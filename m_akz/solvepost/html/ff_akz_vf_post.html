
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_akz_vf_post</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-05-30"><meta name="DC.source" content="ff_akz_vf_post.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameter</a></li><li><a href="#5">Generate Consumption and Income Matrix</a></li><li><a href="#6">Save Mat</a></li><li><a href="#7">Display Val Pol Iter Table</a></li><li><a href="#8">Generate and Save Graphs</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> [result_map] = ff_akz_vf_post(varargin)
</pre><h2 id="2">FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.</h2><p>Given the solution form ff_akz_vf, graphs, tables, mats. Graphing code is separately in ff_akz_vf_post_graph.m. Run this function directly with randomly generates matrixes for graph/table testings.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@param result_map container contains policy function matrix, value function matrix, iteration results</p><p>@return result_map container add coh consumption and other matrixes to result_map also add table versions of val pol and iter matries</p><p>@example</p><pre>  bl_input_override = true;
  result_map = containers.Map('KeyType','char', 'ValueType','any');
  result_map('mt_val') = mt_val;
  result_map('mt_pol_a') = mt_pol_a;
  result_map('mt_pol_k') = mt_pol_k;
  result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
  result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
  result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
  result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);</pre><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post_graph.m">ff_akz_vf_post_graph</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m">ffs_akz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m">ffs_akz_get_funcgrid</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 6)
    bl_input_override = varargin{6};
<span class="keyword">end</span>

<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% if invoked from outside overrid fully</span>
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};

    params_group = values(result_map, {<span class="string">'mt_val'</span>, <span class="string">'mt_pol_a'</span>, <span class="string">'mt_pol_k'</span>});
    [mt_val, mt_pol_a, mt_pol_k] = params_group{:};
    params_group = values(result_map, {<span class="string">'ar_val_diff_norm'</span>, <span class="string">'ar_pol_diff_norm'</span>, <span class="string">'mt_pol_perc_change'</span>});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};

    <span class="comment">% Get Parameters</span>
    params_group = values(param_map, {<span class="string">'it_z_n'</span>});
    [it_z_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>, <span class="string">'mt_coh'</span>, <span class="string">'it_ameshk_n'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};

<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% internal invoke for testing</span>
    it_param_set = 4;
    bl_input_override = true;

    <span class="comment">% Get Parameters</span>
    [param_map, support_map] = ffs_akz_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generate Default val and policy matrixes</span>
    params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'it_z_n'</span>});
    [it_maxiter_val, it_z_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>, <span class="string">'mt_coh'</span>, <span class="string">'it_ameshk_n'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    params_group = values(func_map, {<span class="string">'f_util_standin'</span>, <span class="string">'f_cons'</span>, <span class="string">'f_coh'</span>});
    [f_util_standin, f_cons, f_coh] = params_group{:};

    <span class="comment">% Set Defaults</span>
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_pol_aksum = mt_coh.*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    mt_pol_a = mt_pol_aksum.*(0.7 - cumsum(sort(ar_z))/sum(ar_z)*0.3);
    mt_pol_k = mt_pol_aksum - mt_pol_a;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);

    <span class="comment">% Set Results Map</span>
    result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
    result_map(<span class="string">'mt_val'</span>) = mt_val;
    result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
    result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameter</h2><pre class="codeinput"><span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_display_final'</span>, <span class="string">'it_display_final_rowmax'</span>, <span class="string">'it_display_final_colmax'</span>});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph'</span>, <span class="string">'bl_graph_onebyones'</span>});
[bl_graph] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_mat'</span>, <span class="string">'st_mat_path'</span>, <span class="string">'st_mat_prefix'</span>, <span class="string">'st_mat_name_main'</span>, <span class="string">'st_mat_suffix'</span>});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_inc'</span>, <span class="string">'f_cons'</span>, <span class="string">'f_coh'</span>});
[f_inc, f_cons, f_coh] = params_group{:};
</pre><h2 id="5">Generate Consumption and Income Matrix</h2><pre class="codeinput">mt_cons = f_cons(mt_coh, mt_pol_a, mt_pol_k);
mt_incm = f_inc(ar_z, ar_a_meshk, ar_k_mesha);
result_map(<span class="string">'mt_cons'</span>) = mt_cons;
result_map(<span class="string">'mt_incm'</span>) = mt_incm;
</pre><h2 id="6">Save Mat</h2><pre class="codeinput"><span class="keyword">if</span> (bl_mat)
    mkdir(support_map(<span class="string">'st_mat_path'</span>));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
</pre><h2 id="7">Display Val Pol Iter Table</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_final)

    <span class="comment">% Display Value Function Iteration Step by Step REsults</span>
    it_iter_max = length(ar_val_diff_norm);
    <span class="keyword">if</span> (it_iter_max &gt;= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];
    <span class="keyword">else</span>
        ar_it_rows_iter = 1:1:it_iter_max;
    <span class="keyword">end</span>
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     ar_pol_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');

    cl_col_names = [<span class="string">'valgap'</span>, <span class="string">'polgap'</span>, strcat(<span class="string">'z'</span>, string((1:it_z_n)))];
    cl_row_names = strcat(<span class="string">'iter='</span>, string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'valgap'</span>} = <span class="string">'norm(mt_val - mt_val_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'polgap'</span>} = <span class="string">'norm(mt_pol_a - mt_pol_a_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'z1'</span>} = <span class="string">'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)'</span>;

    disp(<span class="string">'valgap = norm(mt_val - mt_val_cur)'</span>);
    disp(<span class="string">'polgap = norm(mt_pol_a - mt_pol_a_cur)'</span>);
    disp(<span class="string">'z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)'</span>);
    disp(tb_valpol_alliter);

    <span class="comment">% Display Values by States</span>
    <span class="comment">% at most display 11 columns of shocks</span>
    <span class="comment">% at most display 50 rows for states</span>
    <span class="comment">% display first and last</span>
    <span class="keyword">if</span> (it_ameshk_n &gt;= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_ameshk_n)-round(it_display_final_rowmax/2)+1):1:(it_ameshk_n)];
    <span class="keyword">else</span>
        ar_it_rows = 1:1:it_ameshk_n;
    <span class="keyword">end</span>
    <span class="keyword">if</span> (it_z_n &gt;= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    <span class="keyword">else</span>
        ar_it_cols = 1:1:it_z_n;
    <span class="keyword">end</span>
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);

    <span class="comment">% Display Optimal Values</span>
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat(<span class="string">'coh'</span>, string(ar_it_rows),<span class="keyword">...</span>
                                        <span class="string">':k='</span>, string(ar_a_meshk(ar_it_rows)'),<span class="keyword">...</span>
                                        <span class="string">',b='</span>, string(ar_k_mesha(ar_it_rows)'));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_val'</span>);
    disp(tb_val);

    <span class="comment">% Display Optimal Choices</span>
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat(<span class="string">'coh'</span>, string(ar_it_rows),<span class="keyword">...</span>
                                        <span class="string">':k='</span>, string(ar_a_meshk(ar_it_rows)'),<span class="keyword">...</span>
                                        <span class="string">',b='</span>, string(ar_k_mesha(ar_it_rows)'));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_pol_a'</span>);
    disp(tb_pol_a);

    <span class="comment">% Save to result map</span>
    result_map(<span class="string">'tb_valpol_alliter'</span>) = tb_valpol_alliter;
    result_map(<span class="string">'tb_val'</span>) = tb_val;
    result_map(<span class="string">'tb_pol_a'</span>) = tb_pol_a;
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                valgap       polgap        z1          z2          z3           z4           z5          z6           z7          z8           z9         z10          z11         z12         z13          z14         z15   
               _________    ________    ________    ________    _________    _________    ________    _________    ________    _________    ________    ________    _________    ________    ________    _________    ________

    iter=1       0.27425     0.74637     0.44332     0.13213      0.86138      0.38052     0.78009      0.83569     0.18761      0.98546     0.81832     0.94976     0.082208     0.94768     0.56785      0.80285     0.59827
    iter=2       0.14953     0.80144     0.11721     0.76072      0.65784      0.30217     0.96284      0.38415     0.93146      0.69877    0.085342    0.010364      0.59813    0.032442     0.56972      0.80312      0.9262
    iter=3       0.33435     0.33672     0.37994     0.61723      0.10221      0.29453     0.68824    0.0094997     0.97635     0.089932     0.23284     0.16783     0.029186     0.90615     0.77878      0.87664     0.33441
    iter=4       0.83303     0.56409     0.76483     0.39765      0.58046      0.25981     0.49842      0.30902      0.3312      0.47074     0.24605     0.75527      0.45491      0.3685     0.59024     0.087474     0.44303
    iter=5       0.23358     0.85527     0.91837     0.84127      0.96349      0.46348    0.099032      0.83675     0.62371      0.63536     0.35193     0.83382       0.3325     0.66254     0.11066      0.66791    0.099138
    iter=6      0.069241     0.58916      0.6927     0.03832      0.84487      0.98785     0.28775      0.28134     0.52706      0.52527     0.40908     0.60586      0.94367     0.95362     0.64068      0.50242     0.71515
    iter=7       0.49473     0.50824     0.97062    0.096206      0.75311      0.38508     0.53811      0.78134     0.45908      0.14134     0.11424     0.51792       0.3031    0.094128    0.072019      0.33556     0.72164
    iter=8       0.12215     0.85343     0.12616      0.9481      0.70305      0.94323     0.01133      0.53151     0.35857      0.27552     0.40721     0.94286      0.42822     0.68532     0.36585      0.58856     0.78247
    iter=9       0.40262      0.6838     0.64641     0.39602      0.24662        0.167     0.28284      0.15391     0.33427       0.9871     0.67593     0.74121      0.66103     0.41244      0.2873      0.35193     0.94205
    iter=10     0.091214     0.10634     0.38685     0.53226     0.039941        0.925     0.58957      0.52525    0.083195        0.795     0.54302     0.70108      0.38109     0.11179     0.74144      0.20672    0.047568
    iter=11      0.72055     0.50196     0.56234     0.90364      0.46211      0.75434     0.17205      0.28324      0.3904      0.93333     0.35713     0.74472      0.13617     0.49184    0.066987      0.26215     0.80035
    iter=12      0.34234    0.019167     0.19835     0.34004      0.11737       0.8566      0.1701      0.71487     0.23934      0.34837     0.66159     0.87383     0.096627     0.46155     0.75717     0.098649     0.46679
    iter=13       0.5663     0.44261     0.39393      0.6639      0.16162      0.60239     0.67634      0.73439     0.48627      0.20913      0.6787     0.96412      0.30516     0.87706     0.24071      0.15006     0.27914
    iter=14      0.65451     0.90718     0.34024     0.72736      0.41976      0.10737     0.56959      0.44964     0.70009      0.68037     0.13156     0.98192      0.82388     0.66024     0.23091      0.32102    0.044721
    iter=15       0.6525     0.04467     0.35648     0.22301      0.66612      0.45547     0.55167      0.18208     0.13727      0.35542     0.43962     0.91863      0.62725     0.27796    0.011988      0.59439     0.78755
    iter=16      0.70086     0.94519     0.37304     0.55545      0.97315      0.65459     0.96744      0.13554     0.82647      0.43837      0.9372     0.28348      0.20593     0.65717     0.13247      0.15374     0.89912
    iter=17       0.3011     0.18038     0.11536     0.45523      0.27965     0.057533     0.62842      0.27277     0.93005      0.90878     0.57022    0.058626      0.98019     0.64541     0.20939     0.062626     0.77568
    iter=18     0.085464     0.36991     0.50121     0.61026      0.53139     0.021263     0.32455      0.63564     0.82873      0.83359     0.57764     0.82099      0.43777     0.89722     0.21418    0.0077822     0.83745
    iter=19      0.63344     0.20524     0.81691     0.54399      0.93069       0.2898     0.52102      0.80619     0.48495      0.39138      0.7646     0.17952       0.8352     0.88234     0.90579      0.77426     0.34442
    iter=20      0.26643    0.095586     0.34351     0.51836      0.16666      0.93148     0.86494      0.66788     0.65977      0.73398     0.24695    0.034931      0.53918     0.33517     0.27777      0.68205     0.19119
    iter=21      0.89425     0.43274     0.49854     0.28605      0.78925      0.51402     0.99411      0.28659      0.4564      0.29066     0.69386     0.77133     0.025127       0.427    0.097102       0.1205     0.37844
    iter=22      0.30027     0.27756     0.11802     0.87902      0.10297       0.8753     0.83849      0.14244     0.41846      0.29214     0.29486     0.54053    0.0068243     0.80376     0.78282      0.71925     0.25633
    iter=23      0.71506     0.10086     0.57552     0.93654      0.88362       0.3781      0.3474      0.24588    0.034296       0.2968      0.5707     0.33154      0.78609     0.92309     0.66752      0.16185    0.021463
    iter=24      0.33035     0.49892     0.51546     0.80621      0.52224      0.88451     0.74941       0.6919     0.92685     0.024842      0.6348     0.57822      0.44739     0.86672     0.61267      0.12016     0.29328
    iter=25      0.36487     0.23903     0.35528     0.96908      0.97413      0.53477     0.93941     0.071747     0.04338      0.91784     0.39889     0.85451      0.28874     0.49965     0.34379      0.68115     0.24042
    iter=26      0.59235      0.3496     0.86335     0.52423       0.7561       0.8926     0.66808      0.49866     0.47606      0.68603     0.24888     0.64238      0.86318     0.58448     0.69034      0.14483     0.20259
    iter=27      0.90519     0.55826     0.34401     0.11287      0.72257      0.10276      0.4812        0.986     0.38575      0.23428     0.93533      0.4201      0.65623     0.92476     0.23356     0.057828     0.34822
    iter=28      0.26453     0.54807     0.45688     0.65023    0.0026012      0.21205     0.28616       0.9049     0.53406      0.49735      0.4489     0.54591      0.28469     0.16612     0.30803      0.13494     0.53715
    iter=29      0.94983     0.42127     0.23809     0.19089      0.20561      0.70161     0.59516      0.57521     0.99817      0.79058     0.53178      0.1823      0.64457     0.37436      0.3573      0.01478     0.12431
    iter=30      0.73873      0.3855     0.77116     0.85694      0.26037      0.36135     0.33641      0.76652     0.90247      0.38023     0.63484     0.23627      0.26358     0.25941      0.2167      0.18912     0.19274
    iter=31    0.0044611     0.38066      0.2734     0.94285     0.079955    0.0013957     0.95955      0.74677    0.014755      0.21858     0.66812     0.20541      0.17478     0.83048     0.67728     0.070862     0.48862
    iter=32      0.85074     0.28073       0.525     0.10345      0.73533      0.38431     0.44208      0.69533     0.78051      0.72267     0.43901     0.25969      0.36862    0.070177     0.73601      0.03786     0.40701
    iter=33      0.69557     0.17991     0.53111     0.29644      0.82265      0.32014       0.962      0.67732     0.48529      0.77283     0.17299     0.94263      0.53754     0.28103    0.010019      0.30787     0.73492
    iter=34      0.56243     0.12728     0.87338     0.79903      0.34339      0.39335     0.67638       0.2824     0.39022      0.69328     0.69438     0.64157      0.92641     0.55504     0.35591      0.51574      0.2999
    iter=35      0.33772     0.01569     0.93761     0.44171      0.13614      0.18125     0.70608      0.58187     0.82309      0.61967     0.92493     0.82906      0.74912     0.61897     0.23995      0.39351     0.80714
    iter=36       0.3328     0.75309    0.048717     0.49252      0.66589      0.20938     0.95769      0.61887     0.87442       0.7623     0.37061     0.38876      0.14774     0.40979     0.92761       0.9952     0.91366
    iter=37     0.077323     0.50496     0.97884    0.029516      0.83044      0.59372     0.93988      0.81424     0.99836      0.51148     0.63879     0.16841    0.0028877     0.25843     0.76299       0.4396     0.76511
    iter=38       0.4583     0.72211     0.63233     0.57264      0.67362      0.59447     0.83376     0.015987     0.19566      0.32941     0.88968     0.74012      0.12701     0.41675     0.37939      0.15144     0.33421
    iter=39      0.65719      0.7611    0.072634     0.57246      0.13946      0.17247     0.15524      0.21435     0.86997    0.0013441     0.48294      0.8728      0.91692     0.38206     0.68596      0.77805     0.71934
    iter=40      0.57195     0.26895     0.21182     0.74169      0.37883        0.933     0.83043      0.98787     0.30749      0.58064     0.62982     0.35552      0.67212    0.096334     0.69887      0.74117    0.033593
    iter=41      0.40211     0.19362     0.35989    0.076606      0.67836     0.056217     0.46414      0.81734     0.41124      0.17184     0.46502     0.17883      0.11379     0.13128      0.5904     0.087644     0.61562
    iter=42       0.9347    0.064149     0.42668     0.78717      0.51593      0.20172     0.29869      0.63208     0.81634      0.19491     0.10917     0.99642      0.96023      0.6099     0.96206      0.47043     0.11218
    iter=43      0.36053     0.42537     0.75815     0.19349      0.97806      0.50825     0.52331      0.68215     0.36825      0.15032     0.11312     0.95913      0.11938     0.65619     0.78135      0.29283    0.050602
    iter=44      0.94771     0.70215     0.91575     0.53093      0.26772      0.75921     0.83163      0.80822     0.42622      0.50542     0.10789       0.156      0.49242       0.841     0.53843      0.40685     0.05521
    iter=45     0.030124     0.97732     0.62974     0.92413      0.86691      0.14605     0.53913      0.27966    0.091217     0.017387     0.44573     0.92894      0.36131     0.49982    0.094138      0.43024     0.02622
    iter=46       0.4411     0.55158     0.95591     0.98606      0.37375      0.93107     0.25983      0.66497      0.6675      0.47121     0.93885     0.42457         0.47      0.3072     0.88601      0.87126     0.95544
    iter=47      0.70071    0.043807     0.75512     0.97529      0.13663      0.42195     0.35404     0.029324     0.73131     0.046077     0.63381     0.22308      0.05878     0.16976      0.2575      0.70725     0.52521
    iter=48      0.70299     0.58215     0.52611     0.30477     0.082692     0.056499     0.18674      0.54438     0.30082      0.44227     0.92967      0.1364      0.33001    0.048765     0.46351     0.014297     0.75625
    iter=49      0.51017     0.27838     0.85011     0.75364      0.73882       0.6742     0.35066      0.52897       0.338      0.16356    0.062876     0.26018      0.26452     0.22582      0.3308     0.024584     0.58982
    iter=50      0.61224     0.54219     0.81603     0.20636      0.37207      0.27981     0.18972      0.87316     0.73432       0.5721     0.30694     0.54447      0.24592     0.36697     0.75677      0.23699     0.73891

tb_val
                                  z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                  __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                   -4.6052       -4.6052       -4.6052      -4.6052      -4.6052       -4.6052       -4.6052       -4.6052       -4.6052       -4.6052       -4.6052       -4.6052 
    coh2:k=1.72414,b=0             0.55051       0.55051       0.55051      0.55051      0.55051       0.55051       0.55051       0.55051       0.55051       0.55051       0.55051       0.55051 
    coh3:k=3.44828,b=0              1.2408        1.2408        1.2408       1.2408       1.2408        1.2408        1.2408        1.2408        1.2408        1.2408        1.2408        1.2408 
    coh4:k=5.17241,b=0              1.6453        1.6453        1.6453       1.6453       1.6453        1.6453        1.6453        1.6453        1.6453        1.6453        1.6453        1.6453 
    coh5:k=6.89655,b=0              1.9325        1.9325        1.9325       1.9325       1.9325        1.9325        1.9325        1.9325        1.9325        1.9325        1.9325        1.9325 
    coh6:k=8.62069,b=0              2.1553        2.1553        2.1553       2.1553       2.1553        2.1553        2.1553        2.1553        2.1553        2.1553        2.1553        2.1553 
    coh7:k=10.3448,b=0              2.3375        2.3375        2.3375       2.3375       2.3375        2.3375        2.3375        2.3375        2.3375        2.3375        2.3375        2.3375 
    coh8:k=12.069,b=0               2.4915        2.4915        2.4915       2.4915       2.4915        2.4915        2.4915        2.4915        2.4915        2.4915        2.4915        2.4915 
    coh9:k=13.7931,b=0              2.6249        2.6249        2.6249       2.6249       2.6249        2.6249        2.6249        2.6249        2.6249        2.6249        2.6249        2.6249 
    coh10:k=15.5172,b=0             2.7426        2.7426        2.7426       2.7426       2.7426        2.7426        2.7426        2.7426        2.7426        2.7426        2.7426        2.7426 
    coh11:k=17.2414,b=0             2.8479        2.8479        2.8479       2.8479       2.8479        2.8479        2.8479        2.8479        2.8479        2.8479        2.8479        2.8479 
    coh12:k=18.9655,b=0             2.9431        2.9431        2.9431       2.9431       2.9431        2.9431        2.9431        2.9431        2.9431        2.9431        2.9431        2.9431 
    coh13:k=20.6897,b=0             3.0301        3.0301        3.0301       3.0301       3.0301        3.0301        3.0301        3.0301        3.0301        3.0301        3.0301        3.0301 
    coh14:k=22.4138,b=0             3.1101        3.1101        3.1101       3.1101       3.1101        3.1101        3.1101        3.1101        3.1101        3.1101        3.1101        3.1101 
    coh15:k=24.1379,b=0             3.1842        3.1842        3.1842       3.1842       3.1842        3.1842        3.1842        3.1842        3.1842        3.1842        3.1842        3.1842 
    coh16:k=25.8621,b=0             3.2532        3.2532        3.2532       3.2532       3.2532        3.2532        3.2532        3.2532        3.2532        3.2532        3.2532        3.2532 
    coh17:k=27.5862,b=0             3.3177        3.3177        3.3177       3.3177       3.3177        3.3177        3.3177        3.3177        3.3177        3.3177        3.3177        3.3177 
    coh18:k=29.3103,b=0             3.3783        3.3783        3.3783       3.3783       3.3783        3.3783        3.3783        3.3783        3.3783        3.3783        3.3783        3.3783 
    coh19:k=31.0345,b=0             3.4354        3.4354        3.4354       3.4354       3.4354        3.4354        3.4354        3.4354        3.4354        3.4354        3.4354        3.4354 
    coh20:k=32.7586,b=0             3.4895        3.4895        3.4895       3.4895       3.4895        3.4895        3.4895        3.4895        3.4895        3.4895        3.4895        3.4895 
    coh21:k=34.4828,b=0             3.5407        3.5407        3.5407       3.5407       3.5407        3.5407        3.5407        3.5407        3.5407        3.5407        3.5407        3.5407 
    coh22:k=36.2069,b=0             3.5895        3.5895        3.5895       3.5895       3.5895        3.5895        3.5895        3.5895        3.5895        3.5895        3.5895        3.5895 
    coh23:k=37.931,b=0               3.636         3.636         3.636        3.636        3.636         3.636         3.636         3.636         3.636         3.636         3.636         3.636 
    coh24:k=39.6552,b=0             3.6805        3.6805        3.6805       3.6805       3.6805        3.6805        3.6805        3.6805        3.6805        3.6805        3.6805        3.6805 
    coh25:k=41.3793,b=0              3.723         3.723         3.723        3.723        3.723         3.723         3.723         3.723         3.723         3.723         3.723         3.723 
    coh26:k=43.1034,b=0             3.7638        3.7638        3.7638       3.7638       3.7638        3.7638        3.7638        3.7638        3.7638        3.7638        3.7638        3.7638 
    coh27:k=44.8276,b=0              3.803         3.803         3.803        3.803        3.803         3.803         3.803         3.803         3.803         3.803         3.803         3.803 
    coh28:k=46.5517,b=0             3.8408        3.8408        3.8408       3.8408       3.8408        3.8408        3.8408        3.8408        3.8408        3.8408        3.8408        3.8408 
    coh29:k=48.2759,b=0             3.8771        3.8771        3.8771       3.8771       3.8771        3.8771        3.8771        3.8771        3.8771        3.8771        3.8771        3.8771 
    coh30:k=50,b=0                  3.9122        3.9122        3.9122       3.9122       3.9122        3.9122        3.9122        3.9122        3.9122        3.9122        3.9122        3.9122 
    coh31:k=0,b=1.72414            0.70254       0.73419       0.76949      0.80872      0.85215       0.90001        1.1395        1.2119        1.2894         1.372        1.4595        1.5517 
    coh32:k=1.72414,b=1.72414       1.3199        1.3371        1.3566       1.3786       1.4034        1.4312        1.5788        1.6261         1.678        1.7347        1.7964        1.8631 
    coh33:k=3.44828,b=1.72414       1.6988        1.7106         1.724       1.7393       1.7566        1.7763         1.883        1.9181        1.9571        2.0003        2.0479        2.1002 
    coh34:k=5.17241,b=1.72414       1.9729        1.9819        1.9921       2.0038       2.0172        2.0324         2.116        2.1439        2.1751          2.21        2.2488        2.2917 
    coh35:k=6.89655,b=1.72414       2.1878         2.195        2.2033       2.2128       2.2237         2.236        2.3048        2.3279         2.354        2.3832        2.4159        2.4524 
    coh36:k=8.62069,b=1.72414       2.3646        2.3707        2.3776       2.3856       2.3947        2.4052        2.4635        2.4833        2.5056        2.5308        2.5591        2.5908 
    coh37:k=10.3448,b=1.72414       2.5148          2.52         2.526       2.5329       2.5408        2.5498        2.6005        2.6177        2.6373        2.6594        2.6843        2.7123 
    coh38:k=12.069,b=1.72414        2.6453        2.6499        2.6552       2.6612       2.6682        2.6761        2.7209        2.7362        2.7536        2.7733        2.7956        2.8207 
    coh39:k=13.7931,b=1.72414       2.7608        2.7649        2.7696        2.775       2.7812        2.7883        2.8284        2.8422        2.8578        2.8756        2.8957        2.9184 
    coh40:k=15.5172,b=1.72414       2.8643         2.868        2.8722       2.8771       2.8827        2.8891        2.9254         2.938        2.9522        2.9684        2.9867        3.0075 
    coh41:k=17.2414,b=1.72414        2.958        2.9614        2.9653       2.9697       2.9748        2.9807        3.0139        3.0254        3.0384        3.0533        3.0701        3.0893 
    coh42:k=18.9655,b=1.72414       3.0438        3.0469        3.0504       3.0545       3.0592        3.0646        3.0952        3.1057        3.1178        3.1315        3.1471        3.1648 
    coh43:k=20.6897,b=1.72414       3.1227        3.1256        3.1289       3.1327        3.137         3.142        3.1703        3.1801        3.1913        3.2041        3.2186        3.2351 
    coh44:k=22.4138,b=1.72414       3.1959        3.1986        3.2016       3.2051       3.2092        3.2138        3.2402        3.2494        3.2598        3.2717        3.2853        3.3008 
    coh45:k=24.1379,b=1.72414       3.2641        3.2666        3.2694       3.2727       3.2765        3.2808        3.3055        3.3141        3.3239        3.3351        3.3479        3.3624 
    coh46:k=25.8621,b=1.72414       3.3279        3.3303        3.3329        3.336       3.3396        3.3436        3.3669        3.3749        3.3841        3.3947        3.4067        3.4204 
    coh47:k=27.5862,b=1.72414       3.3879        3.3901        3.3927       3.3956       3.3989        3.4027        3.4246        3.4322         3.441        3.4509        3.4623        3.4752 
    coh48:k=29.3103,b=1.72414       3.4446        3.4466         3.449       3.4517       3.4549        3.4585        3.4793        3.4865        3.4947        3.5042        3.5149        3.5272 
    coh49:k=31.0345,b=1.72414       3.4981        3.5001        3.5023       3.5049       3.5079        3.5114         3.531        3.5379        3.5457        3.5547         3.565        3.5767 
    coh50:k=32.7586,b=1.72414        3.549        3.5508         3.553       3.5555       3.5583        3.5616        3.5803        3.5868        3.5943        3.6028        3.6126        3.6238 
    coh851:k=17.2414,b=48.2759      4.1442        4.1476        4.1515        4.156       4.1612        4.1671        4.2008        4.2124        4.2256        4.2407        4.2577        4.2771 
    coh852:k=18.9655,b=48.2759      4.1712        4.1745        4.1783       4.1827       4.1877        4.1935        4.2263        4.2376        4.2505        4.2652        4.2819        4.3007 
    coh853:k=20.6897,b=48.2759      4.1974        4.2007        4.2044       4.2087       4.2136        4.2192        4.2512        4.2622        4.2748        4.2891        4.3054        4.3238 
    coh854:k=22.4138,b=48.2759       4.223        4.2262        4.2298        4.234       4.2388        4.2442        4.2754        4.2862        4.2985        4.3125        4.3284        4.3464 
    coh855:k=24.1379,b=48.2759       4.248        4.2511        4.2546       4.2587       4.2633        4.2687        4.2991        4.3097        4.3217        4.3353        4.3509        4.3685 
    coh856:k=25.8621,b=48.2759      4.2723        4.2753        4.2788       4.2827       4.2873        4.2925        4.3223        4.3326        4.3443        4.3577        4.3729        4.3901 
    coh857:k=27.5862,b=48.2759      4.2961         4.299        4.3024       4.3063       4.3107        4.3158        4.3449         4.355        4.3664        4.3795        4.3944        4.4113 
    coh858:k=29.3103,b=48.2759      4.3193        4.3222        4.3255       4.3293       4.3336        4.3386         4.367        4.3769        4.3881        4.4009        4.4155         4.432 
    coh859:k=31.0345,b=48.2759       4.342        4.3448         4.348       4.3517        4.356        4.3609        4.3887        4.3983        4.4093        4.4218        4.4361        4.4523 
    coh860:k=32.7586,b=48.2759      4.3642        4.3669        4.3701       4.3737       4.3778        4.3826        4.4098        4.4193          4.43        4.4423        4.4563        4.4722 
    coh861:k=34.4828,b=48.2759      4.3859        4.3886        4.3916       4.3952       4.3993        4.4039        4.4306        4.4398        4.4504        4.4624        4.4761        4.4917 
    coh862:k=36.2069,b=48.2759      4.4071        4.4097        4.4128       4.4162       4.4202        4.4248        4.4509          4.46        4.4703        4.4821        4.4955        4.5108 
    coh863:k=37.931,b=48.2759       4.4279        4.4305        4.4335       4.4368       4.4408        4.4452        4.4708        4.4797        4.4898        4.5014        4.5146        4.5296 
    coh864:k=39.6552,b=48.2759      4.4483        4.4508        4.4537        4.457       4.4609        4.4653        4.4904        4.4991         4.509        4.5204        4.5333         4.548 
    coh865:k=41.3793,b=48.2759      4.4683        4.4707        4.4736       4.4768       4.4806        4.4849        4.5095         4.518        4.5278        4.5389        4.5516        4.5661 
    coh866:k=43.1034,b=48.2759      4.4878        4.4903        4.4931       4.4963       4.4999        4.5042        4.5283        4.5367        4.5463        4.5572        4.5697        4.5839 
    coh867:k=44.8276,b=48.2759      4.5071        4.5094        4.5122       4.5153       4.5189        4.5231        4.5468         4.555        4.5644        4.5751        4.5874        4.6013 
    coh868:k=46.5517,b=48.2759      4.5259        4.5282        4.5309        4.534       4.5375        4.5416        4.5649        4.5729        4.5822        4.5927        4.6048        4.6185 
    coh869:k=48.2759,b=48.2759      4.5444        4.5467        4.5493       4.5523       4.5558        4.5598        4.5827        4.5906        4.5997          4.61        4.6219        4.6354 
    coh870:k=50,b=48.2759           4.5625        4.5648        4.5674       4.5703       4.5738        4.5777        4.6001        4.6079        4.6169        4.6271        4.6387        4.6519 
    coh871:k=0,b=50                 3.8593        3.8639        3.8691       3.8752       3.8821          3.89        3.9347          3.95        3.9674        3.9871        4.0093        4.0344 
    coh872:k=1.72414,b=50            3.895        3.8994        3.9045       3.9103        3.917        3.9247        3.9679        3.9827        3.9995        4.0186        4.0401        4.0644 
    coh873:k=3.44828,b=50           3.9294        3.9337        3.9386       3.9443       3.9507        3.9581             4        4.0143        4.0306        4.0491          4.07        4.0936 
    coh874:k=5.17241,b=50           3.9628        3.9669        3.9717       3.9771       3.9834        3.9905        4.0311         4.045        4.0608        4.0787         4.099        4.1219 
    coh875:k=6.89655,b=50            3.995         3.999        4.0036       4.0089        4.015        4.0219        4.0612        4.0747        4.0901        4.1075        4.1272        4.1495 
    coh876:k=8.62069,b=50           4.0263        4.0302        4.0346       4.0397       4.0456        4.0524        4.0905        4.1036        4.1185        4.1355        4.1547        4.1763 
    coh877:k=10.3448,b=50           4.0566        4.0603        4.0647       4.0696       4.0753        4.0819        4.1189        4.1317        4.1462        4.1627        4.1814        4.2025 
    coh878:k=12.069,b=50             4.086        4.0896        4.0938       4.0987       4.1042        4.1106        4.1466         4.159        4.1731        4.1892        4.2074        4.2279 
    coh879:k=13.7931,b=50           4.1145        4.1181        4.1222       4.1269       4.1323        4.1384        4.1735        4.1856        4.1993         4.215        4.2327        4.2528 
    coh880:k=15.5172,b=50           4.1423        4.1458        4.1497       4.1543       4.1596        4.1656        4.1997        4.2115        4.2249        4.2401        4.2574         4.277 
    coh881:k=17.2414,b=50           4.1693        4.1727        4.1766        4.181       4.1861         4.192        4.2252        4.2367        4.2498        4.2646        4.2815        4.3007 
    coh882:k=18.9655,b=50           4.1956        4.1989        4.2027        4.207        4.212        4.2177        4.2501        4.2613        4.2741        4.2886        4.3051        4.3238 
    coh883:k=20.6897,b=50           4.2213        4.2245        4.2281       4.2324       4.2372        4.2428        4.2744        4.2853        4.2978         4.312        4.3281        4.3464 
    coh884:k=22.4138,b=50           4.2463        4.2494         4.253       4.2571       4.2618        4.2673        4.2981        4.3088         4.321        4.3348        4.3506        4.3684 
    coh885:k=24.1379,b=50           4.2707        4.2737        4.2772       4.2812       4.2858        4.2911        4.3213        4.3317        4.3436        4.3572        4.3726        4.3901 
    coh886:k=25.8621,b=50           4.2945        4.2974        4.3009       4.3048       4.3093        4.3145        4.3439        4.3541        4.3658         4.379        4.3941        4.4112 
    coh887:k=27.5862,b=50           4.3177        4.3206         4.324       4.3278       4.3322        4.3373        4.3661        4.3761        4.3874        4.4004        4.4152        4.4319 
    coh888:k=29.3103,b=50           4.3404        4.3433        4.3465       4.3503       4.3546        4.3596        4.3877        4.3975        4.4086        4.4213        4.4358        4.4522 
    coh889:k=31.0345,b=50           4.3627        4.3654        4.3686       4.3723       4.3765        4.3814         4.409        4.4185        4.4294        4.4419         4.456        4.4721 
    coh890:k=32.7586,b=50           4.3844        4.3871        4.3902       4.3938        4.398        4.4027        4.4297        4.4391        4.4498         4.462        4.4758        4.4916 
    coh891:k=34.4828,b=50           4.4057        4.4083        4.4114       4.4149       4.4189        4.4236        4.4501        4.4592        4.4697        4.4817        4.4953        4.5107 
    coh892:k=36.2069,b=50           4.4265        4.4291        4.4321       4.4355       4.4395         4.444          4.47         4.479        4.4893         4.501        4.5143        4.5295 
    coh893:k=37.931,b=50            4.4469        4.4494        4.4524       4.4558       4.4596        4.4641        4.4895        4.4984        4.5084        4.5199         4.533        4.5479 
    coh894:k=39.6552,b=50           4.4669        4.4694        4.4723       4.4756       4.4794        4.4838        4.5087        4.5174        4.5272        4.5385        4.5514         4.566 
    coh895:k=41.3793,b=50           4.4865         4.489        4.4918        4.495       4.4988         4.503        4.5275         4.536        4.5457        4.5568        4.5694        4.5838 
    coh896:k=43.1034,b=50           4.5057        4.5081        4.5109       4.5141       4.5177         4.522         4.546        4.5543        4.5638        4.5747        4.5871        4.6013 
    coh897:k=44.8276,b=50           4.5246         4.527        4.5297       4.5328       4.5364        4.5405        4.5641        4.5723        4.5817        4.5923        4.6045        4.6184 
    coh898:k=46.5517,b=50           4.5431        4.5454        4.5481       4.5512       4.5547        4.5587        4.5819        4.5899        4.5992        4.6097        4.6216        4.6353 
    coh899:k=48.2759,b=50           4.5613        4.5636        4.5662       4.5692       4.5727        4.5766        4.5994        4.6073        4.6163        4.6267        4.6385        4.6519 
    coh900:k=50,b=50                4.5791        4.5814         4.584       4.5869       4.5903        4.5942        4.6166        4.6244        4.6333        4.6434         4.655        4.6682 

tb_pol_a
                                  z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                  __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                  0.0028322      0.002868     0.0029077    0.0029513    0.0029987     0.0030495     0.0032613     0.0033027     0.0033288     0.0033301     0.0032934       0.0032 
    coh2:k=1.72414,b=0              0.49114       0.49735       0.50424       0.5118      0.52002       0.52882       0.56556       0.57273       0.57726       0.57749       0.57111      0.55492 
    coh3:k=3.44828,b=0              0.97944       0.99184        1.0056       1.0206        1.037        1.0546        1.1279        1.1422        1.1512        1.1516        1.1389       1.1066 
    coh4:k=5.17241,b=0               1.4677        1.4863        1.5069       1.5295        1.554        1.5804        1.6902        1.7116        1.7251        1.7258        1.7068       1.6584 
    coh5:k=6.89655,b=0                1.956        1.9808        2.0082       2.0383       2.0711        2.1061        2.2524         2.281         2.299           2.3        2.2746       2.2101 
    coh6:k=8.62069,b=0               2.4443        2.4753        2.5096       2.5472       2.5881        2.6319        2.8147        2.8504         2.873        2.8741        2.8424       2.7618 
    coh7:k=10.3448,b=0               2.9326        2.9698        3.0109        3.056       3.1051        3.1577         3.377        3.4199        3.4469        3.4483        3.4102       3.3135 
    coh8:k=12.069,b=0                 3.421        3.4643        3.5122       3.5649       3.6221        3.6834        3.9393        3.9893        4.0208        4.0224         3.978       3.8653 
    coh9:k=13.7931,b=0               3.9093        3.9587        4.0136       4.0737       4.1391        4.2092        4.5016        4.5587        4.5948        4.5966        4.5459        4.417 
    coh10:k=15.5172,b=0              4.3976        4.4532        4.5149       4.5826       4.6561         4.735        5.0639        5.1282        5.1687        5.1708        5.1137       4.9687 
    coh11:k=17.2414,b=0              4.8859        4.9477        5.0162       5.0914       5.1732        5.2607        5.6262        5.6976        5.7426        5.7449        5.6815       5.5204 
    coh12:k=18.9655,b=0              5.3742        5.4422        5.5175       5.6003       5.6902        5.7865        6.1885         6.267        6.3165        6.3191        6.2493       6.0722 
    coh13:k=20.6897,b=0              5.8625        5.9367        6.0189       6.1091       6.2072        6.3123        6.7508        6.8365        6.8905        6.8932        6.8171       6.6239 
    coh14:k=22.4138,b=0              6.3508        6.4312        6.5202        6.618       6.7242         6.838        7.3131        7.4059        7.4644        7.4674         7.385       7.1756 
    coh15:k=24.1379,b=0              6.8391        6.9257        7.0215       7.1268       7.2412        7.3638        7.8754        7.9753        8.0383        8.0415        7.9528       7.7273 
    coh16:k=25.8621,b=0              7.3274        7.4201        7.5229       7.6357       7.7582        7.8896        8.4377        8.5447        8.6123        8.6157        8.5206       8.2791 
    coh17:k=27.5862,b=0              7.8157        7.9146        8.0242       8.1445       8.2753        8.4153             9        9.1142        9.1862        9.1899        9.0884       8.8308 
    coh18:k=29.3103,b=0               8.304        8.4091        8.5255       8.6534       8.7923        8.9411        9.5623        9.6836        9.7601         9.764        9.6562       9.3825 
    coh19:k=31.0345,b=0              8.7923        8.9036        9.0269       9.1622       9.3093        9.4669        10.125        10.253        10.334        10.338        10.224       9.9342 
    coh20:k=32.7586,b=0              9.2806        9.3981        9.5282       9.6711       9.8263        9.9926        10.687        10.822        10.908        10.912        10.792       10.486 
    coh21:k=34.4828,b=0              9.7689        9.8926         10.03        10.18       10.343        10.518        11.249        11.392        11.482        11.486         11.36       11.038 
    coh22:k=36.2069,b=0              10.257        10.387        10.531       10.689        10.86        11.044        11.811        11.961        12.056        12.061        11.928       11.589 
    coh23:k=37.931,b=0               10.745        10.882        11.032       11.198       11.377         11.57        12.374        12.531         12.63        12.635        12.495       12.141 
    coh24:k=39.6552,b=0              11.234        11.376        11.534       11.706       11.894        12.096        12.936          13.1        13.204        13.209        13.063       12.693 
    coh25:k=41.3793,b=0              11.722         11.87        12.035       12.215       12.411        12.621        13.498         13.67        13.778        13.783        13.631       13.245 
    coh26:k=43.1034,b=0               12.21        12.365        12.536       12.724       12.928        13.147        14.061        14.239        14.352        14.357        14.199       13.796 
    coh27:k=44.8276,b=0              12.699        12.859        13.038       13.233       13.445        13.673        14.623        14.808        14.925        14.931        14.767       14.348 
    coh28:k=46.5517,b=0              13.187        13.354        13.539       13.742       13.962        14.199        15.185        15.378        15.499        15.506        15.334         14.9 
    coh29:k=48.2759,b=0              13.675        13.848         14.04       14.251       14.479        14.725        15.748        15.947        16.073         16.08        15.902       15.451 
    coh30:k=50,b=0                   14.164        14.343        14.541        14.76       14.996         15.25         16.31        16.517        16.647        16.654         16.47       16.003 
    coh31:k=0,b=1.72414             0.57178       0.59763       0.62768      0.66258       0.7031       0.75005        1.0192        1.1097        1.2086        1.3131        1.4173       1.5102 
    coh32:k=1.72414,b=1.72414        1.0601        1.0921         1.129       1.1714       1.2201        1.2758        1.5815        1.6791        1.7825        1.8873        1.9852       2.0619 
    coh33:k=3.44828,b=1.72414        1.5484        1.5866        1.6303       1.6803       1.7371        1.8016        2.1438        2.2485        2.3565        2.4614         2.553       2.6137 
    coh34:k=5.17241,b=1.72414        2.0367        2.0811        2.1317       2.1891       2.2541        2.3274        2.7061         2.818        2.9304        3.0356        3.1208       3.1654 
    coh35:k=6.89655,b=1.72414         2.525        2.5756         2.633        2.698       2.7712        2.8531        3.2684        3.3874        3.5043        3.6098        3.6886       3.7171 
    coh36:k=8.62069,b=1.72414        3.0133        3.0701        3.1343       3.2068       3.2882        3.3789        3.8307        3.9568        4.0782        4.1839        4.2564       4.2688 
    coh37:k=10.3448,b=1.72414        3.5016        3.5645        3.6357       3.7157       3.8052        3.9047         4.393        4.5263        4.6522        4.7581        4.8243       4.8205 
    coh38:k=12.069,b=1.72414         3.9899         4.059         4.137       4.2245       4.3222        4.4304        4.9553        5.0957        5.2261        5.3322        5.3921       5.3723 
    coh39:k=13.7931,b=1.72414        4.4782        4.5535        4.6383       4.7334       4.8392        4.9562        5.5176        5.6651           5.8        5.9064        5.9599        5.924 
    coh40:k=15.5172,b=1.72414        4.9665         5.048        5.1397       5.2422       5.3562         5.482        6.0799        6.2345         6.374        6.4806        6.5277       6.4757 
    coh41:k=17.2414,b=1.72414        5.4548        5.5425         5.641       5.7511       5.8733        6.0077        6.6422         6.804        6.9479        7.0547        7.0955       7.0274 
    coh42:k=18.9655,b=1.72414        5.9431         6.037        6.1423       6.2599       6.3903        6.5335        7.2045        7.3734        7.5218        7.6289        7.6634       7.5792 
    coh43:k=20.6897,b=1.72414        6.4314        6.5314        6.6436       6.7688       6.9073        7.0593        7.7668        7.9428        8.0957         8.203        8.2312       8.1309 
    coh44:k=22.4138,b=1.72414        6.9197        7.0259         7.145       7.2776       7.4243         7.585        8.3291        8.5123        8.6697        8.7772         8.799       8.6826 
    coh45:k=24.1379,b=1.72414         7.408        7.5204        7.6463       7.7865       7.9413        8.1108        8.8914        9.0817        9.2436        9.3513        9.3668       9.2343 
    coh46:k=25.8621,b=1.72414        7.8963        8.0149        8.1476       8.2953       8.4583        8.6366        9.4537        9.6511        9.8175        9.9255        9.9346       9.7861 
    coh47:k=27.5862,b=1.72414        8.3846        8.5094         8.649       8.8042       8.9754        9.1623        10.016        10.221        10.391          10.5        10.502       10.338 
    coh48:k=29.3103,b=1.72414        8.8729        9.0039        9.1503        9.313       9.4924        9.6881        10.578         10.79        10.965        11.074         11.07        10.89 
    coh49:k=31.0345,b=1.72414        9.3612        9.4984        9.6516       9.8219       10.009        10.214        11.141        11.359        11.539        11.648        11.638       11.441 
    coh50:k=32.7586,b=1.72414        9.8495        9.9928        10.153       10.331       10.526         10.74        11.703        11.929        12.113        12.222        12.206       11.993 
    coh851:k=17.2414,b=48.2759       17.862         18.15        18.473       18.835       19.236        19.678        21.766        22.299        22.775        23.129        23.268        23.05 
    coh852:k=18.9655,b=48.2759        18.35        18.644        18.975       19.344       19.753        20.204        22.328        22.869        23.349        23.703        23.836       23.601 
    coh853:k=20.6897,b=48.2759       18.838        19.139        19.476       19.853        20.27         20.73         22.89        23.438        23.923        24.277        24.403       24.153 
    coh854:k=22.4138,b=48.2759       19.327        19.633        19.977       20.361       20.787        21.256        23.453        24.008        24.496        24.852        24.971       24.705 
    coh855:k=24.1379,b=48.2759       19.815        20.128        20.479        20.87       21.304        21.781        24.015        24.577         25.07        25.426        25.539       25.257 
    coh856:k=25.8621,b=48.2759       20.303        20.622         20.98       21.379       21.821        22.307        24.577        25.146        25.644            26        26.107       25.808 
    coh857:k=27.5862,b=48.2759       20.792        21.117        21.481       21.888       22.338        22.833         25.14        25.716        26.218        26.574        26.675        26.36 
    coh858:k=29.3103,b=48.2759        21.28        21.611        21.983       22.397       22.856        23.359        25.702        26.285        26.792        27.148        27.242       26.912 
    coh859:k=31.0345,b=48.2759       21.768        22.106        22.484       22.906       23.373        23.884        26.264        26.855        27.366        27.722         27.81       27.463 
    coh860:k=32.7586,b=48.2759       22.257          22.6        22.985       23.415        23.89         24.41        26.826        27.424         27.94        28.297        28.378       28.015 
    coh861:k=34.4828,b=48.2759       22.745        23.095        23.487       23.923       24.407        24.936        27.389        27.994        28.514        28.871        28.946       28.567 
    coh862:k=36.2069,b=48.2759       23.233        23.589        23.988       24.432       24.924        25.462        27.951        28.563        29.088        29.445        29.514       29.119 
    coh863:k=37.931,b=48.2759        23.721        24.084        24.489       24.941       25.441        25.988        28.513        29.132        29.662        30.019        30.082        29.67 
    coh864:k=39.6552,b=48.2759        24.21        24.578        24.991        25.45       25.958        26.513        29.076        29.702        30.236        30.593        30.649       30.222 
    coh865:k=41.3793,b=48.2759       24.698        25.073        25.492       25.959       26.475        27.039        29.638        30.271         30.81        31.167        31.217       30.774 
    coh866:k=43.1034,b=48.2759       25.186        25.567        25.993       26.468       26.992        27.565          30.2        30.841        31.384        31.741        31.785       31.326 
    coh867:k=44.8276,b=48.2759       25.675        26.061        26.495       26.976       27.509        28.091        30.763         31.41        31.958        32.316        32.353       31.877 
    coh868:k=46.5517,b=48.2759       26.163        26.556        26.996       27.485       28.026        28.616        31.325         31.98        32.531         32.89        32.921       32.429 
    coh869:k=48.2759,b=48.2759       26.651         27.05        27.497       27.994       28.543        29.142        31.887        32.549        33.105        33.464        33.488       32.981 
    coh870:k=50,b=48.2759             27.14        27.545        27.999       28.503        29.06        29.668        32.449        33.118        33.679        34.038        34.056       33.532 
    coh871:k=0,b=50                  13.433        13.666        13.928       14.223       14.551        14.915        16.681        17.153        17.592        17.949         18.15       18.082 
    coh872:k=1.72414,b=50            13.921         14.16        14.429       14.731       15.068        15.441        17.244        17.723        18.166        18.523        18.717       18.634 
    coh873:k=3.44828,b=50             14.41        14.655        14.931        15.24       15.585        15.967        17.806        18.292         18.74        19.097        19.285       19.186 
    coh874:k=5.17241,b=50            14.898        15.149        15.432       15.749       16.102        16.493        18.368        18.862        19.314        19.671        19.853       19.737 
    coh875:k=6.89655,b=50            15.386        15.644        15.933       16.258       16.619        17.019         18.93        19.431        19.888        20.245        20.421       20.289 
    coh876:k=8.62069,b=50            15.875        16.138        16.435       16.767       17.136        17.544        19.493        20.001        20.462         20.82        20.989       20.841 
    coh877:k=10.3448,b=50            16.363        16.633        16.936       17.276       17.653         18.07        20.055         20.57        21.036        21.394        21.556       21.393 
    coh878:k=12.069,b=50             16.851        17.127        17.437       17.785        18.17        18.596        20.617        21.139        21.609        21.968        22.124       21.944 
    coh879:k=13.7931,b=50             17.34        17.622        17.939       18.293       18.687        19.122         21.18        21.709        22.183        22.542        22.692       22.496 
    coh880:k=15.5172,b=50            17.828        18.116         18.44       18.802       19.205        19.647        21.742        22.278        22.757        23.116         23.26       23.048 
    coh881:k=17.2414,b=50            18.316        18.611        18.941       19.311       19.722        20.173        22.304        22.848        23.331         23.69        23.828       23.599 
    coh882:k=18.9655,b=50            18.804        19.105        19.443        19.82       20.239        20.699        22.866        23.417        23.905        24.264        24.396       24.151 
    coh883:k=20.6897,b=50            19.293          19.6        19.944       20.329       20.756        21.225        23.429        23.987        24.479        24.839        24.963       24.703 
    coh884:k=22.4138,b=50            19.781        20.094        20.445       20.838       21.273         21.75        23.991        24.556        25.053        25.413        25.531       25.255 
    coh885:k=24.1379,b=50            20.269        20.588        20.947       21.347        21.79        22.276        24.553        25.125        25.627        25.987        26.099       25.806 
    coh886:k=25.8621,b=50            20.758        21.083        21.448       21.855       22.307        22.802        25.116        25.695        26.201        26.561        26.667       26.358 
    coh887:k=27.5862,b=50            21.246        21.577        21.949       22.364       22.824        23.328        25.678        26.264        26.775        27.135        27.235        26.91 
    coh888:k=29.3103,b=50            21.734        22.072        22.451       22.873       23.341        23.853         26.24        26.834        27.349        27.709        27.802       27.462 
    coh889:k=31.0345,b=50            22.223        22.566        22.952       23.382       23.858        24.379        26.803        27.403        27.923        28.284         28.37       28.013 
    coh890:k=32.7586,b=50            22.711        23.061        23.453       23.891       24.375        24.905        27.365        27.973        28.497        28.858        28.938       28.565 
    coh891:k=34.4828,b=50            23.199        23.555        23.955         24.4       24.892        25.431        27.927        28.542        29.071        29.432        29.506       29.117 
    coh892:k=36.2069,b=50            23.687         24.05        24.456       24.908       25.409        25.957        28.489        29.111        29.644        30.006        30.074       29.668 
    coh893:k=37.931,b=50             24.176        24.544        24.957       25.417       25.926        26.482        29.052        29.681        30.218         30.58        30.642        30.22 
    coh894:k=39.6552,b=50            24.664        25.039        25.459       25.926       26.443        27.008        29.614         30.25        30.792        31.154        31.209       30.772 
    coh895:k=41.3793,b=50            25.152        25.533         25.96       26.435        26.96        27.534        30.176         30.82        31.366        31.729        31.777       31.324 
    coh896:k=43.1034,b=50            25.641        26.028        26.461       26.944       27.477         28.06        30.739        31.389         31.94        32.303        32.345       31.875 
    coh897:k=44.8276,b=50            26.129        26.522        26.963       27.453       27.994        28.585        31.301        31.959        32.514        32.877        32.913       32.427 
    coh898:k=46.5517,b=50            26.617        27.017        27.464       27.962       28.511        29.111        31.863        32.528        33.088        33.451        33.481       32.979 
    coh899:k=48.2759,b=50            27.106        27.511        27.965        28.47       29.028        29.637        32.426        33.097        33.662        34.025        34.049        33.53 
    coh900:k=50,b=50                 27.594        28.006        28.467       28.979       29.545        30.163        32.988        33.667        34.236        34.599        34.616       34.082 

</pre><h2 id="8">Generate and Save Graphs</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph)
    bl_input_override = true;
    ff_akz_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_akz_vf_post_01.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_02.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_03.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_04.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_05.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_06.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_07.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_08.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_09.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_10.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function [result_map] = ff_akz_vf_post(varargin)
%% FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.
% Given the solution form ff_akz_vf, graphs, tables, mats. Graphing code is
% separately in ff_akz_vf_post_graph.m. Run this function directly with
% randomly generates matrixes for graph/table testings.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @param result_map container contains policy function matrix, value
% function matrix, iteration results
%
% @return result_map container add coh consumption and other matrixes to
% result_map also add table versions of val pol and iter matries 
%
% @example
%
%    bl_input_override = true;
%    result_map = containers.Map('KeyType','char', 'ValueType','any');
%    result_map('mt_val') = mt_val;
%    result_map('mt_pol_a') = mt_pol_a;
%    result_map('mt_pol_k') = mt_pol_k;
%    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
%    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
%    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
%    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post_graph.m ff_akz_vf_post_graph>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m ffs_akz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m ffs_akz_get_funcgrid>
%

%% Default

params_len = length(varargin);
bl_input_override = 0;
if (params_len == 6)
    bl_input_override = varargin{6};
end

if (bl_input_override)
    % if invoked from outside overrid fully
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};
    
    params_group = values(result_map, {'mt_val', 'mt_pol_a', 'mt_pol_k'});
    [mt_val, mt_pol_a, mt_pol_k] = params_group{:};
    params_group = values(result_map, {'ar_val_diff_norm', 'ar_pol_diff_norm', 'mt_pol_perc_change'});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};
    
    % Get Parameters
    params_group = values(param_map, {'it_z_n'});
    [it_z_n] = params_group{:};
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z', 'mt_coh', 'it_ameshk_n'});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    
else
    clear all;
    close all;
    
    % internal invoke for testing
    it_param_set = 4;
    bl_input_override = true;
    
    % Get Parameters
    [param_map, support_map] = ffs_akz_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generate Default val and policy matrixes
    params_group = values(param_map, {'it_maxiter_val', 'it_z_n'});
    [it_maxiter_val, it_z_n] = params_group{:};    
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z', 'mt_coh', 'it_ameshk_n'});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    params_group = values(func_map, {'f_util_standin', 'f_cons', 'f_coh'});
    [f_util_standin, f_cons, f_coh] = params_group{:};    
    
    % Set Defaults
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_pol_aksum = mt_coh.*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    mt_pol_a = mt_pol_aksum.*(0.7 - cumsum(sort(ar_z))/sum(ar_z)*0.3);
    mt_pol_k = mt_pol_aksum - mt_pol_a;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);
    
    % Set Results Map
    result_map = containers.Map('KeyType','char', 'ValueType','any');
    result_map('mt_val') = mt_val;
    result_map('mt_pol_a') = mt_pol_a;
    result_map('mt_pol_k') = mt_pol_k;
end

%% Parse Parameter

% support_map
params_group = values(support_map, {'bl_display_final', 'it_display_final_rowmax', 'it_display_final_colmax'});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {'bl_graph', 'bl_graph_onebyones'});
[bl_graph] = params_group{:};
params_group = values(support_map, {'bl_mat', 'st_mat_path', 'st_mat_prefix', 'st_mat_name_main', 'st_mat_suffix'});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

% func_map
params_group = values(func_map, {'f_inc', 'f_cons', 'f_coh'});
[f_inc, f_cons, f_coh] = params_group{:};

%% Generate Consumption and Income Matrix

mt_cons = f_cons(mt_coh, mt_pol_a, mt_pol_k);
mt_incm = f_inc(ar_z, ar_a_meshk, ar_k_mesha);
result_map('mt_cons') = mt_cons;
result_map('mt_incm') = mt_incm;

%% Save Mat

if (bl_mat)
    mkdir(support_map('st_mat_path'));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
end

%% Display Val Pol Iter Table

if (bl_display_final)
    
    % Display Value Function Iteration Step by Step REsults
    it_iter_max = length(ar_val_diff_norm);
    if (it_iter_max >= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];        
    else
        ar_it_rows_iter = 1:1:it_iter_max;
    end
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';...
                                     ar_pol_diff_norm(ar_it_rows_iter)';...
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');
                                 
    cl_col_names = ['valgap', 'polgap', strcat('z', string((1:it_z_n)))];
    cl_row_names = strcat('iter=', string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{'valgap'} = 'norm(mt_val - mt_val_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'polgap'} = 'norm(mt_pol_a - mt_pol_a_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'z1'} = 'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)';
    
    disp('valgap = norm(mt_val - mt_val_cur)');
    disp('polgap = norm(mt_pol_a - mt_pol_a_cur)');
    disp('z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)');   
    disp(tb_valpol_alliter);
    
    % Display Values by States
    % at most display 11 columns of shocks
    % at most display 50 rows for states
    % display first and last
    if (it_ameshk_n >= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_ameshk_n)-round(it_display_final_rowmax/2)+1):1:(it_ameshk_n)];
    else
        ar_it_rows = 1:1:it_ameshk_n;
    end
    if (it_z_n >= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    else
        ar_it_cols = 1:1:it_z_n;
    end
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);
    
    % Display Optimal Values
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat('coh', string(ar_it_rows),...
                                        ':k=', string(ar_a_meshk(ar_it_rows)'),...
                                        ',b=', string(ar_k_mesha(ar_it_rows)'));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_val');
    disp(tb_val);
    
    % Display Optimal Choices
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat('coh', string(ar_it_rows),...
                                        ':k=', string(ar_a_meshk(ar_it_rows)'),...
                                        ',b=', string(ar_k_mesha(ar_it_rows)'));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_pol_a');
    disp(tb_pol_a);
    
    % Save to result map
    result_map('tb_valpol_alliter') = tb_valpol_alliter;
    result_map('tb_val') = tb_val;
    result_map('tb_pol_a') = tb_pol_a;
end

%% Generate and Save Graphs

if (bl_graph)
    bl_input_override = true;
    ff_akz_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>