
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_akz_vf_post</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-01"><meta name="DC.source" content="ff_akz_vf_post.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameter</a></li><li><a href="#5">Generate Consumption and Income Matrix</a></li><li><a href="#6">Save Mat</a></li><li><a href="#7">Display Val Pol Iter Table</a></li><li><a href="#8">Generate and Save Graphs</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> [result_map] = ff_akz_vf_post(varargin)
</pre><h2 id="2">FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.</h2><p>Given the solution form ff_akz_vf, graphs, tables, mats. Graphing code is separately in ff_akz_vf_post_graph.m. Run this function directly with randomly generates matrixes for graph/table testings.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@param result_map container contains policy function matrix, value function matrix, iteration results</p><p>@return result_map container add coh consumption and other matrixes to result_map also add table versions of val pol and iter matries</p><p>@example</p><pre>  bl_input_override = true;
  result_map = containers.Map('KeyType','char', 'ValueType','any');
  result_map('mt_val') = mt_val;
  result_map('mt_pol_a') = mt_pol_a;
  result_map('mt_pol_k') = mt_pol_k;
  result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
  result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
  result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
  result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);</pre><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post_graph.m">ff_akz_vf_post_graph</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m">ffs_akz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m">ffs_akz_get_funcgrid</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 6)
    bl_input_override = varargin{6};
<span class="keyword">end</span>

<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% if invoked from outside overrid fully</span>
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};

    params_group = values(result_map, {<span class="string">'mt_val'</span>, <span class="string">'mt_pol_a'</span>, <span class="string">'mt_pol_k'</span>});
    [mt_val, mt_pol_a, mt_pol_k] = params_group{:};
    params_group = values(result_map, {<span class="string">'ar_val_diff_norm'</span>, <span class="string">'ar_pol_diff_norm'</span>, <span class="string">'mt_pol_perc_change'</span>});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};

    <span class="comment">% Get Parameters</span>
    params_group = values(param_map, {<span class="string">'it_z_n'</span>});
    [it_z_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>, <span class="string">'mt_coh'</span>, <span class="string">'it_ameshk_n'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};

<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% internal invoke for testing</span>
    it_param_set = 4;
    bl_input_override = true;

    <span class="comment">% Get Parameters</span>
    [param_map, support_map] = ffs_akz_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generate Default val and policy matrixes</span>
    params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'it_z_n'</span>});
    [it_maxiter_val, it_z_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>, <span class="string">'mt_coh'</span>, <span class="string">'it_ameshk_n'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    params_group = values(func_map, {<span class="string">'f_util_standin'</span>, <span class="string">'f_cons'</span>, <span class="string">'f_coh'</span>});
    [f_util_standin, f_cons, f_coh] = params_group{:};

    <span class="comment">% Set Defaults</span>
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_pol_aksum = mt_coh.*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    mt_pol_a = mt_pol_aksum.*(0.7 - cumsum(sort(ar_z))/sum(ar_z)*0.3);
    mt_pol_k = mt_pol_aksum - mt_pol_a;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);

    <span class="comment">% Set Results Map</span>
    result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
    result_map(<span class="string">'mt_val'</span>) = mt_val;
    result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
    result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameter</h2><pre class="codeinput"><span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_display_final'</span>, <span class="string">'it_display_final_rowmax'</span>, <span class="string">'it_display_final_colmax'</span>});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph'</span>, <span class="string">'bl_graph_onebyones'</span>});
[bl_graph] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_mat'</span>, <span class="string">'st_mat_path'</span>, <span class="string">'st_mat_prefix'</span>, <span class="string">'st_mat_name_main'</span>, <span class="string">'st_mat_suffix'</span>});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_inc'</span>, <span class="string">'f_cons'</span>, <span class="string">'f_coh'</span>});
[f_inc, f_cons, f_coh] = params_group{:};
</pre><h2 id="5">Generate Consumption and Income Matrix</h2><pre class="codeinput">mt_cons = f_cons(mt_coh, mt_pol_a, mt_pol_k);
mt_incm = f_inc(ar_z, ar_a_meshk, ar_k_mesha);
result_map(<span class="string">'mt_cons'</span>) = mt_cons;
result_map(<span class="string">'mt_incm'</span>) = mt_incm;
</pre><h2 id="6">Save Mat</h2><pre class="codeinput"><span class="keyword">if</span> (bl_mat)
    mkdir(support_map(<span class="string">'st_mat_path'</span>));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
</pre><h2 id="7">Display Val Pol Iter Table</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_final)

    <span class="comment">% Display Value Function Iteration Step by Step REsults</span>
    it_iter_max = length(ar_val_diff_norm);
    <span class="keyword">if</span> (it_iter_max &gt;= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];
    <span class="keyword">else</span>
        ar_it_rows_iter = 1:1:it_iter_max;
    <span class="keyword">end</span>
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     ar_pol_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');

    cl_col_names = [<span class="string">'valgap'</span>, <span class="string">'polgap'</span>, strcat(<span class="string">'z'</span>, string((1:it_z_n)))];
    cl_row_names = strcat(<span class="string">'iter='</span>, string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'valgap'</span>} = <span class="string">'norm(mt_val - mt_val_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'polgap'</span>} = <span class="string">'norm(mt_pol_a - mt_pol_a_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'z1'</span>} = <span class="string">'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)'</span>;

    disp(<span class="string">'valgap = norm(mt_val - mt_val_cur)'</span>);
    disp(<span class="string">'polgap = norm(mt_pol_a - mt_pol_a_cur)'</span>);
    disp(<span class="string">'z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)'</span>);
    disp(tb_valpol_alliter);

    <span class="comment">% Display Values by States</span>
    <span class="comment">% at most display 11 columns of shocks</span>
    <span class="comment">% at most display 50 rows for states</span>
    <span class="comment">% display first and last</span>
    <span class="keyword">if</span> (it_ameshk_n &gt;= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_ameshk_n)-round(it_display_final_rowmax/2)+1):1:(it_ameshk_n)];
    <span class="keyword">else</span>
        ar_it_rows = 1:1:it_ameshk_n;
    <span class="keyword">end</span>
    <span class="keyword">if</span> (it_z_n &gt;= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    <span class="keyword">else</span>
        ar_it_cols = 1:1:it_z_n;
    <span class="keyword">end</span>
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);

    <span class="comment">% Display Optimal Values</span>
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat(<span class="string">'coh'</span>, string(ar_it_rows),<span class="keyword">...</span>
                                        <span class="string">':k='</span>, string(ar_a_meshk(ar_it_rows)'),<span class="keyword">...</span>
                                        <span class="string">',b='</span>, string(ar_k_mesha(ar_it_rows)'));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_val'</span>);
    disp(tb_val);

    <span class="comment">% Display Optimal Choices</span>
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat(<span class="string">'coh'</span>, string(ar_it_rows),<span class="keyword">...</span>
                                        <span class="string">':k='</span>, string(ar_a_meshk(ar_it_rows)'),<span class="keyword">...</span>
                                        <span class="string">',b='</span>, string(ar_k_mesha(ar_it_rows)'));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_pol_a'</span>);
    disp(tb_pol_a);

    <span class="comment">% Save to result map</span>
    result_map(<span class="string">'tb_valpol_alliter'</span>) = tb_valpol_alliter;
    result_map(<span class="string">'tb_val'</span>) = tb_val;
    result_map(<span class="string">'tb_pol_a'</span>) = tb_pol_a;
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                valgap       polgap        z1          z2          z3          z4           z5          z6          z7          z8          z9         z10          z11          z12          z13          z14         z15   
               _________    ________    ________    ________    ________    _________    ________    ________    ________    ________    ________    ________    _________    _________    _________    _________    ________

    iter=1       0.10976     0.98793     0.16357     0.63119     0.98914      0.78287     0.71357     0.50378     0.28595     0.40673     0.11704     0.50384     0.019621      0.14026      0.31802      0.67227     0.64232
    iter=2       0.93376     0.17043     0.66599     0.35507    0.066946      0.69379     0.61834     0.48959     0.54366     0.66693     0.81468     0.61281      0.43518      0.26013      0.60864      0.43151     0.22127
    iter=3       0.18746     0.25779     0.89439       0.997      0.9394    0.0098023     0.34329     0.87705     0.98478     0.93373     0.32486     0.81942      0.83222     0.086815       0.9102       0.6944     0.83706
    iter=4       0.26618      0.3968     0.51656     0.22417    0.018178      0.84321     0.93603     0.35314     0.71568     0.81095     0.24623     0.53189      0.61739       0.4294       0.9091      0.25678     0.97108
    iter=5       0.79783    0.073995      0.7027     0.65245     0.68384      0.92233     0.12477     0.44944     0.83897     0.48455     0.34271     0.20208      0.52013      0.25728      0.59159    0.0097586     0.84637
    iter=6        0.4876      0.6841     0.15359     0.60499     0.78374      0.77095     0.73059     0.96353     0.43326     0.75675     0.37569     0.45389      0.86387      0.29756      0.33257      0.53228       0.506
    iter=7       0.76896     0.40239     0.95346     0.38725     0.53414      0.04266     0.64648    0.042298     0.47062     0.41705     0.54655     0.42791     0.097698      0.42486      0.85306      0.27939     0.27888
    iter=8       0.39601     0.98284     0.54088     0.14219     0.88536      0.37819     0.83315     0.97296     0.56071     0.97179     0.56192     0.96605      0.90805      0.11921       0.4424      0.94623     0.74662
    iter=9       0.27294     0.40218     0.67973    0.025135       0.899      0.70434     0.39828     0.18921     0.26909     0.98797     0.39582     0.62006      0.10802      0.49507      0.90436      0.90644     0.23693
    iter=10     0.037235     0.62067    0.036563     0.42111     0.62594      0.72951     0.74982     0.66712     0.74902     0.86415     0.39813     0.69539        0.517      0.70641     0.033179      0.39268     0.95735
    iter=11      0.67329     0.15437      0.8092      0.1841     0.13787      0.22428     0.83522     0.58644     0.50389     0.38888     0.51537     0.72016      0.14316      0.24357      0.53243     0.024855     0.62026
    iter=12      0.42956     0.38135     0.74862     0.72578      0.2178      0.26905     0.32246     0.67511     0.64681     0.45474     0.65753      0.3469      0.55937      0.78507       0.7165      0.67144     0.60026
    iter=13      0.45174     0.16113     0.12019     0.37036     0.18214      0.67303     0.55226     0.36102     0.30775     0.24669     0.95092     0.51699    0.0045796      0.07409       0.1793      0.83717      0.1726
    iter=14      0.60986     0.75811     0.52505     0.84156     0.04182      0.47749     0.97913     0.62028     0.13872     0.78442     0.72235     0.55669      0.76668      0.39388      0.33653       0.9715    0.090347
    iter=15     0.059403     0.87111     0.32583     0.73423     0.10694      0.62372     0.54931     0.81115     0.47557     0.88284     0.40008      0.1565      0.84871    0.0033941      0.18771     0.056933     0.25526
    iter=16      0.31581     0.35078     0.54645     0.57103     0.61644      0.23644     0.33042    0.019257     0.36246     0.91371     0.83187     0.56206      0.91682      0.22068      0.32193      0.45032     0.85857
    iter=17      0.77272     0.68554     0.39888     0.17686     0.93966      0.17712     0.61947    0.083874     0.78811     0.55828     0.13434      0.6948      0.98697    0.0013006      0.40386      0.58247     0.91107
    iter=18      0.69643     0.29415     0.41509     0.95738     0.35446      0.82964     0.36064      0.9748      0.7803     0.59887    0.060467     0.42646      0.50513      0.18918      0.54857      0.68664     0.69963
    iter=19      0.12533     0.53063     0.18074     0.26532     0.41063      0.76692     0.75651     0.65135     0.66851     0.14888    0.084247     0.83627      0.27142      0.14248     0.048739      0.71943     0.72518
    iter=20      0.13015     0.83242     0.25539     0.92458     0.98435      0.93448      0.4139     0.23124      0.1335     0.89971      0.1639     0.73139      0.10075      0.26808      0.55273      0.65004     0.22989
    iter=21     0.092352     0.59749    0.020536     0.22377     0.94558      0.10789     0.49235     0.40349    0.021556     0.45039     0.32422     0.36003      0.50785      0.17489      0.27481      0.72691     0.57605
    iter=22    0.0078203     0.33531     0.92368     0.37356     0.67664      0.18223     0.69474     0.12202     0.55984     0.20567     0.30173     0.45421      0.58561      0.13865       0.2415      0.37385     0.81063
    iter=23      0.42311     0.29923      0.6537      0.0875      0.9883     0.099095     0.97273     0.26844     0.30082     0.89965    0.011681     0.38639      0.76289      0.59889      0.24315      0.58158     0.40384
    iter=24      0.65557     0.45259     0.93261     0.64012     0.76683      0.48976     0.32775     0.25785     0.93941     0.76259     0.53991     0.77555     0.082963      0.90106      0.15416      0.11612     0.98844
    iter=25      0.72292     0.42265     0.16351     0.18062      0.3367      0.19325      0.8378     0.33167      0.9809     0.88249    0.095373     0.73427       0.6616      0.93938      0.95642     0.057654    0.089999
    iter=26      0.53121     0.35961      0.9211    0.045051     0.66238      0.89589     0.73907     0.15223     0.28662     0.28495     0.14651     0.43028      0.51698      0.22118      0.93566      0.97977     0.32094
    iter=27      0.10882     0.55832     0.79466     0.72317     0.24417      0.09909     0.95417     0.34801     0.80082     0.67323     0.63114     0.69375      0.17105      0.48267      0.81871      0.28482     0.51141
    iter=28      0.63177     0.74255     0.57739     0.34744     0.29551     0.044166    0.031923     0.12166     0.89611     0.66428     0.85932     0.94521      0.93856      0.37601      0.72826      0.59497    0.060606
    iter=29       0.1265     0.42433     0.44004     0.66062     0.68018       0.5573     0.35687     0.88415     0.59753     0.12281     0.97422     0.78423      0.59048      0.52378      0.17581      0.96216     0.72569
    iter=30       0.1343     0.42936     0.25761     0.38387     0.52785       0.7725     0.66265    0.094278     0.88402     0.40732     0.57084     0.70557      0.44063      0.26487      0.36037      0.18578     0.55656
    iter=31     0.098594     0.12487     0.75195     0.62735     0.41159      0.31194      0.2815     0.93004     0.94373     0.27529     0.99685     0.10933      0.94192     0.068357      0.18879      0.19304     0.52936
    iter=32      0.14203    0.024434     0.22867     0.02165     0.60264      0.17898     0.23038     0.39902     0.54916     0.71667     0.55354     0.38993      0.65591      0.43633    0.0011984      0.34164     0.82998
    iter=33      0.16825     0.29019    0.064187     0.91057     0.75052      0.33896     0.71113    0.047401     0.72839     0.28338     0.51546      0.5909      0.45195      0.17385      0.31642       0.9329     0.85876
    iter=34      0.19625     0.31752     0.76733     0.80056     0.58353      0.21015     0.62457     0.34237     0.57676      0.8962     0.33068     0.45938       0.8397     0.026107      0.69962      0.39067     0.78903
    iter=35      0.31748     0.65369      0.6712     0.74585     0.55179      0.51015     0.59061     0.73597    0.025857     0.82658        0.43     0.05034      0.53262      0.95468      0.62526      0.27322     0.31783
    iter=36      0.31643     0.95694     0.71521     0.81311     0.58357      0.90636     0.66044     0.79468     0.44653     0.39003     0.49181     0.22869      0.55389       0.4306      0.54306      0.15195     0.45221
    iter=37      0.21756     0.93573     0.64206     0.38331     0.51182      0.62892    0.047555     0.54491      0.6463      0.4979    0.071037     0.83419      0.68007      0.96156      0.43904      0.39711     0.75223
    iter=38      0.25104     0.45789     0.41905     0.61728    0.082593      0.10153     0.34878     0.68622      0.5212     0.69481     0.88774    0.015645      0.36719      0.76241      0.28743      0.37472     0.10986
    iter=39      0.89292     0.24048     0.39076     0.57549     0.71957      0.39085     0.45134     0.89363     0.37231     0.83437    0.064634     0.86371      0.23929    0.0073487      0.50166      0.13111     0.10974
    iter=40      0.70322      0.7639     0.81614     0.53005     0.99616     0.054617      0.2409    0.054792     0.93713     0.60963     0.43618    0.078069      0.57892      0.68004      0.76155      0.43504     0.26988
    iter=41      0.55574     0.75933     0.31743     0.27507     0.35453      0.50128     0.71505     0.30366     0.82953     0.57474     0.82663     0.66904      0.86689      0.70595      0.76241     0.091513     0.52464
    iter=42      0.18443     0.74065     0.81454     0.24863     0.97126      0.43172     0.85618    0.046192     0.84909     0.32604     0.39453     0.50021      0.40678      0.64513      0.57606      0.61463     0.97265
    iter=43      0.21203     0.74369     0.78907     0.45164     0.34645      0.99756     0.28151     0.19548     0.37253     0.45642     0.61347     0.21799      0.11262      0.55231      0.74766     0.010979     0.71041
    iter=44     0.077347     0.10592     0.85226     0.22771     0.88654       0.8116     0.73105     0.72017     0.59318      0.7138     0.81864     0.57162      0.44385      0.21811      0.64553      0.57326     0.31186
    iter=45       0.9138     0.68156     0.50564     0.80445     0.45469      0.48565     0.13776     0.72175     0.87255     0.88441     0.88624     0.12219      0.30018      0.77237      0.12322      0.78973     0.29146
    iter=46      0.70672     0.46326     0.63566      0.9861     0.41343      0.89445     0.83672      0.8778      0.9335     0.72086     0.93111     0.67117      0.40139      0.22803       0.5044      0.23537     0.85036
    iter=47      0.55779     0.21216     0.95089    0.029992     0.21773      0.13755      0.1386     0.58243     0.66846    0.018613     0.19078     0.59959      0.83336      0.37086      0.34726      0.44802     0.91165
    iter=48      0.31343    0.098519     0.44396     0.53566     0.12565         0.39     0.58821    0.070684     0.20678     0.67478     0.25858    0.055976      0.40363      0.89093     0.092148      0.56936     0.63928
    iter=49       0.1662     0.82357    0.060019    0.087077     0.30891      0.92736     0.36616     0.92274     0.65385     0.43851     0.89787    0.056343      0.39018      0.85638      0.14785     0.061401     0.25537
    iter=50       0.6225     0.17501     0.86675     0.80209      0.7261      0.91749     0.80676     0.80037    0.072052     0.43782     0.59336      0.1525      0.36045      0.40243      0.19817      0.49629    0.088666

tb_val
                                   z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                   __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                    -0.81272      -0.81272     -0.81272     -0.81272      -0.81272      -0.81272      -0.81272      -0.81272      -0.81272      -0.81272      -0.81272     -0.81272 
    coh2:k=1.13636,b=0               0.45743       0.45743      0.45743      0.45743       0.45743       0.45743       0.45743       0.45743       0.45743       0.45743       0.45743      0.45743 
    coh3:k=0,b=1.13636               0.61674       0.64644      0.67964      0.71663       0.75765       0.80298        1.0314        1.1009        1.1756        1.2553          1.34       1.4296 
    coh4:k=2.27273,b=0                0.9993        0.9993       0.9993       0.9993        0.9993        0.9993        0.9993        0.9993        0.9993        0.9993        0.9993       0.9993 
    coh5:k=1.13636,b=1.13636           1.095        1.1135       1.1345       1.1581        1.1847        1.2145        1.3715        1.4215        1.4762        1.5359        1.6005       1.6702 
    coh6:k=0,b=2.27273                1.0991        1.1227       1.1493        1.179        1.2123        1.2494        1.4406        1.5002        1.5648        1.6345        1.7093       1.7891 
    coh7:k=3.40909,b=0                1.3488        1.3488       1.3488       1.3488        1.3488        1.3488        1.3488        1.3488        1.3488        1.3488        1.3488       1.3488 
    coh8:k=2.27273,b=1.13636          1.4172        1.4307        1.446       1.4633         1.483        1.5052        1.6249        1.6639        1.7071        1.7547         1.807        1.864 
    coh9:k=1.13636,b=2.27273          1.4202        1.4373       1.4568       1.4788        1.5036        1.5314        1.6789        1.7262         1.778        1.8347        1.8963        1.963 
    coh10:k=0,b=3.40909               1.4159        1.4359       1.4584       1.4837        1.5122        1.5441        1.7109        1.7638        1.8214         1.884        1.9517       2.0244 
    coh11:k=4.54545,b=0               1.6073        1.6073       1.6073       1.6073        1.6073        1.6073        1.6073        1.6073        1.6073        1.6073        1.6073       1.6073 
    coh12:k=3.40909,b=1.13636         1.6605        1.6711       1.6831       1.6968        1.7124        1.7301        1.8268        1.8588        1.8945        1.9341         1.978       2.0263 
    coh13:k=2.27273,b=2.27273         1.6628        1.6763       1.6917       1.7091        1.7288        1.7511        1.8712        1.9103        1.9537        2.0014        2.0538       2.1111 
    coh14:k=1.13636,b=3.40909         1.6595        1.6751       1.6929        1.713        1.7357        1.7613        1.8977        1.9417        1.9902        2.0433        2.1013       2.1643 
    coh15:k=0,b=4.54545               1.6534        1.6708       1.6906       1.7129        1.7381        1.7663        1.9159        1.9637        2.0162        2.0735        2.1358       2.2031 
    coh16:k=5.68182,b=0               1.8125        1.8125       1.8125       1.8125        1.8125        1.8125        1.8125        1.8125        1.8125        1.8125        1.8125       1.8125 
    coh17:k=4.54545,b=1.13636          1.856        1.8647       1.8747        1.886        1.8989        1.9136        1.9948        2.0219        2.0523        2.0862         2.124       2.1659 
    coh18:k=3.40909,b=2.27273         1.8579        1.8691       1.8817       1.8962        1.9126        1.9311        2.0324        2.0658         2.103        2.1443        2.1899         2.24 
    coh19:k=2.27273,b=3.40909         1.8552        1.8681       1.8828       1.8994        1.9183        1.9396         2.055        2.0927        2.1345        2.1807        2.2314       2.2869 
    coh20:k=1.13636,b=4.54545         1.8502        1.8646       1.8809       1.8994        1.9203        1.9439        2.0706        2.1117        2.1571        2.2071        2.2618       2.3213 
    coh21:k=0,b=5.68182               1.8438        1.8594       1.8772       1.8973          1.92        1.9455        2.0819        2.1259        2.1743        2.2275        2.2854       2.3484 
    coh22:k=6.81818,b=0               1.9826        1.9826       1.9826       1.9826        1.9826        1.9826        1.9826        1.9826        1.9826        1.9826        1.9826       1.9826 
    coh23:k=5.68182,b=1.13636         2.0195        2.0269       2.0354        2.045        2.0561        2.0686        2.1385         2.162        2.1885        2.2182        2.2514       2.2884 
    coh24:k=4.54545,b=2.27273         2.0211        2.0306       2.0414       2.0537        2.0677        2.0836        2.1712        2.2003        2.2329        2.2693        2.3096       2.3542 
    coh25:k=3.40909,b=3.40909         2.0188        2.0298       2.0423       2.0565        2.0726         2.091        2.1909        2.2239        2.2607        2.3015        2.3466       2.3962 
    coh26:k=2.27273,b=4.54545         2.0146        2.0268       2.0406       2.0564        2.0743        2.0946        2.2045        2.2405        2.2806        2.3249        2.3736       2.4271 
    coh27:k=1.13636,b=5.68182         2.0091        2.0224       2.0375       2.0546        2.0741         2.096        2.2144         2.253        2.2958         2.343        2.3948       2.4514 
    coh28:k=0,b=6.81818               2.0028        2.0171       2.0333       2.0517        2.0724        2.0959        2.2219        2.2628         2.308        2.3577        2.4121       2.4715 
    coh29:k=7.95455,b=0                2.128         2.128        2.128        2.128         2.128         2.128         2.128         2.128         2.128         2.128         2.128        2.128 
    coh30:k=6.81818,b=1.13636           2.16        2.1664       2.1738       2.1822        2.1918        2.2028        2.2642         2.285        2.3084        2.3348        2.3644       2.3975 
    coh31:k=5.68182,b=2.27273         2.1614        2.1696        2.179       2.1898         2.202        2.2159        2.2931        2.3189        2.3479        2.3804        2.4165       2.4567 
    coh32:k=4.54545,b=3.40909         2.1594        2.1689       2.1798       2.1922        2.2063        2.2224        2.3105        2.3399        2.3727        2.4092        2.4498       2.4946 
    coh33:k=3.40909,b=4.54545         2.1557        2.1663       2.1784       2.1921        2.2078        2.2255        2.3226        2.3547        2.3905        2.4302        2.4742       2.5227 
    coh34:k=2.27273,b=5.68182         2.1509        2.1625       2.1756       2.1906        2.2076        2.2268        2.3314        2.3658        2.4042        2.4466        2.4934       2.5449 
    coh35:k=1.13636,b=6.81818         2.1455        2.1579        2.172        2.188        2.2061        2.2267         2.338        2.3745         2.415        2.4598        2.5091       2.5631 
    coh36:k=0,b=7.95455               2.1394        2.1526       2.1676       2.1846        2.2038        2.2256        2.3431        2.3814        2.4239        2.4708        2.5222       2.5785 
    coh37:k=9.09091,b=0               2.2549        2.2549       2.2549       2.2549        2.2549        2.2549        2.2549        2.2549        2.2549        2.2549        2.2549       2.2549 
    coh38:k=7.95455,b=1.13636         2.2831        2.2888       2.2953       2.3028        2.3113        2.3211        2.3758        2.3944        2.4154        2.4392        2.4659       2.4958 
    coh39:k=6.81818,b=2.27273         2.2844        2.2917          2.3       2.3095        2.3204        2.3328        2.4017        2.4249         2.451        2.4803        2.5131       2.5496 
    coh40:k=5.68182,b=3.40909         2.2826         2.291       2.3007       2.3117        2.3242        2.3385        2.4173        2.4437        2.4734        2.5065        2.5434       2.5843 
    coh41:k=4.54545,b=4.54545         2.2793        2.2887       2.2994       2.3116        2.3255        2.3413        2.4282        2.4571        2.4895        2.5256        2.5656         2.61 
    coh42:k=3.40909,b=5.68182         2.2751        2.2853        2.297       2.3102        2.3253        2.3424        2.4361        2.4672        2.5019        2.5405        2.5832       2.6303 
    coh43:k=2.27273,b=6.81818         2.2703        2.2813       2.2937       2.3079         2.324        2.3423        2.4421        2.4751        2.5118        2.5525        2.5975       2.6471 
    coh44:k=1.13636,b=7.95455          2.265        2.2766       2.2899       2.3049         2.322        2.3414        2.4466        2.4813        2.5198        2.5625        2.6095       2.6612 
    coh45:k=0,b=9.09091               2.2593        2.2715       2.2855       2.3014        2.3194        2.3397        2.4501        2.4863        2.5264        2.5709        2.6198       2.6734 
    coh46:k=10.2273,b=0               2.3675        2.3675       2.3675       2.3675        2.3675        2.3675        2.3675        2.3675        2.3675        2.3675        2.3675       2.3675 
    coh47:k=9.09091,b=1.13636         2.3928        2.3979       2.4037       2.4104        2.4181        2.4268        2.4762         2.493        2.5121        2.5337         2.558       2.5854 
    coh48:k=7.95455,b=2.27273         2.3939        2.4004       2.4079       2.4164        2.4262        2.4374        2.4996        2.5207        2.5445        2.5712        2.6012       2.6347 
    coh49:k=6.81818,b=3.40909         2.3923        2.3998       2.4085       2.4184        2.4296        2.4425        2.5139        2.5379        2.5648        2.5951        2.6289       2.6665 
    coh50:k=5.68182,b=4.54545         2.3894        2.3978       2.4074       2.4183        2.4308        2.4451        2.5237          2.55        2.5796        2.6126        2.6494       2.6902 
    coh986:k=4.54545,b=44.3182        3.8527        3.8572       3.8622       3.8681        3.8747        3.8824        3.9256        3.9404        3.9572        3.9762        3.9977        4.022 
    coh987:k=3.40909,b=45.4545        3.8511        3.8555       3.8607       3.8666        3.8733         3.881        3.9247        3.9396        3.9566        3.9758        3.9975        4.022 
    coh988:k=2.27273,b=46.5909        3.8494        3.8539       3.8591       3.8651        3.8719        3.8797        3.9237        3.9388         3.956        3.9754        3.9973        4.022 
    coh989:k=1.13636,b=47.7273        3.8477        3.8523       3.8575       3.8635        3.8704        3.8783        3.9228         3.938        3.9553        3.9749        3.9971        4.022 
    coh990:k=0,b=48.8636               3.846        3.8506       3.8559        3.862         3.869        3.8769        3.9219        3.9372        3.9547        3.9745        3.9968       4.0219 
    coh991:k=50,b=0                   3.9209        3.9209       3.9209       3.9209        3.9209        3.9209        3.9209        3.9209        3.9209        3.9209        3.9209       3.9209 
    coh992:k=48.8636,b=1.13636        3.9263        3.9274       3.9286       3.9301        3.9318        3.9337        3.9449        3.9488        3.9532        3.9584        3.9643       3.9711 
    coh993:k=47.7273,b=2.27273        3.9265        3.9279       3.9295       3.9314        3.9336         3.936        3.9503        3.9553         3.961        3.9675         3.975       3.9836 
    coh994:k=46.5909,b=3.40909        3.9261        3.9278       3.9297       3.9318        3.9343        3.9372        3.9536        3.9594         3.966        3.9735        3.9821        3.992 
    coh995:k=45.4545,b=4.54545        3.9255        3.9273       3.9294       3.9318        3.9346        3.9378         3.956        3.9623        3.9696        3.9779        3.9875       3.9983 
    coh996:k=44.3182,b=5.68182        3.9247        3.9267       3.9289       3.9315        3.9345         3.938        3.9577        3.9646        3.9725        3.9814        3.9917       4.0035 
    coh997:k=43.1818,b=6.81818        3.9238        3.9259       3.9283       3.9311        3.9343         3.938         3.959        3.9663        3.9747        3.9843        3.9953       4.0077 
    coh998:k=42.0455,b=7.95455        3.9228         3.925       3.9276       3.9305        3.9339        3.9378          3.96        3.9678        3.9766        3.9867        3.9982       4.0114 
    coh999:k=40.9091,b=9.09091        3.9217         3.924       3.9267       3.9298        3.9334        3.9374        3.9608        3.9689        3.9781        3.9887        4.0008       4.0146 
    coh1000:k=39.7727,b=10.2273       3.9205         3.923       3.9258        3.929        3.9327         3.937        3.9613        3.9698        3.9794        3.9905         4.003       4.0174 
    coh1001:k=38.6364,b=11.3636       3.9194        3.9219       3.9248       3.9282         3.932        3.9365        3.9617        3.9705        3.9805         3.992         4.005       4.0198 
    coh1002:k=37.5,b=12.5             3.9181        3.9208       3.9238       3.9273        3.9313        3.9358         3.962        3.9711        3.9815        3.9933        4.0067       4.0221 
    coh1003:k=36.3636,b=13.6364       3.9169        3.9196       3.9227       3.9263        3.9304        3.9352        3.9622        3.9715        3.9822        3.9944        4.0083       4.0241 
    coh1004:k=35.2273,b=14.7727       3.9156        3.9184       3.9216       3.9253        3.9295        3.9344        3.9622        3.9719        3.9829        3.9954        4.0097       4.0259 
    coh1005:k=34.0909,b=15.9091       3.9143        3.9171       3.9204       3.9242        3.9286        3.9336        3.9622        3.9721        3.9834        3.9963        4.0109       4.0275 
    coh1006:k=32.9545,b=17.0455       3.9129        3.9159       3.9193       3.9232        3.9277        3.9328        3.9621        3.9722        3.9838         3.997         4.012        4.029 
    coh1007:k=31.8182,b=18.1818       3.9115        3.9146       3.9181       3.9221        3.9267        3.9319        3.9619        3.9723        3.9842        3.9976         4.013       4.0304 
    coh1008:k=30.6818,b=19.3182       3.9102        3.9133       3.9168       3.9209        3.9256         3.931        3.9617        3.9723        3.9844        3.9982        4.0139       4.0316 
    coh1009:k=29.5455,b=20.4545       3.9088        3.9119       3.9156       3.9198        3.9246        3.9301        3.9614        3.9723        3.9846        3.9987        4.0146       4.0328 
    coh1010:k=28.4091,b=21.5909       3.9073        3.9106       3.9143       3.9186        3.9235        3.9291        3.9611        3.9721        3.9847        3.9991        4.0153       4.0338 
    coh1011:k=27.2727,b=22.7273       3.9059        3.9092        3.913       3.9174        3.9224        3.9281        3.9607         3.972        3.9848        3.9994         4.016       4.0347 
    coh1012:k=26.1364,b=23.8636       3.9045        3.9078       3.9117       3.9161        3.9212        3.9271        3.9603        3.9717        3.9848        3.9996        4.0165       4.0356 
    coh1013:k=25,b=25                  3.903        3.9064       3.9104       3.9149        3.9201         3.926        3.9598        3.9715        3.9847        3.9998         4.017       4.0364 
    coh1014:k=23.8636,b=26.1364       3.9015         3.905        3.909       3.9136        3.9189        3.9249        3.9593        3.9712        3.9847             4        4.0174       4.0371 
    coh1015:k=22.7273,b=27.2727          3.9        3.9036       3.9076       3.9123        3.9177        3.9238        3.9588        3.9708        3.9845        4.0001        4.0178       4.0378 
    coh1016:k=21.5909,b=28.4091       3.8985        3.9021       3.9063        3.911        3.9165        3.9227        3.9582        3.9704        3.9843        4.0002        4.0181       4.0384 
    coh1017:k=20.4545,b=29.5455        3.897        3.9007       3.9049       3.9097        3.9152        3.9216        3.9576          3.97        3.9841        4.0002        4.0184       4.0389 
    coh1018:k=19.3182,b=30.6818       3.8955        3.8992       3.9035       3.9084         3.914        3.9205         3.957        3.9696        3.9839        4.0001        4.0186       4.0394 
    coh1019:k=18.1818,b=31.8182        3.894        3.8977       3.9021        3.907        3.9127        3.9193        3.9563        3.9691        3.9836        4.0001        4.0187       4.0399 
    coh1020:k=17.0455,b=32.9545       3.8924        3.8963       3.9006       3.9057        3.9115        3.9181        3.9557        3.9686        3.9833             4        4.0189       4.0403 
    coh1021:k=15.9091,b=34.0909       3.8909        3.8948       3.8992       3.9043        3.9102        3.9169         3.955         3.968        3.9829        3.9998         4.019       4.0406 
    coh1022:k=14.7727,b=35.2273       3.8893        3.8933       3.8978       3.9029        3.9089        3.9157        3.9542        3.9675        3.9825        3.9997         4.019       4.0409 
    coh1023:k=13.6364,b=36.3636       3.8878        3.8917       3.8963       3.9015        3.9076        3.9145        3.9535        3.9669        3.9821        3.9995        4.0191       4.0412 
    coh1024:k=12.5,b=37.5             3.8862        3.8902       3.8948       3.9001        3.9062        3.9132        3.9527        3.9663        3.9817        3.9992         4.019       4.0414 
    coh1025:k=11.3636,b=38.6364       3.8846        3.8887       3.8934       3.8987        3.9049         3.912        3.9519        3.9657        3.9813         3.999         4.019       4.0416 
    coh1026:k=10.2273,b=39.7727        3.883        3.8871       3.8919       3.8973        3.9036        3.9107        3.9511         3.965        3.9808        3.9987        4.0189       4.0418 
    coh1027:k=9.09091,b=40.9091       3.8814        3.8856       3.8904       3.8959        3.9022        3.9094        3.9503        3.9643        3.9803        3.9984        4.0188       4.0419 
    coh1028:k=7.95455,b=42.0455       3.8798         3.884       3.8889       3.8944        3.9008        3.9081        3.9495        3.9637        3.9798         3.998        4.0187        4.042 
    coh1029:k=6.81818,b=43.1818       3.8782        3.8825       3.8874        3.893        3.8995        3.9068        3.9486        3.9629        3.9792        3.9977        4.0186       4.0421 
    coh1030:k=5.68182,b=44.3182       3.8766        3.8809       3.8858       3.8915        3.8981        3.9055        3.9477        3.9622        3.9787        3.9973        4.0184       4.0422 
    coh1031:k=4.54545,b=45.4545       3.8749        3.8793       3.8843       3.8901        3.8967        3.9042        3.9469        3.9615        3.9781        3.9969        4.0182       4.0422 
    coh1032:k=3.40909,b=46.5909       3.8733        3.8777       3.8828       3.8886        3.8953        3.9029         3.946        3.9607        3.9775        3.9965         4.018       4.0422 
    coh1033:k=2.27273,b=47.7273       3.8717        3.8761       3.8812       3.8871        3.8938        3.9016         3.945          3.96        3.9769         3.996        4.0177       4.0421 
    coh1034:k=1.13636,b=48.8636         3.87        3.8745       3.8797       3.8856        3.8924        3.9002        3.9441        3.9592        3.9762        3.9956        4.0174       4.0421 
    coh1035:k=0,b=50                  3.8684        3.8729       3.8781       3.8841         3.891        3.8988        3.9432        3.9584        3.9756        3.9951        4.0172        4.042 

tb_pol_a
                                   z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                   __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                    0.12565       0.12724         0.129      0.13093      0.13304       0.13529       0.14469       0.14652       0.14768       0.14774       0.14611       0.14197 
    coh2:k=1.13636,b=0              0.44748       0.45315       0.45942      0.46631       0.4738       0.48182       0.51529       0.52183       0.52595       0.52616       0.52035        0.5056 
    coh3:k=0,b=1.13636              0.52476       0.54743       0.57374      0.60429       0.6397       0.68069       0.91478       0.99313        1.0786        1.1685        1.2578        1.3366 
    coh4:k=2.27273,b=0              0.76932       0.77906       0.78985      0.80169      0.81456       0.82835        0.8859       0.89713       0.90422       0.90458        0.8946       0.86924 
    coh5:k=1.13636,b=1.13636         0.8466       0.87334       0.90417      0.93966      0.98046        1.0272        1.2854        1.3684        1.4568         1.547         1.632        1.7003 
    coh6:k=0,b=2.27273              0.85005       0.88138       0.91763      0.95954       1.0079        1.0637        1.3774        1.4805        1.5918        1.7073        1.8196         1.915 
    coh7:k=3.40909,b=0               1.0912         1.105        1.1203       1.1371       1.1553        1.1749        1.2565        1.2724        1.2825         1.283        1.2688        1.2329 
    coh8:k=2.27273,b=1.13636         1.1684        1.1992        1.2346        1.275       1.3212        1.3738         1.656        1.7437        1.8351        1.9254        2.0063        2.0639 
    coh9:k=1.13636,b=2.27273         1.1719        1.2073         1.248       1.2949       1.3487        1.4103         1.748        1.8558          1.97        2.0858        2.1938        2.2786 
    coh10:k=0,b=3.40909              1.1669        1.2055          1.25       1.3013       1.3604        1.4282        1.8049        1.9269        2.0574        2.1912        2.3187         2.423 
    coh11:k=4.54545,b=0               1.413        1.4309        1.4507       1.4724       1.4961        1.5214        1.6271        1.6477        1.6608        1.6614        1.6431        1.5965 
    coh12:k=3.40909,b=1.13636        1.4903        1.5252         1.565       1.6104        1.662        1.7203        2.0266         2.119        2.2134        2.3038        2.3805        2.4276 
    coh13:k=2.27273,b=2.27273        1.4937        1.5332        1.5785       1.6303       1.6895        1.7568        2.1186        2.2311        2.3483        2.4642        2.5681        2.6423 
    coh14:k=1.13636,b=3.40909        1.4888        1.5314        1.5804       1.6367       1.7012        1.7748        2.1755        2.3022        2.4356        2.5696        2.6929        2.7866 
    coh15:k=0,b=4.54545              1.4797        1.5248        1.5768       1.6366       1.7052        1.7838        2.2154        2.3534        2.4998        2.6483        2.7874        2.8969 
    coh16:k=5.68182,b=0              1.7348        1.7568        1.7811       1.8078       1.8368        1.8679        1.9977        2.0231         2.039        2.0399        2.0173        1.9601 
    coh17:k=4.54545,b=1.13636        1.8121        1.8511        1.8954       1.9458       2.0027        2.0668        2.3972        2.4943        2.5917        2.6822        2.7548        2.7912 
    coh18:k=3.40909,b=2.27273        1.8156        1.8591        1.9089       1.9657       2.0302        2.1033        2.4892        2.6064        2.7266        2.8426        2.9423        3.0059 
    coh19:k=2.27273,b=3.40909        1.8106        1.8573        1.9109       1.9721       2.0419        2.1213        2.5461        2.6775        2.8139         2.948        3.0672        3.1503 
    coh20:k=1.13636,b=4.54545        1.8015        1.8507        1.9072        1.972        2.046        2.1303         2.586        2.7287        2.8781        3.0267        3.1616        3.2606 
    coh21:k=0,b=5.68182                1.79        1.8412        1.9002       1.9678       2.0453        2.1338        2.6155        2.7678        2.9281        3.0891        3.2374          3.35 
    coh22:k=6.81818,b=0              2.0567        2.0827        2.1115       2.1432       2.1776        2.2145        2.3683        2.3984        2.4173        2.4183        2.3916        2.3238 
    coh23:k=5.68182,b=1.13636        2.1339         2.177        2.2259       2.2812       2.3435        2.4133        2.7678        2.8697        2.9699        3.0607         3.129        3.1548 
    coh24:k=4.54545,b=2.27273        2.1374         2.185        2.2393       2.3011        2.371        2.4498        2.8598        2.9817        3.1049         3.221        3.3166        3.3695 
    coh25:k=3.40909,b=3.40909        2.1324        2.1832        2.2413       2.3075       2.3827        2.4678        2.9167        3.0528        3.1922        3.3264        3.4414        3.5139 
    coh26:k=2.27273,b=4.54545        2.1234        2.1766        2.2376       2.3073       2.3867        2.4768        2.9566         3.104        3.2564        3.4052        3.5358        3.6242 
    coh27:k=1.13636,b=5.68182        2.1118        2.1672        2.2306       2.3032       2.3861        2.4803        2.9861        3.1431        3.3064        3.4676        3.6116        3.7136 
    coh28:k=0,b=6.81818              2.0986        2.1557        2.2212       2.2963       2.3822          2.48        3.0084        3.1738        3.3467        3.5187        3.6746        3.7887 
    coh29:k=7.95455,b=0              2.3785        2.4086         2.442       2.4786       2.5184         2.561        2.7389        2.7737        2.7956        2.7967        2.7658        2.6874 
    coh30:k=6.81818,b=1.13636        2.4558        2.5029        2.5563       2.6166       2.6843        2.7599        3.1384         3.245        3.3482        3.4391        3.5033        3.5185 
    coh31:k=5.68182,b=2.27273        2.4592        2.5109        2.5697       2.6364       2.7118        2.7964        3.2304         3.357        3.4831        3.5995        3.6908        3.7332 
    coh32:k=4.54545,b=3.40909        2.4543        2.5091        2.5717       2.6428       2.7235        2.8144        3.2873        3.4281        3.5704        3.7049        3.8157        3.8776 
    coh33:k=3.40909,b=4.54545        2.4452        2.5026        2.5681       2.6427       2.7275        2.8234        3.3272        3.4793        3.6346        3.7836        3.9101        3.9879 
    coh34:k=2.27273,b=5.68182        2.4337        2.4931         2.561       2.6386       2.7269        2.8269        3.3567        3.5184        3.6847         3.846        3.9859        4.0773 
    coh35:k=1.13636,b=6.81818        2.4204        2.4816        2.5516       2.6317        2.723        2.8266         3.379        3.5491         3.725        3.8972        4.0489        4.1523 
    coh36:k=0,b=7.95455              2.4058        2.4686        2.5405       2.6228       2.7167        2.8235         3.396        3.5736        3.7581        3.9401        4.1024        4.2168 
    coh37:k=9.09091,b=0              2.7003        2.7345        2.7724        2.814       2.8591        2.9075        3.1095         3.149        3.1739        3.1751        3.1401        3.0511 
    coh38:k=7.95455,b=1.13636        2.7776        2.8288        2.8867       2.9519        3.025        3.1064         3.509        3.6203        3.7265        3.8175        3.8775        3.8821 
    coh39:k=6.81818,b=2.27273        2.7811        2.8368        2.9002       2.9718       3.0525        3.1429         3.601        3.7323        3.8614        3.9779        4.0651        4.0968 
    coh40:k=5.68182,b=3.40909        2.7761         2.835        2.9021       2.9782       3.0642        3.1609        3.6579        3.8034        3.9487        4.0833        4.1899        4.2412 
    coh41:k=4.54545,b=4.54545        2.7671        2.8285        2.8985       2.9781       3.0683        3.1699        3.6978        3.8546        4.0129         4.162        4.2843        4.3515 
    coh42:k=3.40909,b=5.68182        2.7555         2.819        2.8915        2.974       3.0676        3.1734        3.7273        3.8937         4.063        4.2244        4.3601        4.4409 
    coh43:k=2.27273,b=6.81818        2.7422        2.8075        2.8821       2.9671       3.0637        3.1731        3.7496        3.9244        4.1033        4.2756        4.4231         4.516 
    coh44:k=1.13636,b=7.95455        2.7277        2.7945        2.8709       2.9582       3.0575          3.17        3.7666        3.9489        4.1364        4.3185        4.4766        4.5804 
    coh45:k=0,b=9.09091              2.7122        2.7804        2.8585       2.9477       3.0494        3.1648        3.7796        3.9686         4.164        4.3549        4.5228        4.6367 
    coh46:k=10.2273,b=0              3.0222        3.0604        3.1028       3.1493       3.1999         3.254        3.4801        3.5243        3.5521        3.5535        3.5143        3.4147 
    coh47:k=9.09091,b=1.13636        3.0995        3.1547        3.2171       3.2873       3.3658        3.4529        3.8796        3.9956        4.1047        4.1959        4.2518        4.2457 
    coh48:k=7.95455,b=2.27273        3.1029        3.1627        3.2306       3.3072       3.3933        3.4894        3.9716        4.1076        4.2397        4.3563        4.4393        4.4604 
    coh49:k=6.81818,b=3.40909        3.0979        3.1609        3.2325       3.3136        3.405        3.5074        4.0285        4.1787         4.327        4.4617        4.5642        4.6048 
    coh50:k=5.68182,b=4.54545        3.0889        3.1544        3.2289       3.3135        3.409        3.5164        4.0684        4.2299        4.3912        4.5404        4.6586        4.7151 
    coh986:k=4.54545,b=44.3182       13.346        13.575        13.833       14.122       14.445        14.802        16.529        16.988        17.413        17.754         17.94         17.86 
    coh987:k=3.40909,b=45.4545       13.323        13.553        13.811       14.101       14.424        14.782        16.514        16.975        17.402        17.747        17.937         17.86 
    coh988:k=2.27273,b=46.5909       13.301        13.531        13.789        14.08       14.403        14.762        16.499        16.962        17.392         17.74        17.933         17.86 
    coh989:k=1.13636,b=47.7273       13.279        13.509        13.767       14.058       14.383        14.742        16.483        16.949        17.381        17.732        17.928         17.86 
    coh990:k=0,b=48.8636             13.257        13.486        13.746       14.037       14.362        14.722        16.468        16.935         17.37        17.723        17.923        17.859 
    coh991:k=50,b=0                  14.286        14.467        14.668       14.888       15.127        15.383        16.451         16.66        16.792        16.798        16.613        16.142 
    coh992:k=48.8636,b=1.13636       14.364        14.562        14.782       15.026       15.292        15.581        16.851        17.131        17.344        17.441         17.35        16.973 
    coh993:k=47.7273,b=2.27273       14.367         14.57        14.795       15.045        15.32        15.618        16.943        17.243        17.479        17.601        17.538        17.188 
    coh994:k=46.5909,b=3.40909       14.362        14.568        14.797       15.052       15.332        15.636            17        17.314        17.566        17.706        17.663        17.332 
    coh995:k=45.4545,b=4.54545       14.353        14.561        14.794       15.052       15.336        15.645         17.04        17.366        17.631        17.785        17.757        17.442 
    coh996:k=44.3182,b=5.68182       14.342        14.552        14.787       15.048       15.335        15.648        17.069        17.405        17.681        17.848        17.833        17.532 
    coh997:k=43.1818,b=6.81818       14.328         14.54        14.777       15.041       15.331        15.648        17.091        17.435        17.721        17.899        17.896        17.607 
    coh998:k=42.0455,b=7.95455       14.314        14.527        14.766       15.032       15.325        15.645        17.108         17.46        17.754        17.942        17.949        17.671 
    coh999:k=40.9091,b=9.09091       14.298        14.513        14.754       15.021       15.317         15.64        17.121         17.48        17.782        17.978        17.996        17.728 
    coh1000:k=39.7727,b=10.2273      14.282        14.498         14.74        15.01       15.307        15.633        17.131        17.495        17.805        18.009        18.036        17.777 
    coh1001:k=38.6364,b=11.3636      14.265        14.482        14.726       14.997       15.296        15.624        17.138        17.508        17.824        18.037        18.071        17.822 
    coh1002:k=37.5,b=12.5            14.247        14.466        14.711       14.983       15.285        15.615        17.143        17.518        17.841         18.06        18.103        17.861 
    coh1003:k=36.3636,b=13.6364       14.23        14.449        14.695       14.969       15.272        15.604        17.145        17.526        17.854        18.081        18.131        17.897 
    coh1004:k=35.2273,b=14.7727      14.211        14.431        14.678       14.954       15.258        15.593        17.146        17.532        17.866        18.098        18.156        17.929 
    coh1005:k=34.0909,b=15.9091      14.192        14.413        14.661       14.938       15.244         15.58        17.146        17.536        17.875        18.114        18.178        17.959 
    coh1006:k=32.9545,b=17.0455      14.173        14.395        14.644       14.922        15.23        15.567        17.144        17.539        17.883        18.127        18.198        17.986 
    coh1007:k=31.8182,b=18.1818      14.154        14.377        14.627       14.905       15.214        15.554        17.141         17.54        17.889        18.139        18.216         18.01 
    coh1008:k=30.6818,b=19.3182      14.134        14.358        14.609       14.888       15.199         15.54        17.137         17.54        17.894        18.149        18.232        18.033 
    coh1009:k=29.5455,b=20.4545      14.115        14.339         14.59       14.871       15.183        15.525        17.132        17.539        17.897        18.157        18.246        18.053 
    coh1010:k=28.4091,b=21.5909      14.095        14.319        14.572       14.853       15.166         15.51        17.127        17.536        17.899        18.165        18.259        18.072 
    coh1011:k=27.2727,b=22.7273      14.074          14.3        14.553       14.835       15.149        15.494         17.12        17.533          17.9        18.171         18.27        18.089 
    coh1012:k=26.1364,b=23.8636      14.054         14.28        14.534       14.817       15.132        15.478        17.113         17.53          17.9        18.175         18.28        18.105 
    coh1013:k=25,b=25                14.033         14.26        14.514       14.799       15.115        15.462        17.105        17.525        17.899        18.179        18.289        18.119 
    coh1014:k=23.8636,b=26.1364      14.013         14.24        14.495        14.78       15.097        15.446        17.096        17.519        17.898        18.182        18.297        18.132 
    coh1015:k=22.7273,b=27.2727      13.992        14.219        14.475       14.761       15.079        15.429        17.087        17.513        17.895        18.184        18.304        18.144 
    coh1016:k=21.5909,b=28.4091      13.971        14.199        14.455       14.742        15.06        15.411        17.077        17.507        17.892        18.185        18.309        18.155 
    coh1017:k=20.4545,b=29.5455       13.95        14.178        14.435       14.723       15.042        15.394        17.067        17.499        17.888        18.185        18.314        18.165 
    coh1018:k=19.3182,b=30.6818      13.929        14.158        14.415       14.703       15.023        15.376        17.056        17.491        17.884        18.184        18.318        18.174 
    coh1019:k=18.1818,b=31.8182      13.907        14.137        14.395       14.683       15.004        15.358        17.045        17.483        17.879        18.183        18.321        18.182 
    coh1020:k=17.0455,b=32.9545      13.886        14.116        14.374       14.663       14.985         15.34        17.034        17.474        17.873        18.181        18.324        18.189 
    coh1021:k=15.9091,b=34.0909      13.865        14.095        14.353       14.643       14.966        15.322        17.022        17.465        17.867        18.179        18.326        18.196 
    coh1022:k=14.7727,b=35.2273      13.843        14.073        14.333       14.623       14.946        15.303         17.01        17.455         17.86        18.176        18.327        18.201 
    coh1023:k=13.6364,b=36.3636      13.821        14.052        14.312       14.603       14.927        15.285        16.997        17.445        17.853        18.172        18.327        18.206 
    coh1024:k=12.5,b=37.5              13.8        14.031        14.291       14.582       14.907        15.266        16.984        17.434        17.845        18.168        18.327         18.21 
    coh1025:k=11.3636,b=38.6364      13.778        14.009         14.27       14.562       14.887        15.246        16.971        17.423        17.837        18.163        18.326        18.214 
    coh1026:k=10.2273,b=39.7727      13.756        13.988        14.249       14.541       14.867        15.227        16.957        17.412        17.829        18.158        18.325        18.217 
    coh1027:k=9.09091,b=40.9091      13.734        13.966        14.227        14.52       14.847        15.208        16.943          17.4         17.82        18.152        18.323         18.22 
    coh1028:k=7.95455,b=42.0455      13.712        13.944        14.206         14.5       14.827        15.188        16.929        17.388        17.811        18.146        18.321        18.221 
    coh1029:k=6.81818,b=43.1818       13.69        13.922        14.185       14.479       14.806        15.169        16.914        17.376        17.801         18.14        18.318        18.223 
    coh1030:k=5.68182,b=44.3182      13.668          13.9        14.163       14.457       14.786        15.149          16.9        17.364        17.791        18.133        18.315        18.224 
    coh1031:k=4.54545,b=45.4545      13.645        13.879        14.141       14.436       14.765        15.129        16.885        17.351        17.781        18.126        18.311        18.224 
    coh1032:k=3.40909,b=46.5909      13.623        13.857         14.12       14.415       14.744        15.109         16.87        17.338         17.77        18.118        18.307        18.224 
    coh1033:k=2.27273,b=47.7273      13.601        13.834        14.098       14.394       14.723        15.088        16.854        17.324        17.759         18.11        18.302        18.223 
    coh1034:k=1.13636,b=48.8636      13.578        13.812        14.076       14.372       14.702        15.068        16.838        17.311        17.748        18.102        18.298        18.222 
    coh1035:k=0,b=50                 13.556         13.79        14.054       14.351       14.681        15.048        16.823        17.297        17.736        18.093        18.292        18.221 

</pre><h2 id="8">Generate and Save Graphs</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph)
    bl_input_override = true;
    ff_akz_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_akz_vf_post_01.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_02.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_03.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_04.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_05.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_06.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_07.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_08.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_09.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_post_10.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function [result_map] = ff_akz_vf_post(varargin)
%% FF_AKZ_VF_POST post ff_akz_vf graphs, tables, mats.
% Given the solution form ff_akz_vf, graphs, tables, mats. Graphing code is
% separately in ff_akz_vf_post_graph.m. Run this function directly with
% randomly generates matrixes for graph/table testings.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @param result_map container contains policy function matrix, value
% function matrix, iteration results
%
% @return result_map container add coh consumption and other matrixes to
% result_map also add table versions of val pol and iter matries 
%
% @example
%
%    bl_input_override = true;
%    result_map = containers.Map('KeyType','char', 'ValueType','any');
%    result_map('mt_val') = mt_val;
%    result_map('mt_pol_a') = mt_pol_a;
%    result_map('mt_pol_k') = mt_pol_k;
%    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
%    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
%    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
%    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post_graph.m ff_akz_vf_post_graph>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m ffs_akz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m ffs_akz_get_funcgrid>
%

%% Default

params_len = length(varargin);
bl_input_override = 0;
if (params_len == 6)
    bl_input_override = varargin{6};
end

if (bl_input_override)
    % if invoked from outside overrid fully
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};
    
    params_group = values(result_map, {'mt_val', 'mt_pol_a', 'mt_pol_k'});
    [mt_val, mt_pol_a, mt_pol_k] = params_group{:};
    params_group = values(result_map, {'ar_val_diff_norm', 'ar_pol_diff_norm', 'mt_pol_perc_change'});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};
    
    % Get Parameters
    params_group = values(param_map, {'it_z_n'});
    [it_z_n] = params_group{:};
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z', 'mt_coh', 'it_ameshk_n'});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    
else
    clear all;
    close all;
    
    % internal invoke for testing
    it_param_set = 4;
    bl_input_override = true;
    
    % Get Parameters
    [param_map, support_map] = ffs_akz_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generate Default val and policy matrixes
    params_group = values(param_map, {'it_maxiter_val', 'it_z_n'});
    [it_maxiter_val, it_z_n] = params_group{:};    
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z', 'mt_coh', 'it_ameshk_n'});
    [ar_a_meshk, ar_k_mesha, ar_z, mt_coh, it_ameshk_n] = params_group{:};
    params_group = values(func_map, {'f_util_standin', 'f_cons', 'f_coh'});
    [f_util_standin, f_cons, f_coh] = params_group{:};    
    
    % Set Defaults
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_pol_aksum = mt_coh.*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    mt_pol_a = mt_pol_aksum.*(0.7 - cumsum(sort(ar_z))/sum(ar_z)*0.3);
    mt_pol_k = mt_pol_aksum - mt_pol_a;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);
    
    % Set Results Map
    result_map = containers.Map('KeyType','char', 'ValueType','any');
    result_map('mt_val') = mt_val;
    result_map('mt_pol_a') = mt_pol_a;
    result_map('mt_pol_k') = mt_pol_k;
end

%% Parse Parameter

% support_map
params_group = values(support_map, {'bl_display_final', 'it_display_final_rowmax', 'it_display_final_colmax'});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {'bl_graph', 'bl_graph_onebyones'});
[bl_graph] = params_group{:};
params_group = values(support_map, {'bl_mat', 'st_mat_path', 'st_mat_prefix', 'st_mat_name_main', 'st_mat_suffix'});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

% func_map
params_group = values(func_map, {'f_inc', 'f_cons', 'f_coh'});
[f_inc, f_cons, f_coh] = params_group{:};

%% Generate Consumption and Income Matrix

mt_cons = f_cons(mt_coh, mt_pol_a, mt_pol_k);
mt_incm = f_inc(ar_z, ar_a_meshk, ar_k_mesha);
result_map('mt_cons') = mt_cons;
result_map('mt_incm') = mt_incm;

%% Save Mat

if (bl_mat)
    mkdir(support_map('st_mat_path'));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
end

%% Display Val Pol Iter Table

if (bl_display_final)
    
    % Display Value Function Iteration Step by Step REsults
    it_iter_max = length(ar_val_diff_norm);
    if (it_iter_max >= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];        
    else
        ar_it_rows_iter = 1:1:it_iter_max;
    end
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';...
                                     ar_pol_diff_norm(ar_it_rows_iter)';...
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');
                                 
    cl_col_names = ['valgap', 'polgap', strcat('z', string((1:it_z_n)))];
    cl_row_names = strcat('iter=', string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{'valgap'} = 'norm(mt_val - mt_val_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'polgap'} = 'norm(mt_pol_a - mt_pol_a_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'z1'} = 'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)';
    
    disp('valgap = norm(mt_val - mt_val_cur)');
    disp('polgap = norm(mt_pol_a - mt_pol_a_cur)');
    disp('z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)');   
    disp(tb_valpol_alliter);
    
    % Display Values by States
    % at most display 11 columns of shocks
    % at most display 50 rows for states
    % display first and last
    if (it_ameshk_n >= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_ameshk_n)-round(it_display_final_rowmax/2)+1):1:(it_ameshk_n)];
    else
        ar_it_rows = 1:1:it_ameshk_n;
    end
    if (it_z_n >= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    else
        ar_it_cols = 1:1:it_z_n;
    end
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);
    
    % Display Optimal Values
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat('coh', string(ar_it_rows),...
                                        ':k=', string(ar_a_meshk(ar_it_rows)'),...
                                        ',b=', string(ar_k_mesha(ar_it_rows)'));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_val');
    disp(tb_val);
    
    % Display Optimal Choices
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat('coh', string(ar_it_rows),...
                                        ':k=', string(ar_a_meshk(ar_it_rows)'),...
                                        ',b=', string(ar_k_mesha(ar_it_rows)'));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_pol_a');
    disp(tb_pol_a);
    
    % Save to result map
    result_map('tb_valpol_alliter') = tb_valpol_alliter;
    result_map('tb_val') = tb_val;
    result_map('tb_pol_a') = tb_pol_a;
end

%% Generate and Save Graphs

if (bl_graph)
    bl_input_override = true;
    ff_akz_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>