
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_iwkz_vf</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-03"><meta name="DC.source" content="ff_iwkz_vf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_IWKZ_VF solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Pre-calculate u(c)</a></li><li><a href="#9">Iterate Value Function</a></li><li><a href="#11">Solve Second Stage Problem k*(w,z)</a></li><li><a href="#12">Solve First Stage Problem w*(z) given k*(w,z)</a></li><li><a href="#13">Check Tolerance and Continuation</a></li><li><a href="#15">Process Optimal Choices</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> result_map = ff_iwkz_vf(varargin)
</pre><h2 id="2">FF_IWKZ_VF solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the two step solution with interpolation version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_akz_vf.html">ff_akz_vf</a>. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html">ff_wkz_evf</a> for details about the second stage.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m">ffs_akz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m">ffs_akz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_akz_set_default_param(it_param_set);

<span class="comment">% parameters can be set inside ffs_akz_set_default_param or updated here</span>
param_map(<span class="string">'it_w_n'</span>) = 50;
param_map(<span class="string">'it_ak_n'</span>) = param_map(<span class="string">'it_w_n'</span>);
param_map(<span class="string">'it_z_n'</span>) = 15;
param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 0.025;
param_map(<span class="string">'it_c_interp_grid_gap'</span>) = 10^-4;

<span class="comment">% get armt and func map</span>
[armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_iwkz_vf'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_w'</span>, <span class="string">'ar_z'</span>});
[ar_w, ar_z] = params_group{:};
params_group = values(armt_map, {<span class="string">'ar_interp_c_grid'</span>, <span class="string">'ar_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z'</span>, <span class="string">'mt_z_mesh_coh_interp_grid'</span>});
[ar_interp_c_grid, ar_interp_coh_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {<span class="string">'mt_coh_wkb'</span>, <span class="string">'mt_z_mesh_coh_wkb'</span>});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>,<span class="keyword">...</span>
    <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Pre-calculate u(c)</h2><p>Interpolation, see <a href="https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html">fs_u_c_partrepeat_main</a> for why interpolate over u(c)</p><pre class="codeinput"><span class="comment">% Evaluate</span>
<span class="keyword">if</span> (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_neg_c = f_util_log(fl_c_min);
<span class="keyword">else</span>
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_neg_c = f_util_crra(fl_c_min);
<span class="keyword">end</span>
ar_interp_u_of_c_grid(ar_interp_c_grid &lt;= fl_c_min) = fl_u_neg_c;

<span class="comment">% Get Interpolant</span>
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, <span class="string">'spline'</span>);
</pre><h2 id="9">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="11">Solve Second Stage Problem k*(w,z)</h2><p>This is the key difference between this function and <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> which solves the two stages jointly Interpolation first, because solution coh grid is not the same as all points reachable by k and b choices given w.</p><pre class="codeinput">    f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', <span class="string">'linear'</span>);
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);

    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = <span class="keyword">...</span>
        ff_wkz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
</pre><h2 id="12">Solve First Stage Problem w*(z) given k*(w,z)</h2><p>loop 1: over exogenous states</p><pre class="codeinput">    <span class="keyword">for</span> it_z_i = 1:length(ar_z)

        <span class="comment">% Get 2nd Stage Arrays</span>
        ar_ev_condi_z_max_z = mt_ev_condi_z_max(:, it_z_i);
        ar_w_kstar_z = mt_ev_condi_z_max_kp(:, it_z_i);
        ar_w_astar_z = mt_ev_condi_z_max_bp(:, it_z_i);

        <span class="comment">% loop 2: over endogenous states</span>
        <span class="keyword">for</span> it_coh_interp_j = 1:length(ar_interp_coh_grid)
            <span class="comment">% Get cash-on-hand which include k,b,z</span>
            fl_coh = mt_interp_coh_grid_mesh_z(it_coh_interp_j, it_z_i);

            <span class="comment">% loop 3: over choices, only w vector</span>
            <span class="comment">% we choose w(z), know from ff_wkz_evf k*(w,z), b*=w-k*</span>
            ar_val_cur = zeros(size(ar_w));
            <span class="keyword">for</span> it_cohp_k = 1:length(ar_w)
                fl_w_kstar_z = ar_w_kstar_z(it_cohp_k);
                fl_w_astar_z = ar_w_astar_z(it_cohp_k);

                <span class="comment">% consumption</span>
                fl_c = f_cons(fl_coh, fl_w_astar_z, fl_w_kstar_z);

                <span class="comment">% loop 4: add future utility, integration already done in</span>
                <span class="comment">% ff_wkz_evf</span>
                fl_ev_condi_z_max_z = ar_ev_condi_z_max_z(it_cohp_k);
                ar_val_cur(it_cohp_k) = f_grid_interpolant_spln(fl_c) + fl_beta*fl_ev_condi_z_max_z;

                <span class="comment">% Replace if negative consumption</span>
                <span class="keyword">if</span> fl_c &lt;= 0
                    ar_val_cur(it_cohp_k) = fl_u_neg_c;
                <span class="keyword">end</span>

            <span class="keyword">end</span>

            <span class="comment">% maximization over loop 3 choices for loop 1+2 states</span>
            it_max_lin_idx = find(ar_val_cur == max(ar_val_cur));
            mt_val(it_coh_interp_j,it_z_i) = ar_val_cur(it_max_lin_idx(1));
            mt_pol_a(it_coh_interp_j,it_z_i) = ar_w_astar_z(it_max_lin_idx(1));
            mt_pol_k(it_coh_interp_j,it_z_i) = ar_w_kstar_z(it_max_lin_idx(1));

        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="13">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/length(ar_interp_coh_grid);
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/length(ar_interp_coh_grid);
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
                                      mean(mt_pol_a_cur,1); <span class="keyword">...</span>
                                      mean(mt_pol_k_cur,1); <span class="keyword">...</span>
                                      mt_val_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeoutput">VAL it_iter:5, fl_diff:1.382672e+02, fl_diff_pol:3.203229e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    4.8271    4.8512     4.879    4.9104    4.9443    4.9811    5.0206    5.0631    5.1083    5.1564    5.2074    5.2611    5.3172    5.3745    5.4298
    map     19.764    19.719    18.711    18.648    17.648    17.527    16.584    15.615     14.19    12.925     11.33    9.7601     8.284    6.3765    4.7119
    mak     1.9843    1.9838    2.9387    2.9369     3.867    3.9057    4.7582     5.625    6.9355     8.073    9.5231    10.934    12.233    13.953     15.43
    Hval    6.3899    6.3947    6.4003    6.4069    6.4143    6.4227    6.4322     6.443    6.4555    6.4696    6.4853    6.5029    6.5223    6.5435    6.5647
    Hap     41.837    41.837    40.816    40.816    39.796    39.796    38.776    36.735    34.694    33.673    31.633    29.592    26.531    23.469    20.408
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    8.1633    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:10, fl_diff:7.776052e+01, fl_diff_pol:1.012313e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    6.9533     7.012     7.079    7.1529     7.232    7.3164    7.4063    7.5017    7.6028    7.7098     7.823    7.9423    8.0666    8.1924    8.3122
    map     22.264    22.223    21.219    21.162    20.169    20.062    19.117    18.145    16.788    15.431    13.831    12.241    10.676    8.6472    6.8318
    mak     1.9869    1.9874    2.9436    2.9427    3.8756    3.9146    4.7833     5.669    6.9332     8.188    9.6743    11.138    12.565    14.442    16.109
    Hval    9.7426    9.7591    9.7783       9.8    9.8237    9.8497    9.8783    9.9097    9.9449    9.9837    10.026    10.072    10.122    10.175    10.226
    Hap     46.939    46.939    45.918    45.918    44.898    44.898    43.878    42.857    39.796    38.776    36.735    34.694    32.653    29.592    26.531
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    8.1633    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:15, fl_diff:4.799012e+01, fl_diff_pol:5.299510e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.2315    8.3098    8.3988    8.4965    8.6008    8.7119      8.83    8.9553    9.0882    9.2295    9.3794    9.5375     9.702    9.8682    10.026
    map      22.99    22.952    21.954    21.908     20.92    20.785     19.89     18.93    17.527    16.235    14.669    12.998    11.473    9.4297    7.5842
    mak     1.9892    1.9896    2.9459    2.9459    3.8796    3.9609      4.79    5.6789    7.0032    8.2086     9.682    11.248    12.656    14.576    16.306
    Hval    11.742    11.769    11.799    11.833     11.87    11.911    11.954    12.002    12.054    12.111    12.173    12.241    12.313    12.389    12.464
    Hap     47.959    47.959    46.939    46.939    45.918    45.918    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    27.551
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:20, fl_diff:3.103111e+01, fl_diff_pol:3.970501e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0677    9.1556    9.2556    9.3655    9.4827    9.6077    9.7405    9.8816    10.032    10.191    10.361     10.54    10.727    10.915    11.096
    map     23.281    23.248    22.255    22.212    21.233    21.064    20.217    19.267    17.938    16.591    14.969    13.367    11.846    9.7942    7.9226
    mak      1.991    1.9914    2.9481    2.9481    3.8828    4.0026    4.7936    5.6816    6.9453    8.2162    9.7556     11.27    12.693     14.64     16.41
    Hval    12.983    13.016    13.055    13.098    13.144    13.195     13.25     13.31    13.375    13.445    13.522    13.605    13.694    13.787    13.879
    Hap     47.959    47.959    46.939    46.939    45.918    45.918    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:25, fl_diff:2.066318e+01, fl_diff_pol:2.551424e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.6336    9.7261    9.8316    9.9474    10.071    10.203    10.343    10.493    10.652    10.822    11.002    11.192    11.391    11.593    11.785
    map      23.42     23.39    22.399     22.36    21.385    21.159    20.375    19.429    18.052    16.767    15.131    13.572    12.036    9.9855    8.0856
    mak     1.9919    1.9919     2.949    2.9494    3.8837    4.0619     4.795    5.6834     7.001    8.2198    9.7816    11.257    12.707    14.666    16.474
    Hval    13.778    13.815    13.858    13.906    13.958    14.015    14.077    14.143    14.216    14.296    14.383    14.476    14.577    14.682    14.785
    Hap     47.959    47.959    46.939    46.939    45.918    45.918    44.898    43.878    41.837    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    8.1633    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:30, fl_diff:1.406309e+01, fl_diff_pol:2.052783e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.024    10.119    10.227    10.346    10.473    10.609    10.753    10.907    11.071    11.245    11.431    11.628    11.834    12.042    12.242
    map     23.492    23.465    22.474    22.436    21.464    21.241    20.458    19.517    18.138     16.86    15.207    13.693    12.142    10.089    8.1906
    mak     1.9919    1.9923    2.9494    2.9494    3.8837    4.0619    4.7954    5.6843    7.0041    8.2207    9.8041    11.242    12.713    14.679    16.494
    Hval    14.298    14.338    14.384    14.435     14.49    14.551    14.617    14.689    14.767    14.853    14.945    15.046    15.153    15.265    15.375
    Hap     47.959    47.959    46.939    46.939    45.918    45.918    44.898    43.878    41.837    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    8.1633    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:35, fl_diff:9.737967e+00, fl_diff_pol:2.388698e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.297    10.393    10.502    10.623    10.752    10.889    11.036    11.192    11.358    11.536    11.725    11.925    12.134    12.347     12.55
    map     23.527    23.501     22.51    22.475    21.502    21.301    20.502    19.564    18.207    16.911    15.261     13.73      12.2     10.15    8.1911
    mak     1.9923    1.9923    2.9494    2.9494    3.8846    4.0421    4.7959    5.6852    6.9862    8.2207    9.8054    11.263    12.715    14.683     16.56
    Hval     14.64    14.682     14.73    14.783    14.841    14.905    14.974     15.05    15.131     15.22    15.317    15.421    15.533     15.65    15.764
    Hap     47.959    47.959    46.939    46.939    45.918    45.918    44.898    43.878    41.837    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816    4.0816     5.102    6.1224    8.1633    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:40, fl_diff:6.869713e+00, fl_diff_pol:1.420635e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     10.49    10.587    10.698    10.819    10.948    11.087    11.234    11.391    11.559    11.738    11.929    12.131    12.342    12.556    12.762
    map     23.543    23.516    22.528    22.492    21.521    21.295    20.524    19.586    18.253    16.935    15.288    13.759    12.231    10.182    8.2234
    mak     1.9923    1.9923    2.9494    2.9499     3.885    4.0691    4.7959    5.6852    6.9633    8.2212    9.8059    11.264    12.716    14.685    16.563
    Hval    14.869    14.911     14.96    15.015    15.075     15.14    15.211    15.289    15.373    15.464    15.563     15.67    15.785    15.904    16.021
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:45, fl_diff:4.911965e+00, fl_diff_pol:4.081633e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     10.63    10.727    10.838    10.959    11.089    11.228    11.376    11.534    11.702    11.881    12.073    12.276    12.488    12.703     12.91
    map      23.55    23.523    22.537    22.501     21.53    21.303    20.534    19.597    18.263    16.947    15.299     13.79    12.244    10.198    8.2194
    mak     1.9923    1.9923    2.9499    2.9503     3.885      4.07    4.7959    5.6852    6.9637    8.2221    9.8059    11.246    12.717    14.686    16.584
    Hval    15.027     15.07    15.119    15.175    15.235    15.301    15.374    15.452    15.537    15.629    15.729    15.838    15.954    16.076    16.194
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:50, fl_diff:3.543592e+00, fl_diff_pol:1.353637e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.731    10.828    10.939     11.06    11.191     11.33    11.478    11.636    11.804    11.984    12.176    12.379    12.592    12.808    13.015
    map     23.553    23.527    22.541    22.506    21.534    21.327    20.538    19.601    18.251    16.955    15.305    13.799     12.25    10.204    8.2086
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0511    4.7959    5.6852     6.983    8.2221    9.8068    11.246    12.717    14.686    16.604
    Hval    15.138    15.181    15.231    15.287    15.348    15.414    15.487    15.566    15.651    15.744    15.845    15.954    16.071    16.193    16.312
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:55, fl_diff:2.571453e+00, fl_diff_pol:2.463483e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.804    10.901    11.012    11.134    11.264    11.403    11.552     11.71    11.878    12.058     12.25    12.454    12.667    12.883    13.091
    map     23.554    23.529    22.542    22.507    21.535    21.328     20.54    19.604    18.254    16.957    15.308      13.8    12.254    10.208    8.2122
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8068    11.246    12.717    14.687    16.606
    Hval    15.217    15.261    15.311    15.367    15.428    15.494    15.567    15.646    15.732    15.825    15.926    16.036    16.153    16.276    16.395
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:60, fl_diff:1.873320e+00, fl_diff_pol:3.061224e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.858    10.955    11.066    11.188    11.318    11.457    11.606    11.764    11.932    12.112    12.305    12.508    12.721    12.938    13.145
    map     23.555    23.529    22.543    22.508    21.536    21.329    20.541    19.604    18.255    16.958    15.311    13.803    12.255    10.209    8.2144
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8068    11.247    12.717    14.687    16.605
    Hval    15.275    15.318    15.368    15.424    15.485    15.552    15.625    15.704     15.79    15.883    15.984    16.094    16.212    16.334    16.454
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    28.571
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    21.429

</pre><pre class="codeoutput">VAL it_iter:65, fl_diff:1.368216e+00, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.897    10.994    11.105    11.227    11.357    11.496    11.645    11.803    11.972    12.152    12.344    12.548    12.761    12.977    13.185
    map     23.555    23.529    22.544    22.508    21.537     21.33    20.541    19.605    18.256    16.959    15.311    13.803    12.257    10.209    8.2486
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.573
    Hval    15.316    15.359    15.409    15.465    15.527    15.593    15.666    15.746    15.831    15.925    16.026    16.136    16.254    16.377    16.496
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:70, fl_diff:1.000980e+00, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.925    11.023    11.134    11.256    11.386    11.525    11.674    11.832        12    12.181    12.373    12.576    12.789    13.006    13.213
    map     23.555     23.53    22.544    22.509    21.537     21.33    20.542    19.605    18.256     16.96    15.312    13.803    12.257     10.21    8.2297
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.346    15.389     15.44    15.496    15.557    15.624    15.697    15.776    15.862    15.955    16.056    16.166    16.284    16.407    16.527
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:75, fl_diff:7.331155e-01, fl_diff_pol:1.020408e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.946    11.044    11.155    11.276    11.407    11.546    11.695    11.853    12.021    12.202    12.394    12.597    12.811    13.027    13.235
    map     23.556     23.53    22.544    22.509    21.537     21.33    20.542    19.605    18.257     16.96    15.312    13.804    12.257     10.21    8.2302
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.368    15.411    15.462    15.518    15.579    15.646    15.719    15.798    15.884    15.977    16.078    16.189    16.307    16.429    16.549
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:80, fl_diff:5.373171e-01, fl_diff_pol:1.020408e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.962    11.059     11.17    11.292    11.422    11.561     11.71    11.868    12.037    12.217    12.409    12.613    12.826    13.042     13.25
    map     23.556     23.53    22.544    22.509    21.537     21.33    20.542    19.605    18.257     16.96    15.312    13.804    12.257    10.211    8.2302
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.384    15.428    15.478    15.534    15.595    15.662    15.735    15.814      15.9    15.993    16.095    16.205    16.323    16.445    16.565
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:85, fl_diff:3.939954e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.973     11.07    11.181    11.303    11.434    11.573    11.721    11.879    12.048    12.228     12.42    12.624    12.837    13.054    13.261
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2302
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.396    15.439    15.489    15.545    15.607    15.674    15.747    15.826    15.912    16.005    16.106    16.217    16.335    16.457    16.577
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:90, fl_diff:2.889890e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.981    11.079    11.189    11.311    11.442    11.581    11.729    11.888    12.056    12.237    12.429    12.632    12.846    13.062     13.27
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.405    15.448    15.498    15.554    15.615    15.682    15.755    15.834     15.92    16.014    16.115    16.225    16.343    16.466    16.585
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:95, fl_diff:2.120093e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.987    11.085    11.196    11.318    11.448    11.587    11.736    11.894    12.062    12.243    12.435    12.639    12.852    13.068    13.276
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.411    15.454    15.504     15.56    15.622    15.689    15.762    15.841    15.927     16.02    16.121    16.231     16.35    16.472    16.592
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:100, fl_diff:1.555546e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.992    11.089      11.2    11.322    11.452    11.592     11.74    11.898    12.067    12.247    12.439    12.643    12.856    13.073     13.28
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.416    15.459    15.509    15.565    15.626    15.693    15.766    15.845    15.931    16.025    16.126    16.236    16.354    16.477    16.596
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:105, fl_diff:1.141423e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.995    11.092    11.203    11.325    11.456    11.595    11.743    11.901     12.07     12.25    12.442    12.646    12.859    13.076    13.283
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.419    15.462    15.512    15.568     15.63    15.697     15.77    15.849    15.935    16.028    16.129     16.24    16.358     16.48      16.6
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:110, fl_diff:8.375957e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.997    11.095    11.206    11.328    11.458    11.597    11.746    11.904    12.072    12.253    12.445    12.649    12.862    13.078    13.286
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.421    15.465    15.515    15.571    15.632    15.699    15.772    15.851    15.937     16.03    16.132    16.242     16.36    16.483    16.602
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeoutput">VAL it_iter:115, fl_diff:6.146646e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val
Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice
mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.999    11.096    11.207    11.329     11.46    11.599    11.747    11.906    12.074    12.255    12.447     12.65    12.864     13.08    13.288
    map     23.556     23.53    22.544    22.509    21.538     21.33    20.542    19.605    18.258     16.96    15.312    13.804    12.258    10.211    8.2306
    mak     1.9923    1.9923    2.9499    2.9503     3.885    4.0516    4.7959    5.6852    6.9826    8.2225    9.8072    11.247    12.717    14.687    16.592
    Hval    15.423    15.467    15.517    15.573    15.634    15.701    15.774    15.853    15.939    16.032    16.134    16.244    16.362    16.485    16.604
    Hap     47.959    47.959    46.939    46.939    45.918    44.898    44.898    43.878    42.857    40.816    38.776    36.735    34.694    31.633    29.592
    Hak     2.0408    2.0408    3.0612    3.0612    4.0816     5.102     5.102    6.1224    7.1429    9.1837    11.224    13.265    15.306    18.367    20.408

</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 1852.711928 seconds.
</pre><h2 id="15">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    <span class="comment">% graphing based on coh_wkb, but that does not match optimal choice</span>
    <span class="comment">% matrixes for graphs.</span>
    armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_interp_coh_grid_mesh_z;
    armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_interp_coh_grid);
    armt_map(<span class="string">'ar_a_meshk'</span>) = mt_interp_coh_grid_mesh_z(:,1);
    armt_map(<span class="string">'ar_k_mesha'</span>) = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                 valgap     polgap        z1            z2            z3            z4            z5            z6            z7            z8            z9           z10           z11           z12           z13           z14           z15    
                ________    ______    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________

    iter=1        285.99     369.3             1             1             1             1             1             1             1             1             1             1             1             1             1             1             1
    iter=2        222.05    3285.8       0.94193       0.94127       0.92213       0.92147       0.90211       0.90101       0.88099        0.8612       0.84074       0.80136       0.76177       0.72129       0.68038       0.62033       0.55983
    iter=3        185.25    1094.3       0.64914       0.64848        0.5154       0.51474       0.58095       0.59019       0.62692       0.57765       0.75187        0.4923       0.61505       0.50946       0.57193       0.53234       0.54641
    iter=4         158.8    537.01       0.53102       0.53102       0.45755       0.45733       0.54927       0.58051       0.51936       0.47558       0.65552       0.43687       0.52244       0.44875       0.49406       0.45073       0.45645
    iter=5        138.27    320.32       0.44413       0.44347       0.41421       0.41421       0.46832       0.54795       0.47756       0.42411       0.63418       0.39793        0.4692       0.41311       0.42411       0.40101       0.40453
    iter=6        121.68    220.45       0.37198        0.3722       0.34932       0.34932       0.38033       0.44941       0.42631        0.3601       0.63704       0.35064       0.46238       0.38649       0.36758        0.3546       0.35416
    iter=7        107.92    165.92       0.30906       0.30972       0.28817       0.28883        0.3172       0.37923       0.35768       0.30004       0.57435       0.29564       0.42213        0.3359       0.31126         0.304       0.30708
    iter=8          96.3    139.47       0.22657       0.22657       0.22415       0.22459       0.23845        0.3227       0.26177       0.23273       0.59569       0.22899       0.37857       0.30136       0.24725       0.24351       0.24725
    iter=9        86.353    116.27       0.17488       0.17532       0.16894       0.17312        0.1828       0.25011       0.21029       0.18082       0.57501        0.1784        0.3326       0.28751       0.19402       0.19006       0.19534
    iter=10       77.761    101.23       0.13704       0.13946       0.13286       0.13066       0.13946       0.19314       0.15486       0.13616       0.53828       0.13924       0.25451       0.25011       0.15222       0.15178       0.15398
    iter=11       70.231    88.434       0.10405       0.10537       0.10229       0.10405       0.11065       0.16806       0.12648       0.11307        0.5011       0.11461       0.24285       0.20766       0.12209       0.12604       0.12956
    iter=12       63.637    76.526      0.091069      0.089089       0.08491       0.08667      0.090849       0.11021       0.10229      0.089309       0.43577      0.091069       0.19952       0.15882       0.10471       0.10141       0.10383
    iter=13        57.79    69.393      0.067312      0.069292      0.069512      0.069952      0.078531       0.11571      0.089089      0.076551       0.36758       0.07963       0.14364       0.13308      0.087989      0.087769      0.091069
    iter=14       52.609    57.463      0.058073      0.058073      0.056973      0.057633      0.063132       0.11659      0.070392      0.064232       0.29894      0.064012       0.14628      0.075451      0.070612      0.073691      0.077431
    iter=15        47.99    52.995      0.051914      0.051914      0.048394      0.049934      0.054553       0.11043      0.060933      0.054333       0.26683      0.054773       0.17598       0.08579      0.061153      0.059833      0.063132
    iter=16       43.841    51.623      0.041135      0.043115      0.040035      0.040255      0.045315       0.15156      0.051034      0.045755       0.24307      0.048174        0.1674      0.056313      0.054333      0.056093      0.055213
    iter=17       40.127     46.68      0.033216      0.032776      0.034756      0.033216      0.038055       0.20634      0.042235      0.039815       0.18456      0.040475       0.12319      0.090849      0.047294      0.047734      0.049934
    iter=18       36.789    40.252      0.029037      0.029916      0.028377      0.030356      0.030576        0.1399      0.035196      0.032116       0.16498      0.034096       0.11285       0.10229      0.040915      0.040255      0.042675
    iter=19       33.771    40.502      0.025077      0.025517      0.024637      0.025297      0.027497       0.11021      0.032116      0.029256       0.16344      0.030136      0.089309      0.056093      0.033876      0.035196      0.037615
    iter=20       31.031    39.705      0.022217      0.021557      0.021777      0.021337      0.023537        0.1663      0.028377      0.024637        0.1344      0.025077      0.028817      0.032336      0.030136      0.030796      0.050154
    iter=21        28.54    30.318      0.019138      0.019798      0.019798      0.021557      0.020018      0.075451      0.023977      0.022877      0.097888      0.022657      0.063572      0.046634      0.026397      0.027717      0.065332
    iter=22       26.279      36.3      0.015838      0.015618      0.014958      0.015618      0.019138      0.093709      0.021337      0.018038       0.14254      0.019578      0.078311      0.025077      0.023317      0.023537      0.061813
    iter=23       24.228    26.269      0.012978      0.014738      0.014298      0.015398      0.013638      0.033656      0.018478      0.014738      0.075671      0.017378      0.058073      0.021557      0.020458      0.021117      0.058953
    iter=24       22.363    29.704      0.012538      0.012099      0.011659     0.0098988      0.013638      0.050814      0.014958      0.014738      0.072811      0.014298      0.091289      0.018258      0.016938      0.018038      0.056753
    iter=25       20.663    25.514      0.010339      0.010119      0.010339      0.010779      0.011659      0.067972      0.013638      0.010779      0.052354      0.014078      0.054333      0.016278      0.015398      0.016278      0.034756
    iter=26       19.108    25.078     0.0098988     0.0087989     0.0094589      0.010339      0.010339      0.066652      0.013858      0.010559      0.052354      0.011439      0.012978      0.034756      0.014078      0.014078      0.052354
    iter=27       17.682    21.724     0.0074791      0.010119     0.0074791     0.0076991     0.0096788      0.029037     0.0094589      0.010779      0.048394     0.0098988      0.012319      0.013638      0.012099      0.012319      0.050154
    iter=28       16.373    26.185     0.0076991     0.0074791     0.0074791     0.0070392     0.0068192      0.063572     0.0090189      0.008359      0.045755     0.0090189      0.030136      0.012758      0.010779      0.011439      0.032116
    iter=29       15.169    25.806     0.0059393     0.0059393     0.0065992     0.0061593     0.0070392      0.027277      0.008139     0.0074791      0.066212     0.0090189     0.0087989      0.010339      0.010339      0.010119      0.047954
    iter=30       14.063    20.528     0.0059393     0.0061593     0.0057193     0.0063792     0.0072591      0.044655     0.0072591     0.0070392      0.026177     0.0068192      0.008579      0.008359     0.0087989     0.0087989      0.028817
    iter=31       13.046    20.656     0.0050594     0.0046194     0.0046194     0.0050594     0.0046194      0.023537     0.0057193     0.0054993      0.045535     0.0063792      0.008139     0.0090189     0.0074791      0.008359      0.026397
    iter=32       12.112    22.189     0.0035196     0.0041795     0.0043995     0.0037396     0.0048394      0.023097     0.0054993     0.0054993      0.044655     0.0052794     0.0065992      0.027277     0.0072591     0.0065992      0.026397
    iter=33       11.254    23.173     0.0035196     0.0030796     0.0037396     0.0039595     0.0043995      0.041795     0.0059393     0.0052794      0.042455     0.0052794     0.0057193     0.0076991     0.0054993     0.0068192      0.043555
    iter=34       10.464    19.564     0.0030796     0.0035196     0.0026397     0.0032996     0.0030796      0.040915     0.0032996     0.0039595     0.0048394     0.0041795     0.0046194     0.0046194     0.0052794     0.0059393     0.0068192
    iter=35        9.738    23.887     0.0028597     0.0028597     0.0026397     0.0026397     0.0032996      0.021997     0.0037396     0.0032996      0.060273     0.0037396     0.0041795     0.0054993     0.0043995     0.0043995      0.023317
    iter=36       9.0691    28.567     0.0013198     0.0017598     0.0024197     0.0026397     0.0030796       0.08579     0.0030796     0.0019798     0.0037396     0.0039595     0.0037396     0.0046194     0.0032996     0.0041795      0.023537
    iter=37       8.4526    20.798     0.0026397     0.0019798     0.0017598     0.0015398     0.0017598     0.0021997     0.0024197     0.0030796      0.045535     0.0021997     0.0035196     0.0039595     0.0039595     0.0041795      0.023537
    iter=38       7.8833     14.06     0.0010999     0.0010999     0.0013198     0.0019798     0.0021997     0.0024197     0.0015398     0.0021997      0.020897     0.0028597     0.0035196     0.0035196     0.0026397     0.0030796     0.0041795
    iter=39        7.357    14.135     0.0010999     0.0015398     0.0021997     0.0015398     0.0015398     0.0026397     0.0032996     0.0019798     0.0017598     0.0017598     0.0024197     0.0028597     0.0039595     0.0017598      0.021337
    iter=40       6.8697    14.206     0.0021997     0.0013198    0.00087989     0.0010999     0.0013198      0.019798     0.0013198     0.0015398     0.0015398     0.0013198     0.0015398     0.0028597     0.0019798     0.0030796      0.021337
    iter=41       6.4181    5.3022    0.00065992     0.0015398     0.0013198     0.0013198    0.00065992    0.00087989     0.0019798     0.0019798     0.0017598     0.0019798     0.0013198     0.0024197     0.0017598     0.0021997     0.0026397
    iter=42       5.9992    19.147    0.00087989    0.00065992    0.00065992     0.0015398     0.0010999     0.0015398    0.00087989    0.00087989      0.038715     0.0013198     0.0021997      0.021337     0.0017598     0.0017598     0.0019798
    iter=43       5.6101    13.983    0.00065992    0.00043995    0.00043995    0.00087989    0.00087989    0.00043995     0.0013198     0.0010999     0.0015398    0.00087989    0.00087989    0.00065992     0.0010999     0.0017598      0.020678
    iter=44       5.2484    4.3292    0.00021997    0.00065992    0.00065992    0.00043995     0.0019798     0.0015398    0.00021997    0.00087989     0.0010999     0.0015398    0.00043995     0.0010999     0.0015398    0.00087989     0.0013198
    iter=45        4.912    4.0816     0.0010999    0.00043995     0.0013198    0.00043995    0.00021997    0.00021997     0.0015398    0.00065992    0.00043995    0.00065992    0.00087989     0.0015398     0.0013198     0.0019798    0.00087989
    iter=46       4.5987    13.694    0.00021997    0.00087989    0.00021997    0.00043995    0.00021997      0.019798    0.00043995    0.00043995    0.00087989     0.0010999     0.0010999     0.0017598    0.00065992     0.0010999     0.0017598
    iter=47       4.3068    3.3021    0.00065992             0             0    0.00043995    0.00021997    0.00021997    0.00065992    0.00021997    0.00065992    0.00065992    0.00043995    0.00043995     0.0010999             0     0.0013198
    iter=48       4.0346    13.543    0.00021997    0.00043995    0.00087989    0.00021997    0.00087989    0.00087989    0.00065992    0.00021997     0.0013198    0.00043995     0.0017598     0.0021997    0.00021997    0.00087989      0.019358
    iter=49       3.7807    3.0612    0.00021997    0.00043995    0.00043995    0.00043995    0.00021997    0.00043995    0.00021997    0.00087989    0.00043995    0.00087989    0.00021997             0     0.0010999    0.00065992    0.00043995
    iter=50       3.5436    13.536    0.00021997             0    0.00065992     0.0013198    0.00021997    0.00021997    0.00043995    0.00043995      0.019358    0.00065992    0.00065992    0.00087989    0.00021997    0.00021997    0.00087989
    iter=66       1.2852    1.0204             0             0             0             0             0             0             0    0.00021997             0             0             0             0             0    0.00021997             0
    iter=67       1.2072    1.0204             0    0.00021997             0    0.00021997             0             0             0             0             0    0.00021997    0.00021997    0.00043995             0             0             0
    iter=68       1.1341    13.383             0             0             0             0    0.00021997             0    0.00021997             0             0             0             0             0             0             0      0.018918
    iter=69       1.0654    1.0204             0             0             0             0             0             0             0             0             0    0.00021997             0             0    0.00021997             0    0.00021997
    iter=70        1.001         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=71      0.94047    1.0204    0.00021997             0             0             0             0             0             0             0    0.00021997             0             0             0             0             0             0
    iter=72      0.88365    1.0204             0             0             0    0.00021997             0             0             0             0             0             0             0             0             0             0             0
    iter=73      0.83029    1.0204             0             0             0             0             0             0             0             0             0             0             0             0    0.00021997             0             0
    iter=74      0.78018         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=75      0.73312    1.0204             0             0             0             0             0             0             0             0    0.00021997             0             0    0.00021997             0    0.00021997    0.00021997
    iter=76      0.68891    1.0204             0    0.00021997             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=77      0.64739    1.0204             0             0             0             0             0             0             0    0.00021997             0             0             0             0             0             0             0
    iter=78      0.60838         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=79      0.57174    1.0204             0             0             0             0             0             0             0             0             0             0             0             0             0    0.00021997             0
    iter=80      0.53732    1.0204             0             0             0             0             0             0             0             0             0             0    0.00021997    0.00021997             0             0             0
    iter=81      0.50497    1.0204             0             0             0             0             0             0             0             0    0.00021997             0             0             0    0.00021997             0             0
    iter=82      0.47459         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=83      0.44603    1.0204             0             0             0             0    0.00021997             0             0             0             0             0             0             0             0             0             0
    iter=84      0.41921         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=85        0.394         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=86      0.37031         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=87      0.34804         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=88      0.32712         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=89      0.30746    1.0204             0             0             0             0             0             0             0             0             0             0             0             0             0             0    0.00021997
    iter=90      0.28899         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=91      0.27163         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=92      0.25531         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=93      0.23997         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=94      0.22556         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=95      0.21201         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=96      0.19928         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=97      0.18731         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=98      0.17606         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=99      0.16549         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=100     0.15555         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=101     0.14622         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=102     0.13744         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=103     0.12919         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=104     0.12143         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=105     0.11414         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=106     0.10729         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=107     0.10085         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=108    0.094798         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=109    0.089108         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=110     0.08376         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=111    0.078733         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=112    0.074007         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=113    0.069566         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=114    0.065391         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=115    0.061466         0             0             0             0             0             0             0             0             0             0             0             0             0             0             0             0

tb_val
                             z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                             __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0        -16.699       -16.699       -16.699     -16.699       -16.699       -16.699      -16.699       -16.699        -16.699       -16.699      -16.699       -16.699 
    coh2:k=0.468663,b=0        -16.618       -16.618       -16.618     -16.618       -16.618       -16.618      -16.618       -16.618        -16.618       -16.618      -16.618       -16.618 
    coh3:k=0.493677,b=0        -16.543       -16.543       -16.543     -16.543       -16.543       -16.543      -16.543       -16.543        -16.543       -16.543      -16.543       -16.543 
    coh4:k=0.518692,b=0        -16.473       -16.473       -16.473     -16.473       -16.473       -16.473      -16.473       -16.473        -16.473       -16.473      -16.473       -16.473 
    coh5:k=0.543707,b=0        -16.408       -16.408       -16.408     -16.408       -16.408       -16.408      -16.408       -16.408        -16.408       -16.408      -16.408       -16.408 
    coh6:k=0.568722,b=0        -16.348       -16.348       -16.348     -16.348       -16.348       -16.348      -16.348       -16.348        -16.348       -16.348      -16.348       -16.348 
    coh7:k=0.593736,b=0        -16.292       -16.292       -16.292     -16.292       -16.292       -16.292      -16.292       -16.292        -16.292       -16.292      -16.292       -16.292 
    coh8:k=0.618751,b=0        -16.239       -16.239       -16.239     -16.239       -16.239       -16.239      -16.239       -16.239        -16.239       -16.239      -16.239       -16.239 
    coh9:k=0.643766,b=0        -16.189       -16.189       -16.189     -16.189       -16.189       -16.189      -16.189       -16.189        -16.189       -16.189      -16.189       -16.189 
    coh10:k=0.668781,b=0       -16.142       -16.142       -16.142     -16.142       -16.142       -16.142      -16.142       -16.142        -16.142       -16.142      -16.142       -16.142 
    coh11:k=0.693795,b=0       -16.097       -16.097       -16.097     -16.097       -16.097       -16.097      -16.097       -16.097        -16.097       -16.097      -16.097       -16.097 
    coh12:k=0.71881,b=0        -16.055       -16.055       -16.055     -16.055       -16.055       -16.055      -16.055       -16.055        -16.055       -16.055      -16.055       -16.055 
    coh13:k=0.743825,b=0       -16.015       -16.015       -16.015     -16.015       -16.015       -16.015      -16.015       -16.015        -16.015       -16.015      -16.015       -16.015 
    coh14:k=0.76884,b=0        -15.977       -15.977       -15.977     -15.977       -15.977       -15.977      -15.977       -15.977        -15.977       -15.977      -15.977       -15.977 
    coh15:k=0.793854,b=0       -15.941       -15.941       -15.941     -15.941       -15.941       -15.941      -15.941       -15.941        -15.941       -15.941      -15.941       -15.941 
    coh16:k=0.818869,b=0       -15.906       -15.906       -15.906     -15.906       -15.906       -15.906      -15.906       -15.906        -15.906       -15.906      -15.906       -15.906 
    coh17:k=0.843884,b=0       -15.873       -15.873       -15.873     -15.873       -15.873       -15.873      -15.873       -15.873        -15.873       -15.873      -15.873       -15.873 
    coh18:k=0.868899,b=0       -15.842       -15.842       -15.842     -15.842       -15.842       -15.842      -15.842       -15.842        -15.842       -15.842      -15.842       -15.842 
    coh19:k=0.893913,b=0       -15.811       -15.811       -15.811     -15.811       -15.811       -15.811      -15.811       -15.811        -15.811       -15.811      -15.811       -15.811 
    coh20:k=0.918928,b=0       -15.782       -15.782       -15.782     -15.782       -15.782       -15.782      -15.782       -15.782        -15.782       -15.782      -15.782       -15.782 
    coh21:k=0.943943,b=0       -15.755       -15.755       -15.755     -15.755       -15.755       -15.755      -15.755       -15.755        -15.755       -15.755      -15.755       -15.755 
    coh22:k=0.968958,b=0       -15.728       -15.728       -15.728     -15.728       -15.728       -15.728      -15.728       -15.728        -15.728       -15.728      -15.728       -15.728 
    coh23:k=0.993972,b=0       -15.702       -15.702       -15.702     -15.702       -15.702       -15.702      -15.702       -15.702        -15.702       -15.702      -15.702       -15.702 
    coh24:k=1.01899,b=0        -15.677       -15.677       -15.677     -15.677       -15.677       -15.677      -15.677       -15.677        -15.677       -15.677      -15.677       -15.677 
    coh25:k=1.044,b=0          -8.3992       -8.1464       -7.8671     -7.5728       -7.2677       -6.9514      -5.4596       -5.0062        -4.5365       -4.0708      -3.6301       -3.2368 
    coh26:k=1.06902,b=0          -4.45       -4.1971       -3.9179     -3.6236       -3.3184       -3.0021      -1.5104        -1.057       -0.58724      -0.12161      0.31914       0.71242 
    coh27:k=1.09403,b=0        -2.7495       -2.4967       -2.2174     -1.9231        -1.618       -1.3017      0.19009       0.64346         1.1132        1.5788       2.0196        2.4129 
    coh28:k=1.11905,b=0        -1.7467       -1.4938       -1.2146    -0.92025      -0.61513      -0.29883        1.193        1.6463         2.1161        2.5817       3.0225        3.4157 
    coh29:k=1.14406,b=0        -1.0662      -0.81335       -0.5341    -0.23976      0.065357       0.38166       1.8734        2.3268         2.7966        3.2622       3.7029        4.0962 
    coh30:k=1.16908,b=0       -0.56567      -0.31283     -0.033583     0.26075       0.56588       0.88218        2.374        2.8273         3.2971        3.7627       4.2035        4.5967 
    coh31:k=1.19409,b=0       -0.17762      0.075222       0.35447     0.64881       0.95393        1.2702        2.762        3.2154         3.6851        4.1508       4.5915        4.9848 
    coh32:k=1.21911,b=0        0.13462       0.38746       0.66671     0.96105        1.2662        1.5825       3.0742        3.5276         3.9974         4.463       4.9037         5.297 
    coh33:k=1.24412,b=0         0.3929       0.64575       0.92499      1.2193        1.5245        1.8408       3.3325        3.7859         4.2557        4.7213        5.162        5.5553 
    coh34:k=1.26913,b=0        0.61117       0.86401        1.1433      1.4376        1.7427         2.059       3.5508        4.0042         4.4739        4.9395       5.3803        5.7736 
    coh35:k=1.29415,b=0        0.79879        1.0516        1.3309      1.6252        1.9303        2.2466       3.7384        4.1918         4.6615        5.1272       5.5679        5.9612 
    coh36:k=1.31916,b=0        0.96232        1.2152        1.4944      1.7887        2.0939        2.4102       3.9019        4.3553         4.8251        5.2907       5.7314        6.1247 
    coh37:k=1.34418,b=0         1.1065        1.3594        1.6386      1.9329        2.2381        2.5544       4.0461        4.4995         4.9693        5.4349       5.8756        6.2689 
    coh38:k=1.36919,b=0         1.2349        1.4877         1.767      2.0613        2.3664        2.6827       4.1745        4.6279         5.0976        5.5633        6.004        6.3973 
    coh39:k=1.39421,b=0         1.3502         1.603        1.8823      2.1766        2.4817         2.798       4.2898        4.7432         5.2129        5.6786       6.1193        6.5126 
    coh40:k=1.41922,b=0         1.4544        1.7073        1.9865      2.2809         2.586        2.9023        4.394        4.8474         5.3172        5.7828       6.2236        6.6168 
    coh41:k=1.44424,b=0         1.5493        1.8021        2.0814      2.3757        2.6809        2.9972       4.4889        4.9423         5.4121        5.8777       6.3184        6.7117 
    coh42:k=1.46925,b=0         1.6361         1.889        2.1682      2.4626        2.7677         3.084       4.5758        5.0291         5.4989        5.9645       6.4053        6.7985 
    coh43:k=1.49427,b=0          1.716        1.9688        2.2481      2.5424        2.8475        3.1638       4.6556         5.109         5.5787        6.0444       6.4851        6.8784 
    coh44:k=1.51928,b=0         1.7898        2.0426        2.3219      2.6162        2.9213        3.2376       4.7294        5.1828         5.6525        6.1182       6.5589        6.9522 
    coh45:k=1.5443,b=0          1.8582         2.111        2.3903      2.6846        2.9898        3.3061       4.7978        5.2512          5.721        6.1866       6.6273        7.0206 
    coh46:k=1.56931,b=0         1.9219        2.1747         2.454      2.7483        3.0535        3.3698       4.8615        5.3149         5.7847        6.2503        6.691        7.0843 
    coh47:k=1.59433,b=0         1.9814        2.2342        2.5135      2.8078        3.1129        3.4292        4.921        5.3744         5.8441        6.3098       6.7505        7.1438 
    coh48:k=1.61934,b=0         2.0371          2.29        2.5692      2.8635        3.1687         3.485       4.9767        5.4301         5.8999        6.3655       6.8062        7.1995 
    coh49:k=1.64436,b=0         2.0894        2.3423        2.6215      2.9159         3.221        3.5373       5.0291        5.4824         5.9522        6.4178       6.8586        7.2519 
    coh50:k=1.66937,b=0         2.1387        2.3916        2.6708      2.9651        3.2703        3.5866       5.0783        5.5317         6.0015        6.4671       6.9078        7.3011 
    coh2224:k=56.0514,b=0       15.352        15.395        15.445      15.502        15.563         15.63       15.961        16.062         16.173        16.291       16.413        16.533 
    coh2225:k=56.0764,b=0       15.354        15.397        15.447      15.503        15.564        15.631       15.963        16.064         16.174        16.292       16.415        16.535 
    coh2226:k=56.1015,b=0       15.355        15.399        15.449      15.505        15.566        15.633       15.964        16.066         16.176        16.294       16.417        16.536 
    coh2227:k=56.1265,b=0       15.357          15.4         15.45      15.507        15.568        15.635       15.966        16.067         16.178        16.296       16.418        16.538 
    coh2228:k=56.1515,b=0       15.359        15.402        15.452      15.508        15.569        15.636       15.968        16.069         16.179        16.297        16.42         16.54 
    coh2229:k=56.1765,b=0        15.36        15.404        15.454       15.51        15.571        15.638       15.969        16.071         16.181        16.299       16.422        16.541 
    coh2230:k=56.2015,b=0       15.362        15.405        15.455      15.511        15.573         15.64       15.971        16.072         16.182          16.3       16.423        16.543 
    coh2231:k=56.2265,b=0       15.363        15.407        15.457      15.513        15.574        15.641       15.972        16.074         16.184        16.302       16.425        16.544 
    coh2232:k=56.2516,b=0       15.365        15.408        15.459      15.515        15.576        15.643       15.974        16.076         16.186        16.304       16.426        16.546 
    coh2233:k=56.2766,b=0       15.367         15.41         15.46      15.516        15.578        15.644       15.976        16.077         16.187        16.305       16.428        16.548 
    coh2234:k=56.3016,b=0       15.368        15.412        15.462      15.518        15.579        15.646       15.977        16.079         16.189        16.307        16.43        16.549 
    coh2235:k=56.3266,b=0        15.37        15.413        15.463      15.519        15.581        15.648       15.979         16.08          16.19        16.308       16.431        16.551 
    coh2236:k=56.3516,b=0       15.371        15.415        15.465      15.521        15.582        15.649        15.98        16.082         16.192         16.31       16.433        16.552 
    coh2237:k=56.3766,b=0       15.373        15.416        15.466      15.523        15.584        15.651       15.982        16.083         16.194        16.312       16.434        16.554 
    coh2238:k=56.4016,b=0       15.375        15.418        15.468      15.524        15.585        15.652       15.984        16.085         16.195        16.313       16.436        16.555 
    coh2239:k=56.4267,b=0       15.376        15.419         15.47      15.526        15.587        15.654       15.985        16.087         16.197        16.315       16.437        16.557 
    coh2240:k=56.4517,b=0       15.378        15.421        15.471      15.527        15.588        15.655       15.987        16.088         16.198        16.316       16.439        16.559 
    coh2241:k=56.4767,b=0       15.379        15.423        15.473      15.529         15.59        15.657       15.988         16.09           16.2        16.318        16.44         16.56 
    coh2242:k=56.5017,b=0       15.381        15.424        15.474       15.53        15.591        15.658        15.99        16.091         16.201        16.319       16.442        16.562 
    coh2243:k=56.5267,b=0       15.382        15.426        15.476      15.532        15.593         15.66       15.991        16.093         16.203        16.321       16.443        16.563 
    coh2244:k=56.5517,b=0       15.384        15.427        15.477      15.533        15.594        15.661       15.993        16.094         16.204        16.322       16.445        16.565 
    coh2245:k=56.5767,b=0       15.385        15.429        15.479      15.535        15.596        15.663       15.994        16.096         16.206        16.324       16.446        16.566 
    coh2246:k=56.6018,b=0       15.387         15.43         15.48      15.536        15.597        15.664       15.996        16.097         16.207        16.325       16.448        16.568 
    coh2247:k=56.6268,b=0       15.388        15.431        15.482      15.538        15.599        15.666       15.997        16.099         16.209        16.327       16.449        16.569 
    coh2248:k=56.6518,b=0        15.39        15.433        15.483      15.539          15.6        15.667       15.999          16.1          16.21        16.328       16.451         16.57 
    coh2249:k=56.6768,b=0       15.391        15.434        15.484      15.541        15.602        15.669           16        16.101         16.212         16.33       16.452        16.572 
    coh2250:k=56.7018,b=0       15.392        15.436        15.486      15.542        15.603         15.67       16.001        16.103         16.213        16.331       16.454        16.573 
    coh2251:k=56.7268,b=0       15.394        15.437        15.487      15.543        15.605        15.672       16.003        16.104         16.214        16.332       16.455        16.575 
    coh2252:k=56.7518,b=0       15.395        15.439        15.489      15.545        15.606        15.673       16.004        16.106         16.216        16.334       16.457        16.576 
    coh2253:k=56.7769,b=0       15.397         15.44         15.49      15.546        15.608        15.674       16.006        16.107         16.217        16.335       16.458        16.578 
    coh2254:k=56.8019,b=0       15.398        15.442        15.492      15.548        15.609        15.676       16.007        16.109         16.219        16.337       16.459        16.579 
    coh2255:k=56.8269,b=0         15.4        15.443        15.493      15.549         15.61        15.677       16.009         16.11          16.22        16.338       16.461         16.58 
    coh2256:k=56.8519,b=0       15.401        15.444        15.494       15.55        15.612        15.679        16.01        16.111         16.222         16.34       16.462        16.582 
    coh2257:k=56.8769,b=0       15.402        15.446        15.496      15.552        15.613         15.68       16.011        16.113         16.223        16.341       16.464        16.583 
    coh2258:k=56.9019,b=0       15.404        15.447        15.497      15.553        15.615        15.681       16.013        16.114         16.224        16.342       16.465        16.585 
    coh2259:k=56.9269,b=0       15.405        15.448        15.499      15.555        15.616        15.683       16.014        16.116         16.226        16.344       16.466        16.586 
    coh2260:k=56.952,b=0        15.406         15.45          15.5      15.556        15.617        15.684       16.015        16.117         16.227        16.345       16.468        16.587 
    coh2261:k=56.977,b=0        15.408        15.451        15.501      15.557        15.619        15.685       16.017        16.118         16.228        16.346       16.469        16.589 
    coh2262:k=57.002,b=0        15.409        15.453        15.503      15.559         15.62        15.687       16.018         16.12          16.23        16.348        16.47         16.59 
    coh2263:k=57.027,b=0        15.411        15.454        15.504       15.56        15.621        15.688        16.02        16.121         16.231        16.349       16.472        16.591 
    coh2264:k=57.052,b=0        15.412        15.455        15.505      15.561        15.623         15.69       16.021        16.122         16.232         16.35       16.473        16.593 
    coh2265:k=57.077,b=0        15.413        15.457        15.507      15.563        15.624        15.691       16.022        16.124         16.234        16.352       16.474        16.594 
    coh2266:k=57.1021,b=0       15.415        15.458        15.508      15.564        15.625        15.692       16.024        16.125         16.235        16.353       16.476        16.595 
    coh2267:k=57.1271,b=0       15.416        15.459        15.509      15.565        15.627        15.694       16.025        16.126         16.236        16.354       16.477        16.597 
    coh2268:k=57.1521,b=0       15.417        15.461        15.511      15.567        15.628        15.695       16.026        16.128         16.238        16.356       16.478        16.598 
    coh2269:k=57.1771,b=0       15.418        15.462        15.512      15.568        15.629        15.696       16.027        16.129         16.239        16.357        16.48        16.599 
    coh2270:k=57.2021,b=0        15.42        15.463        15.513      15.569        15.631        15.697       16.029         16.13          16.24        16.358       16.481        16.601 
    coh2271:k=57.2271,b=0       15.421        15.464        15.515      15.571        15.632        15.699        16.03        16.131         16.242         16.36       16.482        16.602 
    coh2272:k=57.2521,b=0       15.422        15.466        15.516      15.572        15.633          15.7       16.031        16.133         16.243        16.361       16.484        16.603 
    coh2273:k=57.2772,b=0       15.424        15.467        15.517      15.573        15.634        15.701       16.033        16.134         16.244        16.362       16.485        16.605 

tb_pol_a
                             z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                             __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh2:k=0.468663,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh3:k=0.493677,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh4:k=0.518692,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh5:k=0.543707,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh6:k=0.568722,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh7:k=0.593736,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh8:k=0.618751,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh9:k=0.643766,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh10:k=0.668781,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh11:k=0.693795,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh12:k=0.71881,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh13:k=0.743825,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh14:k=0.76884,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh15:k=0.793854,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh16:k=0.818869,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh17:k=0.843884,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh18:k=0.868899,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh19:k=0.893913,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh20:k=0.918928,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh21:k=0.943943,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh22:k=0.968958,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh23:k=0.993972,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh24:k=1.01899,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh25:k=1.044,b=0               0             0            0            0             0             0             0             0             0             0             0            0  
    coh26:k=1.06902,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh27:k=1.09403,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh28:k=1.11905,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh29:k=1.14406,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh30:k=1.16908,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh31:k=1.19409,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh32:k=1.21911,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh33:k=1.24412,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh34:k=1.26913,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh35:k=1.29415,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh36:k=1.31916,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh37:k=1.34418,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh38:k=1.36919,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh39:k=1.39421,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh40:k=1.41922,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh41:k=1.44424,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh42:k=1.46925,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh43:k=1.49427,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh44:k=1.51928,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh45:k=1.5443,b=0              0             0            0            0             0             0             0             0             0             0             0            0  
    coh46:k=1.56931,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh47:k=1.59433,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh48:k=1.61934,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh49:k=1.64436,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh50:k=1.66937,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh2224:k=56.0514,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2225:k=56.0764,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2226:k=56.1015,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2227:k=56.1265,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2228:k=56.1515,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2229:k=56.1765,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2230:k=56.2015,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2231:k=56.2265,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2232:k=56.2516,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2233:k=56.2766,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2234:k=56.3016,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2235:k=56.3266,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2236:k=56.3516,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2237:k=56.3766,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2238:k=56.4016,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2239:k=56.4267,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2240:k=56.4517,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2241:k=56.4767,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2242:k=56.5017,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2243:k=56.5267,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2244:k=56.5517,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2245:k=56.5767,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2246:k=56.6018,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2247:k=56.6268,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2248:k=56.6518,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2249:k=56.6768,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2250:k=56.7018,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2251:k=56.7268,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2252:k=56.7518,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2253:k=56.7769,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2254:k=56.8019,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2255:k=56.8269,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2256:k=56.8519,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2257:k=56.8769,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2258:k=56.9019,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2259:k=56.9269,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2260:k=56.952,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2261:k=56.977,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2262:k=57.002,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2263:k=57.027,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2264:k=57.052,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2265:k=57.077,b=0       47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2266:k=57.1021,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2267:k=57.1271,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2268:k=57.1521,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2269:k=57.1771,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2270:k=57.2021,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2271:k=57.2271,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2272:k=57.2521,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  
    coh2273:k=57.2772,b=0      47.959        47.959       46.939       46.939        45.918        44.898        40.816        38.776        36.735        34.694        31.633       29.592  

tb_pol_k
                             z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                             __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh2:k=0.468663,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh3:k=0.493677,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh4:k=0.518692,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh5:k=0.543707,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh6:k=0.568722,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh7:k=0.593736,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh8:k=0.618751,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh9:k=0.643766,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh10:k=0.668781,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh11:k=0.693795,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh12:k=0.71881,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh13:k=0.743825,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh14:k=0.76884,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh15:k=0.793854,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh16:k=0.818869,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh17:k=0.843884,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh18:k=0.868899,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh19:k=0.893913,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh20:k=0.918928,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh21:k=0.943943,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh22:k=0.968958,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh23:k=0.993972,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh24:k=1.01899,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh25:k=1.044,b=0          1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh26:k=1.06902,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh27:k=1.09403,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh28:k=1.11905,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh29:k=1.14406,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh30:k=1.16908,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh31:k=1.19409,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh32:k=1.21911,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh33:k=1.24412,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh34:k=1.26913,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh35:k=1.29415,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh36:k=1.31916,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh37:k=1.34418,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh38:k=1.36919,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh39:k=1.39421,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh40:k=1.41922,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh41:k=1.44424,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh42:k=1.46925,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh43:k=1.49427,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh44:k=1.51928,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh45:k=1.5443,b=0         1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh46:k=1.56931,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh47:k=1.59433,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh48:k=1.61934,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh49:k=1.64436,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh50:k=1.66937,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh2224:k=56.0514,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2225:k=56.0764,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2226:k=56.1015,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2227:k=56.1265,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2228:k=56.1515,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2229:k=56.1765,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2230:k=56.2015,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2231:k=56.2265,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2232:k=56.2516,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2233:k=56.2766,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2234:k=56.3016,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2235:k=56.3266,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2236:k=56.3516,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2237:k=56.3766,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2238:k=56.4016,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2239:k=56.4267,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2240:k=56.4517,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2241:k=56.4767,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2242:k=56.5017,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2243:k=56.5267,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2244:k=56.5517,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2245:k=56.5767,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2246:k=56.6018,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2247:k=56.6268,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2248:k=56.6518,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2249:k=56.6768,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2250:k=56.7018,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2251:k=56.7268,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2252:k=56.7518,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2253:k=56.7769,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2254:k=56.8019,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2255:k=56.8269,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2256:k=56.8519,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2257:k=56.8769,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2258:k=56.9019,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2259:k=56.9269,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2260:k=56.952,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2261:k=56.977,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2262:k=57.002,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2263:k=57.027,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2264:k=57.052,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2265:k=57.077,b=0       2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2266:k=57.1021,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2267:k=57.1271,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2268:k=57.1521,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2269:k=57.1771,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2270:k=57.2021,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2271:k=57.2271,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2272:k=57.2521,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  
    coh2273:k=57.2772,b=0      2.0408        2.0408       3.0612       3.0612        4.0816         5.102        9.1837        11.224        13.265        15.306        18.367       20.408  

tb_pol_w
                             z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                             __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh2:k=0.468663,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh3:k=0.493677,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh4:k=0.518692,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh5:k=0.543707,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh6:k=0.568722,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh7:k=0.593736,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh8:k=0.618751,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh9:k=0.643766,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh10:k=0.668781,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh11:k=0.693795,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh12:k=0.71881,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh13:k=0.743825,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh14:k=0.76884,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh15:k=0.793854,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh16:k=0.818869,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh17:k=0.843884,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh18:k=0.868899,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh19:k=0.893913,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh20:k=0.918928,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh21:k=0.943943,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh22:k=0.968958,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh23:k=0.993972,b=0            0             0            0            0             0             0             0             0             0             0             0            0  
    coh24:k=1.01899,b=0             0             0            0            0             0             0             0             0             0             0             0            0  
    coh25:k=1.044,b=0          1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh26:k=1.06902,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh27:k=1.09403,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh28:k=1.11905,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh29:k=1.14406,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh30:k=1.16908,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh31:k=1.19409,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh32:k=1.21911,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh33:k=1.24412,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh34:k=1.26913,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh35:k=1.29415,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh36:k=1.31916,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh37:k=1.34418,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh38:k=1.36919,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh39:k=1.39421,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh40:k=1.41922,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh41:k=1.44424,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh42:k=1.46925,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh43:k=1.49427,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh44:k=1.51928,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh45:k=1.5443,b=0         1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh46:k=1.56931,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh47:k=1.59433,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh48:k=1.61934,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh49:k=1.64436,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh50:k=1.66937,b=0        1.0204        1.0204       1.0204       1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204        1.0204       1.0204  
    coh2224:k=56.0514,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2225:k=56.0764,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2226:k=56.1015,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2227:k=56.1265,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2228:k=56.1515,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2229:k=56.1765,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2230:k=56.2015,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2231:k=56.2265,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2232:k=56.2516,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2233:k=56.2766,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2234:k=56.3016,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2235:k=56.3266,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2236:k=56.3516,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2237:k=56.3766,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2238:k=56.4016,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2239:k=56.4267,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2240:k=56.4517,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2241:k=56.4767,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2242:k=56.5017,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2243:k=56.5267,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2244:k=56.5517,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2245:k=56.5767,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2246:k=56.6018,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2247:k=56.6268,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2248:k=56.6518,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2249:k=56.6768,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2250:k=56.7018,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2251:k=56.7268,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2252:k=56.7518,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2253:k=56.7769,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2254:k=56.8019,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2255:k=56.8269,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2256:k=56.8519,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2257:k=56.8769,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2258:k=56.9019,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2259:k=56.9269,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2260:k=56.952,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2261:k=56.977,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2262:k=57.002,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2263:k=57.027,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2264:k=57.052,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2265:k=57.077,b=0           50            50           50           50            50            50            50            50            50            50            50           50  
    coh2266:k=57.1021,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2267:k=57.1271,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2268:k=57.1521,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2269:k=57.1771,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2270:k=57.2021,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2271:k=57.2271,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2272:k=57.2521,b=0          50            50           50           50            50            50            50            50            50            50            50           50  
    coh2273:k=57.2772,b=0          50            50           50           50            50            50            50            50            50            50            50           50  

</pre><img vspace="5" hspace="5" src="ff_iwkz_vf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_02.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_03.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_04.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_08.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_09.png" alt=""> <img vspace="5" hspace="5" src="ff_iwkz_vf_10.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function result_map = ff_iwkz_vf(varargin)
%% FF_IWKZ_VF solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the two step solution
% with interpolation version of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_akz_vf.html
% ff_akz_vf>. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html
% ff_wkz_evf> for details about the second stage. 
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables. 
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m ffs_akz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m ffs_akz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_akz_set_default_param(it_param_set);

% parameters can be set inside ffs_akz_set_default_param or updated here
param_map('it_w_n') = 50;
param_map('it_ak_n') = param_map('it_w_n');
param_map('it_z_n') = 15;
param_map('fl_coh_interp_grid_gap') = 0.025;
param_map('it_c_interp_grid_gap') = 10^-4;

% get armt and func map
[armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_iwkz_vf';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_w', 'ar_z'});
[ar_w, ar_z] = params_group{:};
params_group = values(armt_map, {'ar_interp_c_grid', 'ar_interp_coh_grid', ...
    'mt_interp_coh_grid_mesh_z', 'mt_z_mesh_coh_interp_grid'});
[ar_interp_c_grid, ar_interp_coh_grid, ...
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {'mt_coh_wkb', 'mt_z_mesh_coh_wkb'});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};

% param_map
params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w',...
    'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min'});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Pre-calculate u(c)
% Interpolation, see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why interpolate over u(c)

% Evaluate
if (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_neg_c = f_util_log(fl_c_min);
else
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_neg_c = f_util_crra(fl_c_min);
end
ar_interp_u_of_c_grid(ar_interp_c_grid <= fl_c_min) = fl_u_neg_c;

% Get Interpolant
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, 'spline');

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;
    
    %% Solve Second Stage Problem k*(w,z)
    % This is the key difference between this function and
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
    % ffs_akz_set_functions> which solves the two stages jointly    
    % Interpolation first, because solution coh grid is not the same as all
    % points reachable by k and b choices given w. 
    
    f_grid_interpolant_value = griddedInterpolant(...
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', 'linear');
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
    
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ...
        ff_wkz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
    
    %% Solve First Stage Problem w*(z) given k*(w,z)
    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)
        
        % Get 2nd Stage Arrays
        ar_ev_condi_z_max_z = mt_ev_condi_z_max(:, it_z_i);        
        ar_w_kstar_z = mt_ev_condi_z_max_kp(:, it_z_i);
        ar_w_astar_z = mt_ev_condi_z_max_bp(:, it_z_i);        
        
        % loop 2: over endogenous states
        for it_coh_interp_j = 1:length(ar_interp_coh_grid)
            % Get cash-on-hand which include k,b,z
            fl_coh = mt_interp_coh_grid_mesh_z(it_coh_interp_j, it_z_i);
            
            % loop 3: over choices, only w vector
            % we choose w(z), know from ff_wkz_evf k*(w,z), b*=w-k*
            ar_val_cur = zeros(size(ar_w));
            for it_cohp_k = 1:length(ar_w)                                
                fl_w_kstar_z = ar_w_kstar_z(it_cohp_k);
                fl_w_astar_z = ar_w_astar_z(it_cohp_k);
                
                % consumption
                fl_c = f_cons(fl_coh, fl_w_astar_z, fl_w_kstar_z);
                                
                % loop 4: add future utility, integration already done in
                % ff_wkz_evf
                fl_ev_condi_z_max_z = ar_ev_condi_z_max_z(it_cohp_k);
                ar_val_cur(it_cohp_k) = f_grid_interpolant_spln(fl_c) + fl_beta*fl_ev_condi_z_max_z;
                
                % Replace if negative consumption
                if fl_c <= 0
                    ar_val_cur(it_cohp_k) = fl_u_neg_c;
                end
                
            end
            
            % maximization over loop 3 choices for loop 1+2 states
            it_max_lin_idx = find(ar_val_cur == max(ar_val_cur));
            mt_val(it_coh_interp_j,it_z_i) = ar_val_cur(it_max_lin_idx(1));
            mt_pol_a(it_coh_interp_j,it_z_i) = ar_w_astar_z(it_max_lin_idx(1));
            mt_pol_k(it_coh_interp_j,it_z_i) = ar_w_kstar_z(it_max_lin_idx(1));
            
        end
    end
    
    %% Check Tolerance and Continuation
    
    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/length(ar_interp_coh_grid);
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/length(ar_interp_coh_grid);
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);
    
    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;
    
    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
                                      mean(mt_pol_a_cur,1); ...
                                      mean(mt_pol_k_cur,1); ...
                                      mt_val_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(ar_interp_coh_grid,:), highest a state val')
        disp('Hap = mt_pol_a_cur(ar_interp_coh_grid,:), highest a state choice')
        disp('mak = mt_pol_k_cur(ar_interp_coh_grid,:), highest k state choice')                
        disp(tb_valpol_iter);
    end
    
    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;        
    end
    
end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_a') = mt_pol_a;
result_map('mt_pol_k') = mt_pol_k;

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    
    % graphing based on coh_wkb, but that does not match optimal choice
    % matrixes for graphs. 
    armt_map('mt_coh_wkb') = mt_interp_coh_grid_mesh_z;
    armt_map('it_ameshk_n') = length(ar_interp_coh_grid);
    armt_map('ar_a_meshk') = mt_interp_coh_grid_mesh_z(:,1);
    armt_map('ar_k_mesha') = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);
    
    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>