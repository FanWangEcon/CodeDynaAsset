
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_akz_vf_vec</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-01"><meta name="DC.source" content="ff_akz_vf_vec.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_AKZ_VF_VEC solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Iterate Value Function</a></li><li><a href="#10">Solve Optimization Problem Current Iteration</a></li><li><a href="#11">Check Tolerance and Continuation</a></li><li><a href="#13">Process Optimal Choices</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> result_map = ff_akz_vf_vec(varargin)
</pre><h2 id="2">FF_AKZ_VF_VEC solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the vectorized version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_akz_vf.html">ff_akz_vf</a>. See that file for more descriptions.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m">ffs_akz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m">ffs_akz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_akz_set_default_param(it_param_set);
[armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_akz_vf_vec'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'mt_z_trans'</span>, <span class="string">'ar_z'</span>});
[ mt_z_trans, ar_z] = params_group{:};
params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'mt_coh'</span>, <span class="string">'it_ameshk_n'</span>});
[ar_a_meshk, ar_k_mesha, mt_coh, it_ameshk_n] = params_group{:};
<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};
<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>,<span class="keyword">...</span>
    <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_a_meshk),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a_meshk),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_a_meshk),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_a_meshk),length(ar_z));
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="10">Solve Optimization Problem Current Iteration</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:length(ar_z)

        <span class="comment">% Consumption</span>
        mt_c = f_cons(mt_coh(:, it_z_i)', ar_a_meshk, ar_k_mesha);

        <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
        <span class="keyword">if</span> (fl_crra == 1)
            mt_utility = f_util_log(mt_c);
            fl_u_neg_c = f_util_log(fl_c_min);
        <span class="keyword">else</span>
            mt_utility = f_util_crra(mt_c);
            fl_u_neg_c = f_util_crra(fl_c_min);
        <span class="keyword">end</span>

        <span class="comment">% f(z'|z)</span>
        ar_z_trans_condi = mt_z_trans(it_z_i,:);

        <span class="comment">% EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1</span>
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';

        <span class="comment">% EVAL add on future utility, N by N + N by 1</span>
        mt_utility = mt_utility + fl_beta*mt_evzp_condi_z;
        mt_utility(mt_c &lt;= fl_c_min) = fl_u_neg_c;

        <span class="comment">% Optimization: remember matlab is column major, rows must be</span>
        <span class="comment">% choices, columns must be states</span>
        <span class="comment">% &lt;https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR&gt;</span>
        [ar_opti_val1_z, ar_opti_idx_z] = max(mt_utility);
        mt_val(:,it_z_i) = ar_opti_val1_z;
        mt_pol_a(:,it_z_i) = ar_a_meshk(ar_opti_idx_z);
        mt_pol_k(:,it_z_i) = ar_k_mesha(ar_opti_idx_z);
        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        <span class="keyword">end</span>

    <span class="keyword">end</span>
</pre><h2 id="11">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n);
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(it_ameshk_n);
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
                                      mean(mt_pol_a_cur,1); <span class="keyword">...</span>
                                      mean(mt_pol_k_cur,1); <span class="keyword">...</span>
                                      mt_val_cur(it_ameshk_n,:); <span class="keyword">...</span>
                                      mt_pol_a_cur(it_ameshk_n,:); <span class="keyword">...</span>
                                      mt_pol_k_cur(it_ameshk_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_ameshk_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeoutput">VAL it_iter:5, fl_diff:1.018340e+02, fl_diff_pol:2.541385e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    5.4728    5.4938     5.518    5.5453    5.5756    5.6092     5.646    5.6866    5.7309    5.7793    5.8318    5.8882    5.9483    6.0111    6.0743
    map     23.494    23.541    23.554    22.522    22.505    21.525    20.518    19.667    18.609    17.729    16.195     14.37    12.588    10.439    8.3553
    mak     2.2628     2.265    2.3123     3.386    3.4739    4.5092    5.5676    6.4943    7.7086     8.868    10.637    12.557    14.584     17.01    19.468
    Hval    6.1722     6.184    6.1977    6.2132    6.2306    6.2502    6.2727    6.2977    6.3253    6.3564    6.3909    6.4285    6.4699    6.5136    6.5591
    Hap     35.227    35.227    35.227    34.091    34.091    34.091    32.955    31.818    30.682    30.682    28.409    26.136    26.136    22.727    20.455
    Hak     2.2727    2.2727    2.2727    3.4091    3.4091    4.5455    5.6818    6.8182    7.9545    9.0909    11.364    13.636    14.773    18.182    21.591

</pre><pre class="codeoutput">VAL it_iter:10, fl_diff:5.696553e+01, fl_diff_pol:9.913294e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    7.9796    8.0325    8.0928    8.1596    8.2324    8.3115    8.3969    8.4894    8.5891    8.6968    8.8121    8.9345    9.0639    9.1975    9.3302
    map      26.52     26.57    26.566    25.615    25.594    24.671    23.812        23    21.977    21.011      19.6    17.689    16.081    13.856    11.783
    mak     2.2431    2.2661    2.3551    3.3718     3.498    4.5114    5.4732    6.4119    7.6504    8.9262    10.617    12.698    14.769    17.364    19.947
    Hval    9.2917    9.3246     9.362    9.4034    9.4487    9.4988    9.5551     9.616    9.6818    9.7556    9.8351    9.9225    10.015    10.115    10.216
    Hap     39.773    39.773    39.773    38.636    38.636    38.636      37.5    36.364    35.227    35.227    32.955    32.955    31.818    27.273    26.136
    Hak     2.2727    2.2727    2.2727    3.4091    3.4091    4.5455    5.6818    6.8182    7.9545    9.0909    11.364      12.5    14.773    19.318    21.591

</pre><pre class="codeoutput">VAL it_iter:15, fl_diff:3.472000e+01, fl_diff_pol:7.311258e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.4392    9.5129    9.5965    9.6888    9.7891    9.8974    10.014     10.14    10.275     10.42    10.576    10.742    10.917    11.098    11.277
    map     27.384    27.429    27.338    26.533    26.439    25.637    24.857    24.114     23.09    22.052    20.688    18.955    17.186    15.064    12.998
    mak     2.2321    2.2672     2.455    3.3542    3.5782    4.5147    5.4469    6.3625    7.6032     8.935     10.62    12.645    14.841    17.421    20.065
    Hval    11.124    11.172    11.226    11.287    11.354     11.43    11.511    11.597    11.696    11.801    11.916    12.038     12.17    12.307    12.448
    Hap     40.909    40.909    40.909    39.773    40.909    39.773    38.636      37.5      37.5    36.364    36.364    32.955    31.818    30.682    28.409
    Hak     2.2727    2.2727    2.2727    3.4091    3.4091    4.5455    5.6818    6.8182    7.9545    9.0909    10.227    13.636    15.909    18.182    21.591

</pre><pre class="codeoutput">VAL it_iter:20, fl_diff:2.208867e+01, fl_diff_pol:5.515676e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.364    10.449    10.545    10.652    10.768    10.893    11.027    11.173    11.329    11.497    11.677    11.869    12.073    12.283    12.492
    map     27.787    27.823    27.739    26.946    26.797    26.047    25.267    24.539    23.549    22.527    21.132    19.446    17.669    15.699    13.493
    mak     2.2189    2.2694    2.4484    3.3465    3.6232    4.5103    5.4491    6.3713    7.6109    8.9416    10.646    12.667    14.891    17.389     20.18
    Hval    12.262    12.322     12.39    12.464    12.545    12.632    12.731    12.837     12.95    13.078    13.212    13.361    13.519    13.686    13.855
    Hap     40.909    42.045    42.045    40.909    40.909    39.773    40.909    38.636      37.5      37.5    35.227    35.227    34.091    31.818    27.273
    Hak     2.2727    2.2727    2.2727    3.4091    3.4091    4.5455    4.5455    6.8182    7.9545    9.0909    11.364      12.5    14.773    18.182    22.727

</pre><pre class="codeoutput">VAL it_iter:25, fl_diff:1.447005e+01, fl_diff_pol:4.412965e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.976    11.067     11.17    11.284    11.408    11.542    11.687    11.843    12.011    12.192    12.387    12.595    12.815    13.044    13.272
    map     27.959    27.997    27.891    27.127    26.946    26.247    25.494    24.845    23.803    22.743    21.403    19.758    17.951    15.898    13.673
    mak       2.22    2.2694    2.4791    3.3454    3.6627     4.507    5.4436    6.3241     7.601     8.946    10.634    12.646    14.908    17.466    20.296
    Hval    13.001    13.066    13.138    13.219    13.306    13.406    13.514     13.63    13.759    13.898     14.05    14.212    14.391    14.577    14.758
    Hap     42.045    42.045    42.045    40.909    39.773    40.909    39.773    38.636    38.636      37.5      37.5    34.091    32.955    31.818    27.273
    Hak     2.2727    2.2727    2.2727    3.4091    4.5455    4.5455    5.6818    6.8182    7.9545    9.0909    10.227    13.636    15.909    18.182    22.727

</pre><pre class="codeoutput">VAL it_iter:30, fl_diff:9.635349e+00, fl_diff_pol:3.847286e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    11.388    11.482    11.589    11.707    11.836    11.975    12.125    12.287    12.462    12.651    12.854    13.072    13.303    13.543    13.783
    map     28.057    28.104    27.977    27.253    27.107    26.387    25.669     24.96     23.94     22.85    21.585     19.83    18.193     16.08    13.898
    mak     2.2222    2.2694    2.5044     3.341    3.6298    4.5114    5.4117    6.3252    7.5878    8.9822    10.621    12.705    14.866    17.464    20.262
    Hval    13.485    13.554     13.63    13.715     13.81    13.917     14.03    14.151    14.289    14.433    14.597    14.769    14.956    15.155    15.343
    Hap     42.045    42.045    40.909    40.909    42.045    40.909    39.773    40.909    38.636      37.5    36.364    36.364    32.955    31.818    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    15.909    18.182    22.727

</pre><pre class="codeoutput">VAL it_iter:35, fl_diff:6.577823e+00, fl_diff_pol:2.663837e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    11.673    11.769    11.878    11.998    12.129     12.27    12.423    12.588    12.767     12.96    13.168    13.391    13.628    13.875    14.121
    map     28.106    28.154    28.072    27.307    27.222    26.446    25.727    24.992    23.993    22.923    21.618    19.881    18.247    16.267    14.056
    mak       2.22    2.2694    2.4649    3.3421    3.5837    4.5136    5.4073    6.3428    7.5922     8.991    10.659    12.732    14.881    17.408    20.224
    Hval    13.803    13.874    13.952    14.039     14.14    14.249    14.364    14.493    14.634    14.784    14.953    15.135    15.328    15.535    15.729
    Hap     42.045    42.045    40.909    40.909    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:40, fl_diff:4.598622e+00, fl_diff_pol:1.846437e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    11.876    11.972    12.082    12.203    12.334    12.477    12.631    12.798    12.978    13.173    13.384    13.609     13.85      14.1     14.35
    map      28.13    28.179    28.121    27.338    27.256    26.467     25.76    25.008    24.012    22.956    21.614     19.94    18.281    16.341    14.089
    mak       2.22    2.2694    2.4462     3.341    3.5716    4.5147    5.4018    6.3494    7.6021    9.0009    10.692    12.721    14.881    17.392    20.247
    Hval    14.021    14.092    14.171     14.26    14.363    14.473    14.589    14.721    14.864    15.019     15.19    15.377    15.575    15.786    15.982
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:45, fl_diff:3.267848e+00, fl_diff_pol:2.346595e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.021    12.118    12.228    12.349    12.481    12.624    12.779    12.947    13.128    13.324    13.536    13.762    14.004    14.256    14.508
    map     28.135    28.188    28.136    27.352    27.272    26.476    25.758    25.009    24.027    22.993    21.604    19.975    18.278    16.331     14.11
    mak       2.22    2.2694    2.4429     3.341    3.5672    4.5158    5.4084     6.356    7.5999    8.9943    10.713     12.71    14.895    17.417    20.253
    Hval    14.174    14.245    14.324    14.414    14.518    14.628    14.746    14.879    15.023    15.179    15.353    15.541    15.742    15.954    16.152
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:50, fl_diff:2.347163e+00, fl_diff_pol:1.055853e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.126    12.223    12.333    12.455    12.587     12.73    12.886    13.053    13.235    13.432    13.644    13.871    14.114    14.367    14.619
    map     28.141    28.197    28.149    27.356    27.283    26.481    25.763    25.011    24.045    22.996      21.6    19.989    18.275    16.333     14.14
    mak     2.2211    2.2694    2.4374    3.3421    3.5628    4.5147    5.4073    6.3603    7.5933    8.9987     10.72    12.703    14.903    17.423    20.238
    Hval    14.282    14.353    14.433    14.524    14.628    14.738    14.856     14.99    15.134    15.292    15.466    15.656    15.858    16.071    16.269
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:55, fl_diff:1.697769e+00, fl_diff_pol:6.943015e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.202    12.299    12.409    12.531    12.664    12.807    12.962     13.13    13.312    13.509    13.722    13.949    14.192    14.445    14.698
    map     28.144    28.198    28.152    27.358    27.286    26.486    25.761    25.015    24.043    22.998    21.601        20    18.274    16.333    14.135
    mak     2.2211    2.2694    2.4363     3.341    3.5628    4.5136    5.4117    6.3592    7.5966    8.9987     10.72    12.698    14.907    17.429    20.247
    Hval     14.36    14.432    14.512    14.602    14.706    14.817    14.935    15.069    15.214    15.372    15.546    15.737     15.94    16.153    16.351
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:60, fl_diff:1.233904e+00, fl_diff_pol:3.879788e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.258    12.355    12.465    12.587    12.719    12.863    13.018    13.186    13.368    13.565    13.778    14.006    14.249    14.502    14.756
    map     28.144    28.199    28.157    27.358    27.286    26.487    25.764    25.018     24.04    22.997      21.6    20.012    18.278    16.326    14.132
    mak     2.2211    2.2694    2.4352     3.341    3.5628    4.5136    5.4106    6.3592    7.5988    9.0009    10.722    12.691    14.904    17.436    20.251
    Hval    14.417    14.488    14.568    14.659    14.763    14.874    14.992    15.126    15.271     15.43    15.604    15.795    15.998    16.211     16.41
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:65, fl_diff:8.996836e-01, fl_diff_pol:3.409091e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.298    12.395    12.506    12.627     12.76    12.904    13.059    13.227    13.409    13.606    13.819    14.047     14.29    14.543    14.797
    map     28.146    28.202    28.159    27.359    27.287    26.487    25.763    25.019    24.043    23.002    21.599    20.016    18.276    16.323    14.127
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5136    5.4117    6.3592    7.5977    8.9987    10.724    12.689    14.907     17.44    20.256
    Hval    14.458    14.529    14.609      14.7    14.805    14.915    15.033    15.168    15.313    15.471    15.646    15.837     16.04    16.253    16.452
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:70, fl_diff:6.574248e-01, fl_diff_pol:4.148047e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.328    12.425    12.535    12.657     12.79    12.933    13.089    13.257    13.439    13.636    13.849    14.077     14.32    14.573    14.827
    map     28.146    28.203    28.159    27.361    27.286    26.487    25.765    25.021    24.044    23.001    21.599    20.016    18.281     16.33    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5639    4.5136    5.4106    6.3581    7.5977    8.9998    10.724    12.689    14.904    17.435    20.247
    Hval    14.488    14.559    14.639     14.73    14.835    14.946    15.063    15.198    15.343    15.501    15.676    15.867     16.07    16.284    16.483
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:75, fl_diff:4.811023e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     12.35    12.447    12.557    12.679    12.812    12.955    13.111    13.279    13.461    13.658    13.871    14.099    14.342    14.595    14.849
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765    25.021    24.046    23.001    21.601    20.016    18.287     16.33    14.143
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3581    7.5966    8.9998    10.722    12.689      14.9    17.435    20.246
    Hval     14.51    14.581    14.661    14.752    14.857    14.967    15.085     15.22    15.365    15.523    15.698    15.889    16.092    16.306    16.505
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:80, fl_diff:3.524112e-01, fl_diff_pol:3.409091e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.366    12.463    12.573    12.695    12.827    12.971    13.127    13.295    13.477    13.674    13.887    14.114    14.358    14.611    14.865
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765    25.021    24.046    23.001    21.603    20.016    18.287    16.329    14.143
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3581    7.5966    8.9998    10.721    12.689      14.9    17.436    20.246
    Hval    14.526    14.597    14.677    14.768    14.873    14.984    15.101    15.236    15.381     15.54    15.714    15.905    16.109    16.322    16.521
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:85, fl_diff:2.583099e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.377    12.474    12.585    12.707    12.839    12.983    13.138    13.307    13.489    13.686    13.898    14.126    14.369    14.623    14.877
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765    25.021    24.046    23.001    21.603     20.02    18.287    16.329    14.143
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3581    7.5966    8.9998    10.721    12.687      14.9    17.436    20.246
    Hval    14.538    14.609    14.689     14.78    14.884    14.995    15.113    15.248    15.393    15.551    15.726    15.917     16.12    16.334    16.533
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:90, fl_diff:1.894161e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.386    12.483    12.593    12.715    12.848    12.991    13.147    13.315    13.497    13.694    13.907    14.135    14.378    14.632    14.885
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.546    14.618    14.698    14.789    14.893    15.004    15.122    15.256    15.401     15.56    15.735    15.926    16.129    16.342    16.541
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:95, fl_diff:1.389359e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.392    12.489      12.6    12.721    12.854    12.998    13.153    13.321    13.503      13.7    13.913    14.141    14.384    14.638    14.891
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.553    14.624    14.704    14.795    14.899     15.01    15.128    15.263    15.408    15.566    15.741    15.932    16.135    16.349    16.548
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:100, fl_diff:1.019277e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.397    12.494    12.604    12.726    12.859    13.002    13.158    13.326    13.508    13.705    13.918    14.146    14.389    14.643    14.896
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.557    14.629    14.709      14.8    14.904    15.015    15.133    15.267    15.412    15.571    15.746    15.937     16.14    16.353    16.552
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:105, fl_diff:7.478654e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval      12.4    12.497    12.608    12.729    12.862    13.006    13.161    13.329    13.511    13.708    13.921    14.149    14.392    14.646    14.899
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.561    14.632    14.712    14.803    14.907    15.018    15.136    15.271    15.416    15.574    15.749     15.94    16.143    16.357    16.556
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:110, fl_diff:5.487697e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.403      12.5     12.61    12.732    12.865    13.008    13.164    13.332    13.514    13.711    13.924    14.152    14.395    14.649    14.902
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.563    14.635    14.715    14.806     14.91    15.021    15.139    15.273    15.418    15.577    15.751    15.942    16.146    16.359    16.558
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeoutput">VAL it_iter:115, fl_diff:4.026990e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    12.405    12.502    12.612    12.734    12.866     13.01    13.165    13.334    13.516    13.713    13.926    14.153    14.397     14.65    14.904
    map     28.146    28.203    28.159    27.361    27.288    26.486    25.765     25.02    24.046    23.001    21.603     20.02    18.287    16.329    14.141
    mak     2.2211    2.2694    2.4341     3.341    3.5628    4.5147    5.4106    6.3592    7.5966    8.9998    10.721    12.687      14.9    17.436    20.247
    Hval    14.565    14.636    14.716    14.807    14.912    15.023     15.14    15.275     15.42    15.579    15.753    15.944    16.148    16.361     16.56
    Hap     42.045    42.045    40.909    42.045    42.045    40.909    39.773    40.909    38.636    38.636    36.364    36.364    35.227    30.682    27.273
    Hak     2.2727    2.2727    3.4091    3.4091    3.4091    4.5455    5.6818    5.6818    7.9545    9.0909    11.364      12.5    14.773    19.318    22.727

</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 73.633852 seconds.
</pre><h2 id="13">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                 valgap     polgap        z1            z2           z3            z4            z5            z6            z7            z8            z9           z10           z11           z12           z13           z14           z15    
                ________    ______    __________    __________    _________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________

    iter=1        204.27     249.2             1             1            1             1             1             1             1             1             1             1             1             1             1             1             1
    iter=2        161.45    2516.4       0.98937       0.98937      0.98599       0.98261       0.97778       0.97343       0.96184       0.95072       0.93478       0.91643       0.88744       0.85459       0.79324       0.71884       0.62029
    iter=3        135.75    839.31        0.5256        0.5256      0.53188       0.58309       0.60338       0.58792       0.69903        0.7058       0.62126       0.72174       0.71643       0.69082        0.7058       0.64589       0.63333
    iter=4        116.79    415.78       0.50097       0.49952      0.52464       0.56377       0.58599       0.53623       0.70193       0.73188       0.55797       0.69662       0.68261       0.67874       0.72802       0.59758       0.57874
    iter=5        101.83    254.14       0.46908       0.46957      0.50531       0.54734       0.59903       0.49034       0.63092       0.65797       0.54686       0.61691        0.6058       0.57633       0.66377       0.53768       0.54686
    iter=6        89.634    178.69        0.4087       0.40966      0.47053       0.45845       0.53575       0.43961       0.60918       0.69807       0.54928       0.61159       0.65314       0.62174        0.6343       0.54155        0.5401
    iter=7        79.447    137.33       0.32271       0.32415      0.39082       0.35507       0.45169       0.35217       0.51014       0.62367       0.49179        0.4971       0.60338       0.60725       0.61643       0.54444       0.54203
    iter=8        70.803    124.77       0.24348       0.23961      0.31159       0.26715       0.37923       0.26425       0.41884       0.57923       0.45362       0.39082       0.66425       0.65749       0.68744       0.61208       0.60386
    iter=9        63.384    117.76       0.19227       0.18696       0.2599       0.21401           0.3       0.21353       0.36329       0.53913       0.41304       0.31836       0.64879       0.63285        0.7343       0.58647        0.6372
    iter=10       56.966    99.133       0.14783       0.13768      0.23671       0.15797       0.25604       0.15072       0.30242       0.46184       0.35072       0.27343       0.58068       0.59855       0.64203       0.57295       0.60483
    iter=11       51.341    96.961       0.11353       0.10918      0.21304       0.13382       0.23575       0.13382       0.26908       0.40386       0.34058       0.23382       0.52174        0.5372       0.52415       0.53865       0.55411
    iter=12       46.401    81.374       0.10338      0.092754      0.20097       0.11787       0.21546      0.097585       0.21787       0.32319       0.28261       0.20773        0.4401       0.46232       0.49758       0.47585       0.54589
    iter=13       42.048    82.173      0.081159      0.071981      0.18261      0.095169       0.20676      0.092271       0.20676       0.29614       0.25894       0.17778       0.36377       0.38551       0.40821       0.44251       0.48454
    iter=14       38.173    82.554       0.06715      0.055072      0.16908      0.076812       0.20193      0.071014       0.17778       0.25749        0.2372       0.17246       0.31159       0.35121       0.30483       0.36763       0.45894
    iter=15        34.72    73.113      0.061353      0.049275      0.14348      0.072947       0.18357      0.070048       0.15024       0.21159       0.21304       0.14928       0.28406       0.31981       0.31546       0.34348       0.41353
    iter=16       31.634    69.378      0.058937      0.048792      0.12271      0.066184       0.12995      0.062802       0.12609       0.17295       0.18261       0.13478        0.2285       0.24928       0.27391       0.33285       0.34589
    iter=17        28.86    67.217      0.050725      0.043961          0.1      0.057488       0.12319      0.043478       0.11063       0.16232       0.17005       0.13237       0.20676       0.20145       0.24783       0.31594        0.3401
    iter=18       26.359    62.518      0.051691       0.03285     0.074879      0.044928       0.10628      0.035266        0.1029       0.14444       0.15942       0.13768       0.17391       0.19469       0.20725       0.24831       0.26184
    iter=19        24.11    61.923      0.037681      0.027053      0.06715      0.042995      0.082126      0.030435      0.086473       0.13188       0.14251       0.11401       0.14203       0.16957       0.14638       0.21884       0.25072
    iter=20       22.089    55.157      0.026087      0.023671     0.050725      0.041063      0.071498      0.028019      0.068599       0.12367       0.12705       0.10145        0.1285       0.14155       0.14783       0.18261       0.24106
    iter=21       20.263    54.205      0.028502      0.018357     0.051208      0.029469      0.068599      0.023671      0.071014       0.10628       0.11594      0.073913       0.10918       0.13333       0.15362       0.18213       0.23237
    iter=22       18.607    52.297      0.023188      0.018841     0.062319      0.030435        0.0657      0.024155      0.050725      0.092754      0.084058      0.073913       0.10242        0.1343       0.14831        0.1686       0.18068
    iter=23       17.099    47.639      0.022705      0.013527     0.049275      0.027053      0.052174      0.022222      0.054106      0.087923      0.076812      0.081159      0.098551      0.090338       0.11594       0.12802       0.16039
    iter=24       15.725    46.708      0.020773      0.014493     0.048792      0.025121      0.068116      0.018841      0.039614      0.070531      0.072464      0.069565      0.064734      0.091787      0.090821       0.14444       0.14928
    iter=25        14.47     44.13      0.016908      0.011594     0.047343      0.017874      0.056039      0.019807      0.035749      0.067633      0.055072      0.057488      0.074396      0.069565           0.1       0.12077       0.11401
    iter=26       13.322    42.647      0.015459      0.011111     0.042029      0.017391      0.046377      0.023671      0.042029        0.0657      0.047343      0.071014      0.068599      0.081159      0.095169       0.13382       0.11643
    iter=27       12.271    39.678       0.01401      0.013043     0.049758      0.015459       0.04686      0.015942      0.034783      0.045411       0.05314       0.07343      0.069565      0.065217      0.086957       0.10242      0.094686
    iter=28       11.311    39.395      0.011594     0.0082126     0.036715      0.012077      0.036715       0.01401      0.028986      0.033816      0.038647      0.054589      0.069565      0.067633      0.079227      0.086957      0.099517
    iter=29       10.434    38.226     0.0091787     0.0072464     0.037681      0.014976      0.027536      0.016425      0.031884      0.044444      0.042995      0.065217      0.045411      0.047343        0.0657       0.07971      0.081643
    iter=30       9.6353    38.473     0.0072464     0.0072464       0.0343      0.012077       0.02029      0.011594      0.016425      0.028986      0.031884      0.048792      0.038647      0.037198      0.060386      0.078261      0.081643
    iter=31       8.9073    33.725     0.0048309     0.0057971     0.015942     0.0072464      0.016908     0.0096618      0.019324      0.031884      0.024155      0.033816      0.042029      0.041546      0.049275       0.08599      0.062319
    iter=32       8.2438    35.301     0.0072464      0.005314     0.014976     0.0062802      0.017391     0.0072464      0.021739      0.022222      0.027053      0.050725      0.028986      0.041546      0.055072      0.062802      0.070531
    iter=33       7.6381    31.264     0.0043478     0.0038647    0.0096618     0.0072464      0.016908     0.0067633      0.021256      0.021256      0.026087      0.028986      0.031884      0.034783      0.035749      0.058454      0.056039
    iter=34       7.0845    31.041     0.0043478      0.005314    0.0086957     0.0086957       0.01401     0.0082126      0.015459      0.015459      0.017391      0.029952      0.028019      0.022222      0.028019      0.046377      0.058937
    iter=35       6.5778    26.638     0.0038647     0.0019324    0.0091787     0.0038647     0.0067633     0.0028986      0.010628      0.011594      0.011594       0.03285      0.023188      0.029469      0.021256      0.047343      0.043478
    iter=36       6.1133    29.847    0.00096618     0.0024155    0.0033816     0.0028986     0.0072464     0.0014493      0.011594      0.013527      0.015459      0.023188       0.01256       0.02029      0.025604      0.040097      0.043478
    iter=37       5.6866    22.275     0.0057971     0.0019324    0.0033816     0.0057971      0.005314     0.0019324     0.0067633     0.0096618     0.0086957      0.016425      0.023188      0.014493      0.018357      0.035749      0.039614
    iter=38        5.294    25.575     0.0028986    0.00048309    0.0091787     0.0028986     0.0019324     0.0057971     0.0096618     0.0077295      0.013527      0.023188      0.015459      0.018357       0.01256      0.026087      0.033333
    iter=39       4.9323     20.37    0.00096618     0.0038647    0.0077295     0.0028986      0.005314     0.0038647     0.0057971     0.0096618      0.010628      0.019324     0.0096618      0.013527      0.018357      0.025121      0.030918
    iter=40       4.5986    18.464     0.0014493     0.0019324    0.0057971    0.00048309      0.005314    0.00048309     0.0096618     0.0038647      0.011594      0.019324      0.019324      0.015459      0.010628      0.031884      0.031401
    iter=41       4.2902    17.423    0.00096618    0.00096618    0.0019324    0.00048309     0.0038647     0.0014493     0.0067633     0.0057971     0.0028986     0.0086957     0.0077295     0.0067633     0.0086957      0.016425      0.014493
    iter=42       4.0049    15.482    0.00048309    0.00096618    0.0028986     0.0028986             0    0.00096618    0.00096618     0.0038647     0.0067633      0.017391     0.0038647     0.0096618     0.0086957      0.015459      0.018357
    iter=43       3.7406    14.566             0     0.0014493    0.0048309    0.00096618     0.0014493             0     0.0028986     0.0048309     0.0028986      0.014493     0.0038647     0.0067633     0.0038647     0.0067633      0.022222
    iter=44       3.4954    11.956    0.00048309    0.00048309            0     0.0019324     0.0028986     0.0038647     0.0019324    0.00096618     0.0057971     0.0077295      0.011594     0.0057971      0.010628      0.014493      0.010628
    iter=45       3.2678    23.466             0    0.00048309    0.0024155     0.0019324     0.0014493    0.00048309    0.00096618     0.0038647     0.0028986      0.010628      0.010628     0.0067633     0.0086957       0.01256      0.022222
    iter=46       3.0564    15.107     0.0014493    0.00048309            0    0.00096618             0    0.00096618             0     0.0028986     0.0038647     0.0077295     0.0057971     0.0028986     0.0067633      0.010628      0.010628
    iter=47       2.8597     13.22     0.0014493     0.0014493    0.0028986             0             0    0.00048309     0.0038647     0.0057971     0.0057971     0.0028986     0.0028986     0.0019324     0.0028986     0.0048309     0.0057971
    iter=48       2.6767    14.932    0.00096618     0.0014493            0     0.0028986     0.0019324             0             0     0.0028986     0.0028986    0.00096618     0.0019324    0.00096618     0.0038647     0.0067633     0.0096618
    iter=49       2.5061     10.12    0.00048309             0    0.0019324    0.00048309     0.0014493    0.00048309    0.00096618    0.00096618    0.00096618     0.0048309    0.00096618     0.0019324     0.0048309     0.0048309     0.0086957
    iter=50       2.3472    10.559             0    0.00048309    0.0024155    0.00048309     0.0014493    0.00048309     0.0019324     0.0028986             0     0.0038647    0.00096618    0.00096618     0.0019324     0.0028986     0.0048309
    iter=66      0.84485    8.0353             0    0.00048309            0             0    0.00096618             0    0.00096618             0             0             0             0             0             0             0     0.0019324
    iter=67      0.79341    5.6818             0             0            0    0.00048309             0             0             0             0    0.00096618             0             0             0             0    0.00096618    0.00096618
    iter=68      0.74517    8.2788             0             0            0             0             0             0             0             0             0             0             0             0             0             0     0.0019324
    iter=69       0.6999    5.6818             0             0            0             0             0             0             0    0.00096618    0.00096618    0.00096618             0             0    0.00096618    0.00096618             0
    iter=70      0.65742     4.148             0             0            0             0             0             0             0             0             0             0             0             0    0.00096618             0     0.0019324
    iter=71      0.61756    3.4091             0             0            0             0             0    0.00096618             0             0    0.00096618             0    0.00096618             0    0.00096618             0    0.00096618
    iter=72      0.58015    3.4091             0             0            0             0    0.00096618             0             0             0             0             0             0             0             0             0             0
    iter=73      0.54503         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=74      0.51206    7.9545             0             0            0             0             0             0             0             0             0             0             0             0    0.00096618             0             0
    iter=75       0.4811         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=76      0.45203         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=77      0.42474    2.2727             0             0            0             0             0             0             0             0             0             0             0             0             0    0.00096618             0
    iter=78       0.3991         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=79      0.37503         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=80      0.35241    3.4091             0             0            0             0             0             0             0             0             0             0    0.00096618             0             0             0             0
    iter=81      0.33117         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=82      0.31121         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=83      0.29247    5.6818             0             0            0             0             0             0             0             0             0             0             0    0.00096618             0             0             0
    iter=84      0.27486         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=85      0.25831         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=86      0.24276         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=87      0.22816    2.2727             0             0            0             0             0             0             0    0.00096618             0             0             0             0             0             0             0
    iter=88      0.21443         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=89      0.20153    2.2727             0             0            0             0             0             0             0             0             0             0             0             0             0             0    0.00096618
    iter=90      0.18942         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=91      0.17803         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=92      0.16733         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=93      0.15727         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=94      0.14782         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=95      0.13894         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=96      0.13059         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=97      0.12274         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=98      0.11537         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=99      0.10844         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=100     0.10193         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=101    0.095806         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=102    0.090053         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=103    0.084646         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=104    0.079564         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=105    0.074787         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=106    0.070297         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=107    0.066076         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=108     0.06211         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=109    0.058381         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=110    0.054877         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=111    0.051583         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=112    0.048487         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=113    0.045577         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=114    0.042841         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0
    iter=115     0.04027         0             0             0            0             0             0             0             0             0             0             0             0             0             0             0             0

tb_val
                                   z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                   __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                    -16.699       -16.699       -16.699      -16.699      -16.699       -16.699       -16.699       -16.699       -16.699       -16.699       -16.699       -16.699 
    coh2:k=1.13636,b=0               1.7487        2.0008        2.2782       2.5692       2.8689        3.1769        4.5963        5.0387        5.5097        5.9853        6.4382        6.8419 
    coh3:k=0,b=1.13636               2.3887        2.7278        3.0946       3.4766       3.8685        4.2691        6.0507        6.8081        7.4837        8.1037        8.6724        9.1779 
    coh4:k=2.27273,b=0               3.1603        3.4124        3.6898       3.9808       4.2805        4.5885        6.0079        6.4502        6.9213        7.3969        7.8498        8.2535 
    coh5:k=1.13636,b=1.13636         3.6302        3.9925        4.3806       4.7796       5.1826        5.5867        7.2377        7.6797        8.1382        8.6824        9.2242        9.7098 
    coh6:k=0,b=2.27273               3.6501        4.0327        4.4386        4.853       5.2688        5.6832         7.354        7.8528        8.4201        8.9552        9.4576        9.9128 
    coh7:k=3.40909,b=0               4.4019        4.6771        4.9758       5.2838       5.5946        5.9061        7.1949        7.5509         7.926        8.3113        8.6896        9.0361 
    coh8:k=2.27273,b=1.13636         4.5237        4.8206        5.1431       5.4772       5.8646        6.2735        7.9041        8.3207        8.7482        9.1827        9.6507        10.121 
    coh9:k=1.13636,b=2.27273         4.5285        4.8311        5.1595       5.5346       5.9508          6.37        8.0204        8.4377        8.8845        9.4004        9.8841        10.324 
    coh10:k=0,b=3.40909              4.5216        4.8287        5.1618       5.5558       5.9842        6.4125        8.0805        8.5019        9.0274        9.5242        9.9928        10.458 
    coh11:k=4.54545,b=0              5.1435        5.3844        5.6622       5.9641       6.2766        6.5929        7.8613        8.1919         8.536          8.89        9.2414         9.568 
    coh12:k=3.40909,b=1.13636        5.2624        5.5245        5.8295       6.1575       6.4984        6.8454        8.3956        8.8013        9.2126        9.6279        10.038        10.463 
    coh13:k=2.27273,b=2.27273        5.2671        5.5349        5.8459       6.1799       6.5269        6.8859        8.5119        8.9182        9.3289        9.7668        10.237        10.666 
    coh14:k=1.13636,b=3.40909        5.2603        5.5325        5.8483       6.1869       6.5385         6.927        8.5719        8.9793        9.4068        9.8905        10.346        10.763 
    coh15:k=0,b=4.54545              5.2477        5.5241        5.8439       6.1868       6.5424         6.947        8.6098        9.0185        9.4916        9.9655        10.413        10.873 
    coh16:k=5.68182,b=0               5.806        6.0213        6.2632       6.5266       6.8084        7.1074        8.3527        8.6724        9.0004        9.3353        9.6679        9.9793 
    coh17:k=4.54545,b=1.13636        5.9219        6.1582        6.4233       6.7156       7.0291        7.3598        8.7951        9.1919         9.592        9.9943        10.391        10.766 
    coh18:k=3.40909,b=2.27273        5.9265        6.1682        6.4393       6.7375       7.0576        7.3943        8.9114        9.3088        9.7083        10.109        10.545        10.965 
    coh19:k=2.27273,b=3.40909        5.9199         6.166        6.4416       6.7444       7.0692        7.4104        8.9714        9.3699        9.7695        10.207        10.653        11.062 
    coh20:k=1.13636,b=4.54545        5.9076        6.1578        6.4374       6.7443       7.0732        7.4182        9.0093        9.4091        9.8185        10.282         10.72        11.141 
    coh21:k=0,b=5.68182              5.8914        6.1456         6.429       6.7399       7.0725        7.4212        9.0353        9.4367        9.8758        10.334        10.767        11.218 
    coh22:k=6.81818,b=0              6.3939        6.5865        6.8045       7.0392       7.2913          7.56        8.7523        9.0631        9.3797        9.7129        10.045        10.357 
    coh23:k=5.68182,b=1.13636         6.507        6.7202        6.9606       7.2225       7.5042         7.807        9.1492        9.5281        9.9189        10.311        10.699        11.064 
    coh24:k=4.54545,b=2.27273        6.5115        6.7301         6.976       7.2441       7.5322        7.8412        9.2562         9.645        10.035        10.426         10.82        11.233 
    coh25:k=3.40909,b=3.40909         6.505        6.7279        6.9782       7.2508       7.5436        7.8573        9.3163        9.7061        10.096        10.491        10.929         11.33 
    coh26:k=2.27273,b=4.54545         6.493        6.7198        6.9741       7.2507       7.5475        7.8651        9.3541        9.7453        10.136        10.566        10.996         11.39 
    coh27:k=1.13636,b=5.68182        6.4771        6.7079        6.9661       7.2464       7.5469        7.8681        9.3802        9.7729        10.169        10.618        11.043        11.464 
    coh28:k=0,b=6.81818              6.4583         6.693        6.9551       7.2391       7.5431        7.8678        9.3989        9.7933         10.21        10.656        11.078        11.519 
    coh29:k=7.95455,b=0              6.9208        7.0949        7.2924       7.5059       7.7338        7.9768        9.1299        9.4407        9.7574        10.079        10.399        10.699 
    coh30:k=6.81818,b=1.13636        7.0313        7.2257         7.445       7.6839       7.9412        8.2172         9.494         9.837        10.212        10.595        10.974        11.332 
    coh31:k=5.68182,b=2.27273        7.0358        7.2353        7.4601        7.705       7.9681        8.2505        9.5677        9.9469        10.328         10.71        11.086        11.479 
    coh32:k=4.54545,b=3.40909        7.0294        7.2332        7.4623       7.7117       7.9791         8.266        9.6278        10.008        10.389         10.77        11.181        11.575 
    coh33:k=3.40909,b=4.54545        7.0176        7.2253        7.4583       7.7115       7.9829        8.2736        9.6657        10.047        10.429        10.826        11.248        11.636 
    coh34:k=2.27273,b=5.68182        7.0021        7.2136        7.4504       7.7073       7.9823        8.2765        9.6917        10.075        10.457        10.878        11.295        11.692 
    coh35:k=1.13636,b=6.81818        6.9836         7.199        7.4397       7.7001       7.9787        8.2763        9.7104        10.095        10.479        10.916         11.33        11.747 
    coh36:k=0,b=7.95455              6.9626         7.182        7.4266       7.6907       7.9728        8.2737        9.7242        10.111         10.51        10.945        11.357        11.789 
    coh37:k=9.09091,b=0              7.3967        7.5559        7.7364       7.9319       8.1406        8.3643        9.4747        9.7769        10.084        10.396        10.706        10.998 
    coh38:k=7.95455,b=1.13636        7.5049        7.6837        7.8857       8.1058       8.3436        8.5976        9.8056        10.139         10.48        10.855        11.226        11.578 
    coh39:k=6.81818,b=2.27273        7.5092        7.6932        7.9006       8.1265         8.37        8.6304        9.8614        10.223        10.596        10.969        11.338        11.707 
    coh40:k=5.68182,b=3.40909         7.503        7.6911        7.9027        8.133       8.3808        8.6456        9.9144        10.284        10.657         11.03        11.416        11.803 
    coh41:k=4.54545,b=4.54545        7.4914        7.6833        7.8987       8.1329       8.3845         8.653        9.9516        10.323        10.697         11.07        11.483        11.864 
    coh42:k=3.40909,b=5.68182        7.4762        7.6719         7.891       8.1287       8.3839        8.6559        9.9777        10.351        10.725        11.119        11.529        11.906 
    coh43:k=2.27273,b=6.81818        7.4582        7.6576        7.8805       8.1217       8.3804        8.6556        9.9964        10.371        10.746        11.158        11.564        11.961 
    coh44:k=1.13636,b=7.95455        7.4376         7.641        7.8677       8.1124       8.3747        8.6531         10.01        10.387        10.763        11.187        11.592        12.003 
    coh45:k=0,b=9.09091              7.4147        7.6223        7.8529       8.1013       8.3671        8.6488         10.02        10.399        10.784         11.21        11.614        12.036 
    coh46:k=10.2273,b=0              7.8299        7.9769        8.1436       8.3243       8.5175        8.7251        9.7863        10.079        10.377         10.68        10.982        11.266 
    coh47:k=9.09091,b=1.13636        7.9357        8.1019        8.2897       8.4945       8.7162        8.9531        10.092        10.415        10.747        11.097        11.461        11.806 
    coh48:k=7.95455,b=2.27273        7.9399        8.1112        8.3042       8.5149       8.7422        8.9852        10.147        10.482        10.845        11.211        11.573        11.921 
    coh49:k=6.81818,b=3.40909        7.9338        8.1091        8.3063       8.5212       8.7528        9.0002        10.187        10.543        10.907        11.272        11.636        12.017 
    coh50:k=5.68182,b=4.54545        7.9225        8.1015        8.3025       8.5211       8.7564        9.0075        10.223        10.582        10.946        11.312        11.703        12.078 
    coh986:k=4.54545,b=44.3182       14.484        14.555        14.641       14.734       14.834        14.942        15.502        15.673        15.866         16.07        16.284          16.5 
    coh987:k=3.40909,b=45.4545       14.477        14.547        14.632       14.726       14.828        14.936        15.498         15.67        15.863        16.068        16.283          16.5 
    coh988:k=2.27273,b=46.5909        14.47         14.54        14.623       14.719       14.821        14.931        15.493        15.667        15.861        16.066        16.282          16.5 
    coh989:k=1.13636,b=47.7273       14.462        14.533        14.614       14.711       14.814        14.925        15.489        15.664        15.858        16.064        16.281          16.5 
    coh990:k=0,b=48.8636             14.454        14.526        14.607       14.703       14.807        14.919        15.485        15.661        15.855        16.062         16.28          16.5 
    coh991:k=50,b=0                  14.825        14.873        14.928       14.989       15.055        15.127         15.48        15.589        15.707        15.837        15.973        16.107 
    coh992:k=48.8636,b=1.13636       14.849        14.901        14.962       15.029       15.104        15.185        15.587        15.712        15.849        15.996         16.15        16.305 
    coh993:k=47.7273,b=2.27273        14.85        14.904        14.966       15.037       15.114        15.197        15.612        15.741        15.881        16.032        16.192        16.355 
    coh994:k=46.5909,b=3.40909       14.848        14.903        14.967       15.039       15.118        15.203        15.627        15.758          15.9        16.058        16.223        16.387 
    coh995:k=45.4545,b=4.54545       14.846        14.901        14.966       15.039       15.119        15.206        15.636        15.769        15.917        16.077        16.244         16.41 
    coh996:k=44.3182,b=5.68182       14.842        14.899        14.963       15.038       15.119        15.208        15.643        15.779        15.931        16.092         16.26         16.43 
    coh997:k=43.1818,b=6.81818       14.838        14.895         14.96       15.035       15.118        15.208        15.649        15.788        15.941        16.104        16.273        16.448 
    coh998:k=42.0455,b=7.95455       14.834        14.891        14.957       15.032       15.116        15.207        15.652        15.794        15.949        16.113        16.287        16.462 
    coh999:k=40.9091,b=9.09091       14.829        14.887        14.954       15.028       15.113        15.205        15.655          15.8        15.956        16.121        16.298        16.474 
    coh1000:k=39.7727,b=10.2273      14.823        14.882         14.95       15.025       15.109        15.202        15.658        15.804        15.961        16.127        16.307        16.484 
    coh1001:k=38.6364,b=11.3636      14.818        14.878        14.945       15.021       15.105          15.2         15.66        15.807        15.966        16.133        16.315        16.493 
    coh1002:k=37.5,b=12.5            14.812        14.872        14.941       15.018       15.101        15.196        15.661         15.81        15.969        16.139        16.322          16.5 
    coh1003:k=36.3636,b=13.6364      14.806        14.867        14.936       15.013       15.097        15.193        15.662        15.812        15.972        16.145        16.329        16.507 
    coh1004:k=35.2273,b=14.7727        14.8        14.861        14.931       15.009       15.093        15.189        15.662        15.814        15.975        16.149        16.334        16.513 
    coh1005:k=34.0909,b=15.9091      14.793        14.855        14.926       15.004        15.09        15.184        15.662        15.815        15.977        16.153        16.339        16.518 
    coh1006:k=32.9545,b=17.0455      14.786        14.849         14.92           15       15.085         15.18        15.661        15.815        15.979        16.157        16.343        16.523 
    coh1007:k=31.8182,b=18.1818      14.779        14.843        14.915       14.995       15.081        15.175        15.661        15.816         15.98        16.159        16.346        16.527 
    coh1008:k=30.6818,b=19.3182      14.771        14.836        14.909       14.989       15.077        15.172        15.659        15.816        15.981        16.162         16.35        16.531 
    coh1009:k=29.5455,b=20.4545      14.764        14.829        14.902       14.984       15.072        15.168        15.658        15.815        15.982        16.164        16.352        16.534 
    coh1010:k=28.4091,b=21.5909      14.756        14.822        14.896       14.978       15.067        15.164        15.657        15.815        15.982        16.166        16.355        16.537 
    coh1011:k=27.2727,b=22.7273      14.748        14.814        14.889       14.972       15.062         15.16        15.655        15.814        15.983        16.167        16.357         16.54 
    coh1012:k=26.1364,b=23.8636      14.739        14.807        14.883       14.966       15.057        15.155        15.653        15.813        15.983        16.168        16.359        16.542 
    coh1013:k=25,b=25                14.733        14.799        14.875        14.96       15.052        15.151        15.652        15.812        15.982        16.169        16.361        16.545 
    coh1014:k=23.8636,b=26.1364      14.727         14.79        14.868       14.954       15.046        15.146         15.65         15.81        15.982         16.17        16.362        16.547 
    coh1015:k=22.7273,b=27.2727       14.72        14.784         14.86       14.947        15.04        15.141        15.648        15.809        15.981         16.17        16.364        16.549 
    coh1016:k=21.5909,b=28.4091      14.713        14.778        14.853        14.94       15.034        15.136        15.645        15.807        15.981         16.17        16.365         16.55 
    coh1017:k=20.4545,b=29.5455      14.707        14.772        14.846       14.933       15.028        15.131        15.643        15.805         15.98         16.17        16.366        16.552 
    coh1018:k=19.3182,b=30.6818        14.7        14.765         14.84       14.925       15.022        15.125         15.64        15.803        15.979         16.17        16.366        16.553 
    coh1019:k=18.1818,b=31.8182      14.692        14.759        14.834       14.918       15.015         15.12        15.638        15.801        15.978         16.17        16.367        16.554 
    coh1020:k=17.0455,b=32.9545      14.685        14.752        14.828       14.912       15.009        15.114        15.635        15.798        15.977         16.17        16.367        16.556 
    coh1021:k=15.9091,b=34.0909      14.677        14.745        14.821       14.906       15.002        15.108        15.632        15.796        15.975        16.169        16.368        16.557 
    coh1022:k=14.7727,b=35.2273      14.669        14.738        14.815         14.9       14.994        15.102        15.629        15.793        15.974        16.168        16.368        16.557 
    coh1023:k=13.6364,b=36.3636      14.661         14.73        14.808       14.894       14.987        15.096        15.626         15.79        15.972        16.167        16.368        16.558 
    coh1024:k=12.5,b=37.5            14.652        14.722        14.801       14.888       14.982        15.089        15.623        15.787         15.97        16.166        16.368        16.559 
    coh1025:k=11.3636,b=38.6364      14.644        14.715        14.794       14.882       14.976        15.083        15.619        15.784        15.969        16.165        16.368        16.559 
    coh1026:k=10.2273,b=39.7727      14.635        14.706        14.787       14.875        14.97        15.076        15.616        15.781        15.967        16.164        16.368         16.56 
    coh1027:k=9.09091,b=40.9091      14.626        14.698        14.779       14.869       14.964        15.069        15.612        15.778        15.965        16.163        16.367         16.56 
    coh1028:k=7.95455,b=42.0455      14.617        14.689        14.772       14.862       14.958        15.063        15.608        15.774        15.962        16.161        16.367         16.56 
    coh1029:k=6.81818,b=43.1818       14.61        14.681        14.764       14.855       14.952        15.057        15.605        15.772         15.96         16.16        16.366        16.561 
    coh1030:k=5.68182,b=44.3182      14.603        14.671        14.755       14.847       14.946        15.052        15.601        15.769        15.958        16.158        16.366        16.561 
    coh1031:k=4.54545,b=45.4545      14.596        14.665        14.747        14.84        14.94        15.047        15.597        15.766        15.955        16.156        16.365        16.561 
    coh1032:k=3.40909,b=46.5909      14.589        14.658        14.738       14.832       14.933        15.041        15.592        15.763        15.953        16.154        16.364        16.561 
    coh1033:k=2.27273,b=47.7273      14.581        14.651         14.73       14.824       14.926        15.035        15.588         15.76         15.95        16.152        16.363        16.561 
    coh1034:k=1.13636,b=48.8636      14.573        14.644        14.723       14.816       14.919        15.029        15.584        15.757        15.947         16.15        16.362        16.561 
    coh1035:k=0,b=50                 14.565        14.637        14.717       14.808       14.912        15.023        15.579        15.754        15.945        16.148        16.361         16.56 

tb_pol_a
                                   z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                                   __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0,b=0                          0             0            0            0             0             0             0             0             0             0             0            0  
    coh2:k=1.13636,b=0                    0             0            0            0             0             0             0             0             0             0             0            0  
    coh3:k=0,b=1.13636                    0             0            0            0             0             0             0             0             0             0             0            0  
    coh4:k=2.27273,b=0                    0             0            0            0             0             0             0             0             0             0             0            0  
    coh5:k=1.13636,b=1.13636              0             0            0            0             0             0             0             0             0             0             0            0  
    coh6:k=0,b=2.27273                    0             0            0            0             0             0             0             0             0             0             0            0  
    coh7:k=3.40909,b=0                    0             0            0            0             0             0             0             0             0             0             0            0  
    coh8:k=2.27273,b=1.13636              0             0            0            0             0             0             0             0             0             0             0            0  
    coh9:k=1.13636,b=2.27273              0             0            0       1.1364             0             0             0             0             0             0             0            0  
    coh10:k=0,b=3.40909                   0             0            0       1.1364             0             0             0             0             0             0             0            0  
    coh11:k=4.54545,b=0              1.1364        1.1364            0            0             0             0             0             0             0             0             0            0  
    coh12:k=3.40909,b=1.13636        1.1364        1.1364            0            0             0             0             0             0             0             0             0            0  
    coh13:k=2.27273,b=2.27273        1.1364             0            0            0             0        1.1364             0             0             0             0             0            0  
    coh14:k=1.13636,b=3.40909        1.1364             0            0            0             0        1.1364             0             0             0             0             0            0  
    coh15:k=0,b=4.54545              1.1364        1.1364            0            0             0             0             0             0             0             0             0            0  
    coh16:k=5.68182,b=0              3.4091        2.2727       2.2727       1.1364        1.1364             0             0             0             0             0             0            0  
    coh17:k=4.54545,b=1.13636        2.2727        2.2727       1.1364       1.1364             0             0             0             0             0             0             0            0  
    coh18:k=3.40909,b=2.27273        2.2727        2.2727       1.1364       1.1364             0             0             0             0             0             0             0            0  
    coh19:k=2.27273,b=3.40909        2.2727        2.2727       1.1364       1.1364             0             0             0             0             0             0             0            0  
    coh20:k=1.13636,b=4.54545        2.2727        2.2727       1.1364       1.1364             0             0             0             0             0             0             0            0  
    coh21:k=0,b=5.68182              2.2727        2.2727       1.1364       1.1364             0             0             0             0             0             0             0            0  
    coh22:k=6.81818,b=0              4.5455        3.4091       3.4091       3.4091        2.2727        1.1364             0             0             0             0             0            0  
    coh23:k=5.68182,b=1.13636        3.4091        3.4091       3.4091       2.2727        1.1364        1.1364             0             0             0             0             0            0  
    coh24:k=4.54545,b=2.27273        3.4091        3.4091       3.4091       2.2727        1.1364             0             0             0             0             0             0            0  
    coh25:k=3.40909,b=3.40909        3.4091        3.4091       3.4091       2.2727        1.1364             0             0             0             0             0             0            0  
    coh26:k=2.27273,b=4.54545        3.4091        3.4091       3.4091       2.2727        1.1364             0             0             0             0             0             0            0  
    coh27:k=1.13636,b=5.68182        3.4091        3.4091       3.4091       2.2727        1.1364             0             0             0             0             0             0            0  
    coh28:k=0,b=6.81818              3.4091        3.4091       3.4091       2.2727        1.1364             0             0             0             0             0             0            0  
    coh29:k=7.95455,b=0              5.6818        4.5455       4.5455       4.5455        3.4091        3.4091             0             0             0             0             0            0  
    coh30:k=6.81818,b=1.13636        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh31:k=5.68182,b=2.27273        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh32:k=4.54545,b=3.40909        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh33:k=3.40909,b=4.54545        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh34:k=2.27273,b=5.68182        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh35:k=1.13636,b=6.81818        4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh36:k=0,b=7.95455              4.5455        4.5455       4.5455       3.4091        3.4091        2.2727             0             0             0             0             0            0  
    coh37:k=9.09091,b=0              6.8182        5.6818       5.6818       5.6818        4.5455        4.5455             0             0             0             0             0            0  
    coh38:k=7.95455,b=1.13636        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh39:k=6.81818,b=2.27273        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh40:k=5.68182,b=3.40909        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091        1.1364             0             0             0             0            0  
    coh41:k=4.54545,b=4.54545        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh42:k=3.40909,b=5.68182        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh43:k=2.27273,b=6.81818        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh44:k=1.13636,b=7.95455        5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh45:k=0,b=9.09091              5.6818        5.6818       5.6818       4.5455        4.5455        3.4091             0             0             0             0             0            0  
    coh46:k=10.2273,b=0              7.9545        6.8182       6.8182       6.8182        5.6818        5.6818             0             0             0             0             0            0  
    coh47:k=9.09091,b=1.13636        6.8182        6.8182       6.8182       5.6818        5.6818        4.5455             0             0             0             0             0            0  
    coh48:k=7.95455,b=2.27273        6.8182        6.8182       6.8182       5.6818        5.6818        4.5455             0        1.1364             0             0             0            0  
    coh49:k=6.81818,b=3.40909        6.8182        6.8182       6.8182       5.6818        5.6818        4.5455        2.2727             0             0             0             0            0  
    coh50:k=5.68182,b=4.54545        6.8182        6.8182       6.8182       5.6818        5.6818        4.5455        2.2727             0             0             0             0            0  
    coh986:k=4.54545,b=44.3182       40.909        42.045       42.045       40.909        40.909        39.773          37.5        35.227        34.091        34.091        32.955       28.409  
    coh987:k=3.40909,b=45.4545       40.909        40.909       42.045       40.909        40.909        39.773          37.5        35.227        34.091        34.091        32.955       28.409  
    coh988:k=2.27273,b=46.5909       40.909        40.909       42.045       40.909        40.909        39.773          37.5        35.227        34.091        34.091        32.955       28.409  
    coh989:k=1.13636,b=47.7273       40.909        40.909       42.045       40.909        40.909        39.773          37.5        35.227        34.091        34.091        32.955       28.409  
    coh990:k=0,b=48.8636             40.909        40.909       39.773       40.909        40.909        39.773          37.5        35.227        34.091        34.091        32.955       28.409  
    coh991:k=50,b=0                  44.318        44.318       44.318       43.182        43.182        42.045          37.5        36.364        34.091        29.545        26.136       23.864  
    coh992:k=48.8636,b=1.13636       44.318        44.318       43.182       43.182        44.318        43.182        38.636        36.364        35.227        31.818        29.545           25  
    coh993:k=47.7273,b=2.27273       44.318        44.318       45.455       44.318        44.318        43.182        38.636        36.364        34.091        31.818        31.818       28.409  
    coh994:k=46.5909,b=3.40909       44.318        44.318       45.455       44.318        44.318        43.182        38.636        36.364        34.091        34.091        30.682       27.273  
    coh995:k=45.4545,b=4.54545       44.318        44.318       45.455       44.318        44.318        43.182        38.636        36.364        36.364        34.091        30.682       27.273  
    coh996:k=44.3182,b=5.68182       44.318        44.318       43.182       44.318        44.318        43.182          37.5        38.636        36.364        32.955        29.545       30.682  
    coh997:k=43.1818,b=6.81818       44.318        44.318       43.182       44.318        44.318        43.182          37.5        38.636        36.364        32.955        29.545       29.545  
    coh998:k=42.0455,b=7.95455       44.318        44.318       43.182       44.318        44.318        43.182          37.5        38.636        35.227        32.955        32.955       29.545  
    coh999:k=40.9091,b=9.09091       44.318        44.318       43.182       43.182        44.318        43.182          37.5          37.5        35.227        32.955        32.955       29.545  
    coh1000:k=39.7727,b=10.2273      44.318        44.318       43.182       43.182        44.318        43.182          37.5          37.5        35.227        32.955        31.818       28.409  
    coh1001:k=38.6364,b=11.3636      44.318        44.318       43.182       43.182        44.318        43.182        40.909          37.5        35.227        35.227        31.818       28.409  
    coh1002:k=37.5,b=12.5            44.318        44.318       43.182       43.182        44.318        43.182        40.909          37.5        35.227        35.227        31.818       28.409  
    coh1003:k=36.3636,b=13.6364      44.318        44.318       44.318       43.182        42.045        43.182        40.909          37.5        35.227        35.227        31.818       28.409  
    coh1004:k=35.2273,b=14.7727      44.318        44.318       44.318       43.182        42.045        43.182        40.909          37.5        35.227        35.227        31.818       28.409  
    coh1005:k=34.0909,b=15.9091      44.318        44.318       44.318       43.182        42.045        43.182        40.909          37.5        35.227        35.227        31.818       28.409  
    coh1006:k=32.9545,b=17.0455      44.318        44.318       44.318       43.182        42.045        43.182        40.909          37.5        35.227        35.227        31.818       27.273  
    coh1007:k=31.8182,b=18.1818      44.318        44.318       44.318       43.182        43.182        42.045        40.909          37.5        35.227        35.227        31.818       27.273  
    coh1008:k=30.6818,b=19.3182      44.318        44.318       44.318       43.182        43.182        42.045        40.909          37.5        35.227        35.227        31.818       27.273  
    coh1009:k=29.5455,b=20.4545      44.318        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        31.818       27.273  
    coh1010:k=28.4091,b=21.5909      44.318        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        31.818       27.273  
    coh1011:k=27.2727,b=22.7273      44.318        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1012:k=26.1364,b=23.8636      43.182        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1013:k=25,b=25                43.182        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1014:k=23.8636,b=26.1364      43.182        44.318       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1015:k=22.7273,b=27.2727      43.182        43.182       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1016:k=21.5909,b=28.4091      43.182        43.182       44.318       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1017:k=20.4545,b=29.5455      43.182        43.182       42.045       43.182        43.182        42.045          37.5          37.5        35.227        35.227        30.682       27.273  
    coh1018:k=19.3182,b=30.6818      43.182        43.182       42.045       43.182        43.182        42.045        38.636          37.5        35.227        35.227        30.682       27.273  
    coh1019:k=18.1818,b=31.8182      43.182        43.182       42.045       43.182        43.182        42.045        38.636          37.5        35.227        35.227        30.682       27.273  
    coh1020:k=17.0455,b=32.9545      43.182        43.182       42.045       42.045        43.182        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1021:k=15.9091,b=34.0909      43.182        43.182       43.182       42.045        43.182        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1022:k=14.7727,b=35.2273      43.182        43.182       43.182       42.045        43.182        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1023:k=13.6364,b=36.3636      43.182        43.182       43.182       42.045        43.182        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1024:k=12.5,b=37.5            43.182        43.182       43.182       42.045        40.909        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1025:k=11.3636,b=38.6364      43.182        43.182       43.182       42.045        40.909        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1026:k=10.2273,b=39.7727      43.182        43.182       43.182       42.045        42.045        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1027:k=9.09091,b=40.9091      43.182        43.182       43.182       42.045        42.045        42.045        38.636        38.636        35.227        35.227        30.682       27.273  
    coh1028:k=7.95455,b=42.0455      42.045        43.182       43.182       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1029:k=6.81818,b=43.1818      42.045        43.182       43.182       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1030:k=5.68182,b=44.3182      42.045        43.182       43.182       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1031:k=4.54545,b=45.4545      42.045        42.045       43.182       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1032:k=3.40909,b=46.5909      42.045        42.045       43.182       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1033:k=2.27273,b=47.7273      42.045        42.045       40.909       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1034:k=1.13636,b=48.8636      42.045        42.045       40.909       42.045        42.045        40.909        38.636        36.364        35.227        35.227        30.682       27.273  
    coh1035:k=0,b=50                 42.045        42.045       40.909       42.045        42.045        40.909        38.636        36.364        36.364        35.227        30.682       27.273  

</pre><img vspace="5" hspace="5" src="ff_akz_vf_vec_01.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_02.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_03.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_04.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_05.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_06.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_07.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_08.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_09.png" alt=""> <img vspace="5" hspace="5" src="ff_akz_vf_vec_10.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function result_map = ff_akz_vf_vec(varargin)
%% FF_AKZ_VF_VEC solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the vectorized version
% of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_akz_vf.html
% ff_akz_vf>. See that file for more descriptions. 
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables. 
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_set_default_param.m ffs_akz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/paramfunc/ffs_akz_get_funcgrid.m ffs_akz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_akz_set_default_param(it_param_set);
[armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_akz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_akz_vf_vec';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'mt_z_trans', 'ar_z'});
[ mt_z_trans, ar_z] = params_group{:};
params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'mt_coh', 'it_ameshk_n'});
[ar_a_meshk, ar_k_mesha, mt_coh, it_ameshk_n] = params_group{:};
% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};
% param_map
params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w',...
    'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min'});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_a_meshk),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a_meshk),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_a_meshk),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_a_meshk),length(ar_z));

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;
    
    %% Solve Optimization Problem Current Iteration
    
    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)
        
        % Consumption
        mt_c = f_cons(mt_coh(:, it_z_i)', ar_a_meshk, ar_k_mesha);
        
        % EVAL current utility: N by N, f_util defined earlier
        if (fl_crra == 1)
            mt_utility = f_util_log(mt_c);
            fl_u_neg_c = f_util_log(fl_c_min);            
        else
            mt_utility = f_util_crra(mt_c);
            fl_u_neg_c = f_util_crra(fl_c_min);            
        end

        % f(z'|z)
        ar_z_trans_condi = mt_z_trans(it_z_i,:);
        
        % EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';
        
        % EVAL add on future utility, N by N + N by 1
        mt_utility = mt_utility + fl_beta*mt_evzp_condi_z;
        mt_utility(mt_c <= fl_c_min) = fl_u_neg_c;

        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        [ar_opti_val1_z, ar_opti_idx_z] = max(mt_utility);
        mt_val(:,it_z_i) = ar_opti_val1_z;
        mt_pol_a(:,it_z_i) = ar_a_meshk(ar_opti_idx_z);
        mt_pol_k(:,it_z_i) = ar_k_mesha(ar_opti_idx_z);        
        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        end

    end
    
    %% Check Tolerance and Continuation
    
    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n);
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(it_ameshk_n);    
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);
    
    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;
    
    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
                                      mean(mt_pol_a_cur,1); ...
                                      mean(mt_pol_k_cur,1); ...
                                      mt_val_cur(it_ameshk_n,:); ...
                                      mt_pol_a_cur(it_ameshk_n,:); ...
                                      mt_pol_k_cur(it_ameshk_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(it_ameshk_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice')
        disp('mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice')                
        disp(tb_valpol_iter);
    end
    
    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;        
    end
    
end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_a') = mt_pol_a;
result_map('mt_pol_k') = mt_pol_k;

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>