
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-13"><meta name="DC.source" content="ffs_ipwkbzr_fibs_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1a</a></li><li><a href="#5">Parse Parameters 1b</a></li><li><a href="#6">Parse Parameters 2</a></li><li><a href="#7">Parse Parameters 3</a></li><li><a href="#8">G1: Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#9">G2: Expand A and K Arrays further if bridge is allowed</a></li><li><a href="#10">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</a></li><li><a href="#11">F1: Get Shock: Income Shock (ar1)</a></li><li><a href="#12">F2: Get Shock: Interest Rate Shock (iid)</a></li><li><a href="#13">F3: Get Shock: Mesh Shocks Together</a></li><li><a href="#14">FIBS1: Get Equations</a></li><li><a href="#15">FIBS2: Get Formal Borrowing Blocks</a></li><li><a href="#16">Find Formal and Informal Choices for Borrowing points</a></li><li><a href="#17">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</a></li><li><a href="#18">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</a></li><li><a href="#19">COH1: Combine overall Reachable Cash-on-Hand Levels</a></li><li><a href="#20">COH2: Check if COH is within Borrowing Bounds</a></li><li><a href="#21">COH3: Update Valid 2nd stage choice matrix</a></li><li><a href="#22">COH4: Select only Valid (k(w), a) choices</a></li><li><a href="#23">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#24">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#25">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</a></li><li><a href="#26">Generate Interpolation Consumption Grid</a></li><li><a href="#27">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#28">Store armt_map (1): base arrays</a></li><li><a href="#29">Store armt_map (2): 1st stage level coh on hand related arrays</a></li><li><a href="#30">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</a></li><li><a href="#31">Store armt_map (4): 2nd stage additional arrays</a></li><li><a href="#32">Store armt_map (5): Shock Grids Arrays and Mesh</a></li><li><a href="#33">Store armt_map (6): W Share for Bridge Parameters</a></li><li><a href="#34">Store armt_map (7): Formal Informal Arrays</a></li><li><a href="#35">Store Function Map</a></li><li><a href="#36">Graph</a></li><li><a href="#38">Generate Limited Legends</a></li><li><a href="#39">Graph 1: a and k choice grid graphs</a></li><li><a href="#40">Graph 2: coh by shock</a></li><li><a href="#41">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#43">Graph Details, Generally do Not Run</a></li><li><a href="#45">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#46">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#48">Display</a></li><li><a href="#49">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbzr_fibs_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>This file is based on <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html">ffs_ipwkbzr_get_funcgrid</a>, see that file for more comments and compare differences in graphs and tables to see how the inclusion of formal and informal choices that consider bridge loans impact choice sets.</p><p>Also compare against <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html">ffs_abz_fibs_get_funcgrid</a> where the results are also considering formal and informal choices etc in the context of <b>abz fibs</b>.</p><p>In contrast to ff_ipwkbzr_evf.m, here, we need to deal with borrowing and savings formal and informal. These will change how the testing matrix is constructed. When bridge loan is allowed, we also need to construct the output matrixes differently. In ff_ipwkbzr_evf.m, the assumption is that coh today does not matter, so to find optimal k* choice, we only need to know the aggregate savings level. But now, we need to know the coh level as well.</p><p>Below two reachable coh matrixes are constructed, one for when aggregate savings choice w &gt;= 0, and another for when aggregate savings &lt;= 0. Then they are stacked together. And we still have the same outputs as ff_ipwkbzr_evf.m. The difference is that while for savings where w &gt;=0, each row are w levels for the output matrixes, but for w &lt;=0, each row is for w level + coh percentage combinations.</p><div><ul><li><i>ar_w_level</i>: What are the feasible grid of w = k'+b', these are to be interpolated later, these are level grid, not percentage grid</li><li><i>ar_w_level</i>: What are the percentage based choices points for k' and b' given each w. These are <i>ar_a_meshk</i>, <i>ar_k_mesha</i>. Note here these are principles, k + b' is the total aggregate savings in period t. b is be a combination of formal and informal choices, but our percentage point for b is the overall principle of all formal and informal choices</li><li><i>mt_coh_wkb_full</i> : These are the cash-on-hand levels reacheable given the choice percentages of k and b'. The problem here is more complicated than <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html">ffs_ipwkbzr_get_funcgrid</a> because here we can not get to coh tomorrow by multiplying principle by savings or borrowing interest rates, if borrowing, we have to optimize among formal and informal choices. That is computationally trivial because it's a static choice unrelated to the dynamic problem. The slightly more complicated thing is that we also have to consider percentages of b' that has to go to bridge loans due to negative cash-on-hand in period t. That makes the reachable cash-on-hand grid significantly larger than the grid in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html">ffs_ipwkbzr_get_funcgrid</a>, we have to expand the grid by another percentage dimension--percentages of b' going to bridge--for negative levels of w=k'+b' overall choice.</li></ul></div><h2 id="3">Default</h2><p>Results identical to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html">ffs_ipwkbzr_get_funcgrid</a> is obtained by running default with: st_param_which = 'ffs_ipwkbzr_get_funcgrid';</p><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))

    <span class="comment">% override when called from outside</span>
    [param_map, support_map] = varargin{:};

<span class="keyword">else</span>

    close <span class="string">all</span>;
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbzr_fibs_set_default_param();
    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = true;

    st_param_which = <span class="string">'default'</span>;

    param_map(<span class="string">'fl_z_r_infbr_min'</span>) = 0.025;
    param_map(<span class="string">'fl_z_r_infbr_max'</span>) = 0.95;
    param_map(<span class="string">'fl_z_r_infbr_n'</span>) = 3;

    <span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>, <span class="string">'ffs_ipwkbzr_get_funcgrid'</span>]))

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 25;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 45;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

        <span class="comment">% Note it_coh_bridge_perc is percentage NOT for BRIDGE</span>
        <span class="keyword">if</span> (strcmp(st_param_which, <span class="string">'default'</span>))

            param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;
            param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'ffs_ipwkbzr_get_funcgrid'</span>))

            <span class="comment">% when bl_bridge = false, it_coh_bridge_perc_n = 1</span>
            param_map(<span class="string">'bl_bridge'</span>) = false;

        <span class="keyword">end</span>

    <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'small'</span>))

        param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = false; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 7;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 7;
        param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

    <span class="keyword">end</span>

    param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_infbr_n'</span>);

    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display Parameters Specific to IPWKBZR_FIBS
it_coh_bridge_perc_n ADDED ON NEXT
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 22
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_rollover ; val = true
pos = 5 ; key = fl_forbrblk_brleast ; val = -1
pos = 6 ; key = fl_forbrblk_brmost ; val = -19
pos = 7 ; key = fl_forbrblk_gap ; val = -1.5
pos = 8 ; key = fl_r_fbr ; val = 0.065
pos = 9 ; key = fl_r_fsv ; val = 0.025
pos = 10 ; key = fl_z_r_infbr_max ; val = 0.095
pos = 11 ; key = fl_z_r_infbr_min ; val = 0.025
pos = 12 ; key = fl_z_r_infbr_n ; val = 5
pos = 13 ; key = fl_z_r_infbr_poiss_mean ; val = 20
pos = 14 ; key = fl_z_wage_mu ; val = 0
pos = 15 ; key = fl_z_wage_rho ; val = 0.8
pos = 16 ; key = fl_z_wage_sig ; val = 0.2
pos = 17 ; key = it_z_n ; val = 75
pos = 18 ; key = it_z_wage_n ; val = 15
pos = 19 ; key = st_forbrblk_type ; val = seg3
pos = 20 ; key = st_model ; val = ipwkbzr_fibs
pos = 21 ; key = st_z_r_infbr_drv_ele_type ; val = unif
pos = 22 ; key = st_z_r_infbr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                               i     idx    value
                               __    ___    _____

    bl_b_is_principle           1     1       1  
    bl_bridge                   2     2       1  
    bl_default                  3     3       1  
    bl_rollover                 4     4       1  
    fl_forbrblk_brleast         5     5       1  
    fl_forbrblk_brmost          6     6       1  
    fl_forbrblk_gap             7     7       1  
    fl_r_fbr                    8     8       1  
    fl_r_fsv                    9     9       1  
    fl_z_r_infbr_max           10    10       1  
    fl_z_r_infbr_min           11    11       1  
    fl_z_r_infbr_n             12    12       1  
    fl_z_r_infbr_poiss_mean    13    13       1  
    fl_z_wage_mu               14    14       0  
    fl_z_wage_rho              15    15       1  
    fl_z_wage_sig              16    16       1  
    it_z_n                     17    17       1  
    it_z_wage_n                18    18       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                 i    idx
                                 _    ___

    st_forbrblk_type             1    19 
    st_model                     2    20 
    st_z_r_infbr_drv_ele_type    3    21 
    st_z_r_infbr_drv_prb_type    4    22 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display_funcgrids ; val = false
pos = 2 ; key = bl_display_minccost ; val = false
pos = 3 ; key = bl_graph_funcgrids ; val = false
pos = 4 ; key = bl_graph_funcgrids_detail ; val = false
pos = 5 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/img/
pos = 6 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/mat/
pos = 7 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 8 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/profile/
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                 i    idx    value
                                 _    ___    _____

    bl_display_funcgrids         1     1       0  
    bl_display_minccost          2     2       0  
    bl_graph_funcgrids           3     3       0  
    bl_graph_funcgrids_detail    4     4       0  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                           i    idx
                           _    ___

    st_img_path            1     5 
    st_mat_path            2     6 
    st_matimg_path_root    3     7 
    st_profile_path        4     8 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display All Parameters with IPWKBZR overriding IPWKBZR
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 49
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_rollover ; val = true
pos = 5 ; key = fl_Amean ; val = 1
pos = 6 ; key = fl_alpha ; val = 0.36
pos = 7 ; key = fl_b_bd ; val = -20
pos = 8 ; key = fl_beta ; val = 0.94
pos = 9 ; key = fl_c_min ; val = 0.02
pos = 10 ; key = fl_coh_interp_grid_gap ; val = 0.1
pos = 11 ; key = fl_crra ; val = 1.5
pos = 12 ; key = fl_default_wprime ; val = 0
pos = 13 ; key = fl_delta ; val = 0.08
pos = 14 ; key = fl_forbrblk_brleast ; val = -1
pos = 15 ; key = fl_forbrblk_brmost ; val = -19
pos = 16 ; key = fl_forbrblk_gap ; val = -1.5
pos = 17 ; key = fl_k_max ; val = 70
pos = 18 ; key = fl_k_min ; val = 0
pos = 19 ; key = fl_nan_replace ; val = -9999
pos = 20 ; key = fl_r_fbr ; val = 0.065
pos = 21 ; key = fl_r_fsv ; val = 0.025
pos = 22 ; key = fl_tol_dist ; val = 1e-05
pos = 23 ; key = fl_tol_pol ; val = 1e-05
pos = 24 ; key = fl_tol_val ; val = 1e-05
pos = 25 ; key = fl_w ; val = 0.44365
pos = 26 ; key = fl_w_interp_grid_gap ; val = 0.1
pos = 27 ; key = fl_w_max ; val = 50
pos = 28 ; key = fl_w_min ; val = -20
pos = 29 ; key = fl_z_r_infbr_max ; val = 0.095
pos = 30 ; key = fl_z_r_infbr_min ; val = 0.025
pos = 31 ; key = fl_z_r_infbr_n ; val = 5
pos = 32 ; key = fl_z_r_infbr_poiss_mean ; val = 20
pos = 33 ; key = fl_z_wage_mu ; val = 0
pos = 34 ; key = fl_z_wage_rho ; val = 0.8
pos = 35 ; key = fl_z_wage_sig ; val = 0.2
pos = 36 ; key = it_ak_perc_n ; val = 50
pos = 37 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 38 ; key = it_coh_bridge_perc_n ; val = 50
pos = 39 ; key = it_maxiter_dist ; val = 1000
pos = 40 ; key = it_maxiter_val ; val = 250
pos = 41 ; key = it_tol_pol_nochange ; val = 25
pos = 42 ; key = it_w_perc_n ; val = 50
pos = 43 ; key = it_z_n ; val = 75
pos = 44 ; key = it_z_wage_n ; val = 15
pos = 45 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 46 ; key = st_forbrblk_type ; val = seg3
pos = 47 ; key = st_model ; val = ipwkbzr_fibs
pos = 48 ; key = st_z_r_infbr_drv_ele_type ; val = unif
pos = 49 ; key = st_z_r_infbr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                               i     idx    value
                               __    ___    _____

    bl_b_is_principle           1     1       1  
    bl_bridge                   2     2       1  
    bl_default                  3     3       1  
    bl_rollover                 4     4       1  
    fl_Amean                    5     5       1  
    fl_alpha                    6     6       1  
    fl_b_bd                     7     7       1  
    fl_beta                     8     8       1  
    fl_c_min                    9     9       1  
    fl_coh_interp_grid_gap     10    10       1  
    fl_crra                    11    11       1  
    fl_default_wprime          12    12       0  
    fl_delta                   13    13       1  
    fl_forbrblk_brleast        14    14       1  
    fl_forbrblk_brmost         15    15       1  
    fl_forbrblk_gap            16    16       1  
    fl_k_max                   17    17       1  
    fl_k_min                   18    18       0  
    fl_nan_replace             19    19       1  
    fl_r_fbr                   20    20       1  
    fl_r_fsv                   21    21       1  
    fl_tol_dist                22    22       1  
    fl_tol_pol                 23    23       1  
    fl_tol_val                 24    24       1  
    fl_w                       25    25       1  
    fl_w_interp_grid_gap       26    26       1  
    fl_w_max                   27    27       1  
    fl_w_min                   28    28       1  
    fl_z_r_infbr_max           29    29       1  
    fl_z_r_infbr_min           30    30       1  
    fl_z_r_infbr_n             31    31       1  
    fl_z_r_infbr_poiss_mean    32    32       1  
    fl_z_wage_mu               33    33       0  
    fl_z_wage_rho              34    34       1  
    fl_z_wage_sig              35    35       1  
    it_ak_perc_n               36    36       1  
    it_c_interp_grid_gap       37    37       1  
    it_coh_bridge_perc_n       38    38       1  
    it_maxiter_dist            39    39       1  
    it_maxiter_val             40    40       1  
    it_tol_pol_nochange        41    41       1  
    it_w_perc_n                42    42       1  
    it_z_n                     43    43       1  
    it_z_wage_n                44    44       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    45 
    st_forbrblk_type                 2    46 
    st_model                         3    47 
    st_z_r_infbr_drv_ele_type        4    48 
    st_z_r_infbr_drv_prb_type        5    49 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 43
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = true
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = false
pos = 9 ; key = bl_display_minccost ; val = false
pos = 10 ; key = bl_graph ; val = true
pos = 11 ; key = bl_graph_coh_t_coh ; val = true
pos = 12 ; key = bl_graph_evf ; val = false
pos = 13 ; key = bl_graph_funcgrids ; val = false
pos = 14 ; key = bl_graph_funcgrids_detail ; val = false
pos = 15 ; key = bl_graph_onebyones ; val = true
pos = 16 ; key = bl_graph_pol_lvl ; val = true
pos = 17 ; key = bl_graph_pol_pct ; val = true
pos = 18 ; key = bl_graph_val ; val = true
pos = 19 ; key = bl_img_save ; val = false
pos = 20 ; key = bl_mat ; val = false
pos = 21 ; key = bl_post ; val = true
pos = 22 ; key = bl_profile ; val = false
pos = 23 ; key = bl_profile_dist ; val = false
pos = 24 ; key = bl_time ; val = false
pos = 25 ; key = it_display_every ; val = 5
pos = 26 ; key = it_display_final_colmax ; val = 12
pos = 27 ; key = it_display_final_rowmax ; val = 100
pos = 28 ; key = it_display_summmat_colmax ; val = 5
pos = 29 ; key = it_display_summmat_rowmax ; val = 5
pos = 30 ; key = st_img_name_main ; val = _default
pos = 31 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/img/
pos = 32 ; key = st_img_prefix ; val = 
pos = 33 ; key = st_img_suffix ; val = _p4.png
pos = 34 ; key = st_mat_name_main ; val = _default
pos = 35 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/mat/
pos = 36 ; key = st_mat_prefix ; val = 
pos = 37 ; key = st_mat_suffix ; val = _p4
pos = 38 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 39 ; key = st_profile_name_main ; val = _default
pos = 40 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbzr_solve/profile/
pos = 41 ; key = st_profile_prefix ; val = 
pos = 42 ; key = st_profile_suffix ; val = _p4
pos = 43 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1       0  
    bl_display_defparam              2     2       1  
    bl_display_dist                  3     3       0  
    bl_display_evf                   4     4       0  
    bl_display_final                 5     5       1  
    bl_display_final_dist            6     6       0  
    bl_display_final_dist_detail     7     7       0  
    bl_display_funcgrids             8     8       0  
    bl_display_minccost              9     9       0  
    bl_graph                        10    10       1  
    bl_graph_coh_t_coh              11    11       1  
    bl_graph_evf                    12    12       0  
    bl_graph_funcgrids              13    13       0  
    bl_graph_funcgrids_detail       14    14       0  
    bl_graph_onebyones              15    15       1  
    bl_graph_pol_lvl                16    16       1  
    bl_graph_pol_pct                17    17       1  
    bl_graph_val                    18    18       1  
    bl_img_save                     19    19       0  
    bl_mat                          20    20       0  
    bl_post                         21    21       1  
    bl_profile                      22    22       0  
    bl_profile_dist                 23    23       0  
    bl_time                         24    24       0  
    it_display_every                25    25       1  
    it_display_final_colmax         26    26       1  
    it_display_final_rowmax         27    27       1  
    it_display_summmat_colmax       28    28       1  
    it_display_summmat_rowmax       29    29       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    30 
    st_img_path              2    31 
    st_img_prefix            3    32 
    st_img_suffix            4    33 
    st_mat_name_main         5    34 
    st_mat_path              6    35 
    st_mat_prefix            7    36 
    st_mat_suffix            8    37 
    st_matimg_path_root      9    38 
    st_profile_name_main    10    39 
    st_profile_path         11    40 
    st_profile_prefix       12    41 
    st_profile_suffix       13    42 
    st_title_prefix         14    43 

</pre><h2 id="4">Parse Parameters 1a</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'bl_bridge'</span>, <span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>});
[bl_bridge, fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_b_is_principle'</span>, <span class="string">'fl_r_fbr'</span>, <span class="string">'fl_r_fsv'</span>, <span class="string">'fl_w'</span>});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_w] = params_group{:};
</pre><h2 id="5">Parse Parameters 1b</h2><pre class="codeinput">params_group = values(param_map, {<span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'it_ak_perc_n'</span>, <span class="string">'it_coh_bridge_perc_n'</span>, <span class="keyword">...</span>
    <span class="string">'it_c_interp_grid_gap'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[it_w_perc_n, it_ak_perc_n, it_coh_bridge_perc_n, <span class="keyword">...</span>
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};
</pre><h2 id="6">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_wage_n'</span>, <span class="string">'fl_z_wage_mu'</span>, <span class="string">'fl_z_wage_rho'</span>, <span class="string">'fl_z_wage_sig'</span>});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

<span class="comment">% param_map shock borrowing interest</span>
params_group = values(param_map, {<span class="string">'st_z_r_infbr_drv_ele_type'</span>, <span class="string">'st_z_r_infbr_drv_prb_type'</span>, <span class="string">'fl_z_r_infbr_poiss_mean'</span>, <span class="keyword">...</span>
    <span class="string">'fl_z_r_infbr_max'</span>, <span class="string">'fl_z_r_infbr_min'</span>, <span class="string">'fl_z_r_infbr_n'</span>});
[st_z_r_infbr_drv_ele_type, st_z_r_infbr_drv_prb_type, fl_z_r_infbr_poiss_mean, <span class="keyword">...</span>
    fl_z_r_infbr_max, fl_z_r_infbr_min, fl_z_r_infbr_n] = params_group{:};

<span class="comment">% param_map formal menu</span>
params_group = values(param_map, {<span class="string">'st_forbrblk_type'</span>, <span class="string">'fl_forbrblk_brmost'</span>, <span class="string">'fl_forbrblk_brleast'</span>, <span class="string">'fl_forbrblk_gap'</span>});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

<span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_n'</span>});
[it_z_n] = params_group{:};
</pre><h2 id="7">Parse Parameters 3</h2><pre class="codeinput">params_group = values(support_map, {<span class="string">'bl_display_minccost'</span>, <span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="8">G1: Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_fibs_set_default_param.html">ffs_ipwkbzr_fibs_set_default_param</a> for details.</p><p>@example</p><pre>  % For 2nd stage Grid
  ar_w_level = [-2,0,2]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>
</pre><h2 id="9">G2: Expand A and K Arrays further if bridge is allowed</h2><p>Crucially, when a fraction of overall borrowing/savings needs to go pay negative coh, that comes out of w, fraction of w = k' + b' that goes to this. NOT a fraction of the b' choice condition on w, which would change for the same w as w' changes. We are fixing bridge repay level for w.</p><p>@example</p><pre>  clear all
  % Same as above
  ar_w_level = [-2,-1,-0.1]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre>  % fraction of borrowing for bridge loan
  ar_coh_bridge_perc = [0, 0.5, 0.999];</pre><pre>  % Expand matrix to include coh percentage dimension
  mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
  mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])</pre><pre>  % bridge loan component of borrowing
  ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
  ar_brdige_a = ar_brdige_a(:)'</pre><pre>  % borrowing choices excluding bridge loan
  mt_a_nobridge = mt_a - ar_brdige_a</pre><pre class="codeinput"><span class="comment">% 1. negative part of w</span>
ar_bl_w_neg = (ar_w_level &lt; 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

<span class="keyword">if</span> (bl_bridge)

    <span class="comment">% 1. select mt_k and mt_a where w_level &lt;= 0</span>
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    <span class="comment">% 2. fraction of borrowing NOT for bridge loan</span>
    <span class="comment">% 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge</span>
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    <span class="comment">% 3. Expand matrix to include coh percentage dimension</span>
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    <span class="comment">% 4. bridge loan component of borrowing</span>
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    <span class="comment">% 5. borrowing choices excluding bridge loan</span>
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    <span class="comment">% 6. Matrix combine, negative than positive</span>
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    <span class="comment">% 7. Expand Bridge Choices to have the same size as mt_a</span>
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    <span class="comment">% 8. Overall borrowing and savings choices</span>
    mt_a = mt_a_nobridge + mt_bridge_a;

    <span class="comment">% 9. Update w</span>
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    <span class="comment">% 10. Pre-generate Interpolation matrix for negative w levels</span>
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">else</span>

    <span class="comment">% If bridge loans are not needed, do not need to do expansions</span>
    <span class="comment">% All zeros, no bridge</span>
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">end</span>
</pre><h2 id="10">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</h2><p>For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N number of rows. Where N is the percentage grid point for coh as well as k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos = numger of grid points for ar_w_level</p><div><ol><li><b>mt_a</b> includes aggregate/total borrowing and savings levels. b &lt; 0 happens alot when w &gt;= 0. The mt_a_nobridge</li><li><b>mt_a_nobridge</b> includes all aggregate/total borrowing and savings whether w &gt; 0 or w &lt; 0, however, it subtracts away the borrowing that is for bridge loans when b &lt; 0</li><li><b>mt_bridge_a</b> is the bridge loan amount.</li></ol></div><pre class="codeinput">ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;
</pre><h2 id="11">F1: Get Shock: Income Shock (ar1)</h2><pre class="codeinput">[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);
</pre><h2 id="12">F2: Get Shock: Interest Rate Shock (iid)</h2><pre class="codeinput"><span class="comment">% get borrowing grid and probabilities</span>
param_dsv_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
param_dsv_map(<span class="string">'st_drv_ele_type'</span>) = st_z_r_infbr_drv_ele_type;
param_dsv_map(<span class="string">'st_drv_prb_type'</span>) = st_z_r_infbr_drv_prb_type;
param_dsv_map(<span class="string">'fl_poiss_mean'</span>) = fl_z_r_infbr_poiss_mean;
param_dsv_map(<span class="string">'fl_max'</span>) = fl_z_r_infbr_max;
param_dsv_map(<span class="string">'fl_min'</span>) = fl_z_r_infbr_min;
param_dsv_map(<span class="string">'fl_n'</span>) = fl_z_r_infbr_n;
[ar_z_r_infbr, ar_z_r_infbr_prob] = fft_gen_discrete_var(param_dsv_map, true);

<span class="comment">% iid transition matrix</span>
mt_z_r_infbr_prob_trans = repmat(ar_z_r_infbr_prob, [length(ar_z_r_infbr_prob), 1]);
</pre><h2 id="13">F3: Get Shock: Mesh Shocks Together</h2><pre class="codeinput"><span class="comment">% Kronecker product to get full transition matrix for the two shocks</span>
mt_z_trans = kron(mt_z_r_infbr_prob_trans, mt_z_wage_trans);

<span class="comment">% mesh the shock vectors</span>
[mt_z_wage_mesh_r_infbr_w1r2, mt_z_r_infbr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_infbr);
ar_z_r_infbr_mesh_wage_w1r2 = mt_z_r_infbr_mesh_wage_w1r2(:)';
ar_z_wage_mesh_r_infbr_w1r2 = mt_z_wage_mesh_r_infbr_w1r2(:)';

<span class="comment">% mesh the shock vectors</span>
[mt_z_r_infbr_mesh_wage_r1w2, mt_z_wage_mesh_r_infbr_r1w2] = ndgrid(ar_z_r_infbr, ar_z_wage);
ar_z_wage_mesh_r_infbr_r1w2 = mt_z_wage_mesh_r_infbr_r1w2(:)';
ar_z_r_infbr_mesh_wage_r1w2 = mt_z_r_infbr_mesh_wage_r1w2(:)';


<span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_r_infbr_mesh_wage_w1r2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_wage_mesh_r_infbr_w1r2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_r_infbr_mesh_wage_w1r2;<span class="keyword">...</span>
                                 ar_z_wage_mesh_r_infbr_w1r2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_wage_mesh_r_infbr_r1w2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_r_infbr_mesh_wage_r1w2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_wage_mesh_r_infbr_r1w2;<span class="keyword">...</span>
                                 ar_z_r_infbr_mesh_wage_r1w2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:length(ar_z_r_infbr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_infbr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow Rate Transition Matrix: mt_z_r_infbr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_infbr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_infbr', <span class="string">'r%3.2f'</span>)]);
    tb_z_r_infbr_prob_trans = array2table(round(mt_z_r_infbr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_r_infbr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_infbr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_infbr_prob_trans));
    disp(tb_z_r_infbr_prob_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Wage Prod Shock Transition Matrix: mt_z_r_infbr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', <span class="string">'w%3.2f'</span>)]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Full Transition Matrix: mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_infbr_mesh_wage_w1r2', <span class="string">'r%3.2f;'</span>), <span class="keyword">...</span>
                                   num2str(ar_z_wage_mesh_r_infbr_w1r2', <span class="string">'w%3.2f'</span>)]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'i'</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'i'</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_r_infbr_mesh_wage_w1r2
Prod/Wage Shock: ar_z_wage_mesh_r_infbr_w1r2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_1             0.025                0.34741      
    zi_2             0.025                0.40076      
    zi_3             0.025                 0.4623      
    zi_4             0.025                 0.5333      
    zi_5             0.025                0.61519      
    zi_6             0.025                0.70966      
    zi_7             0.025                0.81864      
    zi_8             0.025                0.94436      
    zi_9             0.025                 1.0894      
    zi_10            0.025                 1.2567      
    zi_11            0.025                 1.4496      
    zi_12            0.025                 1.6723      
    zi_13            0.025                 1.9291      
    zi_14            0.025                 2.2253      
    zi_15            0.025                  2.567      
    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      
    zi_31             0.95                0.34741      
    zi_32             0.95                0.40076      
    zi_33             0.95                 0.4623      
    zi_34             0.95                 0.5333      
    zi_35             0.95                0.61519      
    zi_36             0.95                0.70966      
    zi_37             0.95                0.81864      
    zi_38             0.95                0.94436      
    zi_39             0.95                 1.0894      
    zi_40             0.95                 1.2567      
    zi_41             0.95                 1.4496      
    zi_42             0.95                 1.6723      
    zi_43             0.95                 1.9291      
    zi_44             0.95                 2.2253      
    zi_45             0.95                  2.567      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_wage_mesh_r_infbr_r1w2
Prod/Wage Shock: ar_z_r_infbr_mesh_wage_r1w2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

            BorrowRShock_Meshed_    WageRShock_Meshed_
            ____________________    __________________

    zi_1          0.34741                  0.025      
    zi_2          0.34741                 0.4875      
    zi_3          0.34741                   0.95      
    zi_4          0.40076                  0.025      
    zi_5          0.40076                 0.4875      
    zi_6          0.40076                   0.95      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_40           2.2253                  0.025      
    zi_41           2.2253                 0.4875      
    zi_42           2.2253                   0.95      
    zi_43            2.567                  0.025      
    zi_44            2.567                 0.4875      
    zi_45            2.567                   0.95      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow Rate Transition Matrix: mt_z_r_infbr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     3     3

                  zi_1_r0_03    zi_2_r0_49    zi_3_r0_95
                  __________    __________    __________

    zi_1_r0_03     0.004525      0.090498      0.90498  
    zi_2_r0_49     0.004525      0.090498      0.90498  
    zi_3_r0_95     0.004525      0.090498      0.90498  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Wage Prod Shock Transition Matrix: mt_z_r_infbr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

                   zi_1_w0_35    zi_2_w0_40    zi_3_w0_46    zi_4_w0_53    zi_5_w0_62    zi_6_w0_71    zi_7_w0_82    zi_8_w0_94    zi_9_w1_09    zi_10_w1_26    zi_11_w1_45    zi_12_w1_67    zi_13_w1_93    zi_14_w2_23    zi_15_w2_57
                   __________    __________    __________    __________    __________    __________    __________    __________    __________    ___________    ___________    ___________    ___________    ___________    ___________

    zi_1_w0_35       0.26016       0.26831       0.25551       0.14921      0.053403      0.011702      0.001568      0.000128         6e-06             0              0              0              0              0              0  
    zi_2_w0_40       0.11232       0.19622        0.2763       0.23861       0.12635      0.040998      0.008143      0.000989       7.3e-05         3e-06              0              0              0              0              0  
    zi_3_w0_46      0.037073       0.10492        0.2185       0.27902        0.2185       0.10492      0.030863      0.005556      0.000611       4.1e-05          2e-06              0              0              0              0  
    zi_4_w0_53      0.009208      0.040998       0.12635       0.23861        0.2763       0.19622      0.085427      0.022782      0.003717       0.00037        2.3e-05          1e-06              0              0              0  
    zi_5_w0_62      0.001703      0.011702      0.053403       0.14921       0.25551       0.26831       0.17279      0.068209      0.016489      0.002438        0.00022        1.2e-05              0              0              0  
    zi_6_w0_71      0.000233      0.002438      0.016489      0.068209       0.17279       0.26831       0.25551       0.14921      0.053403      0.011702       0.001568       0.000128          6e-06              0              0  
    zi_7_w0_82       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622        0.2763       0.23861       0.12635      0.040998       0.008143       0.000989        7.3e-05          3e-06              0  
    zi_8_w0_94         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492        0.2185       0.27902        0.2185       0.10492       0.030863       0.005556       0.000611        4.1e-05          2e-06  
    zi_9_w1_09             0         3e-06       7.3e-05      0.000989      0.008143      0.040998       0.12635       0.23861        0.2763       0.19622       0.085427       0.022782       0.003717        0.00037        2.3e-05  
    zi_10_w1_26            0             0         6e-06      0.000128      0.001568      0.011702      0.053403       0.14921       0.25551       0.26831        0.17279       0.068209       0.016489       0.002438       0.000233  
    zi_11_w1_45            0             0             0       1.2e-05       0.00022      0.002438      0.016489      0.068209       0.17279       0.26831        0.25551        0.14921       0.053403       0.011702       0.001703  
    zi_12_w1_67            0             0             0         1e-06       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622         0.2763        0.23861        0.12635       0.040998       0.009208  
    zi_13_w1_93            0             0             0             0         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492         0.2185        0.27902         0.2185        0.10492       0.037073  
    zi_14_w2_23            0             0             0             0             0         3e-06       7.3e-05      0.000989      0.008143      0.040998        0.12635        0.23861         0.2763        0.19622        0.11232  
    zi_15_w2_57            0             0             0             0             0             0         6e-06      0.000128      0.001568      0.011702       0.053403        0.14921        0.25551        0.26831        0.26016  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Full Transition Matrix: mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

                       i1_r0_03_w0_35    i2_r0_03_w0_40    i3_r0_03_w0_46    i4_r0_03_w0_53    i5_r0_03_w0_62    i6_r0_03_w0_71    i7_r0_03_w0_82    i8_r0_03_w0_94    i9_r0_03_w1_09    i10_r0_03_w1_26    i11_r0_03_w1_45    i12_r0_03_w1_67    i13_r0_03_w1_93    i14_r0_03_w2_23    i15_r0_03_w2_57    i16_r0_49_w0_35    i17_r0_49_w0_40    i18_r0_49_w0_46    i19_r0_49_w0_53    i20_r0_49_w0_62    i21_r0_49_w0_71    i22_r0_49_w0_82    i23_r0_49_w0_94    i24_r0_49_w1_09    i25_r0_49_w1_26    i26_r0_49_w1_45    i27_r0_49_w1_67    i28_r0_49_w1_93    i29_r0_49_w2_23    i30_r0_49_w2_57    i31_r0_95_w0_35    i32_r0_95_w0_40    i33_r0_95_w0_46    i34_r0_95_w0_53    i35_r0_95_w0_62    i36_r0_95_w0_71    i37_r0_95_w0_82    i38_r0_95_w0_94    i39_r0_95_w1_09    i40_r0_95_w1_26    i41_r0_95_w1_45    i42_r0_95_w1_67    i43_r0_95_w1_93    i44_r0_95_w2_23    i45_r0_95_w2_57
                       ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________

    i1_r0_03_w0_35        0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i2_r0_03_w0_40        0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i3_r0_03_w0_46        0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i4_r0_03_w0_53         4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i5_r0_03_w0_62           8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i6_r0_03_w0_71           1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i7_r0_03_w0_82               0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i8_r0_03_w0_94               0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i9_r0_03_w1_09               0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i10_r0_03_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i11_r0_03_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i12_r0_03_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i13_r0_03_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i14_r0_03_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i15_r0_03_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    
    i16_r0_49_w0_35       0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i17_r0_49_w0_40       0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i18_r0_49_w0_46       0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i19_r0_49_w0_53        4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i20_r0_49_w0_62          8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i21_r0_49_w0_71          1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i22_r0_49_w0_82              0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i23_r0_49_w0_94              0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i24_r0_49_w1_09              0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i25_r0_49_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i26_r0_49_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i27_r0_49_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i28_r0_49_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i29_r0_49_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i30_r0_49_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    
    i31_r0_95_w0_35       0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i32_r0_95_w0_40       0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i33_r0_95_w0_46       0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i34_r0_95_w0_53        4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i35_r0_95_w0_62          8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i36_r0_95_w0_71          1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i37_r0_95_w0_82              0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i38_r0_95_w0_94              0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i39_r0_95_w1_09              0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i40_r0_95_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i41_r0_95_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i42_r0_95_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i43_r0_95_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i44_r0_95_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i45_r0_95_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    

</pre><h2 id="14">FIBS1: Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbzr_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);
</pre><h2 id="15">FIBS2: Get Formal Borrowing Blocks</h2><pre class="codeinput">[ar_forbrblk, ar_forbrblk_r] = <span class="keyword">...</span>
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);
</pre><h2 id="16">Find Formal and Informal Choices for Borrowing points</h2><p>Here we solve for the optimal formal and informal choices given b. Note that kind of like the static firm's maximization problem. Here the optimization problem is static, and can be done independently of the overall dynamic optimization problem.</p><pre class="codeinput"><span class="comment">% When borrowing index and array</span>
<span class="comment">% note index for negative is from _ar_a_meshk_full_, but value from</span>
<span class="comment">% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some</span>
<span class="comment">% of these points _ar_a_nobridge_meshk_ = 0. But need to use</span>
<span class="comment">% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all</span>
<span class="comment">% borrowing.</span>
ar_bl_ameshk_neg_idx = (ar_a_meshk_full &lt; 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

<span class="comment">% Given b, solve for optimal formal and informal choices.</span>
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_infbr_aneg, ar_for_save_aneg] = <span class="keyword">...</span>
   ffs_fibs_min_c_cost(bl_b_is_principle, ar_z_r_infbr, fl_r_fsv, <span class="keyword">...</span>
                         ar_forbrblk_r, ar_forbrblk, <span class="keyword">...</span>
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);
</pre><h2 id="17">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</h2><p><b>ar_coh_fbis_aneg</b>: the consumption cost to t+1 from borrowing in t given formal and informal joint choice optimization.</p><p>Reachable cash-on-hand borrowing points: N_neg*N^2 rows</p><p>Additionally, need to convert borrowing choices to consumption units next period. borrowing choices in percentage are in unit of last period borrowing, principles only, need to convert to interest rates plus principle which means considering which formal informal choice combination maximizes cash-on-hand for the same level of overall principles.</p><p>Construct another percentage, which is, percentages of ar_a_meshk_full when w &lt; 0. Percentage represents what fraction of the a debt is going towards bridge loan debts. Note that as long as w &lt; 0, b &lt; 0 must be the case as well. So for negative elements of w, there is a triple mesh: N points for A x N points for K x N points for Bridge.</p><pre class="codeinput">ar_coh_fbis_aneg = f_coh_fbis(ar_z_r_infbr, <span class="keyword">...</span>
                                ar_for_infbr_aneg, <span class="keyword">...</span>
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), <span class="keyword">...</span>
                                ar_for_save_aneg);
</pre><h2 id="18">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</h2><p><b>ar_coh_save_apos</b>: the consumption gain to t+1 from savings in t</p><pre class="codeinput">ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);
</pre><h2 id="19">COH1: Combine overall Reachable Cash-on-Hand Levels</h2><p>ROWS: N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count. These are the cash-on-hand points reachable given percentage grid choice structure and the possibility of bridge loans. COLUMNS: determined by length(ar_z_r_infbr), each column a different informal borrowing interest rate.</p><div><ol><li>mt_coh_wkb_full: this is the (P^k x I^w x M^r) by (M^z) matrix, where rows = it_w_interp_n*it_ak_perc_n*fl_z_r_infbr_n, and cols = it_z_wage_n.</li></ol></div><pre class="codeinput">mt_ameshk_tnext_with_r = zeros(length(ar_k_mesha), fl_z_r_infbr_n);
mt_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx, :) = ar_coh_fbis_aneg;
mt_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx, :) = zeros(1, fl_z_r_infbr_n) + ar_coh_save_apos;

<span class="comment">% # mt_ameshk_tnext_with_r: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w ) by (M^r) matrix</span>
<span class="comment">% # mt_coh_wkb_full: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix</span>

mt_k_mesha_mesh_z_wage = ar_k_mesha + zeros(1, fl_z_r_infbr_n);
mt_coh_wkb_full = f_coh(ar_z_wage, mt_ameshk_tnext_with_r(:), mt_k_mesha_mesh_z_wage(:));

<span class="comment">% Generate Aggregate Variables</span>
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

<span class="keyword">if</span> (bl_display_funcgrids || bl_graph_funcgrids)

    <span class="comment">% Generate Aggregate Variables</span>
    mt_bwithrplusk_mesh = mt_ameshk_tnext_with_r + ar_k_mesha;

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([mt_bwithrplusk_mesh, ar_aplusk_mesh, <span class="keyword">...</span>
                                  ar_k_mesha, mt_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = [strcat(<span class="string">'mt_bwthrplusk'</span>, string((1:length(ar_z_r_infbr)))), <span class="keyword">...</span>
                    <span class="string">'ar_aplusk_mesha'</span>, <span class="string">'ar_k_mesha'</span>, <span class="keyword">...</span>
                    strcat(<span class="string">'mt_a_wth_r_infbr'</span>, string((1:length(ar_z_r_infbr)))), <span class="keyword">...</span>
                    <span class="string">'ar_a_meshk'</span>, <span class="string">'ar_a_nobridge_meshk'</span>, <span class="string">'ar_bridge_a'</span>];
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_nobridge_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aprime_nobridge*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bridge_a'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bridge_a*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'tab_ak_choices'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_aplusk_mesha*:
*ar_k_mesha*:
*ar_a_meshk*:
*ar_aprime_nobridge*:
*ar_bridge_a*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
tab_ak_choices
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        2475          11

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3    tab_ak_choices4    tab_ak_choices5     tab_ak_choices6      tab_ak_choices7      tab_ak_choices8     tab_ak_choices9     tab_ak_choices10      tab_ak_choices11
    mt_bwthrplusk1     mt_bwthrplusk2     mt_bwthrplusk3     ar_aplusk_mesha      ar_k_mesha       mt_a_wth_r_infbr1    mt_a_wth_r_infbr2    mt_a_wth_r_infbr3      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a   
    _______________    _______________    _______________    _______________    _______________    _________________    _________________    _________________    _______________    ___________________    ________________

         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5               -29.75                  -39                -20                      0                 -20     
       -18.326            -26.596            -34.866             -17.879          0.0021212             -18.328              -26.598              -34.868            -17.881             -0.0021212             -17.879     
       -18.327            -26.619            -34.905             -17.879           0.050234             -18.377              -26.669              -34.955            -17.929              -0.050234             -17.879     
       -18.328            -26.637            -34.906             -17.879           0.098347             -18.427              -26.736              -35.004            -17.977              -0.098347             -17.879     
       -18.329            -26.638            -34.907             -17.879            0.14646             -18.476              -26.785              -35.054            -18.025               -0.14646             -17.879     
       -18.331             -26.64            -34.909             -17.879            0.19457             -18.525              -26.834              -35.103            -18.073               -0.19457             -17.879     
       -18.332            -26.641             -34.91             -17.879            0.24269             -18.575              -26.883              -35.152            -18.121               -0.24269             -17.879     
       -18.333            -26.642            -34.911             -17.879             0.2908             -18.624              -26.933              -35.202             -18.17                -0.2908             -17.879     
       -18.334            -26.643            -34.912             -17.879            0.33891             -18.673              -26.982              -35.251            -18.218               -0.33891             -17.879     
       -18.335            -26.644            -34.913             -17.879            0.38702             -18.722              -27.031                -35.3            -18.266               -0.38702             -17.879     
       -18.337            -26.646            -34.915             -17.879            0.43514             -18.772              -27.081               -35.35            -18.314               -0.43514             -17.879     
       -18.338            -26.647            -34.916             -17.879            0.48325             -18.821               -27.13              -35.399            -18.362               -0.48325             -17.879     
       -18.339            -26.648            -34.917             -17.879            0.53136              -18.87              -27.179              -35.448             -18.41               -0.53136             -17.879     
        -18.34            -26.649            -34.918             -17.879            0.57948              -18.92              -27.229              -35.498            -18.458               -0.57948             -17.879     
       -18.341             -26.65            -34.919             -17.879            0.62759             -18.969              -27.278              -35.547            -18.506               -0.62759             -17.879     
       -18.343            -26.652            -34.921             -17.879             0.6757             -19.018              -27.327              -35.596            -18.554                -0.6757             -17.879     
       -18.344            -26.653            -34.922             -17.879            0.72382             -19.068              -27.377              -35.646            -18.603               -0.72382             -17.879     
       -18.345            -26.654            -34.923             -17.879            0.77193             -19.117              -27.426              -35.695            -18.651               -0.77193             -17.879     
       -18.346            -26.655            -34.924             -17.879            0.82004             -19.166              -27.475              -35.744            -18.699               -0.82004             -17.879     
       -18.347            -26.656            -34.925             -17.879            0.86815             -19.216              -27.525              -35.793            -18.747               -0.86815             -17.879     
       -18.349            -26.658            -34.927             -17.879            0.91627             -19.265              -27.574              -35.843            -18.795               -0.91627             -17.879     
        -18.35            -26.659            -34.928             -17.879            0.96438             -19.314              -27.623              -35.892            -18.843               -0.96438             -17.879     
       -18.351            -26.666            -34.941             -17.879             1.0125             -19.364              -27.678              -35.953            -18.891                -1.0125             -17.879     
       -18.352            -26.689            -34.986             -17.879             1.0606             -19.413               -27.75              -36.047            -18.939                -1.0606             -17.879     
       -18.353            -26.713            -34.991             -17.879             1.1087             -19.462              -27.821                -36.1            -18.988                -1.1087             -17.879     
       -18.355            -26.724            -34.993             -17.879             1.1568             -19.512               -27.88              -36.149            -19.036                -1.1568             -17.879     

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3    tab_ak_choices4    tab_ak_choices5     tab_ak_choices6      tab_ak_choices7      tab_ak_choices8     tab_ak_choices9     tab_ak_choices10      tab_ak_choices11
    mt_bwthrplusk1     mt_bwthrplusk2     mt_bwthrplusk3     ar_aplusk_mesha      ar_k_mesha       mt_a_wth_r_infbr1    mt_a_wth_r_infbr2    mt_a_wth_r_infbr3      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a   
    _______________    _______________    _______________    _______________    _______________    _________________    _________________    _________________    _______________    ___________________    ________________

        48.304             48.304             48.304             47.879              30.86               17.444               17.444               17.444              17.019               17.019                 0        
        48.266             48.266             48.266             47.879               32.4               15.866               15.866               15.866              15.479               15.479                 0        
        48.227             48.227             48.227             47.879             33.939               14.288               14.288               14.288              13.939               13.939                 0        
        48.189             48.189             48.189             47.879             35.479                12.71                12.71                12.71                12.4                 12.4                 0        
         48.15              48.15              48.15             47.879             37.019               11.132               11.132               11.132               10.86                10.86                 0        
        48.112             48.112             48.112             47.879             38.558               9.5536               9.5536               9.5536              9.3206               9.3206                 0        
        48.073             48.073             48.073             47.879             40.098               7.9755               7.9755               7.9755              7.7809               7.7809                 0        
        48.035             48.035             48.035             47.879             41.637               6.3974               6.3974               6.3974              6.2413               6.2413                 0        
        47.996             47.996             47.996             47.879             43.177               4.8193               4.8193               4.8193              4.7017               4.7017                 0        
        47.958             47.958             47.958             47.879             44.717               3.2411               3.2411               3.2411              3.1621               3.1621                 0        
        47.919             47.919             47.919             47.879             46.256                1.663                1.663                1.663              1.6225               1.6225                 0        
        47.881             47.881             47.881             47.879             47.796             0.084937             0.084937             0.084937            0.082865             0.082865                 0        
        47.842             47.742             47.742             47.879             49.336              -1.4932              -1.5932              -1.5932             -1.4567              -1.4567                 0        
        47.804             47.644             47.644             47.879             50.875              -3.0713              -3.2313              -3.2313             -2.9964              -2.9964                 0        
        47.765             47.545             47.545             47.879             52.415              -4.6494              -4.8694              -4.8694              -4.536               -4.536                 0        
        47.727             47.447             47.447             47.879             53.954              -6.2275              -6.5075              -6.5075             -6.0756              -6.0756                 0        
        47.688             47.288             47.288             47.879             55.494              -7.8056              -8.2056              -8.2056             -7.6152              -7.6152                 0        
         47.65              47.25              47.25             47.879             57.034              -9.3837              -9.7837              -9.7837             -9.1548              -9.1548                 0        
        47.611             47.031             47.031             47.879             58.573              -10.962              -11.542              -11.542             -10.694              -10.694                 0        
        47.573             46.993             46.993             47.879             60.113               -12.54               -13.12               -13.12             -12.234              -12.234                 0        
        47.534             46.954             46.954             47.879             61.652              -14.118              -14.698              -14.698             -13.774              -13.774                 0        
        47.496             46.736             46.736             47.879             63.192              -15.696              -16.456              -16.456             -15.313              -15.313                 0        
        47.457             46.697             46.697             47.879             64.732              -17.274              -18.034              -18.034             -16.853              -16.853                 0        
        47.419             46.659             46.659             47.879             66.271              -18.852              -19.612              -19.612             -18.393              -18.393                 0        
         47.38             46.189             45.758             47.879             67.811               -20.43              -21.622              -22.053             -19.932              -19.932                 0        
        51.248             51.248             51.248                 50               0.07               51.178               51.178               51.178               49.93                49.93                 0        
        51.209             51.209             51.209                 50             1.6577               49.551               49.551               49.551              48.342               48.342                 0        
        51.169             51.169             51.169                 50             3.2455               47.923               47.923               47.923              46.755               46.755                 0        
        51.129             51.129             51.129                 50             4.8332               46.296               46.296               46.296              45.167               45.167                 0        
        51.089             51.089             51.089                 50             6.4209               44.669               44.669               44.669              43.579               43.579                 0        
         51.05              51.05              51.05                 50             8.0086               43.041               43.041               43.041              41.991               41.991                 0        
         51.01              51.01              51.01                 50             9.5964               41.414               41.414               41.414              40.404               40.404                 0        
         50.97              50.97              50.97                 50             11.184               39.786               39.786               39.786              38.816               38.816                 0        
        50.931             50.931             50.931                 50             12.772               38.159               38.159               38.159              37.228               37.228                 0        
        50.891             50.891             50.891                 50              14.36               36.531               36.531               36.531               35.64                35.64                 0        
        50.851             50.851             50.851                 50             15.947               34.904               34.904               34.904              34.053               34.053                 0        
        50.812             50.812             50.812                 50             17.535               33.277               33.277               33.277              32.465               32.465                 0        
        50.772             50.772             50.772                 50             19.123               31.649               31.649               31.649              30.877               30.877                 0        
        50.732             50.732             50.732                 50              20.71               30.022               30.022               30.022               29.29                29.29                 0        
        50.693             50.693             50.693                 50             22.298               28.394               28.394               28.394              27.702               27.702                 0        
        50.653             50.653             50.653                 50             23.886               26.767               26.767               26.767              26.114               26.114                 0        
        50.613             50.613             50.613                 50             25.474                25.14                25.14                25.14              24.526               24.526                 0        
        50.573             50.573             50.573                 50             27.061               23.512               23.512               23.512              22.939               22.939                 0        
        50.534             50.534             50.534                 50             28.649               21.885               21.885               21.885              21.351               21.351                 0        
        50.494             50.494             50.494                 50             30.237               20.257               20.257               20.257              19.763               19.763                 0        
        50.454             50.454             50.454                 50             31.825                18.63                18.63                18.63              18.175               18.175                 0        
        50.415             50.415             50.415                 50             33.412               17.002               17.002               17.002              16.588               16.588                 0        
        50.375             50.375             50.375                 50                 35               15.375               15.375               15.375                  15                   15                 0        
        50.335             50.335             50.335                 50             36.588               13.748               13.748               13.748              13.412               13.412                 0        
        50.296             50.296             50.296                 50             38.175                12.12                12.12                12.12              11.825               11.825                 0        
        50.256             50.256             50.256                 50             39.763               10.493               10.493               10.493              10.237               10.237                 0        
        50.216             50.216             50.216                 50             41.351               8.8653               8.8653               8.8653              8.6491               8.6491                 0        
        50.177             50.177             50.177                 50             42.939               7.2379               7.2379               7.2379              7.0614               7.0614                 0        
        50.137             50.137             50.137                 50             44.526               5.6105               5.6105               5.6105              5.4736               5.4736                 0        
        50.097             50.097             50.097                 50             46.114               3.9831               3.9831               3.9831              3.8859               3.8859                 0        
        50.057             50.057             50.057                 50             47.702               2.3556               2.3556               2.3556              2.2982               2.2982                 0        
        50.018             50.018             50.018                 50              49.29              0.72822              0.72822              0.72822             0.71045              0.71045                 0        
        49.978             49.938             49.938                 50             50.877              -0.8992              -0.9392              -0.9392            -0.87727             -0.87727                 0        
        49.938             49.838             49.838                 50             52.465              -2.5266              -2.6266              -2.6266              -2.465               -2.465                 0        
        49.899             49.714              49.69                 50             54.053               -4.154              -4.3384              -4.3628             -4.0527              -4.0527                 0        
        49.859             49.579             49.579                 50              55.64              -5.7815              -6.0615              -6.0615             -5.6405              -5.6405                 0        
        49.819             49.434             49.419                 50             57.228              -7.4089              -7.7944              -7.8089             -7.2282              -7.2282                 0        
         49.78              49.38              49.38                 50             58.816              -9.0363              -9.4363              -9.4363             -8.8159              -8.8159                 0        
         49.74              49.16              49.16                 50             60.404              -10.664              -11.244              -11.244             -10.404              -10.404                 0        
          49.7              49.12              49.12                 50             61.991              -12.291              -12.871              -12.871             -11.991              -11.991                 0        
        49.661             49.081             49.081                 50             63.579              -13.919              -14.499              -14.499             -13.579              -13.579                 0        
        49.621             48.861             48.861                 50             65.167              -15.546              -16.306              -16.306             -15.167              -15.167                 0        
        49.581             48.821             48.821                 50             66.755              -17.173              -17.933              -17.933             -16.755              -16.755                 0        
        49.541             48.781             48.781                 50             68.342              -18.801              -19.561              -19.561             -18.342              -18.342                 0        
        49.502             48.312             47.881                 50              69.93              -20.428              -21.618              -22.049              -19.93               -19.93                 0        

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        7425          15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -17.844             -17.839             -17.832             -17.824             -17.815             -17.805             -17.793             -17.779             -17.764              -17.745              -17.724                -17.7              -17.672               -17.64              -17.602     
        -17.769             -17.751              -17.73             -17.706             -17.678             -17.646             -17.608             -17.566             -17.516              -17.459              -17.394              -17.318               -17.23              -17.129              -17.013     
        -17.742             -17.719             -17.692             -17.661             -17.626             -17.585             -17.537             -17.483              -17.42              -17.347              -17.263              -17.167              -17.055              -16.927              -16.779     
        -17.724             -17.697             -17.666              -17.63             -17.589             -17.542             -17.488             -17.425             -17.352              -17.268              -17.172               -17.06              -16.931              -16.783              -16.612     
         -17.71              -17.68             -17.646             -17.607             -17.561             -17.509             -17.448             -17.379             -17.298              -17.205              -17.098              -16.975              -16.832              -16.668              -16.479     
        -17.699             -17.667              -17.63             -17.587             -17.538             -17.481             -17.416              -17.34             -17.253              -17.153              -17.037              -16.903              -16.749              -16.571              -16.366     
         -17.69             -17.656             -17.616             -17.571             -17.518             -17.458             -17.388             -17.307             -17.214              -17.107              -16.983              -16.841              -16.676              -16.486              -16.267     
        -17.682             -17.646             -17.605             -17.556             -17.501             -17.437             -17.363             -17.278              -17.18              -17.066              -16.936              -16.785              -16.611               -16.41              -16.179     
        -17.676             -17.638             -17.594             -17.544             -17.486             -17.419             -17.341             -17.252             -17.149               -17.03              -16.893              -16.735              -16.552              -16.342              -16.099     
         -17.67             -17.631             -17.585             -17.533             -17.472             -17.402             -17.321             -17.228              -17.12              -16.996              -16.853              -16.688              -16.498              -16.279              -16.025     
        -17.665             -17.624             -17.577             -17.522             -17.459             -17.387             -17.303             -17.206             -17.094              -16.966              -16.817              -16.646              -16.448               -16.22              -15.957     
        -17.661             -17.619              -17.57             -17.513             -17.448             -17.373             -17.286             -17.186              -17.07              -16.937              -16.783              -16.606              -16.402              -16.166              -15.893     
        -17.658             -17.614             -17.563             -17.505             -17.437              -17.36              -17.27             -17.167             -17.048               -16.91              -16.752              -16.569              -16.358              -16.115              -15.834     
        -17.654             -17.609             -17.557             -17.497             -17.428             -17.348             -17.256             -17.149             -17.027              -16.885              -16.722              -16.534              -16.317              -16.066              -15.777     
        -17.651             -17.605             -17.552              -17.49             -17.419             -17.337             -17.242             -17.133             -17.007              -16.862              -16.694              -16.501              -16.278              -16.021              -15.724     
        -17.649             -17.601             -17.547             -17.483              -17.41             -17.326             -17.229             -17.117             -16.988              -16.839              -16.668               -16.47              -16.241              -15.977              -15.673     
        -17.647             -17.598             -17.542             -17.477             -17.403             -17.317             -17.217             -17.103             -16.971              -16.818              -16.643               -16.44              -16.206              -15.936              -15.625     
        -17.645             -17.595             -17.538             -17.472             -17.395             -17.307             -17.206             -17.089             -16.954              -16.798              -16.618              -16.411              -16.172              -15.896              -15.578     
        -17.643             -17.592             -17.534             -17.466             -17.389             -17.299             -17.195             -17.076             -16.938              -16.779              -16.596              -16.384               -16.14              -15.858              -15.534     
        -17.642              -17.59              -17.53             -17.462             -17.382             -17.291             -17.185             -17.063             -16.923              -16.761              -16.574              -16.358              -16.109              -15.822              -15.491     
         -17.64             -17.588             -17.527             -17.457             -17.376             -17.283             -17.175             -17.051             -16.908              -16.743              -16.553              -16.333              -16.079              -15.787               -15.45     
        -17.639             -17.586             -17.524             -17.453              -17.37             -17.276             -17.166              -17.04             -16.894              -16.726              -16.532              -16.309              -16.051              -15.753               -15.41     
        -17.639             -17.584             -17.521             -17.449             -17.365             -17.269             -17.157             -17.029             -16.881               -16.71              -16.513              -16.285              -16.023              -15.721              -15.371     
        -17.638             -17.583             -17.519             -17.445              -17.36             -17.262             -17.149             -17.018             -16.868              -16.694              -16.494              -16.263              -15.996              -15.689              -15.334     
        -17.637             -17.581             -17.516             -17.442             -17.355             -17.256             -17.141             -17.008             -16.856              -16.679              -16.476              -16.241              -15.971              -15.658              -15.298     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         47.473              47.657              47.868              48.112              48.394              48.718              49.093              49.525              50.023              50.598               51.262               52.027               52.909               53.928               55.102      
         47.333              47.519              47.734              47.983              48.269                48.6              48.981              49.421              49.928              50.513               51.188               51.967               52.865               53.901               55.096      
         47.191              47.381                47.6              47.853              48.144               48.48              48.867              49.315               49.83              50.425               51.112               51.904               52.817               53.871               55.086      
          47.05              47.242              47.465              47.721              48.017              48.359              48.753              49.207              49.731              50.336               51.033               51.838               52.766               53.836               55.071      
         46.907              47.103              47.329              47.589               47.89              48.237              48.637              49.098               49.63              50.244               50.952               51.769               52.712               53.799               55.053      
         46.765              46.963              47.192              47.457              47.762              48.114              48.519              48.988              49.528              50.151               50.869               51.698               52.654               53.758                55.03      
         46.621              46.823              47.055              47.323              47.633              47.989              48.401              48.876              49.423              50.055               50.784               51.625               52.595               53.714               55.004      
         46.477              46.682              46.917              47.189              47.503              47.864              48.282              48.763              49.318              49.958               50.697                51.55               52.533               53.667               54.975      
         46.333               46.54              46.779              47.054              47.372              47.738              48.161              48.649              49.211               49.86               50.609               51.472               52.468               53.617               54.943      
         46.189              46.398               46.64              46.919              47.241              47.612               48.04              48.534              49.103               49.76               50.518               51.393               52.401               53.565               54.907      
         46.044              46.256              46.501              46.783              47.109              47.484              47.918              48.417              48.994              49.659               50.426               51.312               52.333               53.511               54.869      
         45.899              46.113              46.361              46.646              46.976              47.356              47.794                48.3              48.884              49.557               50.333               51.229               52.262               53.454               54.829      
         45.653               45.87               46.12              46.409              46.743              47.127              47.571              48.082              48.672              49.353               50.138               51.044               52.089               53.295               54.686      
         45.447              45.667               45.92              46.212              46.549              46.938              47.386              47.903                48.5              49.188               49.982               50.898               51.955               53.174                54.58      
         45.241              45.463              45.719              46.014              46.355              46.747              47.201              47.724              48.327              49.023               49.825               50.751               51.819               53.051               54.472      
         45.034              45.258              45.517              45.815               46.16              46.557              47.015              47.543              48.153              48.856               49.667               50.602               51.681               52.926               54.363      
         44.767              44.994              45.255              45.557              45.904              46.305              46.768              47.302              47.917              48.628               49.447               50.392               51.482                52.74               54.191      
          44.62              44.849              45.113              45.417              45.769              46.174              46.641               47.18              47.802              48.519               49.346               50.301               51.402               52.672               54.137      
         44.293              44.524               44.79              45.098              45.452              45.861              46.333              46.877              47.505              48.229               49.065               50.028                51.14               52.422               53.901      
         44.146              44.379              44.648              44.958              45.316              45.728              46.205              46.754              47.388              48.119               48.962               49.934               51.057               52.351               53.844      
         43.998              44.233              44.504              44.817              45.179              45.595              46.076               46.63              47.269              48.007               48.858                49.84               50.972               52.278               53.785      
          43.67              43.907              44.181              44.497              44.861              45.281              45.766              46.325              46.971              47.715               48.573               49.564               50.706               52.024               53.544      
         43.522              43.761              44.037              44.356              44.723              45.147              45.636                46.2              46.851              47.602               48.468               49.467               50.619               51.949               53.482      
         43.373              43.615              43.893              44.214              44.585              45.013              45.506              46.075              46.731              47.488               48.361               49.369               50.531               51.872               53.418      
         42.362              42.606              42.887              43.211              43.584              44.015              44.513              45.086              45.748              46.511               47.392               48.408                49.58               50.931               52.491      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.936                  52              52.074              52.159              52.258              52.371              52.502              52.652              52.826              53.027               53.259               53.526               53.834               54.189               54.599      
         51.884              51.965              52.059              52.168              52.293              52.437              52.604              52.796              53.017              53.273               53.568               53.908                 54.3               54.753               55.275      
         51.799              51.893              52.001              52.127              52.271              52.438               52.63              52.851              53.107              53.402               53.742               54.135               54.588                55.11               55.713      
         51.698              51.802              51.922              52.061              52.221              52.406              52.618              52.864              53.147              53.474               53.851               54.286               54.787               55.366               56.033      
         51.587                51.7               51.83              51.981              52.154              52.354              52.584               52.85              53.157               53.51               53.919               54.389               54.932               55.559               56.282      
          51.47              51.591               51.73               51.89              52.075              52.288              52.534              52.818              53.145              53.523               53.958               54.461                55.04               55.709                56.48      
         51.348              51.475              51.622              51.791              51.987              52.212              52.472              52.772              53.118              53.517               53.977               54.508                55.12               55.827               56.642      
         51.222              51.355              51.509              51.687              51.892              52.128              52.401              52.715              53.078              53.497               53.979               54.536               55.179                55.92               56.775      
         51.092              51.232              51.392              51.578              51.791              52.038              52.322               52.65              53.029              53.465               53.969                54.55                55.22               55.993               56.885      
         50.961              51.105              51.272              51.464              51.686              51.942              52.238              52.578              52.971              53.425               53.948               54.551               55.247                56.05               56.976      
         50.827              50.976              51.149              51.348              51.578              51.842              52.148              52.501              52.907              53.376               53.918               54.542               55.262               56.093               57.051      
         50.691              50.845              51.023              51.229              51.466              51.739              52.054              52.418              52.837              53.321                53.88               54.524               55.267               56.124               57.112      
         50.553              50.712              50.895              51.107              51.351              51.632              51.956              52.331              52.762              53.261               53.835               54.498               55.263               56.145               57.162      
         50.415              50.578              50.766              50.983              51.233              51.522              51.855               52.24              52.683              53.195               53.785               54.465               55.251               56.156               57.201      
         50.274              50.442              50.635              50.857              51.114               51.41              51.751              52.145                52.6              53.124               53.729               54.427               55.232                56.16               57.231      
         50.133              50.304              50.502               50.73              50.992              51.295              51.645              52.048              52.513               53.05               53.669               54.383               55.207               56.157               57.253      
         49.991              50.166              50.368                50.6              50.869              51.179              51.536              51.948              52.423              52.972               53.605               54.334               55.176               56.147               57.268      
         49.848              50.027              50.232               50.47              50.744               51.06              51.425              51.846              52.331              52.891               53.536               54.281               55.141               56.132               57.275      
         49.704              49.886              50.096              50.338              50.618               50.94              51.312              51.741              52.236              52.806               53.465               54.224                 55.1               56.111               57.277      
         49.559              49.745              49.959              50.205               50.49              50.818              51.197              51.634              52.138              52.719                53.39               54.164               55.056               56.086               57.273      
         49.414              49.603               49.82              50.071              50.361              50.695              51.081              51.525              52.038               52.63               53.312                 54.1               55.008               56.056               57.264      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         49.121              49.316              49.541              49.801                50.1              50.445              50.843              51.303              51.833              52.444               53.149               53.963               54.901               55.984               57.233      
         48.974              49.172              49.401              49.664              49.968              50.318              50.723              51.189              51.727              52.348               53.064                53.89               54.843               55.942                57.21      
         48.827              49.028              49.259              49.527              49.835              50.191              50.601              51.074               51.62               52.25               52.977               53.815               54.782               55.898               57.184      
         48.679              48.882              49.117              49.388              49.701              50.062              50.478              50.958              51.512              52.151               52.888               53.738               54.719                55.85               57.155      
          48.53              48.736              48.975              49.249              49.567              49.932              50.354              50.841              51.402               52.05               52.797               53.658               54.653               55.799               57.122      
         48.381               48.59              48.832               49.11              49.431              49.802              50.229              50.722              51.291              51.947               52.704               53.577               54.584               55.746               57.086      
         48.231              48.443              48.688               48.97              49.295               49.67              50.103              50.602              51.178              51.843               52.609               53.493               54.513                55.69               57.047      
         48.082              48.296              48.544              48.829              49.158              49.538              49.976              50.482              51.065              51.737               52.513               53.408               54.441               55.632               57.006      
         47.932              48.149              48.399              48.688              49.021              49.405              49.849               50.36               50.95               51.63               52.416               53.321               54.366               55.571               56.961      
         47.741              47.961              48.214              48.506              48.843              49.232               49.68              50.197              50.794              51.482               52.277               53.193               54.249               55.468               56.874      
          47.53              47.752              48.008              48.304              48.644              49.037              49.491              50.014              50.617              51.313               52.116               53.042               54.111               55.343               56.765      
          47.27              47.495              47.754              48.052              48.397              48.794              49.252              49.781              50.391              51.094               51.906               52.842               53.922               55.168               56.605      
         47.048              47.274              47.536              47.838              48.186              48.587               49.05              49.584              50.201              50.912               51.732               52.678               53.769               55.028                56.48      
         46.776              47.005              47.269              47.574              47.926              48.331              48.799              49.339              49.961              50.679               51.508               52.463               53.566               54.837               56.304      
         46.624              46.855              47.122               47.43              47.785              48.195              48.667              49.212              49.841              50.566               51.403               52.368               53.481               54.765               56.247      
         46.292              46.525              46.795              47.106              47.464              47.878              48.355              48.905               49.54              50.272               51.116               52.091               53.215               54.512               56.007      
         46.139              46.375              46.647              46.961              47.323               47.74              48.221              48.777              49.418              50.157               51.009               51.993               53.127               54.436               55.946      
         45.987              46.225              46.499              46.816              47.181              47.602              48.088              48.648              49.295              50.041               50.901               51.894               53.039               54.359               55.883      
         45.654              45.894              46.171               46.49              46.858              47.283              47.774              48.339              48.991              49.744               50.612               51.613               52.769               54.101               55.638      
         45.501              45.743              46.022              46.344              46.716              47.144              47.639              48.209              48.867              49.626               50.502               51.512               52.677               54.022               55.572      
         45.347              45.592              45.873              46.198              46.573              47.005              47.504              48.079              48.743              49.508               50.391                51.41               52.585               53.941               55.504      
         44.334               44.58              44.864              45.191              45.569              46.005              46.508              47.088              47.757              48.529               49.419               50.447               51.631               52.998               54.575      

</pre><h2 id="20">COH2: Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
<span class="comment">% mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));</span>
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, length(ar_w_level_full)*fl_z_r_infbr_n]);

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>

ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_infbr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));
</pre><h2 id="21">COH3: Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="22">COH4: Select only Valid (k(w), a) choices</h2><pre class="codeinput"><span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;
<span class="comment">% mt_z_wage_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);</span>
<span class="comment">% mt_z_r_infbr_mesh_coh_wkb = repmat(ar_z_r_infbr, [size(mt_coh_wkb,1),1]);</span>
mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);
</pre><h2 id="23">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>

<span class="comment">% This is borrowing with default or not condition</span>
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);
</pre><h2 id="24">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="comment">% 1. Given COH grid, w choices in terms of cash-on-hand percentages</span>
<span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>

<span class="comment">% 2. Some w &lt; 0, some w &gt; 0. When w &lt; 0, coh &gt; 0 or coh &lt; 0 both possible.</span>
<span class="comment">% Need to interplate in ff_ipwkbzr_fibs_vecsv differently for w &lt; 0 because</span>
<span class="comment">% there both w as well as coh matters, if coh &lt; 0 and w &lt; 0, a fraction of</span>
<span class="comment">% w goes to getting informal bridge loans.</span>
mt_bl_w_perc_mesh_interp_coh_grid_wneg = (mt_w_perc_mesh_interp_coh_grid &lt; 0);
mt_w_perc_mesh_interp_coh_grid_wneg = mt_w_perc_mesh_interp_coh_grid(mt_bl_w_perc_mesh_interp_coh_grid_wneg);
mt_w_perc_mesh_interp_coh_grid_wpos = mt_w_perc_mesh_interp_coh_grid(~mt_bl_w_perc_mesh_interp_coh_grid_wneg);
</pre><h2 id="25">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</h2><p>If bridge loan does not matter, do not need to cover bridge loan. Then these percentages should reflect what happens when param_map('bl_bridge') = false, and, param_map('it_coh_bridge_perc_n') = 1;</p><pre class="codeinput"><span class="comment">% 1. Expand cash-on-hand by w_perc grid</span>
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_perc_mesh_interp_coh_grid)) + ar_interp_coh_grid;

<span class="comment">% 2. How much is coh as perc of w_perc grid level choice based on w_perc</span>
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_perc_mesh_interp_coh_grid));

<span class="comment">% 3. The ratio only relevant for where w &lt; 0 and where coh &lt; 0. Note the</span>
<span class="comment">% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to</span>
<span class="comment">% bridge.</span>
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc &gt;= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_perc_mesh_interp_coh_grid_wneg);
</pre><h2 id="26">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="27">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="28">Store armt_map (1): base arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>ar_interp_c_grid: 1 by I^c</li><li>ar_interp_coh_grid: 1 by I^{coh}</li><li>ar_w_level: 1 by I^{W=k+b}</li><li>ar_w_perc: 1 by P^{W=k+b}</li><li>ar_ak_perc: 1 by P^{k and b}</li></ol></div><p>more descriptions:</p><div><ol><li>ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation</li><li>ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)</li><li>ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li>ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set. 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li>ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
</pre><h2 id="29">Store armt_map (2): 1st stage level coh on hand related arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w</li><li>mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w</li><li>mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}</li><li>mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}</li></ol></div><p>more descriptions:</p><div><ol><li><b>mt_w_perc_mesh_interp_coh_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_interp_coh_grid_mesh_z_wage'</span>) = mt_interp_coh_grid_mesh_z_wage;
armt_map(<span class="string">'mt_z_wage_mesh_interp_coh_grid'</span>) = mt_z_wage_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;
armt_map(<span class="string">'mt_w_perc_mesh_interp_coh_grid'</span>) = mt_w_perc_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
</pre><h2 id="30">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_coh_wkb: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix</li><li>mt_z_wage_mesh_coh_wkb: same as mt_coh_wkb</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_z_wage_mesh_coh_wkb'</span>) = mt_z_wage_mesh_coh_wkb;
</pre><h2 id="31">Store armt_map (4): 2nd stage additional arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_k: (I^w) by (P^{k and b})</li><li>ar_a_meshk: 1 by (I^w x P^{k and b})</li><li>ar_k_mesha: 1 by (I^w x P^{k and b})</li><li>ar_aplusk_mesh: 1 by (I^w x P^{k and b})</li><li>it_ameshk_n: scalar</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'ar_aplusk_mesh'</span>) = ar_aplusk_mesh;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
</pre><h2 id="32">Store armt_map (5): Shock Grids Arrays and Mesh</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>ar_z_r_infbr: 1 by (M^r)</li><li>ar_z_r_infbr_prob: 1 by (M^r)</li><li>ar_z_wage: 1 by (M^z)</li><li>ar_z_wage_prob: 1 by (M^z)</li><li>ar_z_r_infbr_mesh_wage_w1r2: 1 by (M^z x M^r)</li><li>ar_z_wage_mesh_r_infbr_w1r2: 1 by (M^z x M^r)</li><li>ar_z_r_infbr_mesh_wage_r1w2: 1 by (M^r x M^z)</li><li>ar_z_wage_mesh_r_infbr_r1w2: 1 by (M^r x M^z)</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_z_r_infbr'</span>) = ar_z_r_infbr;
armt_map(<span class="string">'ar_z_r_infbr_prob'</span>) = ar_z_r_infbr_prob;

armt_map(<span class="string">'ar_z_wage'</span>) = ar_z_wage;
armt_map(<span class="string">'ar_z_wage_prob'</span>) = ar_z_wage_prob;

armt_map(<span class="string">'ar_z_r_infbr_mesh_wage_w1r2'</span>) = ar_z_r_infbr_mesh_wage_w1r2;
armt_map(<span class="string">'ar_z_wage_mesh_r_infbr_w1r2'</span>) = ar_z_wage_mesh_r_infbr_w1r2;
armt_map(<span class="string">'ar_z_r_infbr_mesh_wage_r1w2'</span>) = ar_z_r_infbr_mesh_wage_r1w2;
armt_map(<span class="string">'ar_z_wage_mesh_r_infbr_r1w2'</span>) = ar_z_wage_mesh_r_infbr_r1w2;

armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
</pre><h2 id="33">Store armt_map (6): W Share for Bridge Parameters</h2><div><ol><li><b>ar_w_level_full</b>: in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/solve/html/ff_ipwkbzr_vf_vecsv.html">ff_ipwkbzr_vf_vecsv</a>, <i>ar_w_level</i> and <i>ar_w_level_full</i> were the same. Now have this thing which is stored (length(ar_w_level_full)) by (length(ar_z)). <i>ar_w_level_full</i> includes not just different levels of <i>ar_w_level</i>, but also repeats the elements of <i>ar_w_level</i> that are &lt; 0 by <i>it_coh_bridge_perc_n</i> times, starting with what corresponds to 100 percent of w should go to cover bridge loan, until 0 percent for w &lt; 0, which then proceeds to w &gt; 0. So the last segment of <i>ar_w_level_full</i> is the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) = ar_w_level.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_coh_bridge_perc'</span>) = ar_coh_bridge_perc;
armt_map(<span class="string">'ar_w_level_full'</span>) = ar_w_level_full;
armt_map(<span class="string">'ar_ameshk_tnext_with_r'</span>) = mt_ameshk_tnext_with_r;

armt_map(<span class="string">'mt_w_level_neg_mesh_coh_bridge_perc'</span>) = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map(<span class="string">'mt_coh_bridge_perc_mesh_w_level_neg'</span>) = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map(<span class="string">'mt_bl_w_perc_mesh_interp_coh_grid_wneg'</span>) = mt_bl_w_perc_mesh_interp_coh_grid_wneg;
armt_map(<span class="string">'mt_w_perc_mesh_interp_coh_grid_wneg'</span>) = mt_w_perc_mesh_interp_coh_grid_wneg;
armt_map(<span class="string">'mt_w_perc_mesh_interp_coh_grid_wpos'</span>) = mt_w_perc_mesh_interp_coh_grid_wpos;
armt_map(<span class="string">'mt_coh_w_perc_ratio_wneg'</span>) = mt_coh_w_perc_ratio_wneg;
</pre><h2 id="34">Store armt_map (7): Formal Informal Arrays</h2><pre class="codeinput">armt_map(<span class="string">'ar_forbrblk'</span>) = ar_forbrblk;
armt_map(<span class="string">'ar_forbrblk_r'</span>) = ar_forbrblk_r;
</pre><h2 id="35">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_util_standin_coh'</span>) = f_util_standin_coh;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_coh_fbis'</span>) = f_coh_fbis;
func_map(<span class="string">'f_coh_save'</span>) = f_coh_save;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="36">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="38">Generate Limited Legends</h2><p>8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates</p><pre class="codeinput">    ar_it_z_r_infbr = ([1 round((fl_z_r_infbr_n)/2) (fl_z_r_infbr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    <span class="comment">% combine by index</span>
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_infbr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    <span class="comment">% legends index final</span>
    cl_st_legendCell = cellstr([num2str(ar_z_r_infbr_mesh_wage_w1r2', <span class="string">'zr=%3.2f;'</span>), <span class="keyword">...</span>
                                num2str(ar_z_wage_mesh_r_infbr_w1r2', <span class="string">'zw=%3.2f'</span>)]);

    <span class="comment">% legends index final full mat wage only</span>
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', <span class="string">'zw=%3.2f'</span>)]);
</pre><h2 id="39">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><p>Plot end because earlier parts have repeating w and a levels due to potentially bridge which are coh percentage dependent. This will only plot out the grid basically when coh percentage for bridge loan = 0</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 mt_k(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 <span class="string">'blue'</span>);

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
    scatter(ar_a_meshk(it_col_start:it_col_end), <span class="keyword">...</span>
            ar_k_mesha(it_col_start:it_col_end), <span class="keyword">...</span>
            3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),<span class="keyword">...</span>
                                     ar_k_mesha_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title({<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span><span class="keyword">...</span>
           <span class="string">'(Bridge Borrow Share = 0)'</span>})
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_fibs_get_funcgrid_01.png" alt=""> <h2 id="40">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
            <span class="string">'Super-Seg: borrow r; Seg: w bridge perc; Sub-Seg: w=k+b; within inc. k'</span><span class="keyword">...</span>
            <span class="string">'For each w and z, coh maximizing k is different'</span>});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="keyword">...</span>
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_fibs_get_funcgrid_02.png" alt=""> <h2 id="41">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_fibs_get_funcgrid_03.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="43">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="45">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_fibs_get_funcgrid_04.png" alt=""> <h2 id="46">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_fibs_get_funcgrid_05.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="48">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z_wage'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_w_perc_mesh_interp_coh_grid));
    disp(head(array2table(mt_w_perc_mesh_interp_coh_grid), 10));
    disp(tail(array2table(mt_w_perc_mesh_interp_coh_grid), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_coh_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_coh_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_c_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_c_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_interp_coh_grid_mesh_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_a'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_a_meshk'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_a_meshk));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_k'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_k_mesha'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    <span class="keyword">for</span> i = 1:length(func_map)
        st_display = strjoin([<span class="string">'pos ='</span> num2str(i) <span class="string">'; key ='</span> string(param_map_keys{i}) <span class="string">'; val ='</span> func2str(param_map_vals{i})]);
        disp(st_display);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z_wage
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    55

  Columns 1 through 7

  -20.0000  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727

  Columns 8 through 14

   -5.1515   -3.0303   -0.9091  -20.0000  -17.8788  -15.7576  -13.6364

  Columns 15 through 21

  -11.5152   -9.3939   -7.2727   -5.1515   -3.0303   -0.9091  -20.0000

  Columns 22 through 28

  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727   -5.1515

  Columns 29 through 35

   -3.0303   -0.9091         0    1.2121    3.3333    5.4545    7.5758

  Columns 36 through 42

    9.6970   11.8182   13.9394   16.0606   18.1818   20.3030   22.4242

  Columns 43 through 49

   24.5455   26.6667   28.7879   30.9091   33.0303   35.1515   37.2727

  Columns 50 through 55

   39.3939   41.5152   43.6364   45.7576   47.8788   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    25    38

    mt_w_perc_mesh_interp_coh_grid1    mt_w_perc_mesh_interp_coh_grid2    mt_w_perc_mesh_interp_coh_grid3    mt_w_perc_mesh_interp_coh_grid4    mt_w_perc_mesh_interp_coh_grid5    mt_w_perc_mesh_interp_coh_grid6    mt_w_perc_mesh_interp_coh_grid7    mt_w_perc_mesh_interp_coh_grid8    mt_w_perc_mesh_interp_coh_grid9    mt_w_perc_mesh_interp_coh_grid10    mt_w_perc_mesh_interp_coh_grid11    mt_w_perc_mesh_interp_coh_grid12    mt_w_perc_mesh_interp_coh_grid13    mt_w_perc_mesh_interp_coh_grid14    mt_w_perc_mesh_interp_coh_grid15    mt_w_perc_mesh_interp_coh_grid16    mt_w_perc_mesh_interp_coh_grid17    mt_w_perc_mesh_interp_coh_grid18    mt_w_perc_mesh_interp_coh_grid19    mt_w_perc_mesh_interp_coh_grid20    mt_w_perc_mesh_interp_coh_grid21    mt_w_perc_mesh_interp_coh_grid22    mt_w_perc_mesh_interp_coh_grid23    mt_w_perc_mesh_interp_coh_grid24    mt_w_perc_mesh_interp_coh_grid25    mt_w_perc_mesh_interp_coh_grid26    mt_w_perc_mesh_interp_coh_grid27    mt_w_perc_mesh_interp_coh_grid28    mt_w_perc_mesh_interp_coh_grid29    mt_w_perc_mesh_interp_coh_grid30    mt_w_perc_mesh_interp_coh_grid31    mt_w_perc_mesh_interp_coh_grid32    mt_w_perc_mesh_interp_coh_grid33    mt_w_perc_mesh_interp_coh_grid34    mt_w_perc_mesh_interp_coh_grid35    mt_w_perc_mesh_interp_coh_grid36    mt_w_perc_mesh_interp_coh_grid37    mt_w_perc_mesh_interp_coh_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.991                            -19.989                            -19.987                            -19.985                            -19.983                            -19.981                              -19.98                             -19.979                             -19.976                             -19.974                             -19.972                              -19.97                             -19.968                             -19.966                             -19.964                             -19.961                             -19.959                             -19.957                             -19.955                             -19.953                             -19.951                              -19.948                            -19.946                             -19.944                              -19.942                              -19.94                            -19.938                             -19.936                              -19.933                             -19.931                            -19.929                             -19.927                             -19.925                              -19.923            
                  -20                              -19.909                            -19.817                            -19.726                            -19.634                            -19.543                            -19.452                             -19.36                            -19.269                            -19.177                             -19.148                             -19.086                             -18.995                             -18.903                             -18.812                              -18.72                             -18.629                             -18.537                             -18.446                             -18.355                             -18.263                             -18.172                              -18.08                             -17.989                             -17.898                              -17.806                            -17.715                             -17.623                              -17.532                             -17.441                            -17.349                             -17.258                              -17.166                             -17.075                            -16.984                             -16.892                             -16.801                              -16.709            
                  -20                              -19.819                            -19.639                            -19.458                            -19.277                            -19.097                            -18.916                            -18.735                            -18.555                            -18.374                             -18.317                             -18.193                             -18.013                             -17.832                             -17.651                             -17.471                              -17.29                             -17.109                             -16.929                             -16.748                             -16.567                             -16.387                             -16.206                             -16.025                             -15.845                              -15.664                            -15.483                             -15.303                              -15.122                             -14.941                            -14.761                              -14.58                              -14.399                             -14.219                            -14.038                             -13.857                             -13.677                              -13.496            
                  -20                               -19.73                             -19.46                             -19.19                             -18.92                             -18.65                             -18.38                             -18.11                            -17.841                            -17.571                             -17.485                             -17.301                             -17.031                             -16.761                             -16.491                             -16.221                             -15.951                             -15.681                             -15.411                             -15.141                             -14.871                             -14.601                             -14.331                             -14.061                             -13.792                              -13.522                            -13.252                             -12.982                              -12.712                             -12.442                            -12.172                             -11.902                              -11.632                             -11.362                            -11.092                             -10.822                             -10.552                              -10.282            
                  -20                              -19.641                            -19.282                            -18.922                            -18.563                            -18.204                            -17.845                            -17.486                            -17.126                            -16.767                             -16.653                             -16.408                             -16.049                              -15.69                              -15.33                             -14.971                             -14.612                             -14.253                             -13.894                             -13.534                             -13.175                             -12.816                             -12.457                             -12.098                             -11.738                              -11.379                             -11.02                             -10.661                              -10.302                             -9.9425                            -9.5833                             -9.2241                              -8.8649                             -8.5057                            -8.1465                             -7.7873                             -7.4282                               -7.069            
                  -20                              -19.552                            -19.103                            -18.655                            -18.206                            -17.758                            -17.309                            -16.861                            -16.412                            -15.964                             -15.822                             -15.515                             -15.067                             -14.619                              -14.17                             -13.722                             -13.273                             -12.825                             -12.376                             -11.928                             -11.479                             -11.031                             -10.582                             -10.134                             -9.6855                               -9.237                            -8.7886                             -8.3401                              -7.8916                             -7.4432                            -6.9947                             -6.5463                              -6.0978                             -5.6493                            -5.2009                             -4.7524                              -4.304                              -3.8555            
                  -20                              -19.462                            -18.925                            -18.387                            -17.849                            -17.311                            -16.774                            -16.236                            -15.698                            -15.161                              -14.99                             -14.623                             -14.085                             -13.547                              -13.01                             -12.472                             -11.934                             -11.396                             -10.859                             -10.321                             -9.7833                             -9.2456                             -8.7079                             -8.1702                             -7.6324                              -7.0947                             -6.557                             -6.0193                              -5.4816                             -4.9438                            -4.4061                             -3.8684                              -3.3307                              -2.793                            -2.2552                             -1.7175                             -1.1798                             -0.64207            
                  -20                              -19.373                            -18.746                            -18.119                            -17.492                            -16.865                            -16.238                            -15.611                            -14.984                            -14.357                             -14.158                              -13.73                             -13.103                             -12.476                             -11.849                             -11.222                             -10.595                             -9.9683                             -9.3413                             -8.7143                             -8.0873                             -7.4604                             -6.8334                             -6.2064                             -5.5794                              -4.9524                            -4.3254                             -3.6985                              -3.0715                             -2.4445                            -1.8175                             -1.1905                             -0.56354                            0.063439                            0.69042                              1.3174                              1.9444                               2.5714            
                  -20                              -19.284                            -18.568                            -17.851                            -17.135                            -16.419                            -15.703                            -14.986                             -14.27                            -13.554                             -13.327                             -12.838                             -12.121                             -11.405                             -10.689                             -9.9726                             -9.2563                             -8.5401                             -7.8238                             -7.1076                             -6.3914                             -5.6751                             -4.9589                             -4.2426                             -3.5264                              -2.8101                            -2.0939                             -1.3776                             -0.66139                            0.054852                             0.7711                              1.4873                               2.2036                              2.9198                             3.6361                              4.3523                              5.0686                               5.7848            
                  -20                              -19.194                            -18.389                            -17.583                            -16.778                            -15.972                            -15.167                            -14.361                            -13.556                             -12.75                             -12.495                             -11.945                             -11.139                             -10.334                             -9.5284                             -8.7229                             -7.9174                             -7.1119                             -6.3064                             -5.5009                             -4.6954                             -3.8899                             -3.0844                             -2.2788                             -1.4733                             -0.66783                            0.13767                             0.94318                               1.7487                              2.5542                             3.3597                              4.1652                               4.9707                              5.7762                             6.5817                              7.3872                              8.1927                               8.9983            

    mt_w_perc_mesh_interp_coh_grid1    mt_w_perc_mesh_interp_coh_grid2    mt_w_perc_mesh_interp_coh_grid3    mt_w_perc_mesh_interp_coh_grid4    mt_w_perc_mesh_interp_coh_grid5    mt_w_perc_mesh_interp_coh_grid6    mt_w_perc_mesh_interp_coh_grid7    mt_w_perc_mesh_interp_coh_grid8    mt_w_perc_mesh_interp_coh_grid9    mt_w_perc_mesh_interp_coh_grid10    mt_w_perc_mesh_interp_coh_grid11    mt_w_perc_mesh_interp_coh_grid12    mt_w_perc_mesh_interp_coh_grid13    mt_w_perc_mesh_interp_coh_grid14    mt_w_perc_mesh_interp_coh_grid15    mt_w_perc_mesh_interp_coh_grid16    mt_w_perc_mesh_interp_coh_grid17    mt_w_perc_mesh_interp_coh_grid18    mt_w_perc_mesh_interp_coh_grid19    mt_w_perc_mesh_interp_coh_grid20    mt_w_perc_mesh_interp_coh_grid21    mt_w_perc_mesh_interp_coh_grid22    mt_w_perc_mesh_interp_coh_grid23    mt_w_perc_mesh_interp_coh_grid24    mt_w_perc_mesh_interp_coh_grid25    mt_w_perc_mesh_interp_coh_grid26    mt_w_perc_mesh_interp_coh_grid27    mt_w_perc_mesh_interp_coh_grid28    mt_w_perc_mesh_interp_coh_grid29    mt_w_perc_mesh_interp_coh_grid30    mt_w_perc_mesh_interp_coh_grid31    mt_w_perc_mesh_interp_coh_grid32    mt_w_perc_mesh_interp_coh_grid33    mt_w_perc_mesh_interp_coh_grid34    mt_w_perc_mesh_interp_coh_grid35    mt_w_perc_mesh_interp_coh_grid36    mt_w_perc_mesh_interp_coh_grid37    mt_w_perc_mesh_interp_coh_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -18.659                            -17.318                            -15.977                            -14.636                            -13.295                            -11.954                            -10.612                            -9.2714                             -7.9303                              -7.505                             -6.5892                             -5.2481                              -3.907                              -2.566                            -1.2249                             0.11621                              1.4573                              2.7984                              4.1395                              5.4805                              6.8216                              8.1627                              9.5038                              10.845                              12.186                              13.527                              14.868                              16.209                               17.55                              18.891                              20.232                              21.573                              22.915                              24.256                              25.597                              26.938                              28.279             
                  -20                               -18.57                            -17.139                            -15.709                            -14.279                            -12.848                            -11.418                            -9.9876                            -8.5573                             -7.1269                             -6.6733                             -5.6966                             -4.2662                             -2.8359                             -1.4055                             0.0248                              1.4551                              2.8855                              4.3158                              5.7462                              7.1765                              8.6069                              10.037                              11.468                              12.898                              14.328                              15.759                              17.189                              18.619                               20.05                               21.48                               22.91                              24.341                              25.771                              27.201                              28.632                              30.062                              31.492             
                  -20                               -18.48                            -16.961                            -15.441                            -13.922                            -12.402                            -10.882                            -9.3628                            -7.8432                             -6.3236                             -5.8417                             -4.8039                             -3.2843                             -1.7647                            -0.24513                             1.2745                              2.7941                              4.3137                              5.8333                              7.3529                              8.8725                              10.392                              11.912                              13.431                              14.951                              16.471                               17.99                               19.51                              21.029                              22.549                              24.069                              25.588                              27.108                              28.627                              30.147                              31.667                              33.186                              34.706             
                  -20                              -18.391                            -16.782                            -15.173                            -13.565                            -11.956                            -10.347                            -8.7379                            -7.1291                             -5.5202                               -5.01                             -3.9113                             -2.3025                            -0.69359                             0.91528                             2.5241                               4.133                              5.7419                              7.3507                              8.9596                              10.568                              12.177                              13.786                              15.395                              17.004                              18.613                              20.222                              21.831                              23.439                              25.048                              26.657                              28.266                              29.875                              31.484                              33.093                              34.701                               36.31                              37.919             
                  -20                              -18.302                            -16.604                            -14.906                            -13.207                            -11.509                            -9.8112                            -8.1131                             -6.415                             -4.7168                             -4.1783                             -3.0187                             -1.3206                             0.37756                              2.0757                             3.7738                              5.4719                              7.1701                              8.8682                              10.566                              12.264                              13.963                              15.661                              17.359                              19.057                              20.755                              22.453                              24.151                               25.85                              27.548                              29.246                              30.944                              32.642                               34.34                              36.038                              37.736                              39.435                              41.133             
                  -20                              -18.213                            -16.425                            -14.638                             -12.85                            -11.063                            -9.2756                            -7.4883                            -5.7009                             -3.9135                             -3.3467                             -2.1261                            -0.33869                              1.4487                              3.2361                             5.0235                              6.8109                              8.5983                              10.386                              12.173                               13.96                              15.748                              17.535                              19.323                               21.11                              22.897                              24.685                              26.472                               28.26                              30.047                              31.834                              33.622                              35.409                              37.197                              38.984                              40.771                              42.559                              44.346             
                  -20                              -18.123                            -16.247                             -14.37                            -12.493                            -10.617                            -8.7401                            -6.8634                            -4.9868                             -3.1101                              -2.515                             -1.2335                              0.6432                              2.5199                              4.3965                             6.2732                              8.1498                              10.026                              11.903                               13.78                              15.656                              17.533                               19.41                              21.286                              23.163                               25.04                              26.916                              28.793                               30.67                              32.546                              34.423                                36.3                              38.176                              40.053                               41.93                              43.806                              45.683                               47.56             
                  -20                              -18.034                            -16.068                            -14.102                            -12.136                             -10.17                            -8.2045                            -6.2386                            -4.2727                             -2.3068                             -1.6833                            -0.34084                              1.6251                               3.591                              5.5569                             7.5228                              9.4887                              11.455                              13.421                              15.386                              17.352                              19.318                              21.284                               23.25                              25.216                              27.182                              29.148                              31.114                               33.08                              35.046                              37.012                              38.977                              40.943                              42.909                              44.875                              46.841                              48.807                              50.773             
                  -20                              -17.945                             -15.89                            -13.834                            -11.779                            -9.7241                            -7.6689                            -5.6137                            -3.5586                             -1.5034                            -0.85167                             0.55179                               2.607                              4.6621                              6.7173                             8.7725                              10.828                              12.883                              14.938                              16.993                              19.048                              21.104                              23.159                              25.214                              27.269                              29.324                              31.379                              33.435                               35.49                              37.545                                39.6                              41.655                              43.711                              45.766                              47.821                              49.876                              51.931                              53.986             
                  -20                              -17.856                            -15.711                            -13.567                            -11.422                            -9.2778                            -7.1334                            -4.9889                            -2.8445                            -0.70003                               -0.02                              1.4444                              3.5889                              5.7333                              7.8777                             10.022                              12.167                              14.311                              16.455                                18.6                              20.744                              22.889                              25.033                              27.178                              29.322                              31.467                              33.611                              35.755                                37.9                              40.044                              42.189                              44.333                              46.478                              48.622                              50.767                              52.911                              55.055                                57.2             

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

     0.0011772      0.0012141      0.0011562     0.00067516     0.00024164      5.295e-05     7.0941e-06     5.8021e-07     2.8919e-08      8.7697e-10      1.6154e-11      1.8049e-13      1.2217e-15      5.0236e-18               0        0.023544        0.024282        0.023123        0.013503       0.0048328       0.001059       0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2308e-10      3.6099e-12      2.4435e-14      1.0047e-16               0         0.23544         0.24282         0.23123         0.13503       0.048328         0.01059       0.0014188       0.00011604      5.7838e-06      1.7539e-07      3.2308e-09      3.6099e-11      2.4435e-13      1.0047e-15               0 
    0.00050823     0.00088787      0.0012502      0.0010797     0.00057172     0.00018551     3.6846e-05     4.4731e-06     3.3139e-07      1.4957e-08      4.1057e-10       6.844e-12      6.9181e-14      4.2349e-16      1.5071e-18        0.010165        0.017757        0.025005        0.021593        0.011434      0.0037102       0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.2114e-09      1.3688e-10      1.3836e-12      8.4698e-15      3.0142e-17         0.10165         0.17757         0.25005         0.21593        0.11434        0.037102       0.0073691       0.00089462      6.6277e-05      2.9913e-06      8.2114e-08      1.3688e-09      1.3836e-11      8.4698e-14      3.0142e-16 
    0.00016775     0.00047473     0.00098871      0.0012625     0.00098871     0.00047473     0.00013965     2.5139e-05     2.7653e-06      1.8556e-07       7.583e-09      1.8842e-10      2.8421e-12       2.599e-14      1.4418e-16        0.003355       0.0094946        0.019774         0.02525        0.019774      0.0094946         0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5166e-07      3.7683e-09      5.6843e-11      5.1981e-13      2.8836e-15         0.03355        0.094946         0.19774          0.2525        0.19774        0.094946         0.02793        0.0050279      0.00055305      3.7111e-05      1.5166e-06      3.7683e-08      5.6843e-10      5.1981e-12      2.8836e-14 
    4.1666e-05     0.00018551     0.00057172      0.0010797      0.0012502     0.00088787     0.00038655     0.00010308     1.6818e-05       1.676e-06      1.0186e-07      3.7688e-09      8.4759e-11      1.1569e-12      9.6177e-15      0.00083331       0.0037102        0.011434        0.021593        0.025005       0.017757         0.007731       0.0020617      0.00033636       3.352e-05      2.0372e-06      7.5377e-08      1.6952e-09      2.3137e-11      1.9235e-13       0.0083331        0.037102         0.11434         0.21593        0.25005         0.17757         0.07731         0.020617       0.0033636       0.0003352      2.0372e-05      7.5377e-07      1.6952e-08      2.3137e-10      1.9235e-12 
    7.7042e-06      5.295e-05     0.00024164     0.00067516      0.0011562      0.0012141     0.00078186     0.00030864      7.461e-05      1.1031e-05      9.9593e-07      5.4816e-08      1.8362e-09      3.7375e-11      4.6502e-13      0.00015408        0.001059       0.0048328        0.013503        0.023123       0.024282         0.015637       0.0061727       0.0014922      0.00022062      1.9919e-05      1.0963e-06      3.6724e-08      7.4749e-10      9.3005e-12       0.0015408         0.01059        0.048328         0.13503        0.23123         0.24282         0.15637         0.061727        0.014922       0.0022062      0.00019919      1.0963e-05      3.6724e-07      7.4749e-09      9.3005e-11 
    1.0526e-06     1.1031e-05      7.461e-05     0.00030864     0.00078186      0.0012141      0.0011562     0.00067516     0.00024164       5.295e-05      7.0941e-06      5.8021e-07      2.8919e-08      8.7697e-10      1.6336e-11      2.1052e-05      0.00022062       0.0014922       0.0061727        0.015637       0.024282         0.023123        0.013503       0.0048328        0.001059      0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2672e-10      0.00021052       0.0022062        0.014922        0.061727        0.15637         0.24282         0.23123          0.13503        0.048328         0.01059       0.0014188      0.00011604      5.7838e-06      1.7539e-07      3.2672e-09 
    1.0571e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655     0.00088787      0.0012502      0.0010797     0.00057172      0.00018551      3.6846e-05      4.4731e-06      3.3139e-07      1.4957e-08      4.1748e-10      2.1143e-06       3.352e-05      0.00033636       0.0020617        0.007731       0.017757         0.025005        0.021593        0.011434       0.0037102      0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.3496e-09      2.1143e-05       0.0003352       0.0033636        0.020617        0.07731         0.17757         0.25005          0.21593         0.11434        0.037102       0.0073691      0.00089462      6.6277e-05      2.9913e-06      8.3496e-08 
    7.7743e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965     0.00047473     0.00098871      0.0012625     0.00098871      0.00047473      0.00013965      2.5139e-05      2.7653e-06      1.8556e-07      7.7743e-09      1.5549e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793      0.0094946         0.019774         0.02525        0.019774       0.0094946        0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5549e-07      1.5549e-06      3.7111e-05      0.00055305       0.0050279        0.02793        0.094946         0.19774           0.2525         0.19774        0.094946         0.02793       0.0050279      0.00055305      3.7111e-05      1.5549e-06 
    4.1748e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05     0.00018551     0.00057172      0.0010797      0.0012502      0.00088787      0.00038655      0.00010308      1.6818e-05       1.676e-06      1.0571e-07      8.3496e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691      0.0037102         0.011434        0.021593        0.025005        0.017757        0.007731       0.0020617      0.00033636       3.352e-05      2.1143e-06      8.3496e-08      2.9913e-06      6.6277e-05      0.00089462      0.0073691        0.037102         0.11434          0.21593         0.25005         0.17757         0.07731        0.020617       0.0033636       0.0003352      2.1143e-05 
    1.6336e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06      5.295e-05     0.00024164     0.00067516      0.0011562       0.0012141      0.00078186      0.00030864       7.461e-05      1.1031e-05      1.0526e-06      3.2672e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188       0.001059        0.0048328        0.013503        0.023123        0.024282        0.015637       0.0061727       0.0014922      0.00022062      2.1052e-05      3.2672e-09      1.7539e-07      5.7838e-06      0.00011604      0.0014188         0.01059        0.048328          0.13503         0.23123         0.24282         0.15637        0.061727        0.014922       0.0022062      0.00021052 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

    1.0526e-06     1.1031e-05      7.461e-05     0.00030864     0.00078186      0.0012141      0.0011562     0.00067516     0.00024164       5.295e-05      7.0941e-06      5.8021e-07      2.8919e-08      8.7697e-10      1.6336e-11      2.1052e-05      0.00022062       0.0014922       0.0061727        0.015637        0.024282        0.023123        0.013503       0.0048328       0.001059       0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2672e-10      0.00021052       0.0022062        0.014922        0.061727         0.15637         0.24282         0.23123         0.13503       0.048328         0.01059       0.0014188       0.00011604      5.7838e-06      1.7539e-07      3.2672e-09 
    1.0571e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655     0.00088787      0.0012502      0.0010797     0.00057172      0.00018551      3.6846e-05      4.4731e-06      3.3139e-07      1.4957e-08      4.1748e-10      2.1143e-06       3.352e-05      0.00033636       0.0020617        0.007731        0.017757        0.025005        0.021593        0.011434      0.0037102       0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.3496e-09      2.1143e-05       0.0003352       0.0033636        0.020617         0.07731         0.17757         0.25005         0.21593        0.11434        0.037102       0.0073691       0.00089462      6.6277e-05      2.9913e-06      8.3496e-08 
    7.7743e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965     0.00047473     0.00098871      0.0012625     0.00098871      0.00047473      0.00013965      2.5139e-05      2.7653e-06      1.8556e-07      7.7743e-09      1.5549e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793       0.0094946        0.019774         0.02525        0.019774      0.0094946         0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5549e-07      1.5549e-06      3.7111e-05      0.00055305       0.0050279         0.02793        0.094946         0.19774          0.2525        0.19774        0.094946         0.02793        0.0050279      0.00055305      3.7111e-05      1.5549e-06 
    4.1748e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05     0.00018551     0.00057172      0.0010797      0.0012502      0.00088787      0.00038655      0.00010308      1.6818e-05       1.676e-06      1.0571e-07      8.3496e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691       0.0037102        0.011434        0.021593        0.025005       0.017757         0.007731       0.0020617      0.00033636       3.352e-05      2.1143e-06      8.3496e-08      2.9913e-06      6.6277e-05      0.00089462       0.0073691        0.037102         0.11434         0.21593        0.25005         0.17757         0.07731         0.020617       0.0033636       0.0003352      2.1143e-05 
    1.6336e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06      5.295e-05     0.00024164     0.00067516      0.0011562       0.0012141      0.00078186      0.00030864       7.461e-05      1.1031e-05      1.0526e-06      3.2672e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188        0.001059       0.0048328        0.013503        0.023123       0.024282         0.015637       0.0061727       0.0014922      0.00022062      2.1052e-05      3.2672e-09      1.7539e-07      5.7838e-06      0.00011604       0.0014188         0.01059        0.048328         0.13503        0.23123         0.24282         0.15637         0.061727        0.014922       0.0022062      0.00021052 
    4.6502e-13     3.7375e-11     1.8362e-09     5.4816e-08     9.9593e-07     1.1031e-05      7.461e-05     0.00030864     0.00078186       0.0012141       0.0011562      0.00067516      0.00024164       5.295e-05      7.7042e-06      9.3005e-12      7.4749e-10      3.6724e-08      1.0963e-06      1.9919e-05      0.00022062       0.0014922       0.0061727        0.015637       0.024282         0.023123        0.013503       0.0048328        0.001059      0.00015408      9.3005e-11      7.4749e-09      3.6724e-07      1.0963e-05      0.00019919       0.0022062        0.014922        0.061727        0.15637         0.24282         0.23123          0.13503        0.048328         0.01059       0.0015408 
    9.6179e-15     1.1569e-12     8.4759e-11     3.7688e-09     1.0186e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655      0.00088787       0.0012502       0.0010797      0.00057172      0.00018551      4.1666e-05      1.9236e-13      2.3137e-11      1.6952e-09      7.5377e-08      2.0372e-06       3.352e-05      0.00033636       0.0020617        0.007731       0.017757         0.025005        0.021593        0.011434       0.0037102      0.00083331      1.9236e-12      2.3137e-10      1.6952e-08      7.5377e-07      2.0372e-05       0.0003352       0.0033636        0.020617        0.07731         0.17757         0.25005          0.21593         0.11434        0.037102       0.0083331 
    1.4438e-16      2.599e-14     2.8421e-12     1.8842e-10      7.583e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965      0.00047473      0.00098871       0.0012625      0.00098871      0.00047473      0.00016775      2.8877e-15       5.198e-13      5.6843e-11      3.7683e-09      1.5166e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793      0.0094946         0.019774         0.02525        0.019774       0.0094946        0.003355      2.8877e-14       5.198e-12      5.6843e-10      3.7683e-08      1.5166e-06      3.7111e-05      0.00055305       0.0050279        0.02793        0.094946         0.19774           0.2525         0.19774        0.094946         0.03355 
     1.572e-18     4.2351e-16     6.9181e-14      6.844e-12     4.1057e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05      0.00018551      0.00057172       0.0010797       0.0012502      0.00088787      0.00050823      3.1439e-17      8.4703e-15      1.3836e-12      1.3688e-10      8.2114e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691      0.0037102         0.011434        0.021593        0.025005        0.017757        0.010165      3.1439e-16      8.4703e-14      1.3836e-11      1.3688e-09      8.2114e-08      2.9913e-06      6.6277e-05      0.00089462      0.0073691        0.037102         0.11434          0.21593         0.25005         0.17757         0.10165 
    1.2404e-20      5.003e-18     1.2216e-15     1.8049e-13     1.6154e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06       5.295e-05      0.00024164      0.00067516       0.0011562       0.0012141       0.0011772      2.4807e-19      1.0006e-16      2.4433e-14      3.6099e-12      3.2308e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188       0.001059        0.0048328        0.013503        0.023123        0.024282        0.023544      2.4807e-18      1.0006e-15      2.4433e-13      3.6099e-11      3.2308e-09      1.7539e-07      5.7838e-06      0.00011604      0.0014188         0.01059        0.048328          0.13503         0.23123         0.24282         0.23544 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_coh_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 38&times;1 double

        Values:

            Min          -20
            Median    17.565
            Max       57.277

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_c_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 772571&times;1 double

        Values:

            Min         0.02
            Median    38.649
            Max       77.277

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_interp_coh_grid_mesh_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    38    45

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15    mt_interp_coh_grid_mesh_z16    mt_interp_coh_grid_mesh_z17    mt_interp_coh_grid_mesh_z18    mt_interp_coh_grid_mesh_z19    mt_interp_coh_grid_mesh_z20    mt_interp_coh_grid_mesh_z21    mt_interp_coh_grid_mesh_z22    mt_interp_coh_grid_mesh_z23    mt_interp_coh_grid_mesh_z24    mt_interp_coh_grid_mesh_z25    mt_interp_coh_grid_mesh_z26    mt_interp_coh_grid_mesh_z27    mt_interp_coh_grid_mesh_z28    mt_interp_coh_grid_mesh_z29    mt_interp_coh_grid_mesh_z30    mt_interp_coh_grid_mesh_z31    mt_interp_coh_grid_mesh_z32    mt_interp_coh_grid_mesh_z33    mt_interp_coh_grid_mesh_z34    mt_interp_coh_grid_mesh_z35    mt_interp_coh_grid_mesh_z36    mt_interp_coh_grid_mesh_z37    mt_interp_coh_grid_mesh_z38    mt_interp_coh_grid_mesh_z39    mt_interp_coh_grid_mesh_z40    mt_interp_coh_grid_mesh_z41    mt_interp_coh_grid_mesh_z42    mt_interp_coh_grid_mesh_z43    mt_interp_coh_grid_mesh_z44    mt_interp_coh_grid_mesh_z45
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

                  -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20          
              -17.853                       -17.853                       -17.853                       -17.853                       -17.853                       -17.853                       -17.853                       -17.853                       -17.853                       -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853                        -17.853          
              -15.707                       -15.707                       -15.707                       -15.707                       -15.707                       -15.707                       -15.707                       -15.707                       -15.707                       -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707                        -15.707          
               -13.56                        -13.56                        -13.56                        -13.56                        -13.56                        -13.56                        -13.56                        -13.56                        -13.56                        -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56                         -13.56          
              -11.414                       -11.414                       -11.414                       -11.414                       -11.414                       -11.414                       -11.414                       -11.414                       -11.414                       -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414                        -11.414          
              -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                       -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671                        -9.2671          
              -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                       -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205                        -7.1205          
              -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                       -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739                        -4.9739          
              -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                       -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273                        -2.8273          
             -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                      -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071                       -0.68071          

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15    mt_interp_coh_grid_mesh_z16    mt_interp_coh_grid_mesh_z17    mt_interp_coh_grid_mesh_z18    mt_interp_coh_grid_mesh_z19    mt_interp_coh_grid_mesh_z20    mt_interp_coh_grid_mesh_z21    mt_interp_coh_grid_mesh_z22    mt_interp_coh_grid_mesh_z23    mt_interp_coh_grid_mesh_z24    mt_interp_coh_grid_mesh_z25    mt_interp_coh_grid_mesh_z26    mt_interp_coh_grid_mesh_z27    mt_interp_coh_grid_mesh_z28    mt_interp_coh_grid_mesh_z29    mt_interp_coh_grid_mesh_z30    mt_interp_coh_grid_mesh_z31    mt_interp_coh_grid_mesh_z32    mt_interp_coh_grid_mesh_z33    mt_interp_coh_grid_mesh_z34    mt_interp_coh_grid_mesh_z35    mt_interp_coh_grid_mesh_z36    mt_interp_coh_grid_mesh_z37    mt_interp_coh_grid_mesh_z38    mt_interp_coh_grid_mesh_z39    mt_interp_coh_grid_mesh_z40    mt_interp_coh_grid_mesh_z41    mt_interp_coh_grid_mesh_z42    mt_interp_coh_grid_mesh_z43    mt_interp_coh_grid_mesh_z44    mt_interp_coh_grid_mesh_z45
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

              37.958                        37.958                        37.958                        37.958                        37.958                        37.958                        37.958                        37.958                        37.958                        37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958                         37.958           
              40.104                        40.104                        40.104                        40.104                        40.104                        40.104                        40.104                        40.104                        40.104                        40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104                         40.104           
              42.251                        42.251                        42.251                        42.251                        42.251                        42.251                        42.251                        42.251                        42.251                        42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251                         42.251           
              44.398                        44.398                        44.398                        44.398                        44.398                        44.398                        44.398                        44.398                        44.398                        44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398                         44.398           
              46.544                        46.544                        46.544                        46.544                        46.544                        46.544                        46.544                        46.544                        46.544                        46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544                         46.544           
              48.691                        48.691                        48.691                        48.691                        48.691                        48.691                        48.691                        48.691                        48.691                        48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691                         48.691           
              50.837                        50.837                        50.837                        50.837                        50.837                        50.837                        50.837                        50.837                        50.837                        50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837                         50.837           
              52.984                        52.984                        52.984                        52.984                        52.984                        52.984                        52.984                        52.984                        52.984                        52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984                         52.984           
              55.131                        55.131                        55.131                        55.131                        55.131                        55.131                        55.131                        55.131                        55.131                        55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131                         55.131           
              57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277                         57.277           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_a
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    55

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9      mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19      mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29      mt_a30      mt_a31      mt_a32      mt_a33     mt_a34     mt_a35    mt_a36    mt_a37    mt_a38    mt_a39    mt_a40    mt_a41    mt_a42    mt_a43    mt_a44    mt_a45    mt_a46    mt_a47    mt_a48    mt_a49    mt_a50    mt_a51    mt_a52    mt_a53    mt_a54    mt_a55
    _____    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ________    ________    ________    _______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

     -20     -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818       -0.02      1.1909        3.31     5.4291    7.5482    9.6673    11.786    13.905    16.025    18.144    20.263    22.382    24.501     26.62    28.739    30.858    32.977    35.096    37.215    39.335    41.454    43.573    45.692    47.811     49.93
     -20     -17.929    -15.858    -13.787    -11.716    -9.6451    -7.5741    -5.5032    -3.4322     -1.3612     -20      -17.929    -15.858    -13.787    -11.716    -9.6451    -7.5741    -5.5032    -3.4322     -1.3612     -20      -17.929    -15.858    -13.787    -11.716    -9.6451    -7.5741    -5.5032    -3.4322     -1.3612    -0.47364     0.70978      2.7808     4.8517    6.9227    8.9937    11.065    13.136    15.207    17.278    19.349     21.42    23.491    25.562    27.632    29.703    31.774    33.845    35.916    37.987    40.058    42.129      44.2    46.271    48.342
     -20     -17.977    -15.954    -13.931    -11.909    -9.8857    -7.8628    -5.8399    -3.8171     -1.7942     -20      -17.977    -15.954    -13.931    -11.909    -9.8857    -7.8628    -5.8399    -3.8171     -1.7942     -20      -17.977    -15.954    -13.931    -11.909    -9.8857    -7.8628    -5.8399    -3.8171     -1.7942    -0.92727     0.22865      2.2515     4.2744    6.2972    8.3201    10.343    12.366    14.389    16.412    18.434    20.457     22.48    24.503    26.526    28.549    30.572    32.594    34.617     36.64    38.663    40.686    42.709    44.732    46.755
     -20     -18.025     -16.05    -14.076    -12.101    -10.126    -8.1515    -6.1767     -4.202     -2.2272     -20      -18.025     -16.05    -14.076    -12.101    -10.126    -8.1515    -6.1767     -4.202     -2.2272     -20      -18.025     -16.05    -14.076    -12.101    -10.126    -8.1515    -6.1767     -4.202     -2.2272     -1.3809    -0.25248      1.7223      3.697    5.6718    7.6465    9.6213    11.596    13.571    15.546     17.52    19.495     21.47    23.445    25.419    27.394    29.369    31.344    33.318    35.293    37.268    39.243    41.217    43.192    45.167
     -20     -18.073    -16.147     -14.22    -12.293    -10.367    -8.4402    -6.5135    -4.5869     -2.6602     -20      -18.073    -16.147     -14.22    -12.293    -10.367    -8.4402    -6.5135    -4.5869     -2.6602     -20      -18.073    -16.147     -14.22    -12.293    -10.367    -8.4402    -6.5135    -4.5869     -2.6602     -1.8345    -0.73361       1.193     3.1197    5.0463    6.9729    8.8996    10.826    12.753     14.68    16.606    18.533    20.459    22.386    24.313    26.239    28.166    30.093    32.019    33.946    35.873    37.799    39.726    41.652    43.579
     -20     -18.121    -16.243    -14.364    -12.486    -10.607    -8.7288    -6.8503    -4.9718     -3.0933     -20      -18.121    -16.243    -14.364    -12.486    -10.607    -8.7288    -6.8503    -4.9718     -3.0933     -20      -18.121    -16.243    -14.364    -12.486    -10.607    -8.7288    -6.8503    -4.9718     -3.0933     -2.2882     -1.2147     0.66379     2.5423    4.4208    6.2994    8.1779    10.056    11.935    13.813    15.692    17.571    19.449    21.328    23.206    25.085    26.963    28.842     30.72    32.599    34.477    36.356    38.234    40.113    41.991
     -20      -18.17    -16.339    -14.509    -12.678    -10.848    -9.0175    -7.1871    -5.3567     -3.5263     -20       -18.17    -16.339    -14.509    -12.678    -10.848    -9.0175    -7.1871    -5.3567     -3.5263     -20       -18.17    -16.339    -14.509    -12.678    -10.848    -9.0175    -7.1871    -5.3567     -3.5263     -2.7418     -1.6959     0.13455      1.965    3.7954    5.6258    7.4562    9.2866    11.117    12.947    14.778    16.608    18.439    20.269      22.1     23.93     25.76    27.591    29.421    31.252    33.082    34.912    36.743    38.573    40.404
     -20     -18.218    -16.435    -14.653    -12.871    -11.088    -9.3062    -7.5239    -5.7416     -3.9593     -20      -18.218    -16.435    -14.653    -12.871    -11.088    -9.3062    -7.5239    -5.7416     -3.9593     -20      -18.218    -16.435    -14.653    -12.871    -11.088    -9.3062    -7.5239    -5.7416     -3.9593     -3.1955      -2.177     -0.3947     1.3876    3.1699    4.9522    6.7345    8.5168    10.299    12.081    13.864    15.646    17.428    19.211    20.993    22.775    24.558     26.34    28.122    29.904    31.687    33.469    35.251    37.034    38.816
     -20     -18.266    -16.532    -14.797    -13.063    -11.329    -9.5949    -7.8607    -6.1265     -4.3923     -20      -18.266    -16.532    -14.797    -13.063    -11.329    -9.5949    -7.8607    -6.1265     -4.3923     -20      -18.266    -16.532    -14.797    -13.063    -11.329    -9.5949    -7.8607    -6.1265     -4.3923     -3.6491     -2.6581    -0.92394    0.81025    2.5444    4.2786    6.0128     7.747    9.4812    11.215     12.95    14.684    16.418    18.152    19.886     21.62    23.355    25.089    26.823    28.557    30.291    32.026     33.76    35.494    37.228
     -20     -18.314    -16.628    -14.942    -13.256     -11.57    -9.8836    -8.1975    -6.5114     -4.8253     -20      -18.314    -16.628    -14.942    -13.256     -11.57    -9.8836    -8.1975    -6.5114     -4.8253     -20      -18.314    -16.628    -14.942    -13.256     -11.57    -9.8836    -8.1975    -6.5114     -4.8253     -4.1027     -3.1393     -1.4532    0.23289     1.919     3.605    5.2911    6.9772    8.6633    10.349    12.035    13.721    15.408    17.094     18.78    20.466    22.152    23.838    25.524     27.21    28.896    30.582    32.268    33.954     35.64

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9     mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19     mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29     mt_a30     mt_a31     mt_a32     mt_a33     mt_a34     mt_a35     mt_a36     mt_a37     mt_a38     mt_a39     mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49     mt_a50     mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______

     -20     -19.565     -19.13    -18.695    -18.259    -17.824    -17.389    -16.954    -16.519    -16.084     -20      -19.565     -19.13    -18.695    -18.259    -17.824    -17.389    -16.954    -16.519    -16.084     -20      -19.565     -19.13    -18.695    -18.259    -17.824    -17.389    -16.954    -16.519    -16.084    -15.897    -15.649    -15.213    -14.778    -14.343    -13.908    -13.473    -13.038    -12.603    -12.168    -11.732    -11.297    -10.862    -10.427    -9.9918    -9.5567    -9.1216    -8.6864    -8.2513    -7.8161     -7.381    -6.9459    -6.5107    -6.0756    -5.6405
     -20     -19.613    -19.226    -18.839    -18.452    -18.065    -17.678    -17.291    -16.904    -16.517     -20      -19.613    -19.226    -18.839    -18.452    -18.065    -17.678    -17.291    -16.904    -16.517     -20      -19.613    -19.226    -18.839    -18.452    -18.065    -17.678    -17.291    -16.904    -16.517    -16.351     -16.13    -15.743    -15.356    -14.969    -14.582    -14.195    -13.808    -13.421    -13.034    -12.647     -12.26    -11.872    -11.485    -11.098    -10.711    -10.324    -9.9374    -9.5503    -9.1633    -8.7763    -8.3893    -8.0022    -7.6152    -7.2282
     -20     -19.661    -19.322    -18.983    -18.644    -18.305    -17.967    -17.628    -17.289     -16.95     -20      -19.661    -19.322    -18.983    -18.644    -18.305    -17.967    -17.628    -17.289     -16.95     -20      -19.661    -19.322    -18.983    -18.644    -18.305    -17.967    -17.628    -17.289     -16.95    -16.805    -16.611    -16.272    -15.933    -15.594    -15.255    -14.916    -14.577    -14.238      -13.9    -13.561    -13.222    -12.883    -12.544    -12.205    -11.866    -11.527    -11.188    -10.849     -10.51    -10.172    -9.8326    -9.4937    -9.1548    -8.8159
     -20     -19.709    -19.418    -19.128    -18.837    -18.546    -18.255    -17.964    -17.674    -17.383     -20      -19.709    -19.418    -19.128    -18.837    -18.546    -18.255    -17.964    -17.674    -17.383     -20      -19.709    -19.418    -19.128    -18.837    -18.546    -18.255    -17.964    -17.674    -17.383    -17.258    -17.092    -16.801     -16.51     -16.22    -15.929    -15.638    -15.347    -15.056    -14.766    -14.475    -14.184    -13.893    -13.602    -13.312    -13.021     -12.73    -12.439    -12.148    -11.858    -11.567    -11.276    -10.985    -10.694    -10.404
     -20     -19.757    -19.515    -19.272    -19.029    -18.787    -18.544    -18.301    -18.059    -17.816     -20      -19.757    -19.515    -19.272    -19.029    -18.787    -18.544    -18.301    -18.059    -17.816     -20      -19.757    -19.515    -19.272    -19.029    -18.787    -18.544    -18.301    -18.059    -17.816    -17.712    -17.573     -17.33    -17.088    -16.845    -16.602     -16.36    -16.117    -15.874    -15.632    -15.389    -15.146    -14.904    -14.661    -14.418    -14.176    -13.933     -13.69    -13.447    -13.205    -12.962    -12.719    -12.477    -12.234    -11.991
     -20     -19.805    -19.611    -19.416    -19.222    -19.027    -18.833    -18.638    -18.443    -18.249     -20      -19.805    -19.611    -19.416    -19.222    -19.027    -18.833    -18.638    -18.443    -18.249     -20      -19.805    -19.611    -19.416    -19.222    -19.027    -18.833    -18.638    -18.443    -18.249    -18.165    -18.054     -17.86    -17.665    -17.471    -17.276    -17.081    -16.887    -16.692    -16.498    -16.303    -16.109    -15.914    -15.719    -15.525     -15.33    -15.136    -14.941    -14.747    -14.552    -14.357    -14.163    -13.968    -13.774    -13.579
     -20     -19.854    -19.707    -19.561    -19.414    -19.268    -19.121    -18.975    -18.828    -18.682     -20      -19.854    -19.707    -19.561    -19.414    -19.268    -19.121    -18.975    -18.828    -18.682     -20      -19.854    -19.707    -19.561    -19.414    -19.268    -19.121    -18.975    -18.828    -18.682    -18.619    -18.535    -18.389    -18.242    -18.096     -17.95    -17.803    -17.657     -17.51    -17.364    -17.217    -17.071    -16.924    -16.778    -16.631    -16.485    -16.338    -16.192    -16.046    -15.899    -15.753    -15.606     -15.46    -15.313    -15.167
     -20     -19.902    -19.803    -19.705    -19.607    -19.508     -19.41    -19.312    -19.213    -19.115     -20      -19.902    -19.803    -19.705    -19.607    -19.508     -19.41    -19.312    -19.213    -19.115     -20      -19.902    -19.803    -19.705    -19.607    -19.508     -19.41    -19.312    -19.213    -19.115    -19.073    -19.017    -18.918     -18.82    -18.721    -18.623    -18.525    -18.426    -18.328     -18.23    -18.131    -18.033    -17.935    -17.836    -17.738     -17.64    -17.541    -17.443    -17.345    -17.246    -17.148     -17.05    -16.951    -16.853    -16.755
     -20      -19.95      -19.9    -19.849    -19.799    -19.749    -19.699    -19.648    -19.598    -19.548     -20       -19.95      -19.9    -19.849    -19.799    -19.749    -19.699    -19.648    -19.598    -19.548     -20       -19.95      -19.9    -19.849    -19.799    -19.749    -19.699    -19.648    -19.598    -19.548    -19.526    -19.498    -19.447    -19.397    -19.347    -19.297    -19.246    -19.196    -19.146    -19.096    -19.046    -18.995    -18.945    -18.895    -18.845    -18.794    -18.744    -18.694    -18.644    -18.593    -18.543    -18.493    -18.443    -18.393    -18.342
     -20     -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983    -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983    -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983    -19.981     -19.98    -19.979    -19.977    -19.975    -19.972     -19.97    -19.968    -19.966    -19.964    -19.962     -19.96    -19.958    -19.955    -19.953    -19.951    -19.949    -19.947    -19.945    -19.943    -19.941    -19.938    -19.936    -19.934    -19.932     -19.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_a_meshk
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_a_meshk: 2475&times;1 double

        Values:

            Min             -20   
            Median      -12.532   
            Max           49.93   

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_k
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    55

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9      mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18     mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28     mt_k29      mt_k30     mt_k31      mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37      mt_k38      mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46     mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    _______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091       0.02    0.021212    0.023333    0.025455    0.027576    0.029697    0.031818    0.033939    0.036061    0.038182    0.040303    0.042424    0.044545    0.046667    0.048788    0.050909    0.05303    0.055152    0.057273    0.059394    0.061515    0.063636    0.065758    0.067879      0.07
      0       0.050234      0.10047       0.1507      0.20094     0.25117      0.3014     0.35164    0.40187     0.45211      0        0.050234      0.10047       0.1507      0.20094     0.25117      0.3014     0.35164    0.40187     0.45211      0        0.050234      0.10047       0.1507      0.20094     0.25117      0.3014     0.35164    0.40187     0.45211    0.47364     0.50234     0.55258     0.60281     0.65304     0.70328     0.75351     0.80375     0.85398     0.90421     0.95445      1.0047      1.0549      1.1052      1.1554      1.2056     1.2559      1.3061      1.3563      1.4066      1.4568       1.507      1.5573      1.6075    1.6577
      0       0.098347      0.19669      0.29504      0.39339     0.49174     0.59008     0.68843    0.78678     0.88512      0        0.098347      0.19669      0.29504      0.39339     0.49174     0.59008     0.68843    0.78678     0.88512      0        0.098347      0.19669      0.29504      0.39339     0.49174     0.59008     0.68843    0.78678     0.88512    0.92727     0.98347      1.0818      1.1802      1.2785      1.3769      1.4752      1.5736      1.6719      1.7702      1.8686      1.9669      2.0653      2.1636       2.262      2.3603     2.4587       2.557      2.6554      2.7537      2.8521      2.9504      3.0488      3.1471    3.2455
      0        0.14646      0.29292      0.43938      0.58584      0.7323     0.87876      1.0252     1.1717      1.3181      0         0.14646      0.29292      0.43938      0.58584      0.7323     0.87876      1.0252     1.1717      1.3181      0         0.14646      0.29292      0.43938      0.58584      0.7323     0.87876      1.0252     1.1717      1.3181     1.3809      1.4646      1.6111      1.7575       1.904      2.0504      2.1969      2.3434      2.4898      2.6363      2.7827      2.9292      3.0757      3.2221      3.3686       3.515     3.6615       3.808      3.9544      4.1009      4.2473      4.3938      4.5403      4.6867    4.8332
      0        0.19457      0.38915      0.58372      0.77829     0.97287      1.1674       1.362     1.5566      1.7512      0         0.19457      0.38915      0.58372      0.77829     0.97287      1.1674       1.362     1.5566      1.7512      0         0.19457      0.38915      0.58372      0.77829     0.97287      1.1674       1.362     1.5566      1.7512     1.8345      1.9457      2.1403      2.3349      2.5294       2.724      2.9186      3.1132      3.3077      3.5023      3.6969      3.8915       4.086      4.2806      4.4752      4.6698     4.8643      5.0589      5.2535       5.448      5.6426      5.8372      6.0318      6.2263    6.4209
      0        0.24269      0.48537      0.72806      0.97074      1.2134      1.4561      1.6988     1.9415      2.1842      0         0.24269      0.48537      0.72806      0.97074      1.2134      1.4561      1.6988     1.9415      2.1842      0         0.24269      0.48537      0.72806      0.97074      1.2134      1.4561      1.6988     1.9415      2.1842     2.2882      2.4269      2.6695      2.9122      3.1549      3.3976      3.6403       3.883      4.1257      4.3683       4.611      4.8537      5.0964      5.3391      5.5818      5.8245     6.0671      6.3098      6.5525      6.7952      7.0379      7.2806      7.5233       7.766    8.0086
      0         0.2908       0.5816       0.8724       1.1632       1.454      1.7448      2.0356     2.3264      2.6172      0          0.2908       0.5816       0.8724       1.1632       1.454      1.7448      2.0356     2.3264      2.6172      0          0.2908       0.5816       0.8724       1.1632       1.454      1.7448      2.0356     2.3264      2.6172     2.7418       2.908      3.1988      3.4896      3.7804      4.0712       4.362      4.6528      4.9436      5.2344      5.5252       5.816      6.1068      6.3976      6.6884      6.9792       7.27      7.5608      7.8516      8.1424      8.4332       8.724      9.0148      9.3056    9.5964
      0        0.33891      0.67782       1.0167       1.3556      1.6946      2.0335      2.3724     2.7113      3.0502      0         0.33891      0.67782       1.0167       1.3556      1.6946      2.0335      2.3724     2.7113      3.0502      0         0.33891      0.67782       1.0167       1.3556      1.6946      2.0335      2.3724     2.7113      3.0502     3.1955      3.3891       3.728      4.0669      4.4059      4.7448      5.0837      5.4226      5.7615      6.1004      6.4393      6.7782      7.1171      7.4561       7.795      8.1339     8.4728      8.8117      9.1506      9.4895      9.8284      10.167      10.506      10.845    11.184
      0        0.38702      0.77405       1.1611       1.5481      1.9351      2.3221      2.7092     3.0962      3.4832      0         0.38702      0.77405       1.1611       1.5481      1.9351      2.3221      2.7092     3.0962      3.4832      0         0.38702      0.77405       1.1611       1.5481      1.9351      2.3221      2.7092     3.0962      3.4832     3.6491      3.8702      4.2573      4.6443      5.0313      5.4183      5.8054      6.1924      6.5794      6.9664      7.3535      7.7405      8.1275      8.5145      8.9016      9.2886     9.6756      10.063       10.45      10.837      11.224      11.611      11.998      12.385    12.772
      0        0.43514      0.87028       1.3054       1.7406      2.1757      2.6108       3.046     3.4811      3.9162      0         0.43514      0.87028       1.3054       1.7406      2.1757      2.6108       3.046     3.4811      3.9162      0         0.43514      0.87028       1.3054       1.7406      2.1757      2.6108       3.046     3.4811      3.9162     4.1027      4.3514      4.7865      5.2217      5.6568      6.0919      6.5271      6.9622      7.3973      7.8325      8.2676      8.7028      9.1379       9.573      10.008      10.443     10.878      11.314      11.749      12.184      12.619      13.054      13.489      13.924     14.36

    mt_k1    mt_k2     mt_k3     mt_k4     mt_k5     mt_k6     mt_k7     mt_k8     mt_k9     mt_k10    mt_k11    mt_k12    mt_k13    mt_k14    mt_k15    mt_k16    mt_k17    mt_k18    mt_k19    mt_k20    mt_k21    mt_k22    mt_k23    mt_k24    mt_k25    mt_k26    mt_k27    mt_k28    mt_k29    mt_k30    mt_k31    mt_k32    mt_k33    mt_k34    mt_k35    mt_k36    mt_k37    mt_k38    mt_k39    mt_k40    mt_k41    mt_k42    mt_k43    mt_k44    mt_k45    mt_k46    mt_k47    mt_k48    mt_k49    mt_k50    mt_k51    mt_k52    mt_k53    mt_k54    mt_k55
    _____    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

      0      1.6861    3.3721    5.0582    6.7443    8.4304    10.116    11.803    13.489    15.175      0       1.6861    3.3721    5.0582    6.7443    8.4304    10.116    11.803    13.489    15.175      0       1.6861    3.3721    5.0582    6.7443    8.4304    10.116    11.803    13.489    15.175    15.897    16.861    18.547    20.233    21.919    23.605    25.291    26.977    28.663    30.349    32.035    33.721    35.408    37.094     38.78    40.466    42.152    43.838    45.524     47.21    48.896    50.582    52.268    53.954     55.64
      0      1.7342    3.4684    5.2026    6.9367    8.6709    10.405    12.139    13.873    15.608      0       1.7342    3.4684    5.2026    6.9367    8.6709    10.405    12.139    13.873    15.608      0       1.7342    3.4684    5.2026    6.9367    8.6709    10.405    12.139    13.873    15.608    16.351    17.342    19.076     20.81    22.544    24.279    26.013    27.747    29.481    31.215     32.95    34.684    36.418    38.152    39.886     41.62    43.355    45.089    46.823    48.557    50.291    52.026     53.76    55.494    57.228
      0      1.7823    3.5646    5.3469    7.1292    8.9115    10.694    12.476    14.258    16.041      0       1.7823    3.5646    5.3469    7.1292    8.9115    10.694    12.476    14.258    16.041      0       1.7823    3.5646    5.3469    7.1292    8.9115    10.694    12.476    14.258    16.041    16.805    17.823    19.605    21.388     23.17    24.952    26.735    28.517    30.299    32.081    33.864    35.646    37.428    39.211    40.993    42.775    44.558     46.34    48.122    49.904    51.687    53.469    55.251    57.034    58.816
      0      1.8304    3.6608    5.4912    7.3217    9.1521    10.982    12.813    14.643    16.474      0       1.8304    3.6608    5.4912    7.3217    9.1521    10.982    12.813    14.643    16.474      0       1.8304    3.6608    5.4912    7.3217    9.1521    10.982    12.813    14.643    16.474    17.258    18.304    20.135    21.965    23.795    25.626    27.456    29.287    31.117    32.947    34.778    36.608    38.439    40.269      42.1     43.93     45.76    47.591    49.421    51.252    53.082    54.912    56.743    58.573    60.404
      0      1.8785    3.7571    5.6356    7.5141    9.3926    11.271     13.15    15.028    16.907      0       1.8785    3.7571    5.6356    7.5141    9.3926    11.271     13.15    15.028    16.907      0       1.8785    3.7571    5.6356    7.5141    9.3926    11.271     13.15    15.028    16.907    17.712    18.785    20.664    22.542    24.421    26.299    28.178    30.056    31.935    33.813    35.692    37.571    39.449    41.328    43.206    45.085    46.963    48.842     50.72    52.599    54.477    56.356    58.234    60.113    61.991
      0      1.9266    3.8533    5.7799    7.7066    9.6332     11.56    13.486    15.413     17.34      0       1.9266    3.8533    5.7799    7.7066    9.6332     11.56    13.486    15.413     17.34      0       1.9266    3.8533    5.7799    7.7066    9.6332     11.56    13.486    15.413     17.34    18.165    19.266    21.193     23.12    25.046    26.973      28.9    30.826    32.753     34.68    36.606    38.533    40.459    42.386    44.313    46.239    48.166    50.093    52.019    53.946    55.873    57.799    59.726    61.652    63.579
      0      1.9748    3.9495    5.9243     7.899    9.8738    11.849    13.823    15.798    17.773      0       1.9748    3.9495    5.9243     7.899    9.8738    11.849    13.823    15.798    17.773      0       1.9748    3.9495    5.9243     7.899    9.8738    11.849    13.823    15.798    17.773    18.619    19.748    21.722    23.697    25.672    27.647    29.621    31.596    33.571    35.546     37.52    39.495     41.47    43.445    45.419    47.394    49.369    51.344    53.318    55.293    57.268    59.243    61.217    63.192    65.167
      0      2.0229    4.0457    6.0686    8.0915    10.114    12.137     14.16    16.183    18.206      0       2.0229    4.0457    6.0686    8.0915    10.114    12.137     14.16    16.183    18.206      0       2.0229    4.0457    6.0686    8.0915    10.114    12.137     14.16    16.183    18.206    19.073    20.229    22.252    24.274    26.297     28.32    30.343    32.366    34.389    36.412    38.434    40.457     42.48    44.503    46.526    48.549    50.572    52.594    54.617     56.64    58.663    60.686    62.709    64.732    66.755
      0       2.071     4.142    6.2129    8.2839    10.355    12.426    14.497    16.568    18.639      0        2.071     4.142    6.2129    8.2839    10.355    12.426    14.497    16.568    18.639      0        2.071     4.142    6.2129    8.2839    10.355    12.426    14.497    16.568    18.639    19.526     20.71    22.781    24.852    26.923    28.994    31.065    33.136    35.207    37.278    39.349     41.42    43.491    45.562    47.632    49.703    51.774    53.845    55.916    57.987    60.058    62.129      64.2    66.271    68.342
      0      2.1191    4.2382    6.3573    8.4764    10.595    12.715    14.834    16.953    19.072      0       2.1191    4.2382    6.3573    8.4764    10.595    12.715    14.834    16.953    19.072      0       2.1191    4.2382    6.3573    8.4764    10.595    12.715    14.834    16.953    19.072     19.98    21.191     23.31    25.429    27.548    29.667    31.786    33.905    36.025    38.144    40.263    42.382    44.501     46.62    48.739    50.858    52.977    55.096    57.215    59.335    61.454    63.573    65.692    67.811     69.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_k_mesha
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_k_mesha: 2475&times;1 double

        Values:

            Min               0   
            Median       7.4681   
            Max           69.93   

pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_coh_fbis ; val = @(fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(ar_for_borr.*(1+fl_r_fbr)+ar_inf_borr.*(1+fl_r_inf)+ar_for_save.*(1+fl_r_fsv))
pos = 3 ; key = f_coh_save ; val = @(b)(b.*(1+fl_r_fsv))
pos = 4 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 5 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 6 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 7 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 8 ; key = f_util_log ; val = @(c)log(c)
pos = 9 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
pos = 10 ; key = f_util_standin_coh ; val = @(coh,fl_r_borr)f_util_log((coh-fl_b_bd).*((coh&gt;0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+((coh-fl_b_bd)./(1)).*((coh&lt;=0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+(fl_c_min./(1+fl_r_borr)).*((((coh-fl_b_bd)./(1))&lt;=fl_c_min)))
</pre><h2 id="49">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 37
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a_meshk ;rown= 2475 ,coln= 1
ar_a_meshk :mu= -7.2645 ,sd= 14.1856 ,min= -20 ,max= 49.93
                     zi_1_c1
                     _______

    zi_1_R1              -20
    zi_2_R2              -20
    zi_1238_r1238    -12.576
    zi_2474_r2474    -18.342
    zi_2475_r2475     -19.93

pos = 2 ; key = ar_ak_perc ;rown= 1 ,coln= 45
ar_ak_perc :mu= 0.5 ,sd= 0.2979 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_23_c23    zi_44_c44    zi_45_c45
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.023682       0.5        0.97632       0.999  

pos = 3 ; key = ar_ameshk_tnext_with_r ;rown= 2475 ,coln= 3
ar_ameshk_tnext_with_r :mu= -9.0195 ,sd= 15.8842 ,min= -39 ,max= 51.1782
                     zi_1_c1    zi_2_c2    zi_3_c3
                     _______    _______    _______

    zi_1_R1            -20.5     -29.75        -39
    zi_2_R2            -20.5     -29.75        -39
    zi_1238_r1238     -12.89     -13.47     -13.47
    zi_2474_r2474    -18.801    -19.561    -19.561
    zi_2475_r2475    -20.428    -21.618    -22.049

pos = 4 ; key = ar_aplusk_mesh ;rown= 2475 ,coln= 1
ar_aplusk_mesh :mu= 5.4711 ,sd= 20.7436 ,min= -20 ,max= 50
                     zi_1_c1
                     _______

    zi_1_R1              -20
    zi_2_R2              -20
    zi_1238_r1238    -5.1515
    zi_2474_r2474         50
    zi_2475_r2475         50

pos = 5 ; key = ar_coh_bridge_perc ;rown= 1 ,coln= 3
ar_coh_bridge_perc :mu= 0.5 ,sd= 0.5 ,min= 0 ,max= 1
               zi_1_c1    zi_2_c2    zi_3_c3
               _______    _______    _______

    zi_1_r1       0         0.5         1   

pos = 6 ; key = ar_forbrblk ;rown= 1 ,coln= 9
ar_forbrblk :mu= -7.0556 ,sd= 6.3809 ,min= -19 ,max= 0
               zi_1_c1    zi_2_c2    zi_5_c5    zi_8_c8    zi_9_c9
               _______    _______    _______    _______    _______

    zi_1_r1      -19       -14.5      -5.5        -1          0   

pos = 7 ; key = ar_forbrblk_r ;rown= 1 ,coln= 9
ar_forbrblk_r :mu= 0.065 ,sd= 0 ,min= 0.065 ,max= 0.065
               zi_1_c1    zi_2_c2    zi_5_c5    zi_8_c8    zi_9_c9
               _______    _______    _______    _______    _______

    zi_1_r1     0.065      0.065      0.065      0.065      0.065 

pos = 8 ; key = ar_interp_c_grid ;rown= 1 ,coln= 772571
ar_interp_c_grid :mu= 38.6486 ,sd= 22.3023 ,min= 0.02 ,max= 77.2772
               zi_1_C1    zi_2_C2    zi_386286_c386286    zi_772570_c772570    zi_772571_c772571
               _______    _______    _________________    _________________    _________________

    zi_1_r1     0.02      0.0201          38.649               77.277               77.277      

pos = 9 ; key = ar_interp_coh_grid ;rown= 1 ,coln= 38
ar_interp_coh_grid :mu= 18.1481 ,sd= 23.1179 ,min= -20 ,max= 57.2772
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.853     16.492       55.131       57.277  

pos = 10 ; key = ar_k_mesha ;rown= 2475 ,coln= 1
ar_k_mesha :mu= 12.7355 ,sd= 14.1856 ,min= 0 ,max= 69.93
                     zi_1_c1
                     _______

    zi_1_R1               0 
    zi_2_R2               0 
    zi_1238_r1238    7.4242 
    zi_2474_r2474    68.342 
    zi_2475_r2475     69.93 

pos = 11 ; key = ar_w_level ;rown= 1 ,coln= 35
ar_w_level :mu= 14.5714 ,sd= 20.9645 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_18_c18    zi_34_c34    zi_35_c35
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.879     13.939       47.879         50    

pos = 12 ; key = ar_w_level_full ;rown= 1 ,coln= 55
ar_w_level_full :mu= 5.4711 ,sd= 20.9306 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_28_c28    zi_54_c54    zi_55_c55
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.879     -5.1515      47.879         50    

pos = 13 ; key = ar_w_perc ;rown= 1 ,coln= 25
ar_w_perc :mu= 0.5 ,sd= 0.30605 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_13_c13    zi_24_c24    zi_25_c25
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.042583       0.5        0.95742       0.999  

pos = 14 ; key = ar_z_r_infbr ;rown= 1 ,coln= 3
ar_z_r_infbr :mu= 0.4875 ,sd= 0.4625 ,min= 0.025 ,max= 0.95
               zi_1_c1    zi_2_c2    zi_3_c3
               _______    _______    _______

    zi_1_r1     0.025     0.4875      0.95  

pos = 15 ; key = ar_z_r_infbr_mesh_wage_r1w2 ;rown= 1 ,coln= 45
ar_z_r_infbr_mesh_wage_r1w2 :mu= 0.4875 ,sd= 0.3819 ,min= 0.025 ,max= 0.95
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1     0.025     0.4875      0.4875       0.4875        0.95   

pos = 16 ; key = ar_z_r_infbr_mesh_wage_w1r2 ;rown= 1 ,coln= 45
ar_z_r_infbr_mesh_wage_w1r2 :mu= 0.4875 ,sd= 0.3819 ,min= 0.025 ,max= 0.95
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1     0.025      0.025      0.4875        0.95         0.95   

pos = 17 ; key = ar_z_r_infbr_prob ;rown= 1 ,coln= 3
ar_z_r_infbr_prob :mu= 0.33333 ,sd= 0.49692 ,min= 0.0045249 ,max= 0.90498
                zi_1_c1     zi_2_c2     zi_3_c3
               _________    ________    _______

    zi_1_r1    0.0045249    0.090498    0.90498

pos = 18 ; key = ar_z_wage ;rown= 1 ,coln= 15
ar_z_wage :mu= 1.1347 ,sd= 0.69878 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
               _______    _______    _______    _________    _________

    zi_1_r1    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 19 ; key = ar_z_wage_mesh_r_infbr_r1w2 ;rown= 1 ,coln= 45
ar_z_wage_mesh_r_infbr_r1w2 :mu= 1.1347 ,sd= 0.68271 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.34741     0.94436       2.567        2.567  

pos = 20 ; key = ar_z_wage_mesh_r_infbr_w1r2 ;rown= 1 ,coln= 45
ar_z_wage_mesh_r_infbr_w1r2 :mu= 1.1347 ,sd= 0.68271 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.40076     0.94436      2.2253        2.567  

pos = 21 ; key = ar_z_wage_prob ;rown= 1 ,coln= 15
ar_z_wage_prob :mu= 0.066667 ,sd= 0.060897 ,min= 0.0027089 ,max= 0.16757
                zi_1_C1      zi_2_C2     zi_8_C8    zi_14_c14    zi_15_c15
               _________    _________    _______    _________    _________

    zi_1_r1    0.0027089    0.0069499    0.16757    0.0069499    0.0027089

pos = 22 ; key = it_ameshk_n ; val = 2475
pos = 23 ; key = mt_bl_w_perc_mesh_interp_coh_grid_wneg ;rown= 25 ,coln= 38
mt_bl_w_perc_mesh_interp_coh_grid_wneg :mu= 0.61895 ,sd= 0.4859 ,min= 0 ,max= 1
                 zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
                 _______    _______    _________    _________    _________

    zi_1_R1       true       true        true         true         true   
    zi_2_R2       true       true        true         true         true   
    zi_13_r13     true       true        true         false        false  
    zi_24_r24     true       true        false        false        false  
    zi_25_r25     true       true        false        false        false  

pos = 24 ; key = mt_coh_bridge_perc_mesh_w_level_neg ;rown= 10 ,coln= 3
mt_coh_bridge_perc_mesh_w_level_neg :mu= 0.5 ,sd= 0.41523 ,min= 0 ,max= 1
                 zi_1_c1    zi_2_c2    zi_3_c3
                 _______    _______    _______

    zi_1_R1         0         0.5         1   
    zi_2_R2         0         0.5         1   
    zi_5_R5         0         0.5         1   
    zi_9_R9         0         0.5         1   
    zi_10_r10       0         0.5         1   

pos = 25 ; key = mt_coh_w_perc_ratio_wneg ;rown= 588 ,coln= 1
mt_coh_w_perc_ratio_wneg :mu= 0.72051 ,sd= 0.38072 ,min= 0 ,max= 1
                   zi_1_c1
                   _______

    zi_1_R1           0   
    zi_2_R2           0   
    zi_294_r294       1   
    zi_587_r587       1   
    zi_588_r588       1   

pos = 26 ; key = mt_coh_wkb ;rown= 7425 ,coln= 15
mt_coh_wkb :mu= 5.5134 ,sd= 22.6417 ,min= -38.5564 ,max= 57.2772
                     zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                     _______    _______    _______    _________    _________

    zi_1_R1          -20.056    -20.056    -20.056     -20.056      -20.056 
    zi_2_R2          -20.056    -20.056    -20.056     -20.056      -20.056 
    zi_3713_r3713    -5.4812    -5.3715    -4.2528     -1.6166     -0.91339 
    zi_7424_r7424     45.347     45.592     48.079      53.941       55.504 
    zi_7425_r7425     44.334      44.58     47.088      52.998       54.575 

pos = 27 ; key = mt_interp_coh_grid_mesh_w_perc ;rown= 25 ,coln= 38
mt_interp_coh_grid_mesh_w_perc :mu= 18.1481 ,sd= 22.8237 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
                 _______    _______    _________    _________    _________

    zi_1_R1        -20      -17.853     16.492       55.131       57.277  
    zi_2_R2        -20      -17.853     16.492       55.131       57.277  
    zi_13_r13      -20      -17.853     16.492       55.131       57.277  
    zi_24_r24      -20      -17.853     16.492       55.131       57.277  
    zi_25_r25      -20      -17.853     16.492       55.131       57.277  

pos = 28 ; key = mt_interp_coh_grid_mesh_z ;rown= 38 ,coln= 45
mt_interp_coh_grid_mesh_z :mu= 18.1481 ,sd= 22.8183 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                 _______    _______    _________    _________    _________

    zi_1_R1          -20        -20         -20          -20          -20 
    zi_2_R2      -17.853    -17.853     -17.853      -17.853      -17.853 
    zi_19_r19     16.492     16.492      16.492       16.492       16.492 
    zi_37_r37     55.131     55.131      55.131       55.131       55.131 
    zi_38_r38     57.277     57.277      57.277       57.277       57.277 

pos = 29 ; key = mt_interp_coh_grid_mesh_z_wage ;rown= 38 ,coln= 15
mt_interp_coh_grid_mesh_z_wage :mu= 18.1481 ,sd= 22.8317 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1          -20        -20        -20         -20          -20 
    zi_2_R2      -17.853    -17.853    -17.853     -17.853      -17.853 
    zi_19_r19     16.492     16.492     16.492      16.492       16.492 
    zi_37_r37     55.131     55.131     55.131      55.131       55.131 
    zi_38_r38     57.277     57.277     57.277      57.277       57.277 

pos = 30 ; key = mt_k ;rown= 45 ,coln= 55
mt_k :mu= 12.7355 ,sd= 14.1856 ,min= 0 ,max= 69.93
                 zi_1_C1     zi_2_C2     zi_28_c28    zi_54_c54    zi_55_c55
                 _______    _________    _________    _________    _________

    zi_1_R1         0       0.0021212    0.014848     0.067879        0.07  
    zi_2_R2         0        0.050234     0.35164       1.6075      1.6577  
    zi_23_r23       0          1.0606      7.4242       33.939          35  
    zi_44_r44       0           2.071      14.497       66.271      68.342  
    zi_45_r45       0          2.1191      14.834       67.811       69.93  

pos = 31 ; key = mt_w_level_neg_mesh_coh_bridge_perc ;rown= 10 ,coln= 3
mt_w_level_neg_mesh_coh_bridge_perc :mu= -10.4545 ,sd= 6.1969 ,min= -20 ,max= -0.90909
                 zi_1_c1     zi_2_c2     zi_3_c3 
                 ________    ________    ________

    zi_1_R1           -20         -20         -20
    zi_2_R2       -17.879     -17.879     -17.879
    zi_5_R5       -11.515     -11.515     -11.515
    zi_9_R9       -3.0303     -3.0303     -3.0303
    zi_10_r10    -0.90909    -0.90909    -0.90909

pos = 32 ; key = mt_w_perc_mesh_interp_coh_grid ;rown= 25 ,coln= 38
mt_w_perc_mesh_interp_coh_grid :mu= -0.92596 ,sd= 17.5517 ,min= -20 ,max= 57.1999
                 zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
                 _______    _______    _________    _________    _________

    zi_1_R1        -20      -19.998     -19.964      -19.925      -19.923 
    zi_2_R2        -20      -19.909     -18.446      -16.801      -16.709 
    zi_13_r13      -20      -18.927      -1.754       17.565       18.639 
    zi_24_r24      -20      -17.945      14.938       51.931       53.986 
    zi_25_r25      -20      -17.856      16.455       55.055         57.2 

pos = 33 ; key = mt_w_perc_mesh_interp_coh_grid_wneg ;rown= 588 ,coln= 1
mt_w_perc_mesh_interp_coh_grid_wneg :mu= -12.4463 ,sd= 5.9341 ,min= -20 ,max= -0.02
                   zi_1_c1 
                   ________

    zi_1_R1             -20
    zi_2_R2             -20
    zi_294_r294     -3.9113
    zi_587_r587     -3.8555
    zi_588_r588    -0.64207

pos = 34 ; key = mt_w_perc_mesh_interp_coh_grid_wpos ;rown= 362 ,coln= 1
mt_w_perc_mesh_interp_coh_grid_wpos :mu= 17.7867 ,sd= 13.6114 ,min= 0.0248 ,max= 57.1999
                   zi_1_c1
                   _______

    zi_1_R1        0.55179
    zi_2_R2         1.4444
    zi_181_r181      19.51
    zi_361_r361     53.986
    zi_362_r362       57.2

pos = 35 ; key = mt_z_trans ;rown= 45 ,coln= 45
mt_z_trans :mu= 0.022222 ,sd= 0.056818 ,min= 0 ,max= 0.2525
                  zi_1_C1       zi_2_C2      zi_23_c23     zi_44_c44     zi_45_c45 
                 __________    __________    __________    __________    __________

    zi_1_R1       0.0011772     0.0012141    1.1604e-05    1.0047e-15             0
    zi_2_R2      0.00050823    0.00088787    8.9462e-05    8.4698e-14    3.0142e-16
    zi_23_r23    7.7743e-09    1.8556e-07       0.02525    3.7111e-05    1.5549e-06
    zi_44_r44     1.572e-18    4.2351e-16    8.9462e-05       0.17757       0.10165
    zi_45_r45    1.2404e-20     5.003e-18    1.1604e-05       0.24282       0.23544

pos = 36 ; key = mt_z_wage_mesh_coh_wkb ;rown= 7425 ,coln= 15
mt_z_wage_mesh_coh_wkb :mu= 1.1347 ,sd= 0.67509 ,min= 0.34741 ,max= 2.567
                     zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                     _______    _______    _______    _________    _________

    zi_1_R1          0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2          0.34741    0.40076    0.94436     2.2253        2.567  
    zi_3713_r3713    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_7424_r7424    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_7425_r7425    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 37 ; key = mt_z_wage_mesh_interp_coh_grid ;rown= 38 ,coln= 15
mt_z_wage_mesh_interp_coh_grid :mu= 1.1347 ,sd= 0.67568 ,min= 0.34741 ,max= 2.567
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_19_r19    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_37_r37    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_38_r38    0.34741    0.40076    0.94436     2.2253        2.567  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                              i     idx    rowN       colN         mean        std          min         max   
                                              __    ___    ____    __________    ________    ________    _________    ________

    ar_a_meshk                                 1     1     2475             1     -7.2645      14.186          -20       49.93
    ar_ak_perc                                 2     2        1            45         0.5      0.2979        0.001       0.999
    ar_ameshk_tnext_with_r                     3     3     2475             3     -9.0195      15.884          -39      51.178
    ar_aplusk_mesh                             4     4     2475             1      5.4711      20.744          -20          50
    ar_coh_bridge_perc                         5     5        1             3         0.5         0.5            0           1
    ar_forbrblk                                6     6        1             9     -7.0556      6.3809          -19           0
    ar_forbrblk_r                              7     7        1             9       0.065           0        0.065       0.065
    ar_interp_c_grid                           8     8        1    7.7257e+05      38.649      22.302         0.02      77.277
    ar_interp_coh_grid                         9     9        1            38      18.148      23.118          -20      57.277
    ar_k_mesha                                10    10     2475             1      12.736      14.186            0       69.93
    ar_w_level                                11    11        1            35      14.571      20.964          -20          50
    ar_w_level_full                           12    12        1            55      5.4711      20.931          -20          50
    ar_w_perc                                 13    13        1            25         0.5     0.30605        0.001       0.999
    ar_z_r_infbr                              14    14        1             3      0.4875      0.4625        0.025        0.95
    ar_z_r_infbr_mesh_wage_r1w2               15    15        1            45      0.4875      0.3819        0.025        0.95
    ar_z_r_infbr_mesh_wage_w1r2               16    16        1            45      0.4875      0.3819        0.025        0.95
    ar_z_r_infbr_prob                         17    17        1             3     0.33333     0.49692    0.0045249     0.90498
    ar_z_wage                                 18    18        1            15      1.1347     0.69878      0.34741       2.567
    ar_z_wage_mesh_r_infbr_r1w2               19    19        1            45      1.1347     0.68271      0.34741       2.567
    ar_z_wage_mesh_r_infbr_w1r2               20    20        1            45      1.1347     0.68271      0.34741       2.567
    ar_z_wage_prob                            21    21        1            15    0.066667    0.060897    0.0027089     0.16757
    mt_bl_w_perc_mesh_interp_coh_grid_wneg    22    23       25            38     0.61895      0.4859            0           1
    mt_coh_bridge_perc_mesh_w_level_neg       23    24       10             3         0.5     0.41523            0           1
    mt_coh_w_perc_ratio_wneg                  24    25      588             1     0.72051     0.38072            0           1
    mt_coh_wkb                                25    26     7425            15      5.5134      22.642      -38.556      57.277
    mt_interp_coh_grid_mesh_w_perc            26    27       25            38      18.148      22.824          -20      57.277
    mt_interp_coh_grid_mesh_z                 27    28       38            45      18.148      22.818          -20      57.277
    mt_interp_coh_grid_mesh_z_wage            28    29       38            15      18.148      22.832          -20      57.277
    mt_k                                      29    30       45            55      12.736      14.186            0       69.93
    mt_w_level_neg_mesh_coh_bridge_perc       30    31       10             3     -10.455      6.1969          -20    -0.90909
    mt_w_perc_mesh_interp_coh_grid            31    32       25            38    -0.92596      17.552          -20        57.2
    mt_w_perc_mesh_interp_coh_grid_wneg       32    33      588             1     -12.446      5.9341          -20       -0.02
    mt_w_perc_mesh_interp_coh_grid_wpos       33    34      362             1      17.787      13.611       0.0248        57.2
    mt_z_trans                                34    35       45            45    0.022222    0.056818            0      0.2525
    mt_z_wage_mesh_coh_wkb                    35    36     7425            15      1.1347     0.67509      0.34741       2.567
    mt_z_wage_mesh_interp_coh_grid            36    37       38            15      1.1347     0.67568      0.34741       2.567

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    value
                   _    ___    _____

    it_ameshk_n    1    22     2475 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 10
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_coh_fbis ; val = @(fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(ar_for_borr.*(1+fl_r_fbr)+ar_inf_borr.*(1+fl_r_inf)+ar_for_save.*(1+fl_r_fsv))
pos = 3 ; key = f_coh_save ; val = @(b)(b.*(1+fl_r_fsv))
pos = 4 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 5 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 6 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 7 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 8 ; key = f_util_log ; val = @(c)log(c)
pos = 9 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
pos = 10 ; key = f_util_standin_coh ; val = @(coh,fl_r_borr)f_util_log((coh-fl_b_bd).*((coh&gt;0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+((coh-fl_b_bd)./(1)).*((coh&lt;=0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+(fl_c_min./(1+fl_r_borr)).*((((coh-fl_b_bd)./(1))&lt;=fl_c_min)))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i     idx    xFunction
                          __    ___    _________

    f_coh                  1     1         1    
    f_coh_fbis             2     2         2    
    f_coh_save             3     3         3    
    f_cons                 4     4         4    
    f_inc                  5     5         5    
    f_prod                 6     6         6    
    f_util_crra            7     7         7    
    f_util_log             8     8         8    
    f_util_standin         9     9         9    
    f_util_standin_coh    10    10        10    

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 37
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbzr_fibs_get_funcgrid(varargin)
%% FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids
% This file is based on
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html
% ffs_ipwkbzr_get_funcgrid>, see that file for more comments and compare
% differences in graphs and tables to see how the inclusion of formal and
% informal choices that consider bridge loans impact choice sets.
%
% Also compare against
% <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html
% ffs_abz_fibs_get_funcgrid> where the results are also considering formal
% and informal choices etc in the context of *abz fibs*.
%
% In contrast to ff_ipwkbzr_evf.m, here, we need to deal with borrowing and
% savings formal and informal. These will change how the testing matrix is
% constructed. When bridge loan is allowed, we also need to construct the
% output matrixes differently. In ff_ipwkbzr_evf.m, the assumption is that
% coh today does not matter, so to find optimal k* choice, we only need to
% know the aggregate savings level. But now, we need to know the coh level
% as well.
%
% Below two reachable coh matrixes are constructed, one for when aggregate
% savings choice w >= 0, and another for when aggregate savings <= 0. Then
% they are stacked together. And we still have the same outputs as
% ff_ipwkbzr_evf.m. The difference is that while for savings where w >=0,
% each row are w levels for the output matrixes, but for w <=0, each row is
% for w level + coh percentage combinations.
%
% * _ar_w_level_: What are the feasible grid of w = k'+b', these are to be interpolated
% later, these are level grid, not percentage grid
% * _ar_w_level_: What are the percentage based choices points for k' and
% b' given each w. These are _ar_a_meshk_, _ar_k_mesha_. Note here these
% are principles, k + b' is the total aggregate savings in period t. b is
% be a combination of formal and informal choices, but our percentage point
% for b is the overall principle of all formal and informal choices
% * _mt_coh_wkb_full_ : These are the cash-on-hand levels reacheable given
% the choice percentages of k and b'. The problem here is more complicated
% than
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html
% ffs_ipwkbzr_get_funcgrid> because here we can not get to coh tomorrow by
% multiplying principle by savings or borrowing interest rates, if
% borrowing, we have to optimize among formal and informal choices. That is
% computationally trivial because it's a static choice unrelated to the
% dynamic problem. The slightly more complicated thing is that we also have
% to consider percentages of b' that has to go to bridge loans due to
% negative cash-on-hand in period t. That makes the reachable cash-on-hand
% grid significantly larger than the grid in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html
% ffs_ipwkbzr_get_funcgrid>, we have to expand the grid by another
% percentage dimensionREPLACE_WITH_DASH_DASHpercentages of b' going to bridgeREPLACE_WITH_DASH_DASHfor negative
% levels of w=k'+b' overall choice.
%

%% Default
% Results identical to
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html
% ffs_ipwkbzr_get_funcgrid> is obtained by running default with:
% st_param_which = 'ffs_ipwkbzr_get_funcgrid';
%

if (~isempty(varargin))
    
    % override when called from outside
    [param_map, support_map] = varargin{:};
    
else
    
    close all;
    % default internal run
    [param_map, support_map] = ffs_ipwkbzr_fibs_set_default_param();
    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    support_map('bl_display_funcgrids') = true;

    st_param_which = 'default';

    param_map('fl_z_r_infbr_min') = 0.025;
    param_map('fl_z_r_infbr_max') = 0.95;
    param_map('fl_z_r_infbr_n') = 3;
    
    if (ismember(st_param_which, ['default', 'ffs_ipwkbzr_get_funcgrid']))

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 25;
        param_map('it_ak_perc_n') = 45;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

        % Note it_coh_bridge_perc is percentage NOT for BRIDGE
        if (strcmp(st_param_which, 'default'))

            param_map('it_coh_bridge_perc_n') = 3;
            param_map('bl_bridge') = true;

        elseif (strcmp(st_param_which, 'ffs_ipwkbzr_get_funcgrid'))

            % when bl_bridge = false, it_coh_bridge_perc_n = 1
            param_map('bl_bridge') = false;

        end

    elseif (strcmp(st_param_which, 'small'))

        param_map('bl_bridge') = true;
        
        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = false; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 7;
        param_map('it_ak_perc_n') = 7;
        param_map('it_coh_bridge_perc_n') = 3;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

    end

    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_infbr_n');

    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
end

%% Parse Parameters 1a

params_group = values(param_map, {'bl_bridge', 'fl_b_bd', 'fl_w_min', 'fl_w_max'});
[bl_bridge, fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min'});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'bl_b_is_principle', 'fl_r_fbr', 'fl_r_fsv', 'fl_w'});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_w] = params_group{:};

%% Parse Parameters 1b

params_group = values(param_map, {...
    'it_w_perc_n', 'it_ak_perc_n', 'it_coh_bridge_perc_n', ...
    'it_c_interp_grid_gap', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[it_w_perc_n, it_ak_perc_n, it_coh_bridge_perc_n, ...
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

%% Parse Parameters 2

% param_map shock income
params_group = values(param_map, {'it_z_wage_n', 'fl_z_wage_mu', 'fl_z_wage_rho', 'fl_z_wage_sig'});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

% param_map shock borrowing interest
params_group = values(param_map, {'st_z_r_infbr_drv_ele_type', 'st_z_r_infbr_drv_prb_type', 'fl_z_r_infbr_poiss_mean', ...
    'fl_z_r_infbr_max', 'fl_z_r_infbr_min', 'fl_z_r_infbr_n'});
[st_z_r_infbr_drv_ele_type, st_z_r_infbr_drv_prb_type, fl_z_r_infbr_poiss_mean, ...
    fl_z_r_infbr_max, fl_z_r_infbr_min, fl_z_r_infbr_n] = params_group{:};

% param_map formal menu
params_group = values(param_map, {'st_forbrblk_type', 'fl_forbrblk_brmost', 'fl_forbrblk_brleast', 'fl_forbrblk_gap'});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

% param_map shock income
params_group = values(param_map, {'it_z_n'});
[it_z_n] = params_group{:};

%% Parse Parameters 3

params_group = values(support_map, {'bl_display_minccost', 'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% G1: Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_fibs_set_default_param.html
% ffs_ipwkbzr_fibs_set_default_param> for details.
%
% @example
%
%    % For 2nd stage Grid
%    ar_w_level = [-2,0,2]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

%% G2: Expand A and K Arrays further if bridge is allowed
% Crucially, when a fraction of overall borrowing/savings needs to go pay
% negative coh, that comes out of w, fraction of w = k' + b' that goes to
% this. NOT a fraction of the b' choice condition on w, which would change
% for the same w as w' changes. We are fixing bridge repay level for w.
%
% @example
%
%    clear all
%    % Same as above
%    ar_w_level = [-2,-1,-0.1]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%
%    % fraction of borrowing for bridge loan
%    ar_coh_bridge_perc = [0, 0.5, 0.999];
%
%    % Expand matrix to include coh percentage dimension
%    mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
%    mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])
%
%    % bridge loan component of borrowing
%    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
%    ar_brdige_a = ar_brdige_a(:)'
%
%    % borrowing choices excluding bridge loan
%    mt_a_nobridge = mt_a - ar_brdige_a
%

% 1. negative part of w
ar_bl_w_neg = (ar_w_level < 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

if (bl_bridge)

    % 1. select mt_k and mt_a where w_level <= 0
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    % 2. fraction of borrowing NOT for bridge loan
    % 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    % 3. Expand matrix to include coh percentage dimension
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    % 4. bridge loan component of borrowing
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    % 5. borrowing choices excluding bridge loan
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    % 6. Matrix combine, negative than positive
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    % 7. Expand Bridge Choices to have the same size as mt_a
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    % 8. Overall borrowing and savings choices
    mt_a = mt_a_nobridge + mt_bridge_a;

    % 9. Update w
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    % 10. Pre-generate Interpolation matrix for negative w levels
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

else

    % If bridge loans are not needed, do not need to do expansions
    % All zeros, no bridge
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

end

%% G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.
% For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N
% number of rows. Where N is the percentage grid point for coh as well as
% k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos =
% numger of grid points for ar_w_level
%
% # *mt_a* includes aggregate/total borrowing and savings levels. b < 0 happens
% alot when w >= 0. The mt_a_nobridge
% # *mt_a_nobridge* includes all aggregate/total borrowing and savings
% whether w > 0 or w < 0, however, it subtracts away the borrowing that is
% for bridge loans when b < 0
% # *mt_bridge_a* is the bridge loan amount.
%

ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;

%% F1: Get Shock: Income Shock (ar1)

[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);

%% F2: Get Shock: Interest Rate Shock (iid)

% get borrowing grid and probabilities
param_dsv_map = containers.Map('KeyType','char', 'ValueType','any');
param_dsv_map('st_drv_ele_type') = st_z_r_infbr_drv_ele_type;
param_dsv_map('st_drv_prb_type') = st_z_r_infbr_drv_prb_type;
param_dsv_map('fl_poiss_mean') = fl_z_r_infbr_poiss_mean;
param_dsv_map('fl_max') = fl_z_r_infbr_max;
param_dsv_map('fl_min') = fl_z_r_infbr_min;
param_dsv_map('fl_n') = fl_z_r_infbr_n;
[ar_z_r_infbr, ar_z_r_infbr_prob] = fft_gen_discrete_var(param_dsv_map, true);

% iid transition matrix
mt_z_r_infbr_prob_trans = repmat(ar_z_r_infbr_prob, [length(ar_z_r_infbr_prob), 1]);

%% F3: Get Shock: Mesh Shocks Together

% Kronecker product to get full transition matrix for the two shocks
mt_z_trans = kron(mt_z_r_infbr_prob_trans, mt_z_wage_trans);

% mesh the shock vectors
[mt_z_wage_mesh_r_infbr_w1r2, mt_z_r_infbr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_infbr);
ar_z_r_infbr_mesh_wage_w1r2 = mt_z_r_infbr_mesh_wage_w1r2(:)';
ar_z_wage_mesh_r_infbr_w1r2 = mt_z_wage_mesh_r_infbr_w1r2(:)';

% mesh the shock vectors
[mt_z_r_infbr_mesh_wage_r1w2, mt_z_wage_mesh_r_infbr_r1w2] = ndgrid(ar_z_r_infbr, ar_z_wage);
ar_z_wage_mesh_r_infbr_r1w2 = mt_z_wage_mesh_r_infbr_r1w2(:)';
ar_z_r_infbr_mesh_wage_r1w2 = mt_z_r_infbr_mesh_wage_r1w2(:)';


if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_r_infbr_mesh_wage_w1r2');
    disp('Prod/Wage Shock: ar_z_wage_mesh_r_infbr_w1r2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_r_infbr_mesh_wage_w1r2;...
                                 ar_z_wage_mesh_r_infbr_w1r2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_wage_mesh_r_infbr_r1w2');
    disp('Prod/Wage Shock: ar_z_r_infbr_mesh_wage_r1w2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_wage_mesh_r_infbr_r1w2;...
                                 ar_z_r_infbr_mesh_wage_r1w2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:length(ar_z_r_infbr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_infbr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow Rate Transition Matrix: mt_z_r_infbr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_infbr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_infbr', 'r%3.2f')]);
    tb_z_r_infbr_prob_trans = array2table(round(mt_z_r_infbr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_r_infbr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_infbr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_infbr_prob_trans));
    disp(tb_z_r_infbr_prob_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Wage Prod Shock Transition Matrix: mt_z_r_infbr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', 'w%3.2f')]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Full Transition Matrix: mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_infbr_mesh_wage_w1r2', 'r%3.2f;'), ...
                                   num2str(ar_z_wage_mesh_r_infbr_w1r2', 'w%3.2f')]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('i', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('i', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

end

%% FIBS1: Get Equations

[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = ...
    ffs_ipwkbzr_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);

%% FIBS2: Get Formal Borrowing Blocks

[ar_forbrblk, ar_forbrblk_r] = ...
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);

%% Find Formal and Informal Choices for Borrowing points
% Here we solve for the optimal formal and informal choices given b. Note
% that kind of like the static firm's maximization problem. Here the
% optimization problem is static, and can be done independently of the
% overall dynamic optimization problem.

% When borrowing index and array
% note index for negative is from _ar_a_meshk_full_, but value from
% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some
% of these points _ar_a_nobridge_meshk_ = 0. But need to use
% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all
% borrowing.
ar_bl_ameshk_neg_idx = (ar_a_meshk_full < 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

% Given b, solve for optimal formal and informal choices.
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_infbr_aneg, ar_for_save_aneg] = ...
   ffs_fibs_min_c_cost(bl_b_is_principle, ar_z_r_infbr, fl_r_fsv, ...
                         ar_forbrblk_r, ar_forbrblk, ...
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);

%% FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative
% *ar_coh_fbis_aneg*: the consumption cost to t+1 from borrowing in t given
% formal and informal joint choice optimization.
%
% Reachable cash-on-hand borrowing points: N_neg*N^2 rows
%
% Additionally, need to convert borrowing choices to consumption units next
% period. borrowing choices in percentage are in unit of last period
% borrowing, principles only, need to convert to interest rates plus
% principle which means considering which formal informal choice
% combination maximizes cash-on-hand for the same level of overall
% principles.
%
% Construct another percentage, which is, percentages of ar_a_meshk_full
% when w < 0. Percentage represents what fraction of the a debt is going
% towards bridge loan debts. Note that as long as w < 0, b < 0 must be the
% case as well. So for negative elements of w, there is a triple mesh: N
% points for A x N points for K x N points for Bridge.
%

ar_coh_fbis_aneg = f_coh_fbis(ar_z_r_infbr, ...
                                ar_for_infbr_aneg, ...
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), ...
                                ar_for_save_aneg);

%% FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive
% *ar_coh_save_apos*: the consumption gain to t+1 from savings in t

ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);

%% COH1: Combine overall Reachable Cash-on-Hand Levels
% ROWS: N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count.
% These are the cash-on-hand points reachable given percentage grid choice
% structure and the possibility of bridge loans.
% COLUMNS: determined by length(ar_z_r_infbr), each column a different
% informal borrowing interest rate.
%
% # mt_coh_wkb_full: this is the (P^k x I^w x M^r) by (M^z) matrix, where
% rows = it_w_interp_n*it_ak_perc_n*fl_z_r_infbr_n, and cols = it_z_wage_n.
%

mt_ameshk_tnext_with_r = zeros(length(ar_k_mesha), fl_z_r_infbr_n);
mt_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx, :) = ar_coh_fbis_aneg;
mt_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx, :) = zeros(1, fl_z_r_infbr_n) + ar_coh_save_apos;

% # mt_ameshk_tnext_with_r: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w ) by (M^r) matrix
% # mt_coh_wkb_full: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix

mt_k_mesha_mesh_z_wage = ar_k_mesha + zeros(1, fl_z_r_infbr_n);
mt_coh_wkb_full = f_coh(ar_z_wage, mt_ameshk_tnext_with_r(:), mt_k_mesha_mesh_z_wage(:));

% Generate Aggregate Variables
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

if (bl_display_funcgrids || bl_graph_funcgrids)
    
    % Generate Aggregate Variables
    mt_bwithrplusk_mesh = mt_ameshk_tnext_with_r + ar_k_mesha;

    % Genereate Table
    tab_ak_choices = array2table([mt_bwithrplusk_mesh, ar_aplusk_mesh, ...
                                  ar_k_mesha, mt_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = [strcat('mt_bwthrplusk', string((1:length(ar_z_r_infbr)))), ...
                    'ar_aplusk_mesha', 'ar_k_mesha', ...
                    strcat('mt_a_wth_r_infbr', string((1:length(ar_z_r_infbr)))), ...
                    'ar_a_meshk', 'ar_a_nobridge_meshk', 'ar_bridge_a'];
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesha'} = ...
        '*ar_aplusk_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha'} = ...
        '*ar_k_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk'} = ...
        '*ar_a_meshk*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_nobridge_meshk'} = ...
        '*ar_aprime_nobridge*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_bridge_a'} = ...
        '*ar_bridge_a*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('tab_ak_choices');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

end

%% COH2: Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
% mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, length(ar_w_level_full)*fl_z_r_infbr_n]);

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.

ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_infbr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));

%% COH3: Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% COH4: Select only Valid (k(w), a) choices

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;
% mt_z_wage_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);
% mt_z_r_infbr_mesh_coh_wkb = repmat(ar_z_r_infbr, [size(mt_coh_wkb,1),1]);
mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;

% This is borrowing with default or not condition
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

% 1. Given COH grid, w choices in terms of cash-on-hand percentages
if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end

% 2. Some w < 0, some w > 0. When w < 0, coh > 0 or coh < 0 both possible.
% Need to interplate in ff_ipwkbzr_fibs_vecsv differently for w < 0 because
% there both w as well as coh matters, if coh < 0 and w < 0, a fraction of
% w goes to getting informal bridge loans.
mt_bl_w_perc_mesh_interp_coh_grid_wneg = (mt_w_perc_mesh_interp_coh_grid < 0);
mt_w_perc_mesh_interp_coh_grid_wneg = mt_w_perc_mesh_interp_coh_grid(mt_bl_w_perc_mesh_interp_coh_grid_wneg);
mt_w_perc_mesh_interp_coh_grid_wpos = mt_w_perc_mesh_interp_coh_grid(~mt_bl_w_perc_mesh_interp_coh_grid_wneg);

%% Generate 1st Stage Choices: Percent of W for Covering Bridge Loans
% If bridge loan does not matter, do not need to cover bridge loan. Then
% these percentages should reflect what happens when param_map('bl_bridge')
% = false, and, param_map('it_coh_bridge_perc_n') = 1;

% 1. Expand cash-on-hand by w_perc grid
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_perc_mesh_interp_coh_grid)) + ar_interp_coh_grid;

% 2. How much is coh as perc of w_perc grid level choice based on w_perc
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_perc_mesh_interp_coh_grid));

% 3. The ratio only relevant for where w < 0 and where coh < 0. Note the
% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to
% bridge.
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc >= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_perc_mesh_interp_coh_grid_wneg);

%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): base arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # ar_interp_c_grid: 1 by I^c
% # ar_interp_coh_grid: 1 by I^{coh}
% # ar_w_level: 1 by I^{W=k+b}
% # ar_w_perc: 1 by P^{W=k+b}
% # ar_ak_perc: 1 by P^{k and b}
%
% more descriptions:
%
% # ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation
% # ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)
% # ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level
% of w over which we solve the optimal percentage k' choices. Need to
% generate interpolant based on this so that we know optimal k* given
% ar_w_perc(coh) in the 1st stage
% # ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set.
% 1st stage, percentage w choice given coh, at each coh level the number of
% choice points is the same for this problem with
% percentage grid points.
% # ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set
%

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('ar_w_level') = ar_w_level;
armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_ak_perc') = ar_ak_perc;

%% Store armt_map (2): 1st stage level coh on hand related arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w
% # mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w
% # mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}
% # mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}
%
% more descriptions:
%
% # *mt_w_perc_mesh_interp_coh_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('mt_interp_coh_grid_mesh_z_wage') = mt_interp_coh_grid_mesh_z_wage;
armt_map('mt_z_wage_mesh_interp_coh_grid') = mt_z_wage_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;
armt_map('mt_w_perc_mesh_interp_coh_grid') = mt_w_perc_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;


%% Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_coh_wkb: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix
% # mt_z_wage_mesh_coh_wkb: same as mt_coh_wkb
%

armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_z_wage_mesh_coh_wkb') = mt_z_wage_mesh_coh_wkb;

%% Store armt_map (4): 2nd stage additional arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_k: (I^w) by (P^{k and b})
% # ar_a_meshk: 1 by (I^w x P^{k and b})
% # ar_k_mesha: 1 by (I^w x P^{k and b})
% # ar_aplusk_mesh: 1 by (I^w x P^{k and b})
% # it_ameshk_n: scalar
%

armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('ar_aplusk_mesh') = ar_aplusk_mesh;
armt_map('it_ameshk_n') = length(ar_a_meshk);

%% Store armt_map (5): Shock Grids Arrays and Mesh
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # ar_z_r_infbr: 1 by (M^r)
% # ar_z_r_infbr_prob: 1 by (M^r)
% # ar_z_wage: 1 by (M^z)
% # ar_z_wage_prob: 1 by (M^z)
% # ar_z_r_infbr_mesh_wage_w1r2: 1 by (M^z x M^r)
% # ar_z_wage_mesh_r_infbr_w1r2: 1 by (M^z x M^r)
% # ar_z_r_infbr_mesh_wage_r1w2: 1 by (M^r x M^z)
% # ar_z_wage_mesh_r_infbr_r1w2: 1 by (M^r x M^z)
%

armt_map('ar_z_r_infbr') = ar_z_r_infbr;
armt_map('ar_z_r_infbr_prob') = ar_z_r_infbr_prob;

armt_map('ar_z_wage') = ar_z_wage;
armt_map('ar_z_wage_prob') = ar_z_wage_prob;

armt_map('ar_z_r_infbr_mesh_wage_w1r2') = ar_z_r_infbr_mesh_wage_w1r2;
armt_map('ar_z_wage_mesh_r_infbr_w1r2') = ar_z_wage_mesh_r_infbr_w1r2;
armt_map('ar_z_r_infbr_mesh_wage_r1w2') = ar_z_r_infbr_mesh_wage_r1w2;
armt_map('ar_z_wage_mesh_r_infbr_r1w2') = ar_z_wage_mesh_r_infbr_r1w2;

armt_map('mt_z_trans') = mt_z_trans;


%% Store armt_map (6): W Share for Bridge Parameters
%
% # *ar_w_level_full*: in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/solve/html/ff_ipwkbzr_vf_vecsv.html
% ff_ipwkbzr_vf_vecsv>, _ar_w_level_ and _ar_w_level_full_ were the same.
% Now have this thing which is stored (length(ar_w_level_full)) by
% (length(ar_z)). _ar_w_level_full_ includes not just different levels of
% _ar_w_level_, but also repeats the elements of _ar_w_level_ that are < 0
% by _it_coh_bridge_perc_n_ times, starting with what corresponds to 100
% percent of w should go to cover bridge loan, until 0 percent for w < 0,
% which then proceeds to w > 0. So the last segment of _ar_w_level_full_ is
% the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) =
% ar_w_level.
%

armt_map('ar_coh_bridge_perc') = ar_coh_bridge_perc;
armt_map('ar_w_level_full') = ar_w_level_full;
armt_map('ar_ameshk_tnext_with_r') = mt_ameshk_tnext_with_r;

armt_map('mt_w_level_neg_mesh_coh_bridge_perc') = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map('mt_coh_bridge_perc_mesh_w_level_neg') = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map('mt_bl_w_perc_mesh_interp_coh_grid_wneg') = mt_bl_w_perc_mesh_interp_coh_grid_wneg;
armt_map('mt_w_perc_mesh_interp_coh_grid_wneg') = mt_w_perc_mesh_interp_coh_grid_wneg;
armt_map('mt_w_perc_mesh_interp_coh_grid_wpos') = mt_w_perc_mesh_interp_coh_grid_wpos;
armt_map('mt_coh_w_perc_ratio_wneg') = mt_coh_w_perc_ratio_wneg;

%% Store armt_map (7): Formal Informal Arrays

armt_map('ar_forbrblk') = ar_forbrblk;
armt_map('ar_forbrblk_r') = ar_forbrblk_r;

%% Store Function Map

func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_util_standin_coh') = f_util_standin_coh;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_coh_fbis') = f_coh_fbis;
func_map('f_coh_save') = f_coh_save;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Generate Limited Legends
    % 8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates
    ar_it_z_r_infbr = ([1 round((fl_z_r_infbr_n)/2) (fl_z_r_infbr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    % combine by index
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_infbr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    % legends index final
    cl_st_legendCell = cellstr([num2str(ar_z_r_infbr_mesh_wage_w1r2', 'zr=%3.2f;'), ...
                                num2str(ar_z_wage_mesh_r_infbr_w1r2', 'zw=%3.2f')]);

    % legends index final full mat wage only
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', 'zw=%3.2f')]);
    
    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.
    %
    % Plot end because earlier parts have repeating w and a levels due to
    % potentially bridge which are coh percentage dependent. This will only
    % plot out the grid basically when coh percentage for bridge loan = 0
    %

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), ...
                 mt_k(:,it_col_start:it_col_end), ...
                 'blue');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

%     if (length(ar_w_level_full) <= 100)
    scatter(ar_a_meshk(it_col_start:it_col_end), ...
            ar_k_mesha(it_col_start:it_col_end), ...
            3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level) <= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),...
                                     ar_k_mesha_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title({'Risky K Percentage Grids Given w=k+a (2nd Stage)'...
           '(Bridge Borrow Share = 0)'})
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end

    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
            'Super-Seg: borrow r; Seg: w bridge perc; Sub-Seg: w=k+b; within inc. k'...    
            'For each w and z, coh maximizing k is different'});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), ...
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), 'Location', 'northwest');
    
    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z_wage');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_w_perc_mesh_interp_coh_grid));
    disp(head(array2table(mt_w_perc_mesh_interp_coh_grid), 10));
    disp(tail(array2table(mt_w_perc_mesh_interp_coh_grid), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_coh_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_coh_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_c_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_c_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_interp_coh_grid_mesh_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_a');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_a_meshk');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_a_meshk));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_k');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_k_mesha');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    for i = 1:length(func_map)
        st_display = strjoin(['pos =' num2str(i) '; key =' string(param_map_keys{i}) '; val =' func2str(param_map_vals{i})]);
        disp(st_display);
    end

end

%% Display

if (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
end

end

##### SOURCE END #####
--></body></html>