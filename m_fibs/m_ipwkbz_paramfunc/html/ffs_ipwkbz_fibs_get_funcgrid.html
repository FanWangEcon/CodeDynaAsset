
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-01"><meta name="DC.source" content="ffs_ipwkbz_fibs_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters</a></li><li><a href="#5">G1: Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#6">G2: Expand A and K Arrays further if bridge is allowed</a></li><li><a href="#7">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</a></li><li><a href="#8">F1: Get Shock Grids</a></li><li><a href="#9">FIBS1: Get Equations</a></li><li><a href="#10">FIBS2: Get Formal Borrowing Blocks</a></li><li><a href="#11">Find Formal and Informal Choices for Borrowing points</a></li><li><a href="#12">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</a></li><li><a href="#13">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</a></li><li><a href="#14">COH1: Combine overall Reachable Cash-on-Hand Levels</a></li><li><a href="#15">COH2: Check if COH is within Borrowing Bounds</a></li><li><a href="#16">COH3: Update Valid 2nd stage choice matrix</a></li><li><a href="#17">COH4: Select only Valid (k(w), a) choices</a></li><li><a href="#18">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#19">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#20">Generate Interpolation Consumption Grid</a></li><li><a href="#21">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#22">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</a></li><li><a href="#23">Store armt_map (2): First Stage Aggregate Savings</a></li><li><a href="#24">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</a></li><li><a href="#25">Store armt_map (4): Shock Grids</a></li><li><a href="#26">Store Function Map</a></li><li><a href="#27">Graph</a></li><li><a href="#29">Graph 1: a and k choice grid graphs</a></li><li><a href="#30">Graph 2: coh by shock</a></li><li><a href="#31">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#33">Graph Details, Generally do Not Run</a></li><li><a href="#35">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#36">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#38">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>This file is based on <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, see that file for more comments and compare differences in graphs and tables to see how the inclusion of formal and informal choices that consider bridge loans impact choice sets.</p><p>Also compare against <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html">ffs_abz_fibs_get_funcgrid</a> where the results are also considering formal and informal choices etc in the context of <b>abz fibs</b>.</p><p>In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and savings formal and informal. These will change how the testing matrix is constructed. When bridge loan is allowed, we also need to construct the output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that coh today does not matter, so to find optimal k* choice, we only need to know the aggregate savings level. But now, we need to know the coh level as well.</p><p>Below two reachable coh matrixes are constructed, one for when aggregate savings choice w &gt;= 0, and another for when aggregate savings &lt;= 0. Then they are stacked together. And we still have the same outputs as ff_ipwkbz_evf.m. The difference is that while for savings where w &gt;=0, each row are w levels for the output matrixes, but for w &lt;=0, each row is for w level + coh percentage combinations.</p><div><ul><li><i>ar_w_level</i>: What are the feasible grid of w = k'+b', these are to be interpolated later, these are level grid, not percentage grid</li><li><i>ar_w_level</i>: What are the percentage based choices points for k' and b' given each w. These are <i>ar_a_meshk</i>, <i>ar_k_mesha</i>. Note here these are principles, k + b' is the total aggregate savings in period t. b is be a combination of formal and informal choices, but our percentage point for b is the overall principle of all formal and informal choices</li><li><i>mt_coh_wkb_full</i> : These are the cash-on-hand levels reacheable given the choice percentages of k and b'. The problem here is more complicated than <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> because here we can not get to coh tomorrow by multiplying principle by savings or borrowing interest rates, if borrowing, we have to optimize among formal and informal choices. That is computationally trivial because it's a static choice unrelated to the dynamic problem. The slightly more complicated thing is that we also have to consider percentages of b' that has to go to bridge loans due to negative cash-on-hand in period t. That makes the reachable cash-on-hand grid significantly larger than the grid in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, we have to expand the grid by another percentage dimension--percentages of b' going to bridge--for negative levels of w=k'+b' overall choice.</li></ul></div><h2 id="3">Default</h2><p>Results identical to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> is obtained by running default with: st_param_which = 'ffs_ipwkbz_get_funcgrid';</p><pre class="codeinput">bl_input_override = 0;
<span class="keyword">if</span> (length(varargin) == 3)
    bl_input_override = varargin{3};
<span class="keyword">end</span>
<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% override when called from outside</span>
    [param_map, support_map, ~] = varargin{:};
<span class="keyword">else</span>
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = true;

    st_param_which = <span class="string">'small'</span>;

    <span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>]))

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 25;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 45;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

        <span class="keyword">if</span> (strcmp(st_param_which, <span class="string">'default'</span>))

            param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

            <span class="comment">% Adjust interest rates</span>
            param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;
            param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>))

            param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 1;

            param_map(<span class="string">'fl_r_inf'</span>) = 0.025;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.025;
            param_map(<span class="string">'bl_bridge'</span>) = false;

        <span class="keyword">end</span>

    <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'small'</span>))

        param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="comment">% Adjust interest rates</span>
        param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
        param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = false; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 7;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 7;
        param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

    <span class="keyword">end</span>


    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameters</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_z_mu'</span>, <span class="string">'fl_z_rho'</span>, <span class="string">'fl_z_sig'</span>});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>, <span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, <span class="keyword">...</span>
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_k_min'</span>, <span class="string">'fl_k_max'</span>, <span class="string">'it_ak_perc_n'</span>});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>, <span class="string">'it_c_interp_grid_gap'</span>});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_bridge'</span>, <span class="string">'it_coh_bridge_perc_n'</span>});
[bl_bridge, it_coh_bridge_perc_n] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_b_is_principle'</span>, <span class="string">'fl_r_fbr'</span>, <span class="string">'fl_r_fsv'</span>, <span class="string">'fl_r_inf'</span>, <span class="string">'fl_w'</span>});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_r_inf, fl_w] = params_group{:};

params_group = values(param_map, {<span class="string">'st_forbrblk_type'</span>, <span class="string">'fl_forbrblk_brmost'</span>, <span class="string">'fl_forbrblk_brleast'</span>, <span class="string">'fl_forbrblk_gap'</span>});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

params_group = values(support_map, {<span class="string">'bl_display_minccost'</span>, <span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
</pre><h2 id="5">G1: Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html">ffs_ipwkbz_fibs_set_default_param</a> for details.</p><p>@example</p><pre>  % For 2nd stage Grid
  ar_w_level = [-2,0,2]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = linspace(fl_w_min, fl_w_max, it_w_interp_n);
ar_w_level = ar_w_level_full;

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>
</pre><h2 id="6">G2: Expand A and K Arrays further if bridge is allowed</h2><p>Crucially, when a fraction of overall borrowing/savings needs to go pay negative coh, that comes out of w, fraction of w = k' + b' that goes to this. NOT a fraction of the b' choice condition on w, which would change for the same w as w' changes. We are fixing bridge repay level for w.</p><p>@example</p><pre>  clear all
  % Same as above
  ar_w_level = [-2,-1,-0.1]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre>  % fraction of borrowing for bridge loan
  ar_coh_bridge_perc = [0, 0.5, 0.999];</pre><pre>  % Expand matrix to include coh percentage dimension
  mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
  mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])</pre><pre>  % bridge loan component of borrowing
  ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
  ar_brdige_a = ar_brdige_a(:)'</pre><pre>  % borrowing choices excluding bridge loan
  mt_a_nobridge = mt_a - ar_brdige_a</pre><pre class="codeinput"><span class="keyword">if</span> (bl_bridge)

    <span class="comment">% 1. select mt_k and mt_a where w_level &lt;= 0</span>
    ar_bl_w_neg = (ar_w_level &lt; 0);
    ar_w_level_neg = ar_w_level(ar_bl_w_neg);
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    <span class="comment">% 2. fraction of borrowing for bridge loan</span>
    <span class="comment">% start at 0, some borrowing no bridge loan needed, coh &gt; 0</span>
    ar_coh_bridge_perc = fliplr(linspace(0, 1.0, it_coh_bridge_perc_n));

    <span class="comment">% 3. Expand matrix to include coh percentage dimension</span>
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    <span class="comment">% 4. bridge loan component of borrowing</span>
    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    <span class="comment">% 5. borrowing choices excluding bridge loan</span>
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    <span class="comment">% 6. Matrix combine, negative than positive</span>
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    <span class="comment">% 7. Expand Bridge Choices to have the same size as mt_a</span>
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    <span class="comment">% 8. Overall borrowing and savings choices</span>
    mt_a = mt_a_nobridge + mt_bridge_a;

    <span class="comment">% 9. Update w</span>
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

<span class="keyword">else</span>

    <span class="comment">% If bridge loans are not needed, do not need to do expansions</span>
    <span class="comment">% All zeros, no bridge</span>
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

<span class="keyword">end</span>
</pre><h2 id="7">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</h2><p>For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N number of rows. Where N is the percentage grid point for coh as well as k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos = numger of grid points for ar_w_level</p><div><ol><li><b>mt_a</b> includes aggregate/total borrowing and savings levels. b &lt; 0 happens alot when w &gt;= 0. The mt_a_nobridge</li><li><b>mt_a_nobridge</b> includes all aggregate/total borrowing and savings whether w &gt; 0 or w &lt; 0, however, it subtracts away the borrowing that is for bridge loans when b &lt; 0</li><li><b>mt_bridge_a</b> is the bridge loan amount.</li></ol></div><pre class="codeinput">ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;
</pre><h2 id="8">F1: Get Shock Grids</h2><pre class="codeinput">[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);
</pre><h2 id="9">FIBS1: Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);
</pre><h2 id="10">FIBS2: Get Formal Borrowing Blocks</h2><pre class="codeinput">[ar_forbrblk, ar_forbrblk_r] = <span class="keyword">...</span>
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);
</pre><h2 id="11">Find Formal and Informal Choices for Borrowing points</h2><p>Here we solve for the optimal formal and informal choices given b. Note that kind of like the static firm's maximization problem. Here the optimization problem is static, and can be done independently of the overall dynamic optimization problem.</p><pre class="codeinput"><span class="comment">% When borrowing index and array</span>
<span class="comment">% note index for negative is from _ar_a_meshk_full_, but value from</span>
<span class="comment">% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some</span>
<span class="comment">% of these points _ar_a_nobridge_meshk_ = 0. But need to use</span>
<span class="comment">% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all</span>
<span class="comment">% borrowing.</span>
ar_bl_ameshk_neg_idx = (ar_a_meshk_full &lt; 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

<span class="comment">% Given b, solve for optimal formal and informal choices.</span>
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = <span class="keyword">...</span>
   ffs_fibs_min_c_cost(bl_b_is_principle, fl_r_inf, fl_r_fsv, <span class="keyword">...</span>
                         ar_forbrblk_r, ar_forbrblk, <span class="keyword">...</span>
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);
</pre><h2 id="12">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</h2><p><b>ar_coh_fbis_aneg</b>: the consumption cost to t+1 from borrowing in t given formal and informal joint choice optimization.</p><p>Reachable cash-on-hand borrowing points: N_neg*N^2 rows</p><p>Additionally, need to convert borrowing choices to consumption units next period. borrowing choices in percentage are in unit of last period borrowing, principles only, need to convert to interest rates plus principle which means considering which formal informal choice combination maximizes cash-on-hand for the same level of overall principles.</p><p>Construct another percentage, which is, percentages of ar_a_meshk_full when w &lt; 0. Percentage represents what fraction of the a debt is going towards bridge loan debts. Note that as long as w &lt; 0, b &lt; 0 must be the case as well. So for negative elements of w, there is a triple mesh: N points for A x N points for K x N points for Bridge.</p><pre class="codeinput">ar_coh_fbis_aneg = f_coh_fbis(fl_r_inf, <span class="keyword">...</span>
                                ar_for_borr_aneg, <span class="keyword">...</span>
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), <span class="keyword">...</span>
                                ar_for_save_aneg);
</pre><h2 id="13">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</h2><p><b>ar_coh_save_apos</b>: the consumption gain to t+1 from savings in t</p><pre class="codeinput">ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);
</pre><h2 id="14">COH1: Combine overall Reachable Cash-on-Hand Levels</h2><p>N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count. These are the cash-on-hand points reachable given percentage grid choice structure and the possibility of bridge loans.</p><pre class="codeinput">ar_ameshk_tnext_with_r = zeros(size(ar_k_mesha));
ar_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx) = ar_coh_fbis_aneg;
ar_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx) = ar_coh_save_apos;

mt_coh_wkb_full = f_coh(ar_z, ar_ameshk_tnext_with_r, ar_k_mesha);

<span class="keyword">if</span> (bl_display_funcgrids)

    <span class="comment">% Generate Aggregate Variables</span>
    ar_aplusk_mesha = ar_a_meshk + ar_k_mesha;
    ar_bwithrplusk_mesha = ar_ameshk_tnext_with_r + ar_k_mesha;

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([ar_bwithrplusk_mesha, ar_aplusk_mesha, <span class="keyword">...</span>
        ar_k_mesha, ar_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = {<span class="string">'ar_bwithrplusk_mesha'</span>, <span class="string">'ar_aplusk_mesha'</span>, <span class="keyword">...</span>
        <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_ameshk_tnext_with_r'</span>, <span class="string">'ar_a_meshk'</span>, <span class="string">'ar_a_nobridge_meshk'</span>, <span class="string">'ar_bridge_a'</span>};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bwithrplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bwithrplusk_mesha*: '</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_ameshk_tnext_with_r'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_ameshk_tnext_with_r*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_nobridge_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aprime_nobridge*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bridge_a'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bridge_a*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_bwithrplusk_mesha*:
*ar_aplusk_mesha*:
*ar_k_mesha*:
*ar_ameshk_tnext_with_r*:
*ar_a_meshk*:
*ar_aprime_nobridge*:
*ar_bridge_a*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   385     7

      tab_ak_choices1       tab_ak_choices2    tab_ak_choices3       tab_ak_choices4        tab_ak_choices5      tab_ak_choices6      tab_ak_choices7
    ar_bwithrplusk_mesha    ar_aplusk_mesha      ar_k_mesha       ar_ameshk_tnext_with_r      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a  
    ____________________    _______________    _______________    ______________________    _______________    ___________________    _______________

              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
              -26                   -20                  0                   -26                   -20                      0                 -20    
          -23.324               -17.941          0.0020588               -23.326               -17.943             -0.0020588             -17.941    
          -23.342               -17.941            0.34451               -23.687               -18.286               -0.34451             -17.941    
          -23.351               -17.941            0.68696               -24.038               -18.628               -0.68696             -17.941    
          -23.367               -17.941             1.0294               -24.397               -18.971                -1.0294             -17.941    
          -23.383               -17.941             1.3719               -24.755               -19.313                -1.3719             -17.941    
          -23.391               -17.941             1.7143               -25.106               -19.655                -1.7143             -17.941    
            -23.4               -17.941             2.0568               -25.457               -19.998                -2.0568             -17.941    
          -20.648               -15.882          0.0041176               -20.652               -15.886             -0.0041176             -15.882    
          -20.674               -15.882            0.68902               -21.363               -16.571               -0.68902             -15.882    
          -20.706               -15.882             1.3739                -22.08               -17.256                -1.3739             -15.882    
          -20.724               -15.882             2.0588               -22.782               -17.941                -2.0588             -15.882    
          -20.756               -15.882             2.7437               -23.499               -18.626                -2.7437             -15.882    
          -20.773               -15.882             3.4286               -24.201               -19.311                -3.4286             -15.882    
          -20.805               -15.882             4.1135               -24.918               -19.996                -4.1135             -15.882    
          -17.972               -13.824          0.0061765               -17.979                -13.83             -0.0061765             -13.824    
          -18.016               -13.824             1.0335               -19.049               -14.857                -1.0335             -13.824    
          -18.047               -13.824             2.0609               -20.108               -15.884                -2.0609             -13.824    
          -18.088               -13.824             3.0882               -21.176               -16.912                -3.0882             -13.824    
          -18.128               -13.824             4.1156               -22.244               -17.939                -4.1156             -13.824    
          -18.154               -13.824             5.1429               -23.297               -18.966                -5.1429             -13.824    
          -18.195               -13.824             6.1703               -24.365               -19.994                -6.1703             -13.824    
          -15.297               -11.765          0.0082353               -15.305               -11.773             -0.0082353             -11.765    
          -15.354               -11.765              1.378               -16.732               -13.143                 -1.378             -11.765    
          -15.403               -11.765             2.7478               -18.151               -14.513                -2.7478             -11.765    
          -15.452               -11.765             4.1176                -19.57               -15.882                -4.1176             -11.765    
          -15.486               -11.765             5.4875               -20.974               -17.252                -5.4875             -11.765    
          -15.536               -11.765             6.8573               -22.393               -18.622                -6.8573             -11.765    
            -15.6               -11.765             8.2271               -23.827               -19.992                -8.2271             -11.765    
          -12.621               -9.7059           0.010294               -12.631               -9.7162              -0.010294             -9.7059    
          -12.686               -9.7059             1.7225               -14.408               -11.428                -1.7225             -9.7059    
          -12.744               -9.7059             3.4348               -16.178               -13.141                -3.4348             -9.7059    
          -12.801               -9.7059             5.1471               -17.948               -14.853                -5.1471             -9.7059    
          -12.859               -9.7059             6.8593               -19.718               -16.565                -6.8593             -9.7059    
          -12.932               -9.7059             8.5716               -21.504               -18.277                -8.5716             -9.7059    
           -13.02               -9.7059             10.284               -23.304                -19.99                -10.284             -9.7059    
          -9.9449               -7.6471           0.012353               -9.9572               -7.6594              -0.012353             -7.6471    
          -10.018               -7.6471             2.0671               -12.085               -9.7141                -2.0671             -7.6471    
          -10.099               -7.6471             4.1218               -14.221               -11.769                -4.1218             -7.6471    
          -10.166               -7.6471             6.1765               -16.342               -13.824                -6.1765             -7.6471    
          -10.247               -7.6471             8.2312               -18.478               -15.878                -8.2312             -7.6471    
          -10.343               -7.6471             10.286               -20.629               -17.933                -10.286             -7.6471    
          -10.395               -7.6471             12.341               -22.735               -19.988                -12.341             -7.6471    
           -7.269               -5.5882           0.014412               -7.2834               -5.6026              -0.014412             -5.5882    
            -7.35               -5.5882             2.4116               -9.7616               -7.9998                -2.4116             -5.5882    
          -7.4399               -5.5882             4.8087               -12.249               -10.397                -4.8087             -5.5882    
          -7.5449               -5.5882             7.2059               -14.751               -12.794                -7.2059             -5.5882    
          -7.6048               -5.5882              9.603               -17.208               -15.191                 -9.603             -5.5882    
          -7.7097               -5.5882                 12                -19.71               -17.588                    -12             -5.5882    
          -7.7696               -5.5882             14.397               -22.167               -19.986                -14.397             -5.5882    
          -4.5932               -3.5294           0.016471               -4.6096               -3.5459              -0.016471             -3.5294    
          -4.6971               -3.5294             2.7561               -7.4532               -6.2855                -2.7561             -3.5294    
          -4.7806               -3.5294             5.4957               -10.276               -9.0251                -5.4957             -3.5294    
          -4.8941               -3.5294             8.2353               -13.129               -11.765                -8.2353             -3.5294    
          -5.0076               -3.5294             10.975               -15.983               -14.504                -10.975             -3.5294    
          -5.0761               -3.5294             13.715               -18.791               -17.244                -13.715             -3.5294    
          -5.1896               -3.5294             16.454               -21.644               -19.984                -16.454             -3.5294    
          -1.9173               -1.4706           0.018529               -1.9359               -1.4891              -0.018529             -1.4706    
          -2.0293               -1.4706             3.1006               -5.1299               -4.5712                -3.1006             -1.4706    
          -2.1363               -1.4706             6.1826                -8.319               -7.6532                -6.1826             -1.4706    
          -2.2434               -1.4706             9.2647               -11.508               -10.735                -9.2647             -1.4706    
          -2.3654               -1.4706             12.347               -14.712               -13.817                -12.347             -1.4706    
          -2.4875               -1.4706             15.429               -17.916               -16.899                -15.429             -1.4706    
          -2.5645               -1.4706             18.511               -21.075               -19.981                -18.511             -1.4706    

      tab_ak_choices1       tab_ak_choices2    tab_ak_choices3       tab_ak_choices4        tab_ak_choices5      tab_ak_choices6      tab_ak_choices7
    ar_bwithrplusk_mesha    ar_aplusk_mesha      ar_k_mesha       ar_ameshk_tnext_with_r      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a  
    ____________________    _______________    _______________    ______________________    _______________    ___________________    _______________

           32.256               31.471            0.051471                 32.205                31.419                31.419                0       
           32.042               31.471              8.6127                 23.429                22.858                22.858                0       
           31.828               31.471              17.174                 14.654                14.297                14.297                0       
           31.614               31.471              25.735                 5.8787                5.7353                5.7353                0       
            31.36               31.471              34.297                -2.9366                -2.826                -2.826                0       
           31.041               31.471              42.858                -11.817               -11.387               -11.387                0       
           30.521               31.471              51.419                -20.898               -19.949               -19.949                0       
           34.366               33.529            0.053529                 34.313                33.476                33.476                0       
           34.144               33.529              8.9573                 25.186                24.572                24.572                0       
           33.921               33.529              17.861                  16.06                15.668                15.668                0       
           33.699               33.529              26.765                 6.9338                6.7647                6.7647                0       
           33.451               33.529              35.668                -2.2175                -2.139                -2.139                0       
           33.108               33.529              44.572                -11.464               -11.043               -11.043                0       
            32.58               33.529              53.476                -20.895               -19.946               -19.946                0       
           36.477               35.588            0.055588                 36.421                35.533                35.533                0       
           36.245               35.588              9.3018                 26.944                26.286                26.286                0       
           36.014               35.588              18.548                 17.466                 17.04                 17.04                0       
           35.783               35.588              27.794                  7.989                7.7941                7.7941                0       
           35.527               35.588               37.04                -1.5134               -1.4521               -1.4521                0       
           35.176               35.588              46.286                -11.111               -10.698               -10.698                0       
            34.64               35.588              55.533                -20.893               -19.944               -19.944                0       
           38.587               37.647            0.057647                 38.529                37.589                37.589                0       
           38.347               37.647              9.6463                 28.701                28.001                28.001                0       
           38.107               37.647              19.235                 18.872                18.412                18.412                0       
           37.868               37.647              28.824                 9.0441                8.8235                8.8235                0       
           37.618               37.647              38.412               -0.79423               -0.7651               -0.7651                0       
           37.243               37.647              48.001                -10.758               -10.354               -10.354                0       
           36.699               37.647              57.589                 -20.89               -19.942               -19.942                0       
           40.697               39.706            0.059706                 40.637                39.646                39.646                0       
           40.449               39.706              9.9908                 30.458                29.715                29.715                0       
             40.2               39.706              19.922                 20.279                19.784                19.784                0       
           39.952               39.706              29.853                 10.099                9.8529                9.8529                0       
           39.694               39.706              39.784              -0.090091             -0.078137             -0.078137                0       
           39.353               39.706              49.715                -10.362               -10.009               -10.009                0       
           38.759               39.706              59.646                -20.887                -19.94                -19.94                0       
           42.807               41.765            0.061765                 42.746                41.703                41.703                0       
            42.55               41.765              10.335                 32.215                31.429                31.429                0       
           42.294               41.765              20.609                 21.685                21.156                21.156                0       
           42.037               41.765              30.882                 11.154                10.882                10.882                0       
            41.78               41.765              41.156                0.62404               0.60882               0.60882                0       
           41.423               41.765              51.429                -10.006               -9.6647               -9.6647                0       
           40.818               41.765              61.703                -20.885               -19.938               -19.938                0       
           44.918               43.824            0.063824                 44.854                 43.76                 43.76                0       
           44.652               43.824               10.68                 33.972                33.144                33.144                0       
           44.387               43.824              21.296                 23.091                22.528                22.528                0       
           44.121               43.824              31.912                  12.21                11.912                11.912                0       
           43.856               43.824              42.528                 1.3282                1.2958                1.2958                0       
           43.491               43.824              53.144                -9.6532               -9.3202               -9.3202                0       
           42.878               43.824               63.76                -20.882               -19.936               -19.936                0       
           47.028               45.882            0.065882                 46.962                45.816                45.816                0       
           46.754               45.882              11.024                 35.729                34.858                34.858                0       
            46.48               45.882              21.983                 24.497                  23.9                  23.9                0       
           46.206               45.882              32.941                 13.265                12.941                12.941                0       
           45.932               45.882                43.9                 2.0323                1.9827                1.9827                0       
           45.558               45.882              54.858                -9.3001               -8.9757               -8.9757                0       
           44.937               45.882              65.816                -20.879               -19.934               -19.934                0       
           49.138               47.941            0.067941                  49.07                47.873                47.873                0       
           48.855               47.941              11.369                 37.487                36.572                36.572                0       
           48.573               47.941               22.67                 25.903                25.271                25.271                0       
            48.29               47.941              33.971                  14.32                13.971                13.971                0       
           48.008               47.941              45.271                 2.7364                2.6697                2.6697                0       
           47.625               47.941              56.572                 -8.947               -8.6312               -8.6312                0       
           46.997               47.941              67.873                -20.877               -19.932               -19.932                0       
           51.248                   50                0.07                 51.178                 49.93                 49.93                0       
           50.957                   50              11.713                 39.244                38.287                38.287                0       
           50.666                   50              23.357                 27.309                26.643                26.643                0       
           50.375                   50                  35                 15.375                    15                    15                0       
           50.084                   50              46.643                 3.4406                3.3567                3.3567                0       
           49.693                   50              58.287                -8.5938               -8.2867               -8.2867                0       
           49.056                   50               69.93                -20.874                -19.93                -19.93                0       

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   385    15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -25.556             -25.556             -25.556             -25.556              -25.556             -25.556             -25.556             -25.556             -25.556              -25.556             -25.556              -25.556              -25.556               -25.556             -25.556     
        -22.843             -22.837             -22.831             -22.823              -22.814             -22.804             -22.792             -22.779             -22.763              -22.745             -22.724                -22.7              -22.673               -22.641             -22.604     
        -22.689             -22.653             -22.611             -22.563              -22.507             -22.443             -22.368             -22.283             -22.184               -22.07             -21.938              -21.787              -21.612                -21.41             -21.177     
        -22.659             -22.612             -22.558             -22.496              -22.425             -22.342             -22.247             -22.137              -22.01              -21.864             -21.696              -21.501              -21.277               -21.018              -20.72     
        -22.655             -22.601             -22.539             -22.467              -22.384             -22.289             -22.179             -22.052             -21.905              -21.736             -21.541              -21.316              -21.057               -20.757             -20.412     
         -22.66               -22.6             -22.531             -22.451               -22.36             -22.254             -22.132             -21.991             -21.828              -21.641             -21.425              -21.175              -20.887               -20.555             -20.172     
        -22.663             -22.598             -22.524             -22.437              -22.338             -22.223             -22.091             -21.938             -21.762              -21.559             -21.325              -21.055              -20.743               -20.383             -19.968     
         -22.67             -22.601             -22.522             -22.429              -22.323             -22.201              -22.06             -21.897             -21.709              -21.492             -21.241              -20.953               -20.62               -20.236             -19.793     
        -20.157             -20.149             -20.141             -20.131               -20.12             -20.107             -20.092             -20.074             -20.054              -20.031             -20.004              -19.973              -19.938               -19.897              -19.85     
        -19.982             -19.935             -19.881             -19.819              -19.748             -19.665              -19.57              -19.46             -19.333              -19.187             -19.018              -18.823              -18.599                -18.34             -18.041     
        -19.983             -19.923             -19.854             -19.775              -19.683             -19.577             -19.455             -19.314             -19.151              -18.964             -18.747              -18.498               -18.21               -17.878             -17.495     
        -19.994             -19.925             -19.845             -19.753              -19.647             -19.524             -19.383              -19.22             -19.032              -18.815             -18.565              -18.276              -17.943               -17.559             -17.115     
        -20.032             -19.955             -19.867             -19.765              -19.647             -19.511             -19.354             -19.173             -18.965              -18.724             -18.447              -18.127              -17.757               -17.331              -16.84     
        -20.062             -19.979             -19.883             -19.772              -19.645             -19.498             -19.328             -19.132             -18.906              -18.645             -18.344              -17.998              -17.597               -17.136             -16.603     
        -20.112             -20.024             -19.921             -19.803              -19.667              -19.51             -19.328             -19.119             -18.878              -18.599             -18.278              -17.908              -17.481               -16.988             -16.419     
        -17.474             -17.465             -17.455             -17.444              -17.431             -17.416             -17.398             -17.378             -17.355              -17.328             -17.297              -17.261               -17.22               -17.173             -17.118     
        -17.303             -17.249             -17.187             -17.115              -17.032             -16.937             -16.826             -16.699             -16.552              -16.383             -16.188              -15.962              -15.703               -15.403             -15.057     
        -17.318             -17.248             -17.169             -17.076               -16.97             -16.848             -16.706             -16.543             -16.355              -16.138             -15.888              -15.599              -15.266               -14.881             -14.438     
         -17.37              -17.29             -17.197             -17.091              -16.968             -16.826             -16.663             -16.474             -16.256              -16.005             -15.716              -15.382              -14.996               -14.552             -14.039     
        -17.436             -17.347             -17.245             -17.127               -16.99             -16.833             -16.652             -16.443             -16.201              -15.923             -15.602              -15.231              -14.804               -14.311             -13.742     
        -17.496             -17.399             -17.288              -17.16              -17.013             -16.842             -16.646             -16.419             -16.158              -15.856             -15.508              -15.107              -14.644               -14.109             -13.493     
        -17.576             -17.473             -17.355             -17.218               -17.06             -16.878             -16.669             -16.427             -16.147              -15.825             -15.454              -15.025              -14.531                -13.96             -13.302     
        -14.792             -14.782             -14.771             -14.759              -14.744             -14.728             -14.708             -14.686              -14.66               -14.63             -14.596              -14.556              -14.511               -14.458             -14.397     
         -14.63              -14.57             -14.501             -14.422               -14.33             -14.224             -14.101              -13.96             -13.797               -13.61             -13.393              -13.143              -12.855               -12.523             -12.139     
        -14.679             -14.602             -14.514             -14.412              -14.294             -14.158             -14.001              -13.82             -13.611              -13.371             -13.093              -12.773              -12.403               -11.977             -11.485     
         -14.76             -14.671             -14.568              -14.45              -14.314             -14.157             -13.975             -13.766             -13.525              -13.246             -12.925              -12.554              -12.127               -11.634             -11.065     
         -14.84             -14.742             -14.628             -14.497              -14.346             -14.172             -13.971             -13.739             -13.471              -13.162             -12.806              -12.395              -11.921               -11.374             -10.744     
        -14.946             -14.839             -14.716             -14.574               -14.41             -14.221             -14.003             -13.752             -13.462              -13.127             -12.741              -12.296              -11.782                -11.19             -10.507     
        -15.072             -14.959             -14.827             -14.675              -14.501             -14.299             -14.066             -13.798             -13.488              -13.131             -12.719              -12.243              -11.695               -11.062             -10.333     
        -12.111             -12.101             -12.089             -12.075              -12.059             -12.041              -12.02             -11.996             -11.968              -11.936             -11.899              -11.856              -11.806               -11.749             -11.684     
        -11.957             -11.892             -11.818             -11.731              -11.632             -11.517             -11.384             -11.231             -11.055              -10.851             -10.617              -10.346              -10.034               -9.6734             -9.2577     
        -12.033              -11.95             -11.854             -11.743              -11.615             -11.468             -11.298             -11.102             -10.876              -10.615             -10.314              -9.9671              -9.5667               -9.1048             -8.5719     
        -12.143             -12.047             -11.936             -11.808               -11.66             -11.489             -11.293             -11.066             -10.805              -10.503             -10.155              -9.7532                -9.29               -8.7557             -8.1393     
        -12.269             -12.163              -12.04             -11.898              -11.734             -11.545             -11.327             -11.075             -10.785              -10.451             -10.065              -9.6195              -9.1058               -8.5133             -7.8298     
        -12.421             -12.305             -12.172             -12.018              -11.841             -11.636               -11.4             -11.127             -10.813              -10.451             -10.032              -9.5499              -8.9933               -8.3513             -7.6107     
        -12.595             -12.471             -12.329             -12.165              -11.975             -11.757             -11.504             -11.213             -10.878              -10.491             -10.044              -9.5291              -8.9348               -8.2493             -7.4585     
        -9.4308             -9.4198             -9.4072             -9.3926              -9.3757             -9.3563             -9.3339             -9.3081             -9.2782              -9.2438             -9.2042              -9.1584              -9.1056               -9.0447             -8.9744     
        -9.2884             -9.2191             -9.1392              -9.047              -8.9406             -8.8179             -8.6764             -8.5131             -8.3247              -8.1075             -7.8568              -7.5677              -7.2342               -6.8495             -6.4056     
        -9.4069              -9.318             -9.2156             -9.0973               -8.961             -8.8037             -8.6222             -8.4129             -8.1714              -7.8929             -7.5716              -7.2009              -6.7733               -6.2801             -5.7111     
        -9.5469             -9.4442             -9.3256             -9.1889              -9.0312             -8.8492             -8.6393             -8.3972             -8.1179              -7.7957              -7.424              -6.9952              -6.5006                 -5.93             -5.2718     
        -9.7198             -9.6058             -9.4744             -9.3228              -9.1479             -8.9461             -8.7133             -8.4448             -8.1351              -7.7778             -7.3656              -6.8901              -6.3417               -5.7089             -4.9791     
        -9.9186             -9.7951             -9.6527             -9.4884              -9.2989             -9.0802              -8.828             -8.5371             -8.2015              -7.8143             -7.3677              -6.8525              -6.2582               -5.5727             -4.7819     
         -10.08              -9.948             -9.7959             -9.6205              -9.4181             -9.1847             -8.9154             -8.6047             -8.2464               -7.833             -7.3561              -6.8061              -6.1715               -5.4395              -4.595     
         -6.751             -6.7394             -6.7261             -6.7106              -6.6928             -6.6723             -6.6486             -6.6213             -6.5898              -6.5534             -6.5115              -6.4631              -6.4073               -6.3429             -6.2686     
        -6.6223             -6.5491             -6.4646             -6.3671              -6.2547              -6.125             -5.9754             -5.8028             -5.6037               -5.374             -5.1091              -4.8035              -4.4509               -4.0442             -3.5751     
        -6.7695             -6.6756             -6.5673             -6.4423              -6.2982             -6.1319             -5.9401             -5.7188             -5.4636              -5.1691             -4.8295              -4.4377              -3.9857               -3.4643             -2.8628     
        -6.9704             -6.8617             -6.7365             -6.5919              -6.4252             -6.2328              -6.011              -5.755             -5.4598              -5.1192             -4.7263               -4.273              -3.7502               -3.1471             -2.4513     
         -7.145             -7.0246             -6.8856             -6.7254              -6.5405             -6.3272             -6.0811             -5.7973             -5.4699              -5.0922             -4.6565              -4.1539              -3.5741               -2.9053             -2.1338     
        -7.3762             -7.2457             -7.0952             -6.9215              -6.7211               -6.49             -6.2234             -5.9159             -5.5611              -5.1519             -4.6798              -4.1352               -3.507               -2.7824             -1.9464     
        -7.5703              -7.431             -7.2702             -7.0848              -6.8709             -6.6241             -6.3394             -6.0111             -5.6323              -5.1953             -4.6912              -4.1097               -3.439               -2.6652             -1.7726     
        -4.0716             -4.0595             -4.0454             -4.0292              -4.0106              -3.989             -3.9642             -3.9355             -3.9024              -3.8643             -3.8203              -3.7695              -3.7109               -3.6434             -3.5655     
        -3.9735             -3.8967              -3.808             -3.7058              -3.5878             -3.4517             -3.2947             -3.1137             -2.9048              -2.6638             -2.3858              -2.0651              -1.6952               -1.2685            -0.77624     
        -4.1351             -4.0365             -3.9229             -3.7918              -3.6405             -3.4661             -3.2648             -3.0326             -2.7648              -2.4559             -2.0995              -1.6884              -1.2141              -0.66707            -0.03598     
        -4.3672             -4.2532             -4.1217             -3.9701              -3.7951             -3.5933             -3.3605             -3.0919             -2.7822              -2.4248             -2.0125               -1.537             -0.98841              -0.35558             0.37442     
         -4.619             -4.4926             -4.3468             -4.1786              -3.9846             -3.7608             -3.5027             -3.2049             -2.8613              -2.4651             -2.0079              -1.4806             -0.87222              -0.17047             0.63904     
        -4.8379              -4.701              -4.543             -4.3608              -4.1506             -3.9081             -3.6284             -3.3057             -2.9334              -2.5041             -2.0087              -1.4373             -0.77818             -0.017808             0.85932     
        -5.1101             -4.9639             -4.7952             -4.6007              -4.3762             -4.1173             -3.8186             -3.4741             -3.0766              -2.6181             -2.0892              -1.4791             -0.77532              0.036569             0.97314     
        -1.3925             -1.3798             -1.3652             -1.3483              -1.3288             -1.3063             -1.2804             -1.2505              -1.216              -1.1762             -1.1303              -1.0773              -1.0162              -0.94572            -0.86441     
        -1.3116             -1.2314             -1.1389             -1.0322             -0.90913            -0.76715            -0.60337            -0.41444            -0.19649             0.054921             0.34494               0.6795               1.0654                1.5106              2.0242     
        -1.5179             -1.4151             -1.2966             -1.1598               -1.002            -0.81996            -0.60999            -0.36777           -0.088351              0.23397              0.6058               1.0347               1.5295                2.1003              2.7587     
        -1.7666             -1.6477             -1.5106             -1.3523              -1.1698            -0.95926            -0.71637            -0.43619            -0.11297              0.25987             0.68997               1.1861               1.7585                2.4187              3.1803     
        -2.0509             -1.9191              -1.767             -1.5915              -1.3891             -1.1556            -0.88626            -0.57556            -0.21714              0.19631             0.67326               1.2235               1.8581                2.5903              3.4349     
        -2.3478             -2.2049             -2.0401               -1.85              -1.6307             -1.3777             -1.0859            -0.74922            -0.36087             0.087126             0.60391               1.2001               1.8878                2.6811              3.5962     
        -2.6084             -2.4558             -2.2799             -2.0769              -1.8427             -1.5726             -1.2609            -0.90147             -0.4868           -0.0084569             0.54335               1.1799               1.9142                2.7612              3.7384     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         32.815              32.833              32.854              32.879              32.907              32.939              32.977               33.02               33.07              33.127               33.194                33.27               33.359                33.46               33.578      
         32.551              32.667                32.8              32.954              33.132              33.337              33.574              33.847              34.162              34.525               34.944               35.427               35.985               36.628                37.37      
         31.865              32.013              32.184              32.382               32.61              32.873              33.176              33.526               33.93              34.395               34.932               35.552               36.267               37.091               38.042      
         31.117              31.289              31.487              31.716              31.979              32.284              32.634              33.039              33.506              34.045               34.666               35.383               36.209               37.163               38.263      
           30.3              30.491               30.71              30.964              31.256              31.593              31.983              32.431              32.949              33.546               34.235                35.03               35.947               37.005               38.225      
           29.4              29.606              29.844              30.119              30.436              30.801              31.223              31.709               32.27              32.917               33.664               34.525               35.518               36.664               37.986      
         28.286              28.506              28.761              29.054              29.392              29.782              30.233              30.752              31.351              32.042               32.839               33.758               34.819               36.043               37.454      
         34.927              34.945              34.967              34.992               35.02              35.053              35.091              35.135              35.185              35.244               35.311               35.389               35.478               35.581                 35.7      
         34.636              34.753              34.889              35.045              35.225              35.433              35.673               35.95              36.269              36.638               37.063               37.553               38.118               38.771               39.523      
         33.917              34.067              34.241              34.441              34.672              34.939              35.247              35.602              36.011              36.483               37.028               37.656               38.381               39.218               40.182      
         33.135               33.31              33.511              33.742               34.01              34.318              34.674              35.085              35.558              36.104               36.735               37.461                 38.3               39.267               40.383      
         32.299              32.492              32.715              32.972              33.269              33.611              34.005              34.461              34.986              35.591                36.29               37.096               38.026               39.099               40.336      
         31.349              31.559                31.8              32.079                32.4              32.771              33.198              33.691               34.26              34.917               35.674               36.547               37.555               38.717               40.058      
         30.201              30.425              30.683               30.98              31.323              31.719              32.176              32.702               33.31              34.011               34.819               35.752               36.827               38.068                 39.5      
         37.039              37.057              37.079              37.104              37.133              37.167              37.205              37.249              37.301               37.36               37.428               37.507               37.597               37.702               37.823      
          36.72              36.839              36.977              37.135              37.318              37.529              37.772              38.053              38.376               38.75                39.18               39.677                40.25               40.912               41.674      
         35.968              36.121              36.297                36.5              36.734              37.005              37.317              37.676              38.091               38.57               39.122               39.759               40.494               41.342               42.319      
         35.153               35.33              35.533              35.768              36.039              36.352              36.713              37.129              37.609              38.163               38.801               39.538               40.388               41.369                 42.5      
         34.283              34.478              34.704              34.965              35.265              35.612              36.012              36.474              37.006               37.62               38.328               39.145               40.088               41.175                42.43      
         33.298               33.51              33.755              34.037              34.363              34.739              35.172              35.672              36.249              36.914               37.682               38.567               39.589               40.767               42.126      
         32.116              32.343              32.604              32.906              33.253              33.655              34.117              34.651              35.267              35.977               36.797               37.742               38.833               40.091               41.542      
          39.15              39.169              39.191              39.217              39.246               39.28              39.319              39.364              39.416              39.476               39.545               39.624               39.716               39.822               39.945      
         38.805              38.925              39.064              39.225               39.41              39.624               39.87              40.155              40.482              40.861               41.297               41.801               42.381               43.051               43.824      
         38.019              38.174              38.353              38.558              38.796               39.07              39.386               39.75               40.17              40.655               41.215                41.86               42.605               43.464               44.454      
          37.17              37.349              37.556              37.794              38.069              38.385              38.751              39.172              39.659               40.22               40.867               41.613               42.475               43.468               44.614      
         36.281              36.479              36.708              36.972              37.276              37.628              38.033              38.501               39.04              39.662                40.38               41.207               42.163               43.264               44.535      
         35.247              35.462               35.71              35.996              36.326              36.706              37.146              37.652              38.236              38.911               39.688               40.585                41.62               42.814               44.191      
         34.031               34.26              34.525               34.83              35.183              35.589              36.058              36.599              37.223              37.943               38.773               39.731               40.836                42.11               43.581      
         41.262              41.281              41.304              41.329              41.359              41.393              41.433              41.478              41.531              41.592               41.661               41.742               41.835               41.943               42.067      
         40.889              41.011              41.152              41.314              41.502              41.718              41.968              42.256              42.588              42.971               43.413               43.923               44.511               45.189               45.972      
          40.07              40.227              40.408              40.616              40.857              41.134              41.454              41.823              42.249               42.74               43.307                43.96               44.714               45.584               46.587      
         39.187              39.369              39.578              39.819              40.097              40.418              40.788              41.215              41.707              42.276               42.931               43.687               44.559               45.565               46.726      
         38.263              38.464              38.696              38.963              39.272              39.628              40.038              40.511              41.058              41.688               42.414               43.253                44.22               45.336               46.623      
         37.237              37.455              37.706              37.996               38.33              38.715               39.16              39.673              40.265              40.948               41.735               42.644               43.692                 44.9               46.295      
         35.944              36.177              36.445              36.754              37.111              37.523              37.998              38.546              39.177              39.906               40.747               41.717               42.836               44.127               45.616      
         43.373              43.393              43.416              43.442              43.472              43.506              43.546              43.593              43.646              43.707               43.778                43.86               43.954               44.063               44.188      
         42.973              43.096              43.239              43.404              43.593              43.812              44.065              44.356              44.693              45.081               45.528               46.044               46.639               47.326               48.118      
         42.121               42.28              42.463              42.674              42.917              43.198              43.522              43.895              44.326              44.823               45.397               46.059               46.822               47.702               48.718      
         41.204              41.388              41.599              41.843              42.125               42.45              42.824              43.256              43.755               44.33               44.994               45.759               46.642                47.66               48.835      
         40.256              40.459              40.694              40.964              41.276              41.637              42.052              42.531              43.084              43.722               44.458               45.306               46.285               47.415               48.718      
         39.187              39.408              39.662              39.955              40.294              40.684              41.134              41.653              42.252              42.943               43.741                44.66               45.721               46.945               48.356      
         37.858              38.093              38.365              38.678              39.039              39.456              39.936              40.491              41.131              41.868                42.72               43.702               44.834               46.141               47.648      
         45.485              45.505              45.528              45.554              45.585               45.62               45.66              45.707              45.761              45.823               45.894               45.977               46.072               46.182               46.309      
         45.056              45.181              45.326              45.492              45.684              45.906              46.162              46.457              46.797              47.189               47.642               48.164               48.766               49.461               50.263      
         44.171              44.332              44.517              44.731              44.977              45.261              45.589              45.967              46.403              46.906               47.486               48.156               48.928               49.819               50.847      
         43.221              43.406               43.62              43.867              44.152              44.481               44.86              45.297              45.802              46.384               47.055               47.829               48.723               49.753               50.942      
         42.238              42.443              42.681              42.955              43.271              43.635              44.055               44.54                45.1              45.745                46.49               47.348               48.339               49.482                 50.8      
         41.135              41.358              41.615              41.912              42.254              42.649              43.104               43.63              44.236              44.935               45.742               46.673               47.746               48.984               50.413      
         39.771              40.009              40.284              40.601              40.966              41.388              41.874              42.435              43.083              43.829                44.69               45.684                46.83               48.152               49.677      
         47.597              47.617               47.64              47.666              47.697              47.733              47.774              47.821              47.875              47.938               48.011               48.094               48.191               48.302                48.43      
          47.14              47.266              47.412              47.581              47.775              47.999              48.258              48.556                48.9              49.297               49.755               50.283               50.893               51.596               52.406      
         46.222              46.384              46.571              46.787              47.036              47.324              47.655              48.038              48.479              48.988               49.575               50.252               51.033               51.934               52.974      
         45.237              45.424              45.641              45.891              46.179              46.511              46.895              47.337              47.847              48.436               49.115               49.898               50.802               51.844               53.047      
         44.219              44.427              44.667              44.945              45.264              45.633              46.058              46.548              47.114              47.767                48.52               49.389               50.391               51.547                52.88      
         43.082              43.307              43.568              43.868              44.214              44.613              45.074              45.606              46.219              46.926               47.742               48.683               49.769               51.021               52.466      
         41.684              41.925              42.202              42.523              42.893              43.319              43.811              44.379              45.033              45.789                46.66               47.665               48.824               50.161               51.704      
         49.708              49.728              49.752              49.779               49.81              49.846              49.887              49.935               49.99              50.054               50.127               50.211               50.309               50.421               50.551      
         49.223              49.351              49.499              49.669              49.866              50.092              50.354              50.655              51.003              51.405               51.868               52.402               53.018               53.728               54.548      
         48.272              48.436              48.625              48.843              49.095              49.386              49.721              50.108              50.554              51.068               51.662               52.347               53.136               54.048               55.099      
         47.252              47.442              47.661              47.914              48.205              48.541              48.929              49.376              49.892              50.488               51.174               51.966                52.88               53.934                55.15      
         46.201              46.411              46.654              46.934              47.257               47.63               48.06              48.556              49.128              49.788               50.549               51.428               52.441                53.61               54.958      
         45.028              45.257               45.52              45.823              46.173              46.577              47.043               47.58                48.2              48.916               49.741               50.692                51.79               53.056               54.517      
         43.596               43.84              44.121              44.445              44.819               45.25              45.747              46.321              46.983              47.747               48.628               49.644               50.816               52.168               53.728      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.306              51.436              51.585              51.757              51.956              52.185              52.449              52.754              53.106              53.511               53.979               54.519               55.142                55.86               56.689      
         50.321              50.487              50.679              50.899              51.154              51.448              51.786              52.177              52.628              53.148               53.748                54.44               55.239                56.16               57.222      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         48.182              48.394               48.64              48.923               49.25              49.626              50.061              50.562              51.141              51.808               52.577               53.465               54.489               55.671               57.034      
         46.975              47.205              47.471              47.778              48.132               48.54              49.011              49.554              50.181              50.904               51.738                 52.7               53.809                55.09               56.566      
         45.508              45.754              46.038              46.366              46.744               47.18              47.682              48.263              48.932              49.704               50.594               51.621               52.806               54.173                55.75      

</pre><h2 id="15">COH2: Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));
</pre><h2 id="16">COH3: Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="17">COH4: Select only Valid (k(w), a) choices</h2><pre class="codeinput"><span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);
</pre><h2 id="18">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>

<span class="comment">% This is borrowing with default or not condition</span>
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);
</pre><h2 id="19">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>
</pre><h2 id="20">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="21">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="22">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</h2><p>ar_a_meshk is t: b ar_ameshk_tnext_with_r is t+1: b*(1+r) with for inf</p><pre class="codeinput">armt_map(<span class="string">'ar_coh_bridge_perc'</span>) = ar_coh_bridge_perc;
armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_ameshk_tnext_with_r'</span>) = ar_ameshk_tnext_with_r;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_z_mesh_coh_wkb'</span>) = mt_z_mesh_coh_wkb;
</pre><h2 id="23">Store armt_map (2): First Stage Aggregate Savings</h2><p>w = k' + b', w is aggregate Savings%</p><div><ol><li><b>ar_w_perc</b> 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li><b>ar_w_level</b> 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li><b>mt_w_by_interp_coh_interp_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'ar_w_level_full'</span>) = ar_w_level_full;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>) = mt_w_by_interp_coh_interp_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;
</pre><h2 id="24">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</h2><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
armt_map(<span class="string">'mt_z_mesh_coh_interp_grid'</span>) = mt_z_mesh_coh_interp_grid;
</pre><h2 id="25">Store armt_map (4): Shock Grids</h2><pre class="codeinput">armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
armt_map(<span class="string">'ar_stationary'</span>) = ar_stationary;
armt_map(<span class="string">'ar_z'</span>) = ar_z;
</pre><h2 id="26">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="27">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="29">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><p>Plot end because earlier parts have repeating w and a levels due to potentially bridge which are coh percentage dependent. This will only plot out the grid basically when coh percentage for bridge loan = 0</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 mt_k(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 <span class="string">'blue'</span>);

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
    scatter(ar_a_meshk(it_col_start:it_col_end), <span class="keyword">...</span>
            ar_k_mesha(it_col_start:it_col_end), <span class="keyword">...</span>
            3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                                     ar_k_mesha_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title({<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span><span class="keyword">...</span>
           <span class="string">'(Bridge Borrow Share = 0)'</span>})
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_01.png" alt=""> <h2 id="30">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
        <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
        <span class="string">'For each w and z, coh maximizing k is different'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

    legendCell{length(legendCell) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_02.png" alt=""> <img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_03.png" alt=""> <h2 id="31">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_04.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="33">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="35">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_05.png" alt=""> <h2 id="36">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_06.png" alt=""> <img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_07.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="38">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z));
    disp(ar_z);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_coh_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_coh_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_c_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_c_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_interp_coh_grid_mesh_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_a'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_a_meshk'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_a_meshk));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_k'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_k_mesha'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    <span class="keyword">for</span> i = 1:length(func_map)
        st_display = strjoin([<span class="string">'pos ='</span> num2str(i) <span class="string">'; key ='</span> string(param_map_keys{i}) <span class="string">'; val ='</span> func2str(param_map_vals{i})]);
        disp(st_display);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    55

  Columns 1 through 7

  -20.0000  -17.9412  -15.8824  -13.8235  -11.7647   -9.7059   -7.6471

  Columns 8 through 14

   -5.5882   -3.5294   -1.4706  -20.0000  -17.9412  -15.8824  -13.8235

  Columns 15 through 21

  -11.7647   -9.7059   -7.6471   -5.5882   -3.5294   -1.4706  -20.0000

  Columns 22 through 28

  -17.9412  -15.8824  -13.8235  -11.7647   -9.7059   -7.6471   -5.5882

  Columns 29 through 35

   -3.5294   -1.4706    0.5882    2.6471    4.7059    6.7647    8.8235

  Columns 36 through 42

   10.8824   12.9412   15.0000   17.0588   19.1176   21.1765   23.2353

  Columns 43 through 49

   25.2941   27.3529   29.4118   31.4706   33.5294   35.5882   37.6471

  Columns 50 through 55

   39.7059   41.7647   43.8235   45.8824   47.9412   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    38

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.992                             -19.99                            -19.987                            -19.985                            -19.983                            -19.981                             -19.979                              -19.977                            -19.975                             -19.973                             -19.971                             -19.969                             -19.967                             -19.965                             -19.962                               -19.96                            -19.958                             -19.956                             -19.954                             -19.952                              -19.95                             -19.948                             -19.946                             -19.944                              -19.942                            -19.939                             -19.937                             -19.935                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.651                            -19.301                            -18.952                            -18.603                            -18.253                            -17.904                            -17.554                            -17.205                            -16.856                             -16.506                              -16.157                            -15.808                             -15.458                             -15.109                             -14.759                              -14.41                             -14.061                             -13.711                              -13.362                            -13.013                             -12.663                             -12.314                             -11.965                             -11.615                             -11.266                             -10.916                             -10.567                              -10.218                            -9.8683                              -9.519                             -9.1696                             -8.8202                             -8.4709                             -8.1215                             -7.7721                             -7.4228                             -7.0734             
                  -20                              -19.303                            -18.607                             -17.91                            -17.213                            -16.517                             -15.82                            -15.123                            -14.427                             -13.73                             -13.034                              -12.337                             -11.64                             -10.944                             -10.247                             -9.5503                             -8.8536                              -8.157                             -7.4603                              -6.7637                             -6.067                             -5.3704                             -4.6738                             -3.9771                             -3.2805                             -2.5838                             -1.8872                             -1.1905                             -0.49387                            0.20278                             0.89943                              1.5961                              2.2927                              2.9894                               3.686                              4.3827                              5.0793                               5.776             
                  -20                              -18.956                            -17.912                            -16.868                            -15.824                             -14.78                            -13.736                            -12.693                            -11.649                            -10.605                             -9.5607                              -8.5168                            -7.4729                             -6.4289                              -5.385                             -4.3411                             -3.2972                             -2.2532                             -1.2093                             -0.16538                            0.87855                              1.9225                              2.9664                              4.0103                              5.0543                              6.0982                              7.1421                               8.186                                 9.23                             10.274                              11.318                              12.362                              13.406                               14.45                              15.494                              16.537                              17.581                              18.625             
                  -20                              -18.609                            -17.218                            -15.826                            -14.435                            -13.044                            -11.653                            -10.262                            -8.8703                            -7.4791                             -6.0879                              -4.6967                            -3.3055                             -1.9143                             -0.5231                             0.86811                              2.2593                              3.6505                              5.0417                               6.4329                             7.8241                              9.2154                              10.607                              11.998                              13.389                               14.78                              16.171                              17.563                               18.954                             20.345                              21.736                              23.127                              24.519                               25.91                              27.301                              28.692                              30.083                              31.475             
                  -20                              -18.262                            -16.523                            -14.785                            -13.046                            -11.308                            -9.5691                            -7.8306                            -6.0921                            -4.3536                             -2.6151                             -0.87664                            0.86185                              2.6003                              4.3388                              6.0773                              7.8158                              9.5543                              11.293                               13.031                              14.77                              16.508                              18.247                              19.985                              21.724                              23.462                              25.201                              26.939                               28.678                             30.416                              32.155                              33.893                              35.632                               37.37                              39.109                              40.847                              42.586                              44.324             
                  -20                              -17.914                            -15.828                            -13.743                            -11.657                            -9.5712                            -7.4854                            -5.3996                            -3.3139                            -1.2281                             0.85767                               2.9434                             5.0292                               7.115                              9.2007                              11.287                              13.372                              15.458                              17.544                                19.63                             21.715                              23.801                              25.887                              27.973                              30.058                              32.144                               34.23                              36.316                               38.401                             40.487                              42.573                              44.659                              46.745                               48.83                              50.916                              53.002                              55.088                              57.173             

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.992                             -19.99                            -19.987                            -19.985                            -19.983                            -19.981                             -19.979                              -19.977                            -19.975                             -19.973                             -19.971                             -19.969                             -19.967                             -19.965                             -19.962                               -19.96                            -19.958                             -19.956                             -19.954                             -19.952                              -19.95                             -19.948                             -19.946                             -19.944                              -19.942                            -19.939                             -19.937                             -19.935                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.651                            -19.301                            -18.952                            -18.603                            -18.253                            -17.904                            -17.554                            -17.205                            -16.856                             -16.506                              -16.157                            -15.808                             -15.458                             -15.109                             -14.759                              -14.41                             -14.061                             -13.711                              -13.362                            -13.013                             -12.663                             -12.314                             -11.965                             -11.615                             -11.266                             -10.916                             -10.567                              -10.218                            -9.8683                              -9.519                             -9.1696                             -8.8202                             -8.4709                             -8.1215                             -7.7721                             -7.4228                             -7.0734             
                  -20                              -19.303                            -18.607                             -17.91                            -17.213                            -16.517                             -15.82                            -15.123                            -14.427                             -13.73                             -13.034                              -12.337                             -11.64                             -10.944                             -10.247                             -9.5503                             -8.8536                              -8.157                             -7.4603                              -6.7637                             -6.067                             -5.3704                             -4.6738                             -3.9771                             -3.2805                             -2.5838                             -1.8872                             -1.1905                             -0.49387                            0.20278                             0.89943                              1.5961                              2.2927                              2.9894                               3.686                              4.3827                              5.0793                               5.776             
                  -20                              -18.956                            -17.912                            -16.868                            -15.824                             -14.78                            -13.736                            -12.693                            -11.649                            -10.605                             -9.5607                              -8.5168                            -7.4729                             -6.4289                              -5.385                             -4.3411                             -3.2972                             -2.2532                             -1.2093                             -0.16538                            0.87855                              1.9225                              2.9664                              4.0103                              5.0543                              6.0982                              7.1421                               8.186                                 9.23                             10.274                              11.318                              12.362                              13.406                               14.45                              15.494                              16.537                              17.581                              18.625             
                  -20                              -18.609                            -17.218                            -15.826                            -14.435                            -13.044                            -11.653                            -10.262                            -8.8703                            -7.4791                             -6.0879                              -4.6967                            -3.3055                             -1.9143                             -0.5231                             0.86811                              2.2593                              3.6505                              5.0417                               6.4329                             7.8241                              9.2154                              10.607                              11.998                              13.389                               14.78                              16.171                              17.563                               18.954                             20.345                              21.736                              23.127                              24.519                               25.91                              27.301                              28.692                              30.083                              31.475             
                  -20                              -18.262                            -16.523                            -14.785                            -13.046                            -11.308                            -9.5691                            -7.8306                            -6.0921                            -4.3536                             -2.6151                             -0.87664                            0.86185                              2.6003                              4.3388                              6.0773                              7.8158                              9.5543                              11.293                               13.031                              14.77                              16.508                              18.247                              19.985                              21.724                              23.462                              25.201                              26.939                               28.678                             30.416                              32.155                              33.893                              35.632                               37.37                              39.109                              40.847                              42.586                              44.324             
                  -20                              -17.914                            -15.828                            -13.743                            -11.657                            -9.5712                            -7.4854                            -5.3996                            -3.3139                            -1.2281                             0.85767                               2.9434                             5.0292                               7.115                              9.2007                              11.287                              13.372                              15.458                              17.544                                19.63                             21.715                              23.801                              25.887                              27.973                              30.058                              32.144                               34.23                              36.316                               38.401                             40.487                              42.573                              44.659                              46.745                               48.83                              50.916                              53.002                              55.088                              57.173             

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

       0.26016        0.26831        0.25551        0.14921       0.053403      0.011702       0.0015678     0.00012823     6.3911e-06      1.9381e-07      3.5701e-09      3.9889e-11      2.7001e-13      1.1102e-15               0 
       0.11232        0.19622         0.2763        0.23861        0.12635      0.040998       0.0081429     0.00098855     7.3236e-05      3.3054e-06      9.0736e-08      1.5125e-09      1.5289e-11      9.3592e-14      3.3307e-16 
      0.037073        0.10492         0.2185        0.27902         0.2185       0.10492        0.030863      0.0055558     0.00061112      4.1008e-05      1.6758e-06       4.164e-08      6.2811e-10      5.7438e-12      3.1863e-14 
     0.0092081       0.040998        0.12635        0.23861         0.2763       0.19622        0.085427       0.022782      0.0037167       0.0003704      2.2511e-05      8.3291e-07      1.8732e-08      2.5567e-10      2.1255e-12 
     0.0017026       0.011702       0.053403        0.14921        0.25551       0.26831         0.17279       0.068209       0.016489       0.0024379       0.0002201      1.2114e-05       4.058e-07      8.2598e-09      1.0277e-10 
    0.00023263      0.0024379       0.016489       0.068209        0.17279       0.26831         0.25551        0.14921       0.053403        0.011702       0.0015678      0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427       0.19622          0.2763        0.23861        0.12635        0.040998       0.0081429      0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863       0.10492          0.2185        0.27902         0.2185         0.10492        0.030863       0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429      0.040998         0.12635        0.23861         0.2763         0.19622        0.085427        0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678      0.011702        0.053403        0.14921        0.25551         0.26831         0.17279        0.068209        0.016489       0.0024379      0.00023263 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

    0.00023263      0.0024379       0.016489       0.068209        0.17279        0.26831        0.25551        0.14921       0.053403       0.011702       0.0015678       0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622         0.2763        0.23861        0.12635       0.040998       0.0081429       0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492         0.2185        0.27902         0.2185        0.10492        0.030863        0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998        0.12635        0.23861         0.2763        0.19622        0.085427         0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702       0.053403        0.14921        0.25551        0.26831         0.17279         0.068209        0.016489       0.0024379      0.00023263 
    1.0277e-10     8.2598e-09      4.058e-07     1.2114e-05      0.0002201      0.0024379       0.016489       0.068209        0.17279        0.26831         0.25551          0.14921        0.053403        0.011702       0.0017026 
    2.1256e-12     2.5567e-10     1.8732e-08     8.3291e-07     2.2511e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622          0.2763          0.23861         0.12635        0.040998       0.0092081 
    3.1909e-14     5.7438e-12     6.2811e-10      4.164e-08     1.6758e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492          0.2185          0.27902          0.2185         0.10492        0.037073 
     3.474e-16     9.3597e-14     1.5289e-11     1.5125e-09     9.0736e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998         0.12635          0.23861          0.2763         0.19622         0.11232 
    2.7412e-18     1.1057e-15     2.6998e-13     3.9889e-11     3.5701e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702        0.053403          0.14921         0.25551         0.26831         0.26016 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_coh_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 38&times;1 double

        Values:

            Min          -20
            Median    18.625
            Max       57.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_c_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 772496&times;1 double

        Values:

            Min        0.001
            Median    38.626
            Max       77.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_interp_coh_grid_mesh_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    38    15

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

                 -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                            -20                            -20                            -20                            -20                            -20                            -20          
             -17.912                       -17.912                       -17.912                       -17.912                       -17.912                       -17.912                       -17.912                       -17.912                       -17.912                        -17.912                        -17.912                        -17.912                        -17.912                        -17.912                        -17.912          
             -15.824                       -15.824                       -15.824                       -15.824                       -15.824                       -15.824                       -15.824                       -15.824                       -15.824                        -15.824                        -15.824                        -15.824                        -15.824                        -15.824                        -15.824          
             -13.736                       -13.736                       -13.736                       -13.736                       -13.736                       -13.736                       -13.736                       -13.736                       -13.736                        -13.736                        -13.736                        -13.736                        -13.736                        -13.736                        -13.736          
             -11.649                       -11.649                       -11.649                       -11.649                       -11.649                       -11.649                       -11.649                       -11.649                       -11.649                        -11.649                        -11.649                        -11.649                        -11.649                        -11.649                        -11.649          
             -9.5607                       -9.5607                       -9.5607                       -9.5607                       -9.5607                       -9.5607                       -9.5607                       -9.5607                       -9.5607                        -9.5607                        -9.5607                        -9.5607                        -9.5607                        -9.5607                        -9.5607          
             -7.4729                       -7.4729                       -7.4729                       -7.4729                       -7.4729                       -7.4729                       -7.4729                       -7.4729                       -7.4729                        -7.4729                        -7.4729                        -7.4729                        -7.4729                        -7.4729                        -7.4729          
              -5.385                        -5.385                        -5.385                        -5.385                        -5.385                        -5.385                        -5.385                        -5.385                        -5.385                         -5.385                         -5.385                         -5.385                         -5.385                         -5.385                         -5.385          
             -3.2972                       -3.2972                       -3.2972                       -3.2972                       -3.2972                       -3.2972                       -3.2972                       -3.2972                       -3.2972                        -3.2972                        -3.2972                        -3.2972                        -3.2972                        -3.2972                        -3.2972          
             -1.2093                       -1.2093                       -1.2093                       -1.2093                       -1.2093                       -1.2093                       -1.2093                       -1.2093                       -1.2093                        -1.2093                        -1.2093                        -1.2093                        -1.2093                        -1.2093                        -1.2093          

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

               38.46                         38.46                         38.46                         38.46                         38.46                         38.46                         38.46                         38.46                         38.46                         38.46                          38.46                          38.46                          38.46                          38.46                          38.46           
              40.548                        40.548                        40.548                        40.548                        40.548                        40.548                        40.548                        40.548                        40.548                        40.548                         40.548                         40.548                         40.548                         40.548                         40.548           
              42.636                        42.636                        42.636                        42.636                        42.636                        42.636                        42.636                        42.636                        42.636                        42.636                         42.636                         42.636                         42.636                         42.636                         42.636           
              44.723                        44.723                        44.723                        44.723                        44.723                        44.723                        44.723                        44.723                        44.723                        44.723                         44.723                         44.723                         44.723                         44.723                         44.723           
              46.811                        46.811                        46.811                        46.811                        46.811                        46.811                        46.811                        46.811                        46.811                        46.811                         46.811                         46.811                         46.811                         46.811                         46.811           
              48.899                        48.899                        48.899                        48.899                        48.899                        48.899                        48.899                        48.899                        48.899                        48.899                         48.899                         48.899                         48.899                         48.899                         48.899           
              50.987                        50.987                        50.987                        50.987                        50.987                        50.987                        50.987                        50.987                        50.987                        50.987                         50.987                         50.987                         50.987                         50.987                         50.987           
              53.075                        53.075                        53.075                        53.075                        53.075                        53.075                        53.075                        53.075                        53.075                        53.075                         53.075                         53.075                         53.075                         53.075                         53.075           
              55.163                        55.163                        55.163                        55.163                        55.163                        55.163                        55.163                        55.163                        55.163                        55.163                         55.163                         55.163                         55.163                         55.163                         55.163           
              57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                         57.251                         57.251                         57.251                         57.251                         57.251           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_a
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9     mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19     mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29     mt_a30     mt_a31     mt_a32     mt_a33     mt_a34      mt_a35     mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50      mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    _________    _______    _______    _______    _______    _______

     -20     -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891     -20      -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891     -20      -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891    0.56765     2.6244     4.6812     6.7379      8.7947     10.851     12.908     14.965     17.022      19.079     21.135     23.192     25.249     27.306     29.362     31.419     33.476     35.533     37.589       39.646     41.703      43.76     45.816     47.873      49.93
     -20     -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712     -20      -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712     -20      -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712    -2.8569    -1.1425    0.57176     2.2861      4.0004     5.7147      7.429     9.1433     10.858      12.572     14.286     16.001     17.715     19.429     21.144     22.858     24.572     26.286     28.001       29.715     31.429     33.144     34.858     36.572     38.287
     -20     -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532     -20      -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532     -20      -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532    -6.2814    -4.9095    -3.5376    -2.1658    -0.79392    0.57794     1.9498     3.3217     4.6935      6.0654     7.4373     8.8091     10.181     11.553     12.925     14.297     15.668      17.04     18.412       19.784     21.156     22.528       23.9     25.271     26.643
     -20     -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735     -20      -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735     -20      -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735    -9.7059    -8.6765    -7.6471    -6.6176     -5.5882    -4.5588    -3.5294       -2.5    -1.4706    -0.44118    0.58824     1.6176     2.6471     3.6765     4.7059     5.7353     6.7647     7.7941     8.8235       9.8529     10.882     11.912     12.941     13.971         15
     -20     -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -20      -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -20      -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -13.13    -12.443    -11.756     -11.07     -10.383    -9.6956    -9.0086    -8.3217    -7.6347     -6.9477    -6.2608    -5.5738    -4.8869    -4.1999    -3.5129     -2.826     -2.139    -1.4521    -0.7651    -0.078137    0.60882     1.2958     1.9827     2.6697     3.3567
     -20     -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899     -20      -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899     -20      -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899    -16.555     -16.21    -15.866    -15.521     -15.177    -14.832    -14.488    -14.143    -13.799     -13.454     -13.11    -12.765    -12.421    -12.076    -11.732    -11.387    -11.043    -10.698    -10.354      -10.009    -9.6647    -9.3202    -8.9757    -8.6312    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981     -20      -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981     -20      -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981    -19.979    -19.977    -19.975    -19.973     -19.971    -19.969    -19.967    -19.965    -19.963     -19.961    -19.959    -19.957    -19.955    -19.953    -19.951    -19.949    -19.946    -19.944    -19.942       -19.94    -19.938    -19.936    -19.934    -19.932     -19.93

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9     mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19     mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29     mt_a30     mt_a31     mt_a32     mt_a33     mt_a34      mt_a35     mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50      mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    ______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    _________    _______    _______    _______    _______    _______

     -20     -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891     -20      -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891     -20      -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891    0.56765     2.6244     4.6812     6.7379      8.7947     10.851     12.908     14.965     17.022      19.079     21.135     23.192     25.249     27.306     29.362     31.419     33.476     35.533     37.589       39.646     41.703      43.76     45.816     47.873      49.93
     -20     -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712     -20      -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712     -20      -18.286    -16.571    -14.857    -13.143    -11.428    -9.7141    -7.9998    -6.2855    -4.5712    -2.8569    -1.1425    0.57176     2.2861      4.0004     5.7147      7.429     9.1433     10.858      12.572     14.286     16.001     17.715     19.429     21.144     22.858     24.572     26.286     28.001       29.715     31.429     33.144     34.858     36.572     38.287
     -20     -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532     -20      -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532     -20      -18.628    -17.256    -15.884    -14.513    -13.141    -11.769    -10.397    -9.0251    -7.6532    -6.2814    -4.9095    -3.5376    -2.1658    -0.79392    0.57794     1.9498     3.3217     4.6935      6.0654     7.4373     8.8091     10.181     11.553     12.925     14.297     15.668      17.04     18.412       19.784     21.156     22.528       23.9     25.271     26.643
     -20     -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735     -20      -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735     -20      -18.971    -17.941    -16.912    -15.882    -14.853    -13.824    -12.794    -11.765    -10.735    -9.7059    -8.6765    -7.6471    -6.6176     -5.5882    -4.5588    -3.5294       -2.5    -1.4706    -0.44118    0.58824     1.6176     2.6471     3.6765     4.7059     5.7353     6.7647     7.7941     8.8235       9.8529     10.882     11.912     12.941     13.971         15
     -20     -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -20      -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -20      -19.313    -18.626    -17.939    -17.252    -16.565    -15.878    -15.191    -14.504    -13.817     -13.13    -12.443    -11.756     -11.07     -10.383    -9.6956    -9.0086    -8.3217    -7.6347     -6.9477    -6.2608    -5.5738    -4.8869    -4.1999    -3.5129     -2.826     -2.139    -1.4521    -0.7651    -0.078137    0.60882     1.2958     1.9827     2.6697     3.3567
     -20     -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899     -20      -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899     -20      -19.655    -19.311    -18.966    -18.622    -18.277    -17.933    -17.588    -17.244    -16.899    -16.555     -16.21    -15.866    -15.521     -15.177    -14.832    -14.488    -14.143    -13.799     -13.454     -13.11    -12.765    -12.421    -12.076    -11.732    -11.387    -11.043    -10.698    -10.354      -10.009    -9.6647    -9.3202    -8.9757    -8.6312    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981     -20      -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981     -20      -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981    -19.979    -19.977    -19.975    -19.973     -19.971    -19.969    -19.967    -19.965    -19.963     -19.961    -19.959    -19.957    -19.955    -19.953    -19.951    -19.949    -19.946    -19.944    -19.942       -19.94    -19.938    -19.936    -19.934    -19.932     -19.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_a_meshk
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_a_meshk: 385&times;1 double

        Values:

            Min             -20   
            Median       -13.11   
            Max           49.93   

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_k
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9       mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18      mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28      mt_k29      mt_k30      mt_k31      mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37     mt_k38     mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46      mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    ________    ________    ______    _________    _________    _________    _________    ________    ________    ________    ________    ________    ______    _________    _________    _________    _________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529      0       0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529      0       0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529    0.020588    0.022647    0.024706    0.026765    0.028824    0.030882    0.032941     0.035    0.037059    0.039118    0.041176    0.043235    0.045294    0.047353    0.049412    0.051471    0.053529    0.055588    0.057647    0.059706    0.061765    0.063824    0.065882    0.067941      0.07
      0        0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      0         0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      0         0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      3.4451      3.7896      4.1341      4.4786      4.8231      5.1676      5.5122    5.8567      6.2012      6.5457      6.8902      7.2347      7.5792      7.9237      8.2682      8.6127      8.9573      9.3018      9.6463      9.9908      10.335       10.68      11.024      11.369    11.713
      0        0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      0         0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      0         0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      6.8696      7.5566      8.2435      8.9305      9.6175      10.304      10.991    11.678      12.365      13.052      13.739      14.426      15.113        15.8      16.487      17.174      17.861      18.548      19.235      19.922      20.609      21.296      21.983       22.67    23.357
      0         1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      0          1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      0          1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      10.294      11.324      12.353      13.382      14.412      15.441      16.471      17.5      18.529      19.559      20.588      21.618      22.647      23.676      24.706      25.735      26.765      27.794      28.824      29.853      30.882      31.912      32.941      33.971        35
      0         1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      0          1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      0          1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      13.719       15.09      16.462      17.834      19.206      20.578       21.95    23.322      24.694      26.065      27.437      28.809      30.181      31.553      32.925      34.297      35.668       37.04      38.412      39.784      41.156      42.528        43.9      45.271    46.643
      0         1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      0          1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      0          1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      17.143      18.857      20.572      22.286          24      25.715      27.429    29.143      30.858      32.572      34.286      36.001      37.715      39.429      41.144      42.858      44.572      46.286      48.001      49.715      51.429      53.144      54.858      56.572    58.287
      0         2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      0          2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      0          2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      20.568      22.624      24.681      26.738      28.795      30.851      32.908    34.965      37.022      39.079      41.135      43.192      45.249      47.306      49.362      51.419      53.476      55.533      57.589      59.646      61.703       63.76      65.816      67.873     69.93

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9       mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18      mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28      mt_k29      mt_k30      mt_k31      mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37     mt_k38     mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46      mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    ________    ________    ______    _________    _________    _________    _________    ________    ________    ________    ________    ________    ______    _________    _________    _________    _________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529      0       0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529      0       0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529    0.020588    0.022647    0.024706    0.026765    0.028824    0.030882    0.032941     0.035    0.037059    0.039118    0.041176    0.043235    0.045294    0.047353    0.049412    0.051471    0.053529    0.055588    0.057647    0.059706    0.061765    0.063824    0.065882    0.067941      0.07
      0        0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      0         0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      0         0.34451      0.68902       1.0335        1.378      1.7225      2.0671      2.4116      2.7561      3.1006      3.4451      3.7896      4.1341      4.4786      4.8231      5.1676      5.5122    5.8567      6.2012      6.5457      6.8902      7.2347      7.5792      7.9237      8.2682      8.6127      8.9573      9.3018      9.6463      9.9908      10.335       10.68      11.024      11.369    11.713
      0        0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      0         0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      0         0.68696       1.3739       2.0609       2.7478      3.4348      4.1218      4.8087      5.4957      6.1826      6.8696      7.5566      8.2435      8.9305      9.6175      10.304      10.991    11.678      12.365      13.052      13.739      14.426      15.113        15.8      16.487      17.174      17.861      18.548      19.235      19.922      20.609      21.296      21.983       22.67    23.357
      0         1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      0          1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      0          1.0294       2.0588       3.0882       4.1176      5.1471      6.1765      7.2059      8.2353      9.2647      10.294      11.324      12.353      13.382      14.412      15.441      16.471      17.5      18.529      19.559      20.588      21.618      22.647      23.676      24.706      25.735      26.765      27.794      28.824      29.853      30.882      31.912      32.941      33.971        35
      0         1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      0          1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      0          1.3719       2.7437       4.1156       5.4875      6.8593      8.2312       9.603      10.975      12.347      13.719       15.09      16.462      17.834      19.206      20.578       21.95    23.322      24.694      26.065      27.437      28.809      30.181      31.553      32.925      34.297      35.668       37.04      38.412      39.784      41.156      42.528        43.9      45.271    46.643
      0         1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      0          1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      0          1.7143       3.4286       5.1429       6.8573      8.5716      10.286          12      13.715      15.429      17.143      18.857      20.572      22.286          24      25.715      27.429    29.143      30.858      32.572      34.286      36.001      37.715      39.429      41.144      42.858      44.572      46.286      48.001      49.715      51.429      53.144      54.858      56.572    58.287
      0         2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      0          2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      0          2.0568       4.1135       6.1703       8.2271      10.284      12.341      14.397      16.454      18.511      20.568      22.624      24.681      26.738      28.795      30.851      32.908    34.965      37.022      39.079      41.135      43.192      45.249      47.306      49.362      51.419      53.476      55.533      57.589      59.646      61.703       63.76      65.816      67.873     69.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_k_mesha
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_k_mesha: 385&times;1 double

        Values:

            Min               0   
            Median       6.8902   
            Max           69.93   

pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 21
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
%% FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids
% This file is based on
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, see that file for more comments and compare
% differences in graphs and tables to see how the inclusion of formal and
% informal choices that consider bridge loans impact choice sets. 
%
% Also compare against
% <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html
% ffs_abz_fibs_get_funcgrid> where the results are also considering formal
% and informal choices etc in the context of *abz fibs*.
%
% In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and
% savings formal and informal. These will change how the testing matrix is
% constructed. When bridge loan is allowed, we also need to construct the
% output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that
% coh today does not matter, so to find optimal k* choice, we only need to
% know the aggregate savings level. But now, we need to know the coh level
% as well.
%
% Below two reachable coh matrixes are constructed, one for when aggregate
% savings choice w >= 0, and another for when aggregate savings <= 0. Then
% they are stacked together. And we still have the same outputs as
% ff_ipwkbz_evf.m. The difference is that while for savings where w >=0,
% each row are w levels for the output matrixes, but for w <=0, each row is
% for w level + coh percentage combinations. 
%
% * _ar_w_level_: What are the feasible grid of w = k'+b', these are to be interpolated
% later, these are level grid, not percentage grid
% * _ar_w_level_: What are the percentage based choices points for k' and
% b' given each w. These are _ar_a_meshk_, _ar_k_mesha_. Note here these
% are principles, k + b' is the total aggregate savings in period t. b is
% be a combination of formal and informal choices, but our percentage point
% for b is the overall principle of all formal and informal choices
% * _mt_coh_wkb_full_ : These are the cash-on-hand levels reacheable given
% the choice percentages of k and b'. The problem here is more complicated
% than
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> because here we can not get to coh tomorrow by
% multiplying principle by savings or borrowing interest rates, if
% borrowing, we have to optimize among formal and informal choices. That is
% computationally trivial because it's a static choice unrelated to the
% dynamic problem. The slightly more complicated thing is that we also have
% to consider percentages of b' that has to go to bridge loans due to
% negative cash-on-hand in period t. That makes the reachable cash-on-hand
% grid significantly larger than the grid in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, we have to expand the grid by another
% percentage dimensionREPLACE_WITH_DASH_DASHpercentages of b' going to bridgeREPLACE_WITH_DASH_DASHfor negative
% levels of w=k'+b' overall choice. 
%

%% Default
% Results identical to
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> is obtained by running default with:
% st_param_which = 'ffs_ipwkbz_get_funcgrid'; 
%

bl_input_override = 0;
if (length(varargin) == 3)
    bl_input_override = varargin{3};
end
if (bl_input_override)
    % override when called from outside
    [param_map, support_map, ~] = varargin{:};
else
    % default internal run
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    support_map('bl_display_funcgrids') = true;
    
    st_param_which = 'small';
    
    if (ismember(st_param_which, ['default', 'ffs_ipwkbz_get_funcgrid']))
        
        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 25;
        param_map('it_ak_perc_n') = 45;
        
        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;
    
        if (strcmp(st_param_which, 'default'))
            
            param_map('it_coh_bridge_perc_n') = 3;
            
            % Adjust interest rates
            param_map('fl_r_inf') = 0.30;
            param_map('fl_r_inf_bridge') = 0.30;
            param_map('bl_bridge') = true;
            
        elseif (strcmp(st_param_which, 'ffs_ipwkbz_get_funcgrid'))
            
            param_map('it_coh_bridge_perc_n') = 1;
            
            param_map('fl_r_inf') = 0.025;
            param_map('fl_r_inf_bridge') = 0.025;
            param_map('bl_bridge') = false;
            
        end        
            
    elseif (strcmp(st_param_which, 'small'))
        
        param_map('bl_bridge') = true;
        
        % Adjust interest rates
        param_map('fl_r_inf') = 0.30;
        param_map('fl_r_inf_bridge') = 0.30;

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = false; % if borrowing is default allowed        

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 7;
        param_map('it_ak_perc_n') = 7;
        param_map('it_coh_bridge_perc_n') = 3;
        
        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;
        
    end
    
    
    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
end

%% Parse Parameters

params_group = values(param_map, {'it_z_n', 'fl_z_mu', 'fl_z_rho', 'fl_z_sig'});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {'fl_nan_replace', 'fl_b_bd', 'fl_w_min', 'fl_w_max', ...
    'it_w_perc_n', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, ...
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_k_min', 'fl_k_max', 'it_ak_perc_n'});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min', 'it_c_interp_grid_gap'});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'bl_bridge', 'it_coh_bridge_perc_n'});
[bl_bridge, it_coh_bridge_perc_n] = params_group{:};

params_group = values(param_map, {'bl_b_is_principle', 'fl_r_fbr', 'fl_r_fsv', 'fl_r_inf', 'fl_w'});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_r_inf, fl_w] = params_group{:};

params_group = values(param_map, {'st_forbrblk_type', 'fl_forbrblk_brmost', 'fl_forbrblk_brleast', 'fl_forbrblk_gap'});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

params_group = values(support_map, {'bl_display_minccost', 'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};

%% G1: Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html
% ffs_ipwkbz_fibs_set_default_param> for details.
%
% @example
%    
%    % For 2nd stage Grid
%    ar_w_level = [-2,0,2]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = linspace(fl_w_min, fl_w_max, it_w_interp_n);
ar_w_level = ar_w_level_full;

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

%% G2: Expand A and K Arrays further if bridge is allowed
% Crucially, when a fraction of overall borrowing/savings needs to go pay
% negative coh, that comes out of w, fraction of w = k' + b' that goes to
% this. NOT a fraction of the b' choice condition on w, which would change
% for the same w as w' changes. We are fixing bridge repay level for w. 
%
% @example
%
%    clear all
%    % Same as above
%    ar_w_level = [-2,-1,-0.1]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%    
%    % fraction of borrowing for bridge loan
%    ar_coh_bridge_perc = [0, 0.5, 0.999];
%    
%    % Expand matrix to include coh percentage dimension
%    mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
%    mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])
%    
%    % bridge loan component of borrowing
%    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
%    ar_brdige_a = ar_brdige_a(:)'
%    
%    % borrowing choices excluding bridge loan
%    mt_a_nobridge = mt_a - ar_brdige_a
%

if (bl_bridge)
    
    % 1. select mt_k and mt_a where w_level <= 0
    ar_bl_w_neg = (ar_w_level < 0);
    ar_w_level_neg = ar_w_level(ar_bl_w_neg);
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);
    
    % 2. fraction of borrowing for bridge loan
    % start at 0, some borrowing no bridge loan needed, coh > 0 
    ar_coh_bridge_perc = fliplr(linspace(0, 1.0, it_coh_bridge_perc_n));

    % 3. Expand matrix to include coh percentage dimension
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    % 4. bridge loan component of borrowing
    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    % 5. borrowing choices excluding bridge loan
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;
    
    % 6. Matrix combine, negative than positive
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];
    
    % 7. Expand Bridge Choices to have the same size as mt_a
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;
    
    % 8. Overall borrowing and savings choices
    mt_a = mt_a_nobridge + mt_bridge_a;
    
    % 9. Update w
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);    
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);
    
else
    
    % If bridge loans are not needed, do not need to do expansions
    % All zeros, no bridge
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];
    
end

%% G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.
% For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N
% number of rows. Where N is the percentage grid point for coh as well as
% k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos =
% numger of grid points for ar_w_level
%
% # *mt_a* includes aggregate/total borrowing and savings levels. b < 0 happens
% alot when w >= 0. The mt_a_nobridge
% # *mt_a_nobridge* includes all aggregate/total borrowing and savings
% whether w > 0 or w < 0, however, it subtracts away the borrowing that is
% for bridge loans when b < 0 
% # *mt_bridge_a* is the bridge loan amount.
%

ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;

%% F1: Get Shock Grids

[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);

%% FIBS1: Get Equations

[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = ...
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);

%% FIBS2: Get Formal Borrowing Blocks

[ar_forbrblk, ar_forbrblk_r] = ...
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);

%% Find Formal and Informal Choices for Borrowing points
% Here we solve for the optimal formal and informal choices given b. Note
% that kind of like the static firm's maximization problem. Here the
% optimization problem is static, and can be done independently of the
% overall dynamic optimization problem. 

% When borrowing index and array
% note index for negative is from _ar_a_meshk_full_, but value from
% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some
% of these points _ar_a_nobridge_meshk_ = 0. But need to use
% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all
% borrowing.
ar_bl_ameshk_neg_idx = (ar_a_meshk_full < 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

% Given b, solve for optimal formal and informal choices.
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = ...
   ffs_fibs_min_c_cost(bl_b_is_principle, fl_r_inf, fl_r_fsv, ...
                         ar_forbrblk_r, ar_forbrblk, ...
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);

%% FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative
% *ar_coh_fbis_aneg*: the consumption cost to t+1 from borrowing in t given
% formal and informal joint choice optimization.
%
% Reachable cash-on-hand borrowing points: N_neg*N^2 rows
%
% Additionally, need to convert borrowing choices to consumption units next
% period. borrowing choices in percentage are in unit of last period
% borrowing, principles only, need to convert to interest rates plus
% principle which means considering which formal informal choice
% combination maximizes cash-on-hand for the same level of overall
% principles.
%
% Construct another percentage, which is, percentages of ar_a_meshk_full
% when w < 0. Percentage represents what fraction of the a debt is going
% towards bridge loan debts. Note that as long as w < 0, b < 0 must be the
% case as well. So for negative elements of w, there is a triple mesh: N
% points for A x N points for K x N points for Bridge.
%

ar_coh_fbis_aneg = f_coh_fbis(fl_r_inf, ...
                                ar_for_borr_aneg, ...
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), ...
                                ar_for_save_aneg);
                            
%% FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive
% *ar_coh_save_apos*: the consumption gain to t+1 from savings in t

ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);

%% COH1: Combine overall Reachable Cash-on-Hand Levels
% N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count.
% These are the cash-on-hand points reachable given percentage grid choice
% structure and the possibility of bridge loans. 

ar_ameshk_tnext_with_r = zeros(size(ar_k_mesha));
ar_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx) = ar_coh_fbis_aneg;
ar_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx) = ar_coh_save_apos;

mt_coh_wkb_full = f_coh(ar_z, ar_ameshk_tnext_with_r, ar_k_mesha);

if (bl_display_funcgrids)
    
    % Generate Aggregate Variables
    ar_aplusk_mesha = ar_a_meshk + ar_k_mesha;
    ar_bwithrplusk_mesha = ar_ameshk_tnext_with_r + ar_k_mesha;
    
    % Genereate Table
    tab_ak_choices = array2table([ar_bwithrplusk_mesha, ar_aplusk_mesha, ...
        ar_k_mesha, ar_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = {'ar_bwithrplusk_mesha', 'ar_aplusk_mesha', ...
        'ar_k_mesha', 'ar_ameshk_tnext_with_r', 'ar_a_meshk', 'ar_a_nobridge_meshk', 'ar_bridge_a'};
    tab_ak_choices.Properties.VariableNames = cl_col_names;
    
    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_bwithrplusk_mesha'} = ...
        '*ar_bwithrplusk_mesha*: ';
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesha'} = ...
        '*ar_aplusk_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha'} = ...
        '*ar_k_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_ameshk_tnext_with_r'} = ...
        '*ar_ameshk_tnext_with_r*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk'} = ...
        '*ar_a_meshk*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_nobridge_meshk'} = ...
        '*ar_aprime_nobridge*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_bridge_a'} = ...
        '*ar_bridge_a*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end
    
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));
    
end

%% COH2: Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));

%% COH3: Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% COH4: Select only Valid (k(w), a) choices

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;

% This is borrowing with default or not condition
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end


%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): 2nd Stage Problem Arrays and Matrixes
% ar_a_meshk is t: b
% ar_ameshk_tnext_with_r is t+1: b*(1+r) with for inf
 
armt_map('ar_coh_bridge_perc') = ar_coh_bridge_perc;
armt_map('ar_ak_perc') = ar_ak_perc;
armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_ameshk_tnext_with_r') = ar_ameshk_tnext_with_r;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('it_ameshk_n') = length(ar_a_meshk);
armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_z_mesh_coh_wkb') = mt_z_mesh_coh_wkb;

%% Store armt_map (2): First Stage Aggregate Savings
% w = k' + b', w is aggregate Savings%
%
% # *ar_w_perc* 1st stage, percentage w choice given coh, at each coh
% level the number of choice points is the same for this problem with
% percentage grid points.
% # *ar_w_level* 2nd stage, level of w over which we solve the optimal
% percentage k' choices. Need to generate interpolant based on this so that
% we know optimal k* given ar_w_perc(coh) in the 1st stage
% # *mt_w_by_interp_coh_interp_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_w_level') = ar_w_level;
armt_map('ar_w_level_full') = ar_w_level_full;
armt_map('mt_w_by_interp_coh_interp_grid') = mt_w_by_interp_coh_interp_grid;
armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;

%% Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;
armt_map('mt_z_mesh_coh_interp_grid') = mt_z_mesh_coh_interp_grid;

%% Store armt_map (4): Shock Grids
armt_map('mt_z_trans') = mt_z_trans;
armt_map('ar_stationary') = ar_stationary;
armt_map('ar_z') = ar_z;

%% Store Function Map
func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.
    %
    % Plot end because earlier parts have repeating w and a levels due to
    % potentially bridge which are coh percentage dependent. This will only
    % plot out the grid basically when coh percentage for bridge loan = 0 
    %
    
    figure('PaperPosition', [0 0 7 4]);
    hold on;
        
    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;
    
    chart = plot(mt_a(:,it_col_start:it_col_end), ...
                 mt_k(:,it_col_start:it_col_end), ...
                 'blue');
             
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    
    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;
    
%     if (length(ar_w_level_full) <= 100)
    scatter(ar_a_meshk(it_col_start:it_col_end), ...
            ar_k_mesha(it_col_start:it_col_end), ...
            3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level) <= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),...
                                     ar_k_mesha_full(ar_bl_wkb_invalid),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title({'Risky K Percentage Grids Given w=k+a (2nd Stage)'...
           '(Bridge Borrow Share = 0)'})
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end

    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
        'Each Segment is a w=k+b; within segment increasing k'...
        'For each w and z, coh maximizing k is different'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));

    legendCell{length(legendCell) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z));
    disp(ar_z);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_coh_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_coh_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_c_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_c_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_interp_coh_grid_mesh_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_a');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_a_meshk');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_a_meshk));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_k');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_k_mesha');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    for i = 1:length(func_map)
        st_display = strjoin(['pos =' num2str(i) '; key =' string(param_map_keys{i}) '; val =' func2str(param_map_vals{i})]);
        disp(st_display);
    end

end

end

##### SOURCE END #####
--></body></html>