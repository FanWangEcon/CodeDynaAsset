
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-10"><meta name="DC.source" content="ffs_ipwkbz_fibs_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1a</a></li><li><a href="#5">Parse Parameters 1b</a></li><li><a href="#6">Parse Parameters 2</a></li><li><a href="#7">Parse Parameters 3</a></li><li><a href="#8">G1: Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#9">G2: Expand A and K Arrays further if bridge is allowed</a></li><li><a href="#10">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</a></li><li><a href="#11">F1: Get Shock: Income Shock (ar1)</a></li><li><a href="#12">F2: Get Shock: Interest Rate Shock (iid)</a></li><li><a href="#13">F3: Get Shock: Mesh Shocks Together</a></li><li><a href="#14">FIBS1: Get Equations</a></li><li><a href="#15">FIBS2: Get Formal Borrowing Blocks</a></li><li><a href="#16">Find Formal and Informal Choices for Borrowing points</a></li><li><a href="#17">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</a></li><li><a href="#18">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</a></li><li><a href="#19">COH1: Combine overall Reachable Cash-on-Hand Levels</a></li><li><a href="#20">COH2: Check if COH is within Borrowing Bounds</a></li><li><a href="#21">COH3: Update Valid 2nd stage choice matrix</a></li><li><a href="#22">COH4: Select only Valid (k(w), a) choices</a></li><li><a href="#23">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#24">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#25">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</a></li><li><a href="#26">Generate Interpolation Consumption Grid</a></li><li><a href="#27">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#28">Store armt_map (1): base arrays</a></li><li><a href="#29">Store armt_map (2): 1st stage level coh on hand related arrays</a></li><li><a href="#30">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</a></li><li><a href="#31">Store armt_map (4): 2nd stage additional arrays</a></li><li><a href="#32">Store armt_map (5): Shock Grids Arrays and Mesh</a></li><li><a href="#33">Store armt_map (6): W Share for Bridge Parameters</a></li><li><a href="#34">Store Function Map</a></li><li><a href="#35">Graph</a></li><li><a href="#37">Generate Limited Legends</a></li><li><a href="#38">Graph 1: a and k choice grid graphs</a></li><li><a href="#39">Graph 2: coh by shock</a></li><li><a href="#40">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#42">Graph Details, Generally do Not Run</a></li><li><a href="#44">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#45">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#47">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>This file is based on <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, see that file for more comments and compare differences in graphs and tables to see how the inclusion of formal and informal choices that consider bridge loans impact choice sets.</p><p>Also compare against <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html">ffs_abz_fibs_get_funcgrid</a> where the results are also considering formal and informal choices etc in the context of <b>abz fibs</b>.</p><p>In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and savings formal and informal. These will change how the testing matrix is constructed. When bridge loan is allowed, we also need to construct the output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that coh today does not matter, so to find optimal k* choice, we only need to know the aggregate savings level. But now, we need to know the coh level as well.</p><p>Below two reachable coh matrixes are constructed, one for when aggregate savings choice w &gt;= 0, and another for when aggregate savings &lt;= 0. Then they are stacked together. And we still have the same outputs as ff_ipwkbz_evf.m. The difference is that while for savings where w &gt;=0, each row are w levels for the output matrixes, but for w &lt;=0, each row is for w level + coh percentage combinations.</p><div><ul><li><i>ar_w_level</i>: What are the feasible grid of w = k'+b', these are to be interpolated later, these are level grid, not percentage grid</li><li><i>ar_w_level</i>: What are the percentage based choices points for k' and b' given each w. These are <i>ar_a_meshk</i>, <i>ar_k_mesha</i>. Note here these are principles, k + b' is the total aggregate savings in period t. b is be a combination of formal and informal choices, but our percentage point for b is the overall principle of all formal and informal choices</li><li><i>mt_coh_wkb_full</i> : These are the cash-on-hand levels reacheable given the choice percentages of k and b'. The problem here is more complicated than <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> because here we can not get to coh tomorrow by multiplying principle by savings or borrowing interest rates, if borrowing, we have to optimize among formal and informal choices. That is computationally trivial because it's a static choice unrelated to the dynamic problem. The slightly more complicated thing is that we also have to consider percentages of b' that has to go to bridge loans due to negative cash-on-hand in period t. That makes the reachable cash-on-hand grid significantly larger than the grid in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, we have to expand the grid by another percentage dimension--percentages of b' going to bridge--for negative levels of w=k'+b' overall choice.</li></ul></div><h2 id="3">Default</h2><p>Results identical to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> is obtained by running default with: st_param_which = 'ffs_ipwkbz_get_funcgrid';</p><pre class="codeinput">bl_input_override = 0;
<span class="keyword">if</span> (length(varargin) == 3)
    bl_input_override = varargin{3};
<span class="keyword">end</span>
<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% override when called from outside</span>
    [param_map, support_map, ~] = varargin{:};
<span class="keyword">else</span>
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = true;

    st_param_which = <span class="string">'small'</span>;

    <span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>]))

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 25;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 45;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

        <span class="comment">% Note it_coh_bridge_perc is percentage NOT for BRIDGE</span>
        <span class="keyword">if</span> (strcmp(st_param_which, <span class="string">'default'</span>))

            param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

            <span class="comment">% Adjust interest rates</span>
            param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;
            param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>))


            param_map(<span class="string">'fl_r_inf'</span>) = 0.025;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.025;
            param_map(<span class="string">'bl_bridge'</span>) = false;
            <span class="comment">% when bl_bridge = false, it_coh_bridge_perc_n = 1</span>

        <span class="keyword">end</span>

    <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'small'</span>))

        param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="comment">% Adjust interest rates</span>
        param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
        param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = false; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 7;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 7;
        param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

    <span class="keyword">end</span>

    param_map(<span class="string">'fl_z_r_borr_min'</span>) = 0.025;
    param_map(<span class="string">'fl_z_r_borr_max'</span>) = 0.95;
    param_map(<span class="string">'fl_z_r_borr_n'</span>) = 3;
    param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);

    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
<span class="keyword">end</span>
</pre><pre class="codeoutput">param_map
  Map with properties:

        Count: 49
      KeyType: char
    ValueType: any

pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_rollover ; val = true
pos = 5 ; key = fl_Amean ; val = 1
pos = 6 ; key = fl_alpha ; val = 0.36
pos = 7 ; key = fl_b_bd ; val = -20
pos = 8 ; key = fl_beta ; val = 0.94
pos = 9 ; key = fl_c_min ; val = 0.02
pos = 10 ; key = fl_coh_interp_grid_gap ; val = 0.1
pos = 11 ; key = fl_crra ; val = 1.5
pos = 12 ; key = fl_default_wprime ; val = 0
pos = 13 ; key = fl_delta ; val = 0.08
pos = 14 ; key = fl_forbrblk_brleast ; val = -1
pos = 15 ; key = fl_forbrblk_brmost ; val = -19
pos = 16 ; key = fl_forbrblk_gap ; val = -1.5
pos = 17 ; key = fl_k_max ; val = 70
pos = 18 ; key = fl_k_min ; val = 0
pos = 19 ; key = fl_nan_replace ; val = -9999
pos = 20 ; key = fl_r_fbr ; val = 0.065
pos = 21 ; key = fl_r_fsv ; val = 0.025
pos = 22 ; key = fl_tol_dist ; val = 1e-05
pos = 23 ; key = fl_tol_pol ; val = 1e-05
pos = 24 ; key = fl_tol_val ; val = 1e-05
pos = 25 ; key = fl_w ; val = 0.44365
pos = 26 ; key = fl_w_interp_grid_gap ; val = 0.1
pos = 27 ; key = fl_w_max ; val = 50
pos = 28 ; key = fl_w_min ; val = -20
pos = 29 ; key = fl_z_r_borr_max ; val = 0.095
pos = 30 ; key = fl_z_r_borr_min ; val = 0.025
pos = 31 ; key = fl_z_r_borr_n ; val = 5
pos = 32 ; key = fl_z_r_borr_poiss_mean ; val = 1.75
pos = 33 ; key = fl_z_wage_mu ; val = 0
pos = 34 ; key = fl_z_wage_rho ; val = 0.8
pos = 35 ; key = fl_z_wage_sig ; val = 0.2
pos = 36 ; key = it_ak_perc_n ; val = 50
pos = 37 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 38 ; key = it_coh_bridge_perc_n ; val = 50
pos = 39 ; key = it_maxiter_dist ; val = 1000
pos = 40 ; key = it_maxiter_val ; val = 250
pos = 41 ; key = it_tol_pol_nochange ; val = 25
pos = 42 ; key = it_w_perc_n ; val = 50
pos = 43 ; key = it_z_n ; val = 75
pos = 44 ; key = it_z_wage_n ; val = 15
pos = 45 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 46 ; key = st_forbrblk_type ; val = seg3
pos = 47 ; key = st_model ; val = ipwkbz_fibs
pos = 48 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 49 ; key = st_z_r_borr_drv_prb_type ; val = poiss
support_map
  Map with properties:

        Count: 46
      KeyType: char
    ValueType: any

pos = 1 ; key = bl_display ; val = true
pos = 2 ; key = bl_display_defparam ; val = false
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = false
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = false
pos = 9 ; key = bl_display_infbridge ; val = false
pos = 10 ; key = bl_display_minccost ; val = false
pos = 11 ; key = bl_graph ; val = false
pos = 12 ; key = bl_graph_coh_t_coh ; val = true
pos = 13 ; key = bl_graph_discrete ; val = true
pos = 14 ; key = bl_graph_evf ; val = false
pos = 15 ; key = bl_graph_forinf_discrete ; val = true
pos = 16 ; key = bl_graph_forinf_pol_lvl ; val = true
pos = 17 ; key = bl_graph_forinf_pol_pct ; val = true
pos = 18 ; key = bl_graph_funcgrids ; val = false
pos = 19 ; key = bl_graph_funcgrids_detail ; val = false
pos = 20 ; key = bl_graph_onebyones ; val = true
pos = 21 ; key = bl_graph_pol_lvl ; val = true
pos = 22 ; key = bl_graph_pol_pct ; val = true
pos = 23 ; key = bl_graph_val ; val = true
pos = 24 ; key = bl_img_save ; val = false
pos = 25 ; key = bl_mat ; val = false
pos = 26 ; key = bl_post ; val = false
pos = 27 ; key = bl_profile ; val = false
pos = 28 ; key = bl_profile_dist ; val = false
pos = 29 ; key = bl_time ; val = true
pos = 30 ; key = it_display_every ; val = 5
pos = 31 ; key = it_display_final_colmax ; val = 12
pos = 32 ; key = it_display_final_rowmax ; val = 100
pos = 33 ; key = st_img_name_main ; val = _default
pos = 34 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/img/
pos = 35 ; key = st_img_prefix ; val = 
pos = 36 ; key = st_img_suffix ; val = _p0.png
pos = 37 ; key = st_mat_name_main ; val = _default
pos = 38 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/mat/
pos = 39 ; key = st_mat_prefix ; val = 
pos = 40 ; key = st_mat_suffix ; val = _p0
pos = 41 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 42 ; key = st_profile_name_main ; val = _default
pos = 43 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/profile/
pos = 44 ; key = st_profile_prefix ; val = 
pos = 45 ; key = st_profile_suffix ; val = _p0
pos = 46 ; key = st_title_prefix ; val = 
</pre><h2 id="4">Parse Parameters 1a</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'bl_bridge'</span>, <span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>});
[bl_bridge, fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_b_is_principle'</span>, <span class="string">'fl_r_fbr'</span>, <span class="string">'fl_r_fsv'</span>, <span class="string">'fl_w'</span>});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_w] = params_group{:};
</pre><h2 id="5">Parse Parameters 1b</h2><pre class="codeinput">params_group = values(param_map, {<span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'it_ak_perc_n'</span>, <span class="string">'it_coh_bridge_perc_n'</span>, <span class="keyword">...</span>
    <span class="string">'it_c_interp_grid_gap'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[it_w_perc_n, it_ak_perc_n, it_coh_bridge_perc_n, <span class="keyword">...</span>
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};
</pre><h2 id="6">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_wage_n'</span>, <span class="string">'fl_z_wage_mu'</span>, <span class="string">'fl_z_wage_rho'</span>, <span class="string">'fl_z_wage_sig'</span>});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

<span class="comment">% param_map shock borrowing interest</span>
params_group = values(param_map, {<span class="string">'st_z_r_borr_drv_ele_type'</span>, <span class="string">'st_z_r_borr_drv_prb_type'</span>, <span class="string">'fl_z_r_borr_poiss_mean'</span>, <span class="keyword">...</span>
    <span class="string">'fl_z_r_borr_max'</span>, <span class="string">'fl_z_r_borr_min'</span>, <span class="string">'fl_z_r_borr_n'</span>});
[st_z_r_borr_drv_ele_type, st_z_r_borr_drv_prb_type, fl_z_r_borr_poiss_mean, <span class="keyword">...</span>
    fl_z_r_borr_max, fl_z_r_borr_min, fl_z_r_borr_n] = params_group{:};

<span class="comment">% param_map formal menu</span>
params_group = values(param_map, {<span class="string">'st_forbrblk_type'</span>, <span class="string">'fl_forbrblk_brmost'</span>, <span class="string">'fl_forbrblk_brleast'</span>, <span class="string">'fl_forbrblk_gap'</span>});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

<span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_n'</span>});
[it_z_n] = params_group{:};
</pre><h2 id="7">Parse Parameters 3</h2><pre class="codeinput">params_group = values(support_map, {<span class="string">'bl_display_minccost'</span>, <span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
</pre><h2 id="8">G1: Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html">ffs_ipwkbz_fibs_set_default_param</a> for details.</p><p>@example</p><pre>  % For 2nd stage Grid
  ar_w_level = [-2,0,2]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>
</pre><h2 id="9">G2: Expand A and K Arrays further if bridge is allowed</h2><p>Crucially, when a fraction of overall borrowing/savings needs to go pay negative coh, that comes out of w, fraction of w = k' + b' that goes to this. NOT a fraction of the b' choice condition on w, which would change for the same w as w' changes. We are fixing bridge repay level for w.</p><p>@example</p><pre>  clear all
  % Same as above
  ar_w_level = [-2,-1,-0.1]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre>  % fraction of borrowing for bridge loan
  ar_coh_bridge_perc = [0, 0.5, 0.999];</pre><pre>  % Expand matrix to include coh percentage dimension
  mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
  mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])</pre><pre>  % bridge loan component of borrowing
  ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
  ar_brdige_a = ar_brdige_a(:)'</pre><pre>  % borrowing choices excluding bridge loan
  mt_a_nobridge = mt_a - ar_brdige_a</pre><pre class="codeinput"><span class="comment">% 1. negative part of w</span>
ar_bl_w_neg = (ar_w_level &lt; 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

<span class="keyword">if</span> (bl_bridge)

    <span class="comment">% 1. select mt_k and mt_a where w_level &lt;= 0</span>
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    <span class="comment">% 2. fraction of borrowing NOT for bridge loan</span>
    <span class="comment">% 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge</span>
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    <span class="comment">% 3. Expand matrix to include coh percentage dimension</span>
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    <span class="comment">% 4. bridge loan component of borrowing</span>
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    <span class="comment">% 5. borrowing choices excluding bridge loan</span>
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    <span class="comment">% 6. Matrix combine, negative than positive</span>
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    <span class="comment">% 7. Expand Bridge Choices to have the same size as mt_a</span>
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    <span class="comment">% 8. Overall borrowing and savings choices</span>
    mt_a = mt_a_nobridge + mt_bridge_a;

    <span class="comment">% 9. Update w</span>
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    <span class="comment">% 10. Pre-generate Interpolation matrix for negative w levels</span>
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">else</span>

    <span class="comment">% If bridge loans are not needed, do not need to do expansions</span>
    <span class="comment">% All zeros, no bridge</span>
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">end</span>
</pre><h2 id="10">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</h2><p>For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N number of rows. Where N is the percentage grid point for coh as well as k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos = numger of grid points for ar_w_level</p><div><ol><li><b>mt_a</b> includes aggregate/total borrowing and savings levels. b &lt; 0 happens alot when w &gt;= 0. The mt_a_nobridge</li><li><b>mt_a_nobridge</b> includes all aggregate/total borrowing and savings whether w &gt; 0 or w &lt; 0, however, it subtracts away the borrowing that is for bridge loans when b &lt; 0</li><li><b>mt_bridge_a</b> is the bridge loan amount.</li></ol></div><pre class="codeinput">ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;
</pre><h2 id="11">F1: Get Shock: Income Shock (ar1)</h2><pre class="codeinput">[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);
</pre><h2 id="12">F2: Get Shock: Interest Rate Shock (iid)</h2><pre class="codeinput"><span class="comment">% get borrowing grid and probabilities</span>
param_dsv_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
param_dsv_map(<span class="string">'st_drv_ele_type'</span>) = st_z_r_borr_drv_ele_type;
param_dsv_map(<span class="string">'st_drv_prb_type'</span>) = st_z_r_borr_drv_prb_type;
param_dsv_map(<span class="string">'fl_poiss_mean'</span>) = fl_z_r_borr_poiss_mean;
param_dsv_map(<span class="string">'fl_max'</span>) = fl_z_r_borr_max;
param_dsv_map(<span class="string">'fl_min'</span>) = fl_z_r_borr_min;
param_dsv_map(<span class="string">'fl_n'</span>) = fl_z_r_borr_n;
[ar_z_r_borr, ar_z_r_borr_prob] = fft_gen_discrete_var(param_dsv_map, true);

<span class="comment">% iid transition matrix</span>
mt_z_r_borr_prob_trans = repmat(ar_z_r_borr_prob, [length(ar_z_r_borr_prob), 1]);
</pre><h2 id="13">F3: Get Shock: Mesh Shocks Together</h2><pre class="codeinput"><span class="comment">% Kronecker product to get full transition matrix for the two shocks</span>
mt_z_trans = kron(mt_z_r_borr_prob_trans, mt_z_wage_trans);

<span class="comment">% mesh the shock vectors</span>
[mt_z_wage_mesh_r_borr_w1r2, mt_z_r_borr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_borr);
ar_z_r_borr_mesh_wage_w1r2 = mt_z_r_borr_mesh_wage_w1r2(:)';
ar_z_wage_mesh_r_borr_w1r2 = mt_z_wage_mesh_r_borr_w1r2(:)';

<span class="comment">% mesh the shock vectors</span>
[mt_z_r_borr_mesh_wage_r1w2, mt_z_wage_mesh_r_borr_r1w2] = ndgrid(ar_z_r_borr, ar_z_wage);
ar_z_wage_mesh_r_borr_r1w2 = mt_z_wage_mesh_r_borr_r1w2(:)';
ar_z_r_borr_mesh_wage_r1w2 = mt_z_r_borr_mesh_wage_r1w2(:)';


<span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_r_borr_mesh_wage_w1r2;<span class="keyword">...</span>
                                 ar_z_wage_mesh_r_borr_w1r2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_wage_mesh_r_borr_r1w2;<span class="keyword">...</span>
                                 ar_z_r_borr_mesh_wage_r1w2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:length(ar_z_r_borr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_borr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_borr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr', <span class="string">'r%3.2f'</span>)]);
    tb_z_r_borr_prob_trans = array2table(round(mt_z_r_borr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_r_borr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_borr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_borr_prob_trans));
    disp(tb_z_r_borr_prob_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', <span class="string">'w%3.2f'</span>)]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Full Transition Matrix: mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', <span class="string">'r%3.2f;'</span>), <span class="keyword">...</span>
                                   num2str(ar_z_wage_mesh_r_borr_w1r2', <span class="string">'w%3.2f'</span>)]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'i'</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'i'</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2
Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_1             0.025                0.34741      
    zi_2             0.025                0.40076      
    zi_3             0.025                 0.4623      
    zi_4             0.025                 0.5333      
    zi_5             0.025                0.61519      
    zi_6             0.025                0.70966      
    zi_7             0.025                0.81864      
    zi_8             0.025                0.94436      
    zi_9             0.025                 1.0894      
    zi_10            0.025                 1.2567      
    zi_11            0.025                 1.4496      
    zi_12            0.025                 1.6723      
    zi_13            0.025                 1.9291      
    zi_14            0.025                 2.2253      
    zi_15            0.025                  2.567      
    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      
    zi_31             0.95                0.34741      
    zi_32             0.95                0.40076      
    zi_33             0.95                 0.4623      
    zi_34             0.95                 0.5333      
    zi_35             0.95                0.61519      
    zi_36             0.95                0.70966      
    zi_37             0.95                0.81864      
    zi_38             0.95                0.94436      
    zi_39             0.95                 1.0894      
    zi_40             0.95                 1.2567      
    zi_41             0.95                 1.4496      
    zi_42             0.95                 1.6723      
    zi_43             0.95                 1.9291      
    zi_44             0.95                 2.2253      
    zi_45             0.95                  2.567      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2
Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

            BorrowRShock_Meshed_    WageRShock_Meshed_
            ____________________    __________________

    zi_1          0.34741                  0.025      
    zi_2          0.34741                 0.4875      
    zi_3          0.34741                   0.95      
    zi_4          0.40076                  0.025      
    zi_5          0.40076                 0.4875      
    zi_6          0.40076                   0.95      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_40           2.2253                  0.025      
    zi_41           2.2253                 0.4875      
    zi_42           2.2253                   0.95      
    zi_43            2.567                  0.025      
    zi_44            2.567                 0.4875      
    zi_45            2.567                   0.95      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     3     3

                  zi_1_r0_03    zi_2_r0_49    zi_3_r0_95
                  __________    __________    __________

    zi_1_r0_03     0.23358       0.40876       0.35766  
    zi_2_r0_49     0.23358       0.40876       0.35766  
    zi_3_r0_95     0.23358       0.40876       0.35766  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

                   zi_1_w0_35    zi_2_w0_40    zi_3_w0_46    zi_4_w0_53    zi_5_w0_62    zi_6_w0_71    zi_7_w0_82    zi_8_w0_94    zi_9_w1_09    zi_10_w1_26    zi_11_w1_45    zi_12_w1_67    zi_13_w1_93    zi_14_w2_23    zi_15_w2_57
                   __________    __________    __________    __________    __________    __________    __________    __________    __________    ___________    ___________    ___________    ___________    ___________    ___________

    zi_1_w0_35       0.26016       0.26831       0.25551       0.14921      0.053403      0.011702      0.001568      0.000128         6e-06             0              0              0              0              0              0  
    zi_2_w0_40       0.11232       0.19622        0.2763       0.23861       0.12635      0.040998      0.008143      0.000989       7.3e-05         3e-06              0              0              0              0              0  
    zi_3_w0_46      0.037073       0.10492        0.2185       0.27902        0.2185       0.10492      0.030863      0.005556      0.000611       4.1e-05          2e-06              0              0              0              0  
    zi_4_w0_53      0.009208      0.040998       0.12635       0.23861        0.2763       0.19622      0.085427      0.022782      0.003717       0.00037        2.3e-05          1e-06              0              0              0  
    zi_5_w0_62      0.001703      0.011702      0.053403       0.14921       0.25551       0.26831       0.17279      0.068209      0.016489      0.002438        0.00022        1.2e-05              0              0              0  
    zi_6_w0_71      0.000233      0.002438      0.016489      0.068209       0.17279       0.26831       0.25551       0.14921      0.053403      0.011702       0.001568       0.000128          6e-06              0              0  
    zi_7_w0_82       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622        0.2763       0.23861       0.12635      0.040998       0.008143       0.000989        7.3e-05          3e-06              0  
    zi_8_w0_94         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492        0.2185       0.27902        0.2185       0.10492       0.030863       0.005556       0.000611        4.1e-05          2e-06  
    zi_9_w1_09             0         3e-06       7.3e-05      0.000989      0.008143      0.040998       0.12635       0.23861        0.2763       0.19622       0.085427       0.022782       0.003717        0.00037        2.3e-05  
    zi_10_w1_26            0             0         6e-06      0.000128      0.001568      0.011702      0.053403       0.14921       0.25551       0.26831        0.17279       0.068209       0.016489       0.002438       0.000233  
    zi_11_w1_45            0             0             0       1.2e-05       0.00022      0.002438      0.016489      0.068209       0.17279       0.26831        0.25551        0.14921       0.053403       0.011702       0.001703  
    zi_12_w1_67            0             0             0         1e-06       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622         0.2763        0.23861        0.12635       0.040998       0.009208  
    zi_13_w1_93            0             0             0             0         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492         0.2185        0.27902         0.2185        0.10492       0.037073  
    zi_14_w2_23            0             0             0             0             0         3e-06       7.3e-05      0.000989      0.008143      0.040998        0.12635        0.23861         0.2763        0.19622        0.11232  
    zi_15_w2_57            0             0             0             0             0             0         6e-06      0.000128      0.001568      0.011702       0.053403        0.14921        0.25551        0.26831        0.26016  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Full Transition Matrix: mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

                       i1_r0_03_w0_35    i2_r0_03_w0_40    i3_r0_03_w0_46    i4_r0_03_w0_53    i5_r0_03_w0_62    i6_r0_03_w0_71    i7_r0_03_w0_82    i8_r0_03_w0_94    i9_r0_03_w1_09    i10_r0_03_w1_26    i11_r0_03_w1_45    i12_r0_03_w1_67    i13_r0_03_w1_93    i14_r0_03_w2_23    i15_r0_03_w2_57    i16_r0_49_w0_35    i17_r0_49_w0_40    i18_r0_49_w0_46    i19_r0_49_w0_53    i20_r0_49_w0_62    i21_r0_49_w0_71    i22_r0_49_w0_82    i23_r0_49_w0_94    i24_r0_49_w1_09    i25_r0_49_w1_26    i26_r0_49_w1_45    i27_r0_49_w1_67    i28_r0_49_w1_93    i29_r0_49_w2_23    i30_r0_49_w2_57    i31_r0_95_w0_35    i32_r0_95_w0_40    i33_r0_95_w0_46    i34_r0_95_w0_53    i35_r0_95_w0_62    i36_r0_95_w0_71    i37_r0_95_w0_82    i38_r0_95_w0_94    i39_r0_95_w1_09    i40_r0_95_w1_26    i41_r0_95_w1_45    i42_r0_95_w1_67    i43_r0_95_w1_93    i44_r0_95_w2_23    i45_r0_95_w2_57
                       ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________

    i1_r0_03_w0_35        0.060767          0.062672          0.059681          0.034852          0.012474          0.002733          0.000366             3e-05             1e-06                 0                  0                  0                  0                  0                  0            0.10634            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0                  0                  0                  0                  0           0.093049           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0                  0                  0                  0                  0    
    i2_r0_03_w0_40        0.026235          0.045832          0.064537          0.055733          0.029512          0.009576          0.001902          0.000231           1.7e-05             1e-06                  0                  0                  0                  0                  0           0.045912           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0                  0                  0                  0                  0           0.040173            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0                  0                  0                  0                  0    
    i3_r0_03_w0_46        0.008659          0.024506          0.051037          0.065171          0.051037          0.024506          0.007209          0.001298          0.000143             1e-05                  0                  0                  0                  0                  0           0.015154           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06                  0                  0                  0                  0            0.01326           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06                  0                  0                  0                  0    
    i4_r0_03_w0_53        0.002151          0.009576          0.029512          0.055733          0.064537          0.045832          0.019954          0.005321          0.000868           8.7e-05              5e-06                  0                  0                  0                  0           0.003764           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              9e-06                  0                  0                  0                  0           0.003293           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06                  0                  0                  0                  0    
    i5_r0_03_w0_62        0.000398          0.002733          0.012474          0.034852          0.059681          0.062672           0.04036          0.015932          0.003851          0.000569            5.1e-05              3e-06                  0                  0                  0           0.000696           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997              9e-05              5e-06                  0                  0                  0           0.000609           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            7.9e-05              4e-06                  0                  0                  0    
    i6_r0_03_w0_71         5.4e-05          0.000569          0.003851          0.015932           0.04036          0.062672          0.059681          0.034852          0.012474          0.002733           0.000366              3e-05              1e-06                  0                  0            9.5e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0            8.3e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0    
    i7_r0_03_w0_82           5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832          0.064537          0.055733          0.029512          0.009576           0.001902           0.000231            1.7e-05              1e-06                  0              1e-05           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0    
    i8_r0_03_w0_94               0             1e-05          0.000143          0.001298          0.007209          0.024506          0.051037          0.065171          0.051037          0.024506           0.007209           0.001298           0.000143              1e-05                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06    
    i9_r0_03_w1_09               0             1e-06           1.7e-05          0.000231          0.001902          0.009576          0.029512          0.055733          0.064537          0.045832           0.019954           0.005321           0.000868            8.7e-05              5e-06                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              1e-05                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06    
    i10_r0_03_w1_26              0                 0             1e-06             3e-05          0.000366          0.002733          0.012474          0.034852          0.059681          0.062672            0.04036           0.015932           0.003851           0.000569            5.4e-05                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997            9.5e-05                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            8.3e-05    
    i11_r0_03_w1_45              0                 0                 0             3e-06           5.1e-05          0.000569          0.003851          0.015932           0.04036          0.062672           0.059681           0.034852           0.012474           0.002733           0.000398                  0                  0                  0              5e-06              9e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000696                  0                  0                  0              4e-06            7.9e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000609    
    i12_r0_03_w1_67              0                 0                 0                 0             5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832           0.064537           0.055733           0.029512           0.009576           0.002151                  0                  0                  0                  0              9e-06           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003764                  0                  0                  0                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.003293    
    i13_r0_03_w1_93              0                 0                 0                 0                 0             1e-05          0.000143          0.001298          0.007209          0.024506           0.051037           0.065171           0.051037           0.024506           0.008659                  0                  0                  0                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.015154                  0                  0                  0                  0              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525            0.01326    
    i14_r0_03_w2_23              0                 0                 0                 0                 0             1e-06           1.7e-05          0.000231          0.001902          0.009576           0.029512           0.055733           0.064537           0.045832           0.026235                  0                  0                  0                  0                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.045912                  0                  0                  0                  0                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.040173    
    i15_r0_03_w2_57              0                 0                 0                 0                 0                 0             1e-06             3e-05          0.000366          0.002733           0.012474           0.034852           0.059681           0.062672           0.060767                  0                  0                  0                  0                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.10634                  0                  0                  0                  0                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.093049    
    i16_r0_49_w0_35       0.060767          0.062672          0.059681          0.034852          0.012474          0.002733          0.000366             3e-05             1e-06                 0                  0                  0                  0                  0                  0            0.10634            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0                  0                  0                  0                  0           0.093049           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0                  0                  0                  0                  0    
    i17_r0_49_w0_40       0.026235          0.045832          0.064537          0.055733          0.029512          0.009576          0.001902          0.000231           1.7e-05             1e-06                  0                  0                  0                  0                  0           0.045912           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0                  0                  0                  0                  0           0.040173            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0                  0                  0                  0                  0    
    i18_r0_49_w0_46       0.008659          0.024506          0.051037          0.065171          0.051037          0.024506          0.007209          0.001298          0.000143             1e-05                  0                  0                  0                  0                  0           0.015154           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06                  0                  0                  0                  0            0.01326           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06                  0                  0                  0                  0    
    i19_r0_49_w0_53       0.002151          0.009576          0.029512          0.055733          0.064537          0.045832          0.019954          0.005321          0.000868           8.7e-05              5e-06                  0                  0                  0                  0           0.003764           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              9e-06                  0                  0                  0                  0           0.003293           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06                  0                  0                  0                  0    
    i20_r0_49_w0_62       0.000398          0.002733          0.012474          0.034852          0.059681          0.062672           0.04036          0.015932          0.003851          0.000569            5.1e-05              3e-06                  0                  0                  0           0.000696           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997              9e-05              5e-06                  0                  0                  0           0.000609           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            7.9e-05              4e-06                  0                  0                  0    
    i21_r0_49_w0_71        5.4e-05          0.000569          0.003851          0.015932           0.04036          0.062672          0.059681          0.034852          0.012474          0.002733           0.000366              3e-05              1e-06                  0                  0            9.5e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0            8.3e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0    
    i22_r0_49_w0_82          5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832          0.064537          0.055733          0.029512          0.009576           0.001902           0.000231            1.7e-05              1e-06                  0              1e-05           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0    
    i23_r0_49_w0_94              0             1e-05          0.000143          0.001298          0.007209          0.024506          0.051037          0.065171          0.051037          0.024506           0.007209           0.001298           0.000143              1e-05                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06    
    i24_r0_49_w1_09              0             1e-06           1.7e-05          0.000231          0.001902          0.009576          0.029512          0.055733          0.064537          0.045832           0.019954           0.005321           0.000868            8.7e-05              5e-06                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              1e-05                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06    
    i25_r0_49_w1_26              0                 0             1e-06             3e-05          0.000366          0.002733          0.012474          0.034852          0.059681          0.062672            0.04036           0.015932           0.003851           0.000569            5.4e-05                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997            9.5e-05                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            8.3e-05    
    i26_r0_49_w1_45              0                 0                 0             3e-06           5.1e-05          0.000569          0.003851          0.015932           0.04036          0.062672           0.059681           0.034852           0.012474           0.002733           0.000398                  0                  0                  0              5e-06              9e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000696                  0                  0                  0              4e-06            7.9e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000609    
    i27_r0_49_w1_67              0                 0                 0                 0             5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832           0.064537           0.055733           0.029512           0.009576           0.002151                  0                  0                  0                  0              9e-06           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003764                  0                  0                  0                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.003293    
    i28_r0_49_w1_93              0                 0                 0                 0                 0             1e-05          0.000143          0.001298          0.007209          0.024506           0.051037           0.065171           0.051037           0.024506           0.008659                  0                  0                  0                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.015154                  0                  0                  0                  0              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525            0.01326    
    i29_r0_49_w2_23              0                 0                 0                 0                 0             1e-06           1.7e-05          0.000231          0.001902          0.009576           0.029512           0.055733           0.064537           0.045832           0.026235                  0                  0                  0                  0                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.045912                  0                  0                  0                  0                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.040173    
    i30_r0_49_w2_57              0                 0                 0                 0                 0                 0             1e-06             3e-05          0.000366          0.002733           0.012474           0.034852           0.059681           0.062672           0.060767                  0                  0                  0                  0                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.10634                  0                  0                  0                  0                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.093049    
    i31_r0_95_w0_35       0.060767          0.062672          0.059681          0.034852          0.012474          0.002733          0.000366             3e-05             1e-06                 0                  0                  0                  0                  0                  0            0.10634            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0                  0                  0                  0                  0           0.093049           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0                  0                  0                  0                  0    
    i32_r0_95_w0_40       0.026235          0.045832          0.064537          0.055733          0.029512          0.009576          0.001902          0.000231           1.7e-05             1e-06                  0                  0                  0                  0                  0           0.045912           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0                  0                  0                  0                  0           0.040173            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0                  0                  0                  0                  0    
    i33_r0_95_w0_46       0.008659          0.024506          0.051037          0.065171          0.051037          0.024506          0.007209          0.001298          0.000143             1e-05                  0                  0                  0                  0                  0           0.015154           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06                  0                  0                  0                  0            0.01326           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06                  0                  0                  0                  0    
    i34_r0_95_w0_53       0.002151          0.009576          0.029512          0.055733          0.064537          0.045832          0.019954          0.005321          0.000868           8.7e-05              5e-06                  0                  0                  0                  0           0.003764           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              9e-06                  0                  0                  0                  0           0.003293           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06                  0                  0                  0                  0    
    i35_r0_95_w0_62       0.000398          0.002733          0.012474          0.034852          0.059681          0.062672           0.04036          0.015932          0.003851          0.000569            5.1e-05              3e-06                  0                  0                  0           0.000696           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997              9e-05              5e-06                  0                  0                  0           0.000609           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            7.9e-05              4e-06                  0                  0                  0    
    i36_r0_95_w0_71        5.4e-05          0.000569          0.003851          0.015932           0.04036          0.062672          0.059681          0.034852          0.012474          0.002733           0.000366              3e-05              1e-06                  0                  0            9.5e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000641            5.2e-05              3e-06                  0                  0            8.3e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000561            4.6e-05              2e-06                  0                  0    
    i37_r0_95_w0_82          5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832          0.064537          0.055733          0.029512          0.009576           0.001902           0.000231            1.7e-05              1e-06                  0              1e-05           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003328           0.000404              3e-05              1e-06                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.002912           0.000354            2.6e-05              1e-06                  0    
    i38_r0_95_w0_94              0             1e-05          0.000143          0.001298          0.007209          0.024506          0.051037          0.065171          0.051037          0.024506           0.007209           0.001298           0.000143              1e-05                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.012616           0.002271            0.00025            1.7e-05              1e-06              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525           0.011039           0.001987           0.000219            1.5e-05              1e-06    
    i39_r0_95_w1_09              0             1e-06           1.7e-05          0.000231          0.001902          0.009576          0.029512          0.055733          0.064537          0.045832           0.019954           0.005321           0.000868            8.7e-05              5e-06                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.034919           0.009312           0.001519           0.000151              1e-05                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.030554           0.008148           0.001329           0.000132              8e-06    
    i40_r0_95_w1_26              0                 0             1e-06             3e-05          0.000366          0.002733          0.012474          0.034852          0.059681          0.062672            0.04036           0.015932           0.003851           0.000569            5.4e-05                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.07063           0.027881            0.00674           0.000997            9.5e-05                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.061801           0.024396           0.005897           0.000872            8.3e-05    
    i41_r0_95_w1_45              0                 0                 0             3e-06           5.1e-05          0.000569          0.003851          0.015932           0.04036          0.062672           0.059681           0.034852           0.012474           0.002733           0.000398                  0                  0                  0              5e-06              9e-05           0.000997            0.00674           0.027881            0.07063            0.10967            0.10444           0.060991           0.021829           0.004783           0.000696                  0                  0                  0              4e-06            7.9e-05           0.000872           0.005897           0.024396           0.061801           0.095966           0.091387           0.053367             0.0191           0.004185           0.000609    
    i42_r0_95_w1_67              0                 0                 0                 0             5e-06           8.7e-05          0.000868          0.005321          0.019954          0.045832           0.064537           0.055733           0.029512           0.009576           0.002151                  0                  0                  0                  0              9e-06           0.000151           0.001519           0.009312           0.034919           0.080206            0.11294           0.097533           0.051646           0.016758           0.003764                  0                  0                  0                  0              8e-06           0.000132           0.001329           0.008148           0.030554            0.07018           0.098823           0.085341           0.045191           0.014664           0.003293    
    i43_r0_95_w1_93              0                 0                 0                 0                 0             1e-05          0.000143          0.001298          0.007209          0.024506           0.051037           0.065171           0.051037           0.024506           0.008659                  0                  0                  0                  0              1e-06            1.7e-05            0.00025           0.002271           0.012616           0.042885           0.089316            0.11405           0.089316           0.042885           0.015154                  0                  0                  0                  0              1e-06            1.5e-05           0.000219           0.001987           0.011039           0.037525           0.078151           0.099794           0.078151           0.037525            0.01326    
    i44_r0_95_w2_23              0                 0                 0                 0                 0             1e-06           1.7e-05          0.000231          0.001902          0.009576           0.029512           0.055733           0.064537           0.045832           0.026235                  0                  0                  0                  0                  0              1e-06              3e-05           0.000404           0.003328           0.016758           0.051646           0.097533            0.11294           0.080206           0.045912                  0                  0                  0                  0                  0              1e-06            2.6e-05           0.000354           0.002912           0.014664           0.045191           0.085341           0.098823            0.07018           0.040173    
    i45_r0_95_w2_57              0                 0                 0                 0                 0                 0             1e-06             3e-05          0.000366          0.002733           0.012474           0.034852           0.059681           0.062672           0.060767                  0                  0                  0                  0                  0                  0              3e-06            5.2e-05           0.000641           0.004783           0.021829           0.060991            0.10444            0.10967            0.10634                  0                  0                  0                  0                  0                  0              2e-06            4.6e-05           0.000561           0.004185             0.0191           0.053367           0.091387           0.095966           0.093049    

</pre><h2 id="14">FIBS1: Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);
</pre><h2 id="15">FIBS2: Get Formal Borrowing Blocks</h2><pre class="codeinput">[ar_forbrblk, ar_forbrblk_r] = <span class="keyword">...</span>
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);
</pre><h2 id="16">Find Formal and Informal Choices for Borrowing points</h2><p>Here we solve for the optimal formal and informal choices given b. Note that kind of like the static firm's maximization problem. Here the optimization problem is static, and can be done independently of the overall dynamic optimization problem.</p><pre class="codeinput"><span class="comment">% When borrowing index and array</span>
<span class="comment">% note index for negative is from _ar_a_meshk_full_, but value from</span>
<span class="comment">% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some</span>
<span class="comment">% of these points _ar_a_nobridge_meshk_ = 0. But need to use</span>
<span class="comment">% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all</span>
<span class="comment">% borrowing.</span>
ar_bl_ameshk_neg_idx = (ar_a_meshk_full &lt; 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

<span class="comment">% Given b, solve for optimal formal and informal choices.</span>
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = <span class="keyword">...</span>
   ffs_fibs_min_c_cost(bl_b_is_principle, ar_z_r_borr, fl_r_fsv, <span class="keyword">...</span>
                         ar_forbrblk_r, ar_forbrblk, <span class="keyword">...</span>
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);
</pre><h2 id="17">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</h2><p><b>ar_coh_fbis_aneg</b>: the consumption cost to t+1 from borrowing in t given formal and informal joint choice optimization.</p><p>Reachable cash-on-hand borrowing points: N_neg*N^2 rows</p><p>Additionally, need to convert borrowing choices to consumption units next period. borrowing choices in percentage are in unit of last period borrowing, principles only, need to convert to interest rates plus principle which means considering which formal informal choice combination maximizes cash-on-hand for the same level of overall principles.</p><p>Construct another percentage, which is, percentages of ar_a_meshk_full when w &lt; 0. Percentage represents what fraction of the a debt is going towards bridge loan debts. Note that as long as w &lt; 0, b &lt; 0 must be the case as well. So for negative elements of w, there is a triple mesh: N points for A x N points for K x N points for Bridge.</p><pre class="codeinput">ar_coh_fbis_aneg = f_coh_fbis(ar_z_r_borr, <span class="keyword">...</span>
                                ar_for_borr_aneg, <span class="keyword">...</span>
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), <span class="keyword">...</span>
                                ar_for_save_aneg);
</pre><h2 id="18">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</h2><p><b>ar_coh_save_apos</b>: the consumption gain to t+1 from savings in t</p><pre class="codeinput">ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);
</pre><h2 id="19">COH1: Combine overall Reachable Cash-on-Hand Levels</h2><p>ROWS: N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count. These are the cash-on-hand points reachable given percentage grid choice structure and the possibility of bridge loans. COLUMNS: determined by length(ar_z_r_borr), each column a different informal borrowing interest rate.</p><div><ol><li>mt_coh_wkb_full: this is the (P^k x I^w x M^r) by (M^z) matrix, where rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n, and cols = it_z_wage_n.</li></ol></div><pre class="codeinput">mt_ameshk_tnext_with_r = zeros(length(ar_k_mesha), fl_z_r_borr_n);
mt_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx, :) = ar_coh_fbis_aneg;
mt_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx, :) = zeros(1, fl_z_r_borr_n) + ar_coh_save_apos;

<span class="comment">% # mt_ameshk_tnext_with_r: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w ) by (M^r) matrix</span>
<span class="comment">% # mt_coh_wkb_full: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix</span>

mt_k_mesha_mesh_z_wage = ar_k_mesha + zeros(1, fl_z_r_borr_n);
mt_coh_wkb_full = f_coh(ar_z_wage, mt_ameshk_tnext_with_r(:), mt_k_mesha_mesh_z_wage(:));

<span class="comment">% Generate Aggregate Variables</span>
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

<span class="keyword">if</span> (bl_display_funcgrids || bl_graph_funcgrids)

    <span class="comment">% Generate Aggregate Variables</span>
    mt_bwithrplusk_mesh = mt_ameshk_tnext_with_r + ar_k_mesha;

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([mt_bwithrplusk_mesh, ar_aplusk_mesh, <span class="keyword">...</span>
                                  ar_k_mesha, mt_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = [strcat(<span class="string">'mt_bwthrplusk'</span>, string((1:length(ar_z_r_borr)))), <span class="keyword">...</span>
                    <span class="string">'ar_aplusk_mesha'</span>, <span class="string">'ar_k_mesha'</span>, <span class="keyword">...</span>
                    strcat(<span class="string">'mt_a_wth_r_borr'</span>, string((1:length(ar_z_r_borr)))), <span class="keyword">...</span>
                    <span class="string">'ar_a_meshk'</span>, <span class="string">'ar_a_nobridge_meshk'</span>, <span class="string">'ar_bridge_a'</span>];
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_nobridge_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aprime_nobridge*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bridge_a'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bridge_a*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'tab_ak_choices'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_aplusk_mesha*:
*ar_k_mesha*:
*ar_a_meshk*:
*ar_aprime_nobridge*:
*ar_bridge_a*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
tab_ak_choices
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   385    11

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3    tab_ak_choices4    tab_ak_choices5    tab_ak_choices6     tab_ak_choices7     tab_ak_choices8     tab_ak_choices9     tab_ak_choices10      tab_ak_choices11
    mt_bwthrplusk1     mt_bwthrplusk2     mt_bwthrplusk3     ar_aplusk_mesha      ar_k_mesha       mt_a_wth_r_borr1    mt_a_wth_r_borr2    mt_a_wth_r_borr3      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a   
    _______________    _______________    _______________    _______________    _______________    ________________    ________________    ________________    _______________    ___________________    ________________

         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
         -20.5             -29.75                -39                 -20                  0               -20.5             -29.75                 -39                 -20                     0                 -20     
       -18.326            -26.596            -34.866             -17.879          0.0021212             -18.328            -26.598             -34.868             -17.881            -0.0021212             -17.879     
       -18.335            -26.644            -34.913             -17.879            0.35495              -18.69            -26.999             -35.267             -18.234              -0.35495             -17.879     
       -18.343            -26.652            -34.921             -17.879            0.70778             -19.051             -27.36             -35.629             -18.587              -0.70778             -17.879     
       -18.352            -26.689            -34.986             -17.879             1.0606             -19.413             -27.75             -36.047             -18.939               -1.0606             -17.879     
       -18.361             -26.73            -34.999             -17.879             1.4134             -19.775            -28.143             -36.412             -19.292               -1.4134             -17.879     
        -18.37            -26.739            -35.008             -17.879             1.7663             -20.136            -28.505             -36.774             -19.645               -1.7663             -17.879     
       -18.379            -26.748            -35.017             -17.879             2.1191             -20.498            -28.867             -37.136             -19.998               -2.1191             -17.879     
       -16.152            -23.441            -30.731             -15.758          0.0042424             -16.156            -23.446             -30.736             -15.762            -0.0042424             -15.758     
       -16.169            -23.497            -30.785             -15.758             0.7099             -16.879            -24.207             -31.495             -16.467               -0.7099             -15.758     
       -16.187            -23.575            -30.863             -15.758             1.4156             -17.602             -24.99             -32.278             -17.173               -1.4156             -15.758     
       -16.205            -23.592             -30.88             -15.758             2.1212             -18.326            -25.714             -33.002             -17.879               -2.1212             -15.758     
       -16.222             -23.67            -30.958             -15.758             2.8269             -19.049            -26.497             -33.785             -18.584               -2.8269             -15.758     
        -16.24            -23.688            -30.976             -15.758             3.5325             -19.772             -27.22             -34.508              -19.29               -3.5325             -15.758     
       -16.257            -23.765            -31.053             -15.758             4.2382             -20.496            -28.004             -35.291             -19.996               -4.2382             -15.758     
       -13.977            -20.287            -26.597             -13.636          0.0063636             -13.984            -20.294             -26.603             -13.643            -0.0063636             -13.636     
       -14.004            -20.381            -26.718             -13.636             1.0648             -15.069            -21.446             -27.782             -14.701               -1.0648             -13.636     
        -14.03            -20.437            -26.744             -13.636             2.1233             -16.154            -22.561             -28.867              -15.76               -2.1233             -13.636     
       -14.057            -20.524             -26.83             -13.636             3.1818             -17.239            -23.705             -30.012             -16.818               -3.1818             -13.636     
       -14.083             -20.61            -26.917             -13.636             4.2403             -18.324             -24.85             -31.157             -17.877               -4.2403             -13.636     
        -14.11            -20.637            -26.943             -13.636             5.2988             -19.409            -25.935             -32.242             -18.935               -5.2988             -13.636     
       -14.136            -20.723             -27.03             -13.636             6.3573             -20.493             -27.08             -33.387             -19.994               -6.3573             -13.636     
       -11.803            -17.133            -22.463             -11.515          0.0084848             -11.812            -17.141             -22.471             -11.524            -0.0084848             -11.515     
       -11.839            -17.264             -22.59             -11.515             1.4198             -13.258            -18.684              -24.01             -12.935               -1.4198             -11.515     
       -11.874             -17.36            -22.685             -11.515             2.8311             -14.705            -20.191             -25.516             -14.346               -2.8311             -11.515     
       -11.909            -17.455            -22.781             -11.515             4.2424             -16.152            -21.697             -27.023             -15.758               -4.2424             -11.515     
       -11.944             -17.55            -22.876             -11.515             5.6537             -17.598            -23.204              -28.53             -17.169               -5.6537             -11.515     
        -11.98            -17.616            -22.971             -11.515             7.0651             -19.045            -24.681             -30.036              -18.58               -7.0651             -11.515     
       -12.015            -17.741            -23.066             -11.515             8.4764             -20.491            -26.217             -31.543             -19.992               -8.4764             -11.515     
       -9.6291            -13.979            -18.328             -9.3939           0.010606             -9.6397            -13.989             -18.339             -9.4045             -0.010606             -9.3939     
       -9.6732            -14.118            -18.463             -9.3939             1.7747             -11.448            -15.893             -20.237             -11.169               -1.7747             -9.3939     
       -9.7173            -14.222            -18.567             -9.3939             3.5389             -13.256            -17.761             -22.106             -12.933               -3.5389             -9.3939     
       -9.7614            -14.326            -18.671             -9.3939              5.303             -15.064            -19.629             -23.974             -14.697                -5.303             -9.3939     
       -9.8055            -14.461            -18.837             -9.3939             7.0672             -16.873            -21.528             -25.904             -16.461               -7.0672             -9.3939     
       -9.8496            -14.594            -18.939             -9.3939             8.8313             -18.681            -23.426              -27.77             -18.225               -8.8313             -9.3939     
       -9.8937            -14.818            -19.163             -9.3939             10.595             -20.489            -25.414             -29.759             -19.989               -10.595             -9.3939     
       -7.4549            -10.824            -14.194             -7.2727           0.012727             -7.4676            -10.837             -14.207             -7.2855             -0.012727             -7.2727     
       -7.5078            -10.971            -14.335             -7.2727             2.1297             -9.6375            -13.101             -16.465             -9.4024               -2.1297             -7.2727     
       -7.5607            -11.144            -14.508             -7.2727             4.2467             -11.807            -15.391             -18.755             -11.519               -4.2467             -7.2727     
       -7.6136            -11.257            -14.621             -7.2727             6.3636             -13.977            -17.621             -20.985             -13.636               -6.3636             -7.2727     
       -7.6666             -11.43            -14.794             -7.2727             8.4806             -16.147            -19.911             -23.274             -15.753               -8.4806             -7.2727     
       -7.7195            -11.663            -15.027             -7.2727             10.598             -18.317            -22.261             -25.624              -17.87               -10.598             -7.2727     
       -7.7724            -11.716             -15.08             -7.2727             12.715             -20.487            -24.431             -27.794             -19.987               -12.715             -7.2727     
       -5.2807            -7.6701             -10.06             -5.1515           0.014848             -5.2955             -7.685             -10.074             -5.1664             -0.014848             -5.1515     
       -5.3424             -7.825            -10.208             -5.1515             2.4846             -7.8271             -10.31             -12.692             -7.6362               -2.4846             -5.1515     
       -5.4042            -8.0067            -10.389             -5.1515             4.9544             -10.359            -12.961             -15.344             -10.106               -4.9544             -5.1515     
       -5.4659            -8.2485            -10.631             -5.1515             7.4242              -12.89            -15.673             -18.055             -12.576               -7.4242             -5.1515     
       -5.5277            -8.3102            -10.693             -5.1515              9.894             -15.422            -18.204             -20.587             -15.046                -9.894             -5.1515     
       -5.5894             -8.552            -10.935             -5.1515             12.364             -17.953            -20.916             -23.298             -17.515               -12.364             -5.1515     
       -5.6511             -8.768            -11.176             -5.1515             14.834             -20.485            -23.602              -26.01             -19.985               -14.834             -5.1515     
       -3.1065            -4.5158            -5.9252             -3.0303            0.01697             -3.1235            -4.5328             -5.9422             -3.0473              -0.01697             -3.0303     
       -3.1771            -4.7386            -6.1401             -3.0303             2.8396             -6.0166            -7.5782             -8.9797             -5.8699               -2.8396             -3.0303     
       -3.2476            -4.9291            -6.3306             -3.0303             5.6622             -8.9098            -10.591             -11.993             -8.6925               -5.6622             -3.0303     
       -3.3182            -5.1197            -6.5212             -3.0303             8.4848             -11.803            -13.605             -15.006             -11.515               -8.4848             -3.0303     
       -3.3887            -5.3703            -6.7718             -3.0303             11.307             -14.696            -16.678             -18.079             -14.338               -11.307             -3.0303     
       -3.4593            -5.4408            -6.8423             -3.0303              14.13             -17.589            -19.571             -20.972              -17.16                -14.13             -3.0303     
       -3.5299            -5.6914            -7.0929             -3.0303             16.953             -20.483            -22.644             -24.046             -19.983               -16.953             -3.0303     
       -0.9323            -1.3616            -1.7909            -0.90909           0.019091            -0.95139            -1.3807               -1.81            -0.92818             -0.019091            -0.90909     
       -1.0117            -1.5921            -2.0126            -0.90909             3.1945             -4.2062            -4.7867             -5.2071             -4.1036               -3.1945            -0.90909     
       -1.0911            -1.7915             -2.212            -0.90909               6.37             -7.4611            -8.1615              -8.582             -7.2791                 -6.37            -0.90909     
       -1.1705            -1.9909            -2.4114            -0.90909             9.5455             -10.716            -11.536             -11.957             -10.455               -9.5455            -0.90909     
       -1.2498            -2.2503            -2.6707            -0.90909             12.721             -13.971            -14.971             -15.392              -13.63               -12.721            -0.90909     
       -1.3292            -2.5097            -2.9301            -0.90909             15.896             -17.226            -18.406             -18.826             -16.805               -15.896            -0.90909     
       -1.4086            -2.6223             -3.076            -0.90909             19.072              -20.48            -21.694             -22.148             -19.981               -19.072            -0.90909     

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3    tab_ak_choices4    tab_ak_choices5    tab_ak_choices6     tab_ak_choices7     tab_ak_choices8     tab_ak_choices9     tab_ak_choices10      tab_ak_choices11
    mt_bwthrplusk1     mt_bwthrplusk2     mt_bwthrplusk3     ar_aplusk_mesha      ar_k_mesha       mt_a_wth_r_borr1    mt_a_wth_r_borr2    mt_a_wth_r_borr3      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a   
    _______________    _______________    _______________    _______________    _______________    ________________    ________________    ________________    _______________    ___________________    ________________

        31.681             31.681             31.681             30.909            0.050909               31.63               31.63               31.63             30.858               30.858                 0        
        31.469             31.469             31.469             30.909              8.5188               22.95               22.95               22.95              22.39                22.39                 0        
        31.257             31.257             31.257             30.909              16.987               14.27               14.27               14.27             13.922               13.922                 0        
        31.045             31.045             31.045             30.909              25.455              5.5909              5.5909              5.5909             5.4545               5.4545                 0        
        30.834             30.674             30.674             30.909              33.922             -3.0887             -3.2487             -3.2487            -3.0133              -3.0133                 0        
        30.622             30.042             30.042             30.909               42.39             -11.768             -12.348             -12.348            -11.481              -11.481                 0        
         30.41             29.211             28.772             30.909              50.858             -20.448             -21.647             -22.086            -19.949              -19.949                 0        
        33.855             33.855             33.855              33.03             0.05303              33.802              33.802              33.802             32.977               32.977                 0        
        33.634             33.634             33.634              33.03              8.8737               24.76               24.76               24.76             24.157               24.157                 0        
        33.414             33.414             33.414              33.03              17.694              15.719              15.719              15.719             15.336               15.336                 0        
        33.193             33.193             33.193              33.03              26.515               6.678               6.678               6.678             6.5152               6.5152                 0        
        32.973             32.873             32.873              33.03              35.336             -2.3632             -2.4632             -2.4632            -2.3056              -2.3056                 0        
        32.752             32.172             32.172              33.03              44.157             -11.404             -11.984             -11.984            -11.126              -11.126                 0        
        32.532             31.334             30.896              33.03              52.977             -20.446             -21.644             -22.082            -19.947              -19.947                 0        
        36.029             36.029             36.029             35.152            0.055152              35.974              35.974              35.974             35.096               35.096                 0        
          35.8               35.8               35.8             35.152              9.2287              26.571              26.571              26.571             25.923               25.923                 0        
         35.57              35.57              35.57             35.152              18.402              17.168              17.168              17.168             16.749               16.749                 0        
        35.341             35.341             35.341             35.152              27.576              7.7652              7.7652              7.7652             7.5758               7.5758                 0        
        35.112             35.012             35.012             35.152              36.749             -1.6377             -1.7377             -1.7377            -1.5978              -1.5978                 0        
        34.882             34.302             34.302             35.152              45.923             -11.041             -11.621             -11.621            -10.771              -10.771                 0        
        34.653             33.456             33.019             35.152              55.096             -20.443              -21.64             -22.077            -19.945              -19.945                 0        
        38.203             38.203             38.203             37.273            0.057273              38.146              38.146              38.146             37.215               37.215                 0        
        37.965             37.965             37.965             37.273              9.5836              28.381              28.381              28.381             27.689               27.689                 0        
        37.727             37.727             37.727             37.273               19.11              18.617              18.617              18.617             18.163               18.163                 0        
        37.489             37.489             37.489             37.273              28.636              8.8523              8.8523              8.8523             8.6364               8.6364                 0        
         37.25              37.21              37.21             37.273              38.163            -0.91225            -0.95225            -0.95225              -0.89                -0.89                 0        
        37.012             36.432             36.432             37.273              47.689             -10.677             -11.257             -11.257            -10.416              -10.416                 0        
        36.774             35.578             35.142             37.273              57.215             -20.441             -21.637             -22.073            -19.943              -19.943                 0        
        40.377             40.377             40.377             39.394            0.059394              40.318              40.318              40.318             39.335               39.335                 0        
         40.13              40.13              40.13             39.394              9.9386              30.192              30.192              30.192             29.455               29.455                 0        
        39.883             39.883             39.883             39.394              19.818              20.066              20.066              20.066             19.576               19.576                 0        
        39.636             39.636             39.636             39.394              29.697              9.9394              9.9394              9.9394              9.697                9.697                 0        
        39.389             39.349             39.349             39.394              39.576            -0.18678            -0.22678            -0.22678           -0.18222             -0.18222                 0        
        39.142             38.714             38.686             39.394              49.455             -10.313             -10.741              -10.77            -10.061              -10.061                 0        
        38.895               37.7             37.265             39.394              59.335             -20.439             -21.634             -22.069            -19.941              -19.941                 0        
        42.551             42.551             42.551             41.515            0.061515               42.49               42.49               42.49             41.454               41.454                 0        
        42.296             42.296             42.296             41.515              10.294              32.002              32.002              32.002             31.222               31.222                 0        
         42.04              42.04              42.04             41.515              20.526              21.514              21.514              21.514              20.99                20.99                 0        
        41.784             41.784             41.784             41.515              30.758              11.027              11.027              11.027             10.758               10.758                 0        
        41.528             41.528             41.528             41.515               40.99             0.53869             0.53869             0.53869            0.52556              0.52556                 0        
        41.272             40.872             40.872             41.515              51.222             -9.9491             -10.349             -10.349            -9.7065              -9.7065                 0        
        41.017             39.823             39.389             41.515              61.454             -20.437             -21.631             -22.065            -19.938              -19.938                 0        
        44.726             44.726             44.726             43.636            0.063636              44.662              44.662              44.662             43.573               43.573                 0        
        44.461             44.461             44.461             43.636              10.648              33.813              33.813              33.813             32.988               32.988                 0        
        44.196             44.196             44.196             43.636              21.233              22.963              22.963              22.963             22.403               22.403                 0        
        43.932             43.932             43.932             43.636              31.818              12.114              12.114              12.114             11.818               11.818                 0        
        43.667             43.667             43.667             43.636              42.403              1.2642              1.2642              1.2642             1.2333               1.2333                 0        
        43.403             43.003             43.003             43.636              52.988             -9.5853             -9.9853             -9.9853            -9.3515              -9.3515                 0        
        43.138             41.945             41.512             43.636              63.573             -20.435             -21.628             -22.061            -19.936              -19.936                 0        
          46.9               46.9               46.9             45.758            0.065758              46.834              46.834              46.834             45.692               45.692                 0        
        46.626             46.626             46.626             45.758              11.003              35.623              35.623              35.623             34.754               34.754                 0        
        46.353             46.353             46.353             45.758              21.941              24.412              24.412              24.412             23.816               23.816                 0        
         46.08              46.08              46.08             45.758              32.879              13.201              13.201              13.201             12.879               12.879                 0        
        45.806             45.806             45.806             45.758              43.816              1.9896              1.9896              1.9896             1.9411               1.9411                 0        
        45.533             45.133             45.133             45.758              54.754             -9.2215             -9.6215             -9.6215            -8.9966              -8.9966                 0        
        45.259             44.067             43.635             45.758              65.692             -20.433             -21.625             -22.057            -19.934              -19.934                 0        
        49.074             49.074             49.074             47.879            0.067879              49.006              49.006              49.006             47.811               47.811                 0        
        48.792             48.792             48.792             47.879              11.358              37.433              37.433              37.433              36.52                36.52                 0        
         48.51              48.51              48.51             47.879              22.649              25.861              25.861              25.861              25.23                25.23                 0        
        48.227             48.227             48.227             47.879              33.939              14.288              14.288              14.288             13.939               13.939                 0        
        47.945             47.945             47.945             47.879               45.23              2.7151              2.7151              2.7151             2.6489               2.6489                 0        
        47.663             47.263             47.263             47.879               56.52             -8.8577             -9.2577             -9.2577            -8.6416              -8.6416                 0        
         47.38             46.189             45.758             47.879              67.811              -20.43             -21.622             -22.053            -19.932              -19.932                 0        
        51.248             51.248             51.248                 50                0.07              51.178              51.178              51.178              49.93                49.93                 0        
        50.957             50.957             50.957                 50              11.713              39.244              39.244              39.244             38.287               38.287                 0        
        50.666             50.666             50.666                 50              23.357              27.309              27.309              27.309             26.643               26.643                 0        
        50.375             50.375             50.375                 50                  35              15.375              15.375              15.375                 15                   15                 0        
        50.084             50.084             50.084                 50              46.643              3.4406              3.4406              3.4406             3.3567               3.3567                 0        
        49.793             49.393             49.393                 50              58.287             -8.4938             -8.8938             -8.8938            -8.2867              -8.2867                 0        
        49.502             48.312             47.881                 50               69.93             -20.428             -21.618             -22.049             -19.93               -19.93                 0        

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        1155          15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056               -20.056              -20.056             -20.056              -20.056     
         -17.844             -17.839             -17.832             -17.824             -17.815             -17.805             -17.793             -17.779             -17.764             -17.745              -17.724                 -17.7              -17.672              -17.64              -17.602     
          -17.68             -17.643             -17.601             -17.552             -17.496             -17.431             -17.356             -17.269             -17.169             -17.054              -16.921               -16.768              -16.591             -16.387              -16.151     
          -17.65             -17.603             -17.548             -17.486             -17.413              -17.33             -17.234             -17.123             -16.995             -16.847              -16.676                -16.48              -16.253             -15.991               -15.69     
         -17.639             -17.584             -17.521             -17.449             -17.365             -17.269             -17.157             -17.029             -16.881              -16.71              -16.513               -16.285              -16.023             -15.721              -15.371     
         -17.637             -17.577             -17.507             -17.426             -17.334             -17.227             -17.103             -16.961             -16.797             -16.607              -16.389               -16.136              -15.846              -15.51              -15.123     
         -17.641             -17.576               -17.5             -17.413             -17.313             -17.197             -17.063             -16.909             -16.731             -16.525              -16.288               -16.015                -15.7             -15.337              -14.917     
         -17.649             -17.579             -17.499             -17.406             -17.298             -17.175             -17.032             -16.867             -16.677             -16.458              -16.205               -15.913              -15.577             -15.189              -14.741     
          -15.66             -15.652             -15.644             -15.634             -15.622             -15.609             -15.594             -15.576             -15.556             -15.532              -15.505               -15.474              -15.438             -15.397              -15.349     
         -15.475             -15.428             -15.374             -15.311             -15.239             -15.155             -15.059             -14.948             -14.819             -14.672              -14.501               -14.304              -14.077             -13.815              -13.513     
         -15.463             -15.402             -15.333             -15.252             -15.159             -15.052             -14.929             -14.786             -14.622             -14.432              -14.214               -13.961               -13.67             -13.335              -12.947     
         -15.475             -15.405             -15.325             -15.231             -15.124                 -15             -14.857             -14.693             -14.503             -14.283               -14.03               -13.738              -13.402             -13.013              -12.565     
           -15.5             -15.422             -15.333             -15.229              -15.11             -14.973             -14.815             -14.632             -14.421             -14.178              -13.897               -13.574                -13.2              -12.77              -12.273     
         -15.532             -15.448             -15.351             -15.239              -15.11             -14.961             -14.789             -14.591             -14.363             -14.099              -13.795               -13.445               -13.04             -12.574              -12.035     
         -15.569             -15.479             -15.375             -15.256             -15.118             -14.959             -14.776             -14.565             -14.321             -14.039              -13.715                -13.34              -12.909              -12.41              -11.836     
         -13.478             -13.469             -13.459             -13.448             -13.435             -13.419             -13.402             -13.381             -13.358             -13.331                -13.3               -13.263              -13.222             -13.174              -13.119     
          -13.29             -13.236             -13.173               -13.1             -13.016              -12.92             -12.808             -12.679             -12.531              -12.36              -12.163               -11.935              -11.672             -11.369               -11.02     
         -13.301             -13.231              -13.15             -13.057              -12.95             -12.826             -12.683             -12.518             -12.328             -12.109              -11.856               -11.564              -11.227             -10.838               -10.39     
         -13.341              -13.26             -13.166             -13.059             -12.935             -12.791             -12.626             -12.435             -12.215             -11.961              -11.669               -11.331              -10.941             -10.492              -9.9737     
         -13.394             -13.305             -13.201             -13.082             -12.944             -12.785             -12.602              -12.39             -12.146             -11.865               -11.54               -11.166              -10.734             -10.236              -9.6608     
         -13.457              -13.36             -13.247             -13.118             -12.969             -12.797             -12.598             -12.369             -12.104               -11.8              -11.448               -11.042              -10.574             -10.034              -9.4112     
         -13.525             -13.421             -13.301             -13.163             -13.004              -12.82             -12.608             -12.363             -12.081             -11.755               -11.38               -10.947              -10.447             -9.8704              -9.2053     
         -11.298             -11.288             -11.277             -11.264              -11.25             -11.233             -11.213             -11.191             -11.165             -11.135                -11.1                -11.06              -11.014             -10.961              -10.899     
         -11.114             -11.054             -10.984             -10.903             -10.811             -10.703              -10.58             -10.437             -10.273             -10.083              -9.8638               -9.6113                -9.32             -8.9839              -8.5962     
         -11.151             -11.074             -10.984             -10.881             -10.762             -10.624             -10.466             -10.283             -10.072             -9.8289              -9.5482               -9.2244              -8.8509               -8.42               -7.923     
          -11.22             -11.131             -11.027             -10.908              -10.77             -10.611             -10.428             -10.216              -9.972             -9.6906              -9.3659               -8.9913              -8.5593             -8.0609               -7.486     
         -11.305             -11.205             -11.091             -10.958             -10.805             -10.629             -10.426             -10.191             -9.9206             -9.6085              -9.2484               -8.8331               -8.354             -7.8013              -7.1637     
         -11.399             -11.291             -11.167             -11.023             -10.858             -10.667             -10.446             -10.192              -9.899             -9.5608              -9.1707               -8.7207              -8.2015             -7.6027              -6.9119     
           -11.5             -11.384             -11.252             -11.098             -10.922             -10.718             -10.482             -10.211              -9.898             -9.5369              -9.1203               -8.6398              -8.0855             -7.4461              -6.7084     
         -9.1186             -9.1083             -9.0963             -9.0825             -9.0665             -9.0481             -9.0269             -9.0025             -8.9742             -8.9417              -8.9041               -8.8608              -8.8108             -8.7532              -8.6866     
         -8.9444             -8.8788             -8.8031             -8.7159             -8.6152              -8.499             -8.3651             -8.2105             -8.0322             -7.8266              -7.5893               -7.3156              -6.9999             -6.6357              -6.2156     
         -9.0092             -8.9251             -8.8281             -8.7162             -8.5871             -8.4382             -8.2664             -8.0683             -7.8397             -7.5761              -7.2719                -6.921              -6.5163             -6.0494              -5.5108     
         -9.1086             -9.0113             -8.8991             -8.7697             -8.6204             -8.4481             -8.2494             -8.0202             -7.7558             -7.4508               -7.099               -6.6931              -6.2249             -5.6848              -5.0618     
         -9.2248              -9.117             -8.9925              -8.849             -8.6834             -8.4924             -8.2721             -8.0179             -7.7247             -7.3865              -6.9964               -6.5463              -6.0271             -5.4282              -4.7373     
         -9.3514             -9.2345             -9.0997             -8.9442             -8.7648             -8.5578             -8.3191             -8.0437              -7.726             -7.3595              -6.9368               -6.4491              -5.8866             -5.2376               -4.489     
          -9.485             -9.3603             -9.2163             -9.0502             -8.8587             -8.6377             -8.3828             -8.0887             -7.7495             -7.3582              -6.9068               -6.3861              -5.7855             -5.0925              -4.2932     
           -6.94             -6.9289             -6.9162             -6.9014             -6.8844             -6.8647             -6.8421              -6.816             -6.7858             -6.7511               -6.711               -6.6647              -6.6113             -6.5498              -6.4787     
         -6.7784             -6.7084             -6.6276             -6.5344             -6.4269             -6.3029             -6.1598             -5.9948             -5.8044             -5.5848              -5.3314               -5.0392              -4.7021             -4.3132              -3.8646     
         -6.8721             -6.7823             -6.6787             -6.5592             -6.4214             -6.2624              -6.079             -5.8674             -5.6233             -5.3418               -5.017               -4.6423              -4.2101             -3.7115              -3.1364     
         -7.0027             -6.8989              -6.779             -6.6408             -6.4814             -6.2975             -6.0853             -5.8406             -5.5582             -5.2325              -4.8568               -4.4234              -3.9235             -3.3467              -2.6814     
         -7.1513             -7.0362             -6.9033               -6.75             -6.5732             -6.3693              -6.134             -5.8626             -5.5495             -5.1883              -4.7717               -4.2911              -3.7367             -3.0972              -2.3594     
          -7.311             -7.1862             -7.0422             -6.8761             -6.6846             -6.4636             -6.2086             -5.9146             -5.5753              -5.184              -4.7326               -4.2118              -3.6111             -2.9181              -2.1188     
         -7.4782             -7.3449             -7.1912             -7.0139             -6.8093             -6.5734             -6.3012             -5.9872             -5.6249             -5.2071              -4.7251                -4.169              -3.5276             -2.7877              -1.9341     
         -4.7619             -4.7502             -4.7367             -4.7211             -4.7031             -4.6823             -4.6584             -4.6308             -4.5989             -4.5621              -4.5197               -4.4708              -4.4144             -4.3493              -4.2743     
         -4.6154             -4.5414              -4.456             -4.3575             -4.2438             -4.1127             -3.9615             -3.7871             -3.5858             -3.3537              -3.0859               -2.7769              -2.4206             -2.0095              -1.5353     
         -4.7388             -4.6439             -4.5344             -4.4081             -4.2624             -4.0943             -3.9004             -3.6768             -3.4188             -3.1211              -2.7778               -2.3818              -1.9249             -1.3979              -0.7899     
         -4.9012             -4.7915             -4.6648             -4.5187             -4.3502             -4.1558             -3.9315             -3.6728             -3.3743               -3.03              -2.6329               -2.1748              -1.6463             -1.0366             -0.33339     
         -5.0827              -4.961             -4.8205             -4.6585             -4.4716              -4.256             -4.0073             -3.7204             -3.3895             -3.0077              -2.5673               -2.0593              -1.4732            -0.79718             -0.01732     
         -5.2758             -5.1439             -4.9917             -4.8162             -4.6137             -4.3801             -4.1106             -3.7997             -3.4411             -3.0275              -2.5503               -1.9998              -1.3648            -0.63231              0.21268     
         -5.4769             -5.3361             -5.1736             -4.9861             -4.7699             -4.5205             -4.2327             -3.9008             -3.5179             -3.0762              -2.5667                -1.979              -1.3009            -0.51879              0.38347     
         -2.5841             -2.5718             -2.5576             -2.5413             -2.5224             -2.5006             -2.4755             -2.4465             -2.4131             -2.3745                -2.33               -2.2787              -2.2195             -2.1512              -2.0725     
         -2.4547             -2.3771             -2.2874             -2.1841             -2.0648             -1.9273             -1.7686             -1.5856             -1.3744             -1.1308             -0.84983               -0.5257             -0.15178             0.27955              0.77711     
         -2.6084             -2.5088              -2.394             -2.2614             -2.1086             -1.9322             -1.7288             -1.4941             -1.2234            -0.91112             -0.55089              -0.13533              0.34404             0.89703               1.5349     
         -2.8032              -2.688             -2.5551             -2.4018             -2.2249              -2.021             -1.7856             -1.5142              -1.201            -0.83981             -0.42311              0.057583              0.61209              1.2518               1.9896     
         -3.0178             -2.8901             -2.7427             -2.5727             -2.3766             -2.1504             -1.8895             -1.5885             -1.2412            -0.84063             -0.37854                0.1545              0.76941              1.4787                2.297     
         -3.2447             -3.1063             -2.9466             -2.7624               -2.55             -2.3049             -2.0221             -1.6959             -1.3197            -0.88566             -0.38498                0.1926              0.85886              1.6274               2.5141     
           -3.48             -3.3322             -3.1617             -2.9651             -2.7382             -2.4765             -2.1746             -1.8263             -1.4246            -0.96111              -0.4265               0.19021              0.90163              1.7223                2.669     
        -0.40663             -0.3938              -0.379            -0.36192            -0.34223            -0.31951             -0.2933            -0.26307            -0.22819            -0.18796             -0.14155             -0.088012            -0.026254            0.044988              0.12717     
        -0.29585             -0.2148            -0.12131           -0.013467             0.11094             0.25445                0.42             0.61098             0.83128              1.0854               1.3786                1.7167               2.1068              2.5569                3.076     
        -0.48042            -0.37652            -0.25666             -0.1184            0.041099             0.22509             0.43733             0.68217              0.9646              1.2904               1.6662                2.0998               2.5999              3.1769               3.8424     
        -0.70779             -0.5876            -0.44896            -0.28902            -0.10453              0.1083             0.35381             0.63702             0.96373              1.3406               1.7754                2.2769               2.8554              3.5228               4.2926     
        -0.95597            -0.82269            -0.66895            -0.49159              -0.287            -0.05099             0.22126             0.53532             0.89761              1.3155               1.7976                2.3538               2.9953              3.7354               4.5891     
         -1.2169             -1.0725             -0.9059            -0.71373            -0.49205            -0.23633            0.058667             0.39896             0.79151              1.2443               1.7667                2.3693               3.0644              3.8663               4.7913     
         -1.4866             -1.3324             -1.1545            -0.94933            -0.71263            -0.43958             -0.1246             0.23875              0.6579              1.1414               1.6992                2.3426               3.0848               3.941               4.9287     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         32.239              32.257              32.278              32.303              32.331              32.363                32.4              32.443              32.493               32.55               32.616               32.693                32.78               32.882               32.999      
         31.982              32.098              32.231              32.384              32.561              32.766              33.001              33.273              33.587              33.948               34.366               34.847               35.402               36.043               36.782      
         31.305              31.453              31.624               31.82              32.047              32.309              32.611               32.96              33.362              33.826               34.361               34.978                35.69               36.511               37.458      
         30.567              30.738              30.935              31.163              31.426              31.729              32.078              32.481              32.946              33.483               34.102               34.815               35.639               36.589               37.685      
         29.639              29.829              30.048                30.3              30.591              30.927              31.315              31.762              32.278              32.872               33.559                34.35               35.264               36.317               37.532      
         28.433              28.639              28.876              29.149              29.465              29.829              30.249              30.733              31.292              31.937                32.68               33.538               34.527               35.669               36.986      
         26.577              26.796              27.049              27.342              27.678              28.067              28.516              29.033              29.629              30.318               31.112               32.028               33.084               34.303               35.709      
         34.415              34.433              34.455              34.479              34.508              34.541              34.579              34.622              34.673              34.731               34.798               34.875               34.964               35.067               35.186      
          34.13              34.247              34.382              34.538              34.718              34.925              35.164               35.44              35.759              36.126               36.549               37.038               37.601               38.251               39.001      
         33.419              33.569              33.742              33.942              34.173              34.438              34.745              35.099              35.507              35.977                36.52               37.146               37.869               38.702               39.664      
         32.646               32.82               33.02              33.251              33.518              33.825               34.18              34.589              35.061              35.605               36.233               36.958               37.793               38.757               39.869      
         31.743              31.936              32.158              32.414               32.71               33.05              33.444              33.897              34.421              35.024               35.721               36.524               37.451                38.52               39.753      
         30.442               30.65              30.891              31.169              31.489              31.858              32.284              32.776              33.343              33.997               34.752               35.622               36.626               37.785               39.121      
         28.552              28.774              29.031              29.328               29.67              30.064              30.519              31.044              31.649              32.348               33.154               34.083               35.155               36.392               37.819      
         36.591              36.609              36.631              36.656              36.685              36.718              36.757              36.801              36.852              36.911               36.979               37.057               37.148               37.252               37.373      
         36.278              36.397              36.534              36.692              36.874              37.084              37.327              37.607              37.929              38.302               38.731               39.227               39.798               40.458               41.218      
         35.533              35.685              35.861              36.063              36.297              36.567              36.878              37.236               37.65              38.127               38.678               39.313               40.046               40.891               41.866      
         34.725              34.901              35.104              35.339              35.609              35.921               36.28              36.695              37.174              37.726               38.363               39.098               39.946               40.923               42.051      
         33.787              33.982              34.207              34.467              34.767              35.113              35.512              35.972              36.502              37.115               37.821               38.636               39.576                40.66               41.911      
          32.45              32.661              32.905              33.187              33.512              33.886              34.319              34.817              35.392              36.056               36.821               37.704               38.722               39.897               41.252      
         30.526              30.752              31.012              31.313               31.66               32.06              32.521              33.054              33.668              34.376               35.193               36.136               37.224               38.478               39.925      
         38.766              38.785              38.807              38.833              38.862              38.896              38.935              38.979              39.031              39.091                39.16               39.239               39.331               39.437               39.559      
         38.426              38.546              38.685              38.845               39.03              39.243              39.489              39.772                40.1              40.477               40.912               41.415               41.994               42.662               43.433      
         37.646              37.801              37.979              38.184              38.421              38.694              39.009              39.373              39.793              40.276               40.835               41.478               42.221               43.078               44.066      
         36.804              36.982              37.188              37.426                37.7              38.016               38.38              38.801              39.286              39.846               40.491               41.236               42.095               43.087                44.23      
          35.89              36.088              36.316               36.58              36.884              37.234              37.638              38.105              38.643              39.264               39.979               40.805               41.758               42.857               44.125      
         34.457              34.672              34.919              35.205              35.534              35.914              36.352              36.857               37.44              38.113               38.888               39.783               40.816               42.007                43.38      
           32.5              32.729              32.993              33.298              33.649              34.055              34.523              35.062              35.685              36.403               37.231               38.187               39.289               40.561               42.027      
         40.942              40.961              40.983              41.009              41.039              41.073              41.112              41.158               41.21              41.271               41.341               41.421               41.514               41.621               41.745      
         40.573              40.695              40.836              40.998              41.185              41.401               41.65              41.937              42.269              42.651               43.092               43.601               44.188               44.865               45.647      
          39.76              39.916              40.096              40.304              40.544              40.821              41.141              41.509              41.934              42.424                42.99               43.642               44.395               45.263               46.264      
         38.882              39.063              39.271              39.512               39.79               40.11              40.479              40.905              41.397              41.964               42.618               43.373               44.243               45.248               46.406      
         37.933              38.133              38.365              38.632              38.939              39.295              39.704              40.177              40.722              41.351               42.076               42.913               43.878               44.992               46.276      
         36.588              36.805              37.056              37.345              37.679              38.063              38.507              39.019               39.61              40.291               41.077               41.984                43.03               44.237               45.628      
         34.473              34.705              34.973              35.282              35.638              36.049              36.523              37.069                37.7              38.428               39.267               40.235               41.352                42.64               44.126      
         43.118              43.137               43.16              43.186              43.216               43.25               43.29              43.336              43.389              43.451               43.521               43.603               43.697               43.806               43.931      
          42.72              42.844              42.986               43.15               43.34              43.559              43.811              44.102              44.438              44.825               45.272               45.787               46.381               47.067               47.858      
         41.873              42.031              42.213              42.424              42.667              42.948              43.271              43.644              44.074              44.571               45.144               45.804               46.566               47.446                48.46      
          40.96              41.143              41.354              41.598              41.879              42.203              42.577              43.009              43.507              44.081               44.744               45.508               46.389               47.406                48.58      
         40.015              40.218              40.453              40.723              41.035              41.394              41.809              42.288               42.84              43.477               44.211               45.059               46.036               47.164               48.465      
         38.651              38.871              39.125              39.418              39.756              40.146              40.595              41.114              41.712              42.402               43.198               44.116               45.175               46.397               47.807      
         36.446              36.681              36.952              37.265              37.625              38.042              38.521              39.075              39.714              40.451               41.301               42.281               43.412               44.717               46.222      
         45.293              45.313              45.336              45.362              45.392              45.427              45.468              45.515              45.568               45.63               45.702               45.785                45.88                45.99               46.117      
         44.867              44.992              45.136              45.302              45.494              45.716              45.971              46.266              46.606              46.998                47.45               47.971               48.573               49.267               50.068      
         43.985              44.145               44.33              44.544               44.79              45.073              45.401              45.778              46.214              46.717               47.296               47.965               48.737               49.627               50.653      
         43.037              43.223              43.437              43.683              43.968              44.296              44.675              45.112              45.616              46.197               46.868               47.641               48.534               49.563               50.751      
         42.057              42.263                42.5              42.774              43.089              43.453              43.873              44.358              44.917              45.561               46.305               47.163               48.152               49.294               50.611      
         40.658              40.881              41.138              41.434              41.776               42.17              42.625               43.15              43.756              44.454                45.26                46.19               47.262               48.499               49.926      
         38.419              38.656              38.931              39.247              39.612              40.034              40.519               41.08              41.727              42.472               43.333               44.325                45.47               46.791               48.314      
         47.469              47.489              47.512              47.538              47.569              47.605              47.646              47.693              47.747               47.81               47.882               47.966               48.062               48.174               48.302      
         47.014               47.14              47.286              47.454              47.648              47.872              48.131              48.429              48.773              49.169               49.627               50.155               50.764               51.466               52.276      
         46.097               46.26              46.447              46.662              46.911              47.199               47.53              47.912              48.353              48.861               49.448               50.125               50.905               51.806               52.845      
         45.114              45.302              45.518              45.768              46.056              46.388              46.772              47.214              47.723              48.312                48.99               49.773               50.676               51.718               52.919      
         44.099              44.307              44.547              44.824              45.143              45.512              45.937              46.427              46.992              47.645               48.397               49.265               50.266               51.422               52.754      
         42.664              42.889              43.149              43.449              43.795              44.194              44.655              45.186              45.799              46.505               47.321               48.261               49.346               50.598               52.042      
         40.391              40.631              40.909              41.229              41.599              42.025              42.517              43.084              43.738              44.493               45.363               46.367               47.526               48.862               50.404      
         49.644              49.664              49.688              49.715              49.746              49.782              49.823              49.871              49.926              49.989               50.063               50.147               50.245               50.357               50.487      
          49.16              49.288              49.436              49.606              49.802              50.029               50.29              50.592              50.939              51.341               51.804               52.337               52.953               53.664               54.483      
         48.209              48.374              48.563              48.781              49.033              49.323              49.658              50.045              50.491              51.005               51.599               52.283               53.073               53.984               55.034      
         47.191              47.381                47.6              47.853              48.144               48.48              48.867              49.315               49.83              50.425               51.112               51.904               52.817               53.871               55.086      
          46.14              46.351              46.594              46.874              47.197              47.569              47.999              48.495              49.067              49.727               50.488               51.366               52.379               53.547               54.895      
         44.669              44.897               45.16              45.464              45.814              46.218              46.683              47.221               47.84              48.555                49.38               50.331               51.429               52.695               54.155      
         42.362              42.606              42.887              43.211              43.584              44.015              44.513              45.086              45.748              46.511               47.392               48.408                49.58               50.931               52.491      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.306              51.436              51.585              51.757              51.956              52.185              52.449              52.754              53.106              53.511               53.979               54.519               55.142                55.86               56.689      
         50.321              50.487              50.679              50.899              51.154              51.448              51.786              52.177              52.628              53.148               53.748                54.44               55.239                56.16               57.222      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         48.182              48.394               48.64              48.923               49.25              49.626              50.061              50.562              51.141              51.808               52.577               53.465               54.489               55.671               57.034      
         46.675              46.905              47.171              47.478              47.832               48.24              48.711              49.254              49.881              50.604               51.438                 52.4               53.509                54.79               56.266      
         44.334               44.58              44.864              45.191              45.569              46.005              46.508              47.088              47.757              48.529               49.419               50.447               51.631               52.998               54.575      

</pre><h2 id="20">COH2: Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
<span class="comment">% mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));</span>
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, length(ar_w_level_full)*fl_z_r_borr_n]);

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>

ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_borr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));
</pre><h2 id="21">COH3: Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="22">COH4: Select only Valid (k(w), a) choices</h2><pre class="codeinput"><span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;
<span class="comment">% mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);</span>
mt_z_r_borr_mesh_coh_wkb = repmat(ar_z_r_borr, [size(mt_coh_wkb,1),1]);
mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);
</pre><h2 id="23">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>

<span class="comment">% This is borrowing with default or not condition</span>
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);
</pre><h2 id="24">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="comment">% 1. Given COH grid, w choices in terms of cash-on-hand percentages</span>
<span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>

<span class="comment">% 2. Some w &lt; 0, some w &gt; 0. When w &lt; 0, coh &gt; 0 or coh &lt; 0 both possible.</span>
<span class="comment">% Need to interplate in ff_ipwkbz_fibs_vecsv differently for w &lt; 0 because</span>
<span class="comment">% there both w as well as coh matters, if coh &lt; 0 and w &lt; 0, a fraction of</span>
<span class="comment">% w goes to getting informal bridge loans.</span>
mt_bl_w_by_interp_coh_interp_grid_wneg = (mt_w_perc_mesh_interp_coh_grid &lt; 0);
mt_w_by_interp_coh_interp_grid_wneg = mt_w_perc_mesh_interp_coh_grid(mt_bl_w_by_interp_coh_interp_grid_wneg);
mt_w_by_interp_coh_interp_grid_wpos = mt_w_perc_mesh_interp_coh_grid(~mt_bl_w_by_interp_coh_interp_grid_wneg);
</pre><h2 id="25">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</h2><p>If bridge loan does not matter, do not need to cover bridge loan. Then these percentages should reflect what happens when param_map('bl_bridge') = false, and, param_map('it_coh_bridge_perc_n') = 1;</p><pre class="codeinput"><span class="comment">% 1. Expand cash-on-hand by w_perc grid</span>
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_perc_mesh_interp_coh_grid)) + ar_interp_coh_grid;

<span class="comment">% 2. How much is coh as perc of w_perc grid level choice based on w_perc</span>
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_perc_mesh_interp_coh_grid));

<span class="comment">% 3. The ratio only relevant for where w &lt; 0 and where coh &lt; 0. Note the</span>
<span class="comment">% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to</span>
<span class="comment">% bridge.</span>
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc &gt;= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_by_interp_coh_interp_grid_wneg);
</pre><h2 id="26">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="27">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="28">Store armt_map (1): base arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>ar_interp_c_grid: 1 by I^c</li><li>ar_interp_coh_grid: 1 by I^{coh}</li><li>ar_w_level: 1 by I^{W=k+b}</li><li>ar_w_perc: 1 by P^{W=k+b}</li><li>ar_ak_perc: 1 by P^{k and b}</li></ol></div><p>more descriptions:</p><div><ol><li>ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation</li><li>ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)</li><li>ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li>ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set. 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li>ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
</pre><h2 id="29">Store armt_map (2): 1st stage level coh on hand related arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w</li><li>mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w</li><li>mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}</li><li>mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}</li></ol></div><p>more descriptions:</p><div><ol><li><b>mt_w_perc_mesh_interp_coh_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_interp_coh_grid_mesh_z_wage'</span>) = mt_interp_coh_grid_mesh_z_wage;
armt_map(<span class="string">'mt_z_wage_mesh_interp_coh_grid'</span>) = mt_z_wage_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;
armt_map(<span class="string">'mt_w_perc_mesh_interp_coh_grid'</span>) = mt_w_perc_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
</pre><h2 id="30">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_coh_wkb: ((P^{k}_{a&gt;=0} + P^{k}_{a&lt;0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix</li><li>mt_z_wage_mesh_coh_wkb: same as mt_coh_wkb</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_z_wage_mesh_coh_wkb'</span>) = mt_z_wage_mesh_coh_wkb;
</pre><h2 id="31">Store armt_map (4): 2nd stage additional arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_k: (I^w) by (P^{k and b})</li><li>ar_a_meshk: 1 by (I^w x P^{k and b})</li><li>ar_k_mesha: 1 by (I^w x P^{k and b})</li><li>ar_aplusk_mesh: 1 by (I^w x P^{k and b})</li><li>it_ameshk_n: scalar</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'ar_aplusk_mesh'</span>) = ar_aplusk_mesh;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
</pre><h2 id="32">Store armt_map (5): Shock Grids Arrays and Mesh</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>ar_z_r_borr: 1 by (M^r)</li><li>ar_z_r_borr_prob: 1 by (M^r)</li><li>ar_z_wage: 1 by (M^z)</li><li>ar_z_wage_prob: 1 by (M^z)</li><li>ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)</li><li>ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)</li><li>ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)</li><li>ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_z_r_borr'</span>) = ar_z_r_borr;
armt_map(<span class="string">'ar_z_r_borr_prob'</span>) = ar_z_r_borr_prob;

armt_map(<span class="string">'ar_z_wage'</span>) = ar_z_wage;
armt_map(<span class="string">'ar_z_wage_prob'</span>) = ar_z_wage_prob;

armt_map(<span class="string">'ar_z_r_borr_mesh_wage_w1r2'</span>) = ar_z_r_borr_mesh_wage_w1r2;
armt_map(<span class="string">'ar_z_wage_mesh_r_borr_w1r2'</span>) = ar_z_wage_mesh_r_borr_w1r2;
armt_map(<span class="string">'ar_z_r_borr_mesh_wage_r1w2'</span>) = ar_z_r_borr_mesh_wage_r1w2;
armt_map(<span class="string">'ar_z_wage_mesh_r_borr_r1w2'</span>) = ar_z_wage_mesh_r_borr_r1w2;

armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
</pre><h2 id="33">Store armt_map (6): W Share for Bridge Parameters</h2><div><ol><li><b>ar_w_level_full</b>: in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/solve/html/ff_ipwkbz_vf_vecsv.html">ff_ipwkbz_vf_vecsv</a>, <i>ar_w_level</i> and <i>ar_w_level_full</i> were the same. Now have this thing which is stored (length(ar_w_level_full)) by (length(ar_z)). <i>ar_w_level_full</i> includes not just different levels of <i>ar_w_level</i>, but also repeats the elements of <i>ar_w_level</i> that are &lt; 0 by <i>it_coh_bridge_perc_n</i> times, starting with what corresponds to 100 percent of w should go to cover bridge loan, until 0 percent for w &lt; 0, which then proceeds to w &gt; 0. So the last segment of <i>ar_w_level_full</i> is the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) = ar_w_level.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_coh_bridge_perc'</span>) = ar_coh_bridge_perc;
armt_map(<span class="string">'ar_w_level_full'</span>) = ar_w_level_full;
armt_map(<span class="string">'ar_ameshk_tnext_with_r'</span>) = mt_ameshk_tnext_with_r;

armt_map(<span class="string">'mt_w_level_neg_mesh_coh_bridge_perc'</span>) = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map(<span class="string">'mt_coh_bridge_perc_mesh_w_level_neg'</span>) = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map(<span class="string">'mt_bl_w_by_interp_coh_interp_grid_wneg'</span>) = mt_bl_w_by_interp_coh_interp_grid_wneg;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid_wneg'</span>) = mt_w_by_interp_coh_interp_grid_wneg;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid_wpos'</span>) = mt_w_by_interp_coh_interp_grid_wpos;
armt_map(<span class="string">'mt_coh_w_perc_ratio_wneg'</span>) = mt_coh_w_perc_ratio_wneg;
</pre><h2 id="34">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_util_standin_coh'</span>) = f_util_standin_coh;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="35">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="37">Generate Limited Legends</h2><p>8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates</p><pre class="codeinput">    ar_it_z_r_borr = ([1 round((fl_z_r_borr_n)/2) (fl_z_r_borr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    <span class="comment">% combine by index</span>
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_borr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    <span class="comment">% legends index final</span>
    cl_st_legendCell = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', <span class="string">'zr=%3.2f;'</span>), <span class="keyword">...</span>
                                num2str(ar_z_wage_mesh_r_borr_w1r2', <span class="string">'zw=%3.2f'</span>)]);

    <span class="comment">% legends index final full mat wage only</span>
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', <span class="string">'zw=%3.2f'</span>)]);
</pre><h2 id="38">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><p>Plot end because earlier parts have repeating w and a levels due to potentially bridge which are coh percentage dependent. This will only plot out the grid basically when coh percentage for bridge loan = 0</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 mt_k(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 <span class="string">'blue'</span>);

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
    scatter(ar_a_meshk(it_col_start:it_col_end), <span class="keyword">...</span>
            ar_k_mesha(it_col_start:it_col_end), <span class="keyword">...</span>
            3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),<span class="keyword">...</span>
                                     ar_k_mesha_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title({<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span><span class="keyword">...</span>
           <span class="string">'(Bridge Borrow Share = 0)'</span>})
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_01.png" alt=""> <h2 id="39">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
            <span class="string">'Super-Seg: borrow r; Seg: w bridge perc; Sub-Seg: w=k+b; within inc. k'</span><span class="keyword">...</span>
            <span class="string">'For each w and z, coh maximizing k is different'</span>});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="keyword">...</span>
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_02.png" alt=""> <h2 id="40">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_03.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="42">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="44">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_04.png" alt=""> <h2 id="45">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_05.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="47">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z_wage'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_w_perc_mesh_interp_coh_grid));
    disp(head(array2table(mt_w_perc_mesh_interp_coh_grid), 10));
    disp(tail(array2table(mt_w_perc_mesh_interp_coh_grid), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_coh_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_coh_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_c_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_c_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_interp_coh_grid_mesh_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_a'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_a_meshk'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_a_meshk));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_k'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_k_mesha'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    <span class="keyword">for</span> i = 1:length(func_map)
        st_display = strjoin([<span class="string">'pos ='</span> num2str(i) <span class="string">'; key ='</span> string(param_map_keys{i}) <span class="string">'; val ='</span> func2str(param_map_vals{i})]);
        disp(st_display);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z_wage
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    55

  Columns 1 through 7

  -20.0000  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727

  Columns 8 through 14

   -5.1515   -3.0303   -0.9091  -20.0000  -17.8788  -15.7576  -13.6364

  Columns 15 through 21

  -11.5152   -9.3939   -7.2727   -5.1515   -3.0303   -0.9091  -20.0000

  Columns 22 through 28

  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727   -5.1515

  Columns 29 through 35

   -3.0303   -0.9091         0    1.2121    3.3333    5.4545    7.5758

  Columns 36 through 42

    9.6970   11.8182   13.9394   16.0606   18.1818   20.3030   22.4242

  Columns 43 through 49

   24.5455   26.6667   28.7879   30.9091   33.0303   35.1515   37.2727

  Columns 50 through 55

   39.3939   41.5152   43.6364   45.7576   47.8788   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    38

    mt_w_perc_mesh_interp_coh_grid1    mt_w_perc_mesh_interp_coh_grid2    mt_w_perc_mesh_interp_coh_grid3    mt_w_perc_mesh_interp_coh_grid4    mt_w_perc_mesh_interp_coh_grid5    mt_w_perc_mesh_interp_coh_grid6    mt_w_perc_mesh_interp_coh_grid7    mt_w_perc_mesh_interp_coh_grid8    mt_w_perc_mesh_interp_coh_grid9    mt_w_perc_mesh_interp_coh_grid10    mt_w_perc_mesh_interp_coh_grid11    mt_w_perc_mesh_interp_coh_grid12    mt_w_perc_mesh_interp_coh_grid13    mt_w_perc_mesh_interp_coh_grid14    mt_w_perc_mesh_interp_coh_grid15    mt_w_perc_mesh_interp_coh_grid16    mt_w_perc_mesh_interp_coh_grid17    mt_w_perc_mesh_interp_coh_grid18    mt_w_perc_mesh_interp_coh_grid19    mt_w_perc_mesh_interp_coh_grid20    mt_w_perc_mesh_interp_coh_grid21    mt_w_perc_mesh_interp_coh_grid22    mt_w_perc_mesh_interp_coh_grid23    mt_w_perc_mesh_interp_coh_grid24    mt_w_perc_mesh_interp_coh_grid25    mt_w_perc_mesh_interp_coh_grid26    mt_w_perc_mesh_interp_coh_grid27    mt_w_perc_mesh_interp_coh_grid28    mt_w_perc_mesh_interp_coh_grid29    mt_w_perc_mesh_interp_coh_grid30    mt_w_perc_mesh_interp_coh_grid31    mt_w_perc_mesh_interp_coh_grid32    mt_w_perc_mesh_interp_coh_grid33    mt_w_perc_mesh_interp_coh_grid34    mt_w_perc_mesh_interp_coh_grid35    mt_w_perc_mesh_interp_coh_grid36    mt_w_perc_mesh_interp_coh_grid37    mt_w_perc_mesh_interp_coh_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.991                            -19.989                            -19.987                            -19.985                            -19.983                             -19.981                             -19.98                             -19.979                              -19.976                            -19.974                             -19.972                               -19.97                            -19.968                             -19.966                             -19.964                              -19.961                            -19.959                             -19.957                             -19.955                             -19.953                             -19.951                             -19.948                             -19.946                             -19.944                              -19.942                              -19.94                            -19.938                             -19.936                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.641                            -19.282                            -18.923                            -18.564                            -18.205                            -17.846                            -17.486                            -17.127                             -16.768                            -16.653                             -16.409                               -16.05                            -15.691                             -15.332                              -14.973                            -14.614                             -14.255                             -13.896                              -13.537                            -13.178                             -12.819                             -12.459                               -12.1                             -11.741                             -11.382                             -11.023                             -10.664                              -10.305                              -9.946                            -9.5869                             -9.2278                             -8.8688                             -8.5097                             -8.1506                             -7.7915                             -7.4325                             -7.0734             
                  -20                              -19.284                            -18.568                            -17.852                            -17.136                             -16.42                            -15.704                            -14.988                            -14.272                             -13.556                            -13.327                              -12.84                              -12.124                            -11.408                             -10.692                               -9.976                              -9.26                              -8.544                              -7.828                               -7.112                             -6.396                               -5.68                              -4.964                              -4.248                              -3.532                              -2.816                                -2.1                              -1.384                             -0.66803                            0.047969                            0.76397                                1.48                               2.196                               2.912                               3.628                               4.344                                5.06                               5.776             
                  -20                              -18.927                            -17.854                            -16.781                            -15.708                            -14.635                            -13.562                             -12.49                            -11.417                             -10.344                                -10                             -9.2707                              -8.1978                            -7.1249                              -6.052                               -4.979                            -3.9061                             -2.8332                             -1.7603                             -0.68734                            0.38558                              1.4585                              2.5314                              3.6044                              4.6773                              5.7502                              6.8231                              7.8961                                8.969                              10.042                             11.115                              12.188                              13.261                              14.334                              15.407                              16.479                              17.552                              18.625             
                  -20                               -18.57                             -17.14                             -15.71                            -14.281                            -12.851                            -11.421                             -9.991                            -8.5612                             -7.1313                            -6.6733                             -5.7015                              -4.2716                            -2.8418                             -1.4119                             0.017927                             1.4478                              2.8776                              4.3075                               5.7373                             7.1672                               8.597                              10.027                              11.457                              12.887                              14.316                              15.746                              17.176                               18.606                              20.036                             21.466                              22.896                              24.325                              25.755                              27.185                              28.615                              30.045                              31.475             
                  -20                              -18.213                            -16.426                             -14.64                            -12.853                            -11.066                            -9.2793                            -7.4926                            -5.7058                              -3.919                            -3.3467                             -2.1322                             -0.34544                             1.4413                              3.2281                               5.0149                             6.8017                              8.5885                              10.375                               12.162                             13.949                              15.736                              17.522                              19.309                              21.096                              22.883                              24.669                              26.456                               28.243                               30.03                             31.817                              33.603                               35.39                              37.177                              38.964                               40.75                              42.537                              44.324             
                  -20                              -17.856                            -15.713                            -13.569                            -11.425                            -9.2815                            -7.1378                            -4.9941                            -2.8504                            -0.70666                              -0.02                               1.437                               3.5808                             5.7245                              7.8682                               10.012                             12.156                              14.299                              16.443                               18.587                              20.73                              22.874                              25.018                              27.162                              29.305                              31.449                              33.593                              35.736                                37.88                              40.024                             42.167                              44.311                              46.455                              48.599                              50.742                              52.886                               55.03                              57.173             

    mt_w_perc_mesh_interp_coh_grid1    mt_w_perc_mesh_interp_coh_grid2    mt_w_perc_mesh_interp_coh_grid3    mt_w_perc_mesh_interp_coh_grid4    mt_w_perc_mesh_interp_coh_grid5    mt_w_perc_mesh_interp_coh_grid6    mt_w_perc_mesh_interp_coh_grid7    mt_w_perc_mesh_interp_coh_grid8    mt_w_perc_mesh_interp_coh_grid9    mt_w_perc_mesh_interp_coh_grid10    mt_w_perc_mesh_interp_coh_grid11    mt_w_perc_mesh_interp_coh_grid12    mt_w_perc_mesh_interp_coh_grid13    mt_w_perc_mesh_interp_coh_grid14    mt_w_perc_mesh_interp_coh_grid15    mt_w_perc_mesh_interp_coh_grid16    mt_w_perc_mesh_interp_coh_grid17    mt_w_perc_mesh_interp_coh_grid18    mt_w_perc_mesh_interp_coh_grid19    mt_w_perc_mesh_interp_coh_grid20    mt_w_perc_mesh_interp_coh_grid21    mt_w_perc_mesh_interp_coh_grid22    mt_w_perc_mesh_interp_coh_grid23    mt_w_perc_mesh_interp_coh_grid24    mt_w_perc_mesh_interp_coh_grid25    mt_w_perc_mesh_interp_coh_grid26    mt_w_perc_mesh_interp_coh_grid27    mt_w_perc_mesh_interp_coh_grid28    mt_w_perc_mesh_interp_coh_grid29    mt_w_perc_mesh_interp_coh_grid30    mt_w_perc_mesh_interp_coh_grid31    mt_w_perc_mesh_interp_coh_grid32    mt_w_perc_mesh_interp_coh_grid33    mt_w_perc_mesh_interp_coh_grid34    mt_w_perc_mesh_interp_coh_grid35    mt_w_perc_mesh_interp_coh_grid36    mt_w_perc_mesh_interp_coh_grid37    mt_w_perc_mesh_interp_coh_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.991                            -19.989                            -19.987                            -19.985                            -19.983                             -19.981                             -19.98                             -19.979                              -19.976                            -19.974                             -19.972                               -19.97                            -19.968                             -19.966                             -19.964                              -19.961                            -19.959                             -19.957                             -19.955                             -19.953                             -19.951                             -19.948                             -19.946                             -19.944                              -19.942                              -19.94                            -19.938                             -19.936                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.641                            -19.282                            -18.923                            -18.564                            -18.205                            -17.846                            -17.486                            -17.127                             -16.768                            -16.653                             -16.409                               -16.05                            -15.691                             -15.332                              -14.973                            -14.614                             -14.255                             -13.896                              -13.537                            -13.178                             -12.819                             -12.459                               -12.1                             -11.741                             -11.382                             -11.023                             -10.664                              -10.305                              -9.946                            -9.5869                             -9.2278                             -8.8688                             -8.5097                             -8.1506                             -7.7915                             -7.4325                             -7.0734             
                  -20                              -19.284                            -18.568                            -17.852                            -17.136                             -16.42                            -15.704                            -14.988                            -14.272                             -13.556                            -13.327                              -12.84                              -12.124                            -11.408                             -10.692                               -9.976                              -9.26                              -8.544                              -7.828                               -7.112                             -6.396                               -5.68                              -4.964                              -4.248                              -3.532                              -2.816                                -2.1                              -1.384                             -0.66803                            0.047969                            0.76397                                1.48                               2.196                               2.912                               3.628                               4.344                                5.06                               5.776             
                  -20                              -18.927                            -17.854                            -16.781                            -15.708                            -14.635                            -13.562                             -12.49                            -11.417                             -10.344                                -10                             -9.2707                              -8.1978                            -7.1249                              -6.052                               -4.979                            -3.9061                             -2.8332                             -1.7603                             -0.68734                            0.38558                              1.4585                              2.5314                              3.6044                              4.6773                              5.7502                              6.8231                              7.8961                                8.969                              10.042                             11.115                              12.188                              13.261                              14.334                              15.407                              16.479                              17.552                              18.625             
                  -20                               -18.57                             -17.14                             -15.71                            -14.281                            -12.851                            -11.421                             -9.991                            -8.5612                             -7.1313                            -6.6733                             -5.7015                              -4.2716                            -2.8418                             -1.4119                             0.017927                             1.4478                              2.8776                              4.3075                               5.7373                             7.1672                               8.597                              10.027                              11.457                              12.887                              14.316                              15.746                              17.176                               18.606                              20.036                             21.466                              22.896                              24.325                              25.755                              27.185                              28.615                              30.045                              31.475             
                  -20                              -18.213                            -16.426                             -14.64                            -12.853                            -11.066                            -9.2793                            -7.4926                            -5.7058                              -3.919                            -3.3467                             -2.1322                             -0.34544                             1.4413                              3.2281                               5.0149                             6.8017                              8.5885                              10.375                               12.162                             13.949                              15.736                              17.522                              19.309                              21.096                              22.883                              24.669                              26.456                               28.243                               30.03                             31.817                              33.603                               35.39                              37.177                              38.964                               40.75                              42.537                              44.324             
                  -20                              -17.856                            -15.713                            -13.569                            -11.425                            -9.2815                            -7.1378                            -4.9941                            -2.8504                            -0.70666                              -0.02                               1.437                               3.5808                             5.7245                              7.8682                               10.012                             12.156                              14.299                              16.443                               18.587                              20.73                              22.874                              25.018                              27.162                              29.305                              31.449                              33.593                              35.736                                37.88                              40.024                             42.167                              44.311                              46.455                              48.599                              50.742                              52.886                               55.03                              57.173             

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

      0.060767       0.062672       0.059681       0.034852       0.012474      0.0027333      0.0003662     2.9951e-05     1.4928e-06      4.5269e-08      8.3389e-10      9.3171e-12      6.3067e-14      2.5932e-16               0         0.10634         0.10968         0.10444        0.060991        0.021829      0.0047833       0.00064085      5.2413e-05      2.6124e-06      7.9222e-08      1.4593e-09      1.6305e-11      1.1037e-13      4.5381e-16               0        0.093049        0.095966        0.091387        0.053367          0.0191      0.0041854       0.00056075      4.5862e-05      2.2859e-06      6.9319e-08      1.2769e-09      1.4267e-11      9.6572e-14      3.9709e-16               0 
      0.026235       0.045832       0.064537       0.055733       0.029512      0.0095762       0.001902      0.0002309     1.7106e-05      7.7207e-07      2.1194e-08      3.5329e-10      3.5712e-12      2.1861e-14      7.7797e-17        0.045912        0.080206         0.11294        0.097533        0.051646       0.016758        0.0033285      0.00040408      2.9936e-05      1.3511e-06      3.7089e-08      6.1826e-10      6.2496e-12      3.8257e-14      1.3614e-16        0.040173         0.07018        0.098823        0.085341        0.045191       0.014664        0.0029124      0.00035357      2.6194e-05      1.1822e-06      3.2453e-08      5.4098e-10      5.4684e-12      3.3474e-14      1.1913e-16 
     0.0086593       0.024506       0.051037       0.065171       0.051037       0.024506      0.0072089      0.0012977     0.00014274      9.5785e-06      3.9144e-07      9.7262e-09      1.4671e-10      1.3416e-12      7.4425e-15        0.015154        0.042885        0.089316         0.11405        0.089316       0.042885         0.012616        0.002271       0.0002498      1.6762e-05      6.8502e-07      1.7021e-08      2.5675e-10      2.3479e-12      1.3024e-14         0.01326        0.037525        0.078151        0.099794        0.078151       0.037525         0.011039       0.0019871      0.00021858      1.4667e-05      5.9939e-07      1.4893e-08      2.2465e-10      2.0544e-12      1.1396e-14 
     0.0021508      0.0095762       0.029512       0.055733       0.064537       0.045832       0.019954      0.0053212     0.00086814      8.6517e-05       5.258e-06      1.9455e-07      4.3753e-09      5.9718e-11      4.9647e-13       0.0037639        0.016758        0.051646        0.097533         0.11294       0.080206         0.034919       0.0093122       0.0015192       0.0001514      9.2016e-06      3.4046e-07      7.6568e-09      1.0451e-10      8.6883e-13       0.0032934        0.014664        0.045191        0.085341        0.098823        0.07018         0.030554       0.0081481       0.0013293      0.00013248      8.0514e-06       2.979e-07      6.6997e-09      9.1443e-11      7.6022e-13 
    0.00039769      0.0027333       0.012474       0.034852       0.059681       0.062672        0.04036       0.015932      0.0038514      0.00056943       5.141e-05      2.8296e-06      9.4786e-08      1.9293e-09      2.4005e-11      0.00069596       0.0047833        0.021829        0.060991         0.10444        0.10968          0.07063        0.027881         0.00674       0.0009965      8.9968e-05      4.9518e-06      1.6588e-07      3.3763e-09      4.2008e-11      0.00060897       0.0041854          0.0191        0.053367        0.091387       0.095966         0.061801        0.024396       0.0058975      0.00087194      7.8722e-05      4.3329e-06      1.4514e-07      2.9542e-09      3.6757e-11 
    5.4337e-05     0.00056943      0.0038514       0.015932        0.04036       0.062672       0.059681       0.034852       0.012474       0.0027333       0.0003662      2.9951e-05      1.4928e-06      4.5269e-08      8.4327e-10      9.5089e-05       0.0009965         0.00674        0.027881         0.07063        0.10968          0.10444        0.060991        0.021829       0.0047833      0.00064085      5.2413e-05      2.6124e-06      7.9222e-08      1.4757e-09      8.3203e-05      0.00087194       0.0058975        0.024396        0.061801       0.095966         0.091387        0.053367          0.0191       0.0041854      0.00056075      4.5862e-05      2.2859e-06      6.9319e-08      1.2913e-09 
     5.457e-06     8.6517e-05     0.00086814      0.0053212       0.019954       0.045832       0.064537       0.055733       0.029512       0.0095762        0.001902       0.0002309      1.7106e-05      7.7207e-07      2.1551e-08      9.5498e-06       0.0001514       0.0015192       0.0093122        0.034919       0.080206          0.11294        0.097533        0.051646        0.016758       0.0033285      0.00040408      2.9936e-05      1.3511e-06      3.7714e-08      8.3561e-06      0.00013248       0.0013293       0.0081481        0.030554        0.07018         0.098823        0.085341        0.045191        0.014664       0.0029124      0.00035357      2.6194e-05      1.1822e-06      3.2999e-08 
    4.0131e-07     9.5785e-06     0.00014274      0.0012977      0.0072089       0.024506       0.051037       0.065171       0.051037        0.024506       0.0072089       0.0012977      0.00014274      9.5785e-06      4.0131e-07       7.023e-07      1.6762e-05       0.0002498        0.002271        0.012616       0.042885         0.089316         0.11405        0.089316        0.042885        0.012616        0.002271       0.0002498      1.6762e-05       7.023e-07      6.1451e-07      1.4667e-05      0.00021858       0.0019871        0.011039       0.037525         0.078151        0.099794        0.078151        0.037525        0.011039       0.0019871      0.00021858      1.4667e-05      6.1451e-07 
    2.1551e-08     7.7207e-07     1.7106e-05      0.0002309       0.001902      0.0095762       0.029512       0.055733       0.064537        0.045832        0.019954       0.0053212      0.00086814      8.6517e-05       5.457e-06      3.7714e-08      1.3511e-06      2.9936e-05      0.00040408       0.0033285       0.016758         0.051646        0.097533         0.11294        0.080206        0.034919       0.0093122       0.0015192       0.0001514      9.5498e-06      3.2999e-08      1.1822e-06      2.6194e-05      0.00035357       0.0029124       0.014664         0.045191        0.085341        0.098823         0.07018        0.030554       0.0081481       0.0013293      0.00013248      8.3561e-06 
    8.4327e-10     4.5269e-08     1.4928e-06     2.9951e-05      0.0003662      0.0027333       0.012474       0.034852       0.059681        0.062672         0.04036        0.015932       0.0038514      0.00056943      5.4337e-05      1.4757e-09      7.9222e-08      2.6124e-06      5.2413e-05      0.00064085      0.0047833         0.021829        0.060991         0.10444         0.10968         0.07063        0.027881         0.00674       0.0009965      9.5089e-05      1.2913e-09      6.9319e-08      2.2859e-06      4.5862e-05      0.00056075      0.0041854           0.0191        0.053367        0.091387        0.095966        0.061801        0.024396       0.0058975      0.00087194      8.3203e-05 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

    5.4337e-05     0.00056943      0.0038514       0.015932        0.04036       0.062672       0.059681       0.034852       0.012474      0.0027333       0.0003662       2.9951e-05      1.4928e-06      4.5269e-08      8.4327e-10      9.5089e-05       0.0009965         0.00674        0.027881         0.07063         0.10968         0.10444        0.060991        0.021829      0.0047833       0.00064085      5.2413e-05      2.6124e-06      7.9222e-08      1.4757e-09      8.3203e-05      0.00087194       0.0058975        0.024396        0.061801        0.095966        0.091387        0.053367          0.0191      0.0041854       0.00056075      4.5862e-05      2.2859e-06      6.9319e-08      1.2913e-09 
     5.457e-06     8.6517e-05     0.00086814      0.0053212       0.019954       0.045832       0.064537       0.055733       0.029512      0.0095762        0.001902        0.0002309      1.7106e-05      7.7207e-07      2.1551e-08      9.5498e-06       0.0001514       0.0015192       0.0093122        0.034919        0.080206         0.11294        0.097533        0.051646       0.016758        0.0033285      0.00040408      2.9936e-05      1.3511e-06      3.7714e-08      8.3561e-06      0.00013248       0.0013293       0.0081481        0.030554         0.07018        0.098823        0.085341        0.045191       0.014664        0.0029124      0.00035357      2.6194e-05      1.1822e-06      3.2999e-08 
    4.0131e-07     9.5785e-06     0.00014274      0.0012977      0.0072089       0.024506       0.051037       0.065171       0.051037       0.024506       0.0072089        0.0012977      0.00014274      9.5785e-06      4.0131e-07       7.023e-07      1.6762e-05       0.0002498        0.002271        0.012616        0.042885        0.089316         0.11405        0.089316       0.042885         0.012616        0.002271       0.0002498      1.6762e-05       7.023e-07      6.1451e-07      1.4667e-05      0.00021858       0.0019871        0.011039        0.037525        0.078151        0.099794        0.078151       0.037525         0.011039       0.0019871      0.00021858      1.4667e-05      6.1451e-07 
    2.1551e-08     7.7207e-07     1.7106e-05      0.0002309       0.001902      0.0095762       0.029512       0.055733       0.064537       0.045832        0.019954        0.0053212      0.00086814      8.6517e-05       5.457e-06      3.7714e-08      1.3511e-06      2.9936e-05      0.00040408       0.0033285        0.016758        0.051646        0.097533         0.11294       0.080206         0.034919       0.0093122       0.0015192       0.0001514      9.5498e-06      3.2999e-08      1.1822e-06      2.6194e-05      0.00035357       0.0029124        0.014664        0.045191        0.085341        0.098823        0.07018         0.030554       0.0081481       0.0013293      0.00013248      8.3561e-06 
    8.4327e-10     4.5269e-08     1.4928e-06     2.9951e-05      0.0003662      0.0027333       0.012474       0.034852       0.059681       0.062672         0.04036         0.015932       0.0038514      0.00056943      5.4337e-05      1.4757e-09      7.9222e-08      2.6124e-06      5.2413e-05      0.00064085       0.0047833        0.021829        0.060991         0.10444        0.10968          0.07063        0.027881         0.00674       0.0009965      9.5089e-05      1.2913e-09      6.9319e-08      2.2859e-06      4.5862e-05      0.00056075       0.0041854          0.0191        0.053367        0.091387       0.095966         0.061801        0.024396       0.0058975      0.00087194      8.3203e-05 
    2.4005e-11     1.9293e-09     9.4786e-08     2.8296e-06      5.141e-05     0.00056943      0.0038514       0.015932        0.04036       0.062672        0.059681         0.034852        0.012474       0.0027333      0.00039769      4.2008e-11      3.3763e-09      1.6588e-07      4.9518e-06      8.9968e-05       0.0009965         0.00674        0.027881         0.07063        0.10968          0.10444        0.060991        0.021829       0.0047833      0.00069596      3.6757e-11      2.9542e-09      1.4514e-07      4.3329e-06      7.8722e-05      0.00087194       0.0058975        0.024396        0.061801       0.095966         0.091387        0.053367          0.0191       0.0041854      0.00060897 
    4.9648e-13     5.9718e-11     4.3753e-09     1.9455e-07      5.258e-06     8.6517e-05     0.00086814      0.0053212       0.019954       0.045832        0.064537         0.055733        0.029512       0.0095762       0.0021508      8.6884e-13      1.0451e-10      7.6568e-09      3.4046e-07      9.2016e-06       0.0001514       0.0015192       0.0093122        0.034919       0.080206          0.11294        0.097533        0.051646        0.016758       0.0037639      7.6024e-13      9.1443e-11      6.6997e-09       2.979e-07      8.0514e-06      0.00013248       0.0013293       0.0081481        0.030554        0.07018         0.098823        0.085341        0.045191        0.014664       0.0032934 
    7.4532e-15     1.3416e-12     1.4671e-10     9.7262e-09     3.9144e-07     9.5785e-06     0.00014274      0.0012977      0.0072089       0.024506        0.051037         0.065171        0.051037        0.024506       0.0086593      1.3043e-14      2.3478e-12      2.5675e-10      1.7021e-08      6.8502e-07      1.6762e-05       0.0002498        0.002271        0.012616       0.042885         0.089316         0.11405        0.089316        0.042885        0.015154      1.1413e-14      2.0543e-12      2.2465e-10      1.4893e-08      5.9939e-07      1.4667e-05      0.00021858       0.0019871        0.011039       0.037525         0.078151        0.099794        0.078151        0.037525         0.01326 
    8.1145e-17     2.1862e-14     3.5712e-12     3.5329e-10     2.1194e-08     7.7207e-07     1.7106e-05      0.0002309       0.001902      0.0095762        0.029512         0.055733        0.064537        0.045832        0.026235        1.42e-16      3.8259e-14      6.2495e-12      6.1826e-10      3.7089e-08      1.3511e-06      2.9936e-05      0.00040408       0.0033285       0.016758         0.051646        0.097533         0.11294        0.080206        0.045912      1.2425e-16      3.3476e-14      5.4683e-12      5.4098e-10      3.2453e-08      1.1822e-06      2.6194e-05      0.00035357       0.0029124       0.014664         0.045191        0.085341        0.098823         0.07018        0.040173 
    6.4029e-19     2.5826e-16     6.3061e-14     9.3171e-12     8.3389e-10     4.5269e-08     1.4928e-06     2.9951e-05      0.0003662      0.0027333        0.012474         0.034852        0.059681        0.062672        0.060767      1.1205e-18      4.5195e-16      1.1036e-13      1.6305e-11      1.4593e-09      7.9222e-08      2.6124e-06      5.2413e-05      0.00064085      0.0047833         0.021829        0.060991         0.10444         0.10968         0.10634      9.8044e-19      3.9546e-16      9.6562e-14      1.4267e-11      1.2769e-09      6.9319e-08      2.2859e-06      4.5862e-05      0.00056075      0.0041854           0.0191        0.053367        0.091387        0.095966        0.093049 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_coh_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 38&times;1 double

        Values:

            Min          -20
            Median    17.552
            Max       57.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_c_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 772306&times;1 double

        Values:

            Min         0.02
            Median    38.635
            Max       77.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_interp_coh_grid_mesh_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    38    45

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15    mt_interp_coh_grid_mesh_z16    mt_interp_coh_grid_mesh_z17    mt_interp_coh_grid_mesh_z18    mt_interp_coh_grid_mesh_z19    mt_interp_coh_grid_mesh_z20    mt_interp_coh_grid_mesh_z21    mt_interp_coh_grid_mesh_z22    mt_interp_coh_grid_mesh_z23    mt_interp_coh_grid_mesh_z24    mt_interp_coh_grid_mesh_z25    mt_interp_coh_grid_mesh_z26    mt_interp_coh_grid_mesh_z27    mt_interp_coh_grid_mesh_z28    mt_interp_coh_grid_mesh_z29    mt_interp_coh_grid_mesh_z30    mt_interp_coh_grid_mesh_z31    mt_interp_coh_grid_mesh_z32    mt_interp_coh_grid_mesh_z33    mt_interp_coh_grid_mesh_z34    mt_interp_coh_grid_mesh_z35    mt_interp_coh_grid_mesh_z36    mt_interp_coh_grid_mesh_z37    mt_interp_coh_grid_mesh_z38    mt_interp_coh_grid_mesh_z39    mt_interp_coh_grid_mesh_z40    mt_interp_coh_grid_mesh_z41    mt_interp_coh_grid_mesh_z42    mt_interp_coh_grid_mesh_z43    mt_interp_coh_grid_mesh_z44    mt_interp_coh_grid_mesh_z45
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

                  -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20                            -20          
              -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854          
              -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708          
              -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562          
              -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417          
              -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707          
              -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249          
               -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979          
              -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332          
             -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734          

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15    mt_interp_coh_grid_mesh_z16    mt_interp_coh_grid_mesh_z17    mt_interp_coh_grid_mesh_z18    mt_interp_coh_grid_mesh_z19    mt_interp_coh_grid_mesh_z20    mt_interp_coh_grid_mesh_z21    mt_interp_coh_grid_mesh_z22    mt_interp_coh_grid_mesh_z23    mt_interp_coh_grid_mesh_z24    mt_interp_coh_grid_mesh_z25    mt_interp_coh_grid_mesh_z26    mt_interp_coh_grid_mesh_z27    mt_interp_coh_grid_mesh_z28    mt_interp_coh_grid_mesh_z29    mt_interp_coh_grid_mesh_z30    mt_interp_coh_grid_mesh_z31    mt_interp_coh_grid_mesh_z32    mt_interp_coh_grid_mesh_z33    mt_interp_coh_grid_mesh_z34    mt_interp_coh_grid_mesh_z35    mt_interp_coh_grid_mesh_z36    mt_interp_coh_grid_mesh_z37    mt_interp_coh_grid_mesh_z38    mt_interp_coh_grid_mesh_z39    mt_interp_coh_grid_mesh_z40    mt_interp_coh_grid_mesh_z41    mt_interp_coh_grid_mesh_z42    mt_interp_coh_grid_mesh_z43    mt_interp_coh_grid_mesh_z44    mt_interp_coh_grid_mesh_z45
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

              37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938                         37.938           
              40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084                         40.084           
               42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23                          42.23           
              44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376                         44.376           
              46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521                         46.521           
              48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667                         48.667           
              50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813                         50.813           
              52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959                         52.959           
              55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105                         55.105           
              57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251                         57.251           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_a
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9      mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19      mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29      mt_a30     mt_a31     mt_a32      mt_a33     mt_a34     mt_a35      mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50     mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    ________    _______    _______    ________    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______

     -20     -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818      -0.02     1.1909        3.31     5.4291     7.5482      9.6673     11.786     13.905     16.025      18.144     20.263     22.382     24.501      26.62     28.739     30.858     32.977     35.096     37.215      39.335     41.454     43.573     45.692     47.811      49.93
     -20     -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036    -3.3467    -2.3374    -0.57111     1.1952     2.9614      4.7277     6.4939     8.2602     10.026      11.793     13.559     15.325     17.092     18.858     20.624      22.39     24.157     25.923     27.689      29.455     31.222     32.988     34.754      36.52     38.287
     -20     -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791    -6.6733    -5.8657     -4.4522    -3.0388    -1.6254    -0.21192     1.2015     2.6149     4.0284      5.4418     6.8553     8.2687     9.6821     11.096     12.509     13.922     15.336     16.749     18.163      19.576      20.99     22.403     23.816      25.23     26.643
     -20     -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455        -10    -9.3939     -8.3333    -7.2727    -6.2121     -5.1515    -4.0909    -3.0303    -1.9697    -0.90909    0.15152     1.2121     2.2727     3.3333     4.3939     5.4545     6.5152     7.5758     8.6364       9.697     10.758     11.818     12.879     13.939         15
     -20     -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63    -13.327    -12.922     -12.214    -11.507    -10.799     -10.091    -9.3833    -8.6756    -7.9678       -7.26    -6.5522    -5.8444    -5.1367    -4.4289    -3.7211    -3.0133    -2.3056    -1.5978      -0.89    -0.18222    0.52556     1.2333     1.9411     2.6489     3.3567
     -20     -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805    -16.653    -16.451     -16.096    -15.741    -15.386     -15.031    -14.676    -14.321    -13.966     -13.611    -13.256    -12.901    -12.546    -12.191    -11.836    -11.481    -11.126    -10.771    -10.416     -10.061    -9.7065    -9.3515    -8.9966    -8.6416    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -19.98    -19.979     -19.977    -19.975    -19.972      -19.97    -19.968    -19.966    -19.964     -19.962     -19.96    -19.958    -19.955    -19.953    -19.951    -19.949    -19.947    -19.945    -19.943     -19.941    -19.938    -19.936    -19.934    -19.932     -19.93

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9      mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19      mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29      mt_a30     mt_a31     mt_a32      mt_a33     mt_a34     mt_a35      mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50     mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    ________    _______    _______    ________    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______

     -20     -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818      -0.02     1.1909        3.31     5.4291     7.5482      9.6673     11.786     13.905     16.025      18.144     20.263     22.382     24.501      26.62     28.739     30.858     32.977     35.096     37.215      39.335     41.454     43.573     45.692     47.811      49.93
     -20     -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036    -3.3467    -2.3374    -0.57111     1.1952     2.9614      4.7277     6.4939     8.2602     10.026      11.793     13.559     15.325     17.092     18.858     20.624      22.39     24.157     25.923     27.689      29.455     31.222     32.988     34.754      36.52     38.287
     -20     -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791    -6.6733    -5.8657     -4.4522    -3.0388    -1.6254    -0.21192     1.2015     2.6149     4.0284      5.4418     6.8553     8.2687     9.6821     11.096     12.509     13.922     15.336     16.749     18.163      19.576      20.99     22.403     23.816      25.23     26.643
     -20     -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455        -10    -9.3939     -8.3333    -7.2727    -6.2121     -5.1515    -4.0909    -3.0303    -1.9697    -0.90909    0.15152     1.2121     2.2727     3.3333     4.3939     5.4545     6.5152     7.5758     8.6364       9.697     10.758     11.818     12.879     13.939         15
     -20     -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63    -13.327    -12.922     -12.214    -11.507    -10.799     -10.091    -9.3833    -8.6756    -7.9678       -7.26    -6.5522    -5.8444    -5.1367    -4.4289    -3.7211    -3.0133    -2.3056    -1.5978      -0.89    -0.18222    0.52556     1.2333     1.9411     2.6489     3.3567
     -20     -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805    -16.653    -16.451     -16.096    -15.741    -15.386     -15.031    -14.676    -14.321    -13.966     -13.611    -13.256    -12.901    -12.546    -12.191    -11.836    -11.481    -11.126    -10.771    -10.416     -10.061    -9.7065    -9.3515    -8.9966    -8.6416    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -19.98    -19.979     -19.977    -19.975    -19.972      -19.97    -19.968    -19.966    -19.964     -19.962     -19.96    -19.958    -19.955    -19.953    -19.951    -19.949    -19.947    -19.945    -19.943     -19.941    -19.938    -19.936    -19.934    -19.932     -19.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_a_meshk
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_a_meshk: 385&times;1 double

        Values:

            Min             -20   
            Median      -12.933   
            Max           49.93   

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_k
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9      mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18     mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28     mt_k29      mt_k30     mt_k31     mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37      mt_k38      mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46     mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0.02    0.021212    0.023333    0.025455    0.027576    0.029697    0.031818    0.033939    0.036061    0.038182    0.040303    0.042424    0.044545    0.046667    0.048788    0.050909    0.05303    0.055152    0.057273    0.059394    0.061515    0.063636    0.065758    0.067879      0.07
      0        0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945    3.3467      3.5495      3.9044      4.2594      4.6143      4.9693      5.3242      5.6792      6.0341      6.3891       6.744       7.099      7.4539      7.8089      8.1638      8.5188     8.8737      9.2287      9.5836      9.9386      10.294      10.648      11.003      11.358    11.713
      0        0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37    6.6733      7.0778      7.7856      8.4933      9.2011      9.9089      10.617      11.324      12.032       12.74      13.448      14.156      14.863      15.571      16.279      16.987     17.694      18.402       19.11      19.818      20.526      21.233      21.941      22.649    23.357
      0         1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455        10      10.606      11.667      12.727      13.788      14.848      15.909       16.97       18.03      19.091      20.152      21.212      22.273      23.333      24.394      25.455     26.515      27.576      28.636      29.697      30.758      31.818      32.879      33.939        35
      0         1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721    13.327      14.134      15.548      16.961      18.375      19.788      21.202      22.615      24.028      25.442      26.855      28.269      29.682      31.096      32.509      33.922     35.336      36.749      38.163      39.576       40.99      42.403      43.816       45.23    46.643
      0         1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896    16.653      17.663      19.429      21.195      22.961      24.728      26.494       28.26      30.026      31.793      33.559      35.325      37.092      38.858      40.624       42.39     44.157      45.923      47.689      49.455      51.222      52.988      54.754       56.52    58.287
      0         2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072     19.98      21.191       23.31      25.429      27.548      29.667      31.786      33.905      36.025      38.144      40.263      42.382      44.501       46.62      48.739      50.858     52.977      55.096      57.215      59.335      61.454      63.573      65.692      67.811     69.93

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9      mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18     mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28     mt_k29      mt_k30     mt_k31     mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37      mt_k38      mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46     mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0.02    0.021212    0.023333    0.025455    0.027576    0.029697    0.031818    0.033939    0.036061    0.038182    0.040303    0.042424    0.044545    0.046667    0.048788    0.050909    0.05303    0.055152    0.057273    0.059394    0.061515    0.063636    0.065758    0.067879      0.07
      0        0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945    3.3467      3.5495      3.9044      4.2594      4.6143      4.9693      5.3242      5.6792      6.0341      6.3891       6.744       7.099      7.4539      7.8089      8.1638      8.5188     8.8737      9.2287      9.5836      9.9386      10.294      10.648      11.003      11.358    11.713
      0        0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37    6.6733      7.0778      7.7856      8.4933      9.2011      9.9089      10.617      11.324      12.032       12.74      13.448      14.156      14.863      15.571      16.279      16.987     17.694      18.402       19.11      19.818      20.526      21.233      21.941      22.649    23.357
      0         1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455        10      10.606      11.667      12.727      13.788      14.848      15.909       16.97       18.03      19.091      20.152      21.212      22.273      23.333      24.394      25.455     26.515      27.576      28.636      29.697      30.758      31.818      32.879      33.939        35
      0         1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721    13.327      14.134      15.548      16.961      18.375      19.788      21.202      22.615      24.028      25.442      26.855      28.269      29.682      31.096      32.509      33.922     35.336      36.749      38.163      39.576       40.99      42.403      43.816       45.23    46.643
      0         1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896    16.653      17.663      19.429      21.195      22.961      24.728      26.494       28.26      30.026      31.793      33.559      35.325      37.092      38.858      40.624       42.39     44.157      45.923      47.689      49.455      51.222      52.988      54.754       56.52    58.287
      0         2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072     19.98      21.191       23.31      25.429      27.548      29.667      31.786      33.905      36.025      38.144      40.263      42.382      44.501       46.62      48.739      50.858     52.977      55.096      57.215      59.335      61.454      63.573      65.692      67.811     69.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_k_mesha
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_k_mesha: 385&times;1 double

        Values:

            Min               0   
            Median       7.0672   
            Max           69.93   

pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
pos = 8 ; key = f_util_standin_coh ; val = @(coh,fl_r_borr)f_util_log((coh-fl_b_bd).*((coh&gt;0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+((coh-fl_b_bd)./(1)).*((coh&lt;=0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+(fl_c_min./(1+fl_r_borr)).*((((coh-fl_b_bd)./(1))&lt;=fl_c_min)))
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 35
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
%% FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids
% This file is based on
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, see that file for more comments and compare
% differences in graphs and tables to see how the inclusion of formal and
% informal choices that consider bridge loans impact choice sets.
%
% Also compare against
% <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html
% ffs_abz_fibs_get_funcgrid> where the results are also considering formal
% and informal choices etc in the context of *abz fibs*.
%
% In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and
% savings formal and informal. These will change how the testing matrix is
% constructed. When bridge loan is allowed, we also need to construct the
% output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that
% coh today does not matter, so to find optimal k* choice, we only need to
% know the aggregate savings level. But now, we need to know the coh level
% as well.
%
% Below two reachable coh matrixes are constructed, one for when aggregate
% savings choice w >= 0, and another for when aggregate savings <= 0. Then
% they are stacked together. And we still have the same outputs as
% ff_ipwkbz_evf.m. The difference is that while for savings where w >=0,
% each row are w levels for the output matrixes, but for w <=0, each row is
% for w level + coh percentage combinations.
%
% * _ar_w_level_: What are the feasible grid of w = k'+b', these are to be interpolated
% later, these are level grid, not percentage grid
% * _ar_w_level_: What are the percentage based choices points for k' and
% b' given each w. These are _ar_a_meshk_, _ar_k_mesha_. Note here these
% are principles, k + b' is the total aggregate savings in period t. b is
% be a combination of formal and informal choices, but our percentage point
% for b is the overall principle of all formal and informal choices
% * _mt_coh_wkb_full_ : These are the cash-on-hand levels reacheable given
% the choice percentages of k and b'. The problem here is more complicated
% than
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> because here we can not get to coh tomorrow by
% multiplying principle by savings or borrowing interest rates, if
% borrowing, we have to optimize among formal and informal choices. That is
% computationally trivial because it's a static choice unrelated to the
% dynamic problem. The slightly more complicated thing is that we also have
% to consider percentages of b' that has to go to bridge loans due to
% negative cash-on-hand in period t. That makes the reachable cash-on-hand
% grid significantly larger than the grid in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, we have to expand the grid by another
% percentage dimensionREPLACE_WITH_DASH_DASHpercentages of b' going to bridgeREPLACE_WITH_DASH_DASHfor negative
% levels of w=k'+b' overall choice.
%

%% Default
% Results identical to
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> is obtained by running default with:
% st_param_which = 'ffs_ipwkbz_get_funcgrid';
%

bl_input_override = 0;
if (length(varargin) == 3)
    bl_input_override = varargin{3};
end
if (bl_input_override)
    % override when called from outside
    [param_map, support_map, ~] = varargin{:};
else
    % default internal run
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    support_map('bl_display_funcgrids') = true;

    st_param_which = 'small';

    if (ismember(st_param_which, ['default', 'ffs_ipwkbz_get_funcgrid']))

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 25;
        param_map('it_ak_perc_n') = 45;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

        % Note it_coh_bridge_perc is percentage NOT for BRIDGE
        if (strcmp(st_param_which, 'default'))

            param_map('it_coh_bridge_perc_n') = 3;

            % Adjust interest rates
            param_map('fl_r_inf') = 0.30;
            param_map('fl_r_inf_bridge') = 0.30;
            param_map('bl_bridge') = true;

        elseif (strcmp(st_param_which, 'ffs_ipwkbz_get_funcgrid'))


            param_map('fl_r_inf') = 0.025;
            param_map('fl_r_inf_bridge') = 0.025;
            param_map('bl_bridge') = false;
            % when bl_bridge = false, it_coh_bridge_perc_n = 1

        end

    elseif (strcmp(st_param_which, 'small'))

        param_map('bl_bridge') = true;

        % Adjust interest rates
        param_map('fl_r_inf') = 0.30;
        param_map('fl_r_inf_bridge') = 0.30;

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = false; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 7;
        param_map('it_ak_perc_n') = 7;
        param_map('it_coh_bridge_perc_n') = 3;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

    end

    param_map('fl_z_r_borr_min') = 0.025;
    param_map('fl_z_r_borr_max') = 0.95;
    param_map('fl_z_r_borr_n') = 3;
    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');

    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
end

%% Parse Parameters 1a

params_group = values(param_map, {'bl_bridge', 'fl_b_bd', 'fl_w_min', 'fl_w_max'});
[bl_bridge, fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min'});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'bl_b_is_principle', 'fl_r_fbr', 'fl_r_fsv', 'fl_w'});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_w] = params_group{:};

%% Parse Parameters 1b

params_group = values(param_map, {...
    'it_w_perc_n', 'it_ak_perc_n', 'it_coh_bridge_perc_n', ...
    'it_c_interp_grid_gap', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[it_w_perc_n, it_ak_perc_n, it_coh_bridge_perc_n, ...
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

%% Parse Parameters 2

% param_map shock income
params_group = values(param_map, {'it_z_wage_n', 'fl_z_wage_mu', 'fl_z_wage_rho', 'fl_z_wage_sig'});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

% param_map shock borrowing interest
params_group = values(param_map, {'st_z_r_borr_drv_ele_type', 'st_z_r_borr_drv_prb_type', 'fl_z_r_borr_poiss_mean', ...
    'fl_z_r_borr_max', 'fl_z_r_borr_min', 'fl_z_r_borr_n'});
[st_z_r_borr_drv_ele_type, st_z_r_borr_drv_prb_type, fl_z_r_borr_poiss_mean, ...
    fl_z_r_borr_max, fl_z_r_borr_min, fl_z_r_borr_n] = params_group{:};

% param_map formal menu
params_group = values(param_map, {'st_forbrblk_type', 'fl_forbrblk_brmost', 'fl_forbrblk_brleast', 'fl_forbrblk_gap'});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

% param_map shock income
params_group = values(param_map, {'it_z_n'});
[it_z_n] = params_group{:};

%% Parse Parameters 3

params_group = values(support_map, {'bl_display_minccost', 'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};

%% G1: Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html
% ffs_ipwkbz_fibs_set_default_param> for details.
%
% @example
%
%    % For 2nd stage Grid
%    ar_w_level = [-2,0,2]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

%% G2: Expand A and K Arrays further if bridge is allowed
% Crucially, when a fraction of overall borrowing/savings needs to go pay
% negative coh, that comes out of w, fraction of w = k' + b' that goes to
% this. NOT a fraction of the b' choice condition on w, which would change
% for the same w as w' changes. We are fixing bridge repay level for w.
%
% @example
%
%    clear all
%    % Same as above
%    ar_w_level = [-2,-1,-0.1]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%
%    % fraction of borrowing for bridge loan
%    ar_coh_bridge_perc = [0, 0.5, 0.999];
%
%    % Expand matrix to include coh percentage dimension
%    mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
%    mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])
%
%    % bridge loan component of borrowing
%    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
%    ar_brdige_a = ar_brdige_a(:)'
%
%    % borrowing choices excluding bridge loan
%    mt_a_nobridge = mt_a - ar_brdige_a
%

% 1. negative part of w
ar_bl_w_neg = (ar_w_level < 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

if (bl_bridge)

    % 1. select mt_k and mt_a where w_level <= 0
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    % 2. fraction of borrowing NOT for bridge loan
    % 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    % 3. Expand matrix to include coh percentage dimension
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    % 4. bridge loan component of borrowing
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    % 5. borrowing choices excluding bridge loan
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    % 6. Matrix combine, negative than positive
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    % 7. Expand Bridge Choices to have the same size as mt_a
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    % 8. Overall borrowing and savings choices
    mt_a = mt_a_nobridge + mt_bridge_a;

    % 9. Update w
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    % 10. Pre-generate Interpolation matrix for negative w levels
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

else

    % If bridge loans are not needed, do not need to do expansions
    % All zeros, no bridge
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

end

%% G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.
% For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N
% number of rows. Where N is the percentage grid point for coh as well as
% k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos =
% numger of grid points for ar_w_level
%
% # *mt_a* includes aggregate/total borrowing and savings levels. b < 0 happens
% alot when w >= 0. The mt_a_nobridge
% # *mt_a_nobridge* includes all aggregate/total borrowing and savings
% whether w > 0 or w < 0, however, it subtracts away the borrowing that is
% for bridge loans when b < 0
% # *mt_bridge_a* is the bridge loan amount.
%

ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;

%% F1: Get Shock: Income Shock (ar1)

[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);

%% F2: Get Shock: Interest Rate Shock (iid)

% get borrowing grid and probabilities
param_dsv_map = containers.Map('KeyType','char', 'ValueType','any');
param_dsv_map('st_drv_ele_type') = st_z_r_borr_drv_ele_type;
param_dsv_map('st_drv_prb_type') = st_z_r_borr_drv_prb_type;
param_dsv_map('fl_poiss_mean') = fl_z_r_borr_poiss_mean;
param_dsv_map('fl_max') = fl_z_r_borr_max;
param_dsv_map('fl_min') = fl_z_r_borr_min;
param_dsv_map('fl_n') = fl_z_r_borr_n;
[ar_z_r_borr, ar_z_r_borr_prob] = fft_gen_discrete_var(param_dsv_map, true);

% iid transition matrix
mt_z_r_borr_prob_trans = repmat(ar_z_r_borr_prob, [length(ar_z_r_borr_prob), 1]);

%% F3: Get Shock: Mesh Shocks Together

% Kronecker product to get full transition matrix for the two shocks
mt_z_trans = kron(mt_z_r_borr_prob_trans, mt_z_wage_trans);

% mesh the shock vectors
[mt_z_wage_mesh_r_borr_w1r2, mt_z_r_borr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_borr);
ar_z_r_borr_mesh_wage_w1r2 = mt_z_r_borr_mesh_wage_w1r2(:)';
ar_z_wage_mesh_r_borr_w1r2 = mt_z_wage_mesh_r_borr_w1r2(:)';

% mesh the shock vectors
[mt_z_r_borr_mesh_wage_r1w2, mt_z_wage_mesh_r_borr_r1w2] = ndgrid(ar_z_r_borr, ar_z_wage);
ar_z_wage_mesh_r_borr_r1w2 = mt_z_wage_mesh_r_borr_r1w2(:)';
ar_z_r_borr_mesh_wage_r1w2 = mt_z_r_borr_mesh_wage_r1w2(:)';


if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2');
    disp('Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_r_borr_mesh_wage_w1r2;...
                                 ar_z_wage_mesh_r_borr_w1r2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2');
    disp('Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_wage_mesh_r_borr_r1w2;...
                                 ar_z_r_borr_mesh_wage_r1w2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:length(ar_z_r_borr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_borr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_borr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr', 'r%3.2f')]);
    tb_z_r_borr_prob_trans = array2table(round(mt_z_r_borr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_r_borr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_borr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_borr_prob_trans));
    disp(tb_z_r_borr_prob_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', 'w%3.2f')]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Full Transition Matrix: mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', 'r%3.2f;'), ...
                                   num2str(ar_z_wage_mesh_r_borr_w1r2', 'w%3.2f')]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('i', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('i', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

end

%% FIBS1: Get Equations

[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = ...
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);

%% FIBS2: Get Formal Borrowing Blocks

[ar_forbrblk, ar_forbrblk_r] = ...
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);

%% Find Formal and Informal Choices for Borrowing points
% Here we solve for the optimal formal and informal choices given b. Note
% that kind of like the static firm's maximization problem. Here the
% optimization problem is static, and can be done independently of the
% overall dynamic optimization problem.

% When borrowing index and array
% note index for negative is from _ar_a_meshk_full_, but value from
% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some
% of these points _ar_a_nobridge_meshk_ = 0. But need to use
% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all
% borrowing.
ar_bl_ameshk_neg_idx = (ar_a_meshk_full < 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

% Given b, solve for optimal formal and informal choices.
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = ...
   ffs_fibs_min_c_cost(bl_b_is_principle, ar_z_r_borr, fl_r_fsv, ...
                         ar_forbrblk_r, ar_forbrblk, ...
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);

%% FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative
% *ar_coh_fbis_aneg*: the consumption cost to t+1 from borrowing in t given
% formal and informal joint choice optimization.
%
% Reachable cash-on-hand borrowing points: N_neg*N^2 rows
%
% Additionally, need to convert borrowing choices to consumption units next
% period. borrowing choices in percentage are in unit of last period
% borrowing, principles only, need to convert to interest rates plus
% principle which means considering which formal informal choice
% combination maximizes cash-on-hand for the same level of overall
% principles.
%
% Construct another percentage, which is, percentages of ar_a_meshk_full
% when w < 0. Percentage represents what fraction of the a debt is going
% towards bridge loan debts. Note that as long as w < 0, b < 0 must be the
% case as well. So for negative elements of w, there is a triple mesh: N
% points for A x N points for K x N points for Bridge.
%

ar_coh_fbis_aneg = f_coh_fbis(ar_z_r_borr, ...
                                ar_for_borr_aneg, ...
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), ...
                                ar_for_save_aneg);

%% FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive
% *ar_coh_save_apos*: the consumption gain to t+1 from savings in t

ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);

%% COH1: Combine overall Reachable Cash-on-Hand Levels
% ROWS: N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count.
% These are the cash-on-hand points reachable given percentage grid choice
% structure and the possibility of bridge loans.
% COLUMNS: determined by length(ar_z_r_borr), each column a different
% informal borrowing interest rate.
%
% # mt_coh_wkb_full: this is the (P^k x I^w x M^r) by (M^z) matrix, where
% rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n, and cols = it_z_wage_n.
%

mt_ameshk_tnext_with_r = zeros(length(ar_k_mesha), fl_z_r_borr_n);
mt_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx, :) = ar_coh_fbis_aneg;
mt_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx, :) = zeros(1, fl_z_r_borr_n) + ar_coh_save_apos;

% # mt_ameshk_tnext_with_r: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w ) by (M^r) matrix
% # mt_coh_wkb_full: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix

mt_k_mesha_mesh_z_wage = ar_k_mesha + zeros(1, fl_z_r_borr_n);
mt_coh_wkb_full = f_coh(ar_z_wage, mt_ameshk_tnext_with_r(:), mt_k_mesha_mesh_z_wage(:));

% Generate Aggregate Variables
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

if (bl_display_funcgrids || bl_graph_funcgrids)
    
    % Generate Aggregate Variables
    mt_bwithrplusk_mesh = mt_ameshk_tnext_with_r + ar_k_mesha;

    % Genereate Table
    tab_ak_choices = array2table([mt_bwithrplusk_mesh, ar_aplusk_mesh, ...
                                  ar_k_mesha, mt_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = [strcat('mt_bwthrplusk', string((1:length(ar_z_r_borr)))), ...
                    'ar_aplusk_mesha', 'ar_k_mesha', ...
                    strcat('mt_a_wth_r_borr', string((1:length(ar_z_r_borr)))), ...
                    'ar_a_meshk', 'ar_a_nobridge_meshk', 'ar_bridge_a'];
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesha'} = ...
        '*ar_aplusk_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha'} = ...
        '*ar_k_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk'} = ...
        '*ar_a_meshk*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_nobridge_meshk'} = ...
        '*ar_aprime_nobridge*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_bridge_a'} = ...
        '*ar_bridge_a*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('tab_ak_choices');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

end

%% COH2: Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
% mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, length(ar_w_level_full)*fl_z_r_borr_n]);

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.

ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_borr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));

%% COH3: Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% COH4: Select only Valid (k(w), a) choices

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;
% mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);
mt_z_r_borr_mesh_coh_wkb = repmat(ar_z_r_borr, [size(mt_coh_wkb,1),1]);
mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;

% This is borrowing with default or not condition
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

% 1. Given COH grid, w choices in terms of cash-on-hand percentages
if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end

% 2. Some w < 0, some w > 0. When w < 0, coh > 0 or coh < 0 both possible.
% Need to interplate in ff_ipwkbz_fibs_vecsv differently for w < 0 because
% there both w as well as coh matters, if coh < 0 and w < 0, a fraction of
% w goes to getting informal bridge loans.
mt_bl_w_by_interp_coh_interp_grid_wneg = (mt_w_perc_mesh_interp_coh_grid < 0);
mt_w_by_interp_coh_interp_grid_wneg = mt_w_perc_mesh_interp_coh_grid(mt_bl_w_by_interp_coh_interp_grid_wneg);
mt_w_by_interp_coh_interp_grid_wpos = mt_w_perc_mesh_interp_coh_grid(~mt_bl_w_by_interp_coh_interp_grid_wneg);

%% Generate 1st Stage Choices: Percent of W for Covering Bridge Loans
% If bridge loan does not matter, do not need to cover bridge loan. Then
% these percentages should reflect what happens when param_map('bl_bridge')
% = false, and, param_map('it_coh_bridge_perc_n') = 1;

% 1. Expand cash-on-hand by w_perc grid
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_perc_mesh_interp_coh_grid)) + ar_interp_coh_grid;

% 2. How much is coh as perc of w_perc grid level choice based on w_perc
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_perc_mesh_interp_coh_grid));

% 3. The ratio only relevant for where w < 0 and where coh < 0. Note the
% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to
% bridge.
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc >= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_by_interp_coh_interp_grid_wneg);

%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): base arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # ar_interp_c_grid: 1 by I^c
% # ar_interp_coh_grid: 1 by I^{coh}
% # ar_w_level: 1 by I^{W=k+b}
% # ar_w_perc: 1 by P^{W=k+b}
% # ar_ak_perc: 1 by P^{k and b}
%
% more descriptions:
%
% # ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation
% # ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)
% # ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level
% of w over which we solve the optimal percentage k' choices. Need to
% generate interpolant based on this so that we know optimal k* given
% ar_w_perc(coh) in the 1st stage
% # ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set.
% 1st stage, percentage w choice given coh, at each coh level the number of
% choice points is the same for this problem with
% percentage grid points.
% # ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set
%

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('ar_w_level') = ar_w_level;
armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_ak_perc') = ar_ak_perc;

%% Store armt_map (2): 1st stage level coh on hand related arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w
% # mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w
% # mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}
% # mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}
%
% more descriptions:
%
% # *mt_w_perc_mesh_interp_coh_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('mt_interp_coh_grid_mesh_z_wage') = mt_interp_coh_grid_mesh_z_wage;
armt_map('mt_z_wage_mesh_interp_coh_grid') = mt_z_wage_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;
armt_map('mt_w_perc_mesh_interp_coh_grid') = mt_w_perc_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;


%% Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_coh_wkb: ((P^{k}_{a>=0} + P^{k}_{a<0} x P^{w frac bridge} ) x I^w x M^r) by (M^z) matrix
% # mt_z_wage_mesh_coh_wkb: same as mt_coh_wkb
%

armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_z_wage_mesh_coh_wkb') = mt_z_wage_mesh_coh_wkb;

%% Store armt_map (4): 2nd stage additional arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_k: (I^w) by (P^{k and b})
% # ar_a_meshk: 1 by (I^w x P^{k and b})
% # ar_k_mesha: 1 by (I^w x P^{k and b})
% # ar_aplusk_mesh: 1 by (I^w x P^{k and b})
% # it_ameshk_n: scalar
%

armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('ar_aplusk_mesh') = ar_aplusk_mesh;
armt_map('it_ameshk_n') = length(ar_a_meshk);

%% Store armt_map (5): Shock Grids Arrays and Mesh
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # ar_z_r_borr: 1 by (M^r)
% # ar_z_r_borr_prob: 1 by (M^r)
% # ar_z_wage: 1 by (M^z)
% # ar_z_wage_prob: 1 by (M^z)
% # ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)
% # ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)
% # ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)
% # ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)
%

armt_map('ar_z_r_borr') = ar_z_r_borr;
armt_map('ar_z_r_borr_prob') = ar_z_r_borr_prob;

armt_map('ar_z_wage') = ar_z_wage;
armt_map('ar_z_wage_prob') = ar_z_wage_prob;

armt_map('ar_z_r_borr_mesh_wage_w1r2') = ar_z_r_borr_mesh_wage_w1r2;
armt_map('ar_z_wage_mesh_r_borr_w1r2') = ar_z_wage_mesh_r_borr_w1r2;
armt_map('ar_z_r_borr_mesh_wage_r1w2') = ar_z_r_borr_mesh_wage_r1w2;
armt_map('ar_z_wage_mesh_r_borr_r1w2') = ar_z_wage_mesh_r_borr_r1w2;

armt_map('mt_z_trans') = mt_z_trans;


%% Store armt_map (6): W Share for Bridge Parameters
%
% # *ar_w_level_full*: in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/solve/html/ff_ipwkbz_vf_vecsv.html
% ff_ipwkbz_vf_vecsv>, _ar_w_level_ and _ar_w_level_full_ were the same.
% Now have this thing which is stored (length(ar_w_level_full)) by
% (length(ar_z)). _ar_w_level_full_ includes not just different levels of
% _ar_w_level_, but also repeats the elements of _ar_w_level_ that are < 0
% by _it_coh_bridge_perc_n_ times, starting with what corresponds to 100
% percent of w should go to cover bridge loan, until 0 percent for w < 0,
% which then proceeds to w > 0. So the last segment of _ar_w_level_full_ is
% the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) =
% ar_w_level.
%

armt_map('ar_coh_bridge_perc') = ar_coh_bridge_perc;
armt_map('ar_w_level_full') = ar_w_level_full;
armt_map('ar_ameshk_tnext_with_r') = mt_ameshk_tnext_with_r;

armt_map('mt_w_level_neg_mesh_coh_bridge_perc') = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map('mt_coh_bridge_perc_mesh_w_level_neg') = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map('mt_bl_w_by_interp_coh_interp_grid_wneg') = mt_bl_w_by_interp_coh_interp_grid_wneg;
armt_map('mt_w_by_interp_coh_interp_grid_wneg') = mt_w_by_interp_coh_interp_grid_wneg;
armt_map('mt_w_by_interp_coh_interp_grid_wpos') = mt_w_by_interp_coh_interp_grid_wpos;
armt_map('mt_coh_w_perc_ratio_wneg') = mt_coh_w_perc_ratio_wneg;


%% Store Function Map

func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_util_standin_coh') = f_util_standin_coh;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Generate Limited Legends
    % 8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates
    ar_it_z_r_borr = ([1 round((fl_z_r_borr_n)/2) (fl_z_r_borr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    % combine by index
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_borr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    % legends index final
    cl_st_legendCell = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', 'zr=%3.2f;'), ...
                                num2str(ar_z_wage_mesh_r_borr_w1r2', 'zw=%3.2f')]);

    % legends index final full mat wage only
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', 'zw=%3.2f')]);
    
    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.
    %
    % Plot end because earlier parts have repeating w and a levels due to
    % potentially bridge which are coh percentage dependent. This will only
    % plot out the grid basically when coh percentage for bridge loan = 0
    %

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), ...
                 mt_k(:,it_col_start:it_col_end), ...
                 'blue');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

%     if (length(ar_w_level_full) <= 100)
    scatter(ar_a_meshk(it_col_start:it_col_end), ...
            ar_k_mesha(it_col_start:it_col_end), ...
            3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level) <= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),...
                                     ar_k_mesha_full(ar_bl_wkb_invalid(it_col_start:it_col_end)),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title({'Risky K Percentage Grids Given w=k+a (2nd Stage)'...
           '(Bridge Borrow Share = 0)'})
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end

    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
            'Super-Seg: borrow r; Seg: w bridge perc; Sub-Seg: w=k+b; within inc. k'...    
            'For each w and z, coh maximizing k is different'});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), ...
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), 'Location', 'northwest');
    
    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z_wage');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_w_perc_mesh_interp_coh_grid));
    disp(head(array2table(mt_w_perc_mesh_interp_coh_grid), 10));
    disp(tail(array2table(mt_w_perc_mesh_interp_coh_grid), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_coh_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_coh_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_c_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_c_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_interp_coh_grid_mesh_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_a');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_a_meshk');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_a_meshk));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_k');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_k_mesha');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    for i = 1:length(func_map)
        st_display = strjoin(['pos =' num2str(i) '; key =' string(param_map_keys{i}) '; val =' func2str(param_map_vals{i})]);
        disp(st_display);
    end

end

end

##### SOURCE END #####
--></body></html>