
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-13"><meta name="DC.source" content="ffs_ipwkbz_fibs_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Default</a></li><li><a href="#5">Parse Parameters</a></li><li><a href="#6">G1: Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#7">G2: Expand A and K Arrays further if bridge is allowed</a></li><li><a href="#8">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</a></li><li><a href="#9">F1: Get Shock Grids</a></li><li><a href="#10">FIBS1: Get Equations</a></li><li><a href="#11">FIBS2: Get Formal Borrowing Blocks</a></li><li><a href="#12">Find Formal and Informal Choices for Borrowing points</a></li><li><a href="#13">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</a></li><li><a href="#14">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</a></li><li><a href="#15">COH1: Combine overall Reachable Cash-on-Hand Levels</a></li><li><a href="#16">COH2: Check if COH is within Borrowing Bounds</a></li><li><a href="#17">COH3: Update Valid 2nd stage choice matrix</a></li><li><a href="#18">COH4: Select only Valid (k(w), a) choices</a></li><li><a href="#19">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#20">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#21">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</a></li><li><a href="#22">Generate Interpolation Consumption Grid</a></li><li><a href="#23">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#24">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</a></li><li><a href="#25">Store armt_map (2): First Stage Aggregate Savings</a></li><li><a href="#26">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</a></li><li><a href="#27">Store armt_map (4): Shock Grids</a></li><li><a href="#28">Store armt_map (5): Formal grid</a></li><li><a href="#29">Store Function Map</a></li><li><a href="#30">Graph</a></li><li><a href="#32">Graph 1: a and k choice grid graphs</a></li><li><a href="#33">Graph 2: coh by shock</a></li><li><a href="#34">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#36">Graph Details, Generally do Not Run</a></li><li><a href="#38">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#39">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#41">Display</a></li><li><a href="#42">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>This file is based on <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, see that file for more comments and compare differences in graphs and tables to see how the inclusion of formal and informal choices that consider bridge loans impact choice sets.</p><p>Also compare against <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html">ffs_abz_fibs_get_funcgrid</a> where the results are also considering formal and informal choices etc in the context of <b>abz fibs</b>.</p><p>In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and savings formal and informal. These will change how the testing matrix is constructed. When bridge loan is allowed, we also need to construct the output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that coh today does not matter, so to find optimal k* choice, we only need to know the aggregate savings level. But now, we need to know the coh level as well.</p><p>Below two reachable coh matrixes are constructed, one for when aggregate savings choice w &gt;= 0, and another for when aggregate savings &lt;= 0. Then they are stacked together. And we still have the same outputs as ff_ipwkbz_evf.m. The difference is that while for savings where w &gt;=0, each row are w levels for the output matrixes, but for w &lt;=0, each row is for w level + coh percentage combinations.</p><div><ul><li><i>ar_w_level</i>: What are the feasible grid of w = k'+b', these are to be interpolated later, these are level grid, not percentage grid</li><li><i>ar_w_level</i>: What are the percentage based choices points for k' and b' given each w. These are <i>ar_a_meshk</i>, <i>ar_k_mesha</i>. Note here these are principles, k + b' is the total aggregate savings in period t. b is be a combination of formal and informal choices, but our percentage point for b is the overall principle of all formal and informal choices</li><li><i>mt_coh_wkb_full</i> : These are the cash-on-hand levels reacheable given the choice percentages of k and b'. The problem here is more complicated than <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> because here we can not get to coh tomorrow by multiplying principle by savings or borrowing interest rates, if borrowing, we have to optimize among formal and informal choices. That is computationally trivial because it's a static choice unrelated to the dynamic problem. The slightly more complicated thing is that we also have to consider percentages of b' that has to go to bridge loans due to negative cash-on-hand in period t. That makes the reachable cash-on-hand grid significantly larger than the grid in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a>, we have to expand the grid by another percentage dimension--percentages of b' going to bridge--for negative levels of w=k'+b' overall choice.</li></ul></div><h2 id="3">Default</h2><p>Results identical to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html">ffs_ipwkbz_get_funcgrid</a> is obtained by running default with: st_param_which = 'ffs_ipwkbz_get_funcgrid';</p><h2 id="4">Default</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))

    <span class="comment">% override when called from outside</span>
    [param_map, support_map] = varargin{:};

<span class="keyword">else</span>
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = true;

    st_param_which = <span class="string">'small'</span>;

    <span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>]))

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 25;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 45;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

        <span class="comment">% Note it_coh_bridge_perc is percentage NOT for BRIDGE</span>
        <span class="keyword">if</span> (strcmp(st_param_which, <span class="string">'default'</span>))

            param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

            <span class="comment">% Adjust interest rates</span>
            param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;
            param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'ffs_ipwkbz_get_funcgrid'</span>))


            param_map(<span class="string">'fl_r_inf'</span>) = 0.025;
            param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.025;
            param_map(<span class="string">'bl_bridge'</span>) = false;
            <span class="comment">% when bl_bridge = false, it_coh_bridge_perc_n = 1</span>

        <span class="keyword">end</span>

    <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'small'</span>))

        param_map(<span class="string">'bl_bridge'</span>) = true;

        <span class="comment">% Adjust interest rates</span>
        param_map(<span class="string">'fl_r_inf'</span>) = 0.30;
        param_map(<span class="string">'fl_r_inf_bridge'</span>) = 0.30;

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = false; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 7;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 7;
        param_map(<span class="string">'it_coh_bridge_perc_n'</span>) = 3;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

    <span class="keyword">end</span>


    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display Parameters Specific to IPWKBZ_FIBS
it_coh_bridge_perc_n ADDED ON NEXT
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 12
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_rollover ; val = true
pos = 5 ; key = fl_forbrblk_brleast ; val = -1
pos = 6 ; key = fl_forbrblk_brmost ; val = -19
pos = 7 ; key = fl_forbrblk_gap ; val = -1.5
pos = 8 ; key = fl_r_fbr ; val = 0.065
pos = 9 ; key = fl_r_fsv ; val = 0.025
pos = 10 ; key = fl_r_inf ; val = 0.095
pos = 11 ; key = st_forbrblk_type ; val = seg3
pos = 12 ; key = st_model ; val = ipwkbz_fibs
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                           i     idx    value
                           __    ___    _____

    bl_b_is_principle       1     1       1  
    bl_bridge               2     2       1  
    bl_default              3     3       1  
    bl_rollover             4     4       1  
    fl_forbrblk_brleast     5     5       1  
    fl_forbrblk_brmost      6     6       1  
    fl_forbrblk_gap         7     7       1  
    fl_r_fbr                8     8       1  
    fl_r_fsv                9     9       1  
    fl_r_inf               10    10       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                        i    idx
                        _    ___

    st_forbrblk_type    1    11 
    st_model            2    12 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display_funcgrids ; val = false
pos = 2 ; key = bl_display_minccost ; val = false
pos = 3 ; key = bl_graph_funcgrids ; val = false
pos = 4 ; key = bl_graph_funcgrids_detail ; val = false
pos = 5 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/img/
pos = 6 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/mat/
pos = 7 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 8 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/profile/
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                 i    idx    value
                                 _    ___    _____

    bl_display_funcgrids         1     1       0  
    bl_display_minccost          2     2       0  
    bl_graph_funcgrids           3     3       0  
    bl_graph_funcgrids_detail    4     4       0  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                           i    idx
                           _    ___

    st_img_path            1     5 
    st_mat_path            2     6 
    st_matimg_path_root    3     7 
    st_profile_path        4     8 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display All Parameters with IPWKBZR overriding IPWKBZR
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 43
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_rollover ; val = true
pos = 5 ; key = fl_Amean ; val = 1
pos = 6 ; key = fl_alpha ; val = 0.36
pos = 7 ; key = fl_b_bd ; val = -20
pos = 8 ; key = fl_beta ; val = 0.94
pos = 9 ; key = fl_c_min ; val = 0.02
pos = 10 ; key = fl_coh_interp_grid_gap ; val = 0.1
pos = 11 ; key = fl_crra ; val = 1.5
pos = 12 ; key = fl_default_wprime ; val = 0
pos = 13 ; key = fl_delta ; val = 0.08
pos = 14 ; key = fl_forbrblk_brleast ; val = -1
pos = 15 ; key = fl_forbrblk_brmost ; val = -19
pos = 16 ; key = fl_forbrblk_gap ; val = -1.5
pos = 17 ; key = fl_k_max ; val = 70
pos = 18 ; key = fl_k_min ; val = 0
pos = 19 ; key = fl_nan_replace ; val = -9999
pos = 20 ; key = fl_r_fbr ; val = 0.065
pos = 21 ; key = fl_r_fsv ; val = 0.025
pos = 22 ; key = fl_r_inf ; val = 0.095
pos = 23 ; key = fl_tol_dist ; val = 1e-05
pos = 24 ; key = fl_tol_pol ; val = 1e-05
pos = 25 ; key = fl_tol_val ; val = 1e-05
pos = 26 ; key = fl_w ; val = 0.44365
pos = 27 ; key = fl_w_interp_grid_gap ; val = 0.1
pos = 28 ; key = fl_w_max ; val = 50
pos = 29 ; key = fl_w_min ; val = -20
pos = 30 ; key = fl_z_mu ; val = 0
pos = 31 ; key = fl_z_rho ; val = 0.8
pos = 32 ; key = fl_z_sig ; val = 0.2
pos = 33 ; key = it_ak_perc_n ; val = 50
pos = 34 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 35 ; key = it_coh_bridge_perc_n ; val = 50
pos = 36 ; key = it_maxiter_dist ; val = 1000
pos = 37 ; key = it_maxiter_val ; val = 250
pos = 38 ; key = it_tol_pol_nochange ; val = 25
pos = 39 ; key = it_w_perc_n ; val = 50
pos = 40 ; key = it_z_n ; val = 15
pos = 41 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 42 ; key = st_forbrblk_type ; val = seg3
pos = 43 ; key = st_model ; val = ipwkbz_fibs
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx    value
                              __    ___    _____

    bl_b_is_principle          1     1       1  
    bl_bridge                  2     2       1  
    bl_default                 3     3       1  
    bl_rollover                4     4       1  
    fl_Amean                   5     5       1  
    fl_alpha                   6     6       1  
    fl_b_bd                    7     7       1  
    fl_beta                    8     8       1  
    fl_c_min                   9     9       1  
    fl_coh_interp_grid_gap    10    10       1  
    fl_crra                   11    11       1  
    fl_default_wprime         12    12       0  
    fl_delta                  13    13       1  
    fl_forbrblk_brleast       14    14       1  
    fl_forbrblk_brmost        15    15       1  
    fl_forbrblk_gap           16    16       1  
    fl_k_max                  17    17       1  
    fl_k_min                  18    18       0  
    fl_nan_replace            19    19       1  
    fl_r_fbr                  20    20       1  
    fl_r_fsv                  21    21       1  
    fl_r_inf                  22    22       1  
    fl_tol_dist               23    23       1  
    fl_tol_pol                24    24       1  
    fl_tol_val                25    25       1  
    fl_w                      26    26       1  
    fl_w_interp_grid_gap      27    27       1  
    fl_w_max                  28    28       1  
    fl_w_min                  29    29       1  
    fl_z_mu                   30    30       0  
    fl_z_rho                  31    31       1  
    fl_z_sig                  32    32       1  
    it_ak_perc_n              33    33       1  
    it_c_interp_grid_gap      34    34       1  
    it_coh_bridge_perc_n      35    35       1  
    it_maxiter_dist           36    36       1  
    it_maxiter_val            37    37       1  
    it_tol_pol_nochange       38    38       1  
    it_w_perc_n               39    39       1  
    it_z_n                    40    40       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    41 
    st_forbrblk_type                 2    42 
    st_model                         3    43 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 43
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = true
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = false
pos = 9 ; key = bl_display_minccost ; val = false
pos = 10 ; key = bl_graph ; val = true
pos = 11 ; key = bl_graph_coh_t_coh ; val = true
pos = 12 ; key = bl_graph_evf ; val = false
pos = 13 ; key = bl_graph_funcgrids ; val = false
pos = 14 ; key = bl_graph_funcgrids_detail ; val = false
pos = 15 ; key = bl_graph_onebyones ; val = true
pos = 16 ; key = bl_graph_pol_lvl ; val = true
pos = 17 ; key = bl_graph_pol_pct ; val = true
pos = 18 ; key = bl_graph_val ; val = true
pos = 19 ; key = bl_img_save ; val = false
pos = 20 ; key = bl_mat ; val = false
pos = 21 ; key = bl_post ; val = true
pos = 22 ; key = bl_profile ; val = false
pos = 23 ; key = bl_profile_dist ; val = false
pos = 24 ; key = bl_time ; val = false
pos = 25 ; key = it_display_every ; val = 5
pos = 26 ; key = it_display_final_colmax ; val = 12
pos = 27 ; key = it_display_final_rowmax ; val = 100
pos = 28 ; key = it_display_summmat_colmax ; val = 5
pos = 29 ; key = it_display_summmat_rowmax ; val = 5
pos = 30 ; key = st_img_name_main ; val = _default
pos = 31 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/img/
pos = 32 ; key = st_img_prefix ; val = 
pos = 33 ; key = st_img_suffix ; val = _p4.png
pos = 34 ; key = st_mat_name_main ; val = _default
pos = 35 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/mat/
pos = 36 ; key = st_mat_prefix ; val = 
pos = 37 ; key = st_mat_suffix ; val = _p4
pos = 38 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 39 ; key = st_profile_name_main ; val = _default
pos = 40 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_ipwkbz_solve/profile/
pos = 41 ; key = st_profile_prefix ; val = 
pos = 42 ; key = st_profile_suffix ; val = _p4
pos = 43 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1       0  
    bl_display_defparam              2     2       1  
    bl_display_dist                  3     3       0  
    bl_display_evf                   4     4       0  
    bl_display_final                 5     5       1  
    bl_display_final_dist            6     6       0  
    bl_display_final_dist_detail     7     7       0  
    bl_display_funcgrids             8     8       0  
    bl_display_minccost              9     9       0  
    bl_graph                        10    10       1  
    bl_graph_coh_t_coh              11    11       1  
    bl_graph_evf                    12    12       0  
    bl_graph_funcgrids              13    13       0  
    bl_graph_funcgrids_detail       14    14       0  
    bl_graph_onebyones              15    15       1  
    bl_graph_pol_lvl                16    16       1  
    bl_graph_pol_pct                17    17       1  
    bl_graph_val                    18    18       1  
    bl_img_save                     19    19       0  
    bl_mat                          20    20       0  
    bl_post                         21    21       1  
    bl_profile                      22    22       0  
    bl_profile_dist                 23    23       0  
    bl_time                         24    24       0  
    it_display_every                25    25       1  
    it_display_final_colmax         26    26       1  
    it_display_final_rowmax         27    27       1  
    it_display_summmat_colmax       28    28       1  
    it_display_summmat_rowmax       29    29       1  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    30 
    st_img_path              2    31 
    st_img_prefix            3    32 
    st_img_suffix            4    33 
    st_mat_name_main         5    34 
    st_mat_path              6    35 
    st_mat_prefix            7    36 
    st_mat_suffix            8    37 
    st_matimg_path_root      9    38 
    st_profile_name_main    10    39 
    st_profile_path         11    40 
    st_profile_prefix       12    41 
    st_profile_suffix       13    42 
    st_title_prefix         14    43 

</pre><h2 id="5">Parse Parameters</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_z_mu'</span>, <span class="string">'fl_z_rho'</span>, <span class="string">'fl_z_sig'</span>});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>, <span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, <span class="keyword">...</span>
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_k_min'</span>, <span class="string">'fl_k_max'</span>, <span class="string">'it_ak_perc_n'</span>});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>, <span class="string">'it_c_interp_grid_gap'</span>});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_bridge'</span>, <span class="string">'it_coh_bridge_perc_n'</span>});
[bl_bridge, it_coh_bridge_perc_n] = params_group{:};

params_group = values(param_map, {<span class="string">'bl_b_is_principle'</span>, <span class="string">'fl_r_fbr'</span>, <span class="string">'fl_r_fsv'</span>, <span class="string">'fl_r_inf'</span>, <span class="string">'fl_w'</span>});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_r_inf, fl_w] = params_group{:};

params_group = values(param_map, {<span class="string">'st_forbrblk_type'</span>, <span class="string">'fl_forbrblk_brmost'</span>, <span class="string">'fl_forbrblk_brleast'</span>, <span class="string">'fl_forbrblk_gap'</span>});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

params_group = values(support_map, {<span class="string">'bl_display_minccost'</span>, <span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};

params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="6">G1: Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html">ffs_ipwkbz_fibs_set_default_param</a> for details.</p><p>@example</p><pre>  % For 2nd stage Grid
  ar_w_level = [-2,0,2]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>
</pre><h2 id="7">G2: Expand A and K Arrays further if bridge is allowed</h2><p>Crucially, when a fraction of overall borrowing/savings needs to go pay negative coh, that comes out of w, fraction of w = k' + b' that goes to this. NOT a fraction of the b' choice condition on w, which would change for the same w as w' changes. We are fixing bridge repay level for w.</p><p>@example</p><pre>  clear all
  % Same as above
  ar_w_level = [-2,-1,-0.1]
  fl_b_bd = -4
  ar_k_max = ar_w_level - fl_b_bd
  ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
  mt_k = (ar_k_max'*ar_ak_perc)'
  mt_a = (ar_w_level - mt_k)</pre><pre>  % fraction of borrowing for bridge loan
  ar_coh_bridge_perc = [0, 0.5, 0.999];</pre><pre>  % Expand matrix to include coh percentage dimension
  mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
  mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])</pre><pre>  % bridge loan component of borrowing
  ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
  ar_brdige_a = ar_brdige_a(:)'</pre><pre>  % borrowing choices excluding bridge loan
  mt_a_nobridge = mt_a - ar_brdige_a</pre><pre class="codeinput"><span class="comment">% 1. negative part of w</span>
ar_bl_w_neg = (ar_w_level &lt; 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

<span class="keyword">if</span> (bl_bridge)

    <span class="comment">% 1. select mt_k and mt_a where w_level &lt;= 0</span>
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    <span class="comment">% 2. fraction of borrowing NOT for bridge loan</span>
    <span class="comment">% 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge</span>
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    <span class="comment">% 3. Expand matrix to include coh percentage dimension</span>
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    <span class="comment">% 4. bridge loan component of borrowing</span>
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    <span class="comment">% 5. borrowing choices excluding bridge loan</span>
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    <span class="comment">% 6. Matrix combine, negative than positive</span>
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    <span class="comment">% 7. Expand Bridge Choices to have the same size as mt_a</span>
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    <span class="comment">% 8. Overall borrowing and savings choices</span>
    mt_a = mt_a_nobridge + mt_bridge_a;

    <span class="comment">% 9. Update w</span>
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    <span class="comment">% 10. Pre-generate Interpolation matrix for negative w levels</span>
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">else</span>

    <span class="comment">% If bridge loans are not needed, do not need to do expansions</span>
    <span class="comment">% All zeros, no bridge</span>
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = <span class="keyword">...</span>
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

<span class="keyword">end</span>
</pre><h2 id="8">G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.</h2><p>For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N number of rows. Where N is the percentage grid point for coh as well as k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos = numger of grid points for ar_w_level</p><div><ol><li><b>mt_a</b> includes aggregate/total borrowing and savings levels. b &lt; 0 happens alot when w &gt;= 0. The mt_a_nobridge</li><li><b>mt_a_nobridge</b> includes all aggregate/total borrowing and savings whether w &gt; 0 or w &lt; 0, however, it subtracts away the borrowing that is for bridge loans when b &lt; 0</li><li><b>mt_bridge_a</b> is the bridge loan amount.</li></ol></div><pre class="codeinput">ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;
</pre><h2 id="9">F1: Get Shock Grids</h2><pre class="codeinput">[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);
</pre><h2 id="10">FIBS1: Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);
</pre><h2 id="11">FIBS2: Get Formal Borrowing Blocks</h2><pre class="codeinput">[ar_forbrblk, ar_forbrblk_r] = <span class="keyword">...</span>
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);
</pre><h2 id="12">Find Formal and Informal Choices for Borrowing points</h2><p>Here we solve for the optimal formal and informal choices given b. Note that kind of like the static firm's maximization problem. Here the optimization problem is static, and can be done independently of the overall dynamic optimization problem.</p><pre class="codeinput"><span class="comment">% When borrowing index and array</span>
<span class="comment">% note index for negative is from _ar_a_meshk_full_, but value from</span>
<span class="comment">% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some</span>
<span class="comment">% of these points _ar_a_nobridge_meshk_ = 0. But need to use</span>
<span class="comment">% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all</span>
<span class="comment">% borrowing.</span>
ar_bl_ameshk_neg_idx = (ar_a_meshk_full &lt; 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

<span class="comment">% Given b, solve for optimal formal and informal choices.</span>
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = <span class="keyword">...</span>
   ffs_fibs_min_c_cost(bl_b_is_principle, fl_r_inf, fl_r_fsv, <span class="keyword">...</span>
                         ar_forbrblk_r, ar_forbrblk, <span class="keyword">...</span>
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);
</pre><h2 id="13">FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative</h2><p><b>ar_coh_fbis_aneg</b>: the consumption cost to t+1 from borrowing in t given formal and informal joint choice optimization.</p><p>Reachable cash-on-hand borrowing points: N_neg*N^2 rows</p><p>Additionally, need to convert borrowing choices to consumption units next period. borrowing choices in percentage are in unit of last period borrowing, principles only, need to convert to interest rates plus principle which means considering which formal informal choice combination maximizes cash-on-hand for the same level of overall principles.</p><p>Construct another percentage, which is, percentages of ar_a_meshk_full when w &lt; 0. Percentage represents what fraction of the a debt is going towards bridge loan debts. Note that as long as w &lt; 0, b &lt; 0 must be the case as well. So for negative elements of w, there is a triple mesh: N points for A x N points for K x N points for Bridge.</p><pre class="codeinput">ar_coh_fbis_aneg = f_coh_fbis(fl_r_inf, <span class="keyword">...</span>
                                ar_for_borr_aneg, <span class="keyword">...</span>
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), <span class="keyword">...</span>
                                ar_for_save_aneg);
</pre><h2 id="14">FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive</h2><p><b>ar_coh_save_apos</b>: the consumption gain to t+1 from savings in t</p><pre class="codeinput">ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);
</pre><h2 id="15">COH1: Combine overall Reachable Cash-on-Hand Levels</h2><p>N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count. These are the cash-on-hand points reachable given percentage grid choice structure and the possibility of bridge loans.</p><pre class="codeinput">ar_ameshk_tnext_with_r = zeros(size(ar_k_mesha));
ar_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx) = ar_coh_fbis_aneg;
ar_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx) = ar_coh_save_apos;

mt_coh_wkb_full = f_coh(ar_z, ar_ameshk_tnext_with_r, ar_k_mesha);

<span class="keyword">if</span> (bl_display_funcgrids)

    <span class="comment">% Generate Aggregate Variables</span>
    ar_aplusk_mesha = ar_a_meshk + ar_k_mesha;
    ar_bwithrplusk_mesha = ar_ameshk_tnext_with_r + ar_k_mesha;

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([ar_bwithrplusk_mesha, ar_aplusk_mesha, <span class="keyword">...</span>
        ar_k_mesha, ar_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = {<span class="string">'ar_bwithrplusk_mesha'</span>, <span class="string">'ar_aplusk_mesha'</span>, <span class="keyword">...</span>
        <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_ameshk_tnext_with_r'</span>, <span class="string">'ar_a_meshk'</span>, <span class="string">'ar_a_nobridge_meshk'</span>, <span class="string">'ar_bridge_a'</span>};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bwithrplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bwithrplusk_mesha*: '</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_ameshk_tnext_with_r'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_ameshk_tnext_with_r*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_nobridge_meshk'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aprime_nobridge*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_bridge_a'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_bridge_a*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'tab_ak_choices'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_bwithrplusk_mesha*:
*ar_aplusk_mesha*:
*ar_k_mesha*:
*ar_ameshk_tnext_with_r*:
*ar_a_meshk*:
*ar_aprime_nobridge*:
*ar_bridge_a*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
tab_ak_choices
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   385     7

      tab_ak_choices1       tab_ak_choices2    tab_ak_choices3       tab_ak_choices4        tab_ak_choices5      tab_ak_choices6      tab_ak_choices7
    ar_bwithrplusk_mesha    ar_aplusk_mesha      ar_k_mesha       ar_ameshk_tnext_with_r      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a  
    ____________________    _______________    _______________    ______________________    _______________    ___________________    _______________

              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
              -26                   -20                  0                   -26                    -20                     0                 -20    
          -23.243               -17.879          0.0021212               -23.245                -17.881            -0.0021212             -17.879    
          -23.291               -17.879            0.35495               -23.646                -18.234              -0.35495             -17.879    
            -23.3               -17.879            0.70778               -24.008                -18.587              -0.70778             -17.879    
          -23.326               -17.879             1.0606               -24.386                -18.939               -1.0606             -17.879    
          -23.378               -17.879             1.4134               -24.791                -19.292               -1.4134             -17.879    
          -23.387               -17.879             1.7663               -25.153                -19.645               -1.7663             -17.879    
          -23.395               -17.879             2.1191               -25.514                -19.998               -2.1191             -17.879    
          -20.486               -15.758          0.0042424                -20.49                -15.762            -0.0042424             -15.758    
          -20.543               -15.758             0.7099               -21.252                -16.467               -0.7099             -15.758    
           -20.62               -15.758             1.4156               -22.036                -17.173               -1.4156             -15.758    
          -20.638               -15.758             2.1212               -22.759                -17.879               -2.1212             -15.758    
          -20.716               -15.758             2.8269               -23.542                -18.584               -2.8269             -15.758    
          -20.733               -15.758             3.5325               -24.266                 -19.29               -3.5325             -15.758    
          -20.811               -15.758             4.2382               -25.049                -19.996               -4.2382             -15.758    
          -17.729               -13.636          0.0063636               -17.736                -13.643            -0.0063636             -13.636    
          -17.812               -13.636             1.0648               -18.877                -14.701               -1.0648             -13.636    
           -17.88               -13.636             2.1233               -20.004                 -15.76               -2.1233             -13.636    
          -17.967               -13.636             3.1818               -21.149                -16.818               -3.1818             -13.636    
          -18.053               -13.636             4.2403               -22.294                -17.877               -4.2403             -13.636    
           -18.08               -13.636             5.2988               -23.379                -18.935               -5.2988             -13.636    
          -18.166               -13.636             6.3573               -24.523                -19.994               -6.3573             -13.636    
          -14.972               -11.515          0.0084848               -14.981                -11.524            -0.0084848             -11.515    
          -15.105               -11.515             1.4198               -16.525                -12.935               -1.4198             -11.515    
            -15.2               -11.515             2.8311               -18.032                -14.346               -2.8311             -11.515    
          -15.296               -11.515             4.2424               -19.538                -15.758               -4.2424             -11.515    
          -15.373               -11.515             5.6537               -21.027                -17.169               -5.6537             -11.515    
          -15.444               -11.515             7.0651               -22.509                 -18.58               -7.0651             -11.515    
          -15.582               -11.515             8.4764               -24.058                -19.992               -8.4764             -11.515    
          -12.215               -9.3939           0.010606               -12.226                -9.4045             -0.010606             -9.3939    
          -12.356               -9.3939             1.7747               -14.131                -11.169               -1.7747             -9.3939    
          -12.461               -9.3939             3.5389               -15.999                -12.933               -3.5389             -9.3939    
          -12.565               -9.3939              5.303               -17.868                -14.697                -5.303             -9.3939    
          -12.687               -9.3939             7.0672               -19.754                -16.461               -7.0672             -9.3939    
          -12.833               -9.3939             8.8313               -21.664                -18.225               -8.8313             -9.3939    
          -13.041               -9.3939             10.595               -23.636                -19.989               -10.595             -9.3939    
          -9.4584               -7.2727           0.012727               -9.4711                -7.2855             -0.012727             -7.2727    
          -9.6078               -7.2727             2.1297               -11.737                -9.4024               -2.1297             -7.2727    
          -9.7807               -7.2727             4.2467               -14.027                -11.519               -4.2467             -7.2727    
          -9.8936               -7.2727             6.3636               -16.257                -13.636               -6.3636             -7.2727    
          -10.067               -7.2727             8.4806               -18.547                -15.753               -8.4806             -7.2727    
          -10.284               -7.2727             10.598               -20.881                 -17.87               -10.598             -7.2727    
          -10.352               -7.2727             12.715               -23.067                -19.987               -12.715             -7.2727    
          -6.7014               -5.1515           0.014848               -6.7163                -5.1664             -0.014848             -5.1515    
          -6.8591               -5.1515             2.4846               -9.3437                -7.6362               -2.4846             -5.1515    
          -7.0408               -5.1515             4.9544               -11.995                -10.106               -4.9544             -5.1515    
          -7.2792               -5.1515             7.4242               -14.703                -12.576               -7.4242             -5.1515    
          -7.3443               -5.1515              9.894               -17.238                -15.046                -9.894             -5.1515    
          -7.5861               -5.1515             12.364                -19.95                -17.515               -12.364             -5.1515    
          -7.7396               -5.1515             14.834               -22.573                -19.985               -14.834             -5.1515    
          -3.9445               -3.0303            0.01697               -3.9615                -3.0473              -0.01697             -3.0303    
          -4.1704               -3.0303             2.8396                 -7.01                -5.8699               -2.8396             -3.0303    
          -4.3456               -3.0303             5.6622               -10.008                -8.6925               -5.6622             -3.0303    
          -4.5515               -3.0303             8.4848               -13.036                -11.515               -8.4848             -3.0303    
          -4.8021               -3.0303             11.307                -16.11                -14.338               -11.307             -3.0303    
          -4.8726               -3.0303              14.13               -19.003                 -17.16                -14.13             -3.0303    
          -5.1232               -3.0303             16.953               -22.076                -19.983               -16.953             -3.0303    
          -1.1875              -0.90909           0.019091               -1.2066               -0.92818             -0.019091            -0.90909    
          -1.4217              -0.90909             3.1945               -4.6162                -4.1036               -3.1945            -0.90909    
          -1.6211              -0.90909               6.37               -7.9911                -7.2791                 -6.37            -0.90909    
          -1.8205              -0.90909             9.5455               -11.366                -10.455               -9.5455            -0.90909    
          -2.0798              -0.90909             12.721               -14.801                 -13.63               -12.721            -0.90909    
          -2.3392              -0.90909             15.896               -18.236                -16.805               -15.896            -0.90909    
          -2.4384              -0.90909             19.072                -21.51                -19.981               -19.072            -0.90909    

      tab_ak_choices1       tab_ak_choices2    tab_ak_choices3       tab_ak_choices4        tab_ak_choices5      tab_ak_choices6      tab_ak_choices7
    ar_bwithrplusk_mesha    ar_aplusk_mesha      ar_k_mesha       ar_ameshk_tnext_with_r      ar_a_meshk       ar_a_nobridge_meshk      ar_bridge_a  
    ____________________    _______________    _______________    ______________________    _______________    ___________________    _______________

           31.681               30.909            0.050909                  31.63                30.858               30.858                 0       
           31.469               30.909              8.5188                  22.95                 22.39                22.39                 0       
           31.257               30.909              16.987                  14.27                13.922               13.922                 0       
           31.045               30.909              25.455                 5.5909                5.4545               5.4545                 0       
           30.674               30.909              33.922                -3.2487               -3.0133              -3.0133                 0       
           30.042               30.909               42.39                -12.348               -11.481              -11.481                 0       
           29.389               30.909              50.858                -21.469               -19.949              -19.949                 0       
           33.855                33.03             0.05303                 33.802                32.977               32.977                 0       
           33.634                33.03              8.8737                  24.76                24.157               24.157                 0       
           33.414                33.03              17.694                 15.719                15.336               15.336                 0       
           33.193                33.03              26.515                  6.678                6.5152               6.5152                 0       
           32.873                33.03              35.336                -2.4632               -2.3056              -2.3056                 0       
           32.172                33.03              44.157                -11.984               -11.126              -11.126                 0       
           31.511                33.03              52.977                -21.466               -19.947              -19.947                 0       
           36.029               35.152            0.055152                 35.974                35.096               35.096                 0       
             35.8               35.152              9.2287                 26.571                25.923               25.923                 0       
            35.57               35.152              18.402                 17.168                16.749               16.749                 0       
           35.341               35.152              27.576                 7.7652                7.5758               7.5758                 0       
           35.012               35.152              36.749                -1.7377               -1.5978              -1.5978                 0       
           34.302               35.152              45.923                -11.621               -10.771              -10.771                 0       
           33.633               35.152              55.096                -21.463               -19.945              -19.945                 0       
           38.203               37.273            0.057273                 38.146                37.215               37.215                 0       
           37.965               37.273              9.5836                 28.381                27.689               27.689                 0       
           37.727               37.273               19.11                 18.617                18.163               18.163                 0       
           37.489               37.273              28.636                 8.8523                8.6364               8.6364                 0       
            37.21               37.273              38.163               -0.95225                 -0.89                -0.89                 0       
           36.498               37.273              47.689                -11.191               -10.416              -10.416                 0       
           35.755               37.273              57.215                -21.461               -19.943              -19.943                 0       
           40.377               39.394            0.059394                 40.318                39.335               39.335                 0       
            40.13               39.394              9.9386                 30.192                29.455               29.455                 0       
           39.883               39.394              19.818                 20.066                19.576               19.576                 0       
           39.636               39.394              29.697                 9.9394                 9.697                9.697                 0       
           39.349               39.394              39.576               -0.22678              -0.18222             -0.18222                 0       
           38.726               39.394              49.455                 -10.73               -10.061              -10.061                 0       
           37.877               39.394              59.335                -21.458               -19.941              -19.941                 0       
           42.551               41.515            0.061515                  42.49                41.454               41.454                 0       
           42.296               41.515              10.294                 32.002                31.222               31.222                 0       
            42.04               41.515              20.526                 21.514                 20.99                20.99                 0       
           41.784               41.515              30.758                 11.027                10.758               10.758                 0       
           41.528               41.515               40.99                0.53869               0.52556              0.52556                 0       
           40.872               41.515              51.222                -10.349               -9.7065              -9.7065                 0       
           39.999               41.515              61.454                -21.455               -19.938              -19.938                 0       
           44.726               43.636            0.063636                 44.662                43.573               43.573                 0       
           44.461               43.636              10.648                 33.813                32.988               32.988                 0       
           44.196               43.636              21.233                 22.963                22.403               22.403                 0       
           43.932               43.636              31.818                 12.114                11.818               11.818                 0       
           43.667               43.636              42.403                 1.2642                1.2333               1.2333                 0       
           43.003               43.636              52.988                -9.9853               -9.3515              -9.3515                 0       
            42.12               43.636              63.573                -21.452               -19.936              -19.936                 0       
             46.9               45.758            0.065758                 46.834                45.692               45.692                 0       
           46.626               45.758              11.003                 35.623                34.754               34.754                 0       
           46.353               45.758              21.941                 24.412                23.816               23.816                 0       
            46.08               45.758              32.879                 13.201                12.879               12.879                 0       
           45.806               45.758              43.816                 1.9896                1.9411               1.9411                 0       
           45.133               45.758              54.754                -9.6215               -8.9966              -8.9966                 0       
           44.242               45.758              65.692                 -21.45               -19.934              -19.934                 0       
           49.074               47.879            0.067879                 49.006                47.811               47.811                 0       
           48.792               47.879              11.358                 37.433                 36.52                36.52                 0       
            48.51               47.879              22.649                 25.861                 25.23                25.23                 0       
           48.227               47.879              33.939                 14.288                13.939               13.939                 0       
           47.945               47.879               45.23                 2.7151                2.6489               2.6489                 0       
           47.263               47.879               56.52                -9.2577               -8.6416              -8.6416                 0       
           46.364               47.879              67.811                -21.447               -19.932              -19.932                 0       
           51.248                   50                0.07                 51.178                 49.93                49.93                 0       
           50.957                   50              11.713                 39.244                38.287               38.287                 0       
           50.666                   50              23.357                 27.309                26.643               26.643                 0       
           50.375                   50                  35                 15.375                    15                   15                 0       
           50.084                   50              46.643                 3.4406                3.3567               3.3567                 0       
           49.393                   50              58.287                -8.8938               -8.2867              -8.2867                 0       
           48.486                   50               69.93                -21.444                -19.93               -19.93                 0       

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   385    15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556             -25.556              -25.556              -25.556              -25.556              -25.556              -25.556     
         -22.762             -22.756             -22.749             -22.741             -22.733             -22.722              -22.71             -22.697             -22.681             -22.663              -22.642              -22.617              -22.589              -22.557               -22.52     
         -22.637               -22.6             -22.558             -22.509             -22.452             -22.387             -22.312             -22.226             -22.126             -22.011              -21.878              -21.724              -21.547              -21.343              -21.108     
         -22.606             -22.559             -22.505             -22.442              -22.37             -22.286              -22.19             -22.079             -21.951             -21.803              -21.633              -21.436               -21.21              -20.948              -20.646     
         -22.612             -22.557             -22.495             -22.422             -22.338             -22.242             -22.131             -22.002             -21.854             -21.683              -21.486              -21.259              -20.996              -20.694              -20.345     
         -22.654             -22.593             -22.524             -22.443              -22.35             -22.243              -22.12             -21.978             -21.813             -21.624              -21.405              -21.153              -20.862              -20.527               -20.14     
         -22.658             -22.592             -22.517              -22.43             -22.329             -22.213              -22.08             -21.925             -21.747             -21.542              -21.305              -21.032              -20.717              -20.353              -19.934     
         -22.666             -22.596             -22.515             -22.422             -22.315             -22.191             -22.049             -21.884             -21.694             -21.475              -21.222               -20.93              -20.593              -20.205              -19.757     
         -19.994             -19.987             -19.978             -19.968             -19.957             -19.944             -19.928             -19.911              -19.89             -19.867               -19.84              -19.809              -19.773              -19.731              -19.684     
         -19.849             -19.801             -19.747             -19.684             -19.612             -19.528             -19.432             -19.321             -19.193             -19.045              -18.874              -18.678              -18.451              -18.189              -17.887     
         -19.896             -19.836             -19.766             -19.685             -19.593             -19.486             -19.362              -19.22             -19.055             -18.866              -18.647              -18.395              -18.104              -17.768              -17.381     
         -19.909             -19.839             -19.758             -19.665             -19.557             -19.434             -19.291             -19.126             -18.936             -18.717              -18.464              -18.172              -17.835              -17.447              -16.999     
         -19.993             -19.915             -19.826             -19.723             -19.604             -19.466             -19.308             -19.125             -18.914             -18.671              -18.391              -18.067              -17.694              -17.263              -16.766     
         -20.025             -19.941             -19.844             -19.732             -19.603             -19.454             -19.283             -19.085             -18.856             -18.593              -18.289              -17.938              -17.534              -17.067              -16.529     
         -20.122             -20.032             -19.929             -19.809             -19.672             -19.513             -19.329             -19.118             -18.874             -18.593              -18.268              -17.894              -17.462              -16.964              -16.389     
          -17.23             -17.221             -17.211               -17.2             -17.186             -17.171             -17.153             -17.133              -17.11             -17.083              -17.051              -17.015              -16.974              -16.926               -16.87     
         -17.098             -17.043              -16.98             -16.908             -16.824             -16.727             -16.616             -16.487             -16.339             -16.168               -15.97              -15.743               -15.48              -15.177              -14.828     
         -17.151             -17.081                 -17             -16.907               -16.8             -16.676             -16.533             -16.368             -16.178             -15.959              -15.706              -15.414              -15.077              -14.688               -14.24     
         -17.251              -17.17             -17.076             -16.969             -16.845             -16.701             -16.536             -16.345             -16.125             -15.871              -15.579              -15.241              -14.851              -14.402              -13.884     
         -17.364             -17.275             -17.171             -17.052             -16.914             -16.755             -16.572              -16.36             -16.116             -15.835               -15.51              -15.136              -14.704              -14.206              -13.631     
         -17.427              -17.33             -17.217             -17.088             -16.939             -16.767             -16.568             -16.339             -16.074              -15.77              -15.418              -15.012              -14.544              -14.004              -13.381     
         -17.555             -17.451             -17.331             -17.193             -17.034              -16.85             -16.638             -16.393             -16.111             -15.785               -15.41              -14.977              -14.477                -13.9              -13.235     
         -14.467             -14.457             -14.446             -14.433             -14.419             -14.402             -14.382              -14.36             -14.334             -14.304              -14.269              -14.229              -14.183               -14.13              -14.068     
         -14.381              -14.32             -14.251              -14.17             -14.077              -13.97             -13.846             -13.704             -13.539             -13.349              -13.131              -12.878              -12.587              -12.251              -11.863     
         -14.478               -14.4             -14.311             -14.208             -14.089             -13.951             -13.793              -13.61             -13.399             -13.156              -12.875              -12.551              -12.178              -11.747               -11.25     
         -14.607             -14.517             -14.414             -14.294             -14.156             -13.998             -13.814             -13.603             -13.359             -13.077              -12.753              -12.378              -11.946              -11.448              -10.873     
         -14.734             -14.634             -14.519             -14.387             -14.234             -14.058             -13.855              -13.62              -13.35             -13.037              -12.677              -12.262              -11.783               -11.23              -10.593     
         -14.863             -14.756             -14.631             -14.488             -14.322             -14.131             -13.911             -13.657             -13.364             -13.025              -12.635              -12.185              -11.666              -11.067              -10.376     
         -15.066             -14.951             -14.818             -14.665             -14.488             -14.284             -14.049             -13.778             -13.465             -13.104              -12.687              -12.206              -11.652              -11.013              -10.275     
         -11.705             -11.695             -11.683             -11.669             -11.653             -11.634             -11.613             -11.589              -11.56             -11.528               -11.49              -11.447              -11.397              -11.339              -11.273     
         -11.628             -11.562             -11.486             -11.399             -11.299             -11.182             -11.048             -10.894             -10.716              -10.51              -10.273               -9.999              -9.6833              -9.3191              -8.8989     
         -11.752             -11.668             -11.571              -11.46              -11.33             -11.182              -11.01             -10.812             -10.583             -10.319              -10.015              -9.6644              -9.2596              -8.7927              -8.2541     
         -11.912             -11.815             -11.702             -11.573             -11.424             -11.251             -11.053             -10.824             -10.559             -10.254              -9.9023              -9.4965              -9.0283              -8.4882              -7.8651     
         -12.107             -11.999             -11.874             -11.731             -11.565             -11.374             -11.154               -10.9             -10.607             -10.268              -9.8782              -9.4281              -8.9089                -8.31              -7.6191     
         -12.335             -12.218             -12.083             -11.928             -11.748             -11.541             -11.302             -11.027             -10.709             -10.343              -9.9201              -9.4325              -8.8699               -8.221              -7.4724     
         -12.632             -12.507             -12.363             -12.197             -12.006             -11.785              -11.53             -11.236             -10.897             -10.505              -10.054              -9.5332              -8.9325              -8.2396              -7.4403     
         -8.9435             -8.9324             -8.9197             -8.9049             -8.8879             -8.8682             -8.8456             -8.8195             -8.7893             -8.7546              -8.7145              -8.6682              -8.6148              -8.5533              -8.4822     
         -8.8784             -8.8084             -8.7276             -8.6344             -8.5269             -8.4029             -8.2598             -8.0948             -7.9044             -7.6848              -7.4314              -7.1392              -6.8021              -6.4132              -5.9646     
         -9.0921             -9.0023             -8.8987             -8.7792             -8.6414             -8.4824              -8.299             -8.0874             -7.8433             -7.5618               -7.237              -6.8623              -6.4301              -5.9315              -5.3564     
         -9.2827             -9.1789              -9.059             -8.9208             -8.7614             -8.5775             -8.3653             -8.1206             -7.8382             -7.5125              -7.1368              -6.7034              -6.2035              -5.6267              -4.9614     
         -9.5513             -9.4362             -9.3033               -9.15             -8.9732             -8.7693              -8.534             -8.2626             -7.9495             -7.5883              -7.1717              -6.6911              -6.1367              -5.4972              -4.7594     
         -9.8753             -9.7505             -9.6065             -9.4405             -9.2489             -9.0279              -8.773             -8.4789             -8.1397             -7.7483              -7.2969              -6.7762              -6.1754              -5.4825              -4.6831     
         -10.058             -9.9249             -9.7712             -9.5939             -9.3893             -9.1534             -8.8812             -8.5672             -8.2049             -7.7871              -7.3051               -6.749              -6.1076              -5.3677              -4.5141     
         -6.1826             -6.1709             -6.1574             -6.1418             -6.1238             -6.1031             -6.0791             -6.0515             -6.0196             -5.9829              -5.9405              -5.8916              -5.8352              -5.7701               -5.695     
         -6.1321             -6.0581             -5.9727             -5.8742             -5.7605             -5.6294             -5.4782             -5.3037             -5.1025             -4.8703              -4.6025              -4.2936              -3.9373              -3.5262              -3.0519     
         -6.3755             -6.2806             -6.1711             -6.0448             -5.8991              -5.731             -5.5371             -5.3134             -5.0554             -4.7578              -4.4145              -4.0184              -3.5616              -3.0345              -2.4266     
         -6.7146             -6.6048             -6.4781              -6.332             -6.1635             -5.9691             -5.7448             -5.4861             -5.1877             -4.8434              -4.4462              -3.9881              -3.4596                -2.85              -2.1467     
         -6.8994             -6.7776             -6.6372             -6.4752             -6.2883             -6.0727              -5.824             -5.5371             -5.2061             -4.8244               -4.384              -3.8759              -3.2899              -2.6138               -1.834     
         -7.2725             -7.1406             -6.9884             -6.8128             -6.6103             -6.3767             -6.1073             -5.7964             -5.4378             -5.0241               -4.547              -3.9965              -3.3615               -2.629               -1.784     
         -7.5653             -7.4245              -7.262             -7.0746             -6.8583             -6.6089             -6.3212             -5.9892             -5.6064             -5.1647              -4.6551              -4.0674              -3.3893              -2.6072              -1.7049     
         -3.4221             -3.4098             -3.3956             -3.3793             -3.3604             -3.3386             -3.3135             -3.2845             -3.2511             -3.2125               -3.168              -3.1167              -3.0575              -2.9892              -2.9105     
         -3.4481             -3.3704             -3.2808             -3.1774             -3.0582             -2.9206             -2.7619             -2.5789             -2.3677             -2.1242              -1.8432               -1.519              -1.1451             -0.71379             -0.21622     
         -3.7064             -3.6068             -3.4919             -3.3594             -3.2065             -3.0302             -2.8267             -2.5921             -2.3213             -2.0091              -1.6488              -1.2333              -0.7539             -0.20092              0.43699     
         -4.0365             -3.9213             -3.7884             -3.6351             -3.4583             -3.2543              -3.019             -2.7475             -2.4344             -2.0731              -1.6564              -1.1758             -0.62124              0.01842              0.75631     
         -4.4312             -4.3034             -4.1561             -3.9861               -3.79             -3.5638             -3.3028             -3.0018             -2.6545              -2.254              -1.7919              -1.2588             -0.64393             0.065407              0.88367     
         -4.6581             -4.5196               -4.36             -4.1758             -3.9633             -3.7182             -3.4354             -3.1093              -2.733              -2.299              -1.7983              -1.2207             -0.55447              0.21411               1.1007     
         -5.0734             -4.9256             -4.7551             -4.5584             -4.3315             -4.0698             -3.7679             -3.4196             -3.0179             -2.5544              -2.0198              -1.4031             -0.69171              0.12895               1.0756     
        -0.66188            -0.64905            -0.63425            -0.61717            -0.59748            -0.57476            -0.54855            -0.51832            -0.48344            -0.44321              -0.3968             -0.34326              -0.2815             -0.21026             -0.12808     
        -0.70585             -0.6248            -0.53131            -0.42347            -0.29906            -0.15555            0.010004             0.20098             0.42128             0.67541              0.96856               1.3067               1.6968               2.1469                2.666     
         -1.0104            -0.90652            -0.78666             -0.6484             -0.4889            -0.30491           -0.092669             0.15217              0.4346             0.76041               1.1362               1.5698               2.0699               2.6469               3.3124     
         -1.3578             -1.2376              -1.099            -0.93902            -0.75453             -0.5417            -0.29619           -0.012977             0.31373              0.6906               1.1254               1.6269               2.2054               2.8728               3.6426     
          -1.786             -1.6527             -1.4989             -1.3216              -1.117            -0.88099            -0.60874            -0.29468             0.06761             0.48553              0.96764               1.5238               2.1653               2.9054               3.7591     
         -2.2269             -2.0825             -1.9159             -1.7237              -1.502             -1.2463            -0.95133            -0.61104            -0.21849             0.23434              0.75671               1.3593               2.0544               2.8563               3.7813     
         -2.5163             -2.3622             -2.1843             -1.9791             -1.7424             -1.4693             -1.1544              -0.791            -0.37185             0.11167              0.66943               1.3129               2.0551               2.9113                3.899     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         32.239              32.257              32.278              32.303              32.331              32.363                32.4              32.443              32.493               32.55               32.616               32.693                32.78               32.882               32.999      
         31.982              32.098              32.231              32.384              32.561              32.766              33.001              33.273              33.587              33.948               34.366               34.847               35.402               36.043               36.782      
         31.305              31.453              31.624               31.82              32.047              32.309              32.611               32.96              33.362              33.826               34.361               34.978                35.69               36.511               37.458      
         30.567              30.738              30.935              31.163              31.426              31.729              32.078              32.481              32.946              33.483               34.102               34.815               35.639               36.589               37.685      
         29.639              29.829              30.048                30.3              30.591              30.927              31.315              31.762              32.278              32.872               33.559                34.35               35.264               36.317               37.532      
         28.433              28.639              28.876              29.149              29.465              29.829              30.249              30.733              31.292              31.937                32.68               33.538               34.527               35.669               36.986      
         27.194              27.413              27.666              27.958              28.295              28.684              29.132               29.65              30.246              30.935               31.729               32.644               33.701                34.92               36.326      
         34.415              34.433              34.455              34.479              34.508              34.541              34.579              34.622              34.673              34.731               34.798               34.875               34.964               35.067               35.186      
          34.13              34.247              34.382              34.538              34.718              34.925              35.164               35.44              35.759              36.126               36.549               37.038               37.601               38.251               39.001      
         33.419              33.569              33.742              33.942              34.173              34.438              34.745              35.099              35.507              35.977                36.52               37.146               37.869               38.702               39.664      
         32.646               32.82               33.02              33.251              33.518              33.825               34.18              34.589              35.061              35.605               36.233               36.958               37.793               38.757               39.869      
         31.743              31.936              32.158              32.414               32.71               33.05              33.444              33.897              34.421              35.024               35.721               36.524               37.451                38.52               39.753      
         30.442               30.65              30.891              31.169              31.489              31.858              32.284              32.776              33.343              33.997               34.752               35.622               36.626               37.785               39.121      
         29.167               29.39              29.647              29.943              30.285               30.68              31.135               31.66              32.265              32.963               33.769               34.699               35.771               37.008               38.434      
         36.591              36.609              36.631              36.656              36.685              36.718              36.757              36.801              36.852              36.911               36.979               37.057               37.148               37.252               37.373      
         36.278              36.397              36.534              36.692              36.874              37.084              37.327              37.607              37.929              38.302               38.731               39.227               39.798               40.458               41.218      
         35.533              35.685              35.861              36.063              36.297              36.567              36.878              37.236               37.65              38.127               38.678               39.313               40.046               40.891               41.866      
         34.725              34.901              35.104              35.339              35.609              35.921               36.28              36.695              37.174              37.726               38.363               39.098               39.946               40.923               42.051      
         33.787              33.982              34.207              34.467              34.767              35.113              35.512              35.972              36.502              37.115               37.821               38.636               39.576                40.66               41.911      
          32.45              32.661              32.905              33.187              33.512              33.886              34.319              34.817              35.392              36.056               36.821               37.704               38.722               39.897               41.252      
          31.14              31.366              31.627              31.927              32.274              32.674              33.136              33.668              34.282               34.99               35.808                36.75               37.838               39.092               40.539      
         38.766              38.785              38.807              38.833              38.862              38.896              38.935              38.979              39.031              39.091                39.16               39.239               39.331               39.437               39.559      
         38.426              38.546              38.685              38.845               39.03              39.243              39.489              39.772                40.1              40.477               40.912               41.415               41.994               42.662               43.433      
         37.646              37.801              37.979              38.184              38.421              38.694              39.009              39.373              39.793              40.276               40.835               41.478               42.221               43.078               44.066      
         36.804              36.982              37.188              37.426                37.7              38.016               38.38              38.801              39.286              39.846               40.491               41.236               42.095               43.087                44.23      
          35.89              36.088              36.316               36.58              36.884              37.234              37.638              38.105              38.643              39.264               39.979               40.805               41.758               42.857               44.125      
         34.523              34.737              34.985               35.27              35.599              35.979              36.417              36.923              37.506              38.178               38.954               39.849               40.881               42.072               43.446      
         33.113              33.342              33.606               33.91              34.262              34.668              35.135              35.675              36.297              37.015               37.844               38.799               39.902               41.173                42.64      
         40.942              40.961              40.983              41.009              41.039              41.073              41.112              41.158               41.21              41.271               41.341               41.421               41.514               41.621               41.745      
         40.573              40.695              40.836              40.998              41.185              41.401               41.65              41.937              42.269              42.651               43.092               43.601               44.188               44.865               45.647      
          39.76              39.916              40.096              40.304              40.544              40.821              41.141              41.509              41.934              42.424                42.99               43.642               44.395               45.263               46.264      
         38.882              39.063              39.271              39.512               39.79               40.11              40.479              40.905              41.397              41.964               42.618               43.373               44.243               45.248               46.406      
         37.933              38.133              38.365              38.632              38.939              39.295              39.704              40.177              40.722              41.351               42.076               42.913               43.878               44.992               46.276      
         36.628              36.845              37.096              37.385              37.718              38.103              38.547              39.059               39.65              40.331               41.117               42.024                43.07               44.276               45.668      
         35.085              35.317              35.584              35.893              36.249               36.66              37.134              37.681              38.311              39.039               39.878               40.846               41.963               43.251               44.738      
         43.118              43.137               43.16              43.186              43.216               43.25               43.29              43.336              43.389              43.451               43.521               43.603               43.697               43.806               43.931      
          42.72              42.844              42.986               43.15               43.34              43.559              43.811              44.102              44.438              44.825               45.272               45.787               46.381               47.067               47.858      
         41.873              42.031              42.213              42.424              42.667              42.948              43.271              43.644              44.074              44.571               45.144               45.804               46.566               47.446                48.46      
          40.96              41.143              41.354              41.598              41.879              42.203              42.577              43.009              43.507              44.081               44.744               45.508               46.389               47.406                48.58      
         40.015              40.218              40.453              40.723              41.035              41.394              41.809              42.288               42.84              43.477               44.211               45.059               46.036               47.164               48.465      
         38.651              38.871              39.125              39.418              39.756              40.146              40.595              41.114              41.712              42.402               43.198               44.116               45.175               46.397               47.807      
         37.056              37.291              37.562              37.875              38.235              38.652              39.132              39.685              40.324              41.061               41.911               42.891               44.022               45.327               46.832      
         45.293              45.313              45.336              45.362              45.392              45.427              45.468              45.515              45.568               45.63               45.702               45.785                45.88                45.99               46.117      
         44.867              44.992              45.136              45.302              45.494              45.716              45.971              46.266              46.606              46.998                47.45               47.971               48.573               49.267               50.068      
         43.985              44.145               44.33              44.544               44.79              45.073              45.401              45.778              46.214              46.717               47.296               47.965               48.737               49.627               50.653      
         43.037              43.223              43.437              43.683              43.968              44.296              44.675              45.112              45.616              46.197               46.868               47.641               48.534               49.563               50.751      
         42.057              42.263                42.5              42.774              43.089              43.453              43.873              44.358              44.917              45.561               46.305               47.163               48.152               49.294               50.611      
         40.658              40.881              41.138              41.434              41.776               42.17              42.625               43.15              43.756              44.454                45.26                46.19               47.262               48.499               49.926      
         39.027              39.265              39.539              39.856              40.221              40.642              41.128              41.689              42.335              43.081               43.941               44.934               46.079                 47.4               48.923      
         47.469              47.489              47.512              47.538              47.569              47.605              47.646              47.693              47.747               47.81               47.882               47.966               48.062               48.174               48.302      
         47.014               47.14              47.286              47.454              47.648              47.872              48.131              48.429              48.773              49.169               49.627               50.155               50.764               51.466               52.276      
         46.097               46.26              46.447              46.662              46.911              47.199               47.53              47.912              48.353              48.861               49.448               50.125               50.905               51.806               52.845      
         45.114              45.302              45.518              45.768              46.056              46.388              46.772              47.214              47.723              48.312                48.99               49.773               50.676               51.718               52.919      
         44.099              44.307              44.547              44.824              45.143              45.512              45.937              46.427              46.992              47.645               48.397               49.265               50.266               51.422               52.754      
         42.664              42.889              43.149              43.449              43.795              44.194              44.655              45.186              45.799              46.505               47.321               48.261               49.346               50.598               52.042      
         40.998              41.239              41.516              41.836              42.206              42.632              43.124              43.691              44.345                45.1                45.97               46.975               48.133                49.47               51.011      
         49.644              49.664              49.688              49.715              49.746              49.782              49.823              49.871              49.926              49.989               50.063               50.147               50.245               50.357               50.487      
          49.16              49.288              49.436              49.606              49.802              50.029               50.29              50.592              50.939              51.341               51.804               52.337               52.953               53.664               54.483      
         48.209              48.374              48.563              48.781              49.033              49.323              49.658              50.045              50.491              51.005               51.599               52.283               53.073               53.984               55.034      
         47.191              47.381                47.6              47.853              48.144               48.48              48.867              49.315               49.83              50.425               51.112               51.904               52.817               53.871               55.086      
          46.14              46.351              46.594              46.874              47.197              47.569              47.999              48.495              49.067              49.727               50.488               51.366               52.379               53.547               54.895      
         44.669              44.897               45.16              45.464              45.814              46.218              46.683              47.221               47.84              48.555                49.38               50.331               51.429               52.695               54.155      
         42.968              43.212              43.492              43.816               44.19              44.621              45.119              45.692              46.354              47.117               47.998               49.014               50.186               51.537               53.097      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.306              51.436              51.585              51.757              51.956              52.185              52.449              52.754              53.106              53.511               53.979               54.519               55.142                55.86               56.689      
         50.321              50.487              50.679              50.899              51.154              51.448              51.786              52.177              52.628              53.148               53.748                54.44               55.239                56.16               57.222      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         48.182              48.394               48.64              48.923               49.25              49.626              50.061              50.562              51.141              51.808               52.577               53.465               54.489               55.671               57.034      
         46.675              46.905              47.171              47.478              47.832               48.24              48.711              49.254              49.881              50.604               51.438                 52.4               53.509                54.79               56.266      
         44.938              45.184              45.468              45.796              46.174               46.61              47.112              47.693              48.362              49.134               50.024               51.051               52.236               53.603                55.18      

</pre><h2 id="16">COH2: Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));
</pre><h2 id="17">COH3: Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="18">COH4: Select only Valid (k(w), a) choices</h2><pre class="codeinput"><span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);
</pre><h2 id="19">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>

<span class="comment">% This is borrowing with default or not condition</span>
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);
</pre><h2 id="20">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="comment">% 1. Given COH grid, w choices in terms of cash-on-hand percentages</span>
<span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>

<span class="comment">% 2. Some w &lt; 0, some w &gt; 0. When w &lt; 0, coh &gt; 0 or coh &lt; 0 both possible.</span>
<span class="comment">% Need to interplate in ff_ipwkbz_fibs_vecsv differently for w &lt; 0 because</span>
<span class="comment">% there both w as well as coh matters, if coh &lt; 0 and w &lt; 0, a fraction of</span>
<span class="comment">% w goes to getting informal bridge loans.</span>
mt_bl_w_by_interp_coh_interp_grid_wneg = (mt_w_by_interp_coh_interp_grid &lt; 0);
mt_w_by_interp_coh_interp_grid_wneg = mt_w_by_interp_coh_interp_grid(mt_bl_w_by_interp_coh_interp_grid_wneg);
mt_w_by_interp_coh_interp_grid_wpos = mt_w_by_interp_coh_interp_grid(~mt_bl_w_by_interp_coh_interp_grid_wneg);
</pre><h2 id="21">Generate 1st Stage Choices: Percent of W for Covering Bridge Loans</h2><p>If bridge loan does not matter, do not need to cover bridge loan. Then these percentages should reflect what happens when param_map('bl_bridge') = false, and, param_map('it_coh_bridge_perc_n') = 1;</p><pre class="codeinput"><span class="comment">% 1. Expand cash-on-hand by w_perc grid</span>
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_by_interp_coh_interp_grid)) + ar_interp_coh_grid;

<span class="comment">% 2. How much is coh as perc of w_perc grid level choice based on w_perc</span>
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_by_interp_coh_interp_grid));

<span class="comment">% 3. The ratio only relevant for where w &lt; 0 and where coh &lt; 0. Note the</span>
<span class="comment">% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to</span>
<span class="comment">% bridge.</span>
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc &gt;= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_by_interp_coh_interp_grid_wneg);
</pre><h2 id="22">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="23">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="24">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</h2><p>ar_a_meshk is t: b ar_ameshk_tnext_with_r is t+1: b*(1+r) with for inf ar_coh_bridge_perc: this is percentage of w NOT for bridge loan</p><pre class="codeinput">armt_map(<span class="string">'ar_coh_bridge_perc'</span>) = ar_coh_bridge_perc;
armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_ameshk_tnext_with_r'</span>) = ar_ameshk_tnext_with_r;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_z_mesh_coh_wkb'</span>) = mt_z_mesh_coh_wkb;
</pre><h2 id="25">Store armt_map (2): First Stage Aggregate Savings</h2><p>w = k' + b', w is aggregate Savings</p><div><ol><li><b>ar_w_perc</b> 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li><b>ar_w_level</b> 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li><b>ar_w_level_full</b>: in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/solve/html/ff_ipwkbz_vf_vecsv.html">ff_ipwkbz_vf_vecsv</a>, <i>ar_w_level</i> and <i>ar_w_level_full</i> were the same. Now have this thing which is stored (length(ar_w_level_full)) by (length(ar_z)). <i>ar_w_level_full</i> includes not just different levels of <i>ar_w_level</i>, but also repeats the elements of <i>ar_w_level</i> that are &lt; 0 by <i>it_coh_bridge_perc_n</i> times, starting with what corresponds to 100 percent of w should go to cover bridge loan, until 0 percent for w &lt; 0, which then proceeds to w &gt; 0. So the last segment of <i>ar_w_level_full</i> is the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) = ar_w_level.</li><li><b>mt_w_by_interp_coh_interp_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'ar_w_level_full'</span>) = ar_w_level_full;

armt_map(<span class="string">'mt_w_level_neg_mesh_coh_bridge_perc'</span>) = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map(<span class="string">'mt_coh_bridge_perc_mesh_w_level_neg'</span>) = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>) = mt_w_by_interp_coh_interp_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;

armt_map(<span class="string">'mt_bl_w_by_interp_coh_interp_grid_wneg'</span>) = mt_bl_w_by_interp_coh_interp_grid_wneg;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid_wneg'</span>) = mt_w_by_interp_coh_interp_grid_wneg;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid_wpos'</span>) = mt_w_by_interp_coh_interp_grid_wpos;
armt_map(<span class="string">'mt_coh_w_perc_ratio_wneg'</span>) = mt_coh_w_perc_ratio_wneg;
</pre><h2 id="26">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</h2><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
armt_map(<span class="string">'mt_z_mesh_coh_interp_grid'</span>) = mt_z_mesh_coh_interp_grid;
</pre><h2 id="27">Store armt_map (4): Shock Grids</h2><pre class="codeinput">armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
armt_map(<span class="string">'ar_stationary'</span>) = ar_stationary;
armt_map(<span class="string">'ar_z'</span>) = ar_z;
</pre><h2 id="28">Store armt_map (5): Formal grid</h2><pre class="codeinput">armt_map(<span class="string">'ar_forbrblk'</span>) = ar_forbrblk;
armt_map(<span class="string">'ar_forbrblk_r'</span>) = ar_forbrblk_r;
</pre><h2 id="29">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_coh_fbis'</span>) = f_coh_fbis;
func_map(<span class="string">'f_coh_save'</span>) = f_coh_save;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="30">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="32">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><p>Plot end because earlier parts have repeating w and a levels due to potentially bridge which are coh percentage dependent. This will only plot out the grid basically when coh percentage for bridge loan = 0</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 mt_k(:,it_col_start:it_col_end), <span class="keyword">...</span>
                 <span class="string">'blue'</span>);

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
    scatter(ar_a_meshk(it_col_start:it_col_end), <span class="keyword">...</span>
            ar_k_mesha(it_col_start:it_col_end), <span class="keyword">...</span>
            3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                                     ar_k_mesha_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title({<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span><span class="keyword">...</span>
           <span class="string">'(Bridge Borrow Share = 0)'</span>})
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_01.png" alt=""> <h2 id="33">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
        <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
        <span class="string">'For each w and z, coh maximizing k is different'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

    legendCell{length(legendCell) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_02.png" alt=""> <h2 id="34">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_03.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="36">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="38">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_04.png" alt=""> <h2 id="39">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_fibs_get_funcgrid_05.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="41">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z));
    disp(ar_z);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_coh_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_coh_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_c_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_c_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_interp_coh_grid_mesh_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_a'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_a_meshk'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_a_meshk));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_k'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_k_mesha'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    <span class="keyword">for</span> i = 1:length(func_map)
        st_display = strjoin([<span class="string">'pos ='</span> num2str(i) <span class="string">'; key ='</span> string(param_map_keys{i}) <span class="string">'; val ='</span> func2str(param_map_vals{i})]);
        disp(st_display);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    55

  Columns 1 through 7

  -20.0000  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727

  Columns 8 through 14

   -5.1515   -3.0303   -0.9091  -20.0000  -17.8788  -15.7576  -13.6364

  Columns 15 through 21

  -11.5152   -9.3939   -7.2727   -5.1515   -3.0303   -0.9091  -20.0000

  Columns 22 through 28

  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727   -5.1515

  Columns 29 through 35

   -3.0303   -0.9091         0    1.2121    3.3333    5.4545    7.5758

  Columns 36 through 42

    9.6970   11.8182   13.9394   16.0606   18.1818   20.3030   22.4242

  Columns 43 through 49

   24.5455   26.6667   28.7879   30.9091   33.0303   35.1515   37.2727

  Columns 50 through 55

   39.3939   41.5152   43.6364   45.7576   47.8788   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    38

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.991                            -19.989                            -19.987                            -19.985                            -19.983                             -19.981                             -19.98                             -19.979                              -19.976                            -19.974                             -19.972                               -19.97                            -19.968                             -19.966                             -19.964                              -19.961                            -19.959                             -19.957                             -19.955                             -19.953                             -19.951                             -19.948                             -19.946                             -19.944                              -19.942                              -19.94                            -19.938                             -19.936                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.641                            -19.282                            -18.923                            -18.564                            -18.205                            -17.846                            -17.486                            -17.127                             -16.768                            -16.653                             -16.409                               -16.05                            -15.691                             -15.332                              -14.973                            -14.614                             -14.255                             -13.896                              -13.537                            -13.178                             -12.819                             -12.459                               -12.1                             -11.741                             -11.382                             -11.023                             -10.664                              -10.305                              -9.946                            -9.5869                             -9.2278                             -8.8688                             -8.5097                             -8.1506                             -7.7915                             -7.4325                             -7.0734             
                  -20                              -19.284                            -18.568                            -17.852                            -17.136                             -16.42                            -15.704                            -14.988                            -14.272                             -13.556                            -13.327                              -12.84                              -12.124                            -11.408                             -10.692                               -9.976                              -9.26                              -8.544                              -7.828                               -7.112                             -6.396                               -5.68                              -4.964                              -4.248                              -3.532                              -2.816                                -2.1                              -1.384                             -0.66803                            0.047969                            0.76397                                1.48                               2.196                               2.912                               3.628                               4.344                                5.06                               5.776             
                  -20                              -18.927                            -17.854                            -16.781                            -15.708                            -14.635                            -13.562                             -12.49                            -11.417                             -10.344                                -10                             -9.2707                              -8.1978                            -7.1249                              -6.052                               -4.979                            -3.9061                             -2.8332                             -1.7603                             -0.68734                            0.38558                              1.4585                              2.5314                              3.6044                              4.6773                              5.7502                              6.8231                              7.8961                                8.969                              10.042                             11.115                              12.188                              13.261                              14.334                              15.407                              16.479                              17.552                              18.625             
                  -20                               -18.57                             -17.14                             -15.71                            -14.281                            -12.851                            -11.421                             -9.991                            -8.5612                             -7.1313                            -6.6733                             -5.7015                              -4.2716                            -2.8418                             -1.4119                             0.017927                             1.4478                              2.8776                              4.3075                               5.7373                             7.1672                               8.597                              10.027                              11.457                              12.887                              14.316                              15.746                              17.176                               18.606                              20.036                             21.466                              22.896                              24.325                              25.755                              27.185                              28.615                              30.045                              31.475             
                  -20                              -18.213                            -16.426                             -14.64                            -12.853                            -11.066                            -9.2793                            -7.4926                            -5.7058                              -3.919                            -3.3467                             -2.1322                             -0.34544                             1.4413                              3.2281                               5.0149                             6.8017                              8.5885                              10.375                               12.162                             13.949                              15.736                              17.522                              19.309                              21.096                              22.883                              24.669                              26.456                               28.243                               30.03                             31.817                              33.603                               35.39                              37.177                              38.964                               40.75                              42.537                              44.324             
                  -20                              -17.856                            -15.713                            -13.569                            -11.425                            -9.2815                            -7.1378                            -4.9941                            -2.8504                            -0.70666                              -0.02                               1.437                               3.5808                             5.7245                              7.8682                               10.012                             12.156                              14.299                              16.443                               18.587                              20.73                              22.874                              25.018                              27.162                              29.305                              31.449                              33.593                              35.736                                37.88                              40.024                             42.167                              44.311                              46.455                              48.599                              50.742                              52.886                               55.03                              57.173             

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.991                            -19.989                            -19.987                            -19.985                            -19.983                             -19.981                             -19.98                             -19.979                              -19.976                            -19.974                             -19.972                               -19.97                            -19.968                             -19.966                             -19.964                              -19.961                            -19.959                             -19.957                             -19.955                             -19.953                             -19.951                             -19.948                             -19.946                             -19.944                              -19.942                              -19.94                            -19.938                             -19.936                             -19.933                             -19.931                             -19.929                             -19.927                             -19.925                             -19.923             
                  -20                              -19.641                            -19.282                            -18.923                            -18.564                            -18.205                            -17.846                            -17.486                            -17.127                             -16.768                            -16.653                             -16.409                               -16.05                            -15.691                             -15.332                              -14.973                            -14.614                             -14.255                             -13.896                              -13.537                            -13.178                             -12.819                             -12.459                               -12.1                             -11.741                             -11.382                             -11.023                             -10.664                              -10.305                              -9.946                            -9.5869                             -9.2278                             -8.8688                             -8.5097                             -8.1506                             -7.7915                             -7.4325                             -7.0734             
                  -20                              -19.284                            -18.568                            -17.852                            -17.136                             -16.42                            -15.704                            -14.988                            -14.272                             -13.556                            -13.327                              -12.84                              -12.124                            -11.408                             -10.692                               -9.976                              -9.26                              -8.544                              -7.828                               -7.112                             -6.396                               -5.68                              -4.964                              -4.248                              -3.532                              -2.816                                -2.1                              -1.384                             -0.66803                            0.047969                            0.76397                                1.48                               2.196                               2.912                               3.628                               4.344                                5.06                               5.776             
                  -20                              -18.927                            -17.854                            -16.781                            -15.708                            -14.635                            -13.562                             -12.49                            -11.417                             -10.344                                -10                             -9.2707                              -8.1978                            -7.1249                              -6.052                               -4.979                            -3.9061                             -2.8332                             -1.7603                             -0.68734                            0.38558                              1.4585                              2.5314                              3.6044                              4.6773                              5.7502                              6.8231                              7.8961                                8.969                              10.042                             11.115                              12.188                              13.261                              14.334                              15.407                              16.479                              17.552                              18.625             
                  -20                               -18.57                             -17.14                             -15.71                            -14.281                            -12.851                            -11.421                             -9.991                            -8.5612                             -7.1313                            -6.6733                             -5.7015                              -4.2716                            -2.8418                             -1.4119                             0.017927                             1.4478                              2.8776                              4.3075                               5.7373                             7.1672                               8.597                              10.027                              11.457                              12.887                              14.316                              15.746                              17.176                               18.606                              20.036                             21.466                              22.896                              24.325                              25.755                              27.185                              28.615                              30.045                              31.475             
                  -20                              -18.213                            -16.426                             -14.64                            -12.853                            -11.066                            -9.2793                            -7.4926                            -5.7058                              -3.919                            -3.3467                             -2.1322                             -0.34544                             1.4413                              3.2281                               5.0149                             6.8017                              8.5885                              10.375                               12.162                             13.949                              15.736                              17.522                              19.309                              21.096                              22.883                              24.669                              26.456                               28.243                               30.03                             31.817                              33.603                               35.39                              37.177                              38.964                               40.75                              42.537                              44.324             
                  -20                              -17.856                            -15.713                            -13.569                            -11.425                            -9.2815                            -7.1378                            -4.9941                            -2.8504                            -0.70666                              -0.02                               1.437                               3.5808                             5.7245                              7.8682                               10.012                             12.156                              14.299                              16.443                               18.587                              20.73                              22.874                              25.018                              27.162                              29.305                              31.449                              33.593                              35.736                                37.88                              40.024                             42.167                              44.311                              46.455                              48.599                              50.742                              52.886                               55.03                              57.173             

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

       0.26016        0.26831        0.25551        0.14921       0.053403      0.011702       0.0015678     0.00012823     6.3911e-06      1.9381e-07      3.5701e-09      3.9889e-11      2.7001e-13      1.1102e-15               0 
       0.11232        0.19622         0.2763        0.23861        0.12635      0.040998       0.0081429     0.00098855     7.3236e-05      3.3054e-06      9.0736e-08      1.5125e-09      1.5289e-11      9.3592e-14      3.3307e-16 
      0.037073        0.10492         0.2185        0.27902         0.2185       0.10492        0.030863      0.0055558     0.00061112      4.1008e-05      1.6758e-06       4.164e-08      6.2811e-10      5.7438e-12      3.1863e-14 
     0.0092081       0.040998        0.12635        0.23861         0.2763       0.19622        0.085427       0.022782      0.0037167       0.0003704      2.2511e-05      8.3291e-07      1.8732e-08      2.5567e-10      2.1255e-12 
     0.0017026       0.011702       0.053403        0.14921        0.25551       0.26831         0.17279       0.068209       0.016489       0.0024379       0.0002201      1.2114e-05       4.058e-07      8.2598e-09      1.0277e-10 
    0.00023263      0.0024379       0.016489       0.068209        0.17279       0.26831         0.25551        0.14921       0.053403        0.011702       0.0015678      0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427       0.19622          0.2763        0.23861        0.12635        0.040998       0.0081429      0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863       0.10492          0.2185        0.27902         0.2185         0.10492        0.030863       0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429      0.040998         0.12635        0.23861         0.2763         0.19622        0.085427        0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678      0.011702        0.053403        0.14921        0.25551         0.26831         0.17279        0.068209        0.016489       0.0024379      0.00023263 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

    0.00023263      0.0024379       0.016489       0.068209        0.17279        0.26831        0.25551        0.14921       0.053403       0.011702       0.0015678       0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622         0.2763        0.23861        0.12635       0.040998       0.0081429       0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492         0.2185        0.27902         0.2185        0.10492        0.030863        0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998        0.12635        0.23861         0.2763        0.19622        0.085427         0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702       0.053403        0.14921        0.25551        0.26831         0.17279         0.068209        0.016489       0.0024379      0.00023263 
    1.0277e-10     8.2598e-09      4.058e-07     1.2114e-05      0.0002201      0.0024379       0.016489       0.068209        0.17279        0.26831         0.25551          0.14921        0.053403        0.011702       0.0017026 
    2.1256e-12     2.5567e-10     1.8732e-08     8.3291e-07     2.2511e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622          0.2763          0.23861         0.12635        0.040998       0.0092081 
    3.1909e-14     5.7438e-12     6.2811e-10      4.164e-08     1.6758e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492          0.2185          0.27902          0.2185         0.10492        0.037073 
     3.474e-16     9.3597e-14     1.5289e-11     1.5125e-09     9.0736e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998         0.12635          0.23861          0.2763         0.19622         0.11232 
    2.7412e-18     1.1057e-15     2.6998e-13     3.9889e-11     3.5701e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702        0.053403          0.14921         0.25551         0.26831         0.26016 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_coh_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 38&times;1 double

        Values:

            Min          -20
            Median    17.552
            Max       57.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_c_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 772306&times;1 double

        Values:

            Min         0.02
            Median    38.635
            Max       77.251

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_interp_coh_grid_mesh_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    38    15

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

                  -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                            -20                            -20                            -20                            -20                            -20          
              -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                       -17.854                        -17.854                        -17.854                        -17.854                        -17.854                        -17.854          
              -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                       -15.708                        -15.708                        -15.708                        -15.708                        -15.708                        -15.708          
              -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                       -13.562                        -13.562                        -13.562                        -13.562                        -13.562                        -13.562          
              -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                       -11.417                        -11.417                        -11.417                        -11.417                        -11.417                        -11.417          
              -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                       -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707                        -9.2707          
              -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                       -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249                        -7.1249          
               -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                        -4.979                         -4.979                         -4.979                         -4.979                         -4.979                         -4.979          
              -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                       -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332                        -2.8332          
             -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                      -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734                       -0.68734          

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

              37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                        37.938                         37.938                         37.938                         37.938                         37.938                         37.938           
              40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                        40.084                         40.084                         40.084                         40.084                         40.084                         40.084           
               42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                         42.23                          42.23                          42.23                          42.23                          42.23                          42.23           
              44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                        44.376                         44.376                         44.376                         44.376                         44.376                         44.376           
              46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                        46.521                         46.521                         46.521                         46.521                         46.521                         46.521           
              48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                        48.667                         48.667                         48.667                         48.667                         48.667                         48.667           
              50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                        50.813                         50.813                         50.813                         50.813                         50.813                         50.813           
              52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                        52.959                         52.959                         52.959                         52.959                         52.959                         52.959           
              55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                        55.105                         55.105                         55.105                         55.105                         55.105                         55.105           
              57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                        57.251                         57.251                         57.251                         57.251                         57.251                         57.251           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_a
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9      mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19      mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29      mt_a30     mt_a31     mt_a32      mt_a33     mt_a34     mt_a35      mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50     mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    ________    _______    _______    ________    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______

     -20     -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818      -0.02     1.1909        3.31     5.4291     7.5482      9.6673     11.786     13.905     16.025      18.144     20.263     22.382     24.501      26.62     28.739     30.858     32.977     35.096     37.215      39.335     41.454     43.573     45.692     47.811      49.93
     -20     -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036    -3.3467    -2.3374    -0.57111     1.1952     2.9614      4.7277     6.4939     8.2602     10.026      11.793     13.559     15.325     17.092     18.858     20.624      22.39     24.157     25.923     27.689      29.455     31.222     32.988     34.754      36.52     38.287
     -20     -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791    -6.6733    -5.8657     -4.4522    -3.0388    -1.6254    -0.21192     1.2015     2.6149     4.0284      5.4418     6.8553     8.2687     9.6821     11.096     12.509     13.922     15.336     16.749     18.163      19.576      20.99     22.403     23.816      25.23     26.643
     -20     -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455        -10    -9.3939     -8.3333    -7.2727    -6.2121     -5.1515    -4.0909    -3.0303    -1.9697    -0.90909    0.15152     1.2121     2.2727     3.3333     4.3939     5.4545     6.5152     7.5758     8.6364       9.697     10.758     11.818     12.879     13.939         15
     -20     -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63    -13.327    -12.922     -12.214    -11.507    -10.799     -10.091    -9.3833    -8.6756    -7.9678       -7.26    -6.5522    -5.8444    -5.1367    -4.4289    -3.7211    -3.0133    -2.3056    -1.5978      -0.89    -0.18222    0.52556     1.2333     1.9411     2.6489     3.3567
     -20     -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805    -16.653    -16.451     -16.096    -15.741    -15.386     -15.031    -14.676    -14.321    -13.966     -13.611    -13.256    -12.901    -12.546    -12.191    -11.836    -11.481    -11.126    -10.771    -10.416     -10.061    -9.7065    -9.3515    -8.9966    -8.6416    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -19.98    -19.979     -19.977    -19.975    -19.972      -19.97    -19.968    -19.966    -19.964     -19.962     -19.96    -19.958    -19.955    -19.953    -19.951    -19.949    -19.947    -19.945    -19.943     -19.941    -19.938    -19.936    -19.934    -19.932     -19.93

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9      mt_a10     mt_a11    mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19      mt_a20     mt_a21    mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29      mt_a30     mt_a31     mt_a32      mt_a33     mt_a34     mt_a35      mt_a36     mt_a37     mt_a38     mt_a39      mt_a40     mt_a41     mt_a42     mt_a43     mt_a44     mt_a45     mt_a46     mt_a47     mt_a48     mt_a49      mt_a50     mt_a51     mt_a52     mt_a53     mt_a54     mt_a55 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    ________    _______    _______    ________    _______    _______    _______    ________    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    _______    _______    _______    _______    _______

     -20     -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818     -20      -17.881    -15.762    -13.643    -11.524    -9.4045    -7.2855    -5.1664    -3.0473    -0.92818      -0.02     1.1909        3.31     5.4291     7.5482      9.6673     11.786     13.905     16.025      18.144     20.263     22.382     24.501      26.62     28.739     30.858     32.977     35.096     37.215      39.335     41.454     43.573     45.692     47.811      49.93
     -20     -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036     -20      -18.234    -16.467    -14.701    -12.935    -11.169    -9.4024    -7.6362    -5.8699     -4.1036    -3.3467    -2.3374    -0.57111     1.1952     2.9614      4.7277     6.4939     8.2602     10.026      11.793     13.559     15.325     17.092     18.858     20.624      22.39     24.157     25.923     27.689      29.455     31.222     32.988     34.754      36.52     38.287
     -20     -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791     -20      -18.587    -17.173     -15.76    -14.346    -12.933    -11.519    -10.106    -8.6925     -7.2791    -6.6733    -5.8657     -4.4522    -3.0388    -1.6254    -0.21192     1.2015     2.6149     4.0284      5.4418     6.8553     8.2687     9.6821     11.096     12.509     13.922     15.336     16.749     18.163      19.576      20.99     22.403     23.816      25.23     26.643
     -20     -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455     -20      -18.939    -17.879    -16.818    -15.758    -14.697    -13.636    -12.576    -11.515     -10.455        -10    -9.3939     -8.3333    -7.2727    -6.2121     -5.1515    -4.0909    -3.0303    -1.9697    -0.90909    0.15152     1.2121     2.2727     3.3333     4.3939     5.4545     6.5152     7.5758     8.6364       9.697     10.758     11.818     12.879     13.939         15
     -20     -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63     -20      -19.292    -18.584    -17.877    -17.169    -16.461    -15.753    -15.046    -14.338      -13.63    -13.327    -12.922     -12.214    -11.507    -10.799     -10.091    -9.3833    -8.6756    -7.9678       -7.26    -6.5522    -5.8444    -5.1367    -4.4289    -3.7211    -3.0133    -2.3056    -1.5978      -0.89    -0.18222    0.52556     1.2333     1.9411     2.6489     3.3567
     -20     -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805     -20      -19.645     -19.29    -18.935     -18.58    -18.225     -17.87    -17.515     -17.16     -16.805    -16.653    -16.451     -16.096    -15.741    -15.386     -15.031    -14.676    -14.321    -13.966     -13.611    -13.256    -12.901    -12.546    -12.191    -11.836    -11.481    -11.126    -10.771    -10.416     -10.061    -9.7065    -9.3515    -8.9966    -8.6416    -8.2867
     -20     -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -20      -19.998    -19.996    -19.994    -19.992    -19.989    -19.987    -19.985    -19.983     -19.981     -19.98    -19.979     -19.977    -19.975    -19.972      -19.97    -19.968    -19.966    -19.964     -19.962     -19.96    -19.958    -19.955    -19.953    -19.951    -19.949    -19.947    -19.945    -19.943     -19.941    -19.938    -19.936    -19.934    -19.932     -19.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_a_meshk
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_a_meshk: 385&times;1 double

        Values:

            Min             -20   
            Median      -12.933   
            Max           49.93   

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_k
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     7    55

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9      mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18     mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28     mt_k29      mt_k30     mt_k31     mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37      mt_k38      mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46     mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0.02    0.021212    0.023333    0.025455    0.027576    0.029697    0.031818    0.033939    0.036061    0.038182    0.040303    0.042424    0.044545    0.046667    0.048788    0.050909    0.05303    0.055152    0.057273    0.059394    0.061515    0.063636    0.065758    0.067879      0.07
      0        0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945    3.3467      3.5495      3.9044      4.2594      4.6143      4.9693      5.3242      5.6792      6.0341      6.3891       6.744       7.099      7.4539      7.8089      8.1638      8.5188     8.8737      9.2287      9.5836      9.9386      10.294      10.648      11.003      11.358    11.713
      0        0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37    6.6733      7.0778      7.7856      8.4933      9.2011      9.9089      10.617      11.324      12.032       12.74      13.448      14.156      14.863      15.571      16.279      16.987     17.694      18.402       19.11      19.818      20.526      21.233      21.941      22.649    23.357
      0         1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455        10      10.606      11.667      12.727      13.788      14.848      15.909       16.97       18.03      19.091      20.152      21.212      22.273      23.333      24.394      25.455     26.515      27.576      28.636      29.697      30.758      31.818      32.879      33.939        35
      0         1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721    13.327      14.134      15.548      16.961      18.375      19.788      21.202      22.615      24.028      25.442      26.855      28.269      29.682      31.096      32.509      33.922     35.336      36.749      38.163      39.576       40.99      42.403      43.816       45.23    46.643
      0         1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896    16.653      17.663      19.429      21.195      22.961      24.728      26.494       28.26      30.026      31.793      33.559      35.325      37.092      38.858      40.624       42.39     44.157      45.923      47.689      49.455      51.222      52.988      54.754       56.52    58.287
      0         2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072     19.98      21.191       23.31      25.429      27.548      29.667      31.786      33.905      36.025      38.144      40.263      42.382      44.501       46.62      48.739      50.858     52.977      55.096      57.215      59.335      61.454      63.573      65.692      67.811     69.93

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9      mt_k10     mt_k11     mt_k12       mt_k13       mt_k14       mt_k15       mt_k16      mt_k17      mt_k18     mt_k19      mt_k20     mt_k21     mt_k22       mt_k23       mt_k24       mt_k25       mt_k26      mt_k27      mt_k28     mt_k29      mt_k30     mt_k31     mt_k32      mt_k33      mt_k34      mt_k35      mt_k36      mt_k37      mt_k38      mt_k39      mt_k40      mt_k41      mt_k42      mt_k43      mt_k44      mt_k45      mt_k46     mt_k47      mt_k48      mt_k49      mt_k50      mt_k51      mt_k52      mt_k53      mt_k54     mt_k55
    _____    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    _________    _________    _________    _________    ________    ________    ________    _______    ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0       0.0021212    0.0042424    0.0063636    0.0084848    0.010606    0.012727    0.014848    0.01697    0.019091      0.02    0.021212    0.023333    0.025455    0.027576    0.029697    0.031818    0.033939    0.036061    0.038182    0.040303    0.042424    0.044545    0.046667    0.048788    0.050909    0.05303    0.055152    0.057273    0.059394    0.061515    0.063636    0.065758    0.067879      0.07
      0        0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945      0         0.35495       0.7099       1.0648       1.4198      1.7747      2.1297      2.4846     2.8396      3.1945    3.3467      3.5495      3.9044      4.2594      4.6143      4.9693      5.3242      5.6792      6.0341      6.3891       6.744       7.099      7.4539      7.8089      8.1638      8.5188     8.8737      9.2287      9.5836      9.9386      10.294      10.648      11.003      11.358    11.713
      0        0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37      0         0.70778       1.4156       2.1233       2.8311      3.5389      4.2467      4.9544     5.6622        6.37    6.6733      7.0778      7.7856      8.4933      9.2011      9.9089      10.617      11.324      12.032       12.74      13.448      14.156      14.863      15.571      16.279      16.987     17.694      18.402       19.11      19.818      20.526      21.233      21.941      22.649    23.357
      0         1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455      0          1.0606       2.1212       3.1818       4.2424       5.303      6.3636      7.4242     8.4848      9.5455        10      10.606      11.667      12.727      13.788      14.848      15.909       16.97       18.03      19.091      20.152      21.212      22.273      23.333      24.394      25.455     26.515      27.576      28.636      29.697      30.758      31.818      32.879      33.939        35
      0         1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721      0          1.4134       2.8269       4.2403       5.6537      7.0672      8.4806       9.894     11.307      12.721    13.327      14.134      15.548      16.961      18.375      19.788      21.202      22.615      24.028      25.442      26.855      28.269      29.682      31.096      32.509      33.922     35.336      36.749      38.163      39.576       40.99      42.403      43.816       45.23    46.643
      0         1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896      0          1.7663       3.5325       5.2988       7.0651      8.8313      10.598      12.364      14.13      15.896    16.653      17.663      19.429      21.195      22.961      24.728      26.494       28.26      30.026      31.793      33.559      35.325      37.092      38.858      40.624       42.39     44.157      45.923      47.689      49.455      51.222      52.988      54.754       56.52    58.287
      0         2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072      0          2.1191       4.2382       6.3573       8.4764      10.595      12.715      14.834     16.953      19.072     19.98      21.191       23.31      25.429      27.548      29.667      31.786      33.905      36.025      38.144      40.263      42.382      44.501       46.62      48.739      50.858     52.977      55.096      57.215      59.335      61.454      63.573      65.692      67.811     69.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_k_mesha
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_k_mesha: 385&times;1 double

        Values:

            Min               0   
            Median       7.0672   
            Max           69.93   

pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_coh_fbis ; val = @(fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(ar_for_borr.*(1+fl_r_fbr)+ar_inf_borr.*(1+fl_r_inf)+ar_for_save.*(1+fl_r_fsv))
pos = 3 ; key = f_coh_save ; val = @(b)(b.*(1+fl_r_fsv))
pos = 4 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 5 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 6 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 7 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 8 ; key = f_util_log ; val = @(c)log(c)
pos = 9 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
</pre><h2 id="42">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 29
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a_meshk ;rown= 385 ,coln= 1
ar_a_meshk :mu= -7.2645 ,sd= 15.0838 ,min= -20 ,max= 49.93
                   zi_1_c1
                   _______

    zi_1_R1            -20
    zi_2_R2            -20
    zi_193_r193    -12.576
    zi_384_r384    -8.2867
    zi_385_r385     -19.93

pos = 2 ; key = ar_ak_perc ;rown= 1 ,coln= 7
ar_ak_perc :mu= 0.5 ,sd= 0.35932 ,min= 0.001 ,max= 0.999
               zi_1_c1    zi_2_c2    zi_4_c4    zi_6_c6    zi_7_c7
               _______    _______    _______    _______    _______

    zi_1_r1     0.001     0.16733      0.5      0.83267     0.999 

pos = 3 ; key = ar_ameshk_tnext_with_r ;rown= 385 ,coln= 1
ar_ameshk_tnext_with_r :mu= -8.6132 ,sd= 16.2368 ,min= -26 ,max= 51.1782
                   zi_1_c1
                   _______

    zi_1_R1            -26
    zi_2_R2            -26
    zi_193_r193     -13.47
    zi_384_r384    -8.8938
    zi_385_r385    -21.444

pos = 4 ; key = ar_coh_bridge_perc ;rown= 1 ,coln= 3
ar_coh_bridge_perc :mu= 0.5 ,sd= 0.5 ,min= 0 ,max= 1
               zi_1_c1    zi_2_c2    zi_3_c3
               _______    _______    _______

    zi_1_r1       0         0.5         1   

pos = 5 ; key = ar_forbrblk ;rown= 1 ,coln= 9
ar_forbrblk :mu= -7.0556 ,sd= 6.3809 ,min= -19 ,max= 0
               zi_1_c1    zi_2_c2    zi_5_c5    zi_8_c8    zi_9_c9
               _______    _______    _______    _______    _______

    zi_1_r1      -19       -14.5      -5.5        -1          0   

pos = 6 ; key = ar_forbrblk_r ;rown= 1 ,coln= 9
ar_forbrblk_r :mu= 0.065 ,sd= 0 ,min= 0.065 ,max= 0.065
               zi_1_c1    zi_2_c2    zi_5_c5    zi_8_c8    zi_9_c9
               _______    _______    _______    _______    _______

    zi_1_r1     0.065      0.065      0.065      0.065      0.065 

pos = 7 ; key = ar_interp_c_grid ;rown= 1 ,coln= 772306
ar_interp_c_grid :mu= 38.6353 ,sd= 22.2946 ,min= 0.02 ,max= 77.2506
               zi_1_C1    zi_2_C2    zi_386153_c386153    zi_772305_c772305    zi_772306_c772306
               _______    _______    _________________    _________________    _________________

    zi_1_r1     0.02      0.0201          38.635               77.251               77.251      

pos = 8 ; key = ar_interp_coh_grid ;rown= 1 ,coln= 38
ar_interp_coh_grid :mu= 18.1352 ,sd= 23.1098 ,min= -20 ,max= 57.2506
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.854     16.479       55.105       57.251  

pos = 9 ; key = ar_k_mesha ;rown= 385 ,coln= 1
ar_k_mesha :mu= 12.7355 ,sd= 15.0838 ,min= 0 ,max= 69.93
                   zi_1_c1
                   _______

    zi_1_R1             0 
    zi_2_R2             0 
    zi_193_r193    7.4242 
    zi_384_r384    58.287 
    zi_385_r385     69.93 

pos = 10 ; key = ar_stationary ;rown= 1 ,coln= 15
ar_stationary :mu= 0.066667 ,sd= 0.060897 ,min= 0.0027089 ,max= 0.16757
                zi_1_C1      zi_2_C2     zi_8_C8    zi_14_c14    zi_15_c15
               _________    _________    _______    _________    _________

    zi_1_r1    0.0027089    0.0069499    0.16757    0.0069499    0.0027089

pos = 11 ; key = ar_w_level ;rown= 1 ,coln= 35
ar_w_level :mu= 14.5714 ,sd= 20.9645 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_18_c18    zi_34_c34    zi_35_c35
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.879     13.939       47.879         50    

pos = 12 ; key = ar_w_level_full ;rown= 1 ,coln= 55
ar_w_level_full :mu= 5.4711 ,sd= 20.9306 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_28_c28    zi_54_c54    zi_55_c55
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.879     -5.1515      47.879         50    

pos = 13 ; key = ar_w_perc ;rown= 1 ,coln= 7
ar_w_perc :mu= 0.5 ,sd= 0.35932 ,min= 0.001 ,max= 0.999
               zi_1_c1    zi_2_c2    zi_4_c4    zi_6_c6    zi_7_c7
               _______    _______    _______    _______    _______

    zi_1_r1     0.001     0.16733      0.5      0.83267     0.999 

pos = 14 ; key = ar_z ;rown= 1 ,coln= 15
ar_z :mu= 1.1347 ,sd= 0.69878 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
               _______    _______    _______    _________    _________

    zi_1_r1    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 15 ; key = it_ameshk_n ; val = 385
pos = 16 ; key = mt_bl_w_by_interp_coh_interp_grid_wneg ;rown= 7 ,coln= 38
mt_bl_w_by_interp_coh_interp_grid_wneg :mu= 0.61654 ,sd= 0.48715 ,min= 0 ,max= 1
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1     true       true        true         true         true   
    zi_2_r2     true       true        true         true         true   
    zi_4_r4     true       true        true         false        false  
    zi_6_r6     true       true        false        false        false  
    zi_7_r7     true       true        false        false        false  

pos = 17 ; key = mt_coh_bridge_perc_mesh_w_level_neg ;rown= 10 ,coln= 3
mt_coh_bridge_perc_mesh_w_level_neg :mu= 0.5 ,sd= 0.41523 ,min= 0 ,max= 1
                 zi_1_c1    zi_2_c2    zi_3_c3
                 _______    _______    _______

    zi_1_R1         0         0.5         1   
    zi_2_R2         0         0.5         1   
    zi_5_R5         0         0.5         1   
    zi_9_R9         0         0.5         1   
    zi_10_r10       0         0.5         1   

pos = 18 ; key = mt_coh_w_perc_ratio_wneg ;rown= 164 ,coln= 1
mt_coh_w_perc_ratio_wneg :mu= 0.71268 ,sd= 0.3908 ,min= 0 ,max= 1
                   zi_1_c1
                   _______

    zi_1_R1           0   
    zi_2_R2           0   
    zi_82_R82         1   
    zi_163_r163       1   
    zi_164_r164       1   

pos = 19 ; key = mt_coh_wkb ;rown= 385 ,coln= 15
mt_coh_wkb :mu= 5.8021 ,sd= 21.9424 ,min= -25.5564 ,max= 57.2506
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1        -25.556    -25.556    -25.556     -25.556      -25.556 
    zi_2_R2        -25.556    -25.556    -25.556     -25.556      -25.556 
    zi_193_r193    -5.4812    -5.3715    -4.2528     -1.6166     -0.91339 
    zi_384_r384     46.675     46.905     49.254       54.79       56.266 
    zi_385_r385     44.938     45.184     47.693      53.603        55.18 

pos = 20 ; key = mt_interp_coh_grid_mesh_w_perc ;rown= 7 ,coln= 38
mt_interp_coh_grid_mesh_w_perc :mu= 18.1352 ,sd= 22.8467 ,min= -20 ,max= 57.2506
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.854     16.479       55.105       57.251  
    zi_2_r2      -20      -17.854     16.479       55.105       57.251  
    zi_4_r4      -20      -17.854     16.479       55.105       57.251  
    zi_6_r6      -20      -17.854     16.479       55.105       57.251  
    zi_7_r7      -20      -17.854     16.479       55.105       57.251  

pos = 21 ; key = mt_interp_coh_grid_mesh_z ;rown= 38 ,coln= 15
mt_interp_coh_grid_mesh_z :mu= 18.1352 ,sd= 22.8237 ,min= -20 ,max= 57.2506
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1          -20        -20        -20         -20          -20 
    zi_2_R2      -17.854    -17.854    -17.854     -17.854      -17.854 
    zi_19_r19     16.479     16.479     16.479      16.479       16.479 
    zi_37_r37     55.105     55.105     55.105      55.105       55.105 
    zi_38_r38     57.251     57.251     57.251      57.251       57.251 

pos = 22 ; key = mt_k ;rown= 7 ,coln= 55
mt_k :mu= 12.7355 ,sd= 15.0838 ,min= 0 ,max= 69.93
               zi_1_C1     zi_2_C2     zi_28_c28    zi_54_c54    zi_55_c55
               _______    _________    _________    _________    _________

    zi_1_r1       0       0.0021212    0.014848     0.067879        0.07  
    zi_2_r2       0         0.35495      2.4846       11.358      11.713  
    zi_4_r4       0          1.0606      7.4242       33.939          35  
    zi_6_r6       0          1.7663      12.364        56.52      58.287  
    zi_7_r7       0          2.1191      14.834       67.811       69.93  

pos = 23 ; key = mt_w_by_interp_coh_interp_grid ;rown= 7 ,coln= 38
mt_w_by_interp_coh_interp_grid :mu= -0.93241 ,sd= 18.7031 ,min= -20 ,max= 57.1734
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -19.998     -19.964      -19.925      -19.923 
    zi_2_r2      -20      -19.641     -13.896      -7.4325      -7.0734 
    zi_4_r4      -20      -18.927     -1.7603       17.552       18.625 
    zi_6_r6      -20      -18.213      10.375       42.537       44.324 
    zi_7_r7      -20      -17.856      16.443        55.03       57.173 

pos = 24 ; key = mt_w_by_interp_coh_interp_grid_wneg ;rown= 164 ,coln= 1
mt_w_by_interp_coh_interp_grid_wneg :mu= -13.2366 ,sd= 6.1562 ,min= -20 ,max= -0.02
                   zi_1_c1
                   _______

    zi_1_R1            -20
    zi_2_R2            -20
    zi_82_R82      -5.7015
    zi_163_r163    -19.923
    zi_164_r164    -7.0734

pos = 25 ; key = mt_w_by_interp_coh_interp_grid_wpos ;rown= 102 ,coln= 1
mt_w_by_interp_coh_interp_grid_wpos :mu= 18.8508 ,sd= 14.6824 ,min= 0.017927 ,max= 57.1734
                   zi_1_c1
                   _______

    zi_1_R1         1.437 
    zi_2_R2        3.5808 
    zi_51_R51      17.176 
    zi_101_r101    44.324 
    zi_102_r102    57.173 

pos = 26 ; key = mt_w_level_neg_mesh_coh_bridge_perc ;rown= 10 ,coln= 3
mt_w_level_neg_mesh_coh_bridge_perc :mu= -10.4545 ,sd= 6.1969 ,min= -20 ,max= -0.90909
                 zi_1_c1     zi_2_c2     zi_3_c3 
                 ________    ________    ________

    zi_1_R1           -20         -20         -20
    zi_2_R2       -17.879     -17.879     -17.879
    zi_5_R5       -11.515     -11.515     -11.515
    zi_9_R9       -3.0303     -3.0303     -3.0303
    zi_10_r10    -0.90909    -0.90909    -0.90909

pos = 27 ; key = mt_z_mesh_coh_interp_grid ;rown= 38 ,coln= 15
mt_z_mesh_coh_interp_grid :mu= 1.1347 ,sd= 0.67568 ,min= 0.34741 ,max= 2.567
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_19_r19    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_37_r37    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_38_r38    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 28 ; key = mt_z_mesh_coh_wkb ;rown= 385 ,coln= 15
mt_z_mesh_coh_wkb :mu= 1.1347 ,sd= 0.67514 ,min= 0.34741 ,max= 2.567
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1        0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2        0.34741    0.40076    0.94436     2.2253        2.567  
    zi_193_r193    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_384_r384    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_385_r385    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 29 ; key = mt_z_trans ;rown= 15 ,coln= 15
mt_z_trans :mu= 0.066667 ,sd= 0.095337 ,min= 0 ,max= 0.27902
                  zi_1_C1       zi_2_C2       zi_8_C8      zi_14_c14     zi_15_c15 
                 __________    __________    __________    __________    __________

    zi_1_R1         0.26016       0.26831    0.00012823    1.1102e-15             0
    zi_2_R2         0.11232       0.19622    0.00098855    9.3592e-14    3.3307e-16
    zi_8_R8      1.7181e-06    4.1008e-05       0.27902    4.1008e-05    1.7181e-06
    zi_14_r14     3.474e-16    9.3597e-14    0.00098855       0.19622       0.11232
    zi_15_r15    2.7412e-18    1.1057e-15    0.00012823       0.26831       0.26016

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                              i     idx    rowN       colN         mean        std          min         max   
                                              __    ___    ____    __________    ________    ________    _________    ________

    ar_a_meshk                                 1     1     385              1     -7.2645      15.084          -20       49.93
    ar_ak_perc                                 2     2       1              7         0.5     0.35932        0.001       0.999
    ar_ameshk_tnext_with_r                     3     3     385              1     -8.6132      16.237          -26      51.178
    ar_coh_bridge_perc                         4     4       1              3         0.5         0.5            0           1
    ar_forbrblk                                5     5       1              9     -7.0556      6.3809          -19           0
    ar_forbrblk_r                              6     6       1              9       0.065           0        0.065       0.065
    ar_interp_c_grid                           7     7       1     7.7231e+05      38.635      22.295         0.02      77.251
    ar_interp_coh_grid                         8     8       1             38      18.135       23.11          -20      57.251
    ar_k_mesha                                 9     9     385              1      12.736      15.084            0       69.93
    ar_stationary                             10    10       1             15    0.066667    0.060897    0.0027089     0.16757
    ar_w_level                                11    11       1             35      14.571      20.964          -20          50
    ar_w_level_full                           12    12       1             55      5.4711      20.931          -20          50
    ar_w_perc                                 13    13       1              7         0.5     0.35932        0.001       0.999
    ar_z                                      14    14       1             15      1.1347     0.69878      0.34741       2.567
    mt_bl_w_by_interp_coh_interp_grid_wneg    15    16       7             38     0.61654     0.48715            0           1
    mt_coh_bridge_perc_mesh_w_level_neg       16    17      10              3         0.5     0.41523            0           1
    mt_coh_w_perc_ratio_wneg                  17    18     164              1     0.71268      0.3908            0           1
    mt_coh_wkb                                18    19     385             15      5.8021      21.942      -25.556      57.251
    mt_interp_coh_grid_mesh_w_perc            19    20       7             38      18.135      22.847          -20      57.251
    mt_interp_coh_grid_mesh_z                 20    21      38             15      18.135      22.824          -20      57.251
    mt_k                                      21    22       7             55      12.736      15.084            0       69.93
    mt_w_by_interp_coh_interp_grid            22    23       7             38    -0.93241      18.703          -20      57.173
    mt_w_by_interp_coh_interp_grid_wneg       23    24     164              1     -13.237      6.1562          -20       -0.02
    mt_w_by_interp_coh_interp_grid_wpos       24    25     102              1      18.851      14.682     0.017927      57.173
    mt_w_level_neg_mesh_coh_bridge_perc       25    26      10              3     -10.455      6.1969          -20    -0.90909
    mt_z_mesh_coh_interp_grid                 26    27      38             15      1.1347     0.67568      0.34741       2.567
    mt_z_mesh_coh_wkb                         27    28     385             15      1.1347     0.67514      0.34741       2.567
    mt_z_trans                                28    29      15             15    0.066667    0.095337            0     0.27902

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    value
                   _    ___    _____

    it_ameshk_n    1    15      385 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 9
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(z,b_with_r,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b_with_r)
pos = 2 ; key = f_coh_fbis ; val = @(fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(ar_for_borr.*(1+fl_r_fbr)+ar_inf_borr.*(1+fl_r_inf)+ar_for_save.*(1+fl_r_fsv))
pos = 3 ; key = f_coh_save ; val = @(b)(b.*(1+fl_r_fsv))
pos = 4 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 5 ; key = f_inc ; val = @(z,k,fl_r_inf,ar_for_borr,ar_inf_borr,ar_for_save)(f_prod(z,k)-(fl_delta)*k+fl_w+(ar_for_borr.*(fl_r_fbr)+ar_inf_borr.*(fl_r_inf)+ar_for_save.*(fl_r_fsv)))
pos = 6 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 7 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 8 ; key = f_util_log ; val = @(c)log(c)
pos = 9 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                      i    idx    xFunction
                      _    ___    _________

    f_coh             1     1         1    
    f_coh_fbis        2     2         2    
    f_coh_save        3     3         3    
    f_cons            4     4         4    
    f_inc             5     5         5    
    f_prod            6     6         6    
    f_util_crra       7     7         7    
    f_util_log        8     8         8    
    f_util_standin    9     9         9    

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 29
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset + FIBS)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbz_fibs_get_funcgrid(varargin)
%% FFS_IPWKBZ_FIBS_GET_FUNCGRID get funcs, params, states choices shocks grids
% This file is based on
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, see that file for more comments and compare
% differences in graphs and tables to see how the inclusion of formal and
% informal choices that consider bridge loans impact choice sets.
%
% Also compare against
% <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_paramfunc/html/ffs_abz_fibs_get_funcgrid.html
% ffs_abz_fibs_get_funcgrid> where the results are also considering formal
% and informal choices etc in the context of *abz fibs*.
%
% In contrast to ff_ipwkbz_evf.m, here, we need to deal with borrowing and
% savings formal and informal. These will change how the testing matrix is
% constructed. When bridge loan is allowed, we also need to construct the
% output matrixes differently. In ff_ipwkbz_evf.m, the assumption is that
% coh today does not matter, so to find optimal k* choice, we only need to
% know the aggregate savings level. But now, we need to know the coh level
% as well.
%
% Below two reachable coh matrixes are constructed, one for when aggregate
% savings choice w >= 0, and another for when aggregate savings <= 0. Then
% they are stacked together. And we still have the same outputs as
% ff_ipwkbz_evf.m. The difference is that while for savings where w >=0,
% each row are w levels for the output matrixes, but for w <=0, each row is
% for w level + coh percentage combinations.
%
% * _ar_w_level_: What are the feasible grid of w = k'+b', these are to be interpolated
% later, these are level grid, not percentage grid
% * _ar_w_level_: What are the percentage based choices points for k' and
% b' given each w. These are _ar_a_meshk_, _ar_k_mesha_. Note here these
% are principles, k + b' is the total aggregate savings in period t. b is
% be a combination of formal and informal choices, but our percentage point
% for b is the overall principle of all formal and informal choices
% * _mt_coh_wkb_full_ : These are the cash-on-hand levels reacheable given
% the choice percentages of k and b'. The problem here is more complicated
% than
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> because here we can not get to coh tomorrow by
% multiplying principle by savings or borrowing interest rates, if
% borrowing, we have to optimize among formal and informal choices. That is
% computationally trivial because it's a static choice unrelated to the
% dynamic problem. The slightly more complicated thing is that we also have
% to consider percentages of b' that has to go to bridge loans due to
% negative cash-on-hand in period t. That makes the reachable cash-on-hand
% grid significantly larger than the grid in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid>, we have to expand the grid by another
% percentage dimensionREPLACE_WITH_DASH_DASHpercentages of b' going to bridgeREPLACE_WITH_DASH_DASHfor negative
% levels of w=k'+b' overall choice.
%

%% Default
% Results identical to
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_get_funcgrid.html
% ffs_ipwkbz_get_funcgrid> is obtained by running default with:
% st_param_which = 'ffs_ipwkbz_get_funcgrid';
%

%% Default
if (~isempty(varargin))
    
    % override when called from outside
    [param_map, support_map] = varargin{:};
    
else
    % default internal run
    [param_map, support_map] = ffs_ipwkbz_fibs_set_default_param();
    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    support_map('bl_display_funcgrids') = true;

    st_param_which = 'small';

    if (ismember(st_param_which, ['default', 'ffs_ipwkbz_get_funcgrid']))

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 25;
        param_map('it_ak_perc_n') = 45;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

        % Note it_coh_bridge_perc is percentage NOT for BRIDGE
        if (strcmp(st_param_which, 'default'))

            param_map('it_coh_bridge_perc_n') = 3;

            % Adjust interest rates
            param_map('fl_r_inf') = 0.30;
            param_map('fl_r_inf_bridge') = 0.30;
            param_map('bl_bridge') = true;

        elseif (strcmp(st_param_which, 'ffs_ipwkbz_get_funcgrid'))


            param_map('fl_r_inf') = 0.025;
            param_map('fl_r_inf_bridge') = 0.025;
            param_map('bl_bridge') = false;
            % when bl_bridge = false, it_coh_bridge_perc_n = 1

        end

    elseif (strcmp(st_param_which, 'small'))

        param_map('bl_bridge') = true;

        % Adjust interest rates
        param_map('fl_r_inf') = 0.30;
        param_map('fl_r_inf_bridge') = 0.30;

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = false; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 7;
        param_map('it_ak_perc_n') = 7;
        param_map('it_coh_bridge_perc_n') = 3;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

    end


    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
end

%% Parse Parameters

params_group = values(param_map, {'it_z_n', 'fl_z_mu', 'fl_z_rho', 'fl_z_sig'});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {'fl_nan_replace', 'fl_b_bd', 'fl_w_min', 'fl_w_max', ...
    'it_w_perc_n', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, ...
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_k_min', 'fl_k_max', 'it_ak_perc_n'});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min', 'it_c_interp_grid_gap'});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'bl_bridge', 'it_coh_bridge_perc_n'});
[bl_bridge, it_coh_bridge_perc_n] = params_group{:};

params_group = values(param_map, {'bl_b_is_principle', 'fl_r_fbr', 'fl_r_fsv', 'fl_r_inf', 'fl_w'});
[bl_b_is_principle, fl_r_fbr, fl_r_fsv, fl_r_inf, fl_w] = params_group{:};

params_group = values(param_map, {'st_forbrblk_type', 'fl_forbrblk_brmost', 'fl_forbrblk_brleast', 'fl_forbrblk_gap'});
[st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap] = params_group{:};

params_group = values(support_map, {'bl_display_minccost', 'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_display_minccost, bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};

params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% G1: Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_fibs_set_default_param.html
% ffs_ipwkbz_fibs_set_default_param> for details.
%
% @example
%
%    % For 2nd stage Grid
%    ar_w_level = [-2,0,2]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

%% G2: Expand A and K Arrays further if bridge is allowed
% Crucially, when a fraction of overall borrowing/savings needs to go pay
% negative coh, that comes out of w, fraction of w = k' + b' that goes to
% this. NOT a fraction of the b' choice condition on w, which would change
% for the same w as w' changes. We are fixing bridge repay level for w.
%
% @example
%
%    clear all
%    % Same as above
%    ar_w_level = [-2,-1,-0.1]
%    fl_b_bd = -4
%    ar_k_max = ar_w_level - fl_b_bd
%    ar_ak_perc = [0.001, 0.1,0.3,0.7,0.9, 0.999]
%    mt_k = (ar_k_max'*ar_ak_perc)'
%    mt_a = (ar_w_level - mt_k)
%
%    % fraction of borrowing for bridge loan
%    ar_coh_bridge_perc = [0, 0.5, 0.999];
%
%    % Expand matrix to include coh percentage dimension
%    mt_k = repmat(mt_k, [1, length(ar_coh_bridge_perc)])
%    mt_a = repmat(mt_a, [1, length(ar_coh_bridge_perc)])
%
%    % bridge loan component of borrowing
%    ar_brdige_a = (ar_coh_bridge_perc'*ar_w_level)'
%    ar_brdige_a = ar_brdige_a(:)'
%
%    % borrowing choices excluding bridge loan
%    mt_a_nobridge = mt_a - ar_brdige_a
%

% 1. negative part of w
ar_bl_w_neg = (ar_w_level < 0);
ar_w_level_neg = ar_w_level(ar_bl_w_neg);

if (bl_bridge)

    % 1. select mt_k and mt_a where w_level <= 0
    mt_a_wneg_cols = mt_a(:, ar_bl_w_neg);
    mt_k_wneg_cols = mt_k(:, ar_bl_w_neg);

    % 2. fraction of borrowing NOT for bridge loan
    % 0 means 100 percent of w will go to bridge, 1 mean nothing for bridge
    ar_coh_bridge_perc = linspace(0, 1.0, it_coh_bridge_perc_n);

    % 3. Expand matrix to include coh percentage dimension
    mt_k_wneg_cols = repmat(mt_k_wneg_cols, [1, length(ar_coh_bridge_perc)]);
    mt_a_wneg_cols = repmat(mt_a_wneg_cols, [1, length(ar_coh_bridge_perc)]);

    % 4. bridge loan component of borrowing
    ar_brdige_a = ((1-ar_coh_bridge_perc)'*ar_w_level_neg)';
    ar_brdige_a = ar_brdige_a(:)';

    % 5. borrowing choices excluding bridge loan
    mt_a_wneg_nobridge = mt_a_wneg_cols - ar_brdige_a;

    % 6. Matrix combine, negative than positive
    mt_a_wpos_cols = mt_a(:, ~ar_bl_w_neg);
    mt_k_wpos_cols = mt_k(:, ~ar_bl_w_neg);
    mt_a_nobridge = [mt_a_wneg_nobridge  mt_a_wpos_cols];
    mt_k = [mt_k_wneg_cols                mt_k_wpos_cols];

    % 7. Expand Bridge Choices to have the same size as mt_a
    mt_bridge_a= zeros(size(mt_a_nobridge));
    mt_bridge_a(:, 1:1:size(mt_a_wneg_nobridge,2)) = zeros(size(mt_a_wneg_nobridge)) + ar_brdige_a;

    % 8. Overall borrowing and savings choices
    mt_a = mt_a_nobridge + mt_bridge_a;

    % 9. Update w
    ar_w_level_full = zeros(size(mt_a_nobridge(1,:)));
    ar_w_level_neg_rep = repmat(ar_w_level_neg, [1, length(ar_coh_bridge_perc)]);
    ar_w_level_full(1:1:size(mt_a_wneg_nobridge,2)) = ar_w_level_neg_rep;
    ar_w_level_full((size(mt_a_wneg_nobridge,2)+1):1:length(ar_w_level_full)) = ar_w_level(~ar_bl_w_neg);

    % 10. Pre-generate Interpolation matrix for negative w levels
    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

else

    % If bridge loans are not needed, do not need to do expansions
    % All zeros, no bridge
    mt_bridge_a = zeros(size(mt_a));
    mt_a_nobridge = mt_a;
    ar_coh_bridge_perc = [1];

    [mt_w_level_neg_mesh_coh_bridge_perc, mt_coh_bridge_perc_mesh_w_level_neg] = ...
        ndgrid(ar_w_level_neg, ar_coh_bridge_perc);

end

%% G3: Flatten Choices to Arrays to be Combined with Shocks as Columns.
% For the arrays below, their dimensionality are all: N_neg*N^2 + N_pos*N
% number of rows. Where N is the percentage grid point for coh as well as
% k' choices: N = it_ak_perc_n = it_coh_bridge_perc_n; And N_neg + N_pos =
% numger of grid points for ar_w_level
%
% # *mt_a* includes aggregate/total borrowing and savings levels. b < 0 happens
% alot when w >= 0. The mt_a_nobridge
% # *mt_a_nobridge* includes all aggregate/total borrowing and savings
% whether w > 0 or w < 0, however, it subtracts away the borrowing that is
% for bridge loans when b < 0
% # *mt_bridge_a* is the bridge loan amount.
%

ar_a_meshk_full = mt_a(:);
ar_a_nobridge_meshk_full = mt_a_nobridge(:);
ar_k_mesha_full = mt_k(:);
ar_bridge_a_full = mt_bridge_a(:);

ar_a_meshk = ar_a_meshk_full;
ar_a_nobridge_meshk = ar_a_nobridge_meshk_full;
ar_k_mesha = ar_k_mesha_full;
ar_bridge_a = ar_bridge_a_full;

%% F1: Get Shock Grids

[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);

%% FIBS1: Get Equations

[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_coh_fbis, f_coh_save, f_cons] = ...
    ffs_ipwkbz_fibs_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_w, fl_r_fbr, fl_r_fsv);

%% FIBS2: Get Formal Borrowing Blocks

[ar_forbrblk, ar_forbrblk_r] = ...
        ffs_for_br_block_gen(fl_r_fbr, st_forbrblk_type, fl_forbrblk_brmost, fl_forbrblk_brleast, fl_forbrblk_gap);

%% Find Formal and Informal Choices for Borrowing points
% Here we solve for the optimal formal and informal choices given b. Note
% that kind of like the static firm's maximization problem. Here the
% optimization problem is static, and can be done independently of the
% overall dynamic optimization problem.

% When borrowing index and array
% note index for negative is from _ar_a_meshk_full_, but value from
% _ar_a_nobridge_meshk_. Index from _ar_a_meshk_full_, which means at some
% of these points _ar_a_nobridge_meshk_ = 0. But need to use
% _ar_bl_ameshk_neg_idx_ because *f_coh_fbis* function below applies to all
% borrowing.
ar_bl_ameshk_neg_idx = (ar_a_meshk_full < 0);
ar_a_meshk_nobridge_aneg = ar_a_nobridge_meshk(ar_bl_ameshk_neg_idx);

% Given b, solve for optimal formal and informal choices.
bl_input_override = true;
[~, ar_inf_borr_nobridge_aneg, ar_for_borr_aneg, ar_for_save_aneg] = ...
   ffs_fibs_min_c_cost(bl_b_is_principle, fl_r_inf, fl_r_fsv, ...
                         ar_forbrblk_r, ar_forbrblk, ...
                         ar_a_meshk_nobridge_aneg, bl_display_minccost, bl_input_override);

%% FIBS3: Generate C cost Matrix when aggregate savings = k'+b' is negative
% *ar_coh_fbis_aneg*: the consumption cost to t+1 from borrowing in t given
% formal and informal joint choice optimization.
%
% Reachable cash-on-hand borrowing points: N_neg*N^2 rows
%
% Additionally, need to convert borrowing choices to consumption units next
% period. borrowing choices in percentage are in unit of last period
% borrowing, principles only, need to convert to interest rates plus
% principle which means considering which formal informal choice
% combination maximizes cash-on-hand for the same level of overall
% principles.
%
% Construct another percentage, which is, percentages of ar_a_meshk_full
% when w < 0. Percentage represents what fraction of the a debt is going
% towards bridge loan debts. Note that as long as w < 0, b < 0 must be the
% case as well. So for negative elements of w, there is a triple mesh: N
% points for A x N points for K x N points for Bridge.
%

ar_coh_fbis_aneg = f_coh_fbis(fl_r_inf, ...
                                ar_for_borr_aneg, ...
                                ar_inf_borr_nobridge_aneg + ar_bridge_a(ar_bl_ameshk_neg_idx), ...
                                ar_for_save_aneg);

%% FIBS3: Generate C cost Cash-on-Hand/State Matrix when aggregate savings is positive
% *ar_coh_save_apos*: the consumption gain to t+1 from savings in t

ar_a_meshk_apos = ar_a_meshk(~ar_bl_ameshk_neg_idx);
ar_coh_save_apos = f_coh_save(ar_a_meshk_apos);

%% COH1: Combine overall Reachable Cash-on-Hand Levels
% N_neg*N^2 + N_pos*N rows total row count, and N_z shock column count.
% These are the cash-on-hand points reachable given percentage grid choice
% structure and the possibility of bridge loans.

ar_ameshk_tnext_with_r = zeros(size(ar_k_mesha));
ar_ameshk_tnext_with_r(ar_bl_ameshk_neg_idx) = ar_coh_fbis_aneg;
ar_ameshk_tnext_with_r(~ar_bl_ameshk_neg_idx) = ar_coh_save_apos;

mt_coh_wkb_full = f_coh(ar_z, ar_ameshk_tnext_with_r, ar_k_mesha);

if (bl_display_funcgrids)

    % Generate Aggregate Variables
    ar_aplusk_mesha = ar_a_meshk + ar_k_mesha;
    ar_bwithrplusk_mesha = ar_ameshk_tnext_with_r + ar_k_mesha;

    % Genereate Table
    tab_ak_choices = array2table([ar_bwithrplusk_mesha, ar_aplusk_mesha, ...
        ar_k_mesha, ar_ameshk_tnext_with_r, ar_a_meshk, ar_a_nobridge_meshk, ar_bridge_a]);
    cl_col_names = {'ar_bwithrplusk_mesha', 'ar_aplusk_mesha', ...
        'ar_k_mesha', 'ar_ameshk_tnext_with_r', 'ar_a_meshk', 'ar_a_nobridge_meshk', 'ar_bridge_a'};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_bwithrplusk_mesha'} = ...
        '*ar_bwithrplusk_mesha*: ';
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesha'} = ...
        '*ar_aplusk_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha'} = ...
        '*ar_k_mesha*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_ameshk_tnext_with_r'} = ...
        '*ar_ameshk_tnext_with_r*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk'} = ...
        '*ar_a_meshk*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_nobridge_meshk'} = ...
        '*ar_aprime_nobridge*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_bridge_a'} = ...
        '*ar_bridge_a*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('tab_ak_choices');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

end

%% COH2: Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));

%% COH3: Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% COH4: Select only Valid (k(w), a) choices

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;

% This is borrowing with default or not condition
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

% 1. Given COH grid, w choices in terms of cash-on-hand percentages
if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end

% 2. Some w < 0, some w > 0. When w < 0, coh > 0 or coh < 0 both possible.
% Need to interplate in ff_ipwkbz_fibs_vecsv differently for w < 0 because
% there both w as well as coh matters, if coh < 0 and w < 0, a fraction of
% w goes to getting informal bridge loans.
mt_bl_w_by_interp_coh_interp_grid_wneg = (mt_w_by_interp_coh_interp_grid < 0);
mt_w_by_interp_coh_interp_grid_wneg = mt_w_by_interp_coh_interp_grid(mt_bl_w_by_interp_coh_interp_grid_wneg);
mt_w_by_interp_coh_interp_grid_wpos = mt_w_by_interp_coh_interp_grid(~mt_bl_w_by_interp_coh_interp_grid_wneg);

%% Generate 1st Stage Choices: Percent of W for Covering Bridge Loans
% If bridge loan does not matter, do not need to cover bridge loan. Then
% these percentages should reflect what happens when param_map('bl_bridge')
% = false, and, param_map('it_coh_bridge_perc_n') = 1;

% 1. Expand cash-on-hand by w_perc grid
mt_interp_coh_grid_mesh_w_perc = zeros(size(mt_w_by_interp_coh_interp_grid)) + ar_interp_coh_grid;

% 2. How much is coh as perc of w_perc grid level choice based on w_perc
mt_coh_w_perc_ratio = (1-(mt_interp_coh_grid_mesh_w_perc./mt_w_by_interp_coh_interp_grid));

% 3. The ratio only relevant for where w < 0 and where coh < 0. Note the
% ratio we want is: ar_coh_bridge_perc, which is percent of w NOT going to
% bridge.
mt_coh_w_perc_ratio(mt_interp_coh_grid_mesh_w_perc >= 0) = 1;
mt_coh_w_perc_ratio_wneg = mt_coh_w_perc_ratio(mt_bl_w_by_interp_coh_interp_grid_wneg);

%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): 2nd Stage Problem Arrays and Matrixes
% ar_a_meshk is t: b
% ar_ameshk_tnext_with_r is t+1: b*(1+r) with for inf
% ar_coh_bridge_perc: this is percentage of w NOT for bridge loan

armt_map('ar_coh_bridge_perc') = ar_coh_bridge_perc;
armt_map('ar_ak_perc') = ar_ak_perc;
armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_ameshk_tnext_with_r') = ar_ameshk_tnext_with_r;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('it_ameshk_n') = length(ar_a_meshk);
armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_z_mesh_coh_wkb') = mt_z_mesh_coh_wkb;

%% Store armt_map (2): First Stage Aggregate Savings
% w = k' + b', w is aggregate Savings
%
% # *ar_w_perc* 1st stage, percentage w choice given coh, at each coh level
% the number of choice points is the same for this problem with percentage
% grid points.
% # *ar_w_level* 2nd stage, level of w over which we solve the optimal
% percentage k' choices. Need to generate interpolant based on this so that
% we know optimal k* given ar_w_perc(coh) in the 1st stage
% # *ar_w_level_full*: in
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/solve/html/ff_ipwkbz_vf_vecsv.html
% ff_ipwkbz_vf_vecsv>, _ar_w_level_ and _ar_w_level_full_ were the same.
% Now have this thing which is stored (length(ar_w_level_full)) by
% (length(ar_z)). _ar_w_level_full_ includes not just different levels of
% _ar_w_level_, but also repeats the elements of _ar_w_level_ that are < 0
% by _it_coh_bridge_perc_n_ times, starting with what corresponds to 100
% percent of w should go to cover bridge loan, until 0 percent for w < 0,
% which then proceeds to w > 0. So the last segment of _ar_w_level_full_ is
% the same as ar_w_level: ar_w_level_full((end-length(ar_w_level)+1):end) =
% ar_w_level.
% # *mt_w_by_interp_coh_interp_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_w_level') = ar_w_level;
armt_map('ar_w_level_full') = ar_w_level_full;

armt_map('mt_w_level_neg_mesh_coh_bridge_perc') = mt_w_level_neg_mesh_coh_bridge_perc;
armt_map('mt_coh_bridge_perc_mesh_w_level_neg') = mt_coh_bridge_perc_mesh_w_level_neg;

armt_map('mt_w_by_interp_coh_interp_grid') = mt_w_by_interp_coh_interp_grid;
armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;

armt_map('mt_bl_w_by_interp_coh_interp_grid_wneg') = mt_bl_w_by_interp_coh_interp_grid_wneg;
armt_map('mt_w_by_interp_coh_interp_grid_wneg') = mt_w_by_interp_coh_interp_grid_wneg;
armt_map('mt_w_by_interp_coh_interp_grid_wpos') = mt_w_by_interp_coh_interp_grid_wpos;
armt_map('mt_coh_w_perc_ratio_wneg') = mt_coh_w_perc_ratio_wneg;

%% Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;
armt_map('mt_z_mesh_coh_interp_grid') = mt_z_mesh_coh_interp_grid;

%% Store armt_map (4): Shock Grids

armt_map('mt_z_trans') = mt_z_trans;
armt_map('ar_stationary') = ar_stationary;
armt_map('ar_z') = ar_z;

%% Store armt_map (5): Formal grid
armt_map('ar_forbrblk') = ar_forbrblk;
armt_map('ar_forbrblk_r') = ar_forbrblk_r;

%% Store Function Map

func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_coh_fbis') = f_coh_fbis;
func_map('f_coh_save') = f_coh_save;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.
    %
    % Plot end because earlier parts have repeating w and a levels due to
    % potentially bridge which are coh percentage dependent. This will only
    % plot out the grid basically when coh percentage for bridge loan = 0
    %

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    it_col_end = size(mt_a, 2);
    it_col_start = size(mt_a, 2) - length(ar_w_level) + 1;

    chart = plot(mt_a(:,it_col_start:it_col_end), ...
                 mt_k(:,it_col_start:it_col_end), ...
                 'blue');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    it_col_end = length(ar_a_meshk);
    it_col_start = length(ar_a_meshk) - length(ar_w_level)*it_ak_perc_n + 1;

%     if (length(ar_w_level_full) <= 100)
    scatter(ar_a_meshk(it_col_start:it_col_end), ...
            ar_k_mesha(it_col_start:it_col_end), ...
            3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level) <= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),...
                                     ar_k_mesha_full(ar_bl_wkb_invalid),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title({'Risky K Percentage Grids Given w=k+a (2nd Stage)'...
           '(Bridge Borrow Share = 0)'})
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end

    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
        'Each Segment is a w=k+b; within segment increasing k'...
        'For each w and z, coh maximizing k is different'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));

    legendCell{length(legendCell) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z));
    disp(ar_z);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_coh_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_coh_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_c_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_c_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_interp_coh_grid_mesh_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_a');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_a_meshk');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_a_meshk));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_k');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_k_mesha');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    for i = 1:length(func_map)
        st_display = strjoin(['pos =' num2str(i) '; key =' string(param_map_keys{i}) '; val =' func2str(param_map_vals{i})]);
        disp(st_display);
    end

end

%% Display

if (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
end

end

##### SOURCE END #####
--></body></html>