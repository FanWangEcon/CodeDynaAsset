
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Solve For+Inf+Borr+Save Dynamic Programming Problem (Loop)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-07"><meta name="DC.source" content="ff_abz_fibs_vf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Solve For+Inf+Borr+Save Dynamic Programming Problem (Loop)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_ABZ_FIBS_VF borr + save one asset formal informal + loop</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Display Parameters</a></li><li><a href="#7">Initialize Output Matrixes</a></li><li><a href="#8">Initialize Convergence Conditions</a></li><li><a href="#9">Iterate Value Function</a></li><li><a href="#11">Iterate over a and z states</a></li><li><a href="#14">Compute Consumption given Borrowing and Savings</a></li><li><a href="#15">Compute Utility With Default</a></li><li><a href="#16">Store Values</a></li><li><a href="#18">Optimize over Next Period Asset Choices</a></li><li><a href="#19">Find Optimal Choices for Defaults or Not</a></li><li><a href="#20">Store Optimal Choices and Value Given(a,z)</a></li><li><a href="#22">Check Tolerance and Continuation</a></li><li><a href="#24">Process Optimal Choices</a></li><li><a href="#25">Post Solution Graph and Table Generation</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_abz_fibs_vf(varargin)
</pre><h2 id="2">FF_ABZ_FIBS_VF borr + save one asset formal informal + loop</h2><p>This program solves the infinite horizon dynamic single asset and single shock problem with loops. This file contains codes that processes borrowing and handles formal and informal choices.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>mt_cons matrix states_n by shock_n matrix of optimal consumption levels, unlike modele without formal and informal choices, where we know c from coh and a, here this needed to be stored because it is the results from with joint category maximization problem.</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc/html/ffs_abz_fibs_set_default_param.html">ffs_abz_fibs_set_default_param</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc/html/ffs_abz_fibs_get_funcgrid.html">ffs_abz_fibs_get_funcgrid</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_min_c_cost_bridge.html">ffs_fibs_min_c_cost_bridge</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_inf_bridge.html">ffs_fibs_inf_bridge</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_min_c_cost.html">ffs_fibs_min_c_cost</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html">ff_az_vf_post</a></li></ul></div><p>@seealso</p><div><ul><li>for/inf + save + borr loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf.html">ff_abz_fibs_vf</a></li><li>for/inf + borr vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf_vec.html">ff_abz_fibs_vf_vec</a></li><li>for/inf + borr optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf_vecsv.html">ff_abz_fibs_vf_vecsv</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_abz_fibs_set_default_param(it_param_set);

<span class="comment">% Note: param_map and support_map can be adjusted here or outside to override defaults</span>
<span class="comment">% To generate results as if formal informal do not matter</span>
param_map(<span class="string">'it_a_n'</span>) = 75;
param_map(<span class="string">'fl_z_r_borr_n'</span>) = 3;
param_map(<span class="string">'it_z_wage_n'</span>) = 5;
param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);
<span class="comment">% param_map('fl_r_fsv') = 0.025;</span>
<span class="comment">% param_map('fl_r_fbr') = 0.035;</span>
<span class="comment">% param_map('bl_b_is_principle') = false;</span>
<span class="comment">% param_map('st_forbrblk_type') = 'seg3';</span>
<span class="comment">% param_map('fl_forbrblk_brmost') = -19;</span>
<span class="comment">% param_map('fl_forbrblk_brleast') = -1;</span>
<span class="comment">% param_map('fl_forbrblk_gap') = -1.5;</span>
<span class="comment">% param_map('bl_b_is_principle') = false;</span>

[armt_map, func_map] = ffs_abz_fibs_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_abz_fibs_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_abz_fibs_vf'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'mt_z_trans'</span>, <span class="string">'ar_z_r_borr_mesh_wage'</span>, <span class="string">'ar_z_wage_mesh_r_borr'</span>});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

<span class="comment">% Formal choice Menu/Grid and Interest Rate Menu/Grid</span>
params_group = values(armt_map, {<span class="string">'ar_forbrblk_r'</span>, <span class="string">'ar_forbrblk'</span>});
[ar_forbrblk_r, ar_forbrblk] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_coh'</span>, <span class="string">'f_cons_coh_fbis'</span>, <span class="string">'f_cons_coh_save'</span>});
[f_util_log, f_util_crra, f_coh, f_cons_coh_fbis, f_cons_coh_save] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'it_a_n'</span>, <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>,<span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'bl_default'</span>, <span class="string">'bl_bridge'</span>, <span class="string">'bl_rollover'</span>, <span class="string">'fl_default_aprime'</span>});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, <span class="keyword">...</span>
    fl_nan_replace, bl_default, bl_bridge, bl_rollover, fl_default_aprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% param_map, Formal informal</span>
params_group = values(param_map, {<span class="string">'fl_r_fsv'</span>, <span class="string">'bl_b_is_principle'</span>});
[fl_r_fsv, bl_b_is_principle] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_display_minccost'</span>, <span class="string">'bl_display_infbridge'</span>, <span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display_defparam'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_display_minccost, bl_display_infbridge, <span class="keyword">...</span>
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Display Parameters</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_defparam)
    fft_container_map_display(param_map);
    fft_container_map_display(support_map);
<span class="keyword">end</span>
</pre><pre class="codeoutput">  Map with properties:

        Count: 42
      KeyType: char
    ValueType: any

pos = 1 ; key = bl_b_is_principle ; val = false
pos = 2 ; key = bl_bridge ; val = true
pos = 3 ; key = bl_default ; val = true
pos = 4 ; key = bl_loglin ; val = false
pos = 5 ; key = bl_rollover ; val = true
pos = 6 ; key = fl_a_max ; val = 50
pos = 7 ; key = fl_a_min ; val = 0
pos = 8 ; key = fl_b_bd ; val = -20
pos = 9 ; key = fl_beta ; val = 0.94
pos = 10 ; key = fl_c_min ; val = 0.02
pos = 11 ; key = fl_crra ; val = 1.5
pos = 12 ; key = fl_default_aprime ; val = 0
pos = 13 ; key = fl_forbrblk_brleast ; val = -1
pos = 14 ; key = fl_forbrblk_brmost ; val = -19
pos = 15 ; key = fl_forbrblk_gap ; val = -1.5
pos = 16 ; key = fl_loglin_threshold ; val = 1
pos = 17 ; key = fl_nan_replace ; val = -99999
pos = 18 ; key = fl_r_fbr ; val = 0.065
pos = 19 ; key = fl_r_fsv ; val = 0.025
pos = 20 ; key = fl_tol_dist ; val = 1e-05
pos = 21 ; key = fl_tol_pol ; val = 1e-05
pos = 22 ; key = fl_tol_val ; val = 1e-05
pos = 23 ; key = fl_w ; val = 1.28
pos = 24 ; key = fl_z_r_borr_max ; val = 0.095
pos = 25 ; key = fl_z_r_borr_min ; val = 0.025
pos = 26 ; key = fl_z_r_borr_n ; val = 3
pos = 27 ; key = fl_z_r_borr_poiss_mean ; val = 20
pos = 28 ; key = fl_z_wage_mu ; val = 0
pos = 29 ; key = fl_z_wage_rho ; val = 0.8
pos = 30 ; key = fl_z_wage_sig ; val = 0.2
pos = 31 ; key = it_a_n ; val = 75
pos = 32 ; key = it_maxiter_dist ; val = 1000
pos = 33 ; key = it_maxiter_val ; val = 1000
pos = 34 ; key = it_tol_pol_nochange ; val = 25
pos = 35 ; key = it_trans_power_dist ; val = 1000
pos = 36 ; key = it_z_n ; val = 15
pos = 37 ; key = it_z_wage_n ; val = 5
pos = 38 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 39 ; key = st_forbrblk_type ; val = seg3
pos = 40 ; key = st_model ; val = abz_fibs
pos = 41 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 42 ; key = st_z_r_borr_drv_prb_type ; val = poiss
  Map with properties:

        Count: 43
      KeyType: char
    ValueType: any

pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_final ; val = true
pos = 5 ; key = bl_display_final_dist ; val = false
pos = 6 ; key = bl_display_final_dist_detail ; val = false
pos = 7 ; key = bl_display_funcgrids ; val = false
pos = 8 ; key = bl_display_infbridge ; val = false
pos = 9 ; key = bl_display_minccost ; val = false
pos = 10 ; key = bl_graph ; val = true
pos = 11 ; key = bl_graph_coh_t_coh ; val = true
pos = 12 ; key = bl_graph_discrete ; val = true
pos = 13 ; key = bl_graph_forinf_discrete ; val = true
pos = 14 ; key = bl_graph_forinf_pol_lvl ; val = true
pos = 15 ; key = bl_graph_forinf_pol_pct ; val = true
pos = 16 ; key = bl_graph_funcgrids ; val = false
pos = 17 ; key = bl_graph_onebyones ; val = true
pos = 18 ; key = bl_graph_pol_lvl ; val = true
pos = 19 ; key = bl_graph_pol_pct ; val = true
pos = 20 ; key = bl_graph_val ; val = true
pos = 21 ; key = bl_img_save ; val = false
pos = 22 ; key = bl_mat ; val = false
pos = 23 ; key = bl_post ; val = true
pos = 24 ; key = bl_profile ; val = false
pos = 25 ; key = bl_profile_dist ; val = false
pos = 26 ; key = bl_time ; val = false
pos = 27 ; key = it_display_every ; val = 5
pos = 28 ; key = it_display_final_colmax ; val = 15
pos = 29 ; key = it_display_final_rowmax ; val = 100
pos = 30 ; key = st_img_name_main ; val = ff_abz_fibs_vf_default
pos = 31 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_abz_solve/img/
pos = 32 ; key = st_img_prefix ; val = 
pos = 33 ; key = st_img_suffix ; val = _p4.png
pos = 34 ; key = st_mat_name_main ; val = ff_abz_fibs_vf_default
pos = 35 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_abz_solve/mat/
pos = 36 ; key = st_mat_prefix ; val = 
pos = 37 ; key = st_mat_suffix ; val = _p4
pos = 38 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_fibs/
pos = 39 ; key = st_profile_name_main ; val = ff_abz_fibs_vf_default
pos = 40 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_fibs//m_abz_solve/profile/
pos = 41 ; key = st_profile_prefix ; val = 
pos = 42 ; key = st_profile_suffix ; val = _p4
pos = 43 ; key = st_title_prefix ; val = 
</pre><h2 id="7">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(it_a_n,it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n,it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_cons = zeros(it_a_n,it_z_n);

<span class="comment">% collect optimal borrowing formal and informal choices</span>
mt_pol_b_bridge = zeros(it_a_n,it_z_n);
mt_pol_inf_borr_nobridge = zeros(it_a_n,it_z_n);
mt_pol_for_borr = zeros(it_a_n,it_z_n);
mt_pol_for_save = zeros(it_a_n,it_z_n);
</pre><h2 id="8">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="9">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Utility at-Default/at-limiting-case-when-nodefault</span>
<span class="keyword">if</span> (fl_crra == 1)
    fl_u_cmin = f_util_log(fl_c_min);
<span class="keyword">else</span>
    fl_u_cmin = f_util_crra(fl_c_min);
<span class="keyword">end</span>


<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="11">Iterate over a and z states</h2><p>handling borrowing and default possibility</p><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n

        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        <span class="comment">% loop 2: over endogenous states</span>
        <span class="keyword">for</span> it_a_j = 1:it_a_n
</pre><pre class="codeinput">            <span class="comment">% Get asset state</span>
            fl_a = ar_a(it_a_j);

            <span class="comment">% Initialize storage</span>
            ar_val_cur = zeros(size(ar_a));
            ar_c_cur = zeros(size(ar_a));
            ar_b_bridge = zeros(size(ar_a));
            ar_inf_borr_nobridge = zeros(size(ar_a));
            ar_for_borr = zeros(size(ar_a));
            ar_for_save = zeros(size(ar_a));

            <span class="comment">% calculate cash on hand</span>
            fl_coh = f_coh(fl_z_wage, fl_a);

            <span class="comment">% loop 3: over choices</span>
            <span class="keyword">for</span> it_ap_k = 1:it_a_n
</pre><pre class="codeinput">                <span class="comment">% get next period asset choice</span>
                fl_ap = ar_a(it_ap_k);
</pre><h2 id="14">Compute Consumption given Borrowing and Savings</h2><p>find the today's consumption maximizing formal and informal choices given a' and coh. The formal and informal choices need to generate exactly a', but depending on which formal and informal joint choice is used, the consumption cost today a' is different. Note here, a is principle + interests. Three areas:</p><div><ul><li><b>CASE A</b> a' &gt; 0: savings, do not need to optimize over formal and informal choices</li><li><b>CASE B</b> a' &lt; 0 &amp; coh &lt; 0: need bridge loan to pay for unpaid debt, and borrowing over-all, need to first pick bridge loan to pay for debt, if bridge loan is insufficient, go into default. After bridge loan, optimize over formal+informal, borrow+save joint choices.</li><li><b>CASE C</b> $ a' &lt; 0 &amp; coh &gt; 0: do not need to get informal bridge loans, optimize over for+inf save, for+save+borr, inf+borr only, for borrow only.</li></ul></div><pre class="codeinput">                <span class="keyword">if</span> (fl_ap &lt; 0)

                    <span class="comment">% Calculate Bridge Loan Borrowing</span>
                    <span class="keyword">if</span> (bl_bridge &amp;&amp; fl_coh &lt; 0)

                        bl_input_override = true;
                        [fl_aprime_nobridge, fl_b_bridge, fl_c_bridge] = ffs_fibs_inf_bridge(<span class="keyword">...</span>
                            bl_b_is_principle, fl_z_r_borr, fl_ap, fl_coh, <span class="keyword">...</span>
                            bl_display_infbridge, bl_input_override);

                    <span class="keyword">else</span>

                        fl_aprime_nobridge = fl_ap;
                        fl_b_bridge = 0;
                        fl_c_bridge = 0;

                    <span class="keyword">end</span>

                    <span class="comment">% Find Optimal Formal Informal Borrow Save Combo</span>
                    <span class="comment">% calculate consumption gain from formal + informal</span>
                    <span class="comment">% borrowing and savings choices.</span>
                    bl_input_override = true;
                    [fl_max_c_nobridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = <span class="keyword">...</span>
                        ffs_fibs_min_c_cost(<span class="keyword">...</span>
                        bl_b_is_principle, fl_z_r_borr, fl_r_fsv, <span class="keyword">...</span>
                        ar_forbrblk_r, ar_forbrblk, <span class="keyword">...</span>
                        fl_aprime_nobridge, bl_display_minccost, bl_input_override);

                    <span class="comment">% Compute Consumption given Formal and Informal joint</span>
                    <span class="comment">% consumption with formal borrow menu + bridge loans.</span>
                    fl_c = f_cons_coh_fbis(fl_coh, fl_max_c_nobridge + fl_c_bridge);

                <span class="keyword">else</span>

                    <span class="comment">% consumption with savings</span>
                    fl_c = f_cons_coh_save(fl_coh, fl_ap);

                    <span class="comment">% assign values for formal and informal choices</span>
                    <span class="comment">% possible that fl_coh &lt; 0, but if then fl_ap &gt; 0 is</span>
                    <span class="comment">% not valid choice</span>
                    [fl_b_bridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = deal(0, 0, 0, fl_ap);

                <span class="keyword">end</span>
</pre><h2 id="15">Compute Utility With Default</h2><p>if rollover is not allowed and bridge is not allowed, then as long as coh &lt;= 0, also treat as not allowed states. assign u(c)</p><pre class="codeinput">                <span class="keyword">if</span> (fl_c &lt;= fl_c_min || <span class="keyword">...</span>
                    ( ~bl_rollover &amp;&amp; ~bl_bridge &amp;&amp; fl_coh &lt; fl_c_min))

                    <span class="keyword">if</span> (bl_default)
                        <span class="comment">% defaults</span>
                        <span class="comment">% current utility: only today u(cmin)</span>
                        ar_val_cur(it_ap_k) = fl_u_cmin;
                        <span class="comment">% transition out next period, debt wiped out</span>
                        <span class="keyword">for</span> it_az_q = 1:it_z_n
                            ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + <span class="keyword">...</span>
                                fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur((ar_a == fl_default_aprime), it_az_q);
                        <span class="keyword">end</span>

                        <span class="comment">% Replace Consumption if default cmin</span>
                        fl_c = fl_c_min;
                    <span class="keyword">else</span>
                        <span class="comment">% if default is not allowed: v = fl_nan_replace</span>
                        ar_val_cur(it_ap_k) = fl_nan_replace;

                        <span class="comment">% Replace Consumption if no default nan</span>
                        fl_c = 0;
                    <span class="keyword">end</span>

                    <span class="comment">% no action, defaulting</span>
                    fl_b_bridge = 0;
                    fl_inf_borr_nobridge = 0;
                    fl_for_borr = 0;
                    fl_for_save = 0;

                <span class="keyword">else</span>
                    <span class="comment">% Solve Optimization Problem: max_{a'} u(c(a,a',z)) + beta*EV(a',z')</span>
                    <span class="comment">% borrowed enough to pay debt (and borrowing limit not exceeded)</span>
                    <span class="comment">% saved only the coh available.</span>
                    <span class="comment">% current utility</span>
                    <span class="keyword">if</span> (fl_crra == 1)
                        ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    <span class="keyword">else</span>
                        ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    <span class="keyword">end</span>
                    <span class="comment">% loop 4: add future utility, integration--loop over future shocks</span>
                    <span class="keyword">for</span> it_az_q = 1:it_z_n
                        ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + <span class="keyword">...</span>
                            fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur(it_ap_k, it_az_q);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
</pre><h2 id="16">Store Values</h2><pre class="codeinput">                <span class="comment">% Could get the formal and informal values from</span>
                <span class="comment">% ffs_fibs_min_c_cost_bridge.m</span>
<span class="comment">%                 bl_input_override = true;</span>
<span class="comment">%                 [fl_c, fl_b_bridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = ...</span>
<span class="comment">%                     ffs_fibs_min_c_cost_bridge(fl_ap, fl_coh, ...</span>
<span class="comment">%                     param_map, support_map, armt_map, func_map, bl_input_override);</span>

                <span class="comment">% Store consumption</span>
                ar_c_cur(it_ap_k) = fl_c;

                <span class="comment">% Save/Update Borrowing Information</span>
                ar_b_bridge(it_ap_k) = fl_b_bridge;
                ar_inf_borr_nobridge(it_ap_k) = fl_inf_borr_nobridge;
                ar_for_borr(it_ap_k) = fl_for_borr;
                ar_for_save(it_ap_k) = fl_for_save;
</pre><pre class="codeinput">            <span class="keyword">end</span>
</pre><h2 id="18">Optimize over Next Period Asset Choices</h2><p>optimal choice value</p><pre class="codeinput">            [fl_opti_val_z, fl_opti_idx_z] = max(ar_val_cur);
            fl_opti_aprime_z = ar_a(fl_opti_idx_z);
            fl_opti_c_z = ar_c_cur(fl_opti_idx_z);

            <span class="comment">% corresponding optimal borrowing and savings choices</span>
            fl_opti_b_bridge = ar_b_bridge(fl_opti_idx_z);
            fl_opti_inf_borr_nobridge = ar_inf_borr_nobridge(fl_opti_idx_z);
            fl_opti_for_borr = ar_for_borr(fl_opti_idx_z);
            fl_opti_for_save = ar_for_save(fl_opti_idx_z);
</pre><h2 id="19">Find Optimal Choices for Defaults or Not</h2><p>Handle Default is optimal or not</p><pre class="codeinput">            <span class="keyword">if</span> (fl_opti_c_z &lt;= fl_c_min)
                <span class="keyword">if</span> (bl_default)
                    <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
                    <span class="comment">% to default, non-default possible, but default could be optimal</span>
                    fl_opti_aprime_z = fl_default_aprime;
                <span class="keyword">else</span>
                    <span class="comment">% if default is not allowed, then next period same state as now</span>
                    <span class="comment">% this is absorbing state, this is the limiting case, single</span>
                    <span class="comment">% state space point, lowest a and lowest shock has this.</span>
                    fl_opti_aprime_z = min(ar_a);
                <span class="keyword">end</span>
            <span class="keyword">end</span>
</pre><h2 id="20">Store Optimal Choices and Value Given(a,z)</h2><pre class="codeinput">            <span class="comment">% store overal savings, value and consumption</span>
            mt_val(it_a_j,it_z_i) = fl_opti_val_z;
            mt_pol_a(it_a_j,it_z_i) = fl_opti_aprime_z;
            mt_pol_cons(it_a_j,it_z_i) = fl_opti_c_z;

            <span class="comment">% store savings and borrowing formal and inf optimal choices</span>
            mt_pol_b_bridge(it_a_j,it_z_i) = fl_opti_b_bridge;
            mt_pol_inf_borr_nobridge(it_a_j,it_z_i) = fl_opti_inf_borr_nobridge;
            mt_pol_for_borr(it_a_j,it_z_i) = fl_opti_for_borr;
            mt_pol_for_save(it_a_j,it_z_i) = fl_opti_for_save;
</pre><pre class="codeinput">        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="22">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_a_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_a_n,:), highest a state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><h2 id="24">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;

result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_coh'</span>) = {f_coh(ar_z_r_borr_mesh_wage, ar_a'), zeros(1)};

result_map(<span class="string">'cl_mt_pol_c'</span>) = {mt_pol_cons, zeros(1)};
result_map(<span class="string">'cl_mt_pol_b_bridge'</span>) = {mt_pol_b_bridge, zeros(1)};
result_map(<span class="string">'cl_mt_pol_inf_borr_nobridge'</span>) = {mt_pol_inf_borr_nobridge, zeros(1)};
result_map(<span class="string">'cl_mt_pol_for_borr'</span>) = {mt_pol_for_borr, zeros(1)};
result_map(<span class="string">'cl_mt_pol_for_save'</span>) = {mt_pol_for_save, zeros(1)};

result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_pol_coh"</span>, <span class="string">"cl_mt_pol_c"</span>, <span class="keyword">...</span>
    <span class="string">"cl_mt_pol_b_bridge"</span>, <span class="string">"cl_mt_pol_inf_borr_nobridge"</span>, <span class="string">"cl_mt_pol_for_borr"</span>, <span class="string">"cl_mt_pol_for_save"</span>];

<span class="comment">% Get Discrete Choice Outcomes</span>
result_map = ffs_fibs_identify_discrete(result_map, bl_input_override);
</pre><h2 id="25">Post Solution Graph and Table Generation</h2><p>Note in comparison with <b>abz</b>, results here, even when using identical parameters would differ because in <b>abz</b> solved where choices are principle. Here choices are principle + interests in order to facilitate using the informal choice functions.</p><p>Note that this means two things are different, on the one hand, the value of asset for to coh is different based on the grid of assets. If the asset grid is negative, now per grid point, there is more coh because that grid point of asset no longer has interest rates. On the other hand, if one has positive asset grid point on arrival, that is worth less to coh. Additionally, when making choices for the next period, now choices aprime includes interests. What these mean is that the a grid no longer has the same meaning. We should expect at higher savings levels, for the same grid points, if optimal grid choices are the same as before, consumption should be lower when b includes interest rates and principle. This is however, not true when arriving in a period with negative a levels, for the same negative a level and same a prime negative choice, could have higher consumption here becasue have to pay less interests on debt. This tends to happen for smaller levels of borrowing choices.</p><p>Graphically, when using interest + principle, big difference in consumption as a fraction of (coh - aprime) figure. In those figures, when counting in principles only, the gap in coh and aprime is consumption, but now, as more is borrowed only a small fraction of coh and aprime gap is consumption, becuase aprime/(1+r) is put into consumption.</p><pre class="codeinput"><span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    <span class="comment">% Standard AZ graphs</span>
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);

    <span class="comment">% Graphs for results_map with FIBS contents</span>
    result_map = ff_az_fibs_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n): percentage of state space points conditional on shock where the policy function is changing across iterations
                 valgap     polgap    zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                ________    ______    _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    iter=1        58.345    633.35                  1                          1                         1                          1                        1                         1                        1                         1                        1                        1                          1                          1                           1                          1                          1       
    iter=2        47.645    689.78            0.98667                          1                   0.98667                          1                        1                   0.98667                  0.98667                         1                  0.98667                        1                    0.97333                    0.97333                     0.98667                    0.98667                          1       
    iter=3        37.776    228.25               0.96                    0.98667                   0.98667                    0.97333                        1                      0.96                     0.96                   0.98667                     0.96                  0.98667                    0.94667                       0.96                        0.96                       0.96                    0.98667       
    iter=4         30.97    114.27               0.92                    0.93333                      0.92                    0.94667                     0.96                   0.93333                  0.93333                      0.96                  0.93333                  0.94667                    0.90667                       0.92                        0.92                       0.96                       0.96       
    iter=5        25.991    67.494            0.85333                    0.89333                   0.86667                       0.88                  0.90667                      0.88                  0.85333                   0.89333                  0.89333                  0.90667                       0.88                    0.86667                        0.88                    0.90667                       0.92       
    iter=6        22.173    47.265            0.81333                    0.81333                   0.78667                       0.84                  0.82667                   0.81333                  0.81333                   0.78667                  0.81333                  0.81333                    0.81333                    0.82667                     0.78667                    0.81333                    0.82667       
    iter=7        19.023    33.142               0.76                    0.73333                   0.70667                    0.73333                  0.78667                   0.73333                  0.73333                      0.72                     0.72                  0.78667                    0.74667                       0.72                     0.70667                       0.72                       0.76       
    iter=8        16.438    24.767            0.57333                    0.61333                   0.62667                       0.64                     0.68                       0.6                      0.6                   0.62667                     0.64                  0.66667                        0.6                    0.61333                         0.6                       0.64                    0.70667       
    iter=9        14.267    18.695               0.48                       0.48                   0.50667                    0.49333                  0.54667                   0.46667                  0.45333                   0.49333                  0.46667                  0.54667                       0.48                    0.49333                     0.50667                       0.48                    0.53333       
    iter=10       12.436    21.763               0.36                       0.44                       0.4                    0.42667                     0.44                   0.38667                  0.38667                   0.41333                     0.44                  0.42667                        0.4                        0.4                     0.37333                    0.42667                    0.45333       
    iter=11       10.867    13.368            0.30667                       0.32                   0.29333                       0.32                  0.38667                   0.30667                  0.30667                   0.33333                     0.32                     0.36                    0.30667                       0.32                     0.29333                    0.33333                    0.37333       
    iter=12       9.5202    20.669               0.28                       0.28                   0.33333                       0.32                  0.30667                      0.28                  0.29333                   0.30667                  0.26667                  0.29333                       0.32                    0.26667                     0.30667                    0.26667                    0.30667       
    iter=13       8.3615    9.6326            0.18667                       0.24                   0.22667                        0.2                  0.26667                   0.18667                  0.21333                   0.22667                  0.18667                  0.22667                    0.17333                    0.21333                        0.24                    0.18667                    0.22667       
    iter=14       7.3481    8.7881            0.17333                    0.21333                   0.21333                    0.22667                  0.21333                      0.16                     0.16                      0.24                  0.18667                      0.2                    0.17333                       0.16                     0.21333                    0.18667                        0.2       
    iter=15       6.4662    20.252            0.17333                       0.16                   0.14667                    0.18667                  0.21333                   0.18667                  0.14667                   0.18667                  0.17333                  0.22667                    0.18667                    0.14667                     0.18667                    0.18667                        0.2       
    iter=16       5.7104    7.2433           0.093333                    0.14667                   0.14667                    0.14667                  0.17333                      0.12                  0.13333                   0.13333                     0.12                  0.17333                    0.10667                       0.12                     0.13333                       0.12                       0.16       
    iter=17       5.0619    7.5187            0.10667                    0.17333                      0.12                       0.12                     0.16                   0.10667                     0.12                   0.13333                  0.10667                  0.14667                    0.10667                       0.12                        0.12                       0.12                    0.13333       
    iter=18       4.5302     7.083            0.10667                    0.14667                   0.10667                    0.13333                     0.12                  0.093333                     0.12                   0.10667                  0.13333                  0.10667                    0.10667                    0.13333                     0.10667                    0.10667                    0.10667       
    iter=19       4.0886    7.6105            0.10667                       0.08                  0.066667                       0.12                     0.12                      0.12                 0.066667                      0.08                     0.12                  0.14667                    0.10667                   0.066667                    0.066667                    0.10667                    0.14667       
    iter=20       3.7231    6.0347           0.066667                   0.066667                  0.066667                   0.093333                 0.093333                  0.053333                 0.066667                  0.066667                  0.10667                     0.08                   0.066667                   0.066667                        0.08                       0.08                   0.093333       
    iter=21        3.394    4.4301           0.066667                   0.066667                  0.093333                   0.053333                 0.066667                  0.026667                 0.066667                  0.093333                 0.066667                 0.066667                   0.026667                   0.066667                     0.10667                   0.053333                   0.066667       
    iter=22       3.0834    5.3752           0.093333                       0.04                  0.066667                   0.053333                     0.08                  0.066667                 0.053333                      0.08                     0.04                     0.08                       0.08                       0.04                    0.066667                   0.053333                       0.08       
    iter=23       2.7964    5.0571               0.04                   0.053333                  0.093333                       0.08                     0.08                      0.04                 0.053333                  0.093333                 0.066667                     0.08                       0.04                   0.053333                     0.10667                       0.08                       0.08       
    iter=24        2.537    3.9566               0.04                   0.053333                      0.04                   0.053333                     0.04                      0.04                 0.053333                      0.04                 0.053333                     0.04                   0.026667                   0.066667                        0.04                   0.053333                   0.053333       
    iter=25       2.3078    4.7594           0.066667                   0.053333                      0.04                   0.053333                 0.066667                  0.053333                 0.066667                  0.026667                 0.066667                 0.093333                   0.066667                   0.053333                    0.026667                   0.053333                   0.066667       
    iter=26       2.1053    3.5691               0.04                       0.04                      0.04                       0.04                 0.053333                      0.04                     0.04                      0.04                     0.04                 0.053333                       0.04                       0.04                    0.053333                       0.04                   0.053333       
    iter=27       1.9244    3.3715           0.053333                       0.04                  0.026667                       0.04                     0.04                  0.053333                 0.026667                  0.026667                     0.04                     0.04                       0.04                   0.026667                    0.026667                       0.04                       0.04       
    iter=28       1.7658    3.4895           0.026667                   0.013333                      0.04                   0.053333                 0.026667                  0.026667                 0.013333                      0.04                 0.053333                 0.013333                   0.026667                   0.013333                        0.04                   0.053333                   0.013333       
    iter=29       1.6279    2.9335               0.04                   0.026667                  0.026667                   0.013333                 0.026667                      0.04                 0.026667                  0.026667                 0.013333                 0.026667                   0.053333                   0.026667                    0.026667                   0.013333                   0.026667       
    iter=30       1.5082    2.8767           0.013333                   0.013333                      0.04                   0.026667                 0.026667                  0.013333                 0.013333                      0.04                 0.026667                 0.026667                   0.013333                   0.013333                        0.04                   0.026667                   0.026667       
    iter=31       1.4043    2.3488           0.026667                   0.026667                  0.026667                   0.013333                 0.013333                  0.026667                 0.026667                  0.026667                 0.013333                 0.013333                   0.026667                   0.026667                    0.026667                   0.013333                   0.013333       
    iter=32       1.3138    2.3488                  0                   0.013333                  0.013333                   0.013333                 0.026667                  0.013333                 0.013333                  0.013333                 0.013333                 0.026667                          0                   0.013333                    0.013333                   0.013333                   0.026667       
    iter=33       1.2349    2.7052           0.013333                   0.013333                  0.026667                   0.013333                 0.026667                  0.013333                 0.026667                  0.026667                 0.013333                 0.026667                   0.013333                   0.013333                    0.026667                   0.013333                   0.026667       
    iter=34       1.1652    2.3488           0.013333                   0.013333                  0.026667                   0.026667                 0.013333                  0.013333                 0.013333                  0.026667                 0.026667                 0.013333                   0.013333                   0.013333                    0.026667                   0.026667                   0.013333       
    iter=35       1.1027    2.7198                  0                       0.04                  0.013333                   0.013333                 0.013333                         0                 0.026667                  0.013333                 0.013333                 0.013333                          0                   0.026667                    0.013333                   0.013333                   0.013333       
    iter=36       1.0459    1.6609           0.013333                          0                  0.013333                          0                 0.013333                  0.013333                        0                  0.013333                        0                 0.013333                   0.013333                          0                    0.013333                          0                   0.013333       
    iter=37      0.99384    2.3488           0.013333                   0.013333                  0.013333                   0.026667                 0.026667                  0.013333                 0.013333                  0.013333                 0.026667                 0.026667                   0.013333                   0.013333                    0.013333                   0.026667                   0.026667       
    iter=38       0.9452    2.3488                  0                   0.026667                  0.026667                   0.013333                        0                         0                 0.026667                  0.026667                 0.013333                        0                          0                   0.026667                    0.026667                   0.013333                          0       
    iter=39      0.89951    2.3488           0.013333                          0                         0                          0                 0.026667                  0.013333                        0                         0                        0                 0.026667                   0.013333                          0                           0                          0                   0.026667       
    iter=40      0.85623    2.3488                  0                   0.013333                  0.026667                   0.013333                 0.013333                         0                 0.013333                  0.026667                 0.013333                 0.013333                          0                   0.013333                    0.026667                   0.013333                   0.013333       
    iter=41      0.81543    1.6609           0.013333                          0                  0.013333                   0.013333                        0                  0.013333                        0                  0.013333                 0.013333                        0                   0.013333                          0                    0.013333                   0.013333                          0       
    iter=42      0.77671    2.3488                  0                   0.013333                  0.013333                          0                 0.026667                         0                 0.013333                  0.013333                        0                 0.026667                          0                   0.013333                    0.013333                          0                   0.026667       
    iter=43      0.74006    1.6609           0.013333                   0.013333                         0                   0.013333                        0                  0.013333                 0.013333                         0                 0.013333                        0                   0.013333                   0.013333                           0                   0.013333                          0       
    iter=44      0.70531    1.6609                  0                          0                         0                          0                 0.013333                         0                        0                         0                        0                 0.013333                          0                          0                           0                          0                   0.013333       
    iter=45      0.67222    1.6609           0.013333                   0.013333                  0.013333                   0.013333                        0                  0.013333                 0.013333                  0.013333                 0.013333                        0                   0.013333                   0.013333                    0.013333                   0.013333                          0       
    iter=46      0.64062    1.6609                  0                          0                         0                          0                 0.013333                         0                        0                         0                        0                 0.013333                          0                          0                           0                          0                   0.013333       
    iter=47      0.61048    1.6609                  0                   0.013333                         0                   0.013333                 0.013333                         0                 0.013333                         0                 0.013333                 0.013333                          0                   0.013333                           0                   0.013333                   0.013333       
    iter=48      0.58158    1.6609           0.013333                          0                         0                          0                 0.013333                  0.013333                        0                         0                        0                 0.013333                   0.013333                          0                           0                          0                   0.013333       
    iter=49      0.55386    1.6609                  0                          0                         0                   0.013333                        0                         0                        0                         0                 0.013333                        0                          0                          0                           0                   0.013333                          0       
    iter=50      0.52719    1.6609                  0                   0.013333                         0                          0                 0.013333                         0                 0.013333                         0                        0                 0.013333                          0                   0.013333                           0                          0                   0.013333       
    iter=51       0.5015    1.6609           0.013333                          0                         0                   0.013333                        0                  0.013333                        0                         0                 0.013333                        0                   0.013333                          0                           0                   0.013333                          0       
    iter=52      0.47671    1.6609                  0                          0                         0                          0                 0.013333                         0                        0                         0                        0                 0.013333                          0                          0                           0                          0                   0.013333       
    iter=53       0.4528    1.6609                  0                   0.013333                         0                          0                        0                         0                 0.013333                         0                        0                        0                          0                   0.013333                           0                          0                          0       
    iter=54      0.42971    1.6609                  0                          0                         0                   0.013333                        0                         0                        0                         0                 0.013333                        0                          0                          0                           0                   0.013333                          0       
    iter=55       0.4074    1.6609                  0                          0                         0                          0                 0.013333                         0                        0                         0                        0                 0.013333                          0                          0                           0                          0                   0.013333       
    iter=56      0.38591         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=57      0.36521    1.6609                  0                   0.013333                         0                          0                        0                         0                 0.013333                         0                        0                        0                          0                   0.013333                           0                          0                          0       
    iter=58      0.34534    1.6609                  0                          0                         0                   0.013333                        0                         0                        0                         0                 0.013333                        0                          0                          0                           0                   0.013333                          0       
    iter=59      0.32629         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=60      0.30808    1.6609                  0                          0                         0                          0                 0.013333                         0                        0                         0                        0                 0.013333                          0                          0                           0                          0                   0.013333       
    iter=61      0.29071    1.6609                  0                          0                  0.013333                          0                        0                         0                        0                  0.013333                        0                        0                          0                          0                    0.013333                          0                          0       
    iter=62       0.2742         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=63      0.25853         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=64      0.24368         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=65      0.22962         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=66      0.21633         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=67      0.20377         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=68      0.19192         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=69      0.18073         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=70      0.17017         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=71       0.1602         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=72       0.1508         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=73      0.14193         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=74      0.13357    1.6609           0.013333                          0                         0                          0                        0                  0.013333                        0                         0                        0                        0                   0.013333                          0                           0                          0                          0       
    iter=75      0.12568         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=76      0.11825         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=77      0.11124         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=78      0.10464         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=79     0.098423         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=80     0.092567         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=81     0.087055         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=82     0.081867         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=83     0.076984         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=84      0.07239         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=85     0.068068         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=86     0.064002         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=87     0.060177         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=88      0.05658         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=89     0.053197         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=90     0.050014         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=91     0.047022         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=92     0.044207         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=93      0.04156         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=94     0.039072         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=95     0.036731         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=96     0.034531         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=97     0.032462         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=98     0.030516         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=99     0.028687         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    iter=100    0.026967         0                  0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       

tb_val: V(a,z) value at each state space point
                     zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                     _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    a1=-20                    -11.776                   -10.831                   -9.3799                    -7.5992                  -5.6209                   -11.776                  -10.831                    -9.558                   -8.159                  -5.9709                    -11.776                    -10.831                      -9.558                    -8.2417                    -6.2321       
    a2=-19.0411                -10.81                    -9.779                   -8.5337                    -7.2149                  -5.1504                   -11.776                  -10.657                     -8.97                  -7.4452                  -5.4689                    -11.776                    -10.831                      -9.558                    -7.7707                     -5.713       
    a3=-18.0822               -10.173                   -9.3088                   -8.2155                    -6.6808                  -4.6325                   -10.519                  -9.5755                   -8.4039                  -7.0516                  -4.9219                    -11.248                    -10.027                     -8.6735                    -7.2989                    -5.2121       
    a4=-17.1233               -9.8987                   -8.9433                   -7.6582                     -6.193                  -4.1218                   -10.063                  -9.2185                   -8.0166                  -6.5088                  -4.3843                    -10.288                    -9.3995                     -8.2732                    -6.7632                    -4.6665       
    a5=-16.1644               -9.3369                   -8.3919                   -7.2382                    -5.6848                   -3.562                   -9.7867                  -8.7189                    -7.512                  -6.0129                  -3.7995                     -9.948                    -9.0563                     -7.7263                     -6.238                    -4.1305       
    a6=-15.2055               -8.7501                   -7.9518                   -6.7383                    -5.1812                  -3.0003                   -9.0129                  -8.1584                   -7.0317                  -5.4972                  -3.2147                     -9.436                    -8.4527                     -7.2757                    -5.6962                    -3.5095       
    a7=-14.2466               -8.4172                   -7.4548                    -6.279                    -4.6661                  -2.4371                   -8.6191                  -7.7586                   -6.5436                  -4.9574                  -2.6299                    -8.7815                    -7.9712                     -6.7479                    -5.1623                    -2.8813       
    a8=-13.2877               -7.8816                   -6.9771                   -5.7806                    -4.1532                   -1.846                   -8.0983                  -7.2054                   -6.0187                  -4.4129                  -2.0419                    -8.4029                    -7.4298                     -6.2631                    -4.6199                    -2.2561       
    a9=-12.3288                 -7.34                   -6.4694                   -5.3011                    -3.6361                  -1.2129                    -7.536                  -6.7208                   -5.5146                  -3.8668                  -1.4383                    -7.7976                    -6.9165                     -5.7406                    -4.0821                    -1.6203       
    a10=-11.3699              -6.8848                   -5.9691                   -4.8014                    -3.1201                 -0.54132                   -7.0835                  -6.2067                   -4.9922                  -3.3241                 -0.80163                    -7.3013                    -6.3771                     -5.2356                    -3.5422                   -0.95558       
    a11=-10.411               -6.3678                   -5.4582                   -4.3096                     -2.567                  0.12683                   -6.5264                  -5.7005                   -4.4792                  -2.7464                 -0.12709                    -6.7188                    -5.8484                     -4.6847                    -2.9624                   -0.25642       
    a12=-9.45205              -5.8406                   -4.9428                   -3.7849                    -1.9302                  0.79134                    -6.022                  -5.1842                   -3.9347                  -2.0867                  0.54362                    -6.1864                     -5.312                     -4.1075                    -2.2651                      0.436       
    a13=-8.49315              -5.3217                   -4.4185                   -3.2285                    -1.2906                   1.4584                   -5.4733                  -4.6275                   -3.3598                   -1.426                   1.2533                    -5.6129                    -4.7735                     -3.5042                    -1.5721                     1.1219       
    a14=-7.53425              -4.7781                   -3.8834                   -2.6379                    -0.6534                   2.1255                   -4.9507                  -4.0627                   -2.7664                 -0.76915                   1.9601                    -5.0685                    -4.2283                      -2.886                   -0.88749                      1.808       
    a15=-6.57534              -4.2485                   -3.3418                   -2.0293                  -0.020662                   2.7648                   -4.4038                  -3.4939                    -2.163                 -0.11811                   2.6351                    -4.5022                    -3.6569                     -2.2607                    -0.2123                     2.5103       
    a16=-5.61644               -3.698                   -2.7814                   -1.4153                    0.60604                   3.3991                   -3.8712                  -2.9085                   -1.5539                  0.52567                   3.3014                    -3.9524                    -3.0361                     -1.6323                    0.45259                      3.222       
    a17=-4.65753              -3.1397                   -2.1893                   -0.7986                     1.2568                   4.0093                    -3.284                  -2.2934                  -0.93958                   1.1579                   3.9405                    -3.3838                    -2.3909                     -1.0009                     1.1034                     3.8932       
    a18=-3.69863              -2.5602                   -1.5789                  -0.16901                      2.046                   4.5584                   -2.6739                  -1.6618                  -0.28303                   1.9384                   4.5158                    -2.7758                    -1.7336                    -0.36894                     1.8395                     4.4952       
    a19=-2.73973              -1.9551                  -0.95759                   0.64444                     2.7626                   5.0354                   -2.0411                  -1.0209                   0.56462                   2.6971                   5.0166                    -2.1101                    -1.0704                     0.50714                      2.653                     5.0076       
    a20=-1.78082              -1.3169                  -0.27949                    1.4419                     3.4095                   5.4765                   -1.3777                 -0.32463                    1.3928                   3.3811                   5.4765                    -1.4192                   -0.35492                      1.3689                     3.3673                     5.4765       
    a21=-0.821918            -0.64487                   0.43247                    2.1627                      4.015                   5.8611                  -0.68266                   0.4042                    2.1411                    4.015                   5.8611                   -0.70084                    0.39072                      2.1306                      4.015                     5.8611       
    a22=0                   -0.038572                    1.0766                    2.7438                     4.4744                   6.1582                 -0.058147                   1.0623                    2.7438                   4.4744                   6.1582                   -0.06765                     1.0554                      2.7438                     4.4744                     6.1582       
    a23=0.136986             0.053495                    1.1465                     2.842                     4.5275                   6.1999                  0.036801                   1.1465                     2.842                   4.5275                   6.1999                   0.028717                     1.1465                       2.842                     4.5275                     6.1999       
    a24=1.09589               0.76227                    1.8548                    3.3051                     4.9129                   6.5311                   0.76227                   1.8548                    3.3051                   4.9129                   6.5311                    0.76227                     1.8548                      3.3051                     4.9129                     6.5311       
    a25=2.05479                1.4551                    2.4798                    3.7645                      5.294                   6.8517                    1.4551                   2.4798                    3.7645                    5.294                   6.8517                     1.4551                     2.4798                      3.7645                      5.294                     6.8517       
    a26=3.0137                  2.094                     3.045                    4.2122                      5.665                   7.1605                     2.094                    3.045                    4.2122                    5.665                   7.1605                      2.094                      3.045                      4.2122                      5.665                     7.1605       
    a27=3.9726                 2.6797                    3.5642                    4.6443                     6.0234                    7.457                    2.6797                   3.5642                    4.6443                   6.0234                    7.457                     2.6797                     3.5642                      4.6443                     6.0234                      7.457       
    a28=4.93151                 3.218                    4.0462                    5.0588                     6.3677                   7.7413                     3.218                   4.0462                    5.0588                   6.3677                   7.7413                      3.218                     4.0462                      5.0588                     6.3677                     7.7413       
    a29=5.89041                3.7153                    4.4968                    5.4551                     6.6977                   8.0136                    3.7153                   4.4968                    5.4551                   6.6977                   8.0136                     3.7153                     4.4968                      5.4551                     6.6977                     8.0136       
    a30=6.84932                4.1773                    4.9201                    5.8333                     7.0134                   8.2744                    4.1773                   4.9201                    5.8333                   7.0134                   8.2744                     4.1773                     4.9201                      5.8333                     7.0134                     8.2744       
    a31=7.80822                4.6091                    5.3193                    6.1938                     7.3152                   8.5243                    4.6091                   5.3193                    6.1938                   7.3152                   8.5243                     4.6091                     5.3193                      6.1938                     7.3152                     8.5243       
    a32=8.76712                5.0144                    5.6968                    6.5373                     7.6037                   8.7638                    5.0144                   5.6968                    6.5373                   7.6037                   8.7638                     5.0144                     5.6968                      6.5373                     7.6037                     8.7638       
    a33=9.72603                5.3964                    6.0544                    6.8646                     7.8795                   8.9936                    5.3964                   6.0544                    6.8646                   7.8795                   8.9936                     5.3964                     6.0544                      6.8646                     7.8795                     8.9936       
    a34=10.6849                5.7576                     6.394                    7.1766                     8.1434                   9.2144                    5.7576                    6.394                    7.1766                   8.1434                   9.2144                     5.7576                      6.394                      7.1766                     8.1434                     9.2144       
    a35=11.6438                   6.1                    6.7169                    7.4742                      8.396                   9.4267                       6.1                   6.7169                    7.4742                    8.396                   9.4267                        6.1                     6.7169                      7.4742                      8.396                     9.4267       
    a36=12.6027                6.4253                    7.0243                    7.7582                      8.638                   9.6314                    6.4253                   7.0243                    7.7582                    8.638                   9.6314                     6.4253                     7.0243                      7.7582                      8.638                     9.6314       
    a37=13.5616                6.7377                    7.3174                    8.0295                     8.8701                   9.8292                    6.7377                   7.3174                    8.0295                   8.8701                   9.8292                     6.7377                     7.3174                      8.0295                     8.8701                     9.8292       
    a38=14.5205                7.0421                    7.5973                    8.2888                      9.093                   10.021                    7.0421                   7.5973                    8.2888                    9.093                   10.021                     7.0421                     7.5973                      8.2888                      9.093                     10.021       
    a39=15.4795                7.3338                    7.8651                     8.537                     9.3073                   10.209                    7.3338                   7.8651                     8.537                   9.3073                   10.209                     7.3338                     7.8651                       8.537                     9.3073                     10.209       
    a40=16.4384                7.6159                    8.1215                    8.7748                     9.5153                   10.393                    7.6159                   8.1215                    8.7748                   9.5153                   10.393                     7.6159                     8.1215                      8.7748                     9.5153                     10.393       
    a41=17.3973                7.8863                    8.3674                     9.003                     9.7202                   10.573                    7.8863                   8.3674                     9.003                   9.7202                   10.573                     7.8863                     8.3674                       9.003                     9.7202                     10.573       
    a42=18.3562                8.1469                    8.6074                    9.2227                     9.9207                   10.748                    8.1469                   8.6074                    9.2227                   9.9207                   10.748                     8.1469                     8.6074                      9.2227                     9.9207                     10.748       
    a43=19.3151                8.3968                    8.8401                     9.435                     10.116                    10.92                    8.3968                   8.8401                     9.435                   10.116                    10.92                     8.3968                     8.8401                       9.435                     10.116                      10.92       
    a44=20.274                  8.639                    9.0665                    9.6404                     10.306                   11.088                     8.639                   9.0665                    9.6404                   10.306                   11.088                      8.639                     9.0665                      9.6404                     10.306                     11.088       
    a45=21.2329                8.8723                    9.2858                    9.8397                     10.491                   11.254                    8.8723                   9.2858                    9.8397                   10.491                   11.254                     8.8723                     9.2858                      9.8397                     10.491                     11.254       
    a46=22.1918                9.0989                     9.499                    10.033                     10.671                   11.417                    9.0989                    9.499                    10.033                   10.671                   11.417                     9.0989                      9.499                      10.033                     10.671                     11.417       
    a47=23.1507                9.3177                    9.7056                    10.221                     10.846                   11.576                    9.3177                   9.7056                    10.221                   10.846                   11.576                     9.3177                     9.7056                      10.221                     10.846                     11.576       
    a48=24.1096                9.5303                    9.9065                    10.403                     11.017                    11.73                    9.5303                   9.9065                    10.403                   11.017                    11.73                     9.5303                     9.9065                      10.403                     11.017                      11.73       
    a49=25.0685                9.7361                    10.101                     10.58                     11.182                    11.88                    9.7361                   10.101                     10.58                   11.182                    11.88                     9.7361                     10.101                       10.58                     11.182                      11.88       
    a50=26.0274                9.9361                    10.291                    10.753                     11.343                   12.026                    9.9361                   10.291                    10.753                   11.343                   12.026                     9.9361                     10.291                      10.753                     11.343                     12.026       
    a51=26.9863                 10.13                    10.474                     10.92                       11.5                   12.169                     10.13                   10.474                     10.92                     11.5                   12.169                      10.13                     10.474                       10.92                       11.5                     12.169       
    a52=27.9452                10.318                    10.653                    11.086                     11.653                   12.307                    10.318                   10.653                    11.086                   11.653                   12.307                     10.318                     10.653                      11.086                     11.653                     12.307       
    a53=28.9041                10.501                    10.827                    11.247                     11.802                   12.443                    10.501                   10.827                    11.247                   11.802                   12.443                     10.501                     10.827                      11.247                     11.802                     12.443       
    a54=29.863                 10.679                    10.996                    11.406                     11.948                   12.576                    10.679                   10.996                    11.406                   11.948                   12.576                     10.679                     10.996                      11.406                     11.948                     12.576       
    a55=30.8219                10.852                    11.161                    11.561                     12.091                   12.706                    10.852                   11.161                    11.561                   12.091                   12.706                     10.852                     11.161                      11.561                     12.091                     12.706       
    a56=31.7808                 11.02                    11.322                    11.713                      12.23                   12.833                     11.02                   11.322                    11.713                    12.23                   12.833                      11.02                     11.322                      11.713                      12.23                     12.833       
    a57=32.7397                11.184                    11.479                    11.862                     12.367                   12.958                    11.184                   11.479                    11.862                   12.367                   12.958                     11.184                     11.479                      11.862                     12.367                     12.958       
    a58=33.6986                11.344                    11.633                    12.008                     12.501                    13.08                    11.344                   11.633                    12.008                   12.501                    13.08                     11.344                     11.633                      12.008                     12.501                      13.08       
    a59=34.6575                11.499                    11.782                     12.15                     12.632                     13.2                    11.499                   11.782                     12.15                   12.632                     13.2                     11.499                     11.782                       12.15                     12.632                       13.2       
    a60=35.6164                11.651                    11.929                     12.29                     12.761                   13.318                    11.651                   11.929                     12.29                   12.761                   13.318                     11.651                     11.929                       12.29                     12.761                     13.318       
    a61=36.5753                11.799                    12.072                    12.426                     12.887                   13.433                    11.799                   12.072                    12.426                   12.887                   13.433                     11.799                     12.072                      12.426                     12.887                     13.433       
    a62=37.5342                11.944                    12.212                     12.56                      13.01                   13.546                    11.944                   12.212                     12.56                    13.01                   13.546                     11.944                     12.212                       12.56                      13.01                     13.546       
    a63=38.4932                12.085                    12.349                    12.691                     13.131                   13.657                    12.085                   12.349                    12.691                   13.131                   13.657                     12.085                     12.349                      12.691                     13.131                     13.657       
    a64=39.4521                12.224                    12.483                    12.819                      13.25                   13.765                    12.224                   12.483                    12.819                    13.25                   13.765                     12.224                     12.483                      12.819                      13.25                     13.765       
    a65=40.411                 12.359                    12.613                    12.944                     13.366                   13.872                    12.359                   12.613                    12.944                   13.366                   13.872                     12.359                     12.613                      12.944                     13.366                     13.872       
    a66=41.3699                12.491                    12.742                    13.067                      13.48                   13.977                    12.491                   12.742                    13.067                    13.48                   13.977                     12.491                     12.742                      13.067                      13.48                     13.977       
    a67=42.3288                12.622                    12.867                    13.188                     13.592                   14.079                    12.622                   12.867                    13.188                   13.592                   14.079                     12.622                     12.867                      13.188                     13.592                     14.079       
    a68=43.2877                 12.75                     12.99                    13.306                     13.701                    14.18                     12.75                    12.99                    13.306                   13.701                    14.18                      12.75                      12.99                      13.306                     13.701                      14.18       
    a69=44.2466                12.876                    13.111                    13.422                     13.809                   14.279                    12.876                   13.111                    13.422                   13.809                   14.279                     12.876                     13.111                      13.422                     13.809                     14.279       
    a70=45.2055                12.999                    13.229                    13.535                     13.914                   14.376                    12.999                   13.229                    13.535                   13.914                   14.376                     12.999                     13.229                      13.535                     13.914                     14.376       
    a71=46.1644                 13.12                    13.344                    13.646                     14.018                   14.471                     13.12                   13.344                    13.646                   14.018                   14.471                      13.12                     13.344                      13.646                     14.018                     14.471       
    a72=47.1233                13.239                    13.458                    13.755                     14.119                   14.564                    13.239                   13.458                    13.755                   14.119                   14.564                     13.239                     13.458                      13.755                     14.119                     14.564       
    a73=48.0822                13.356                     13.57                    13.862                      14.22                   14.657                    13.356                    13.57                    13.862                    14.22                   14.657                     13.356                      13.57                      13.862                      14.22                     14.657       
    a74=49.0411                 13.47                     13.68                    13.967                     14.319                   14.748                     13.47                    13.68                    13.967                   14.319                   14.748                      13.47                      13.68                      13.967                     14.319                     14.748       
    a75=50                     13.582                    13.788                     14.07                     14.416                   14.838                    13.582                   13.788                     14.07                   14.416                   14.838                     13.582                     13.788                       14.07                     14.416                     14.838       

tb_pol_a: optimal asset choice for each state space point
                     zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                     _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    a1=-20                         0                          0                       -20                        -20                  -19.041                         0                        0                         0                      -20                  -19.041                          0                          0                           0                          0                        -20       
    a2=-19.0411                  -20                        -20                       -20                    -19.041                  -18.082                         0                      -20                       -20                      -20                  -18.082                          0                          0                           0                        -20                    -19.041       
    a3=-18.0822                  -20                        -20                       -20                    -18.082                  -17.123                       -20                      -20                       -20                  -19.041                  -17.123                        -20                        -20                         -20                        -20                    -18.082       
    a4=-17.1233                  -20                    -18.082                   -18.082                    -17.123                  -16.164                       -20                      -20                   -18.082                  -18.082                  -16.164                        -20                        -20                         -20                    -18.082                    -17.123       
    a5=-16.1644              -17.123                    -17.123                   -17.123                    -16.164                  -15.205                   -18.082                  -18.082                   -18.082                  -17.123                  -15.205                        -20                    -18.082                     -18.082                    -17.123                    -16.164       
    a6=-15.2055              -17.123                    -17.123                   -16.164                    -15.205                  -14.247                   -17.123                  -17.123                   -16.164                  -16.164                  -14.247                    -17.123                    -17.123                     -17.123                    -16.164                    -14.247       
    a7=-14.2466              -16.164                    -15.205                   -15.205                    -14.247                  -13.288                   -17.123                  -16.164                   -15.205                  -14.247                  -13.288                    -17.123                    -17.123                     -16.164                    -15.205                    -13.288       
    a8=-13.2877              -15.205                    -14.247                   -14.247                    -13.288                   -11.37                   -15.205                  -15.205                   -14.247                  -13.288                  -12.329                    -15.205                    -15.205                     -15.205                    -14.247                    -12.329       
    a9=-12.3288              -14.247                    -13.288                   -13.288                    -12.329                  -10.411                   -14.247                  -14.247                   -13.288                  -12.329                   -11.37                    -14.247                    -14.247                     -14.247                    -13.288                     -11.37       
    a10=-11.3699             -12.329                    -12.329                   -12.329                     -11.37                  -9.4521                   -13.288                  -13.288                   -12.329                   -11.37                  -10.411                    -14.247                    -13.288                     -12.329                    -12.329                    -10.411       
    a11=-10.411              -12.329                     -11.37                    -11.37                    -10.411                  -8.4932                   -12.329                  -12.329                    -11.37                  -10.411                  -9.4521                    -12.329                    -12.329                      -11.37                    -10.411                    -9.4521       
    a12=-9.45205             -10.411                    -10.411                   -10.411                    -9.4521                  -7.5342                    -11.37                   -11.37                   -10.411                  -9.4521                  -8.4932                     -11.37                     -11.37                     -10.411                    -9.4521                    -8.4932       
    a13=-8.49315             -9.4521                    -9.4521                   -9.4521                    -8.4932                  -6.5753                   -10.411                  -9.4521                   -9.4521                  -8.4932                  -6.5753                    -10.411                    -10.411                     -9.4521                    -8.4932                    -7.5342       
    a14=-7.53425             -8.4932                    -8.4932                   -7.5342                    -7.5342                  -5.6164                   -9.4521                  -8.4932                   -8.4932                  -7.5342                  -5.6164                    -9.4521                    -9.4521                     -8.4932                    -7.5342                    -6.5753       
    a15=-6.57534             -7.5342                    -7.5342                   -6.5753                    -6.5753                  -4.6575                   -8.4932                  -7.5342                   -7.5342                  -6.5753                  -4.6575                    -8.4932                    -7.5342                     -7.5342                    -6.5753                    -4.6575       
    a16=-5.61644             -6.5753                    -6.5753                   -5.6164                    -5.6164                  -3.6986                   -7.5342                  -6.5753                   -6.5753                  -5.6164                  -3.6986                    -7.5342                    -6.5753                     -6.5753                    -5.6164                    -3.6986       
    a17=-4.65753             -5.6164                    -5.6164                   -4.6575                    -3.6986                  -2.7397                   -5.6164                  -5.6164                   -5.6164                  -4.6575                  -2.7397                    -6.5753                    -5.6164                     -5.6164                    -4.6575                    -2.7397       
    a18=-3.69863             -4.6575                    -4.6575                   -3.6986                    -2.7397                  -1.7808                   -4.6575                  -4.6575                   -3.6986                  -2.7397                  -1.7808                    -4.6575                    -4.6575                     -4.6575                    -2.7397                    -1.7808       
    a19=-2.73973             -3.6986                    -3.6986                   -2.7397                    -1.7808                 -0.82192                   -3.6986                  -3.6986                   -2.7397                  -1.7808                 -0.82192                    -3.6986                    -3.6986                     -2.7397                    -1.7808                   -0.82192       
    a20=-1.78082             -2.7397                    -2.7397                   -1.7808                   -0.82192                        0                   -2.7397                  -2.7397                   -1.7808                 -0.82192                        0                    -2.7397                    -2.7397                     -1.7808                   -0.82192                          0       
    a21=-0.821918            -1.7808                    -1.7808                  -0.82192                          0                  0.13699                   -1.7808                  -1.7808                  -0.82192                        0                  0.13699                    -1.7808                    -1.7808                    -0.82192                          0                    0.13699       
    a22=0                   -0.82192                   -0.82192                         0                    0.13699                   1.0959                  -0.82192                 -0.82192                         0                  0.13699                   1.0959                   -0.82192                   -0.82192                           0                    0.13699                     1.0959       
    a23=0.136986            -0.82192                          0                         0                    0.13699                   1.0959                  -0.82192                        0                         0                  0.13699                   1.0959                   -0.82192                          0                           0                    0.13699                     1.0959       
    a24=1.09589              0.13699                    0.13699                   0.13699                     1.0959                   2.0548                   0.13699                  0.13699                   0.13699                   1.0959                   2.0548                    0.13699                    0.13699                     0.13699                     1.0959                     2.0548       
    a25=2.05479               1.0959                     1.0959                    1.0959                     2.0548                   3.0137                    1.0959                   1.0959                    1.0959                   2.0548                   3.0137                     1.0959                     1.0959                      1.0959                     2.0548                     3.0137       
    a26=3.0137                2.0548                     2.0548                    2.0548                     3.0137                   3.9726                    2.0548                   2.0548                    2.0548                   3.0137                   3.9726                     2.0548                     2.0548                      2.0548                     3.0137                     3.9726       
    a27=3.9726                3.0137                     3.0137                    3.0137                     3.9726                   4.9315                    3.0137                   3.0137                    3.0137                   3.9726                   4.9315                     3.0137                     3.0137                      3.0137                     3.9726                     4.9315       
    a28=4.93151               3.9726                     3.9726                    3.9726                     4.9315                   5.8904                    3.9726                   3.9726                    3.9726                   4.9315                   5.8904                     3.9726                     3.9726                      3.9726                     4.9315                     5.8904       
    a29=5.89041               4.9315                     4.9315                    4.9315                     5.8904                   6.8493                    4.9315                   4.9315                    4.9315                   5.8904                   6.8493                     4.9315                     4.9315                      4.9315                     5.8904                     6.8493       
    a30=6.84932               5.8904                     5.8904                    5.8904                     6.8493                   7.8082                    5.8904                   5.8904                    5.8904                   6.8493                   7.8082                     5.8904                     5.8904                      5.8904                     6.8493                     7.8082       
    a31=7.80822               6.8493                     6.8493                    6.8493                     7.8082                   8.7671                    6.8493                   6.8493                    6.8493                   7.8082                   8.7671                     6.8493                     6.8493                      6.8493                     7.8082                     8.7671       
    a32=8.76712               7.8082                     7.8082                    7.8082                     8.7671                    9.726                    7.8082                   7.8082                    7.8082                   8.7671                    9.726                     7.8082                     7.8082                      7.8082                     8.7671                      9.726       
    a33=9.72603               8.7671                     8.7671                    8.7671                      9.726                   10.685                    8.7671                   8.7671                    8.7671                    9.726                   10.685                     8.7671                     8.7671                      8.7671                      9.726                     10.685       
    a34=10.6849                9.726                      9.726                     9.726                     10.685                   11.644                     9.726                    9.726                     9.726                   10.685                   11.644                      9.726                      9.726                       9.726                     10.685                     11.644       
    a35=11.6438               10.685                     10.685                    10.685                     11.644                   12.603                    10.685                   10.685                    10.685                   11.644                   12.603                     10.685                     10.685                      10.685                     11.644                     12.603       
    a36=12.6027               11.644                     11.644                    11.644                     12.603                   13.562                    11.644                   11.644                    11.644                   12.603                   13.562                     11.644                     11.644                      11.644                     12.603                     13.562       
    a37=13.5616               11.644                     12.603                    12.603                     13.562                   14.521                    11.644                   12.603                    12.603                   13.562                   14.521                     11.644                     12.603                      12.603                     13.562                     14.521       
    a38=14.5205               12.603                     13.562                    13.562                     14.521                   15.479                    12.603                   13.562                    13.562                   14.521                   15.479                     12.603                     13.562                      13.562                     14.521                     15.479       
    a39=15.4795               13.562                     14.521                    14.521                     15.479                   16.438                    13.562                   14.521                    14.521                   15.479                   16.438                     13.562                     14.521                      14.521                     15.479                     16.438       
    a40=16.4384               14.521                     15.479                    15.479                     15.479                   17.397                    14.521                   15.479                    15.479                   15.479                   17.397                     14.521                     15.479                      15.479                     15.479                     17.397       
    a41=17.3973               15.479                     16.438                    16.438                     16.438                   18.356                    15.479                   16.438                    16.438                   16.438                   18.356                     15.479                     16.438                      16.438                     16.438                     18.356       
    a42=18.3562               16.438                     16.438                    17.397                     17.397                   19.315                    16.438                   16.438                    17.397                   17.397                   19.315                     16.438                     16.438                      17.397                     17.397                     19.315       
    a43=19.3151               17.397                     17.397                    18.356                     18.356                   20.274                    17.397                   17.397                    18.356                   18.356                   20.274                     17.397                     17.397                      18.356                     18.356                     20.274       
    a44=20.274                18.356                     18.356                    19.315                     19.315                   21.233                    18.356                   18.356                    19.315                   19.315                   21.233                     18.356                     18.356                      19.315                     19.315                     21.233       
    a45=21.2329               19.315                     19.315                    20.274                     20.274                   21.233                    19.315                   19.315                    20.274                   20.274                   21.233                     19.315                     19.315                      20.274                     20.274                     21.233       
    a46=22.1918               20.274                     20.274                    21.233                     21.233                   22.192                    20.274                   20.274                    21.233                   21.233                   22.192                     20.274                     20.274                      21.233                     21.233                     22.192       
    a47=23.1507               21.233                     21.233                    22.192                     22.192                   23.151                    21.233                   21.233                    22.192                   22.192                   23.151                     21.233                     21.233                      22.192                     22.192                     23.151       
    a48=24.1096               22.192                     22.192                    23.151                     23.151                    24.11                    22.192                   22.192                    23.151                   23.151                    24.11                     22.192                     22.192                      23.151                     23.151                      24.11       
    a49=25.0685               23.151                     23.151                     24.11                      24.11                   25.068                    23.151                   23.151                     24.11                    24.11                   25.068                     23.151                     23.151                       24.11                      24.11                     25.068       
    a50=26.0274                24.11                      24.11                    25.068                     25.068                   26.027                     24.11                    24.11                    25.068                   25.068                   26.027                      24.11                      24.11                      25.068                     25.068                     26.027       
    a51=26.9863               25.068                     25.068                    26.027                     26.027                   26.986                    25.068                   25.068                    26.027                   26.027                   26.986                     25.068                     25.068                      26.027                     26.027                     26.986       
    a52=27.9452               26.027                     26.027                    26.027                     26.986                   27.945                    26.027                   26.027                    26.027                   26.986                   27.945                     26.027                     26.027                      26.027                     26.986                     27.945       
    a53=28.9041               26.986                     26.986                    26.986                     27.945                   28.904                    26.986                   26.986                    26.986                   27.945                   28.904                     26.986                     26.986                      26.986                     27.945                     28.904       
    a54=29.863                27.945                     27.945                    27.945                     28.904                   29.863                    27.945                   27.945                    27.945                   28.904                   29.863                     27.945                     27.945                      27.945                     28.904                     29.863       
    a55=30.8219               28.904                     28.904                    28.904                     29.863                   30.822                    28.904                   28.904                    28.904                   29.863                   30.822                     28.904                     28.904                      28.904                     29.863                     30.822       
    a56=31.7808               29.863                     29.863                    29.863                     30.822                   31.781                    29.863                   29.863                    29.863                   30.822                   31.781                     29.863                     29.863                      29.863                     30.822                     31.781       
    a57=32.7397               30.822                     30.822                    30.822                     31.781                    32.74                    30.822                   30.822                    30.822                   31.781                    32.74                     30.822                     30.822                      30.822                     31.781                      32.74       
    a58=33.6986               31.781                     31.781                    31.781                      32.74                   33.699                    31.781                   31.781                    31.781                    32.74                   33.699                     31.781                     31.781                      31.781                      32.74                     33.699       
    a59=34.6575                32.74                      32.74                     32.74                     33.699                   34.658                     32.74                    32.74                     32.74                   33.699                   34.658                      32.74                      32.74                       32.74                     33.699                     34.658       
    a60=35.6164               33.699                     33.699                    33.699                     34.658                   35.616                    33.699                   33.699                    33.699                   34.658                   35.616                     33.699                     33.699                      33.699                     34.658                     35.616       
    a61=36.5753               34.658                     34.658                    34.658                     35.616                   36.575                    34.658                   34.658                    34.658                   35.616                   36.575                     34.658                     34.658                      34.658                     35.616                     36.575       
    a62=37.5342               35.616                     35.616                    35.616                     36.575                   37.534                    35.616                   35.616                    35.616                   36.575                   37.534                     35.616                     35.616                      35.616                     36.575                     37.534       
    a63=38.4932               36.575                     36.575                    36.575                     37.534                   38.493                    36.575                   36.575                    36.575                   37.534                   38.493                     36.575                     36.575                      36.575                     37.534                     38.493       
    a64=39.4521               37.534                     37.534                    37.534                     38.493                   39.452                    37.534                   37.534                    37.534                   38.493                   39.452                     37.534                     37.534                      37.534                     38.493                     39.452       
    a65=40.411                38.493                     38.493                    38.493                     39.452                   40.411                    38.493                   38.493                    38.493                   39.452                   40.411                     38.493                     38.493                      38.493                     39.452                     40.411       
    a66=41.3699               39.452                     39.452                    39.452                     40.411                    41.37                    39.452                   39.452                    39.452                   40.411                    41.37                     39.452                     39.452                      39.452                     40.411                      41.37       
    a67=42.3288               39.452                     40.411                    40.411                      41.37                   42.329                    39.452                   40.411                    40.411                    41.37                   42.329                     39.452                     40.411                      40.411                      41.37                     42.329       
    a68=43.2877               40.411                      41.37                     41.37                     42.329                   43.288                    40.411                    41.37                     41.37                   42.329                   43.288                     40.411                      41.37                       41.37                     42.329                     43.288       
    a69=44.2466                41.37                     42.329                    42.329                     43.288                   44.247                     41.37                   42.329                    42.329                   43.288                   44.247                      41.37                     42.329                      42.329                     43.288                     44.247       
    a70=45.2055               42.329                     43.288                    43.288                     44.247                   45.205                    42.329                   43.288                    43.288                   44.247                   45.205                     42.329                     43.288                      43.288                     44.247                     45.205       
    a71=46.1644               43.288                     44.247                    44.247                     45.205                   46.164                    43.288                   44.247                    44.247                   45.205                   46.164                     43.288                     44.247                      44.247                     45.205                     46.164       
    a72=47.1233               44.247                     45.205                    45.205                     45.205                   47.123                    44.247                   45.205                    45.205                   45.205                   47.123                     44.247                     45.205                      45.205                     45.205                     47.123       
    a73=48.0822               45.205                     45.205                    46.164                     46.164                   48.082                    45.205                   45.205                    46.164                   46.164                   48.082                     45.205                     45.205                      46.164                     46.164                     48.082       
    a74=49.0411               46.164                     46.164                    47.123                     47.123                   49.041                    46.164                   46.164                    47.123                   47.123                   49.041                     46.164                     46.164                      47.123                     47.123                     49.041       
    a75=50                    47.123                     47.123                    48.082                     48.082                       50                    47.123                   47.123                    48.082                   48.082                       50                     47.123                     47.123                      48.082                     48.082                         50       

Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
mt_pol_b_bridge_print: bridge loans
                       zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                       _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    coh1=-19.968                     0                          0                    -19.29                    -18.504                   -17.21                         0                        0                         0                  -19.136                  -17.797                          0                          0                           0                          0                    -18.385       
    coh2=-19.0091              -19.072                    -18.783                   -18.307                    -17.521                  -16.227                         0                  -19.424                   -18.932                   -18.12                  -16.781                          0                          0                           0                    -18.718                    -17.335       
    coh3=-18.0502              -18.089                      -17.8                   -17.324                    -16.538                  -15.244                   -18.707                  -18.408                   -17.915                  -17.103                  -15.764                    -19.324                    -19.016                     -18.507                    -17.668                    -16.285       
    coh4=-17.0913              -17.106                    -16.817                   -16.341                    -15.556                  -14.261                    -17.69                  -17.391                   -16.899                  -16.087                  -14.748                    -18.274                    -17.966                     -17.457                    -16.618                    -15.235       
    coh5=-16.1324              -16.123                    -15.834                   -15.358                    -14.573                  -13.278                   -16.674                  -16.375                   -15.882                   -15.07                  -13.731                    -17.224                    -16.916                     -16.407                    -15.568                    -14.185       
    coh6=-15.1735               -15.14                    -14.851                   -14.375                     -13.59                  -12.295                   -15.657                  -15.359                   -14.866                  -14.054                  -12.715                    -16.174                    -15.866                     -15.357                    -14.518                    -13.135       
    coh7=-14.2146              -14.157                    -13.869                   -13.392                    -12.607                  -11.312                   -14.641                  -14.342                    -13.85                  -13.037                  -11.699                    -15.124                    -14.816                     -14.307                    -13.468                    -12.085       
    coh8=-13.2557              -13.175                    -12.886                   -12.409                    -11.624                  -10.329                   -13.624                  -13.326                   -12.833                  -12.021                  -10.682                    -14.074                    -13.766                     -13.257                    -12.418                    -11.035       
    coh9=-12.2968              -12.192                    -11.903                   -11.426                    -10.641                  -9.3465                   -12.608                  -12.309                   -11.817                  -11.005                  -9.6657                    -13.024                    -12.716                     -12.207                    -11.368                    -9.9848       
    coh10=-11.3379             -11.209                     -10.92                   -10.444                    -9.6583                  -8.3636                   -11.592                  -11.293                     -10.8                  -9.9881                  -8.6492                    -11.974                    -11.666                     -11.157                    -10.318                    -8.9348       
    coh11=-10.379              -10.226                     -9.937                   -9.4607                    -8.6755                  -7.3808                   -10.575                  -10.276                   -9.7838                  -8.9717                  -7.6328                    -10.924                    -10.616                     -10.107                    -9.2679                    -7.8848       
    coh12=-9.42005              -9.243                    -8.9542                   -8.4779                    -7.6926                  -6.3979                   -9.5587                  -9.2599                   -8.7674                  -7.9553                  -6.6164                    -9.8743                    -9.5657                     -9.0568                    -8.2179                    -6.8348       
    coh13=-8.46115             -8.2602                    -7.9713                    -7.495                    -6.7097                   -5.415                   -8.5422                  -8.2435                   -7.7509                  -6.9388                  -5.5999                    -8.8243                    -8.5157                     -8.0068                    -7.1679                    -5.7848       
    coh14=-7.50225             -7.2773                    -6.9884                   -6.5121                    -5.7268                  -4.4321                   -7.5258                   -7.227                   -6.7345                  -5.9224                  -4.5835                    -7.7743                    -7.4657                     -6.9568                    -6.1179                    -4.7348       
    coh15=-6.54334             -6.2944                    -6.0055                   -5.5292                     -4.744                  -3.4493                   -6.5093                  -6.2106                    -5.718                  -4.9059                   -3.567                    -6.7243                    -6.4157                     -5.9068                    -5.0679                    -3.6848       
    coh16=-5.58444             -5.3115                    -5.0226                   -4.5464                    -3.7611                  -2.4664                   -5.4929                  -5.1942                   -4.7016                  -3.8895                  -2.5506                    -5.6743                    -5.3657                     -4.8568                    -4.0179                    -2.6348       
    coh17=-4.62553             -4.3287                    -4.0398                   -3.5635                    -2.7782                  -1.4835                   -4.4765                  -4.1777                   -3.6852                  -2.8731                  -1.5342                    -4.6243                    -4.3157                     -3.8068                    -2.9679                    -1.5848       
    coh18=-3.66663             -3.3458                    -3.0569                   -2.5806                    -1.7953                 -0.50064                     -3.46                  -3.1613                   -2.6687                  -1.8566                 -0.51773                    -3.5743                    -3.2657                     -2.7568                    -1.9179                   -0.53483       
    coh19=-2.70773             -2.3629                     -2.074                   -1.5977                   -0.81245                        0                   -2.4436                  -2.1448                   -1.6523                  -0.8402                        0                    -2.5243                    -2.2157                     -1.7068                   -0.86794                          0       
    coh20=-1.74882               -1.38                    -1.0911                  -0.61485                          0                        0                   -1.4271                  -1.1284                  -0.63584                        0                        0                    -1.4743                    -1.1657                    -0.65684                          0                          0       
    coh21=-0.789918           -0.39715                   -0.10826                         0                          0                        0                  -0.41071                 -0.11196                         0                        0                        0                   -0.42427                   -0.11566                           0                          0                          0       
    coh22=0.032                      0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh23=0.168986                   0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh24=1.12789                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh25=2.08679                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh26=3.0457                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh27=4.0046                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh28=4.96351                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh29=5.92241                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh30=6.88132                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh31=7.84022                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh32=8.79912                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh33=9.75803                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh34=10.7169                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh35=11.6758                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh36=12.6347                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh37=13.5936                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh38=14.5525                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh39=15.5115                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh40=16.4704                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh41=17.4293                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh42=18.3882                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh43=19.3471                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh44=20.306                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh45=21.2649                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh46=22.2238                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh47=23.1827                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh48=24.1416                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh49=25.1005                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh50=26.0594                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh51=27.0183                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh52=27.9772                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh53=28.9361                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh54=29.895                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh55=30.8539                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh56=31.8128                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh57=32.7717                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh58=33.7306                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh59=34.6895                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh60=35.6484                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh61=36.6073                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh62=37.5662                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh63=38.5252                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh64=39.4841                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh65=40.443                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh66=41.4019                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh67=42.3608                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh68=43.3197                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh69=44.2786                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh70=45.2375                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh71=46.1964                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh72=47.1553                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh73=48.1142                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh74=49.0731                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       
    coh75=50.032                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                          0                           0                          0                          0       

mt_pol_inf_borr_nobridge_print: Informal loans that is not bridge loan
                       zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                       _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    coh1=-19.968                     0                          0                  -0.71049                    -1.4958                  -1.8316                         0                        0                         0                 -0.86391                  -1.2439                          0                           0                          0                          0                   -0.55017       
    coh2=-19.0091             -0.92819                    -1.2171                   -1.6934                    -1.5197                  -1.8555                         0                 -0.57571                   -1.0683                  -1.8804                  -1.3014                          0                           0                          0                   -0.21706                   -0.64127       
    coh3=-18.0502              -1.9111                       -2.2                   -2.6762                    -1.5437                  -1.8795                   -1.2934                  -1.5921                   -2.0847                  -1.9379                   -1.359                          0                           0                   -0.42816                          0                   -0.73237       
    coh4=-17.0913              -2.8939                     -1.265                   -1.7413                    -1.5677                  -1.9035                   -2.3098                  -2.6086                   -1.1833                  -1.9954                  -1.4165                   -0.66073                           0                          0                   -0.39925                   -0.82346       
    coh5=-16.1324              -1.0001                     -1.289                   -1.7653                    -1.5917                  -1.9274                   -1.4085                  -1.7072                   -2.1998                   -2.053                  -1.4741                   -0.11323                    -0.10153                   -0.61035                   -0.49035                   -0.91456       
    coh6=-15.1735               -1.983                    -2.2719                   -1.7893                    -1.6156                  -1.9514                    -1.466                  -1.7648                   -1.2984                  -2.1105                  -1.5316                          0                    -0.19263                   -0.70145                   -0.58144                   -0.04675       
    coh7=-14.2146               -2.007                    -1.3369                   -1.8132                    -1.6396                  -1.9754                   -2.4824                  -1.8223                   -1.3559                  -1.2091                  -1.5891                   -0.93401                           0                   -0.79254                   -0.67254                   -0.13785       
    coh8=-13.2557              -2.0309                    -1.3609                   -1.8372                    -1.6636                  -1.0405                   -1.5811                  -1.8798                   -1.4135                  -1.2667                  -1.6467                  -0.066207                    -0.37482                   -0.88364                   -0.76364                   -0.22894       
    coh9=-12.2968              -2.0549                    -1.3849                   -1.8612                    -1.6875                  -1.0644                   -1.6386                  -1.9374                    -1.471                  -1.3242                  -1.7042                    -0.1573                    -0.46592                          0                   -0.85473                   -0.32004       
    coh10=-11.3379               -1.12                    -1.4089                   -1.8852                    -1.7115                  -1.0884                   -1.6961                  -1.9949                   -1.5285                  -1.3817                  -1.7617                          0                    -0.55701                   -0.10693                          0                   -0.41113       
    coh11=-10.379              -2.1028                    -1.4328                   -1.9091                    -1.7355                  -1.1124                   -1.7537                  -2.0524                   -1.5861                  -1.4393                  -1.8193                   -0.33949                    -0.64811                   -0.19802                   -0.07802                   -0.50223       
    coh12=-9.42005             -1.1679                    -1.4568                   -1.9331                    -1.7595                  -1.1364                   -1.8112                    -2.11                   -1.6436                  -1.4968                  -1.8768                   -0.43059                     -0.7392                   -0.28912                   -0.16912                   -0.59333       
    coh13=-8.46115             -1.1919                    -1.4808                   -1.9571                    -1.7834                  -1.1603                   -1.8687                  -1.2086                   -1.7011                  -1.5543                 -0.97542                   -0.52169                     -0.8303                   -0.38022                   -0.26021                   -0.68442       
    coh14=-7.50225             -1.2159                    -1.5047                   -1.0221                    -1.8074                  -1.1843                   -1.9263                  -1.2661                   -1.7587                  -1.6119                   -1.033                   -0.61278                     -0.9214                   -0.47131                   -0.35131                   -0.77552       
    coh15=-6.54334             -1.2398                    -1.5287                   -1.0461                    -1.8314                  -1.2083                   -1.9838                  -1.3237                   -1.8162                  -1.6694                  -1.0905                   -0.70388                   -0.053588                   -0.56241                    -0.4424                          0       
    coh16=-5.58444             -1.2638                    -1.5527                   -1.0701                    -1.8554                  -1.2322                   -2.0413                  -1.3812                   -1.8737                  -1.7269                   -1.148                   -0.79497                    -0.14468                    -0.6535                    -0.5335                          0       
    coh17=-4.62553             -1.2878                    -1.5767                   -1.0941                   -0.92042                  -1.2562                     -1.14                  -1.4387                   -1.9313                  -1.7845                  -1.2056                   -0.88607                    -0.23578                    -0.7446                    -0.6246                  -0.089901       
    coh18=-3.66663             -1.3118                    -1.6006                    -1.118                    -0.9444                  -1.2802                   -1.1975                  -1.4963                   -1.0299                 -0.88309                  -1.2631                  -0.018261                    -0.32688                   -0.83569                          0                     -0.181       
    coh19=-2.70773             -1.3357                    -1.6246                    -1.142                   -0.96837                 -0.82192                    -1.255                  -1.5538                   -1.0874                 -0.94063                 -0.82192                   -0.10936                    -0.41797                          0                          0                          0       
    coh20=-1.74882             -1.3597                    -1.6486                    -1.166                   -0.82192                        0                   -1.3126                  -1.6113                    -1.145                 -0.82192                        0                   -0.20045                    -0.50907                  -0.058982                          0                          0       
    coh21=-0.789918            -1.3837                    -1.6726                  -0.82192                          0                        0                   -1.3701                  -1.6689                  -0.82192                        0                        0                   -0.29155                    -0.60016                          0                          0                          0       
    coh22=0.032               -0.82192                   -0.82192                         0                          0                        0                  -0.82192                 -0.82192                         0                        0                        0                          0                           0                          0                          0                          0       
    coh23=0.168986            -0.82192                          0                         0                          0                        0                  -0.82192                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh24=1.12789                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh25=2.08679                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh26=3.0457                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh27=4.0046                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh28=4.96351                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh29=5.92241                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh30=6.88132                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh31=7.84022                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh32=8.79912                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh33=9.75803                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh34=10.7169                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh35=11.6758                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh36=12.6347                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh37=13.5936                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh38=14.5525                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh39=15.5115                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh40=16.4704                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh41=17.4293                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh42=18.3882                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh43=19.3471                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh44=20.306                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh45=21.2649                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh46=22.2238                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh47=23.1827                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh48=24.1416                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh49=25.1005                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh50=26.0594                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh51=27.0183                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh52=27.9772                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh53=28.9361                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh54=29.895                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh55=30.8539                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh56=31.8128                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh57=32.7717                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh58=33.7306                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh59=34.6895                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh60=35.6484                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh61=36.6073                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh62=37.5662                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh63=38.5252                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh64=39.4841                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh65=40.443                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh66=41.4019                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh67=42.3608                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh68=43.3197                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh69=44.2786                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh70=45.2375                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh71=46.1964                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh72=47.1553                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh73=48.1142                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh74=49.0731                    0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       
    coh75=50.032                     0                          0                         0                          0                        0                         0                        0                         0                        0                        0                          0                           0                          0                          0                          0       

mt_pol_for_borr_print: formal borrowing
                       zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                       _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    coh1=-19.968                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                    -1.065        
    coh2=-19.0091                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                      -1.065                    -1.065        
    coh3=-18.0502                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                     -2.6625                    -1.065        
    coh4=-17.0913                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                     -2.6625                    -2.6625                      -1.065                    -1.065        
    coh5=-16.1324                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                      -2.6625                      -1.065                     -1.065                      -1.065                    -1.065        
    coh6=-15.1735                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh7=-14.2146                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                     -2.6625                     -1.065                      -1.065                    -1.065        
    coh8=-13.2557                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh9=-12.2968                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                    -2.6625                      -1.065                    -1.065        
    coh10=-11.3379                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                      -2.6625                      -1.065                     -1.065                     -2.6625                    -1.065        
    coh11=-10.379                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh12=-9.42005                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh13=-8.46115                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh14=-7.50225                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh15=-6.54334                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh16=-5.58444                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh17=-4.62553                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh18=-3.66663                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh19=-2.70773                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                    -1.065        
    coh20=-1.74882                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                      -1.065                         0        
    coh21=-0.789918               0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                     -1.065                           0                         0        
    coh22=0.032                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                      -1.065                          0                           0                         0        
    coh23=0.168986                0                         0                          0                         0                         0                        0                         0                        0                         0                        0                       -1.065                           0                          0                           0                         0        
    coh24=1.12789                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh25=2.08679                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh26=3.0457                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh27=4.0046                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh28=4.96351                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh29=5.92241                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh30=6.88132                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh31=7.84022                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh32=8.79912                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh33=9.75803                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh34=10.7169                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh35=11.6758                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh36=12.6347                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh37=13.5936                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh38=14.5525                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh39=15.5115                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh40=16.4704                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh41=17.4293                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh42=18.3882                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh43=19.3471                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh44=20.306                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh45=21.2649                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh46=22.2238                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh47=23.1827                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh48=24.1416                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh49=25.1005                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh50=26.0594                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh51=27.0183                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh52=27.9772                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh53=28.9361                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh54=29.895                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh55=30.8539                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh56=31.8128                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh57=32.7717                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh58=33.7306                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh59=34.6895                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh60=35.6484                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh61=36.6073                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh62=37.5662                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh63=38.5252                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh64=39.4841                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh65=40.443                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh66=41.4019                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh67=42.3608                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh68=43.3197                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh69=44.2786                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh70=45.2375                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh71=46.1964                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh72=47.1553                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh73=48.1142                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh74=49.0731                 0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        
    coh75=50.032                  0                         0                          0                         0                         0                        0                         0                        0                         0                        0                            0                           0                          0                           0                         0        

mt_pol_for_save_print: formal savings
                       zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                       _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    coh1=-19.968                     0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh2=-19.0091                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh3=-18.0502                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                   0.38927                    0.080658                           0                    0.33044                          0       
    coh4=-17.0913                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                     0.62816                     0.11934                          0                          0       
    coh5=-16.1324                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh6=-15.1735                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                   0.11599                           0                           0                          0                          0       
    coh7=-14.2146                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                     0.35487                           0                          0                          0       
    coh8=-13.2557                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh9=-12.2968                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                     0.62276                          0                          0       
    coh10=-11.3379                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                    0.3902                           0                           0                    0.65167                          0       
    coh11=-10.379                    0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh12=-9.42005                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh13=-8.46115                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh14=-7.50225                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh15=-6.54334                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                   0.092291       
    coh16=-5.58444                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                   0.001195       
    coh17=-4.62553                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                          0                          0       
    coh18=-3.66663                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                    0.24321                          0       
    coh19=-2.70773                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                    0.032113                    0.15212                    0.24308       
    coh20=-1.74882                   0                         0                          0                         0                         0                        0                         0                        0                         0                        0                         0                           0                           0                    0.24308                          0       
    coh21=-0.789918                  0                         0                          0                         0                   0.13699                        0                         0                        0                         0                  0.13699                         0                           0                     0.24308                          0                    0.13699       
    coh22=0.032                      0                         0                          0                   0.13699                    1.0959                        0                         0                        0                   0.13699                   1.0959                   0.24308                     0.24308                           0                    0.13699                     1.0959       
    coh23=0.168986                   0                         0                          0                   0.13699                    1.0959                        0                         0                        0                   0.13699                   1.0959                   0.24308                           0                           0                    0.13699                     1.0959       
    coh24=1.12789              0.13699                   0.13699                    0.13699                    1.0959                    2.0548                  0.13699                   0.13699                  0.13699                    1.0959                   2.0548                   0.13699                     0.13699                     0.13699                     1.0959                     2.0548       
    coh25=2.08679               1.0959                    1.0959                     1.0959                    2.0548                    3.0137                   1.0959                    1.0959                   1.0959                    2.0548                   3.0137                    1.0959                      1.0959                      1.0959                     2.0548                     3.0137       
    coh26=3.0457                2.0548                    2.0548                     2.0548                    3.0137                    3.9726                   2.0548                    2.0548                   2.0548                    3.0137                   3.9726                    2.0548                      2.0548                      2.0548                     3.0137                     3.9726       
    coh27=4.0046                3.0137                    3.0137                     3.0137                    3.9726                    4.9315                   3.0137                    3.0137                   3.0137                    3.9726                   4.9315                    3.0137                      3.0137                      3.0137                     3.9726                     4.9315       
    coh28=4.96351               3.9726                    3.9726                     3.9726                    4.9315                    5.8904                   3.9726                    3.9726                   3.9726                    4.9315                   5.8904                    3.9726                      3.9726                      3.9726                     4.9315                     5.8904       
    coh29=5.92241               4.9315                    4.9315                     4.9315                    5.8904                    6.8493                   4.9315                    4.9315                   4.9315                    5.8904                   6.8493                    4.9315                      4.9315                      4.9315                     5.8904                     6.8493       
    coh30=6.88132               5.8904                    5.8904                     5.8904                    6.8493                    7.8082                   5.8904                    5.8904                   5.8904                    6.8493                   7.8082                    5.8904                      5.8904                      5.8904                     6.8493                     7.8082       
    coh31=7.84022               6.8493                    6.8493                     6.8493                    7.8082                    8.7671                   6.8493                    6.8493                   6.8493                    7.8082                   8.7671                    6.8493                      6.8493                      6.8493                     7.8082                     8.7671       
    coh32=8.79912               7.8082                    7.8082                     7.8082                    8.7671                     9.726                   7.8082                    7.8082                   7.8082                    8.7671                    9.726                    7.8082                      7.8082                      7.8082                     8.7671                      9.726       
    coh33=9.75803               8.7671                    8.7671                     8.7671                     9.726                    10.685                   8.7671                    8.7671                   8.7671                     9.726                   10.685                    8.7671                      8.7671                      8.7671                      9.726                     10.685       
    coh34=10.7169                9.726                     9.726                      9.726                    10.685                    11.644                    9.726                     9.726                    9.726                    10.685                   11.644                     9.726                       9.726                       9.726                     10.685                     11.644       
    coh35=11.6758               10.685                    10.685                     10.685                    11.644                    12.603                   10.685                    10.685                   10.685                    11.644                   12.603                    10.685                      10.685                      10.685                     11.644                     12.603       
    coh36=12.6347               11.644                    11.644                     11.644                    12.603                    13.562                   11.644                    11.644                   11.644                    12.603                   13.562                    11.644                      11.644                      11.644                     12.603                     13.562       
    coh37=13.5936               11.644                    12.603                     12.603                    13.562                    14.521                   11.644                    12.603                   12.603                    13.562                   14.521                    11.644                      12.603                      12.603                     13.562                     14.521       
    coh38=14.5525               12.603                    13.562                     13.562                    14.521                    15.479                   12.603                    13.562                   13.562                    14.521                   15.479                    12.603                      13.562                      13.562                     14.521                     15.479       
    coh39=15.5115               13.562                    14.521                     14.521                    15.479                    16.438                   13.562                    14.521                   14.521                    15.479                   16.438                    13.562                      14.521                      14.521                     15.479                     16.438       
    coh40=16.4704               14.521                    15.479                     15.479                    15.479                    17.397                   14.521                    15.479                   15.479                    15.479                   17.397                    14.521                      15.479                      15.479                     15.479                     17.397       
    coh41=17.4293               15.479                    16.438                     16.438                    16.438                    18.356                   15.479                    16.438                   16.438                    16.438                   18.356                    15.479                      16.438                      16.438                     16.438                     18.356       
    coh42=18.3882               16.438                    16.438                     17.397                    17.397                    19.315                   16.438                    16.438                   17.397                    17.397                   19.315                    16.438                      16.438                      17.397                     17.397                     19.315       
    coh43=19.3471               17.397                    17.397                     18.356                    18.356                    20.274                   17.397                    17.397                   18.356                    18.356                   20.274                    17.397                      17.397                      18.356                     18.356                     20.274       
    coh44=20.306                18.356                    18.356                     19.315                    19.315                    21.233                   18.356                    18.356                   19.315                    19.315                   21.233                    18.356                      18.356                      19.315                     19.315                     21.233       
    coh45=21.2649               19.315                    19.315                     20.274                    20.274                    21.233                   19.315                    19.315                   20.274                    20.274                   21.233                    19.315                      19.315                      20.274                     20.274                     21.233       
    coh46=22.2238               20.274                    20.274                     21.233                    21.233                    22.192                   20.274                    20.274                   21.233                    21.233                   22.192                    20.274                      20.274                      21.233                     21.233                     22.192       
    coh47=23.1827               21.233                    21.233                     22.192                    22.192                    23.151                   21.233                    21.233                   22.192                    22.192                   23.151                    21.233                      21.233                      22.192                     22.192                     23.151       
    coh48=24.1416               22.192                    22.192                     23.151                    23.151                     24.11                   22.192                    22.192                   23.151                    23.151                    24.11                    22.192                      22.192                      23.151                     23.151                      24.11       
    coh49=25.1005               23.151                    23.151                      24.11                     24.11                    25.068                   23.151                    23.151                    24.11                     24.11                   25.068                    23.151                      23.151                       24.11                      24.11                     25.068       
    coh50=26.0594                24.11                     24.11                     25.068                    25.068                    26.027                    24.11                     24.11                   25.068                    25.068                   26.027                     24.11                       24.11                      25.068                     25.068                     26.027       
    coh51=27.0183               25.068                    25.068                     26.027                    26.027                    26.986                   25.068                    25.068                   26.027                    26.027                   26.986                    25.068                      25.068                      26.027                     26.027                     26.986       
    coh52=27.9772               26.027                    26.027                     26.027                    26.986                    27.945                   26.027                    26.027                   26.027                    26.986                   27.945                    26.027                      26.027                      26.027                     26.986                     27.945       
    coh53=28.9361               26.986                    26.986                     26.986                    27.945                    28.904                   26.986                    26.986                   26.986                    27.945                   28.904                    26.986                      26.986                      26.986                     27.945                     28.904       
    coh54=29.895                27.945                    27.945                     27.945                    28.904                    29.863                   27.945                    27.945                   27.945                    28.904                   29.863                    27.945                      27.945                      27.945                     28.904                     29.863       
    coh55=30.8539               28.904                    28.904                     28.904                    29.863                    30.822                   28.904                    28.904                   28.904                    29.863                   30.822                    28.904                      28.904                      28.904                     29.863                     30.822       
    coh56=31.8128               29.863                    29.863                     29.863                    30.822                    31.781                   29.863                    29.863                   29.863                    30.822                   31.781                    29.863                      29.863                      29.863                     30.822                     31.781       
    coh57=32.7717               30.822                    30.822                     30.822                    31.781                     32.74                   30.822                    30.822                   30.822                    31.781                    32.74                    30.822                      30.822                      30.822                     31.781                      32.74       
    coh58=33.7306               31.781                    31.781                     31.781                     32.74                    33.699                   31.781                    31.781                   31.781                     32.74                   33.699                    31.781                      31.781                      31.781                      32.74                     33.699       
    coh59=34.6895                32.74                     32.74                      32.74                    33.699                    34.658                    32.74                     32.74                    32.74                    33.699                   34.658                     32.74                       32.74                       32.74                     33.699                     34.658       
    coh60=35.6484               33.699                    33.699                     33.699                    34.658                    35.616                   33.699                    33.699                   33.699                    34.658                   35.616                    33.699                      33.699                      33.699                     34.658                     35.616       
    coh61=36.6073               34.658                    34.658                     34.658                    35.616                    36.575                   34.658                    34.658                   34.658                    35.616                   36.575                    34.658                      34.658                      34.658                     35.616                     36.575       
    coh62=37.5662               35.616                    35.616                     35.616                    36.575                    37.534                   35.616                    35.616                   35.616                    36.575                   37.534                    35.616                      35.616                      35.616                     36.575                     37.534       
    coh63=38.5252               36.575                    36.575                     36.575                    37.534                    38.493                   36.575                    36.575                   36.575                    37.534                   38.493                    36.575                      36.575                      36.575                     37.534                     38.493       
    coh64=39.4841               37.534                    37.534                     37.534                    38.493                    39.452                   37.534                    37.534                   37.534                    38.493                   39.452                    37.534                      37.534                      37.534                     38.493                     39.452       
    coh65=40.443                38.493                    38.493                     38.493                    39.452                    40.411                   38.493                    38.493                   38.493                    39.452                   40.411                    38.493                      38.493                      38.493                     39.452                     40.411       
    coh66=41.4019               39.452                    39.452                     39.452                    40.411                     41.37                   39.452                    39.452                   39.452                    40.411                    41.37                    39.452                      39.452                      39.452                     40.411                      41.37       
    coh67=42.3608               39.452                    40.411                     40.411                     41.37                    42.329                   39.452                    40.411                   40.411                     41.37                   42.329                    39.452                      40.411                      40.411                      41.37                     42.329       
    coh68=43.3197               40.411                     41.37                      41.37                    42.329                    43.288                   40.411                     41.37                    41.37                    42.329                   43.288                    40.411                       41.37                       41.37                     42.329                     43.288       
    coh69=44.2786                41.37                    42.329                     42.329                    43.288                    44.247                    41.37                    42.329                   42.329                    43.288                   44.247                     41.37                      42.329                      42.329                     43.288                     44.247       
    coh70=45.2375               42.329                    43.288                     43.288                    44.247                    45.205                   42.329                    43.288                   43.288                    44.247                   45.205                    42.329                      43.288                      43.288                     44.247                     45.205       
    coh71=46.1964               43.288                    44.247                     44.247                    45.205                    46.164                   43.288                    44.247                   44.247                    45.205                   46.164                    43.288                      44.247                      44.247                     45.205                     46.164       
    coh72=47.1553               44.247                    45.205                     45.205                    45.205                    47.123                   44.247                    45.205                   45.205                    45.205                   47.123                    44.247                      45.205                      45.205                     45.205                     47.123       
    coh73=48.1142               45.205                    45.205                     46.164                    46.164                    48.082                   45.205                    45.205                   46.164                    46.164                   48.082                    45.205                      45.205                      46.164                     46.164                     48.082       
    coh74=49.0731               46.164                    46.164                     47.123                    47.123                    49.041                   46.164                    46.164                   47.123                    47.123                   49.041                    46.164                      46.164                      47.123                     47.123                     49.041       
    coh75=50.032                47.123                    47.123                     48.082                    48.082                        50                   47.123                    47.123                   48.082                    48.082                       50                    47.123                      47.123                      48.082                     48.082                         50       

</pre><img vspace="5" hspace="5" src="ff_abz_fibs_vf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_02.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_03.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_04.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_08.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_09.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_10.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_11.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_12.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_13.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_14.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_15.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_16.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_17.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_18.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_19.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_20.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_21.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_22.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_23.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_24.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_25.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_26.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_27.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_28.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_29.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_fibs_vf_30.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 21
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Solve For+Inf+Borr+Save Dynamic Programming Problem (Loop)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_abz_fibs_vf(varargin)
%% FF_ABZ_FIBS_VF borr + save one asset formal informal + loop
% This program solves the infinite horizon dynamic single asset and single
% shock problem with loops. This file contains codes that processes
% borrowing and handles formal and informal choices.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * mt_cons matrix states_n by shock_n matrix of optimal consumption
% levels, unlike modele without formal and informal choices, where we know
% c from coh and a, here this needed to be stored because it is the results
% from with joint category maximization problem.
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc/html/ffs_abz_fibs_set_default_param.html ffs_abz_fibs_set_default_param>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc/html/ffs_abz_fibs_get_funcgrid.html ffs_abz_fibs_get_funcgrid>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_min_c_cost_bridge.html ffs_fibs_min_c_cost_bridge>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_inf_bridge.html ffs_fibs_inf_bridge>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/paramfunc_fibs/html/ffs_fibs_min_c_cost.html ffs_fibs_min_c_cost>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html ff_az_vf_post>
%
% @seealso
%
% * for/inf + save + borr loop: <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf.html ff_abz_fibs_vf>
% * for/inf + borr vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf_vec.html ff_abz_fibs_vf_vec>
% * for/inf + borr optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_fibs/m_abz_solve/html/ff_abz_fibs_vf_vecsv.html ff_abz_fibs_vf_vecsv>
%

%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_abz_fibs_set_default_param(it_param_set);

% Note: param_map and support_map can be adjusted here or outside to override defaults
% To generate results as if formal informal do not matter
param_map('it_a_n') = 75;
param_map('fl_z_r_borr_n') = 3;
param_map('it_z_wage_n') = 5;
param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
% param_map('fl_r_fsv') = 0.025;
% param_map('fl_r_fbr') = 0.035;
% param_map('bl_b_is_principle') = false;
% param_map('st_forbrblk_type') = 'seg3';
% param_map('fl_forbrblk_brmost') = -19;
% param_map('fl_forbrblk_brleast') = -1;
% param_map('fl_forbrblk_gap') = -1.5;
% param_map('bl_b_is_principle') = false;

[armt_map, func_map] = ffs_abz_fibs_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_abz_fibs_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_abz_fibs_vf';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_a', 'mt_z_trans', 'ar_z_r_borr_mesh_wage', 'ar_z_wage_mesh_r_borr'});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

% Formal choice Menu/Grid and Interest Rate Menu/Grid
params_group = values(armt_map, {'ar_forbrblk_r', 'ar_forbrblk'});
[ar_forbrblk_r, ar_forbrblk] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_coh', 'f_cons_coh_fbis', 'f_cons_coh_save'});
[f_util_log, f_util_crra, f_coh, f_cons_coh_fbis, f_cons_coh_save] = params_group{:};

% param_map
params_group = values(param_map, {'it_a_n', 'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min',...
    'fl_nan_replace', 'bl_default', 'bl_bridge', 'bl_rollover', 'fl_default_aprime'});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, ...
    fl_nan_replace, bl_default, bl_bridge, bl_rollover, fl_default_aprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% param_map, Formal informal
params_group = values(param_map, {'fl_r_fsv', 'bl_b_is_principle'});
[fl_r_fsv, bl_b_is_principle] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_display_minccost', 'bl_display_infbridge', ...
    'bl_time', 'bl_display_defparam', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_display_minccost, bl_display_infbridge, ...
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};

%% Display Parameters

if (bl_display_defparam)
    fft_container_map_display(param_map);
    fft_container_map_display(support_map);
end

%% Initialize Output Matrixes

mt_val_cur = zeros(it_a_n,it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n,it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_cons = zeros(it_a_n,it_z_n);

% collect optimal borrowing formal and informal choices
mt_pol_b_bridge = zeros(it_a_n,it_z_n);
mt_pol_inf_borr_nobridge = zeros(it_a_n,it_z_n);
mt_pol_for_borr = zeros(it_a_n,it_z_n);
mt_pol_for_save = zeros(it_a_n,it_z_n);

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Utility at-Default/at-limiting-case-when-nodefault
if (fl_crra == 1)
    fl_u_cmin = f_util_log(fl_c_min);
else
    fl_u_cmin = f_util_crra(fl_c_min);
end


% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Iterate over a and z states
    % handling borrowing and default possibility

    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n
        
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        % loop 2: over endogenous states
        for it_a_j = 1:it_a_n

            % Get asset state
            fl_a = ar_a(it_a_j);

            % Initialize storage
            ar_val_cur = zeros(size(ar_a));
            ar_c_cur = zeros(size(ar_a));
            ar_b_bridge = zeros(size(ar_a));
            ar_inf_borr_nobridge = zeros(size(ar_a));
            ar_for_borr = zeros(size(ar_a));
            ar_for_save = zeros(size(ar_a));

            % calculate cash on hand
            fl_coh = f_coh(fl_z_wage, fl_a);

            % loop 3: over choices
            for it_ap_k = 1:it_a_n

                % get next period asset choice
                fl_ap = ar_a(it_ap_k);

                %% Compute Consumption given Borrowing and Savings
                % find the today's consumption maximizing formal and informal
                % choices given a' and coh. The formal and informal choices need to
                % generate exactly a', but depending on which formal and informal
                % joint choice is used, the consumption cost today a' is different.
                % Note here, a is principle + interests. Three areas:
                %
                % * *CASE A* a' > 0: savings, do not need to optimize over formal and
                % informal choices
                % * *CASE B* a' < 0 & coh < 0: need bridge loan to pay for unpaid debt, and
                % borrowing over-all, need to first pick bridge loan to pay for
                % debt, if bridge loan is insufficient, go into default. After
                % bridge loan, optimize over formal+informal, borrow+save joint
                % choices.
                % * *CASE C* $ a' < 0 & coh > 0: do not need to get informal bridge loans,
                % optimize over for+inf save, for+save+borr, inf+borr only, for
                % borrow only.
                %

                if (fl_ap < 0)

                    % Calculate Bridge Loan Borrowing
                    if (bl_bridge && fl_coh < 0)

                        bl_input_override = true;
                        [fl_aprime_nobridge, fl_b_bridge, fl_c_bridge] = ffs_fibs_inf_bridge(...
                            bl_b_is_principle, fl_z_r_borr, fl_ap, fl_coh, ...
                            bl_display_infbridge, bl_input_override);

                    else

                        fl_aprime_nobridge = fl_ap;
                        fl_b_bridge = 0;
                        fl_c_bridge = 0;

                    end

                    % Find Optimal Formal Informal Borrow Save Combo
                    % calculate consumption gain from formal + informal
                    % borrowing and savings choices.
                    bl_input_override = true;
                    [fl_max_c_nobridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = ...
                        ffs_fibs_min_c_cost(...
                        bl_b_is_principle, fl_z_r_borr, fl_r_fsv, ...
                        ar_forbrblk_r, ar_forbrblk, ...
                        fl_aprime_nobridge, bl_display_minccost, bl_input_override);

                    % Compute Consumption given Formal and Informal joint
                    % consumption with formal borrow menu + bridge loans.
                    fl_c = f_cons_coh_fbis(fl_coh, fl_max_c_nobridge + fl_c_bridge);

                else

                    % consumption with savings
                    fl_c = f_cons_coh_save(fl_coh, fl_ap);

                    % assign values for formal and informal choices
                    % possible that fl_coh < 0, but if then fl_ap > 0 is
                    % not valid choice
                    [fl_b_bridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = deal(0, 0, 0, fl_ap);

                end

                %% Compute Utility With Default
                % if rollover is not allowed and bridge is not allowed,
                % then as long as coh <= 0, also treat as not allowed
                % states.
                % assign u(c)
                if (fl_c <= fl_c_min || ...
                    ( ~bl_rollover && ~bl_bridge && fl_coh < fl_c_min))

                    if (bl_default)
                        % defaults
                        % current utility: only today u(cmin)
                        ar_val_cur(it_ap_k) = fl_u_cmin;
                        % transition out next period, debt wiped out
                        for it_az_q = 1:it_z_n
                            ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + ...
                                fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur((ar_a == fl_default_aprime), it_az_q);
                        end

                        % Replace Consumption if default cmin
                        fl_c = fl_c_min;
                    else
                        % if default is not allowed: v = fl_nan_replace
                        ar_val_cur(it_ap_k) = fl_nan_replace;

                        % Replace Consumption if no default nan
                        fl_c = 0;
                    end

                    % no action, defaulting
                    fl_b_bridge = 0;
                    fl_inf_borr_nobridge = 0;
                    fl_for_borr = 0;
                    fl_for_save = 0;

                else
                    % Solve Optimization Problem: max_{a'} u(c(a,a',z)) + beta*EV(a',z')
                    % borrowed enough to pay debt (and borrowing limit not exceeded)
                    % saved only the coh available.
                    % current utility
                    if (fl_crra == 1)
                        ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    else
                        ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    end
                    % loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
                    for it_az_q = 1:it_z_n
                        ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + ...
                            fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur(it_ap_k, it_az_q);
                    end
                end

                %% Store Values

                % Could get the formal and informal values from
                % ffs_fibs_min_c_cost_bridge.m
%                 bl_input_override = true;
%                 [fl_c, fl_b_bridge, fl_inf_borr_nobridge, fl_for_borr, fl_for_save] = ...
%                     ffs_fibs_min_c_cost_bridge(fl_ap, fl_coh, ...
%                     param_map, support_map, armt_map, func_map, bl_input_override);

                % Store consumption
                ar_c_cur(it_ap_k) = fl_c;

                % Save/Update Borrowing Information
                ar_b_bridge(it_ap_k) = fl_b_bridge;
                ar_inf_borr_nobridge(it_ap_k) = fl_inf_borr_nobridge;
                ar_for_borr(it_ap_k) = fl_for_borr;
                ar_for_save(it_ap_k) = fl_for_save;

            end

            %% Optimize over Next Period Asset Choices
            % optimal choice value
            [fl_opti_val_z, fl_opti_idx_z] = max(ar_val_cur);
            fl_opti_aprime_z = ar_a(fl_opti_idx_z);
            fl_opti_c_z = ar_c_cur(fl_opti_idx_z);

            % corresponding optimal borrowing and savings choices
            fl_opti_b_bridge = ar_b_bridge(fl_opti_idx_z);
            fl_opti_inf_borr_nobridge = ar_inf_borr_nobridge(fl_opti_idx_z);
            fl_opti_for_borr = ar_for_borr(fl_opti_idx_z);
            fl_opti_for_save = ar_for_save(fl_opti_idx_z);

            %% Find Optimal Choices for Defaults or Not
            % Handle Default is optimal or not
            if (fl_opti_c_z <= fl_c_min)
                if (bl_default)
                    % if defaulting is optimal choice, at these states, not required
                    % to default, non-default possible, but default could be optimal
                    fl_opti_aprime_z = fl_default_aprime;
                else
                    % if default is not allowed, then next period same state as now
                    % this is absorbing state, this is the limiting case, single
                    % state space point, lowest a and lowest shock has this.
                    fl_opti_aprime_z = min(ar_a);
                end
            end

            %% Store Optimal Choices and Value Given(a,z)

            % store overal savings, value and consumption
            mt_val(it_a_j,it_z_i) = fl_opti_val_z;
            mt_pol_a(it_a_j,it_z_i) = fl_opti_aprime_z;
            mt_pol_cons(it_a_j,it_z_i) = fl_opti_c_z;

            % store savings and borrowing formal and inf optimal choices
            mt_pol_b_bridge(it_a_j,it_z_i) = fl_opti_b_bridge;
            mt_pol_inf_borr_nobridge(it_a_j,it_z_i) = fl_opti_inf_borr_nobridge;
            mt_pol_for_borr(it_a_j,it_z_i) = fl_opti_for_borr;
            mt_pol_for_save(it_a_j,it_z_i) = fl_opti_for_save;

        end
    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); ...
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'Hval', 'Hap'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('Hval = mt_val_cur(it_a_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_a_n,:), highest a state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;

result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_coh') = {f_coh(ar_z_r_borr_mesh_wage, ar_a'), zeros(1)};

result_map('cl_mt_pol_c') = {mt_pol_cons, zeros(1)};
result_map('cl_mt_pol_b_bridge') = {mt_pol_b_bridge, zeros(1)};
result_map('cl_mt_pol_inf_borr_nobridge') = {mt_pol_inf_borr_nobridge, zeros(1)};
result_map('cl_mt_pol_for_borr') = {mt_pol_for_borr, zeros(1)};
result_map('cl_mt_pol_for_save') = {mt_pol_for_save, zeros(1)};

result_map('ar_st_pol_names') = ["cl_mt_pol_a", "cl_mt_pol_coh", "cl_mt_pol_c", ...
    "cl_mt_pol_b_bridge", "cl_mt_pol_inf_borr_nobridge", "cl_mt_pol_for_borr", "cl_mt_pol_for_save"];

% Get Discrete Choice Outcomes
result_map = ffs_fibs_identify_discrete(result_map, bl_input_override);

%% Post Solution Graph and Table Generation
% Note in comparison with *abz*, results here, even when using identical
% parameters would differ because in *abz* solved where choices are
% principle. Here choices are principle + interests in order to facilitate
% using the informal choice functions.
%
% Note that this means two things are
% different, on the one hand, the value of asset for to coh is different
% based on the grid of assets. If the asset grid is negative, now per grid
% point, there is more coh because that grid point of asset no longer has
% interest rates. On the other hand, if one has positive asset grid point
% on arrival, that is worth less to coh. Additionally, when making choices
% for the next period, now choices aprime includes interests. What these
% mean is that the a grid no longer has the same meaning. We should expect
% at higher savings levels, for the same grid points, if optimal grid
% choices are the same as before, consumption should be lower when b
% includes interest rates and principle. This is however, not true when
% arriving in a period with negative a levels, for the same negative a
% level and same a prime negative choice, could have higher consumption
% here becasue have to pay less interests on debt. This tends to happen for
% smaller levels of borrowing choices.
%
% Graphically, when using interest + principle, big difference in
% consumption as a fraction of (coh - aprime) figure. In those figures,
% when counting in principles only, the gap in coh and aprime is
% consumption, but now, as more is borrowed only a small fraction of coh
% and aprime gap is consumption, becuase aprime/(1+r) is put into
% consumption.

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);

    % Standard AZ graphs
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);

    % Graphs for results_map with FIBS contents
    result_map = ff_az_fibs_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>