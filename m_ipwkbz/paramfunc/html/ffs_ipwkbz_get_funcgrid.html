
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-01"><meta name="DC.source" content="ffs_ipwkbz_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZ_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters</a></li><li><a href="#5">Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#6">Get Shock Grids</a></li><li><a href="#7">Get Equations</a></li><li><a href="#8">Generate Cash-on-Hand/State Matrix</a></li><li><a href="#9">Check if COH is within Borrowing Bounds</a></li><li><a href="#10">Update Valid 2nd stage choice matrix</a></li><li><a href="#11">Select only Valid (k(w), a) choices</a></li><li><a href="#12">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#13">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#14">Generate Interpolation Consumption Grid</a></li><li><a href="#15">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#16">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</a></li><li><a href="#17">Store armt_map (2): First Stage Aggregate Savings</a></li><li><a href="#18">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</a></li><li><a href="#19">Store armt_map (4): Shock Grids</a></li><li><a href="#20">Store Function Map</a></li><li><a href="#21">Graph</a></li><li><a href="#23">Graph 1: a and k choice grid graphs</a></li><li><a href="#24">Graph 2: coh by shock</a></li><li><a href="#25">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#27">Graph Details, Generally do Not Run</a></li><li><a href="#29">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#30">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#32">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZ_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>centralized gateway for retrieving parameters, and solution grids and functions. Similar to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a> function. This code deals with problems with savings and borrowing.</p><p>The graphs below show the difference between percentage choice grid and level choice grid. See comments by graphs below for explanations of differences between the choice grids here and choice grids in the ffs_akz_get_funcgrid function.</p><p>Note that for borrowing, we can not start at the min(coh(k,w-k,z)) reacheable given the w and k choice grids. That would be: min(coh(k,w-k,z)) &lt; min(w). At min(coh), there is a single point, and also for all values between min(coh) and min(w), all percentage w_perc choices are below min(w), requiring extrapolation. It is in some sense safer to extrapolate by starting solution at min(coh) = min(w). Now, for the lowest levels of coh(k, w-k, z), which are &lt; min(w), we now require extrapolation. But this extrapolation is straight forward, when coh &lt; min(w), households have to default, the utility from default is the same regardless of the level of coh at the time of default. So nearest extrapolation is fully correct.</p><p>Note that the first stage w grid is based on cash-on-hand level reached by the coh(k,w-k,z) possible choice and shock combinations. This coh(k,w-k,z) &gt; max(w), which also means that at max(coh) grid, the w_perc choices at higher points require extrapolation. Extrapolation is based on nearest extrapolation.</p><p>Note that even when w = 0, as long as interest rate is low, only the lowest level of borrowing is invalid.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param bl_input_override boolean if true varargin contained param_map and support_map fully overrides local default. Local default is not invoked. This could be important for speed if this function is getting invoked within certain loops. Default is 0.</p><p>@return armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@return func_map container container with function handles for consumption cash-on-hand etc.</p><p>@example</p><pre>  it_param_set = 2;
  bl_input_override = true;
  [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);
  [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);</pre><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_functions.m">ffs_ipwkbz_set_functions</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/ffto_gen_tauchen_jhl.m">ffto_gen_tauchen_jhl</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/fft_gen_grid_loglin.m">fft_gen_grid_loglin</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">bl_input_override = 0;
<span class="keyword">if</span> (length(varargin) == 3)
    bl_input_override = varargin{3};
<span class="keyword">end</span>
<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% override when called from outside</span>
    [param_map, support_map, ~] = varargin{:};
<span class="keyword">else</span>
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbz_set_default_param();
    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = true;

    <span class="comment">% to be able to visually see choice grid points</span>
    param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
    param_map(<span class="string">'fl_default_aprime'</span>) = 0;
    param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

    param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
    param_map(<span class="string">'it_w_perc_n'</span>) = 25;
    param_map(<span class="string">'it_ak_perc_n'</span>) = 45;
    param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
    param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameters</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_z_mu'</span>, <span class="string">'fl_z_rho'</span>, <span class="string">'fl_z_sig'</span>});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>, <span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, <span class="keyword">...</span>
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_k_min'</span>, <span class="string">'fl_k_max'</span>, <span class="string">'it_ak_perc_n'</span>});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>, <span class="string">'it_c_interp_grid_gap'</span>});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>});
[fl_r_save, fl_r_borr, fl_w] = params_group{:};

params_group = values(support_map, {<span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
</pre><h2 id="5">Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_default_param.html">ffs_ipwkbz_set_default_param</a> for details.</p><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = linspace(fl_w_min, fl_w_max, it_w_interp_n);
ar_w_level = ar_w_level_full;

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>

ar_a_meshk_full = mt_a(:);
ar_k_mesha_full = mt_k(:);

ar_a_meshk = ar_a_meshk_full;
ar_k_mesha = ar_k_mesha_full;
</pre><h2 id="6">Get Shock Grids</h2><pre class="codeinput">[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);
</pre><h2 id="7">Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbz_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_r_save, fl_r_borr, fl_w);
</pre><h2 id="8">Generate Cash-on-Hand/State Matrix</h2><p>The endogenous state variable is cash-on-hand, it has it_z_n*it_a_n number of points, covering all reachable points when ar_a is the choice vector and ar_z is the shock vector. requires inputs from get Asset and choice grids, get shock grids, and get equations above.</p><pre class="codeinput">mt_coh_wkb_full = f_coh(ar_z, ar_a_meshk_full, ar_k_mesha_full);


<span class="keyword">if</span> (bl_display_funcgrids)

    <span class="comment">% Generate Aggregate Variables</span>
    ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([ar_aplusk_mesha, ar_k_mesha_full, ar_a_meshk_full]);
    cl_col_names = {<span class="string">'ar_aplusk_mesha'</span>, <span class="string">'ar_k_mesha_full'</span>, <span class="string">'ar_a_meshk_full'</span>};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesha'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk_full'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk_full*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha_full'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha_full*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));


    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;
*ar_k_mesha_full*:
*ar_a_meshk_full*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        1575           3

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3
    ar_aplusk_mesha    ar_k_mesha_full    ar_a_meshk_full
    _______________    _______________    _______________

            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
            -20                   0               -20    
        -17.941           0.0020588           -17.943    
        -17.941            0.048757            -17.99    
        -17.941            0.095455           -18.037    
        -17.941             0.14215           -18.083    
        -17.941             0.18885            -18.13    
        -17.941             0.23555           -18.177    
        -17.941             0.28225           -18.223    
        -17.941             0.32894            -18.27    
        -17.941             0.37564           -18.317    
        -17.941             0.42234           -18.364    
        -17.941             0.46904            -18.41    
        -17.941             0.51574           -18.457    
        -17.941             0.56243           -18.504    
        -17.941             0.60913            -18.55    
        -17.941             0.65583           -18.597    
        -17.941             0.70253           -18.644    
        -17.941             0.74922            -18.69    
        -17.941             0.79592           -18.737    
        -17.941             0.84262           -18.784    
        -17.941             0.88932            -18.83    
        -17.941             0.93602           -18.877    
        -17.941             0.98271           -18.924    
        -17.941              1.0294           -18.971    
        -17.941              1.0761           -19.017    
        -17.941              1.1228           -19.064    

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3
    ar_aplusk_mesha    ar_k_mesha_full    ar_a_meshk_full
    _______________    _______________    _______________

        47.941             30.889              17.053    
        47.941              32.43              15.512    
        47.941             33.971              13.971    
        47.941             35.512               12.43    
        47.941             37.053              10.889    
        47.941             38.594              9.3475    
        47.941             40.135              7.8065    
        47.941             41.676              6.2654    
        47.941             43.217              4.7244    
        47.941             44.758              3.1834    
        47.941             46.299              1.6424    
        47.941              47.84             0.10132    
        47.941             49.381             -1.4397    
        47.941             50.922             -2.9807    
        47.941             52.463             -4.5218    
        47.941             54.004             -6.0628    
        47.941             55.545             -7.6038    
        47.941             57.086             -9.1449    
        47.941             58.627             -10.686    
        47.941             60.168             -12.227    
        47.941             61.709             -13.768    
        47.941              63.25             -15.309    
        47.941             64.791              -16.85    
        47.941             66.332             -18.391    
        47.941             67.873             -19.932    
            50               0.07               49.93    
            50             1.6577              48.342    
            50             3.2455              46.755    
            50             4.8332              45.167    
            50             6.4209              43.579    
            50             8.0086              41.991    
            50             9.5964              40.404    
            50             11.184              38.816    
            50             12.772              37.228    
            50              14.36               35.64    
            50             15.947              34.053    
            50             17.535              32.465    
            50             19.123              30.877    
            50              20.71               29.29    
            50             22.298              27.702    
            50             23.886              26.114    
            50             25.474              24.526    
            50             27.061              22.939    
            50             28.649              21.351    
            50             30.237              19.763    
            50             31.825              18.175    
            50             33.412              16.588    
            50                 35                  15    
            50             36.588              13.412    
            50             38.175              11.825    
            50             39.763              10.237    
            50             41.351              8.6491    
            50             42.939              7.0614    
            50             44.526              5.4736    
            50             46.114              3.8859    
            50             47.702              2.2982    
            50              49.29             0.71045    
            50             50.877            -0.87727    
            50             52.465              -2.465    
            50             54.053             -4.0527    
            50              55.64             -5.6405    
            50             57.228             -7.2282    
            50             58.816             -8.8159    
            50             60.404             -10.404    
            50             61.991             -11.991    
            50             63.579             -13.579    
            50             65.167             -15.167    
            50             66.755             -16.755    
            50             68.342             -18.342    
            50              69.93              -19.93    

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        1575          15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -17.909             -17.903             -17.896             -17.889              -17.88              -17.87             -17.858             -17.844             -17.829              -17.811               -17.79              -17.766              -17.738              -17.706              -17.669     
        -17.834             -17.816             -17.795             -17.771             -17.744             -17.712             -17.675             -17.633             -17.584              -17.528              -17.463              -17.388              -17.301              -17.201              -17.086     
        -17.807             -17.784             -17.758             -17.727             -17.692             -17.651             -17.605             -17.551             -17.488              -17.417              -17.334              -17.238              -17.128              -17.001              -16.854     
        -17.789             -17.762             -17.732             -17.697             -17.656             -17.609             -17.555             -17.493             -17.421              -17.338              -17.243              -17.132              -17.005              -16.858              -16.689     
        -17.775             -17.746             -17.712             -17.673             -17.628             -17.576             -17.517             -17.448             -17.368              -17.276               -17.17              -17.048              -16.907              -16.745              -16.557     
        -17.764             -17.733             -17.696             -17.654             -17.605             -17.549             -17.484              -17.41             -17.323              -17.224              -17.109              -16.977              -16.824              -16.648              -16.445     
        -17.755             -17.722             -17.683             -17.637             -17.586             -17.526             -17.457             -17.377             -17.285              -17.179              -17.056              -16.915              -16.752              -16.564              -16.348     
        -17.748             -17.712             -17.671             -17.623             -17.568             -17.505             -17.432             -17.348             -17.251              -17.138              -17.009               -16.86              -16.688              -16.489               -16.26     
        -17.741             -17.704             -17.661             -17.611             -17.553             -17.487              -17.41             -17.322              -17.22              -17.102              -16.966               -16.81              -16.629              -16.421              -16.181     
        -17.736             -17.697             -17.651             -17.599             -17.539              -17.47              -17.39             -17.298             -17.192              -17.069              -16.927              -16.764              -16.576              -16.359              -16.108     
        -17.731              -17.69             -17.643             -17.589             -17.527             -17.455             -17.372             -17.276             -17.166              -17.038              -16.891              -16.722              -16.526              -16.301              -16.041     
        -17.726             -17.684             -17.636              -17.58             -17.515             -17.441             -17.355             -17.256             -17.142               -17.01              -16.858              -16.683               -16.48              -16.247              -15.978     
        -17.723             -17.679             -17.629             -17.572             -17.505             -17.428              -17.34             -17.237              -17.12              -16.984              -16.827              -16.646              -16.437              -16.196              -15.918     
        -17.719             -17.675             -17.623             -17.564             -17.495             -17.416             -17.325              -17.22             -17.099              -16.959              -16.797              -16.611              -16.396              -16.148              -15.863     
        -17.716             -17.671             -17.618             -17.557             -17.486             -17.405             -17.312             -17.204             -17.079              -16.935               -16.77              -16.578              -16.358              -16.103               -15.81     
        -17.714             -17.667             -17.613              -17.55             -17.478             -17.395             -17.299             -17.188              -17.06              -16.913              -16.743              -16.547              -16.321               -16.06              -15.759     
        -17.712             -17.664             -17.608             -17.544              -17.47             -17.385             -17.287             -17.174             -17.043              -16.892              -16.718              -16.518              -16.286              -16.019              -15.711     
         -17.71              -17.66             -17.604             -17.538             -17.463             -17.376             -17.276              -17.16             -17.026              -16.872              -16.694              -16.489              -16.253               -15.98              -15.665     
        -17.708             -17.658               -17.6             -17.533             -17.456             -17.367             -17.265             -17.147              -17.01              -16.853              -16.672              -16.462              -16.221              -15.942              -15.621     
        -17.706             -17.655             -17.596             -17.528              -17.45             -17.359             -17.255             -17.134             -16.995              -16.835               -16.65              -16.436               -16.19              -15.906              -15.579     
        -17.705             -17.653             -17.593             -17.524             -17.444             -17.351             -17.245             -17.122             -16.981              -16.817              -16.629              -16.411              -16.161              -15.871              -15.538     
        -17.704             -17.651              -17.59             -17.519             -17.438             -17.344             -17.236             -17.111             -16.967                -16.8              -16.609              -16.387              -16.132              -15.838              -15.498     
        -17.703             -17.649             -17.587             -17.515             -17.433             -17.337             -17.227               -17.1             -16.953              -16.784              -16.589              -16.364              -16.105              -15.806               -15.46     
        -17.702             -17.648             -17.584             -17.511             -17.427              -17.33             -17.219             -17.089             -16.941              -16.769              -16.571              -16.342              -16.078              -15.774              -15.423     
        -17.702             -17.646             -17.582             -17.508             -17.423             -17.324              -17.21             -17.079             -16.928              -16.754              -16.553               -16.32              -16.053              -15.744              -15.388     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         47.535              47.718               47.93              48.174              48.455               48.78              49.155              49.587              50.086              50.661               51.324                52.09               52.972               53.991               55.166      
         47.394               47.58              47.796              48.044              48.331              48.661              49.043              49.483               49.99              50.575               51.251               52.029               52.928               53.964                55.16      
         47.252              47.442              47.661              47.914              48.205              48.541              48.929              49.376              49.892              50.488               51.174               51.966                52.88               53.934                55.15      
         47.111              47.303              47.526              47.783              48.079               48.42              48.814              49.269              49.793              50.398               51.095                 51.9               52.829                 53.9               55.135      
         46.968              47.164               47.39              47.651              47.951              48.298              48.698              49.159              49.692              50.306               51.014               51.832               52.774               53.862               55.116      
         46.825              47.024              47.253              47.518              47.823              48.175              48.581              49.049              49.589              50.212               50.931                51.76               52.717               53.821               55.094      
         46.682              46.883              47.116              47.384              47.693               48.05              48.462              48.937              49.485              50.117               50.846               51.687               52.657               53.776               55.068      
         46.538              46.742              46.978               47.25              47.563              47.925              48.343              48.824              49.379               50.02               50.759               51.612               52.595               53.729               55.038      
         46.394              46.601              46.839              47.115              47.433              47.799              48.222               48.71              49.272              49.921                50.67               51.534                52.53                53.68               55.006      
         46.249              46.458                46.7              46.979              47.301              47.672                48.1              48.594              49.164              49.822                50.58               51.455               52.464               53.628                54.97      
         46.104              46.316              46.561              46.843              47.169              47.545              47.978              48.478              49.055               49.72               50.488               51.373               52.395               53.573               54.932      
         45.958              46.173              46.421              46.706              47.036              47.416              47.855              48.361              48.944              49.618               50.394                51.29               52.324               53.516               54.891      
         45.813               46.03               46.28              46.569              46.903              47.287              47.731              48.243              48.833              49.514                 50.3               51.206               52.251               53.457               54.848      
         45.667              45.886              46.139              46.432              46.769              47.158              47.606              48.124              48.721              49.409               50.203                51.12               52.177               53.396               54.803      
          45.52              45.742              45.998              46.294              46.634              47.027              47.481              48.004              48.607              49.303               50.106               51.032               52.101               53.333               54.755      
         45.373              45.598              45.857              46.155              46.499              46.896              47.355              47.883              48.493              49.196               50.007               50.943               52.023               53.268               54.705      
         45.227              45.453              45.714              46.016              46.364              46.765              47.228              47.762              48.378              49.088               49.908               50.853               51.944               53.202               54.653      
         45.079              45.308              45.572              45.877              46.228              46.633                47.1               47.64              48.262              48.979               49.807               50.762               51.863               53.134               54.599      
         44.932              45.163              45.429              45.737              46.091              46.501              46.972              47.517              48.145              48.869               49.705               50.669               51.781               53.064               54.543      
         44.784              45.017              45.286              45.597              45.955              46.368              46.844              47.393              48.027              48.758               49.602               50.575               51.697               52.992               54.486      
         44.636              44.872              45.143              45.456              45.817              46.234              46.715              47.269              47.909              48.647               49.498                50.48               51.613               52.919               54.427      
         44.488              44.726              44.999              45.315               45.68                46.1              46.585              47.145               47.79              48.535               49.393               50.384               51.527               52.845               54.366      
          44.34              44.579              44.856              45.174              45.542              45.966              46.455              47.019               47.67              48.421               49.288               50.287                51.44                52.77               54.304      
         44.191              44.433              44.711              45.033              45.404              45.831              46.325              46.894               47.55              48.308               49.181               50.189               51.352               52.693                54.24      
         44.042              44.286              44.567              44.891              45.265              45.696              46.194              46.767              47.429              48.193               49.074                50.09               51.262               52.614               54.174      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.936                  52              52.074              52.159              52.258              52.371              52.502              52.652              52.826              53.027               53.259               53.526               53.834               54.189               54.599      
         51.884              51.965              52.059              52.168              52.293              52.437              52.604              52.796              53.017              53.273               53.568               53.908                 54.3               54.753               55.275      
         51.799              51.893              52.001              52.127              52.271              52.438               52.63              52.851              53.107              53.402               53.742               54.135               54.588                55.11               55.713      
         51.698              51.802              51.922              52.061              52.221              52.406              52.618              52.864              53.147              53.474               53.851               54.286               54.787               55.366               56.033      
         51.587                51.7               51.83              51.981              52.154              52.354              52.584               52.85              53.157               53.51               53.919               54.389               54.932               55.559               56.282      
          51.47              51.591               51.73               51.89              52.075              52.288              52.534              52.818              53.145              53.523               53.958               54.461                55.04               55.709                56.48      
         51.348              51.475              51.622              51.791              51.987              52.212              52.472              52.772              53.118              53.517               53.977               54.508                55.12               55.827               56.642      
         51.222              51.355              51.509              51.687              51.892              52.128              52.401              52.715              53.078              53.497               53.979               54.536               55.179                55.92               56.775      
         51.092              51.232              51.392              51.578              51.791              52.038              52.322               52.65              53.029              53.465               53.969                54.55                55.22               55.993               56.885      
         50.961              51.105              51.272              51.464              51.686              51.942              52.238              52.578              52.971              53.425               53.948               54.551               55.247                56.05               56.976      
         50.827              50.976              51.149              51.348              51.578              51.842              52.148              52.501              52.907              53.376               53.918               54.542               55.262               56.093               57.051      
         50.691              50.845              51.023              51.229              51.466              51.739              52.054              52.418              52.837              53.321                53.88               54.524               55.267               56.124               57.112      
         50.553              50.712              50.895              51.107              51.351              51.632              51.956              52.331              52.762              53.261               53.835               54.498               55.263               56.145               57.162      
         50.415              50.578              50.766              50.983              51.233              51.522              51.855               52.24              52.683              53.195               53.785               54.465               55.251               56.156               57.201      
         50.274              50.442              50.635              50.857              51.114               51.41              51.751              52.145                52.6              53.124               53.729               54.427               55.232                56.16               57.231      
         50.133              50.304              50.502               50.73              50.992              51.295              51.645              52.048              52.513               53.05               53.669               54.383               55.207               56.157               57.253      
         49.991              50.166              50.368                50.6              50.869              51.179              51.536              51.948              52.423              52.972               53.605               54.334               55.176               56.147               57.268      
         49.848              50.027              50.232               50.47              50.744               51.06              51.425              51.846              52.331              52.891               53.536               54.281               55.141               56.132               57.275      
         49.704              49.886              50.096              50.338              50.618               50.94              51.312              51.741              52.236              52.806               53.465               54.224                 55.1               56.111               57.277      
         49.559              49.745              49.959              50.205               50.49              50.818              51.197              51.634              52.138              52.719                53.39               54.164               55.056               56.086               57.273      
         49.414              49.603               49.82              50.071              50.361              50.695              51.081              51.525              52.038               52.63               53.312                 54.1               55.008               56.056               57.264      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         49.121              49.316              49.541              49.801                50.1              50.445              50.843              51.303              51.833              52.444               53.149               53.963               54.901               55.984               57.233      
         48.974              49.172              49.401              49.664              49.968              50.318              50.723              51.189              51.727              52.348               53.064                53.89               54.843               55.942                57.21      
         48.827              49.028              49.259              49.527              49.835              50.191              50.601              51.074               51.62               52.25               52.977               53.815               54.782               55.898               57.184      
         48.679              48.882              49.117              49.388              49.701              50.062              50.478              50.958              51.512              52.151               52.888               53.738               54.719                55.85               57.155      
          48.53              48.736              48.975              49.249              49.567              49.932              50.354              50.841              51.402               52.05               52.797               53.658               54.653               55.799               57.122      
         48.381               48.59              48.832               49.11              49.431              49.802              50.229              50.722              51.291              51.947               52.704               53.577               54.584               55.746               57.086      
         48.231              48.443              48.688               48.97              49.295               49.67              50.103              50.602              51.178              51.843               52.609               53.493               54.513                55.69               57.047      
         48.082              48.296              48.544              48.829              49.158              49.538              49.976              50.482              51.065              51.737               52.513               53.408               54.441               55.632               57.006      
         47.932              48.149              48.399              48.688              49.021              49.405              49.849               50.36               50.95               51.63               52.416               53.321               54.366               55.571               56.961      
         47.781              48.001              48.254              48.546              48.883              49.272               49.72              50.237              50.834              51.522               52.317               53.233               54.289               55.508               56.914      
          47.63              47.852              48.108              48.404              48.744              49.137              49.591              50.114              50.717              51.413               52.216               53.142               54.211               55.443               56.865      
         47.479              47.703              47.962              48.261              48.605              49.003              49.461               49.99              50.599              51.303               52.115               53.051               54.131               55.377               56.814      
         47.328              47.554              47.816              48.118              48.466              48.867               49.33              49.864              50.481              51.192               52.012               52.958               54.049               55.308                56.76      
         47.176              47.405              47.669              47.974              48.326              48.731              49.199              49.739              50.361              51.079               51.908               52.863               53.966               55.237               56.704      
         47.024              47.255              47.522               47.83              48.185              48.595              49.067              49.612              50.241              50.966               51.803               52.768               53.881               55.165               56.647      
         46.872              47.105              47.375              47.686              48.044              48.458              48.935              49.485               50.12              50.852               51.696               52.671               53.795               55.092               56.587      
         46.719              46.955              47.227              47.541              47.903               48.32              48.801              49.357              49.998              50.737               51.589               52.573               53.707               55.016               56.526      
         46.567              46.805              47.079              47.396              47.761              48.182              48.668              49.228              49.875              50.621               51.481               52.474               53.619               54.939               56.463      
         46.414              46.654              46.931               47.25              47.618              48.043              48.534              49.099              49.751              50.504               51.372               52.373               53.529               54.861               56.398      
         46.261              46.503              46.782              47.104              47.476              47.904              48.399              48.969              49.627              50.386               51.262               52.272               53.437               54.782               56.332      
         46.107              46.352              46.633              46.958              47.333              47.765              48.264              48.839              49.503              50.268               51.151                52.17               53.345               54.701               56.264      
         45.954                46.2              46.484              46.812              47.189              47.625              48.128              48.708              49.377              50.149                51.04               52.067               53.252               54.619               56.195      

</pre><h2 id="9">Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));
</pre><h2 id="10">Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="11">Select only Valid (k(w), a) choices</h2><pre class="codeinput"><span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);
</pre><h2 id="12">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>

<span class="comment">% This is borrowing with default or not condition</span>
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);
</pre><h2 id="13">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>
</pre><h2 id="14">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="15">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="16">Store armt_map (1): 2nd Stage Problem Arrays and Matrixes</h2><pre class="codeinput">armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_z_mesh_coh_wkb'</span>) = mt_z_mesh_coh_wkb;
</pre><h2 id="17">Store armt_map (2): First Stage Aggregate Savings</h2><p>w = k' + b', w is aggregate Savings%</p><div><ol><li><b>ar_w_perc</b> 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li><b>ar_w_level</b> 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li><b>mt_w_by_interp_coh_interp_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>) = mt_w_by_interp_coh_interp_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;
</pre><h2 id="18">Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids</h2><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
armt_map(<span class="string">'mt_z_mesh_coh_interp_grid'</span>) = mt_z_mesh_coh_interp_grid;
</pre><h2 id="19">Store armt_map (4): Shock Grids</h2><pre class="codeinput">armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
armt_map(<span class="string">'ar_stationary'</span>) = ar_stationary;
armt_map(<span class="string">'ar_z'</span>) = ar_z;
</pre><h2 id="20">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="21">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="23">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(mt_a, mt_k, <span class="string">'blue'</span>);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
        scatter(ar_a_meshk, ar_k_mesha, 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level_full) &lt;= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                                     ar_k_mesha_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title(<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span>)
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level_full) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_01.png" alt=""> <h2 id="24">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
        <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
        <span class="string">'For each w and z, coh maximizing k is different'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

    legendCell{length(legendCell) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'southeast'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_02.png" alt=""> <h2 id="25">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_03.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="27">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="29">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_04.png" alt=""> <img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_05.png" alt=""> <h2 id="30">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbz_get_funcgrid_06.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="32">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z));
    disp(ar_z);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_w_by_interp_coh_interp_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_coh_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_coh_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_interp_c_grid'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_interp_c_grid'));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_interp_coh_grid_mesh_z'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_a'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_a_meshk'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_a_meshk));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_k'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_k_mesha'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    <span class="keyword">for</span> i = 1:length(func_map)
        st_display = strjoin([<span class="string">'pos ='</span> num2str(i) <span class="string">'; key ='</span> string(param_map_keys{i}) <span class="string">'; val ='</span> func2str(param_map_vals{i})]);
        disp(st_display);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    35

  Columns 1 through 7

  -20.0000  -17.9412  -15.8824  -13.8235  -11.7647   -9.7059   -7.6471

  Columns 8 through 14

   -5.5882   -3.5294   -1.4706    0.5882    2.6471    4.7059    6.7647

  Columns 15 through 21

    8.8235   10.8824   12.9412   15.0000   17.0588   19.1176   21.1765

  Columns 22 through 28

   23.2353   25.2941   27.3529   29.4118   31.4706   33.5294   35.5882

  Columns 29 through 35

   37.6471   39.7059   41.7647   43.8235   45.8824   47.9412   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_w_by_interp_coh_interp_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    25    38

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -19.998                            -19.996                            -19.994                            -19.992                             -19.99                            -19.987                            -19.985                            -19.983                            -19.981                             -19.979                             -19.977                             -19.975                             -19.973                             -19.971                             -19.969                             -19.967                             -19.964                             -19.962                              -19.96                             -19.958                             -19.956                             -19.954                             -19.952                              -19.95                              -19.948                            -19.946                             -19.944                              -19.942                            -19.939                             -19.937                             -19.935                              -19.933                            -19.931                             -19.929                             -19.927                             -19.925                              -19.923            
                  -20                              -19.911                            -19.822                            -19.733                            -19.644                            -19.555                            -19.466                            -19.377                            -19.288                              -19.2                             -19.111                             -19.022                             -18.933                             -18.844                             -18.755                             -18.666                             -18.577                             -18.488                             -18.399                              -18.31                             -18.221                             -18.132                             -18.043                             -17.954                             -17.865                              -17.777                            -17.688                             -17.599                               -17.51                            -17.421                             -17.332                             -17.243                              -17.154                            -17.065                             -16.976                             -16.887                             -16.798                              -16.709            
                  -20                              -19.824                            -19.648                            -19.473                            -19.297                            -19.121                            -18.945                            -18.769                            -18.594                            -18.418                             -18.242                             -18.066                             -17.891                             -17.715                             -17.539                             -17.363                             -17.187                             -17.012                             -16.836                              -16.66                             -16.484                             -16.308                             -16.133                             -15.957                             -15.781                              -15.605                             -15.43                             -15.254                              -15.078                            -14.902                             -14.726                             -14.551                              -14.375                            -14.199                             -14.023                             -13.847                             -13.672                              -13.496            
                  -20                              -19.737                            -19.475                            -19.212                            -18.949                            -18.687                            -18.424                            -18.162                            -17.899                            -17.636                             -17.374                             -17.111                             -16.848                             -16.586                             -16.323                              -16.06                             -15.798                             -15.535                             -15.273                              -15.01                             -14.747                             -14.485                             -14.222                             -13.959                             -13.697                              -13.434                            -13.171                             -12.909                              -12.646                            -12.384                             -12.121                             -11.858                              -11.596                            -11.333                              -11.07                             -10.808                             -10.545                              -10.282            
                  -20                              -19.651                            -19.301                            -18.952                            -18.602                            -18.253                            -17.903                            -17.554                            -17.204                            -16.855                             -16.505                             -16.156                             -15.806                             -15.457                             -15.107                             -14.758                             -14.408                             -14.059                             -13.709                              -13.36                              -13.01                             -12.661                             -12.311                             -11.962                             -11.612                              -11.263                            -10.913                             -10.564                              -10.214                            -9.8649                             -9.5154                             -9.1659                              -8.8164                            -8.4669                             -8.1174                             -7.7679                             -7.4184                               -7.069            
                  -20                              -19.564                            -19.127                            -18.691                            -18.255                            -17.818                            -17.382                            -16.946                            -16.509                            -16.073                             -15.637                               -15.2                             -14.764                             -14.328                             -13.891                             -13.455                             -13.019                             -12.582                             -12.146                              -11.71                             -11.273                             -10.837                             -10.401                             -9.9642                             -9.5279                              -9.0916                            -8.6552                             -8.2189                              -7.7826                            -7.3462                             -6.9099                             -6.4735                              -6.0372                            -5.6009                             -5.1645                             -4.7282                             -4.2919                              -3.8555            
                  -20                              -19.477                            -18.954                             -18.43                            -17.907                            -17.384                            -16.861                            -16.338                            -15.815                            -15.291                             -14.768                             -14.245                             -13.722                             -13.199                             -12.675                             -12.152                             -11.629                             -11.106                             -10.583                             -10.059                             -9.5363                             -9.0131                             -8.4899                             -7.9667                             -7.4435                              -6.9203                            -6.3971                             -5.8739                              -5.3508                            -4.8276                             -4.3044                             -3.7812                               -3.258                            -2.7348                             -2.2116                             -1.6884                             -1.1653                             -0.64207            
                  -20                               -19.39                             -18.78                             -18.17                             -17.56                             -16.95                             -16.34                             -15.73                             -15.12                             -14.51                               -13.9                              -13.29                              -12.68                              -12.07                             -11.459                             -10.849                             -10.239                             -9.6294                             -9.0193                             -8.4093                             -7.7993                             -7.1892                             -6.5792                             -5.9691                             -5.3591                              -4.7491                             -4.139                              -3.529                               -2.919                            -2.3089                             -1.6989                             -1.0889                             -0.47882                            0.13122                             0.74126                              1.3513                              1.9613                               2.5714            
                  -20                              -19.303                            -18.606                            -17.909                            -17.212                            -16.516                            -15.819                            -15.122                            -14.425                            -13.728                             -13.031                             -12.334                             -11.637                              -10.94                             -10.244                             -9.5467                             -8.8498                             -8.1529                              -7.456                             -6.7592                             -6.0623                             -5.3654                             -4.6685                             -3.9716                             -3.2747                              -2.5778                            -1.8809                             -1.1841                             -0.48717                            0.20972                              0.9066                              1.6035                               2.3004                             2.9973                              3.6941                               4.391                              5.0879                               5.7848            
                  -20                              -19.216                            -18.433                            -17.649                            -16.865                            -16.081                            -15.298                            -14.514                             -13.73                            -12.946                             -12.163                             -11.379                             -10.595                             -9.8114                             -9.0277                              -8.244                             -7.4602                             -6.6765                             -5.8927                              -5.109                             -4.3253                             -3.5415                             -2.7578                             -1.9741                             -1.1903                             -0.40659                            0.37715                              1.1609                               1.9446                             2.7284                              3.5121                              4.2958                               5.0796                             5.8633                               6.647                              7.4308                              8.2145                               8.9983            

    mt_w_by_interp_coh_interp_grid1    mt_w_by_interp_coh_interp_grid2    mt_w_by_interp_coh_interp_grid3    mt_w_by_interp_coh_interp_grid4    mt_w_by_interp_coh_interp_grid5    mt_w_by_interp_coh_interp_grid6    mt_w_by_interp_coh_interp_grid7    mt_w_by_interp_coh_interp_grid8    mt_w_by_interp_coh_interp_grid9    mt_w_by_interp_coh_interp_grid10    mt_w_by_interp_coh_interp_grid11    mt_w_by_interp_coh_interp_grid12    mt_w_by_interp_coh_interp_grid13    mt_w_by_interp_coh_interp_grid14    mt_w_by_interp_coh_interp_grid15    mt_w_by_interp_coh_interp_grid16    mt_w_by_interp_coh_interp_grid17    mt_w_by_interp_coh_interp_grid18    mt_w_by_interp_coh_interp_grid19    mt_w_by_interp_coh_interp_grid20    mt_w_by_interp_coh_interp_grid21    mt_w_by_interp_coh_interp_grid22    mt_w_by_interp_coh_interp_grid23    mt_w_by_interp_coh_interp_grid24    mt_w_by_interp_coh_interp_grid25    mt_w_by_interp_coh_interp_grid26    mt_w_by_interp_coh_interp_grid27    mt_w_by_interp_coh_interp_grid28    mt_w_by_interp_coh_interp_grid29    mt_w_by_interp_coh_interp_grid30    mt_w_by_interp_coh_interp_grid31    mt_w_by_interp_coh_interp_grid32    mt_w_by_interp_coh_interp_grid33    mt_w_by_interp_coh_interp_grid34    mt_w_by_interp_coh_interp_grid35    mt_w_by_interp_coh_interp_grid36    mt_w_by_interp_coh_interp_grid37    mt_w_by_interp_coh_interp_grid38
    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    _______________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________    ________________________________

                  -20                              -18.695                             -17.39                            -16.085                            -14.781                            -13.476                            -12.171                            -10.866                            -9.5613                            -8.2565                               -6.9516                            -5.6468                              -4.342                             -3.0371                             -1.7323                            -0.42747                            0.87736                              2.1822                               3.487                              4.7919                              6.0967                              7.4015                              8.7064                              10.011                              11.316                              12.621                              13.926                              15.231                              16.535                               17.84                              19.145                               20.45                              21.755                               23.06                              24.364                              25.669                              26.974                              28.279             
                  -20                              -18.608                            -17.217                            -15.825                            -14.433                            -13.042                             -11.65                            -10.258                            -8.8665                            -7.4748                               -6.0832                            -4.6915                             -3.2998                             -1.9081                            -0.51641                             0.87527                              2.267                              3.6586                              5.0503                               6.442                              7.8337                              9.2254                              10.617                              12.009                                13.4                              14.792                              16.184                              17.575                              18.967                              20.359                              21.751                              23.142                              24.534                              25.926                              27.317                              28.709                              30.101                              31.492             
                  -20                              -18.521                            -17.043                            -15.564                            -14.086                            -12.607                            -11.129                            -9.6503                            -8.1717                            -6.6932                               -5.2147                            -3.7361                             -2.2576                            -0.77905                             0.69949                               2.178                             3.6566                              5.1351                              6.6136                              8.0922                              9.5707                              11.049                              12.528                              14.006                              15.485                              16.963                              18.442                               19.92                              21.399                              22.878                              24.356                              25.835                              27.313                              28.792                               30.27                              31.749                              33.227                              34.706             
                  -20                              -18.435                            -16.869                            -15.304                            -13.738                            -12.173                            -10.608                            -9.0423                            -7.4769                            -5.9115                               -4.3462                            -2.7808                             -1.2154                                0.35                              1.9154                              3.4808                             5.0462                              6.6115                              8.1769                              9.7423                              11.308                              12.873                              14.438                              16.004                              17.569                              19.135                                20.7                              22.265                              23.831                              25.396                              26.962                              28.527                              30.092                              31.658                              33.223                              34.788                              36.354                              37.919             
                  -20                              -18.348                            -16.696                            -15.043                            -13.391                            -11.739                            -10.087                            -8.4344                            -6.7821                            -5.1299                               -3.4777                            -1.8254                            -0.17319                               1.479                              3.1313                              4.7835                             6.4357                               8.088                              9.7402                              11.392                              13.045                              14.697                              16.349                              18.001                              19.654                              21.306                              22.958                               24.61                              26.263                              27.915                              29.567                              31.219                              32.871                              34.524                              36.176                              37.828                               39.48                              41.133             
                  -20                              -18.261                            -16.522                            -14.783                            -13.044                            -11.305                            -9.5655                            -7.8264                            -6.0873                            -4.3482                               -2.6092                           -0.87008                             0.86901                              2.6081                              4.3472                              6.0863                             7.8253                              9.5644                              11.304                              13.043                              14.782                              16.521                               18.26                              19.999                              21.738                              23.477                              25.216                              26.955                              28.694                              30.433                              32.173                              33.912                              35.651                               37.39                              39.129                              40.868                              42.607                              44.346             
                  -20                              -18.174                            -16.348                            -14.522                            -12.696                             -10.87                            -9.0444                            -7.2185                            -5.3925                            -3.5666                               -1.7407                           0.085272                              1.9112                              3.7371                              5.5631                               7.389                             9.2149                              11.041                              12.867                              14.693                              16.519                              18.345                              20.171                              21.996                              23.822                              25.648                              27.474                                29.3                              31.126                              32.952                              34.778                              36.604                               38.43                              40.256                              42.082                              43.908                              45.734                               47.56             
                  -20                              -18.087                            -16.174                            -14.262                            -12.349                            -10.436                            -8.5233                            -6.6105                            -4.6977                            -2.7849                              -0.87216                             1.0406                              2.9534                              4.8662                               6.779                              8.6918                             10.605                              12.517                               14.43                              16.343                              18.256                              20.168                              22.081                              23.994                              25.907                               27.82                              29.732                              31.645                              33.558                              35.471                              37.384                              39.296                              41.209                              43.122                              45.035                              46.947                               48.86                              50.773             
                  -20                                  -18                            -16.001                            -14.001                            -12.001                            -10.002                            -8.0022                            -6.0026                            -4.0029                            -2.0033                            -0.0036663                              1.996                              3.9956                              5.9952                              7.9949                              9.9945                             11.994                              13.994                              15.993                              17.993                              19.993                              21.992                              23.992                              25.992                              27.991                              29.991                               31.99                               33.99                               35.99                              37.989                              39.989                              41.989                              43.988                              45.988                              47.988                              49.987                              51.987                              53.986             
                  -20                              -17.914                            -15.827                            -13.741                            -11.654                            -9.5676                            -7.4811                            -5.3946                            -3.3081                            -1.2217                               0.86483                             2.9513                              5.0378                              7.1243                              9.2108                              11.297                             13.384                               15.47                              17.557                              19.643                               21.73                              23.816                              25.903                              27.989                              30.076                              32.162                              34.249                              36.335                              38.422                              40.508                              42.594                              44.681                              46.767                              48.854                               50.94                              53.027                              55.113                                57.2             

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

       0.26016        0.26831        0.25551        0.14921       0.053403      0.011702       0.0015678     0.00012823     6.3911e-06      1.9381e-07      3.5701e-09      3.9889e-11      2.7001e-13      1.1102e-15               0 
       0.11232        0.19622         0.2763        0.23861        0.12635      0.040998       0.0081429     0.00098855     7.3236e-05      3.3054e-06      9.0736e-08      1.5125e-09      1.5289e-11      9.3592e-14      3.3307e-16 
      0.037073        0.10492         0.2185        0.27902         0.2185       0.10492        0.030863      0.0055558     0.00061112      4.1008e-05      1.6758e-06       4.164e-08      6.2811e-10      5.7438e-12      3.1863e-14 
     0.0092081       0.040998        0.12635        0.23861         0.2763       0.19622        0.085427       0.022782      0.0037167       0.0003704      2.2511e-05      8.3291e-07      1.8732e-08      2.5567e-10      2.1255e-12 
     0.0017026       0.011702       0.053403        0.14921        0.25551       0.26831         0.17279       0.068209       0.016489       0.0024379       0.0002201      1.2114e-05       4.058e-07      8.2598e-09      1.0277e-10 
    0.00023263      0.0024379       0.016489       0.068209        0.17279       0.26831         0.25551        0.14921       0.053403        0.011702       0.0015678      0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427       0.19622          0.2763        0.23861        0.12635        0.040998       0.0081429      0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863       0.10492          0.2185        0.27902         0.2185         0.10492        0.030863       0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429      0.040998         0.12635        0.23861         0.2763         0.19622        0.085427        0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678      0.011702        0.053403        0.14921        0.25551         0.26831         0.17279        0.068209        0.016489       0.0024379      0.00023263 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________

    0.00023263      0.0024379       0.016489       0.068209        0.17279        0.26831        0.25551        0.14921       0.053403       0.011702       0.0015678       0.00012823      6.3911e-06      1.9381e-07      3.6102e-09 
    2.3363e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622         0.2763        0.23861        0.12635       0.040998       0.0081429       0.00098855      7.3236e-05      3.3054e-06      9.2263e-08 
    1.7181e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492         0.2185        0.27902         0.2185        0.10492        0.030863        0.0055558      0.00061112      4.1008e-05      1.7181e-06 
    9.2263e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998        0.12635        0.23861         0.2763        0.19622        0.085427         0.022782       0.0037167       0.0003704      2.3363e-05 
    3.6102e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702       0.053403        0.14921        0.25551        0.26831         0.17279         0.068209        0.016489       0.0024379      0.00023263 
    1.0277e-10     8.2598e-09      4.058e-07     1.2114e-05      0.0002201      0.0024379       0.016489       0.068209        0.17279        0.26831         0.25551          0.14921        0.053403        0.011702       0.0017026 
    2.1256e-12     2.5567e-10     1.8732e-08     8.3291e-07     2.2511e-05      0.0003704      0.0037167       0.022782       0.085427        0.19622          0.2763          0.23861         0.12635        0.040998       0.0092081 
    3.1909e-14     5.7438e-12     6.2811e-10      4.164e-08     1.6758e-06     4.1008e-05     0.00061112      0.0055558       0.030863        0.10492          0.2185          0.27902          0.2185         0.10492        0.037073 
     3.474e-16     9.3597e-14     1.5289e-11     1.5125e-09     9.0736e-08     3.3054e-06     7.3236e-05     0.00098855      0.0081429       0.040998         0.12635          0.23861          0.2763         0.19622         0.11232 
    2.7412e-18     1.1057e-15     2.6998e-13     3.9889e-11     3.5701e-09     1.9381e-07     6.3911e-06     0.00012823      0.0015678       0.011702        0.053403          0.14921         0.25551         0.26831         0.26016 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_coh_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 38&times;1 double

        Values:

            Min          -20
            Median    18.639
            Max       57.277

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_interp_c_grid
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    Var1: 772761&times;1 double

        Values:

            Min        0.001
            Median    38.639
            Max       77.277

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_interp_coh_grid_mesh_z
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    38    15

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

                 -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                           -20                            -20                            -20                            -20                            -20                            -20                            -20          
             -17.911                       -17.911                       -17.911                       -17.911                       -17.911                       -17.911                       -17.911                       -17.911                       -17.911                        -17.911                        -17.911                        -17.911                        -17.911                        -17.911                        -17.911          
             -15.823                       -15.823                       -15.823                       -15.823                       -15.823                       -15.823                       -15.823                       -15.823                       -15.823                        -15.823                        -15.823                        -15.823                        -15.823                        -15.823                        -15.823          
             -13.734                       -13.734                       -13.734                       -13.734                       -13.734                       -13.734                       -13.734                       -13.734                       -13.734                        -13.734                        -13.734                        -13.734                        -13.734                        -13.734                        -13.734          
             -11.646                       -11.646                       -11.646                       -11.646                       -11.646                       -11.646                       -11.646                       -11.646                       -11.646                        -11.646                        -11.646                        -11.646                        -11.646                        -11.646                        -11.646          
             -9.5571                       -9.5571                       -9.5571                       -9.5571                       -9.5571                       -9.5571                       -9.5571                       -9.5571                       -9.5571                        -9.5571                        -9.5571                        -9.5571                        -9.5571                        -9.5571                        -9.5571          
             -7.4686                       -7.4686                       -7.4686                       -7.4686                       -7.4686                       -7.4686                       -7.4686                       -7.4686                       -7.4686                        -7.4686                        -7.4686                        -7.4686                        -7.4686                        -7.4686                        -7.4686          
               -5.38                         -5.38                         -5.38                         -5.38                         -5.38                         -5.38                         -5.38                         -5.38                         -5.38                          -5.38                          -5.38                          -5.38                          -5.38                          -5.38                          -5.38          
             -3.2914                       -3.2914                       -3.2914                       -3.2914                       -3.2914                       -3.2914                       -3.2914                       -3.2914                       -3.2914                        -3.2914                        -3.2914                        -3.2914                        -3.2914                        -3.2914                        -3.2914          
             -1.2029                       -1.2029                       -1.2029                       -1.2029                       -1.2029                       -1.2029                       -1.2029                       -1.2029                       -1.2029                        -1.2029                        -1.2029                        -1.2029                        -1.2029                        -1.2029                        -1.2029          

    mt_interp_coh_grid_mesh_z1    mt_interp_coh_grid_mesh_z2    mt_interp_coh_grid_mesh_z3    mt_interp_coh_grid_mesh_z4    mt_interp_coh_grid_mesh_z5    mt_interp_coh_grid_mesh_z6    mt_interp_coh_grid_mesh_z7    mt_interp_coh_grid_mesh_z8    mt_interp_coh_grid_mesh_z9    mt_interp_coh_grid_mesh_z10    mt_interp_coh_grid_mesh_z11    mt_interp_coh_grid_mesh_z12    mt_interp_coh_grid_mesh_z13    mt_interp_coh_grid_mesh_z14    mt_interp_coh_grid_mesh_z15
    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________    ___________________________

               38.48                         38.48                         38.48                         38.48                         38.48                         38.48                         38.48                         38.48                         38.48                         38.48                          38.48                          38.48                          38.48                          38.48                          38.48           
              40.569                        40.569                        40.569                        40.569                        40.569                        40.569                        40.569                        40.569                        40.569                        40.569                         40.569                         40.569                         40.569                         40.569                         40.569           
              42.657                        42.657                        42.657                        42.657                        42.657                        42.657                        42.657                        42.657                        42.657                        42.657                         42.657                         42.657                         42.657                         42.657                         42.657           
              44.746                        44.746                        44.746                        44.746                        44.746                        44.746                        44.746                        44.746                        44.746                        44.746                         44.746                         44.746                         44.746                         44.746                         44.746           
              46.834                        46.834                        46.834                        46.834                        46.834                        46.834                        46.834                        46.834                        46.834                        46.834                         46.834                         46.834                         46.834                         46.834                         46.834           
              48.923                        48.923                        48.923                        48.923                        48.923                        48.923                        48.923                        48.923                        48.923                        48.923                         48.923                         48.923                         48.923                         48.923                         48.923           
              51.011                        51.011                        51.011                        51.011                        51.011                        51.011                        51.011                        51.011                        51.011                        51.011                         51.011                         51.011                         51.011                         51.011                         51.011           
                53.1                          53.1                          53.1                          53.1                          53.1                          53.1                          53.1                          53.1                          53.1                          53.1                           53.1                           53.1                           53.1                           53.1                           53.1           
              55.189                        55.189                        55.189                        55.189                        55.189                        55.189                        55.189                        55.189                        55.189                        55.189                         55.189                         55.189                         55.189                         55.189                         55.189           
              57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                        57.277                         57.277                         57.277                         57.277                         57.277                         57.277           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_a
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    35

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9     mt_a10      mt_a11      mt_a12      mt_a13     mt_a14    mt_a15    mt_a16    mt_a17    mt_a18    mt_a19    mt_a20    mt_a21    mt_a22    mt_a23    mt_a24    mt_a25    mt_a26    mt_a27    mt_a28    mt_a29    mt_a30    mt_a31    mt_a32    mt_a33    mt_a34    mt_a35
    _____    _______    _______    _______    _______    _______    _______    _______    _______    _______    ________    ________    ________    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

     -20     -17.943    -15.886     -13.83    -11.773    -9.7162    -7.6594    -5.6026    -3.5459    -1.4891     0.56765      2.6244      4.6812    6.7379    8.7947    10.851    12.908    14.965    17.022    19.079    21.135    23.192    25.249    27.306    29.362    31.419    33.476    35.533    37.589    39.646    41.703     43.76    45.816    47.873     49.93
     -20      -17.99     -15.98     -13.97     -11.96    -9.9497    -7.9396    -5.9295    -3.9195    -1.9094     0.10067      2.1107      4.1208    6.1309    8.1409    10.151    12.161    14.171    16.181    18.191    20.201    22.211    24.221    26.232    28.242    30.252    32.262    34.272    36.282    38.292    40.302    42.312    44.322    46.332    48.342
     -20     -18.037    -16.073     -14.11    -12.147    -10.183    -8.2198    -6.2564     -4.293    -2.3297    -0.36631      1.5971      3.5604    5.5238    7.4872    9.4505    11.414    13.377    15.341    17.304    19.267    21.231    23.194    25.157    27.121    29.084    31.048    33.011    34.974    36.938    38.901    40.864    42.828    44.791    46.755
     -20     -18.083    -16.167     -14.25    -12.333    -10.417       -8.5    -6.5833    -4.6666      -2.75    -0.83329      1.0834      3.0001    4.9167    6.8334    8.7501    10.667    12.583      14.5    16.417    18.333     20.25    22.167    24.083        26    27.917    29.833     31.75    33.667    35.583      37.5    39.417    41.333     43.25    45.167
     -20      -18.13     -16.26     -14.39     -12.52     -10.65    -8.7802    -6.9102    -5.0402    -3.1702     -1.3003     0.56971      2.4397    4.3097    6.1796    8.0496    9.9196     11.79     13.66    15.529    17.399    19.269    21.139    23.009    24.879    26.749    28.619    30.489    32.359    34.229    36.099    37.969    39.839    41.709    43.579
     -20     -18.177    -16.353     -14.53    -12.707    -10.884    -9.0603    -7.2371    -5.4138    -3.5905     -1.7672    0.056029      1.8793    3.7026    5.5259    7.3491    9.1724    10.996    12.819    14.642    16.466    18.289    20.112    21.935    23.759    25.582    27.405    29.228    31.052    32.875    34.698    36.522    38.345    40.168    41.991
     -20     -18.223    -16.447     -14.67    -12.894    -11.117    -9.3405     -7.564    -5.7874    -4.0108     -2.2342    -0.45765      1.3189    3.0955    4.8721    6.6487    8.4252    10.202    11.978    13.755    15.532    17.308    19.085    20.861    22.638    24.414    26.191    27.968    29.744    31.521    33.297    35.074     36.85    38.627    40.404
     -20      -18.27     -16.54     -14.81     -13.08    -11.351    -9.6207    -7.8908     -6.161    -4.4311     -2.7012    -0.97132     0.75856    2.4884    4.2183    5.9482    7.6781     9.408    11.138    12.868    14.598    16.327    18.057    19.787    21.517    23.247    24.977    26.707    28.437    30.167    31.896    33.626    35.356    37.086    38.816
     -20     -18.317    -16.634     -14.95    -13.267    -11.584    -9.9009    -8.2177    -6.5345    -4.8514     -3.1682      -1.485     0.19818    1.8814    3.5645    5.2477    6.9309    8.6141    10.297     11.98    13.664    15.347     17.03    18.713    20.396     22.08    23.763    25.446    27.129    28.812    30.495    32.179    33.862    35.545    37.228
     -20     -18.364    -16.727    -15.091    -13.454    -11.818    -10.181    -8.5446    -6.9081    -5.2716     -3.6352     -1.9987    -0.36219    1.2743    2.9108    4.5473    6.1837    7.8202    9.4567    11.093     12.73    14.366    16.003    17.639    19.276    20.912    22.549    24.185    25.822    27.458    29.095    30.731    32.367    34.004     35.64

    mt_a1     mt_a2      mt_a3      mt_a4      mt_a5      mt_a6      mt_a7      mt_a8      mt_a9     mt_a10     mt_a11     mt_a12     mt_a13     mt_a14     mt_a15     mt_a16     mt_a17     mt_a18     mt_a19     mt_a20     mt_a21     mt_a22     mt_a23     mt_a24     mt_a25     mt_a26     mt_a27     mt_a28     mt_a29     mt_a30     mt_a31     mt_a32     mt_a33     mt_a34     mt_a35 
    _____    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______    _______

     -20     -19.578    -19.155    -18.733    -18.311    -17.888    -17.466    -17.044    -16.621    -16.199    -15.777    -15.354    -14.932     -14.51    -14.087    -13.665    -13.243     -12.82    -12.398    -11.976    -11.553    -11.131    -10.709    -10.286    -9.8639    -9.4415    -9.0192    -8.5968    -8.1745    -7.7522    -7.3298    -6.9075    -6.4851    -6.0628    -5.6405
     -20     -19.624    -19.249    -18.873    -18.497    -18.122    -17.746    -17.371    -16.995    -16.619    -16.244    -15.868    -15.492    -15.117    -14.741    -14.365     -13.99    -13.614    -13.238    -12.863    -12.487    -12.112    -11.736     -11.36    -10.985    -10.609    -10.233    -9.8577     -9.482    -9.1064    -8.7307    -8.3551    -7.9795    -7.6038    -7.2282
     -20     -19.671    -19.342    -19.013    -18.684    -18.355    -18.026    -17.697    -17.368     -17.04    -16.711    -16.382    -16.053    -15.724    -15.395    -15.066    -14.737    -14.408    -14.079     -13.75    -13.421    -13.092    -12.763    -12.434    -12.105    -11.776    -11.447    -11.119     -10.79    -10.461    -10.132    -9.8027    -9.4738    -9.1449    -8.8159
     -20     -19.718    -19.436    -19.153    -18.871    -18.589    -18.307    -18.024    -17.742     -17.46    -17.178    -16.895    -16.613    -16.331    -16.049    -15.766    -15.484    -15.202     -14.92    -14.637    -14.355    -14.073    -13.791    -13.508    -13.226    -12.944    -12.662    -12.379    -12.097    -11.815    -11.533     -11.25    -10.968    -10.686    -10.404
     -20     -19.764    -19.529    -19.293    -19.058    -18.822    -18.587    -18.351    -18.116     -17.88    -17.645    -17.409    -17.173    -16.938    -16.702    -16.467    -16.231    -15.996     -15.76    -15.525    -15.289    -15.053    -14.818    -14.582    -14.347    -14.111    -13.876     -13.64    -13.405    -13.169    -12.934    -12.698    -12.462    -12.227    -11.991
     -20     -19.811    -19.622    -19.433    -19.245    -19.056    -18.867    -18.678    -18.489      -18.3    -18.111    -17.923    -17.734    -17.545    -17.356    -17.167    -16.978     -16.79    -16.601    -16.412    -16.223    -16.034    -15.845    -15.656    -15.468    -15.279     -15.09    -14.901    -14.712    -14.523    -14.334    -14.146    -13.957    -13.768    -13.579
     -20     -19.858    -19.716    -19.574    -19.431    -19.289    -19.147    -19.005    -18.863    -18.721    -18.578    -18.436    -18.294    -18.152     -18.01    -17.868    -17.726    -17.583    -17.441    -17.299    -17.157    -17.015    -16.873     -16.73    -16.588    -16.446    -16.304    -16.162     -16.02    -15.878    -15.735    -15.593    -15.451    -15.309    -15.167
     -20     -19.905    -19.809    -19.714    -19.618    -19.523    -19.427    -19.332    -19.236    -19.141    -19.045     -18.95    -18.855    -18.759    -18.664    -18.568    -18.473    -18.377    -18.282    -18.186    -18.091    -17.995      -17.9    -17.805    -17.709    -17.614    -17.518    -17.423    -17.327    -17.232    -17.136    -17.041    -16.945     -16.85    -16.755
     -20     -19.951    -19.902    -19.854    -19.805    -19.756    -19.707    -19.659     -19.61    -19.561    -19.512    -19.464    -19.415    -19.366    -19.317    -19.269     -19.22    -19.171    -19.122    -19.074    -19.025    -18.976    -18.927    -18.879     -18.83    -18.781    -18.732    -18.684    -18.635    -18.586    -18.537    -18.489     -18.44    -18.391    -18.342
     -20     -19.998    -19.996    -19.994    -19.992     -19.99    -19.988    -19.986    -19.984    -19.981    -19.979    -19.977    -19.975    -19.973    -19.971    -19.969    -19.967    -19.965    -19.963    -19.961    -19.959    -19.957    -19.955    -19.953    -19.951    -19.949    -19.946    -19.944    -19.942     -19.94    -19.938    -19.936    -19.934    -19.932     -19.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_a_meshk
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_a_meshk: 1575&times;1 double

        Values:

            Min             -20   
            Median      -7.2082   
            Max           49.93   

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_k
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    35

    mt_k1      mt_k2        mt_k3        mt_k4        mt_k5       mt_k6       mt_k7       mt_k8       mt_k9       mt_k10      mt_k11      mt_k12      mt_k13      mt_k14      mt_k15      mt_k16      mt_k17     mt_k18      mt_k19      mt_k20      mt_k21      mt_k22      mt_k23      mt_k24      mt_k25      mt_k26      mt_k27      mt_k28      mt_k29      mt_k30      mt_k31      mt_k32      mt_k33      mt_k34     mt_k35
    _____    _________    _________    _________    _________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    _______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ______

      0      0.0020588    0.0041176    0.0061765    0.0082353    0.010294    0.012353    0.014412    0.016471    0.018529    0.020588    0.022647    0.024706    0.026765    0.028824    0.030882    0.032941      0.035    0.037059    0.039118    0.041176    0.043235    0.045294    0.047353    0.049412    0.051471    0.053529    0.055588    0.057647    0.059706    0.061765    0.063824    0.065882    0.067941      0.07
      0       0.048757     0.097513      0.14627      0.19503     0.24378     0.29254      0.3413     0.39005     0.43881     0.48757     0.53632     0.58508     0.63384     0.68259     0.73135     0.78011    0.82886     0.87762     0.92638     0.97513      1.0239      1.0726      1.1214      1.1702      1.2189      1.2677      1.3164      1.3652      1.4139      1.4627      1.5115      1.5602       1.609    1.6577
      0       0.095455      0.19091      0.28636      0.38182     0.47727     0.57273     0.66818     0.76364     0.85909     0.95455        1.05      1.1455      1.2409      1.3364      1.4318      1.5273     1.6227      1.7182      1.8136      1.9091      2.0045         2.1      2.1955      2.2909      2.3864      2.4818      2.5773      2.6727      2.7682      2.8636      2.9591      3.0545        3.15    3.2455
      0        0.14215       0.2843      0.42646      0.56861     0.71076     0.85291     0.99507      1.1372      1.2794      1.4215      1.5637      1.7058       1.848      1.9901      2.1323      2.2744     2.4166      2.5587      2.7009       2.843      2.9852      3.1274      3.2695      3.4117      3.5538       3.696      3.8381      3.9803      4.1224      4.2646      4.4067      4.5489       4.691    4.8332
      0        0.18885       0.3777      0.56655       0.7554     0.94425      1.1331       1.322      1.5108      1.6997      1.8885      2.0774      2.2662      2.4551      2.6439      2.8328      3.0216     3.2105      3.3993      3.5882       3.777      3.9659      4.1547      4.3436      4.5324      4.7213      4.9101       5.099      5.2878      5.4767      5.6655      5.8544      6.0432      6.2321    6.4209
      0        0.23555       0.4711      0.70664      0.94219      1.1777      1.4133      1.6488      1.8844      2.1199      2.3555       2.591      2.8266      3.0621      3.2977      3.5332      3.7688     4.0043      4.2399      4.4754       4.711      4.9465      5.1821      5.4176      5.6532      5.8887      6.1243      6.3598      6.5953      6.8309      7.0664       7.302      7.5375      7.7731    8.0086
      0        0.28225      0.56449      0.84674        1.129      1.4112      1.6935      1.9757       2.258      2.5402      2.8225      3.1047       3.387      3.6692      3.9514      4.2337      4.5159     4.7982      5.0804      5.3627      5.6449      5.9272      6.2094      6.4917      6.7739      7.0561      7.3384      7.6206      7.9029      8.1851      8.4674      8.7496      9.0319      9.3141    9.5964
      0        0.32894      0.65789      0.98683       1.3158      1.6447      1.9737      2.3026      2.6316      2.9605      3.2894      3.6184      3.9473      4.2763      4.6052      4.9342      5.2631      5.592       5.921      6.2499      6.5789      6.9078      7.2368      7.5657      7.8947      8.2236      8.5525      8.8815      9.2104      9.5394      9.8683      10.197      10.526      10.855    11.184
      0        0.37564      0.75128       1.1269       1.5026      1.8782      2.2539      2.6295      3.0051      3.3808      3.7564      4.1321      4.5077      4.8833       5.259      5.6346      6.0103     6.3859      6.7616      7.1372      7.5128      7.8885      8.2641      8.6398      9.0154       9.391      9.7667      10.142      10.518      10.894      11.269      11.645      12.021      12.396    12.772
      0        0.42234      0.84468        1.267       1.6894      2.1117       2.534      2.9564      3.3787      3.8011      4.2234      4.6457      5.0681      5.4904      5.9128      6.3351      6.7574     7.1798      7.6021      8.0245      8.4468      8.8691      9.2915      9.7138      10.136      10.558      10.981      11.403      11.826      12.248       12.67      13.093      13.515      13.937     14.36

    mt_k1    mt_k2     mt_k3     mt_k4     mt_k5     mt_k6     mt_k7     mt_k8     mt_k9     mt_k10    mt_k11    mt_k12    mt_k13    mt_k14    mt_k15    mt_k16    mt_k17    mt_k18    mt_k19    mt_k20    mt_k21    mt_k22    mt_k23    mt_k24    mt_k25    mt_k26    mt_k27    mt_k28    mt_k29    mt_k30    mt_k31    mt_k32    mt_k33    mt_k34    mt_k35
    _____    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

      0      1.6365     3.273    4.9095    6.5459    8.1824    9.8189    11.455    13.092    14.728    16.365    18.001    19.638    21.274    22.911    24.547    26.184     27.82    29.457    31.093     32.73    34.366    36.003    37.639    39.276    40.912    42.549    44.185    45.822    47.458    49.095    50.731    52.367    54.004     55.64
      0      1.6832    3.3664    5.0495    6.7327    8.4159    10.099    11.782    13.465    15.149    16.832    18.515    20.198    21.881    23.565    25.248    26.931    28.614    30.297     31.98    33.664    35.347     37.03    38.713    40.396     42.08    43.763    45.446    47.129    48.812    50.495    52.179    53.862    55.545    57.228
      0      1.7299    3.4598    5.1896    6.9195    8.6494    10.379    12.109    13.839    15.569    17.299    19.029    20.759    22.488    24.218    25.948    27.678    29.408    31.138    32.868    34.598    36.327    38.057    39.787    41.517    43.247    44.977    46.707    48.437    50.167    51.896    53.626    55.356    57.086    58.816
      0      1.7766    3.5532    5.3297    7.1063    8.8829    10.659    12.436    14.213    15.989    17.766    19.542    21.319    23.096    24.872    26.649    28.425    30.202    31.978    33.755    35.532    37.308    39.085    40.861    42.638    44.414    46.191    47.968    49.744    51.521    53.297    55.074     56.85    58.627    60.404
      0      1.8233    3.6466    5.4698    7.2931    9.1164     10.94    12.763    14.586    16.409    18.233    20.056    21.879    23.703    25.526    27.349    29.172    30.996    32.819    34.642    36.466    38.289    40.112    41.935    43.759    45.582    47.405    49.228    51.052    52.875    54.698    56.522    58.345    60.168    61.991
      0        1.87    3.7399    5.6099    7.4799    9.3499     11.22     13.09     14.96     16.83      18.7     20.57     22.44     24.31     26.18     28.05     29.92     31.79     33.66    35.529    37.399    39.269    41.139    43.009    44.879    46.749    48.619    50.489    52.359    54.229    56.099    57.969    59.839    61.709    63.579
      0      1.9167    3.8333      5.75    7.6667    9.5834      11.5    13.417    15.333     17.25    19.167    21.083        23    24.917    26.833     28.75    30.667    32.583      34.5    36.417    38.333     40.25    42.167    44.083        46    47.917    49.833     51.75    53.667    55.583      57.5    59.417    61.333     63.25    65.167
      0      1.9634    3.9267    5.8901    7.8535    9.8168     11.78    13.744    15.707     17.67    19.634    21.597     23.56    25.524    27.487    29.451    31.414    33.377    35.341    37.304    39.267    41.231    43.194    45.157    47.121    49.084    51.048    53.011    54.974    56.938    58.901    60.864    62.828    64.791    66.755
      0      2.0101    4.0201    6.0302    8.0403     10.05     12.06     14.07    16.081    18.091    20.101    22.111    24.121    26.131    28.141    30.151    32.161    34.171    36.181    38.191    40.201    42.211    44.221    46.232    48.242    50.252    52.262    54.272    56.282    58.292    60.302    62.312    64.322    66.332    68.342
      0      2.0568    4.1135    6.1703    8.2271    10.284    12.341    14.397    16.454    18.511    20.568    22.624    24.681    26.738    28.795    30.851    32.908    34.965    37.022    39.079    41.135    43.192    45.249    47.306    49.362    51.419    53.476    55.533    57.589    59.646    61.703     63.76    65.816    67.873     69.93

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_k_mesha
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

Variables:

    ar_k_mesha: 1575&times;1 double

        Values:

            Min               0   
            Median       12.792   
            Max           69.93   

pos = 1 ; key = f_coh ; val = @(z,b,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0))
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(z,b,k)(f_prod(z,k)-(fl_delta)*k+fl_w+b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 18
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States, Choices and Shocks Grids and Get Functions (Interpolated + Percentage + Risky + Safe Asset)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(varargin)
%% FFS_IPWKBZ_GET_FUNCGRID get funcs, params, states choices shocks grids
% centralized gateway for retrieving parameters, and solution grids and
% functions. Similar to
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
% ffs_akz_get_funcgrid> function. This code deals with problems with
% savings and borrowing.
%
% The graphs below show the difference between percentage choice grid and
% level choice grid. See comments by graphs below for explanations of
% differences between the choice grids here and choice grids in the
% ffs_akz_get_funcgrid function.
%
% Note that for borrowing, we can not start at the min(coh(k,w-k,z))
% reacheable given the w and k choice grids. That would be:
% min(coh(k,w-k,z)) < min(w). At min(coh), there is a single point, and
% also for all values between min(coh) and min(w), all percentage w_perc
% choices are below min(w), requiring extrapolation. It is in some sense
% safer to extrapolate by starting solution at min(coh) = min(w). Now, for
% the lowest levels of coh(k, w-k, z), which are < min(w), we now require
% extrapolation. But this extrapolation is straight forward, when coh <
% min(w), households have to default, the utility from default is the same
% regardless of the level of coh at the time of default. So nearest
% extrapolation is fully correct.
%
% Note that the first stage w grid is based on cash-on-hand level reached
% by the coh(k,w-k,z) possible choice and shock combinations. This
% coh(k,w-k,z) > max(w), which also means that at max(coh) grid, the w_perc
% choices at higher points require extrapolation. Extrapolation is based on
% nearest extrapolation.
%
% Note that even when w = 0, as long as interest rate is low, only the
% lowest level of borrowing is invalid.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param bl_input_override boolean if true varargin contained param_map and
% support_map fully overrides local default. Local default is not invoked.
% This could be important for speed if this function is getting invoked
% within certain loops. Default is 0.
%
% @return armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @return func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @example
%
%    it_param_set = 2;
%    bl_input_override = true;
%    [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);
%    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_functions.m ffs_ipwkbz_set_functions>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/ffto_gen_tauchen_jhl.m ffto_gen_tauchen_jhl>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/fft_gen_grid_loglin.m fft_gen_grid_loglin>
%

%% Default

bl_input_override = 0;
if (length(varargin) == 3)
    bl_input_override = varargin{3};
end
if (bl_input_override)
    % override when called from outside
    [param_map, support_map, ~] = varargin{:};
else
    % default internal run
    [param_map, support_map] = ffs_ipwkbz_set_default_param();
    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    support_map('bl_display_funcgrids') = true;
    
    % to be able to visually see choice grid points
    param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
    param_map('fl_default_aprime') = 0;
    param_map('bl_default') = 0; % if borrowing is default allowed

    param_map('fl_w_min') = param_map('fl_b_bd');
    param_map('it_w_perc_n') = 25;
    param_map('it_ak_perc_n') = 45;
    param_map('fl_w_interp_grid_gap') = 2;
    param_map('fl_coh_interp_grid_gap') = 2;

    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];
end

%% Parse Parameters

params_group = values(param_map, {'it_z_n', 'fl_z_mu', 'fl_z_rho', 'fl_z_sig'});
[it_z_n, fl_z_mu, fl_z_rho, fl_z_sig] = params_group{:};

params_group = values(param_map, {'fl_nan_replace', 'fl_b_bd', 'fl_w_min', 'fl_w_max', ...
    'it_w_perc_n', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[fl_nan_replace, fl_b_bd, fl_w_min, fl_w_max, ...
    it_w_perc_n, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_k_min', 'fl_k_max', 'it_ak_perc_n'});
[fl_k_min, fl_k_max, it_ak_perc_n] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min', 'it_c_interp_grid_gap'});
[fl_crra, fl_c_min, it_c_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w'});
[fl_r_save, fl_r_borr, fl_w] = params_group{:};

params_group = values(support_map, {'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};

%% Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_default_param.html
% ffs_ipwkbz_set_default_param> for details.

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = (fl_w_max-fl_w_min)/(fl_w_interp_grid_gap);
ar_w_level_full = linspace(fl_w_min, fl_w_max, it_w_interp_n);
ar_w_level = ar_w_level_full;

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

ar_a_meshk_full = mt_a(:);
ar_k_mesha_full = mt_k(:);

ar_a_meshk = ar_a_meshk_full;
ar_k_mesha = ar_k_mesha_full;

%% Get Shock Grids

[~, mt_z_trans, ar_stationary, ar_z] = ffto_gen_tauchen_jhl(fl_z_mu,fl_z_rho,fl_z_sig,it_z_n);

%% Get Equations

[f_util_log, f_util_crra, f_util_standin, f_prod, f_inc, f_coh, f_cons] = ...
    ffs_ipwkbz_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_r_save, fl_r_borr, fl_w);

%% Generate Cash-on-Hand/State Matrix
% The endogenous state variable is cash-on-hand, it has it_z_n*it_a_n
% number of points, covering all reachable points when ar_a is the choice
% vector and ar_z is the shock vector. requires inputs from get Asset and
% choice grids, get shock grids, and get equations above.

mt_coh_wkb_full = f_coh(ar_z, ar_a_meshk_full, ar_k_mesha_full);


if (bl_display_funcgrids)
    
    % Generate Aggregate Variables
    ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;
    
    % Genereate Table
    tab_ak_choices = array2table([ar_aplusk_mesha, ar_k_mesha_full, ar_a_meshk_full]);
    cl_col_names = {'ar_aplusk_mesha', 'ar_k_mesha_full', 'ar_a_meshk_full'};
    tab_ak_choices.Properties.VariableNames = cl_col_names;
    
    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesha'} = ...
        '*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk_full'} = ...
        '*ar_a_meshk_full*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha_full'} = ...
        '*ar_k_mesha_full*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end
    
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));


    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));
    
end


%% Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, size(mt_a));

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.
fl_w_level_min_valid = min(ar_w_level_full(~ar_bl_w_level_invalid));

%% Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% Select only Valid (k(w), a) choices

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;
mt_z_mesh_coh_wkb = repmat(ar_z, [size(mt_coh_wkb,1),1]);

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;

% This is borrowing with default or not condition
fl_min_mt_coh = fl_b_bd;

it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n);
[mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid] = ndgrid(ar_interp_coh_grid, ar_z);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_by_interp_coh_interp_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end


%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): 2nd Stage Problem Arrays and Matrixes
armt_map('ar_ak_perc') = ar_ak_perc;
armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('it_ameshk_n') = length(ar_a_meshk);
armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_z_mesh_coh_wkb') = mt_z_mesh_coh_wkb;

%% Store armt_map (2): First Stage Aggregate Savings
% w = k' + b', w is aggregate Savings%
%
% # *ar_w_perc* 1st stage, percentage w choice given coh, at each coh
% level the number of choice points is the same for this problem with
% percentage grid points.
% # *ar_w_level* 2nd stage, level of w over which we solve the optimal
% percentage k' choices. Need to generate interpolant based on this so that
% we know optimal k* given ar_w_perc(coh) in the 1st stage
% # *mt_w_by_interp_coh_interp_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_w_level') = ar_w_level;
armt_map('mt_w_by_interp_coh_interp_grid') = mt_w_by_interp_coh_interp_grid;
armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;

%% Store armt_map (3): First Stage Consumption and Cash-on-Hand Grids

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;
armt_map('mt_z_mesh_coh_interp_grid') = mt_z_mesh_coh_interp_grid;

%% Store armt_map (4): Shock Grids
armt_map('mt_z_trans') = mt_z_trans;
armt_map('ar_stationary') = ar_stationary;
armt_map('ar_z') = ar_z;

%% Store Function Map
func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(mt_a, mt_k, 'blue');
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
%     if (length(ar_w_level_full) <= 100)
        scatter(ar_a_meshk, ar_k_mesha, 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level_full) <= 100)
        gf_invalid_scatter = scatter(ar_a_meshk_full(ar_bl_wkb_invalid),...
                                     ar_k_mesha_full(ar_bl_wkb_invalid),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title('Risky K Percentage Grids Given w=k+a (2nd Stage)')
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level_full) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end
        
    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
        'Each Segment is a w=k+b; within segment increasing k'...
        'For each w and z, coh maximizing k is different'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));

    legendCell{length(legendCell) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'southeast');

    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_by_interp_coh_interp_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_by_interp_coh_interp_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z));
    disp(ar_z);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_w_by_interp_coh_interp_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_w_by_interp_coh_interp_grid));
    disp(head(array2table(mt_w_by_interp_coh_interp_grid), 10));
    disp(tail(array2table(mt_w_by_interp_coh_interp_grid), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_coh_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_coh_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_interp_c_grid');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_interp_c_grid'));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_interp_coh_grid_mesh_z');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_interp_coh_grid_mesh_z));
    disp(head(array2table(mt_interp_coh_grid_mesh_z), 10));
    disp(tail(array2table(mt_interp_coh_grid_mesh_z), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_a');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a));
    disp(head(array2table(mt_a), 10));
    disp(tail(array2table(mt_a), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_a_meshk');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_a_meshk));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_k');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k));
    disp(head(array2table(mt_k), 10));
    disp(tail(array2table(mt_k), 10));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_k_mesha');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    summary(array2table(ar_k_mesha));

    param_map_keys = keys(func_map);
    param_map_vals = values(func_map);
    for i = 1:length(func_map)
        st_display = strjoin(['pos =' num2str(i) '; key =' string(param_map_keys{i}) '; val =' func2str(param_map_vals{i})]);
        disp(st_display);
    end

end

end

##### SOURCE END #####
--></body></html>