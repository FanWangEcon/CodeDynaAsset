
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-05"><meta name="DC.source" content="ff_ipwkbz_evf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters</a></li><li><a href="#5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></a></li><li><a href="#6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</a></li><li><a href="#7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</a></li><li><a href="#8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</a></li><li><a href="#9">Graph</a></li><li><a href="#11">Graph 1, V and EV</a></li><li><a href="#12">Graph 2, max(EV)</a></li><li><a href="#13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</a></li><li><a href="#14">Graph 4, Optimal K' and B' Levels</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkbz_evf(varargin)
</pre><h2 id="2">FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings</h2><p>This function follows the structure set up here: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html">ff_wkz_evf</a> but now we solve the second stage with percentage choice grid</p><p>We solve along a vector of w_n vector, that is an interpolation vector, not a vector of actual w choices picked in the first stage. k' choices are in terms of percentages. Compared to ff_wkz_evf where we only had an upper triangle of choices, now we have a full matrix of percentage choices.</p><p>@param mt_val matrix state_n I^2 by shock_n. This is the value matrix each row is a feasible reachable state given the choice vectors/matrix and each column is a shock state.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@return mt_ev_condi_z_max matrix choice_w_n by shock_n max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the optimal k' choice (w=k'+b') what is the expected utility? This is the value result from the 2nd stage problem. Note the result integrates over z'.</p><p>@return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k' choices, which index maximized conditional on z and w integrating over z'/</p><p>@return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m">ffs_ipwkbz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m">ffs_ipwkbz_get_funcgrid</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 5)
    bl_input_override = varargin{5};
<span class="keyword">end</span>
<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% override when called from outside</span>
    [mt_val, param_map, support_map, armt_map, ~] = varargin{:};
<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% Not default parameters, but parameters that generate defaults</span>
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

    support_map(<span class="string">'bl_graph_evf'</span>) = true;
    support_map(<span class="string">'bl_display_evf'</span>) = true;

    param_map(<span class="string">'it_ak_perc_n'</span>) = 250;
    param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = (param_map(<span class="string">'fl_w_max'</span>)-param_map(<span class="string">'fl_b_bd'</span>))/param_map(<span class="string">'it_ak_perc_n'</span>);

    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generating Defaults</span>
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {<span class="string">'f_util_standin'</span>, <span class="string">'f_coh'</span>});
    [f_util_standin, f_coh] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_coh = f_coh(ar_z, ar_a_meshk, ar_k_mesha);

<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameters</h2><pre class="codeinput">params_group = values(armt_map, {<span class="string">'mt_z_trans'</span>, <span class="string">'ar_z'</span>,<span class="keyword">...</span>
    <span class="string">'ar_w_level'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_a_meshk'</span>, <span class="string">'mt_k'</span>});
[mt_z_trans, ar_z, ar_w_level, <span class="keyword">...</span>
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph_onebyones'</span>,<span class="string">'bl_display_evf'</span>, <span class="string">'bl_graph_evf'</span>});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_img_save'</span>, <span class="string">'st_img_path'</span>, <span class="string">'st_img_prefix'</span>, <span class="string">'st_img_name_main'</span>, <span class="string">'st_img_suffix'</span>});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkbz_evf'</span>;
st_img_name_main = [st_func_name st_img_name_main];
</pre><h2 id="5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></h2><p>Each column for a different state z, each value <b>E(V(coh,z')|z)</b> integrated already Here, each column is a current z, more to right higher EV dim(mt_ev_condi_z): <b>Q by M</b> Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be what we do in the <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_functions.html">ffs_ipwkbz_set_functions</a> code where we loop over current z, and for each current z, grab out a particular row from the mt_z_trans that corresponds to a current shock's transition into all future states.</p><p>here, each column of mt_val corresponds to a state z, think of that as future state z. The input mt_val is <b>V(coh, z)</b>, we need to integrate to get <b>E(V(coh,z')|z)</b>.</p><pre class="codeinput">mt_ev_condi_z = mt_val*mt_z_trans';
<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z: Q by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z: Q by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
       62250          15

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     
        -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912            -3.912             -3.912             -3.912             -3.912             -3.912             -3.912     

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

        4.1874            4.1907            4.1946            4.1991             4.204            4.2095            4.2157            4.2225            4.2302            4.2386             4.2481             4.2585             4.2699             4.2822             4.2945     
        4.1867              4.19             4.194            4.1984            4.2034            4.2089            4.2151            4.2219            4.2296            4.2381             4.2475             4.2579             4.2694             4.2817              4.294     
         4.186            4.1894            4.1933            4.1977            4.2027            4.2082            4.2144            4.2213             4.229            4.2375             4.2469             4.2574             4.2689             4.2812             4.2935     
        4.1853            4.1887            4.1926             4.197             4.202            4.2076            4.2138            4.2207            4.2284            4.2369             4.2464             4.2568             4.2684             4.2807             4.2931     
        4.1846             4.188            4.1919            4.1964            4.2014            4.2069            4.2131            4.2201            4.2277            4.2363             4.2458             4.2563             4.2678             4.2802             4.2926     
        4.1839            4.1873            4.1912            4.1957            4.2007            4.2063            4.2125            4.2194            4.2271            4.2357             4.2452             4.2558             4.2673             4.2797             4.2921     
        4.1832            4.1866            4.1905             4.195               4.2            4.2056            4.2119            4.2188            4.2265            4.2351             4.2447             4.2552             4.2668             4.2792             4.2916     
        4.1825            4.1859            4.1898            4.1943            4.1994             4.205            4.2112            4.2182            4.2259            4.2345             4.2441             4.2547             4.2663             4.2787             4.2912     
        4.1818            4.1852            4.1892            4.1937            4.1987            4.2043            4.2106            4.2176            4.2253            4.2339             4.2435             4.2541             4.2657             4.2782             4.2907     
        4.1811            4.1845            4.1885             4.193             4.198            4.2037            4.2099            4.2169            4.2247            4.2333             4.2429             4.2536             4.2652             4.2777             4.2902     
        4.1804            4.1838            4.1878            4.1923            4.1974             4.203            4.2093            4.2163            4.2241            4.2328             4.2424              4.253             4.2647             4.2772             4.2897     
        4.1797            4.1831            4.1871            4.1916            4.1967            4.2024            4.2087            4.2157            4.2235            4.2322             4.2418             4.2525             4.2642             4.2767             4.2893     
         4.179            4.1824            4.1864            4.1909             4.196            4.2017             4.208             4.215            4.2229            4.2316             4.2412             4.2519             4.2636             4.2762             4.2888     
        4.1783            4.1817            4.1857            4.1903            4.1954             4.201            4.2074            4.2144            4.2223             4.231             4.2406             4.2514             4.2631             4.2757             4.2883     
        4.1776             4.181             4.185            4.1896            4.1947            4.2004            4.2067            4.2138            4.2216            4.2304             4.2401             4.2508             4.2626             4.2752             4.2878     
        4.1769            4.1803            4.1843            4.1889             4.194            4.1997            4.2061            4.2132             4.221            4.2298             4.2395             4.2502              4.262             4.2747             4.2873     
        4.1762            4.1796            4.1836            4.1882            4.1933            4.1991            4.2054            4.2125            4.2204            4.2292             4.2389             4.2497             4.2615             4.2742             4.2869     
        4.1754            4.1789            4.1829            4.1875            4.1927            4.1984            4.2048            4.2119            4.2198            4.2286             4.2383             4.2491              4.261             4.2736             4.2864     
        4.1747            4.1782            4.1823            4.1869             4.192            4.1977            4.2041            4.2113            4.2192             4.228             4.2378             4.2486             4.2604             4.2731             4.2859     
         4.174            4.1775            4.1816            4.1862            4.1913            4.1971            4.2035            4.2106            4.2186            4.2274             4.2372              4.248             4.2599             4.2726             4.2854     

</pre><h2 id="6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</h2><p>dim(mt_ev_condi_z): <b>IxJ by M</b></p><pre class="codeinput">[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);
</pre><h2 id="7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</h2><p>Maximization, find optimal k'/b' combination given z and w=k'+b'</p><pre class="codeinput">[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_full: J by IxM'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_full));
<span class="comment">%     disp(head(array2table(mt_ev_condi_z_full), 20));</span>
<span class="comment">%     disp(tail(array2table(mt_ev_condi_z_full), 20));</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));


    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_full: J by IxM
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
         250        3735

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

           -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                  -3.912                -3.912                 -3.912                 -3.912                 -3.912      
           -3.912                -3.912                -3.912                -3.912                -3.912                -3.912                -3.912               -3.9117               -3.9097               -3.8993                 -3.8587               -3.7381                 -3.465                -2.9937                -2.3746      
           -3.912                -3.912                -3.912               -3.9114               -3.9078               -3.8902                -3.827               -3.6584                 -3.32               -2.8007                 -2.1761               -1.5641                -1.0482               -0.64825               -0.34844      
          -3.9092               -3.8965               -3.8479               -3.7101               -3.4191               -2.9536               -2.3764               -1.7999               -1.3076              -0.91818                -0.60988              -0.35478               -0.13403               0.060946                0.22997      
          -3.1231               -2.6385               -2.1416               -1.7011               -1.3407               -1.0473               -0.8001              -0.58315              -0.38682              -0.20537               -0.035188               0.12606                0.27947                0.42403                0.55498      
          -1.0435              -0.92496              -0.79232              -0.65115              -0.50576              -0.36368              -0.22526             -0.089953              0.042696               0.17306                 0.30145               0.42801                0.55237                0.67264                0.78375      
         -0.40662              -0.34046              -0.26298              -0.17635             -0.081541              0.019466               0.12202               0.22571               0.33045               0.43614                 0.54268               0.64988                0.75713                0.86242                0.96087      
        -0.022754              0.023335              0.078333               0.14119               0.21159                0.2896               0.37322               0.45934                0.5478               0.63846                 0.73116               0.82566                0.92132                 1.0162                 1.1057      
          0.25349               0.28888               0.33157               0.38097               0.43706               0.50011               0.57038               0.64509               0.72268               0.80304                 0.88602                0.9714                 1.0586                 1.1457                 1.2283      
          0.46954               0.49828               0.53318               0.57389               0.62054                0.6735               0.73319               0.79938                0.8691               0.94186                  1.0176                 1.096                 1.1766                 1.2576                 1.3348      
          0.64703               0.67123               0.70076               0.73539               0.77533                 0.821               0.87286               0.93138                0.9951                 1.062                  1.1319                1.2049                 1.2802                 1.3562                  1.429      
          0.79769               0.81859               0.84417               0.87431               0.90924               0.94938               0.99525                1.0473                1.1057                1.1679                  1.2332                1.3016                 1.3725                 1.4444                 1.5135      
          0.92857               0.94696               0.96953               0.99621                1.0272                1.0631                1.1042                1.1511                1.2043                1.2626                  1.3241                1.3887                 1.4559                 1.5243                 1.5901      
           1.0443                1.0607                1.0809                1.1048                1.1328                1.1651                1.2024                1.2451                1.2937                1.3483                  1.4065                1.4679                 1.5319                 1.5973                 1.6603      
            1.148                1.1628                1.1811                1.2028                1.2282                1.2576                1.2917                1.3309                1.3757                1.4266                   1.482                1.5405                 1.6018                 1.6645                 1.7251      
           1.2419                1.2554                1.2721                 1.292                1.3152                1.3423                1.3737                1.4099                1.4514                1.4988                  1.5516                1.6077                 1.6665                 1.7268                 1.7852      
           1.3278                1.3402                1.3555                1.3738                1.3953                1.4204                1.4495                1.4831                1.5218                1.5661                  1.6162                1.6701                 1.7267                 1.7849                 1.8414      
           1.4068                1.4183                1.4325                1.4495                1.4694                1.4927                1.5199                1.5513                1.5875                1.6291                  1.6765                1.7284                 1.7831                 1.8394                  1.894      
           1.4801                1.4908                 1.504                1.5198                1.5384                1.5602                1.5856                1.6151                1.6492                1.6883                  1.7331                1.7831                 1.8361                 1.8906                 1.9436      
           1.5483                1.5583                1.5707                1.5855                 1.603                1.6234                1.6473                1.6751                1.7072                1.7442                  1.7867                1.8347                  1.886                 1.9389                 1.9905      

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

          4.1976                4.1986                4.1998                4.2012                4.2029                 4.205                4.2074                4.2104                4.2139                 4.218                  4.223                 4.2289                 4.2358                 4.2436                 4.2521       
           4.202                4.2029                4.2041                4.2055                4.2073                4.2093                4.2118                4.2147                4.2182                4.2223                 4.2272                 4.2331                 4.2399                 4.2478                 4.2562       
          4.2063                4.2072                4.2084                4.2099                4.2116                4.2136                4.2161                 4.219                4.2224                4.2266                 4.2315                 4.2373                 4.2441                 4.2519                 4.2603       
          4.2106                4.2116                4.2127                4.2142                4.2159                4.2179                4.2203                4.2232                4.2267                4.2308                 4.2357                 4.2415                 4.2483                 4.2561                 4.2644       
          4.2149                4.2159                 4.217                4.2184                4.2201                4.2222                4.2246                4.2275                4.2309                 4.235                 4.2399                 4.2456                 4.2524                 4.2602                 4.2685       
          4.2192                4.2201                4.2213                4.2227                4.2244                4.2264                4.2288                4.2317                4.2351                4.2392                 4.2441                 4.2498                 4.2566                 4.2643                 4.2725       
          4.2235                4.2244                4.2256                 4.227                4.2287                4.2307                4.2331                4.2359                4.2393                4.2434                 4.2482                 4.2539                 4.2607                 4.2683                 4.2766       
          4.2277                4.2286                4.2298                4.2312                4.2329                4.2349                4.2373                4.2401                4.2435                4.2475                 4.2524                 4.2581                 4.2648                 4.2724                 4.2806       
          4.2319                4.2329                 4.234                4.2354                4.2371                4.2391                4.2415                4.2443                4.2477                4.2517                 4.2565                 4.2622                 4.2688                 4.2764                 4.2846       
          4.2362                4.2371                4.2382                4.2396                4.2413                4.2433                4.2456                4.2485                4.2518                4.2558                 4.2606                 4.2662                 4.2729                 4.2805                 4.2886       
          4.2403                4.2413                4.2424                4.2438                4.2454                4.2474                4.2498                4.2526                4.2559                4.2599                 4.2647                 4.2703                 4.2769                 4.2845                 4.2926       
          4.2445                4.2454                4.2466                4.2479                4.2496                4.2516                4.2539                4.2567                4.2601                 4.264                 4.2688                 4.2744                  4.281                 4.2885                 4.2965       
          4.2487                4.2496                4.2507                4.2521                4.2537                4.2557                 4.258                4.2608                4.2641                4.2681                 4.2728                 4.2784                  4.285                 4.2925                 4.3005       
          4.2528                4.2537                4.2548                4.2562                4.2579                4.2598                4.2621                4.2649                4.2682                4.2722                 4.2769                 4.2824                  4.289                 4.2964                 4.3044       
          4.2569                4.2578                 4.259                4.2603                 4.262                4.2639                4.2662                 4.269                4.2723                4.2762                 4.2809                 4.2864                 4.2929                 4.3004                 4.3083       
           4.261                4.2619                4.2631                4.2644                 4.266                 4.268                4.2703                 4.273                4.2763                4.2802                 4.2849                 4.2904                 4.2969                 4.3043                 4.3122       
          4.2651                 4.266                4.2671                4.2685                4.2701                 4.272                4.2743                4.2771                4.2804                4.2843                 4.2889                 4.2944                 4.3008                 4.3082                 4.3161       
          4.2692                4.2701                4.2712                4.2726                4.2742                4.2761                4.2784                4.2811                4.2844                4.2882                 4.2929                 4.2983                 4.3048                 4.3121                   4.32       
          4.2733                4.2741                4.2753                4.2766                4.2782                4.2801                4.2824                4.2851                4.2884                4.2922                 4.2968                 4.3023                 4.3087                  4.316                 4.3239       
          4.2773                4.2782                4.2793                4.2806                4.2822                4.2841                4.2864                4.2891                4.2923                4.2962                 4.3008                 4.3062                 4.3126                 4.3199                 4.3277       

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

               1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1                          1          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             222                       232                       248                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             142                       166                       195                       232                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             122                       142                       168                       200                       237                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             105                       123                       146                       174                       207                       246                       250                       250                       250                        250                        250                        250                        250                        250                        250          
              93                       109                       129                       153                       182                       217                       250                       250                       250                        250                        250                        250                        250                        250                        250          
              83                        97                       115                       137                       163                       194                       231                       250                       250                        250                        250                        250                        250                        250                        250          
              75                        88                       104                       124                       147                       175                       209                       249                       250                        250                        250                        250                        250                        250                        250          
              68                        80                        95                       113                       134                       160                       191                       227                       250                        250                        250                        250                        250                        250                        250          
              63                        74                        87                       104                       124                       147                       175                       209                       248                        250                        250                        250                        250                        250                        250          
              58                        68                        81                        96                       114                       136                       162                       193                       230                        250                        250                        250                        250                        250                        250          
              54                        63                        75                        89                       106                       127                       151                       180                       214                        250                        250                        250                        250                        250                        250          
              50                        59                        70                        84                        99                       119                       141                       168                       200                        238                        250                        250                        250                        250                        250          
              47                        56                        66                        78                        93                       111                       133                       158                       188                        224                        250                        250                        250                        250                        250          
              45                        52                        62                        74                        88                       105                       125                       149                       177                        211                        250                        250                        250                        250                        250          
              42                        49                        59                        70                        83                        99                       118                       141                       168                        200                        238                        250                        250                        250                        250          
              40                        47                        56                        66                        79                        94                       112                       134                       159                        190                        226                        250                        250                        250                        250          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

              8                         9                         11                        13                        15                        18                        22                        26                        31                        36                         43                         52                         61                         73                         85           
              8                         9                         11                        13                        15                        18                        22                        26                        30                        36                         43                         51                         61                         72                         85           
              8                         9                         11                        13                        15                        18                        21                        26                        30                        36                         43                         51                         61                         72                         84           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         43                         51                         61                         72                         84           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         43                         51                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         42                         51                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         60                         71                         82           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         59                         70                         82           
              8                         9                         11                        13                        15                        18                        21                        25                        29                        35                         42                         50                         59                         70                         82           
              8                         9                         11                        12                        15                        17                        21                        25                        29                        35                         42                         50                         59                         70                         81           
              8                         9                         11                        12                        15                        17                        21                        25                        29                        35                         41                         49                         59                         69                         81           
              8                         9                         10                        12                        15                        17                        21                        24                        29                        35                         41                         49                         58                         69                         81           
              8                         9                         10                        12                        15                        17                        21                        24                        29                        34                         41                         49                         58                         69                         80           
              8                         9                         10                        12                        15                        17                        20                        24                        29                        34                         41                         49                         58                         69                         80           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         41                         49                         58                         68                         80           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         41                         48                         57                         68                         79           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         40                         48                         57                         68                         79           
              8                         9                         10                        12                        14                        17                        20                        24                        28                        34                         40                         48                         57                         67                         79           
              7                         9                         10                        12                        14                        17                        20                        24                        28                        34                         40                         48                         57                         67                         78           

</pre><h2 id="8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</h2><p>The K' and B' Optimal Choices Associated with EV opti dim(mt_ev_condi_z_max_kp): <b>I by M</b></p><pre class="codeinput">ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
<span class="keyword">end</span>

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_kp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_bp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

                1                         1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1          
              500                       500                       500                       500                       500                       500                       500                       500                       500                       500                        500                        500                        500                        500                        500          
              750                       750                       750                       750                       750                       750                       750                       750                       750                       750                        750                        750                        750                        750                        750          
             1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                       1000                       1000                       1000                       1000                       1000          
             1222                      1232                      1248                      1250                      1250                      1250                      1250                      1250                      1250                      1250                       1250                       1250                       1250                       1250                       1250          
             1392                      1416                      1445                      1482                      1500                      1500                      1500                      1500                      1500                      1500                       1500                       1500                       1500                       1500                       1500          
             1622                      1642                      1668                      1700                      1737                      1750                      1750                      1750                      1750                      1750                       1750                       1750                       1750                       1750                       1750          
             1855                      1873                      1896                      1924                      1957                      1996                      2000                      2000                      2000                      2000                       2000                       2000                       2000                       2000                       2000          
             2093                      2109                      2129                      2153                      2182                      2217                      2250                      2250                      2250                      2250                       2250                       2250                       2250                       2250                       2250          
             2333                      2347                      2365                      2387                      2413                      2444                      2481                      2500                      2500                      2500                       2500                       2500                       2500                       2500                       2500          
             2575                      2588                      2604                      2624                      2647                      2675                      2709                      2749                      2750                      2750                       2750                       2750                       2750                       2750                       2750          
             2818                      2830                      2845                      2863                      2884                      2910                      2941                      2977                      3000                      3000                       3000                       3000                       3000                       3000                       3000          
             3063                      3074                      3087                      3104                      3124                      3147                      3175                      3209                      3248                      3250                       3250                       3250                       3250                       3250                       3250          
             3308                      3318                      3331                      3346                      3364                      3386                      3412                      3443                      3480                      3500                       3500                       3500                       3500                       3500                       3500          
             3554                      3563                      3575                      3589                      3606                      3627                      3651                      3680                      3714                      3750                       3750                       3750                       3750                       3750                       3750          
             3800                      3809                      3820                      3834                      3849                      3869                      3891                      3918                      3950                      3988                       4000                       4000                       4000                       4000                       4000          
             4047                      4056                      4066                      4078                      4093                      4111                      4133                      4158                      4188                      4224                       4250                       4250                       4250                       4250                       4250          
             4295                      4302                      4312                      4324                      4338                      4355                      4375                      4399                      4427                      4461                       4500                       4500                       4500                       4500                       4500          
             4542                      4549                      4559                      4570                      4583                      4599                      4618                      4641                      4668                      4700                       4738                       4750                       4750                       4750                       4750          
             4790                      4797                      4806                      4816                      4829                      4844                      4862                      4884                      4909                      4940                       4976                       5000                       5000                       5000                       5000          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

            57258                     57259                     57261                     57263                     57265                     57268                     57272                     57276                     57281                      57286                      57293                      57302                      57311                      57323                      57335         
            57508                     57509                     57511                     57513                     57515                     57518                     57522                     57526                     57530                      57536                      57543                      57551                      57561                      57572                      57585         
            57758                     57759                     57761                     57763                     57765                     57768                     57771                     57776                     57780                      57786                      57793                      57801                      57811                      57822                      57834         
            58008                     58009                     58011                     58013                     58015                     58018                     58021                     58025                     58030                      58036                      58043                      58051                      58061                      58072                      58084         
            58258                     58259                     58261                     58263                     58265                     58268                     58271                     58275                     58280                      58286                      58293                      58301                      58310                      58321                      58333         
            58508                     58509                     58511                     58513                     58515                     58518                     58521                     58525                     58530                      58536                      58542                      58551                      58560                      58571                      58583         
            58758                     58759                     58761                     58763                     58765                     58768                     58771                     58775                     58780                      58785                      58792                      58800                      58810                      58821                      58833         
            59008                     59009                     59011                     59013                     59015                     59018                     59021                     59025                     59030                      59035                      59042                      59050                      59060                      59071                      59082         
            59258                     59259                     59261                     59263                     59265                     59268                     59271                     59275                     59280                      59285                      59292                      59300                      59309                      59320                      59332         
            59508                     59509                     59511                     59513                     59515                     59518                     59521                     59525                     59529                      59535                      59542                      59550                      59559                      59570                      59582         
            59758                     59759                     59761                     59762                     59765                     59767                     59771                     59775                     59779                      59785                      59792                      59800                      59809                      59820                      59831         
            60008                     60009                     60011                     60012                     60015                     60017                     60021                     60025                     60029                      60035                      60041                      60049                      60059                      60069                      60081         
            60258                     60259                     60260                     60262                     60265                     60267                     60271                     60274                     60279                      60285                      60291                      60299                      60308                      60319                      60331         
            60508                     60509                     60510                     60512                     60515                     60517                     60521                     60524                     60529                      60534                      60541                      60549                      60558                      60569                      60580         
            60758                     60759                     60760                     60762                     60765                     60767                     60770                     60774                     60779                      60784                      60791                      60799                      60808                      60819                      60830         
            61008                     61009                     61010                     61012                     61014                     61017                     61020                     61024                     61029                      61034                      61041                      61049                      61058                      61068                      61080         
            61258                     61259                     61260                     61262                     61264                     61267                     61270                     61274                     61279                      61284                      61291                      61298                      61307                      61318                      61329         
            61508                     61509                     61510                     61512                     61514                     61517                     61520                     61524                     61529                      61534                      61540                      61548                      61557                      61568                      61579         
            61758                     61759                     61760                     61762                     61764                     61767                     61770                     61774                     61778                      61784                      61790                      61798                      61807                      61817                      61829         
            62007                     62009                     62010                     62012                     62014                     62017                     62020                     62024                     62028                      62034                      62040                      62048                      62057                      62067                      62078         

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_kp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

                 0                        0                        0                        0                        0                        0                        0                        0                        0                        0                         0                         0                         0                         0                         0        
           0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                   0.28312                   0.28312                   0.28312                   0.28312                   0.28312        
           0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                   0.56623                   0.56623                   0.56623                   0.56623                   0.56623        
           0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                   0.84935                   0.84935                   0.84935                   0.84935                   0.84935        
            1.0053                   1.0507                   1.1234                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                    1.1325                    1.1325                    1.1325                    1.1325                    1.1325        
           0.80221                  0.93852                   1.1032                   1.3134                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                    1.4156                    1.4156                    1.4156                    1.4156                    1.4156        
           0.82635                  0.96265                   1.1399                   1.3579                   1.6101                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                    1.6987                    1.6987                    1.6987                    1.6987                    1.6987        
            0.8289                  0.97202                   1.1549                   1.3775                   1.6399                     1.95                   1.9818                   1.9818                   1.9818                   1.9818                    1.9818                    1.9818                    1.9818                    1.9818                    1.9818        
           0.83827                  0.98367                   1.1654                   1.3835                    1.647                   1.9651                   2.2649                   2.2649                   2.2649                   2.2649                    2.2649                    2.2649                    2.2649                    2.2649                    2.2649        
           0.84083                  0.98395                    1.168                   1.3929                   1.6587                   1.9756                   2.3538                   2.5481                   2.5481                   2.5481                    2.5481                    2.5481                    2.5481                    2.5481                    2.5481        
           0.84338                  0.99105                   1.1728                      1.4                   1.6612                   1.9793                   2.3655                   2.8198                   2.8312                   2.8312                    2.8312                    2.8312                    2.8312                    2.8312                    2.8312        
           0.84026                   0.9902                   1.1776                   1.4025                   1.6649                   1.9898                   2.3771                   2.8269                   3.1143                   3.1143                    3.1143                    3.1143                    3.1143                    3.1143                    3.1143        
            0.8485                  0.99843                   1.1756                   1.4073                     1.68                   1.9935                   2.3751                   2.8386                   3.3701                   3.3974                    3.3974                    3.3974                    3.3974                    3.3974                    3.3974        
           0.84537                  0.99304                    1.185                   1.4065                   1.6723                   1.9972                   2.3811                   2.8388                   3.3852                   3.6805                    3.6805                    3.6805                    3.6805                    3.6805                    3.6805        
           0.84679                  0.98991                   1.1807                   1.4034                   1.6737                   2.0077                   2.3893                   2.8505                   3.3912                   3.9636                    3.9636                    3.9636                    3.9636                    3.9636                    3.9636        
           0.83912                  0.99247                   1.1799                   1.4184                    1.674                   2.0148                   2.3896                   2.8496                   3.3949                   4.0423                    4.2468                    4.2468                    4.2468                    4.2468                    4.2468        
           0.84054                   1.0041                   1.1858                   1.4039                   1.6765                   2.0037                   2.4035                   2.8579                   3.4031                   4.0574                    4.5299                    4.5299                    4.5299                    4.5299                    4.5299        
           0.85446                  0.98963                   1.1827                   1.4144                   1.6848                   2.0131                   2.3993                   2.8627                   3.4034                   4.0599                     4.813                     4.813                     4.813                     4.813                     4.813        
           0.84338                   0.9865                    1.191                   1.4159                   1.6817                   2.0088                   2.3973                   2.8675                   3.4196                   4.0738                    4.8508                    5.0961                    5.0961                    5.0961                    5.0961        
           0.84707                  0.99814                   1.1924                   1.4082                   1.6888                   2.0125                    2.401                   2.8758                   3.4153                   4.0843                    4.8613                    5.3792                    5.3792                    5.3792                    5.3792        

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           1.8775                   2.1365                   2.6544                   3.1724                   3.6903                   4.4673                   5.5032                   6.5391                    7.834                    9.1289                    10.942                    13.273                    15.603                    18.711                    21.819        
           1.8857                   2.1458                   2.6661                   3.1863                   3.7065                   4.4869                   5.5273                   6.5678                   7.6083                     9.169                     10.99                    13.071                    15.672                    18.533                    21.915        
           1.8939                   2.1552                   2.6777                   3.2002                   3.7227                   4.5065                   5.2902                   6.5965                   7.6415                     9.209                    11.038                    13.128                     15.74                    18.614                    21.749        
           1.9022                   2.1646                   2.6893                   3.2141                   3.7389                   4.5261                   5.3132                   6.3628                   7.6747                    9.2491                    11.086                    13.185                    15.809                    18.695                    21.844        
           1.9104                   2.1739                    2.701                    3.228                   3.7551                   4.5457                   5.3362                   6.3903                   7.7079                    9.2891                    11.134                    13.242                    15.614                    18.512                    21.675        
           1.9187                   2.1833                   2.7126                    3.242                   3.7713                   4.5653                   5.3592                   6.4179                   7.7412                    9.3291                    10.917                    13.299                    15.681                    18.592                    21.768        
           1.9269                   2.1927                   2.7243                   3.2559                   3.7875                   4.5848                   5.3822                   6.4454                   7.7744                    9.1034                    10.964                     13.09                    15.748                    18.672                    21.862        
           1.9351                   2.2021                   2.7359                   3.2698                   3.8036                   4.6044                   5.4052                    6.473                   7.8076                    9.1423                    11.011                    13.146                    15.816                    18.752                    21.688        
           1.9434                   2.2114                   2.7476                   3.2837                   3.8198                    4.624                   5.4282                   6.5005                   7.8408                    9.1812                    11.058                    13.202                    15.615                    18.564                     21.78        
           1.9516                   2.2208                   2.7592                   3.2976                    3.836                   4.6436                   5.4512                    6.528                   7.6049                    9.2201                    11.105                    13.258                    15.681                    18.642                    21.873        
           1.9598                   2.2302                   2.7708                   3.0412                   3.8522                   4.3929                   5.4742                   6.5556                    7.637                     9.259                    11.151                    13.314                    15.747                    18.721                    21.695        
           1.9681                   2.2395                   2.7825                    3.054                   3.8684                   4.4113                   5.4972                   6.5831                    7.669                    9.2979                    10.927                    13.099                    15.813                    18.528                    21.786        
           1.9763                   2.2489                   2.5215                   3.0667                   3.8846                   4.4298                   5.5202                   6.3381                   7.7011                    9.3368                    10.972                    13.153                    15.607                    18.606                    21.877        
           1.9845                   2.2583                    2.532                   3.0795                   3.9008                   4.4483                   5.5432                   6.3645                   7.7332                    9.1019                    11.018                    13.208                    15.672                    18.683                    21.694        
           1.9928                   2.2676                   2.5425                   3.0923                   3.9169                   4.4667                   5.2914                   6.3909                   7.7653                    9.1397                    11.064                    13.263                    15.737                    18.761                    21.784        
            2.001                    2.277                    2.553                   3.1051                   3.6571                   4.4852                   5.3132                   6.4173                   7.7974                    9.1775                     11.11                    13.318                    15.802                    18.562                    21.874        
           2.0092                   2.2864                   2.5635                   3.1179                   3.6722                   4.5036                   5.3351                   6.4437                   7.8295                    9.2153                    11.155                    13.095                     15.59                    18.639                    21.687        
           2.0175                   2.2958                    2.574                   3.1306                   3.6872                   4.5221                    5.357                   6.4701                   7.8616                     9.253                    10.923                    13.149                    15.654                    18.715                    21.776        
           2.0257                   2.3051                   2.5846                   3.1434                   3.7023                   4.5405                   5.3788                   6.4965                   7.6142                    9.2908                    10.967                    13.203                    15.718                    18.512                    21.865        
           1.7534                   2.3145                   2.5951                   3.1562                   3.7173                    4.559                   5.4007                   6.5229                   7.6452                    9.3286                    11.012                    13.256                    15.781                    18.587                    21.673        

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_bp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

               -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                       -20                       -20                       -20                       -20                       -20        
               -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                       -20                       -20                       -20                       -20                       -20        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.872                  -19.917                   -19.99                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.385                  -19.522                  -19.686                  -19.896                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.126                  -19.262                  -19.439                  -19.658                   -19.91                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
           -18.845                  -18.988                  -19.171                  -19.394                  -19.656                  -19.966                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
           -18.571                  -18.716                  -18.898                  -19.116                   -19.38                  -19.698                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
            -18.29                  -18.433                  -18.617                  -18.842                  -19.108                  -19.425                  -19.803                  -19.997                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -18.009                  -18.157                  -18.339                  -18.566                  -18.827                  -19.145                  -19.531                  -19.986                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -17.723                  -17.873                   -18.06                  -18.285                  -18.548                  -18.872                   -19.26                   -19.71                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -17.448                  -17.598                  -17.775                  -18.007                  -18.279                  -18.593                  -18.974                  -19.438                  -19.969                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -17.161                  -17.309                  -17.501                  -17.722                  -17.988                  -18.313                  -18.697                  -19.155                  -19.701                  -19.996                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -16.879                  -17.022                  -17.213                  -17.436                  -17.706                   -18.04                  -18.422                  -18.883                  -19.424                  -19.996                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -16.588                  -16.741                  -16.929                  -17.167                  -17.423                  -17.764                  -18.139                  -18.599                  -19.144                  -19.791                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -16.306                   -16.47                  -16.651                   -16.87                  -17.142                  -17.469                  -17.869                  -18.323                  -18.869                  -19.523                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        
           -16.037                  -16.172                  -16.365                  -16.597                  -16.867                  -17.195                  -17.581                  -18.045                  -18.586                  -19.242                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        
           -15.742                  -15.885                   -16.09                  -16.315                   -16.58                  -16.908                  -17.296                  -17.766                  -18.318                  -18.973                    -19.75                   -19.995                   -19.995                   -19.995                   -19.995        
           -15.462                  -15.614                  -15.808                  -16.024                  -16.304                  -16.628                  -17.016                  -17.491                  -18.031                    -18.7                   -19.477                   -19.995                   -19.995                   -19.995                   -19.995        

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           42.738                   42.479                   41.961                   41.443                   40.925                   40.148                   39.112                   38.076                   36.781                    35.486                    33.674                    31.343                    29.012                    25.904                    22.796        
           43.013                   42.753                   42.233                   41.712                   41.192                   40.412                   39.371                   38.331                   37.291                     35.73                    33.909                    31.828                    29.227                    26.366                    22.984        
           43.288                   43.027                   42.504                   41.982                   41.459                   40.676                   39.892                   38.586                   37.541                    35.973                    34.144                    32.054                    29.442                    26.568                    23.433        
           43.563                   43.301                   42.776                   42.251                   41.727                    40.94                   40.152                   39.103                   37.791                    36.217                     34.38                    32.281                    29.657                    26.771                    23.622        
           43.839                   43.575                   43.048                   42.521                   41.994                   41.203                   40.413                   39.359                   38.041                     36.46                    34.615                    32.507                    30.135                    27.237                    24.074        
           44.114                   43.849                    43.32                    42.79                   42.261                   41.467                   40.673                   39.615                   38.291                    36.703                    35.115                    32.733                    30.351                     27.44                    24.264        
           44.389                   44.123                   43.592                    43.06                   42.528                   41.731                   40.934                    39.87                   38.541                    37.212                    35.352                    33.225                    30.568                    27.644                    24.454        
           44.664                   44.397                   43.863                   43.329                   42.796                   41.995                   41.194                   40.126                   38.792                    37.457                    35.588                    33.453                    30.784                    27.847                    24.911        
           44.939                   44.671                   44.135                   43.599                   43.063                   42.259                   41.454                   40.382                   39.042                    37.701                    35.825                     33.68                    31.268                    28.319                    25.102        
           45.214                   44.945                   44.407                   43.868                    43.33                   42.522                   41.715                   40.638                   39.561                    37.946                    36.061                    33.908                    31.485                    28.524                    25.293        
            45.49                   45.219                   44.679                   44.408                   43.597                   43.057                   41.975                   40.894                   39.812                     38.19                    36.298                    34.135                    31.702                    28.729                    25.755        
           45.765                   45.493                    44.95                   44.679                   43.864                   43.321                   42.236                    41.15                   40.064                    38.435                    36.806                    34.634                    31.919                    29.205                    25.947        
            46.04                   45.767                   45.495                   44.949                   44.132                   43.586                   42.496                   41.678                   40.315                    38.679                    37.044                    34.863                    32.409                    29.411                    26.139        
           46.315                   46.041                   45.768                    45.22                   44.399                   43.851                   42.756                   41.935                   40.566                    39.198                    37.281                    35.091                    32.628                    29.617                    26.605        
            46.59                   46.315                    46.04                   45.491                   44.666                   44.116                   43.292                   42.192                   40.818                    39.443                    37.519                     35.32                    32.846                    29.822                    26.799        
           46.865                   46.589                   46.313                   45.761                   45.209                   44.381                   43.553                   42.449                   41.069                    39.689                    37.757                    35.549                    33.064                    30.304                    26.992        
           47.141                   46.863                   46.586                   46.032                   45.478                   44.646                   43.815                   42.706                    41.32                    39.935                    37.994                    36.054                     33.56                    30.511                    27.463        
           47.416                   47.137                   46.859                   46.303                   45.746                   44.911                   44.076                   42.963                   41.572                     40.18                     38.51                    36.284                    33.779                    30.718                    27.657        
           47.691                   47.411                   47.132                   46.573                   46.014                   45.176                   44.338                    43.22                   42.102                    40.426                    38.749                    36.514                    33.999                    31.205                    27.852        
           48.247                   47.686                   47.405                   46.844                   46.283                   45.441                   44.599                   43.477                   42.355                    40.671                    38.988                    36.744                    34.219                    31.413                    28.327        

</pre><h2 id="9">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_evf)
</pre><h2 id="11">Graph 1, V and EV</h2><pre class="codeinput">    <span class="keyword">if</span> (~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
        hold <span class="string">on</span>;
    <span class="keyword">end</span>


    <span class="keyword">for</span> subplot_j=1:1:2

        <span class="keyword">if</span> (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (subplot_j==1)
            chart = plot(mt_val);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        <span class="keyword">end</span>

        clr = jet(numel(chart));
        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>

        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        <span class="keyword">if</span> (subplot_j==1)
            title(<span class="string">'V(coh,zp); w(k+b),k,z'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            title(<span class="string">'E_z(V(coh,zp|z))'</span>);
        <span class="keyword">end</span>

        ylabel(<span class="string">'Next Period Value'</span>);
        xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span><span class="keyword">...</span>
            <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
            <span class="string">'EV and V identical if shock is fully persistent'</span>});
        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
    <span class="keyword">end</span>

    <span class="comment">% Share y axis</span>
    <span class="keyword">if</span> (~bl_graph_onebyones)
        linkaxes(hAxis,<span class="string">'y'</span>);
    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_vev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_02.png" alt=""> <h2 id="12">Graph 2, max(EV)</h2><pre class="codeinput">    <span class="keyword">if</span>(~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="keyword">end</span>

    <span class="keyword">for</span> sub_j=1:1:1

        <span class="keyword">if</span>(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = <span class="string">'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span>(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>
        hold <span class="string">on</span>;

        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        <span class="keyword">for</span> i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, <span class="keyword">...</span>
                <span class="string">'MarkerEdgeColor'</span>, clr(i_ctr,:), <span class="keyword">...</span>
                <span class="string">'MarkerFaceColor'</span>, clr(i_ctr,:));
        <span class="keyword">end</span>

        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
        title([<span class="string">'2nd Stage Exp Value at Optimal K given W=K''+B'''</span>])
        ylabel(st_y_label)
        xlabel({<span class="string">'Aggregate Savings'</span>})

        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legendCell{length(legendCell) + 1} = <span class="string">'max-agg-save'</span>;
        legend(legendCell([ar_it_z_graph length(legendCell)]), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_03.png" alt=""> <h2 id="13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</h2><pre class="codeinput">    <span class="comment">% Borrow Vs Save</span>
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) &gt; 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));

    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="comment">% States: ar_w, ar_z</span>
    <span class="comment">% Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp</span>
    hold <span class="string">on</span>;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_borr_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'blue'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_br], {'Borrow'}, 'Location','northeast');</span>
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'black'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_khalf], {'Save &gt;0.5 K'}, 'Location','northeast');</span>
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'red'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_sv], {'Save &lt;0.5 K'}, 'Location','northeast');</span>
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'yellow'</span>, <span class="string">'filled'</span>);
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], <span class="keyword">...</span>
        {<span class="string">'Borrow'</span>,<span class="string">'Save &gt;0.5 K'</span>,<span class="string">'Save &lt;0.5 K'</span>, <span class="string">'k=0 or k=nan'</span>}, <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
    title(<span class="string">'Borrow and Save Regions'</span>)
    ylabel(<span class="string">'Shocks'</span>)
    xlabel({<span class="string">'Total Savings w=k+b'</span>})
    grid <span class="string">on</span>;

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxbrsv'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_04.png" alt=""> <h2 id="14">Graph 4, Optimal K' and B' Levels</h2><pre class="codeinput">    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    <span class="keyword">for</span> sub_j=1:1:4

        <span class="keyword">if</span> (bl_graph_onebyones)
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_bp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            <span class="keyword">end</span>

            mt_y = mt_ev_condi_z_max_kp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==3)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        <span class="keyword">end</span>

        hold <span class="string">on</span>;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));

        <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
        <span class="keyword">end</span>

        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;
        grid <span class="string">on</span>;
        <span class="keyword">if</span> (sub_j&lt;=2)
            hline = refline([1 0]);
            hline.Color = <span class="string">'k'</span>;
            hline.LineStyle = <span class="string">':'</span>;
            hline.HandleVisibility = <span class="string">'off'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            title(<span class="string">'B Choices of W'</span>);
            ylabel(<span class="string">'B Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            title(<span class="string">'K Choices of W'</span>);
            ylabel(<span class="string">'K Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==3)
            title(<span class="string">'B Fraction of Borrow Max and Save'</span>);
            ylabel(<span class="string">'B/bar(B) if br or B/W if sv'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            title(<span class="string">'K Fraction Choices of Total K Possible'</span>);
            ylabel(<span class="string">'K/(W-bar(b)) '</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
        <span class="keyword">end</span>

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_wkbopti'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_08.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans =

  Columns 1 through 7

   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120
   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120
   -3.9120   -3.9120   -3.9120   -3.9114   -3.9078   -3.8902   -3.8270
   -3.9092   -3.8965   -3.8479   -3.7101   -3.4191   -2.9536   -2.3764
   -3.1231   -2.6385   -2.1416   -1.7011   -1.3407   -1.0473   -0.8001
   -1.0435   -0.9250   -0.7923   -0.6511   -0.5058   -0.3637   -0.2253
   -0.4066   -0.3405   -0.2630   -0.1763   -0.0815    0.0195    0.1220
   -0.0228    0.0233    0.0783    0.1412    0.2116    0.2896    0.3732
    0.2535    0.2889    0.3316    0.3810    0.4371    0.5001    0.5704
    0.4695    0.4983    0.5332    0.5739    0.6205    0.6735    0.7332
    0.6470    0.6712    0.7008    0.7354    0.7753    0.8210    0.8729
    0.7977    0.8186    0.8442    0.8743    0.9092    0.9494    0.9953
    0.9286    0.9470    0.9695    0.9962    1.0272    1.0631    1.1042
    1.0443    1.0607    1.0809    1.1048    1.1328    1.1651    1.2024
    1.1480    1.1628    1.1811    1.2028    1.2282    1.2576    1.2917
    1.2419    1.2554    1.2721    1.2920    1.3152    1.3423    1.3737
    1.3278    1.3402    1.3555    1.3738    1.3953    1.4204    1.4495
    1.4068    1.4183    1.4325    1.4495    1.4694    1.4927    1.5199
    1.4801    1.4908    1.5040    1.5198    1.5384    1.5602    1.5856
    1.5483    1.5583    1.5707    1.5855    1.6030    1.6234    1.6473
    1.6122    1.6216    1.6333    1.6472    1.6636    1.6829    1.7054
    1.6723    1.6811    1.6921    1.7053    1.7208    1.7390    1.7603
    1.7290    1.7373    1.7477    1.7601    1.7748    1.7921    1.8123
    1.7826    1.7905    1.8003    1.8122    1.8261    1.8425    1.8618
    1.8335    1.8410    1.8504    1.8616    1.8749    1.8906    1.9089
    1.8819    1.8891    1.8980    1.9087    1.9214    1.9364    1.9539
    1.9281    1.9349    1.9435    1.9537    1.9658    1.9802    1.9970
    1.9722    1.9788    1.9869    1.9968    2.0084    2.0221    2.0383
    2.0145    2.0208    2.0286    2.0380    2.0492    2.0624    2.0779
    2.0550    2.0611    2.0686    2.0777    2.0884    2.1011    2.1161
    2.0940    2.0998    2.1071    2.1158    2.1262    2.1384    2.1528
    2.1315    2.1372    2.1441    2.1525    2.1625    2.1743    2.1882
    2.1677    2.1731    2.1799    2.1880    2.1976    2.2090    2.2224
    2.2026    2.2078    2.2143    2.2222    2.2315    2.2425    2.2555
    2.2363    2.2414    2.2477    2.2553    2.2643    2.2749    2.2875
    2.2689    2.2738    2.2799    2.2873    2.2960    2.3063    2.3185
    2.3005    2.3053    2.3112    2.3183    2.3268    2.3368    2.3486
    2.3312    2.3358    2.3415    2.3484    2.3566    2.3663    2.3779
    2.3609    2.3653    2.3709    2.3776    2.3856    2.3951    2.4062
    2.3897    2.3941    2.3995    2.4060    2.4138    2.4230    2.4338
    2.4178    2.4220    2.4273    2.4336    2.4412    2.4501    2.4607
    2.4451    2.4492    2.4543    2.4605    2.4678    2.4765    2.4868
    2.4716    2.4756    2.4806    2.4866    2.4938    2.5023    2.5123
    2.4975    2.5014    2.5062    2.5121    2.5191    2.5274    2.5372
    2.5227    2.5265    2.5312    2.5370    2.5438    2.5519    2.5614
    2.5473    2.5510    2.5556    2.5612    2.5679    2.5758    2.5851
    2.5713    2.5749    2.5794    2.5849    2.5914    2.5991    2.6082
    2.5947    2.5983    2.6027    2.6080    2.6144    2.6219    2.6308
    2.6176    2.6211    2.6254    2.6306    2.6368    2.6442    2.6530
    2.6400    2.6434    2.6477    2.6527    2.6588    2.6660    2.6746
    2.6619    2.6653    2.6694    2.6744    2.6803    2.6874    2.6958
    2.6834    2.6866    2.6907    2.6955    2.7014    2.7083    2.7165
    2.7044    2.7075    2.7115    2.7163    2.7220    2.7288    2.7368
    2.7249    2.7280    2.7319    2.7366    2.7422    2.7488    2.7567
    2.7451    2.7481    2.7519    2.7565    2.7620    2.7685    2.7762
    2.7648    2.7678    2.7715    2.7760    2.7814    2.7878    2.7954
    2.7842    2.7871    2.7907    2.7952    2.8004    2.8067    2.8141
    2.8031    2.8060    2.8096    2.8139    2.8191    2.8253    2.8326
    2.8218    2.8246    2.8281    2.8324    2.8375    2.8435    2.8507
    2.8401    2.8428    2.8463    2.8505    2.8555    2.8614    2.8685
    2.8580    2.8608    2.8642    2.8683    2.8732    2.8790    2.8859
    2.8757    2.8784    2.8817    2.8857    2.8906    2.8963    2.9031
    2.8930    2.8957    2.8990    2.9029    2.9077    2.9133    2.9200
    2.9101    2.9127    2.9159    2.9198    2.9245    2.9300    2.9366
    2.9268    2.9294    2.9326    2.9364    2.9410    2.9464    2.9529
    2.9433    2.9458    2.9490    2.9527    2.9572    2.9626    2.9690
    2.9596    2.9620    2.9651    2.9688    2.9732    2.9785    2.9848
    2.9755    2.9779    2.9810    2.9846    2.9890    2.9942    3.0004
    2.9912    2.9936    2.9966    3.0002    3.0045    3.0096    3.0157
    3.0067    3.0090    3.0120    3.0155    3.0198    3.0248    3.0308
    3.0219    3.0242    3.0271    3.0306    3.0348    3.0398    3.0457
    3.0305    3.0328    3.0357    3.0391    3.0433    3.0482    3.0541
    3.0369    3.0392    3.0420    3.0455    3.0496    3.0545    3.0603
    3.0517    3.0539    3.0568    3.0601    3.0642    3.0690    3.0747
    3.0663    3.0685    3.0712    3.0746    3.0786    3.0833    3.0890
    3.0805    3.0828    3.0855    3.0888    3.0928    3.0974    3.1030
    3.0943    3.0967    3.0996    3.1029    3.1067    3.1114    3.1169
    3.1077    3.1102    3.1132    3.1167    3.1205    3.1251    3.1305
    3.1207    3.1234    3.1265    3.1301    3.1341    3.1386    3.1440
    3.1335    3.1362    3.1395    3.1431    3.1473    3.1520    3.1573
    3.1461    3.1488    3.1521    3.1559    3.1602    3.1650    3.1704
    3.1585    3.1612    3.1645    3.1685    3.1729    3.1778    3.1832
    3.1707    3.1734    3.1767    3.1807    3.1852    3.1902    3.1959
    3.1829    3.1855    3.1888    3.1927    3.1973    3.2024    3.2082
    3.1948    3.1974    3.2007    3.2046    3.2092    3.2145    3.2203
    3.2067    3.2092    3.2124    3.2163    3.2209    3.2262    3.2321
    3.2184    3.2209    3.2241    3.2279    3.2324    3.2378    3.2438
    3.2299    3.2324    3.2356    3.2393    3.2438    3.2492    3.2553
    3.2414    3.2438    3.2469    3.2507    3.2551    3.2604    3.2666
    3.2526    3.2551    3.2582    3.2618    3.2663    3.2715    3.2777
    3.2638    3.2662    3.2693    3.2729    3.2773    3.2825    3.2886
    3.2749    3.2773    3.2803    3.2839    3.2882    3.2933    3.2994
    3.2858    3.2882    3.2911    3.2947    3.2990    3.3040    3.3101
    3.2966    3.2989    3.3019    3.3054    3.3096    3.3147    3.3206
    3.3073    3.3096    3.3125    3.3160    3.3202    3.3252    3.3311
    3.3179    3.3202    3.3230    3.3265    3.3306    3.3356    3.3414
    3.3283    3.3306    3.3335    3.3369    3.3410    3.3458    3.3516
    3.3387    3.3410    3.3438    3.3472    3.3512    3.3560    3.3618
    3.3490    3.3512    3.3540    3.3573    3.3613    3.3661    3.3718
    3.3591    3.3613    3.3641    3.3674    3.3714    3.3761    3.3817
    3.3692    3.3713    3.3741    3.3774    3.3813    3.3860    3.3915
    3.3791    3.3813    3.3840    3.3872    3.3911    3.3957    3.4013
    3.3890    3.3911    3.3938    3.3970    3.4008    3.4054    3.4109
    3.3987    3.4008    3.4035    3.4067    3.4105    3.4150    3.4204
    3.4084    3.4105    3.4131    3.4163    3.4200    3.4245    3.4299
    3.4179    3.4200    3.4226    3.4257    3.4295    3.4340    3.4393
    3.4274    3.4295    3.4320    3.4352    3.4389    3.4433    3.4485
    3.4368    3.4388    3.4414    3.4445    3.4481    3.4525    3.4577
    3.4461    3.4481    3.4506    3.4537    3.4573    3.4617    3.4668
    3.4553    3.4573    3.4598    3.4628    3.4665    3.4708    3.4759
    3.4645    3.4664    3.4689    3.4719    3.4755    3.4797    3.4848
    3.4735    3.4755    3.4779    3.4809    3.4844    3.4887    3.4937
    3.4825    3.4844    3.4868    3.4898    3.4933    3.4975    3.5025
    3.4914    3.4933    3.4957    3.4986    3.5021    3.5062    3.5112
    3.5002    3.5021    3.5045    3.5074    3.5108    3.5149    3.5198
    3.5089    3.5108    3.5132    3.5160    3.5195    3.5235    3.5284
    3.5176    3.5194    3.5218    3.5246    3.5280    3.5321    3.5369
    3.5261    3.5280    3.5303    3.5331    3.5365    3.5405    3.5453
    3.5346    3.5365    3.5388    3.5416    3.5449    3.5489    3.5536
    3.5431    3.5449    3.5472    3.5500    3.5533    3.5572    3.5619
    3.5515    3.5533    3.5555    3.5583    3.5616    3.5655    3.5701
    3.5597    3.5616    3.5638    3.5665    3.5698    3.5737    3.5783
    3.5680    3.5698    3.5720    3.5747    3.5779    3.5818    3.5864
    3.5761    3.5779    3.5801    3.5828    3.5860    3.5898    3.5944
    3.5842    3.5860    3.5882    3.5908    3.5940    3.5978    3.6023
    3.5923    3.5940    3.5962    3.5988    3.6020    3.6057    3.6102
    3.6002    3.6020    3.6041    3.6067    3.6099    3.6136    3.6180
    3.6081    3.6099    3.6120    3.6146    3.6177    3.6214    3.6258
    3.6160    3.6177    3.6198    3.6224    3.6255    3.6291    3.6335
    3.6238    3.6255    3.6276    3.6301    3.6332    3.6368    3.6412
    3.6315    3.6332    3.6353    3.6378    3.6408    3.6444    3.6487
    3.6391    3.6408    3.6429    3.6454    3.6484    3.6520    3.6563
    3.6467    3.6484    3.6505    3.6530    3.6560    3.6595    3.6637
    3.6543    3.6559    3.6580    3.6605    3.6634    3.6670    3.6712
    3.6618    3.6634    3.6654    3.6679    3.6708    3.6744    3.6785
    3.6692    3.6708    3.6729    3.6753    3.6782    3.6817    3.6858
    3.6766    3.6782    3.6802    3.6826    3.6855    3.6890    3.6931
    3.6839    3.6855    3.6875    3.6899    3.6928    3.6962    3.7003
    3.6912    3.6928    3.6947    3.6971    3.7000    3.7034    3.7075
    3.6984    3.7000    3.7019    3.7043    3.7072    3.7105    3.7146
    3.7056    3.7071    3.7091    3.7114    3.7143    3.7176    3.7216
    3.7127    3.7142    3.7162    3.7185    3.7213    3.7247    3.7286
    3.7198    3.7213    3.7232    3.7255    3.7283    3.7316    3.7356
    3.7268    3.7283    3.7302    3.7325    3.7353    3.7386    3.7425
    3.7337    3.7353    3.7372    3.7394    3.7422    3.7455    3.7493
    3.7407    3.7422    3.7441    3.7463    3.7490    3.7523    3.7562
    3.7475    3.7490    3.7509    3.7532    3.7559    3.7591    3.7629
    3.7544    3.7558    3.7577    3.7599    3.7626    3.7658    3.7696
    3.7611    3.7626    3.7645    3.7667    3.7694    3.7725    3.7763
    3.7679    3.7693    3.7712    3.7734    3.7760    3.7792    3.7830
    3.7746    3.7760    3.7778    3.7800    3.7827    3.7858    3.7895
    3.7812    3.7827    3.7845    3.7866    3.7893    3.7924    3.7961
    3.7878    3.7892    3.7910    3.7932    3.7958    3.7989    3.8026
    3.7944    3.7958    3.7976    3.7997    3.8023    3.8054    3.8091
    3.8009    3.8023    3.8041    3.8062    3.8088    3.8118    3.8155
    3.8073    3.8088    3.8105    3.8126    3.8152    3.8182    3.8219
    3.8138    3.8152    3.8169    3.8190    3.8216    3.8246    3.8282
    3.8202    3.8216    3.8233    3.8254    3.8279    3.8309    3.8345
    3.8265    3.8279    3.8296    3.8317    3.8342    3.8372    3.8407
    3.8328    3.8342    3.8359    3.8380    3.8405    3.8434    3.8470
    3.8391    3.8405    3.8422    3.8442    3.8467    3.8496    3.8531
    3.8453    3.8467    3.8484    3.8504    3.8529    3.8558    3.8593
    3.8515    3.8529    3.8545    3.8566    3.8590    3.8619    3.8654
    3.8577    3.8590    3.8607    3.8627    3.8651    3.8680    3.8715
    3.8638    3.8651    3.8668    3.8688    3.8712    3.8741    3.8775
    3.8699    3.8712    3.8728    3.8748    3.8772    3.8801    3.8835
    3.8759    3.8772    3.8789    3.8809    3.8832    3.8861    3.8895
    3.8819    3.8832    3.8848    3.8868    3.8892    3.8920    3.8954
    3.8879    3.8892    3.8908    3.8928    3.8951    3.8979    3.9013
    3.8938    3.8951    3.8967    3.8987    3.9010    3.9038    3.9071
    3.8997    3.9010    3.9026    3.9045    3.9069    3.9096    3.9129
    3.9056    3.9069    3.9084    3.9104    3.9127    3.9154    3.9187
    3.9114    3.9127    3.9143    3.9162    3.9185    3.9212    3.9245
    3.9172    3.9185    3.9200    3.9220    3.9242    3.9270    3.9302
    3.9230    3.9242    3.9258    3.9277    3.9300    3.9327    3.9359
    3.9287    3.9299    3.9315    3.9334    3.9356    3.9383    3.9416
    3.9344    3.9356    3.9372    3.9391    3.9413    3.9440    3.9472
    3.9401    3.9413    3.9428    3.9447    3.9469    3.9496    3.9528
    3.9457    3.9469    3.9485    3.9503    3.9525    3.9552    3.9583
    3.9513    3.9525    3.9540    3.9559    3.9581    3.9607    3.9639
    3.9569    3.9581    3.9596    3.9614    3.9636    3.9662    3.9694
    3.9624    3.9636    3.9651    3.9669    3.9691    3.9717    3.9748
    3.9679    3.9691    3.9706    3.9724    3.9746    3.9772    3.9803
    3.9734    3.9746    3.9761    3.9779    3.9800    3.9826    3.9857
    3.9788    3.9800    3.9815    3.9833    3.9855    3.9880    3.9911
    3.9843    3.9854    3.9869    3.9887    3.9908    3.9934    3.9964
    3.9896    3.9908    3.9923    3.9941    3.9962    3.9987    4.0018
    3.9950    3.9962    3.9976    3.9994    4.0015    4.0040    4.0070
    4.0003    4.0015    4.0030    4.0047    4.0068    4.0093    4.0123
    4.0056    4.0068    4.0082    4.0100    4.0121    4.0146    4.0176
    4.0109    4.0121    4.0135    4.0152    4.0173    4.0198    4.0228
    4.0162    4.0173    4.0187    4.0205    4.0225    4.0250    4.0280
    4.0214    4.0225    4.0240    4.0257    4.0277    4.0302    4.0331
    4.0266    4.0277    4.0291    4.0308    4.0329    4.0353    4.0383
    4.0318    4.0329    4.0343    4.0360    4.0380    4.0405    4.0434
    4.0369    4.0380    4.0394    4.0411    4.0431    4.0456    4.0484
    4.0420    4.0431    4.0445    4.0462    4.0482    4.0506    4.0535
    4.0471    4.0482    4.0496    4.0513    4.0533    4.0557    4.0585
    4.0522    4.0533    4.0546    4.0563    4.0583    4.0607    4.0635
    4.0572    4.0583    4.0597    4.0613    4.0633    4.0657    4.0685
    4.0622    4.0633    4.0647    4.0663    4.0683    4.0707    4.0735
    4.0672    4.0683    4.0696    4.0713    4.0733    4.0756    4.0784
    4.0722    4.0732    4.0746    4.0762    4.0782    4.0805    4.0833
    4.0771    4.0782    4.0795    4.0811    4.0831    4.0854    4.0882
    4.0820    4.0831    4.0844    4.0860    4.0880    4.0903    4.0931
    4.0869    4.0880    4.0893    4.0909    4.0928    4.0951    4.0979
    4.0918    4.0928    4.0942    4.0958    4.0977    4.1000    4.1027
    4.0966    4.0977    4.0990    4.1006    4.1025    4.1048    4.1075
    4.1014    4.1025    4.1038    4.1054    4.1073    4.1096    4.1123
    4.1062    4.1073    4.1086    4.1102    4.1121    4.1143    4.1170
    4.1110    4.1120    4.1133    4.1149    4.1168    4.1190    4.1217
    4.1157    4.1168    4.1181    4.1196    4.1215    4.1238    4.1264
    4.1205    4.1215    4.1228    4.1244    4.1262    4.1284    4.1311
    4.1252    4.1262    4.1275    4.1290    4.1309    4.1331    4.1358
    4.1299    4.1309    4.1322    4.1337    4.1356    4.1378    4.1404
    4.1345    4.1355    4.1368    4.1384    4.1402    4.1424    4.1450
    4.1392    4.1402    4.1414    4.1430    4.1448    4.1470    4.1496
    4.1438    4.1448    4.1460    4.1476    4.1494    4.1516    4.1542
    4.1484    4.1494    4.1506    4.1522    4.1540    4.1561    4.1587
    4.1530    4.1540    4.1552    4.1567    4.1585    4.1607    4.1632
    4.1575    4.1585    4.1597    4.1612    4.1631    4.1652    4.1678
    4.1620    4.1630    4.1643    4.1658    4.1676    4.1697    4.1722
    4.1666    4.1675    4.1688    4.1703    4.1721    4.1742    4.1767
    4.1711    4.1720    4.1733    4.1747    4.1765    4.1786    4.1812
    4.1755    4.1765    4.1777    4.1792    4.1810    4.1831    4.1856
    4.1800    4.1810    4.1822    4.1836    4.1854    4.1875    4.1900
    4.1844    4.1854    4.1866    4.1881    4.1898    4.1919    4.1944
    4.1888    4.1898    4.1910    4.1925    4.1942    4.1963    4.1988
    4.1932    4.1942    4.1954    4.1968    4.1986    4.2006    4.2031
    4.1976    4.1986    4.1998    4.2012    4.2029    4.2050    4.2074
    4.2020    4.2029    4.2041    4.2055    4.2073    4.2093    4.2118
    4.2063    4.2072    4.2084    4.2099    4.2116    4.2136    4.2161
    4.2106    4.2116    4.2127    4.2142    4.2159    4.2179    4.2203
    4.2149    4.2159    4.2170    4.2184    4.2201    4.2222    4.2246
    4.2192    4.2201    4.2213    4.2227    4.2244    4.2264    4.2288
    4.2235    4.2244    4.2256    4.2270    4.2287    4.2307    4.2331
    4.2277    4.2286    4.2298    4.2312    4.2329    4.2349    4.2373
    4.2319    4.2329    4.2340    4.2354    4.2371    4.2391    4.2415
    4.2362    4.2371    4.2382    4.2396    4.2413    4.2433    4.2456
    4.2403    4.2413    4.2424    4.2438    4.2454    4.2474    4.2498
    4.2445    4.2454    4.2466    4.2479    4.2496    4.2516    4.2539
    4.2487    4.2496    4.2507    4.2521    4.2537    4.2557    4.2580
    4.2528    4.2537    4.2548    4.2562    4.2579    4.2598    4.2621
    4.2569    4.2578    4.2590    4.2603    4.2620    4.2639    4.2662
    4.2610    4.2619    4.2631    4.2644    4.2660    4.2680    4.2703
    4.2651    4.2660    4.2671    4.2685    4.2701    4.2720    4.2743
    4.2692    4.2701    4.2712    4.2726    4.2742    4.2761    4.2784
    4.2733    4.2741    4.2753    4.2766    4.2782    4.2801    4.2824
    4.2773    4.2782    4.2793    4.2806    4.2822    4.2841    4.2864

  Columns 8 through 14

   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120   -3.9120
   -3.9117   -3.9097   -3.8993   -3.8587   -3.7381   -3.4650   -2.9937
   -3.6584   -3.3200   -2.8007   -2.1761   -1.5641   -1.0482   -0.6483
   -1.7999   -1.3076   -0.9182   -0.6099   -0.3548   -0.1340    0.0609
   -0.5831   -0.3868   -0.2054   -0.0352    0.1261    0.2795    0.4240
   -0.0900    0.0427    0.1731    0.3015    0.4280    0.5524    0.6726
    0.2257    0.3305    0.4361    0.5427    0.6499    0.7571    0.8624
    0.4593    0.5478    0.6385    0.7312    0.8257    0.9213    1.0162
    0.6451    0.7227    0.8030    0.8860    0.9714    1.0586    1.1457
    0.7994    0.8691    0.9419    1.0176    1.0960    1.1766    1.2576
    0.9314    0.9951    1.0620    1.1319    1.2049    1.2802    1.3562
    1.0473    1.1057    1.1679    1.2332    1.3016    1.3725    1.4444
    1.1511    1.2043    1.2626    1.3241    1.3887    1.4559    1.5243
    1.2451    1.2937    1.3483    1.4065    1.4679    1.5319    1.5973
    1.3309    1.3757    1.4266    1.4820    1.5405    1.6018    1.6645
    1.4099    1.4514    1.4988    1.5516    1.6077    1.6665    1.7268
    1.4831    1.5218    1.5661    1.6162    1.6701    1.7267    1.7849
    1.5513    1.5875    1.6291    1.6765    1.7284    1.7831    1.8394
    1.6151    1.6492    1.6883    1.7331    1.7831    1.8361    1.8906
    1.6751    1.7072    1.7442    1.7867    1.8347    1.8860    1.9389
    1.7316    1.7621    1.7972    1.8375    1.8835    1.9333    1.9848
    1.7852    1.8141    1.8475    1.8859    1.9298    1.9782    2.0283
    1.8360    1.8635    1.8953    1.9320    1.9740    2.0210    2.0698
    1.8843    1.9105    1.9410    1.9761    2.0163    2.0617    2.1094
    1.9304    1.9555    1.9846    2.0183    2.0569    2.1008    2.1474
    1.9745    1.9985    2.0264    2.0588    2.0959    2.1382    2.1837
    2.0167    2.0398    2.0666    2.0977    2.1335    2.1742    2.2187
    2.0572    2.0794    2.1052    2.1351    2.1696    2.2090    2.2523
    2.0961    2.1175    2.1423    2.1712    2.2045    2.2426    2.2847
    2.1336    2.1542    2.1781    2.2060    2.2383    2.2751    2.3159
    2.1697    2.1895    2.2127    2.2397    2.2709    2.3065    2.3462
    2.2046    2.2237    2.2461    2.2722    2.3025    2.3371    2.3755
    2.2382    2.2568    2.2785    2.3038    2.3331    2.3667    2.4040
    2.2708    2.2888    2.3098    2.3343    2.3628    2.3954    2.4318
    2.3023    2.3198    2.3402    2.3640    2.3916    2.4233    2.4587
    2.3329    2.3498    2.3696    2.3928    2.4196    2.4505    2.4850
    2.3626    2.3790    2.3983    2.4208    2.4469    2.4770    2.5106
    2.3914    2.4074    2.4261    2.4480    2.4735    2.5027    2.5355
    2.4194    2.4349    2.4532    2.4745    2.4993    2.5279    2.5598
    2.4467    2.4618    2.4795    2.5003    2.5245    2.5524    2.5836
    2.4732    2.4879    2.5052    2.5255    2.5491    2.5763    2.6068
    2.4990    2.5134    2.5302    2.5500    2.5731    2.5997    2.6295
    2.5242    2.5382    2.5547    2.5740    2.5965    2.6225    2.6516
    2.5488    2.5624    2.5785    2.5974    2.6194    2.6448    2.6733
    2.5728    2.5861    2.6018    2.6202    2.6418    2.6666    2.6945
    2.5962    2.6092    2.6246    2.6426    2.6636    2.6880    2.7153
    2.6190    2.6318    2.6468    2.6644    2.6851    2.7089    2.7357
    2.6414    2.6539    2.6686    2.6858    2.7060    2.7294    2.7556
    2.6633    2.6755    2.6899    2.7068    2.7266    2.7494    2.7752
    2.6847    2.6967    2.7107    2.7273    2.7467    2.7691    2.7944
    2.7057    2.7174    2.7312    2.7474    2.7664    2.7884    2.8132
    2.7262    2.7377    2.7512    2.7671    2.7857    2.8073    2.8316
    2.7463    2.7575    2.7708    2.7864    2.8047    2.8259    2.8498
    2.7660    2.7771    2.7901    2.8054    2.8233    2.8441    2.8676
    2.7854    2.7962    2.8090    2.8240    2.8416    2.8620    2.8851
    2.8043    2.8150    2.8275    2.8422    2.8596    2.8796    2.9023
    2.8230    2.8334    2.8457    2.8602    2.8772    2.8969    2.9192
    2.8412    2.8515    2.8636    2.8778    2.8945    2.9139    2.9358
    2.8592    2.8692    2.8811    2.8951    2.9115    2.9306    2.9522
    2.8768    2.8867    2.8984    2.9121    2.9283    2.9471    2.9683
    2.8941    2.9039    2.9153    2.9289    2.9448    2.9632    2.9841
    2.9112    2.9207    2.9320    2.9453    2.9610    2.9791    2.9997
    2.9279    2.9373    2.9484    2.9615    2.9769    2.9948    3.0150
    2.9444    2.9536    2.9646    2.9775    2.9926    3.0102    3.0302
    2.9606    2.9697    2.9804    2.9931    3.0081    3.0254    3.0450
    2.9765    2.9855    2.9961    3.0086    3.0233    3.0404    3.0597
    2.9922    3.0010    3.0115    3.0238    3.0383    3.0551    3.0742
    3.0077    3.0164    3.0266    3.0388    3.0530    3.0696    3.0884
    3.0229    3.0315    3.0416    3.0535    3.0676    3.0840    3.1025
    3.0379    3.0463    3.0563    3.0681    3.0819    3.0981    3.1163
    3.0527    3.0610    3.0708    3.0824    3.0961    3.1120    3.1300
    3.0610    3.0692    3.0790    3.0905    3.1041    3.1198    3.1377
    3.0672    3.0754    3.0851    3.0965    3.1100    3.1257    3.1435
    3.0816    3.0896    3.0992    3.1105    3.1238    3.1392    3.1568
    3.0957    3.1036    3.1131    3.1242    3.1373    3.1526    3.1699
    3.1096    3.1175    3.1268    3.1378    3.1507    3.1658    3.1829
    3.1234    3.1311    3.1403    3.1511    3.1639    3.1788    3.1957
    3.1370    3.1446    3.1536    3.1643    3.1769    3.1916    3.2083
    3.1503    3.1579    3.1668    3.1774    3.1898    3.2043    3.2208
    3.1635    3.1710    3.1798    3.1902    3.2025    3.2168    3.2331
    3.1766    3.1839    3.1926    3.2029    3.2150    3.2292    3.2453
    3.1894    3.1967    3.2053    3.2155    3.2274    3.2414    3.2573
    3.2021    3.2093    3.2178    3.2278    3.2397    3.2535    3.2692
    3.2146    3.2218    3.2301    3.2401    3.2518    3.2654    3.2809
    3.2268    3.2341    3.2423    3.2521    3.2637    3.2772    3.2925
    3.2388    3.2461    3.2544    3.2641    3.2755    3.2888    3.3040
    3.2505    3.2580    3.2663    3.2759    3.2872    3.3004    3.3153
    3.2620    3.2696    3.2780    3.2875    3.2987    3.3117    3.3265
    3.2734    3.2811    3.2896    3.2991    3.3101    3.3230    3.3376
    3.2846    3.2923    3.3009    3.3105    3.3214    3.3341    3.3486
    3.2956    3.3034    3.3120    3.3217    3.3325    3.3451    3.3594
    3.3064    3.3143    3.3230    3.3327    3.3435    3.3560    3.3702
    3.3171    3.3250    3.3338    3.3436    3.3544    3.3668    3.3808
    3.3277    3.3356    3.3445    3.3543    3.3652    3.3774    3.3913
    3.3381    3.3461    3.3550    3.3649    3.3758    3.3880    3.4017
    3.3484    3.3564    3.3653    3.3753    3.3863    3.3984    3.4120
    3.3585    3.3665    3.3755    3.3855    3.3966    3.4087    3.4222
    3.3686    3.3766    3.3856    3.3956    3.4067    3.4189    3.4322
    3.3785    3.3865    3.3955    3.4056    3.4168    3.4290    3.4422
    3.3884    3.3963    3.4054    3.4154    3.4266    3.4389    3.4521
    3.3981    3.4060    3.4151    3.4252    3.4364    3.4487    3.4619
    3.4078    3.4156    3.4247    3.4348    3.4461    3.4584    3.4716
    3.4174    3.4251    3.4341    3.4443    3.4556    3.4680    3.4812
    3.4269    3.4345    3.4435    3.4537    3.4649    3.4774    3.4906
    3.4363    3.4438    3.4527    3.4630    3.4743    3.4867    3.4999
    3.4456    3.4530    3.4619    3.4721    3.4835    3.4959    3.5092
    3.4548    3.4622    3.4710    3.4812    3.4925    3.5050    3.5183
    3.4639    3.4713    3.4800    3.4902    3.5015    3.5140    3.5273
    3.4730    3.4803    3.4889    3.4990    3.5104    3.5229    3.5362
    3.4819    3.4892    3.4977    3.5078    3.5192    3.5317    3.5450
    3.4908    3.4980    3.5065    3.5165    3.5279    3.5404    3.5537
    3.4997    3.5067    3.5151    3.5251    3.5365    3.5490    3.5624
    3.5084    3.5154    3.5237    3.5336    3.5450    3.5575    3.5709
    3.5171    3.5240    3.5323    3.5420    3.5534    3.5659    3.5793
    3.5256    3.5325    3.5407    3.5504    3.5618    3.5743    3.5876
    3.5342    3.5410    3.5491    3.5587    3.5700    3.5825    3.5959
    3.5426    3.5494    3.5574    3.5670    3.5782    3.5907    3.6041
    3.5510    3.5577    3.5657    3.5751    3.5863    3.5988    3.6122
    3.5593    3.5659    3.5739    3.5832    3.5943    3.6068    3.6202
    3.5675    3.5741    3.5820    3.5913    3.6023    3.6148    3.6282
    3.5757    3.5822    3.5900    3.5993    3.6102    3.6226    3.6360
    3.5838    3.5903    3.5980    3.6072    3.6180    3.6304    3.6438
    3.5918    3.5983    3.6059    3.6150    3.6258    3.6382    3.6515
    3.5998    3.6062    3.6138    3.6228    3.6335    3.6458    3.6592
    3.6077    3.6140    3.6216    3.6305    3.6411    3.6534    3.6668
    3.6155    3.6218    3.6293    3.6382    3.6487    3.6609    3.6743
    3.6233    3.6296    3.6370    3.6458    3.6562    3.6684    3.6817
    3.6310    3.6373    3.6446    3.6534    3.6637    3.6758    3.6891
    3.6387    3.6449    3.6522    3.6609    3.6711    3.6831    3.6964
    3.6463    3.6524    3.6597    3.6683    3.6785    3.6904    3.7036
    3.6539    3.6599    3.6672    3.6757    3.6858    3.6976    3.7108
    3.6614    3.6674    3.6746    3.6830    3.6931    3.7048    3.7180
    3.6688    3.6748    3.6819    3.6903    3.7003    3.7119    3.7250
    3.6762    3.6821    3.6892    3.6975    3.7074    3.7190    3.7321
    3.6835    3.6894    3.6964    3.7047    3.7145    3.7260    3.7390
    3.6908    3.6966    3.7036    3.7118    3.7216    3.7330    3.7459
    3.6980    3.7038    3.7107    3.7189    3.7286    3.7399    3.7528
    3.7052    3.7109    3.7178    3.7259    3.7356    3.7468    3.7596
    3.7123    3.7180    3.7248    3.7329    3.7425    3.7536    3.7663
    3.7194    3.7251    3.7318    3.7398    3.7493    3.7604    3.7730
    3.7264    3.7320    3.7388    3.7467    3.7561    3.7672    3.7797
    3.7334    3.7390    3.7456    3.7536    3.7629    3.7738    3.7863
    3.7403    3.7459    3.7525    3.7603    3.7696    3.7805    3.7929
    3.7471    3.7527    3.7593    3.7671    3.7763    3.7871    3.7994
    3.7540    3.7595    3.7660    3.7738    3.7829    3.7937    3.8059
    3.7608    3.7662    3.7727    3.7804    3.7895    3.8002    3.8123
    3.7675    3.7729    3.7794    3.7870    3.7961    3.8067    3.8187
    3.7742    3.7796    3.7860    3.7936    3.8026    3.8131    3.8251
    3.7808    3.7862    3.7926    3.8001    3.8090    3.8195    3.8314
    3.7874    3.7928    3.7991    3.8066    3.8155    3.8258    3.8377
    3.7940    3.7993    3.8056    3.8130    3.8218    3.8322    3.8439
    3.8005    3.8058    3.8120    3.8194    3.8282    3.8384    3.8501
    3.8070    3.8122    3.8184    3.8258    3.8345    3.8447    3.8563
    3.8134    3.8186    3.8248    3.8321    3.8407    3.8509    3.8624
    3.8198    3.8250    3.8311    3.8384    3.8470    3.8570    3.8685
    3.8262    3.8313    3.8374    3.8446    3.8531    3.8631    3.8745
    3.8325    3.8376    3.8436    3.8508    3.8593    3.8692    3.8806
    3.8387    3.8438    3.8498    3.8569    3.8654    3.8753    3.8865
    3.8450    3.8500    3.8560    3.8631    3.8715    3.8813    3.8925
    3.8512    3.8562    3.8621    3.8692    3.8775    3.8873    3.8984
    3.8573    3.8623    3.8682    3.8752    3.8835    3.8932    3.9043
    3.8634    3.8684    3.8742    3.8812    3.8894    3.8991    3.9101
    3.8695    3.8744    3.8803    3.8872    3.8954    3.9050    3.9159
    3.8756    3.8804    3.8862    3.8931    3.9013    3.9108    3.9217
    3.8816    3.8864    3.8922    3.8990    3.9071    3.9166    3.9274
    3.8875    3.8924    3.8981    3.9049    3.9129    3.9224    3.9331
    3.8935    3.8983    3.9040    3.9107    3.9187    3.9281    3.9388
    3.8994    3.9041    3.9098    3.9165    3.9245    3.9338    3.9444
    3.9052    3.9100    3.9156    3.9223    3.9302    3.9395    3.9501
    3.9111    3.9158    3.9214    3.9280    3.9359    3.9451    3.9556
    3.9169    3.9216    3.9271    3.9337    3.9416    3.9507    3.9612
    3.9226    3.9273    3.9328    3.9394    3.9472    3.9563    3.9667
    3.9284    3.9330    3.9385    3.9450    3.9528    3.9618    3.9722
    3.9341    3.9387    3.9441    3.9506    3.9583    3.9674    3.9776
    3.9397    3.9443    3.9498    3.9562    3.9639    3.9728    3.9831
    3.9454    3.9499    3.9553    3.9618    3.9694    3.9783    3.9885
    3.9510    3.9555    3.9609    3.9673    3.9748    3.9837    3.9938
    3.9566    3.9611    3.9664    3.9728    3.9803    3.9891    3.9992
    3.9621    3.9666    3.9719    3.9782    3.9857    3.9945    4.0045
    3.9676    3.9721    3.9773    3.9836    3.9911    3.9998    4.0098
    3.9731    3.9775    3.9828    3.9890    3.9964    4.0051    4.0150
    3.9785    3.9829    3.9882    3.9944    4.0018    4.0104    4.0202
    3.9840    3.9883    3.9935    3.9997    4.0071    4.0156    4.0255
    3.9894    3.9937    3.9989    4.0050    4.0123    4.0209    4.0306
    3.9947    3.9990    4.0042    4.0103    4.0176    4.0261    4.0358
    4.0000    4.0044    4.0095    4.0156    4.0228    4.0312    4.0409
    4.0054    4.0096    4.0147    4.0208    4.0280    4.0364    4.0460
    4.0106    4.0149    4.0200    4.0260    4.0331    4.0415    4.0511
    4.0159    4.0201    4.0252    4.0312    4.0383    4.0466    4.0561
    4.0211    4.0253    4.0303    4.0363    4.0434    4.0517    4.0611
    4.0263    4.0305    4.0355    4.0414    4.0485    4.0567    4.0661
    4.0315    4.0356    4.0406    4.0465    4.0535    4.0617    4.0711
    4.0366    4.0408    4.0457    4.0516    4.0585    4.0667    4.0760
    4.0417    4.0459    4.0508    4.0566    4.0635    4.0717    4.0809
    4.0468    4.0509    4.0558    4.0616    4.0685    4.0766    4.0858
    4.0519    4.0560    4.0608    4.0666    4.0735    4.0815    4.0907
    4.0569    4.0610    4.0658    4.0716    4.0784    4.0864    4.0956
    4.0619    4.0660    4.0708    4.0765    4.0833    4.0913    4.1004
    4.0669    4.0710    4.0758    4.0815    4.0882    4.0961    4.1052
    4.0719    4.0759    4.0807    4.0863    4.0931    4.1010    4.1100
    4.0768    4.0808    4.0856    4.0912    4.0979    4.1058    4.1147
    4.0817    4.0857    4.0904    4.0961    4.1027    4.1105    4.1195
    4.0866    4.0906    4.0953    4.1009    4.1075    4.1153    4.1242
    4.0915    4.0954    4.1001    4.1057    4.1123    4.1200    4.1289
    4.0963    4.1003    4.1049    4.1105    4.1170    4.1247    4.1335
    4.1012    4.1051    4.1097    4.1152    4.1217    4.1294    4.1382
    4.1060    4.1098    4.1145    4.1199    4.1264    4.1341    4.1428
    4.1107    4.1146    4.1192    4.1246    4.1311    4.1387    4.1474
    4.1155    4.1193    4.1239    4.1293    4.1358    4.1433    4.1520
    4.1202    4.1240    4.1286    4.1340    4.1404    4.1479    4.1565
    4.1249    4.1287    4.1333    4.1386    4.1450    4.1525    4.1611
    4.1296    4.1334    4.1379    4.1433    4.1496    4.1571    4.1656
    4.1343    4.1380    4.1425    4.1479    4.1542    4.1616    4.1701
    4.1389    4.1427    4.1471    4.1524    4.1587    4.1661    4.1746
    4.1435    4.1473    4.1517    4.1570    4.1633    4.1706    4.1790
    4.1481    4.1518    4.1563    4.1615    4.1678    4.1751    4.1835
    4.1527    4.1564    4.1608    4.1661    4.1723    4.1796    4.1879
    4.1573    4.1610    4.1653    4.1706    4.1767    4.1840    4.1923
    4.1618    4.1655    4.1698    4.1750    4.1812    4.1884    4.1967
    4.1663    4.1700    4.1743    4.1795    4.1856    4.1928    4.2010
    4.1708    4.1744    4.1788    4.1839    4.1900    4.1972    4.2054
    4.1753    4.1789    4.1832    4.1883    4.1944    4.2015    4.2097
    4.1797    4.1833    4.1876    4.1927    4.1988    4.2059    4.2140
    4.1842    4.1878    4.1920    4.1971    4.2031    4.2102    4.2183
    4.1886    4.1922    4.1964    4.2015    4.2075    4.2145    4.2226
    4.1930    4.1965    4.2008    4.2058    4.2118    4.2188    4.2268
    4.1974    4.2009    4.2051    4.2101    4.2161    4.2231    4.2310
    4.2017    4.2053    4.2094    4.2144    4.2204    4.2273    4.2353
    4.2061    4.2096    4.2138    4.2187    4.2246    4.2315    4.2395
    4.2104    4.2139    4.2180    4.2230    4.2289    4.2358    4.2436
    4.2147    4.2182    4.2223    4.2272    4.2331    4.2399    4.2478
    4.2190    4.2224    4.2266    4.2315    4.2373    4.2441    4.2519
    4.2232    4.2267    4.2308    4.2357    4.2415    4.2483    4.2561
    4.2275    4.2309    4.2350    4.2399    4.2456    4.2524    4.2602
    4.2317    4.2351    4.2392    4.2441    4.2498    4.2566    4.2643
    4.2359    4.2393    4.2434    4.2482    4.2539    4.2607    4.2683
    4.2401    4.2435    4.2475    4.2524    4.2581    4.2648    4.2724
    4.2443    4.2477    4.2517    4.2565    4.2622    4.2688    4.2764
    4.2485    4.2518    4.2558    4.2606    4.2662    4.2729    4.2805
    4.2526    4.2559    4.2599    4.2647    4.2703    4.2769    4.2845
    4.2567    4.2601    4.2640    4.2688    4.2744    4.2810    4.2885
    4.2608    4.2641    4.2681    4.2728    4.2784    4.2850    4.2925
    4.2649    4.2682    4.2722    4.2769    4.2824    4.2890    4.2964
    4.2690    4.2723    4.2762    4.2809    4.2864    4.2929    4.3004
    4.2730    4.2763    4.2802    4.2849    4.2904    4.2969    4.3043
    4.2771    4.2804    4.2843    4.2889    4.2944    4.3008    4.3082
    4.2811    4.2844    4.2882    4.2929    4.2983    4.3048    4.3121
    4.2851    4.2884    4.2922    4.2968    4.3023    4.3087    4.3160
    4.2891    4.2923    4.2962    4.3008    4.3062    4.3126    4.3199

  Column 15

   -3.9120
   -2.3746
   -0.3484
    0.2300
    0.5550
    0.7838
    0.9609
    1.1057
    1.2283
    1.3348
    1.4290
    1.5135
    1.5901
    1.6603
    1.7251
    1.7852
    1.8414
    1.8940
    1.9436
    1.9905
    2.0350
    2.0773
    2.1176
    2.1561
    2.1930
    2.2284
    2.2624
    2.2952
    2.3268
    2.3573
    2.3867
    2.4153
    2.4429
    2.4697
    2.4958
    2.5211
    2.5458
    2.5699
    2.5934
    2.6164
    2.6388
    2.6608
    2.6823
    2.7033
    2.7239
    2.7441
    2.7639
    2.7833
    2.8023
    2.8210
    2.8393
    2.8573
    2.8750
    2.8924
    2.9095
    2.9262
    2.9428
    2.9590
    2.9750
    2.9907
    3.0062
    3.0214
    3.0365
    3.0513
    3.0659
    3.0802
    3.0944
    3.1084
    3.1221
    3.1357
    3.1491
    3.1567
    3.1624
    3.1754
    3.1883
    3.2010
    3.2136
    3.2260
    3.2383
    3.2504
    3.2623
    3.2742
    3.2858
    3.2974
    3.3088
    3.3201
    3.3312
    3.3423
    3.3532
    3.3640
    3.3747
    3.3852
    3.3957
    3.4061
    3.4163
    3.4264
    3.4365
    3.4464
    3.4563
    3.4660
    3.4757
    3.4852
    3.4947
    3.5041
    3.5134
    3.5226
    3.5317
    3.5407
    3.5496
    3.5584
    3.5672
    3.5758
    3.5843
    3.5928
    3.6011
    3.6094
    3.6175
    3.6256
    3.6336
    3.6416
    3.6494
    3.6572
    3.6649
    3.6726
    3.6802
    3.6876
    3.6951
    3.7024
    3.7097
    3.7170
    3.7242
    3.7313
    3.7383
    3.7454
    3.7523
    3.7592
    3.7660
    3.7728
    3.7795
    3.7862
    3.7928
    3.7994
    3.8059
    3.8124
    3.8188
    3.8252
    3.8316
    3.8378
    3.8441
    3.8503
    3.8565
    3.8626
    3.8687
    3.8747
    3.8807
    3.8867
    3.8926
    3.8986
    3.9044
    3.9103
    3.9161
    3.9218
    3.9276
    3.9333
    3.9390
    3.9446
    3.9502
    3.9558
    3.9613
    3.9668
    3.9723
    3.9778
    3.9832
    3.9886
    3.9940
    3.9993
    4.0046
    4.0099
    4.0152
    4.0204
    4.0256
    4.0308
    4.0359
    4.0410
    4.0461
    4.0512
    4.0562
    4.0613
    4.0663
    4.0712
    4.0762
    4.0811
    4.0860
    4.0909
    4.0957
    4.1005
    4.1053
    4.1101
    4.1149
    4.1196
    4.1243
    4.1290
    4.1337
    4.1383
    4.1429
    4.1475
    4.1521
    4.1567
    4.1612
    4.1657
    4.1702
    4.1747
    4.1792
    4.1836
    4.1880
    4.1924
    4.1968
    4.2012
    4.2055
    4.2098
    4.2141
    4.2184
    4.2227
    4.2269
    4.2312
    4.2354
    4.2396
    4.2438
    4.2479
    4.2521
    4.2562
    4.2603
    4.2644
    4.2685
    4.2725
    4.2766
    4.2806
    4.2846
    4.2886
    4.2926
    4.2965
    4.3005
    4.3044
    4.3083
    4.3122
    4.3161
    4.3200
    4.3239
    4.3277

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkbz_evf(varargin)
%% FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings
% This function follows the structure set up here:
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html
% ff_wkz_evf> but now we solve the second stage with percentage choice grid
%
% We solve along a vector of w_n vector, that is an interpolation vector,
% not a vector of actual w choices picked in the first stage. k' choices
% are in terms of percentages. Compared to ff_wkz_evf where we only had an
% upper triangle of choices, now we have a full matrix of percentage
% choices.
%
% @param mt_val matrix state_n I^2 by shock_n. This is the value
% matrix each row is a feasible reachable state given the choice
% vectors/matrix and each column is a shock state.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @return mt_ev_condi_z_max matrix choice_w_n by shock_n
% max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the
% optimal k' choice (w=k'+b') what is the expected utility? This is the
% value result from the 2nd stage problem. Note the result integrates over
% z'.
%
% @return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the
% argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k'
% choices, which index maximized conditional on z and w integrating over
% z'/
%
% @return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m ffs_ipwkbz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m ffs_ipwkbz_get_funcgrid>
%

%% Default

params_len = length(varargin);
bl_input_override = 0;
if (params_len == 5)
    bl_input_override = varargin{5};
end
if (bl_input_override)
    % override when called from outside
    [mt_val, param_map, support_map, armt_map, ~] = varargin{:};
else
    clear all;
    close all;
    
    % Not default parameters, but parameters that generate defaults
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);
    
    support_map('bl_graph_evf') = true;
    support_map('bl_display_evf') = true;
        
    param_map('it_ak_perc_n') = 250;
    param_map('fl_w_interp_grid_gap') = (param_map('fl_w_max')-param_map('fl_b_bd'))/param_map('it_ak_perc_n');    

    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generating Defaults
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z'});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {'f_util_standin', 'f_coh'});
    [f_util_standin, f_coh] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_coh = f_coh(ar_z, ar_a_meshk, ar_k_mesha);
       
end

%% Parse Parameters
params_group = values(armt_map, {'mt_z_trans', 'ar_z',...
    'ar_w_level', 'ar_k_mesha', 'ar_a_meshk', 'mt_k'});
[mt_z_trans, ar_z, ar_w_level, ...
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {'it_z_n', 'fl_nan_replace', 'fl_b_bd'});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {'bl_graph_onebyones','bl_display_evf', 'bl_graph_evf'});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {'bl_img_save', 'st_img_path', 'st_img_prefix', 'st_img_name_main', 'st_img_suffix'});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

% append function name
st_func_name = 'ff_ipwkbz_evf';
st_img_name_main = [st_func_name st_img_name_main];

%% Integrate *E(V(coh(k',b'), z')|z, w)*
% Each column for a different state z, each value *E(V(coh,z')|z)* integrated already
% Here, each column is a current z, more to right higher EV
% dim(mt_ev_condi_z): *Q by M*
% Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be
% what we do in the
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_functions.html
% ffs_ipwkbz_set_functions> code where we loop over current z, and for each
% current z, grab out a particular row from the mt_z_trans that corresponds
% to a current shock's transition into all future states.
%
% here, each column of mt_val corresponds to a state z, think of that as
% future state z. The input mt_val is *V(coh, z)*, we need to integrate to
% get *E(V(coh,z')|z)*.
%

mt_ev_condi_z = mt_val*mt_z_trans';
if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z: Q by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));
end

%% Reshape *E(V(coh,z'|z,w))* to allow for maxing
% dim(mt_ev_condi_z): *IxJ by M*

[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);

%% Maximize *max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))* optimal value and index
% Maximization, find optimal k'/b' combination given z and w=k'+b'

[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_full: J by IxM');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_full));
%     disp(head(array2table(mt_ev_condi_z_full), 20));
%     disp(tail(array2table(mt_ev_condi_z_full), 20));
        
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));
    

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
    
end

%% Reindex K' and B' Choices for each State at the Optimal *w'=k'+b'* choice
% The K' and B' Optimal Choices Associated with EV opti
% dim(mt_ev_condi_z_max_kp): *I by M*
ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));    
end

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_kp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));        
    
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_bp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));    
end

%% Graph

if (bl_graph_evf)
    
    %% Graph 1, V and EV
    if (~bl_graph_onebyones)
        figure('PaperPosition', [0 0 14 4]);
        hold on;
    end
    
    
    for subplot_j=1:1:2
        
        if (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (subplot_j==1)
            chart = plot(mt_val);
        end
        if (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        end
        
        clr = jet(numel(chart));
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legend(chart(legend2plot), legendCell(legend2plot), 'Location','southeast');
        
        if (subplot_j==1)
            title('V(coh,zp); w(k+b),k,z');
        end
        if (subplot_j==2)
            title('E_z(V(coh,zp|z))');
        end
        
        ylabel('Next Period Value');
        xlabel({'Index of Cash-on-Hand Discrete Point'...
            'Each Segment is a w=k+b; within segment increasing k'...
            'EV and V identical if shock is fully persistent'});
        grid on;
        grid minor;
    end
    
    % Share y axis
    if (~bl_graph_onebyones)
        linkaxes(hAxis,'y');
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_vev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 2, max(EV)
    
    if(~bl_graph_onebyones)
        figure('PaperPosition', [0 0 7 4]);
    end
    
    for sub_j=1:1:1
        
        if(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = 'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))';
        end
        
        if(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        hold on;
        
        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        for i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, ...
                'MarkerEdgeColor', clr(i_ctr,:), ...
                'MarkerFaceColor', clr(i_ctr,:));
        end
        
        grid on;
        grid minor;
        title(['2nd Stage Exp Value at Optimal K given W=K''+B'''])
        ylabel(st_y_label)
        xlabel({'Aggregate Savings'})
        
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legendCell{length(legendCell) + 1} = 'max-agg-save';
        legend(legendCell([ar_it_z_graph length(legendCell)]), 'Location','southeast');
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 3, at max(EV) optimal choice category, color regions, borrow save
    
    % Borrow Vs Save
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) > 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));
    
    figure('PaperPosition', [0 0 7 4]);
    % States: ar_w, ar_z
    % Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp
    hold on;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),...
        ar_z_mw(mt_it_borr_idx),...
        it_sca_size, 'blue', 'filled');
    %     legend([chart_br], {'Borrow'}, 'Location','northeast');
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        it_sca_size, 'black', 'filled');
    %     legend([chart_khalf], {'Save >0.5 K'}, 'Location','northeast');
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        it_sca_size, 'red', 'filled');
    %     legend([chart_sv], {'Save <0.5 K'}, 'Location','northeast');
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),...
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),...
        it_sca_size, 'yellow', 'filled');
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], ...
        {'Borrow','Save >0.5 K','Save <0.5 K', 'k=0 or k=nan'}, 'Location','northeast');
    title('Borrow and Save Regions')
    ylabel('Shocks')
    xlabel({'Total Savings w=k+b'})
    grid on;
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxbrsv' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 4, Optimal K' and B' Levels
    
    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    for sub_j=1:1:4
        
        if (bl_graph_onebyones)
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (sub_j==1)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j);
            end
            mt_y = mt_ev_condi_z_max_bp;
        end
        if (sub_j==2)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            end
            
            mt_y = mt_ev_condi_z_max_kp;
        end
        if (sub_j==3)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j-2);
            end
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        end
        if (sub_j==4)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            end
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        end
        
        hold on;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));
        
        if (length(ar_w_level) <= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
        end
        
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        grid on;
        if (sub_j<=2)
            hline = refline([1 0]);
            hline.Color = 'k';
            hline.LineStyle = ':';
            hline.HandleVisibility = 'off';
        end
        
        if (sub_j==1)
            title('B Choices of W');
            ylabel('B Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==2)
            title('K Choices of W');
            ylabel('K Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        
        if (sub_j==3)
            title('B Fraction of Borrow Max and Save');
            ylabel('B/bar(B) if br or B/W if sv');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==4)
            title('K Fraction Choices of Total K Possible');
            ylabel('K/(W-bar(b)) ');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northeast');
        end
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_wkbopti' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
end

end

##### SOURCE END #####
--></body></html>