
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-06"><meta name="DC.source" content="ff_ipwkbz_evf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters</a></li><li><a href="#5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></a></li><li><a href="#6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</a></li><li><a href="#7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</a></li><li><a href="#8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</a></li><li><a href="#9">Graph</a></li><li><a href="#11">Graph 1, V and EV</a></li><li><a href="#12">Graph 2, max(EV)</a></li><li><a href="#13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</a></li><li><a href="#14">Graph 4, Optimal K' and B' Levels</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkbz_evf(varargin)
</pre><h2 id="2">FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings</h2><p>This function follows the structure set up here: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html">ff_wkz_evf</a> but now we solve the second stage with percentage choice grid</p><p>We solve along a vector of w_n vector, that is an interpolation vector, not a vector of actual w choices picked in the first stage. k' choices are in terms of percentages. Compared to ff_wkz_evf where we only had an upper triangle of choices, now we have a full matrix of percentage choices.</p><p>@param mt_val matrix state_n I^2 by shock_n. This is the value matrix each row is a feasible reachable state given the choice vectors/matrix and each column is a shock state.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@return mt_ev_condi_z_max matrix choice_w_n by shock_n max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the optimal k' choice (w=k'+b') what is the expected utility? This is the value result from the 2nd stage problem. Note the result integrates over z'.</p><p>@return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k' choices, which index maximized conditional on z and w integrating over z'/</p><p>@return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m">ffs_ipwkbz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m">ffs_ipwkbz_get_funcgrid</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 5)
    bl_input_override = varargin{5};
<span class="keyword">end</span>
<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% override when called from outside</span>
    [mt_val, param_map, support_map, armt_map, ~] = varargin{:};
<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% Not default parameters, but parameters that generate defaults</span>
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

    support_map(<span class="string">'bl_graph_evf'</span>) = true;
    support_map(<span class="string">'bl_display_evf'</span>) = true;

    param_map(<span class="string">'it_ak_perc_n'</span>) = 250;
    param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = (param_map(<span class="string">'fl_w_max'</span>)-param_map(<span class="string">'fl_b_bd'</span>))/param_map(<span class="string">'it_ak_perc_n'</span>);

    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generating Defaults</span>
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {<span class="string">'f_util_standin'</span>, <span class="string">'f_coh'</span>});
    [f_util_standin, f_coh] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_coh = f_coh(ar_z, ar_a_meshk, ar_k_mesha);

<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameters</h2><pre class="codeinput">params_group = values(armt_map, {<span class="string">'mt_z_trans'</span>, <span class="string">'ar_z'</span>,<span class="keyword">...</span>
    <span class="string">'ar_w_level'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_a_meshk'</span>, <span class="string">'mt_k'</span>});
[mt_z_trans, ar_z, ar_w_level, <span class="keyword">...</span>
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph_onebyones'</span>,<span class="string">'bl_display_evf'</span>, <span class="string">'bl_graph_evf'</span>});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_img_save'</span>, <span class="string">'st_img_path'</span>, <span class="string">'st_img_prefix'</span>, <span class="string">'st_img_name_main'</span>, <span class="string">'st_img_suffix'</span>});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkbz_evf'</span>;
st_img_name_main = [st_func_name st_img_name_main];
</pre><h2 id="5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></h2><p>Each column for a different state z, each value <b>E(V(coh,z')|z)</b> integrated already Here, each column is a current z, more to right higher EV dim(mt_ev_condi_z): <b>Q by M</b> Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be what we do in the <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_functions.html">ffs_ipwkbz_set_functions</a> code where we loop over current z, and for each current z, grab out a particular row from the mt_z_trans that corresponds to a current shock's transition into all future states.</p><p>here, each column of mt_val corresponds to a state z, think of that as future state z. The input mt_val is <b>V(coh, z)</b>, we need to integrate to get <b>E(V(coh,z')|z)</b>.</p><pre class="codeinput">mt_ev_condi_z = mt_val*mt_z_trans';
<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z: Q by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z: Q by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
       62250          15

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    
       -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078           -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078            -6.9078    

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

        4.2006            4.2039            4.2078            4.2121             4.217            4.2225            4.2285            4.2353            4.2428            4.2512             4.2605             4.2708             4.2821             4.2942             4.3064     
        4.2002            4.2035            4.2073            4.2117            4.2166            4.2221            4.2282            4.2349            4.2425            4.2509             4.2602             4.2705             4.2818             4.2939             4.3061     
        4.1998             4.203            4.2069            4.2113            4.2162            4.2217            4.2278            4.2346            4.2421            4.2505             4.2599             4.2702             4.2815             4.2937             4.3059     
        4.1993            4.2026            4.2065            4.2109            4.2158            4.2213            4.2274            4.2342            4.2418            4.2502             4.2595             4.2699             4.2813             4.2934             4.3056     
        4.1989            4.2022            4.2061            4.2105            4.2154            4.2209             4.227            4.2338            4.2414            4.2498             4.2592             4.2696              4.281             4.2932             4.3054     
        4.1984            4.2018            4.2056              4.21             4.215            4.2205            4.2266            4.2335            4.2411            4.2495             4.2589             4.2693             4.2807             4.2929             4.3052     
         4.198            4.2013            4.2052            4.2096            4.2146            4.2201            4.2262            4.2331            4.2407            4.2492             4.2586              4.269             4.2804             4.2926             4.3049     
        4.1976            4.2009            4.2048            4.2092            4.2142            4.2197            4.2259            4.2327            4.2403            4.2488             4.2582             4.2687             4.2801             4.2924             4.3047     
        4.1971            4.2005            4.2044            4.2088            4.2138            4.2193            4.2255            4.2323              4.24            4.2485             4.2579             4.2684             4.2798             4.2921             4.3044     
        4.1967               4.2            4.2039            4.2084            4.2134            4.2189            4.2251             4.232            4.2396            4.2481             4.2576             4.2681             4.2796             4.2918             4.3042     
        4.1962            4.1996            4.2035             4.208            4.2129            4.2185            4.2247            4.2316            4.2393            4.2478             4.2573             4.2678             4.2793             4.2916              4.304     
        4.1958            4.1992            4.2031            4.2075            4.2125            4.2181            4.2243            4.2312            4.2389            4.2475             4.2569             4.2674              4.279             4.2913             4.3037     
        4.1954            4.1987            4.2027            4.2071            4.2121            4.2177            4.2239            4.2308            4.2385            4.2471             4.2566             4.2671             4.2787              4.291             4.3035     
        4.1949            4.1983            4.2022            4.2067            4.2117            4.2173            4.2235            4.2305            4.2382            4.2468             4.2563             4.2668             4.2784             4.2908             4.3032     
        4.1945            4.1978            4.2018            4.2063            4.2113            4.2169            4.2231            4.2301            4.2378            4.2464              4.256             4.2665             4.2781             4.2905              4.303     
         4.194            4.1974            4.2014            4.2059            4.2109            4.2165            4.2228            4.2297            4.2375            4.2461             4.2556             4.2662             4.2778             4.2902             4.3027     
        4.1936             4.197            4.2009            4.2054            4.2105            4.2161            4.2224            4.2293            4.2371            4.2457             4.2553             4.2659             4.2775               4.29             4.3025     
        4.1931            4.1965            4.2005             4.205            4.2101            4.2157             4.222             4.229            4.2367            4.2454              4.255             4.2656             4.2772             4.2897             4.3022     
        4.1927            4.1961            4.2001            4.2046            4.2097            4.2153            4.2216            4.2286            4.2364             4.245             4.2546             4.2653              4.277             4.2894              4.302     
        4.1923            4.1957            4.1997            4.2042            4.2093            4.2149            4.2212            4.2282             4.236            4.2447             4.2543              4.265             4.2767             4.2892             4.3017     

</pre><h2 id="6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</h2><p>dim(mt_ev_condi_z): <b>IxJ by M</b></p><pre class="codeinput">[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);
</pre><h2 id="7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</h2><p>Maximization, find optimal k'/b' combination given z and w=k'+b'</p><pre class="codeinput">[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_full: J by IxM'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_full));
<span class="comment">%     disp(head(array2table(mt_ev_condi_z_full), 20));</span>
<span class="comment">%     disp(tail(array2table(mt_ev_condi_z_full), 20));</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));


    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_full: J by IxM
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
         250        3735

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

          -6.9078               -6.9078               -6.9078               -6.9078               -6.9078               -6.9078               -6.9078               -6.9078               -6.9078               -6.9078                -6.9078                 -6.9078               -6.9078                -6.9078                -6.9078      
          -1.2797               -1.1781               -1.0688              -0.95673              -0.84385              -0.73071              -0.61744              -0.50405              -0.39057              -0.27701               -0.16338               -0.049812              0.063142                0.17348                0.27624      
            -0.48              -0.41927              -0.35169              -0.27975              -0.20451              -0.12635             -0.045453              0.038062               0.12406                0.2124                0.30293                 0.39541                0.4892                0.58239                0.67036      
        -0.066129             -0.019076              0.033919              0.091109               0.15177               0.21569               0.28277               0.35295               0.42616               0.50229                0.58123                 0.66277               0.74632                0.83007                0.90973      
          0.21677               0.25638               0.30129               0.35013               0.40237               0.45786               0.51658               0.57853               0.64366               0.71194                0.78328                  0.8575               0.93408                 1.0113                 1.0852      
          0.43262               0.46737               0.50695               0.55022               0.59675               0.64646               0.69937                0.7555               0.81487               0.87745                 0.9432                   1.012                1.0833                 1.1556                  1.225      
          0.60759               0.63877               0.67449               0.71368               0.75601               0.80141               0.84995               0.90167               0.95661                1.0148                 1.0762                  1.1406                1.2078                 1.2761                 1.3418      
          0.75597               0.78335               0.81605                0.8521               0.89115               0.93318               0.97827                1.0265                1.0779                1.1325                 1.1903                  1.2512                1.3149                 1.3799                 1.4426      
          0.88511               0.90926               0.93873               0.97226                1.0087                 1.048                1.0902                1.1355                 1.184                1.2356                 1.2904                  1.3484                1.4092                 1.4713                 1.5314      
          0.99945                1.0211                1.0475                1.0785                1.1127                1.1497                1.1896                1.2325                1.2785                1.3275                 1.3798                  1.4352                1.4934                 1.5531                 1.6109      
            1.102                1.1216                1.1455                1.1738                1.2061                1.2412                1.2791                1.3198                1.3637                1.4106                 1.4606                  1.5138                1.5697                 1.6272                  1.683      
            1.195                1.2129                1.2348                1.2608                1.2909                1.3243                1.3604                1.3994                1.4413                1.4863                 1.5344                  1.5855                1.6395                 1.6951                 1.7491      
           1.2801                1.2966                1.3168                1.3407                1.3686                1.4005                 1.435                1.4724                1.5127                1.5559                 1.6023                  1.6517                1.7039                 1.7577                   1.81      
           1.3586                1.3738                1.3925                1.4147                1.4407                1.4708                 1.504                  1.54                1.5787                1.6205                 1.6652                   1.713                1.7636                 1.8158                 1.8667      
           1.4313                1.4454                1.4629                1.4836                1.5079                1.5362                1.5682                1.6028                1.6402                1.6806                 1.7239                  1.7703                1.8194                 1.8701                 1.9196      
            1.499                1.5123                1.5286                1.5481                1.5709                1.5975                1.6281                1.6616                1.6978                1.7369                 1.7789                  1.8239                1.8717                 1.9211                 1.9693      
           1.5625                1.5749                1.5903                1.6086                1.6301                1.6552                1.6844                1.7168                1.7519                1.7898                 1.8306                  1.8744                1.9209                 1.9691                 2.0162      
           1.6222                1.6339                1.6484                1.6657                1.6861                1.7098                1.7374                1.7688                1.8029                1.8398                 1.8795                  1.9222                1.9675                 2.0145                 2.0606      
           1.6785                1.6896                1.7033                1.7197                 1.739                1.7616                1.7878                1.8181                1.8513                1.8871                 1.9259                  1.9674                2.0117                 2.0577                 2.1027      
           1.7318                1.7423                1.7554                 1.771                1.7893                1.8108                1.8358                1.8649                1.8971                1.9321                 1.9699                  2.0105                2.0538                 2.0987                 2.1428      

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

          4.1976                4.1986                4.1998                4.2012                4.2029                 4.205                4.2074                4.2104                4.2139                 4.218                  4.223                 4.2289                 4.2358                 4.2436                 4.2521       
           4.202                4.2029                4.2041                4.2055                4.2073                4.2093                4.2118                4.2147                4.2182                4.2223                 4.2272                 4.2331                 4.2399                 4.2478                 4.2562       
          4.2063                4.2072                4.2084                4.2099                4.2116                4.2136                4.2161                 4.219                4.2224                4.2266                 4.2315                 4.2373                 4.2441                 4.2519                 4.2603       
          4.2106                4.2116                4.2127                4.2142                4.2159                4.2179                4.2203                4.2232                4.2267                4.2308                 4.2357                 4.2415                 4.2483                 4.2561                 4.2644       
          4.2149                4.2159                 4.217                4.2184                4.2201                4.2222                4.2246                4.2275                4.2309                 4.235                 4.2399                 4.2456                 4.2524                 4.2602                 4.2685       
          4.2192                4.2201                4.2213                4.2227                4.2244                4.2264                4.2288                4.2317                4.2351                4.2392                 4.2441                 4.2498                 4.2566                 4.2643                 4.2725       
          4.2235                4.2244                4.2256                 4.227                4.2287                4.2307                4.2331                4.2359                4.2393                4.2434                 4.2482                 4.2539                 4.2607                 4.2683                 4.2766       
          4.2277                4.2286                4.2298                4.2312                4.2329                4.2349                4.2373                4.2401                4.2435                4.2475                 4.2524                 4.2581                 4.2648                 4.2724                 4.2806       
          4.2319                4.2329                 4.234                4.2354                4.2371                4.2391                4.2415                4.2443                4.2477                4.2517                 4.2565                 4.2622                 4.2688                 4.2764                 4.2846       
          4.2362                4.2371                4.2382                4.2396                4.2413                4.2433                4.2456                4.2485                4.2518                4.2558                 4.2606                 4.2662                 4.2729                 4.2805                 4.2886       
          4.2403                4.2413                4.2424                4.2438                4.2454                4.2474                4.2498                4.2526                4.2559                4.2599                 4.2647                 4.2703                 4.2769                 4.2845                 4.2926       
          4.2445                4.2454                4.2466                4.2479                4.2496                4.2516                4.2539                4.2567                4.2601                 4.264                 4.2688                 4.2744                  4.281                 4.2885                 4.2965       
          4.2487                4.2496                4.2507                4.2521                4.2537                4.2557                 4.258                4.2608                4.2641                4.2681                 4.2728                 4.2784                  4.285                 4.2925                 4.3005       
          4.2528                4.2537                4.2548                4.2562                4.2579                4.2598                4.2621                4.2649                4.2682                4.2722                 4.2769                 4.2824                  4.289                 4.2964                 4.3044       
          4.2569                4.2578                 4.259                4.2603                 4.262                4.2639                4.2662                 4.269                4.2723                4.2762                 4.2809                 4.2864                 4.2929                 4.3004                 4.3083       
           4.261                4.2619                4.2631                4.2644                 4.266                 4.268                4.2703                 4.273                4.2763                4.2802                 4.2849                 4.2904                 4.2969                 4.3043                 4.3122       
          4.2651                 4.266                4.2671                4.2685                4.2701                 4.272                4.2743                4.2771                4.2804                4.2843                 4.2889                 4.2944                 4.3008                 4.3082                 4.3161       
          4.2692                4.2701                4.2712                4.2726                4.2742                4.2761                4.2784                4.2811                4.2844                4.2882                 4.2929                 4.2983                 4.3048                 4.3121                   4.32       
          4.2733                4.2741                4.2753                4.2766                4.2782                4.2801                4.2824                4.2851                4.2884                4.2922                 4.2968                 4.3023                 4.3087                  4.316                 4.3239       
          4.2773                4.2782                4.2793                4.2806                4.2822                4.2841                4.2864                4.2891                4.2923                4.2962                 4.3008                 4.3062                 4.3126                 4.3199                 4.3277       

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

               1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1                          1          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             238                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             204                       240                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             179                       210                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             159                       187                       222                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             144                       169                       201                       239                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             131                       154                       183                       217                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             120                       141                       168                       200                       238                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             111                       130                       155                       185                       220                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             103                       121                       144                       172                       204                       244                       250                       250                       250                        250                        250                        250                        250                        250                        250          
              96                       113                       135                       160                       191                       228                       250                       250                       250                        250                        250                        250                        250                        250                        250          
              90                       106                       126                       150                       179                       214                       250                       250                       250                        250                        250                        250                        250                        250                        250          
              85                       100                       119                       142                       169                       201                       240                       250                       250                        250                        250                        250                        250                        250                        250          
              80                        95                       112                       134                       160                       190                       227                       250                       250                        250                        250                        250                        250                        250                        250          
              76                        90                       107                       127                       151                       181                       215                       250                       250                        250                        250                        250                        250                        250                        250          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

              8                         9                         11                        13                        15                        18                        22                        26                        31                        36                         43                         52                         61                         73                         85           
              8                         9                         11                        13                        15                        18                        22                        26                        30                        36                         43                         51                         61                         72                         85           
              8                         9                         11                        13                        15                        18                        21                        26                        30                        36                         43                         51                         61                         72                         84           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         43                         51                         61                         72                         84           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         43                         51                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        36                         42                         51                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         60                         71                         83           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         60                         71                         82           
              8                         9                         11                        13                        15                        18                        21                        25                        30                        35                         42                         50                         59                         70                         82           
              8                         9                         11                        13                        15                        18                        21                        25                        29                        35                         42                         50                         59                         70                         82           
              8                         9                         11                        12                        15                        17                        21                        25                        29                        35                         42                         50                         59                         70                         81           
              8                         9                         11                        12                        15                        17                        21                        25                        29                        35                         41                         49                         59                         69                         81           
              8                         9                         10                        12                        15                        17                        21                        24                        29                        35                         41                         49                         58                         69                         81           
              8                         9                         10                        12                        15                        17                        21                        24                        29                        34                         41                         49                         58                         69                         80           
              8                         9                         10                        12                        15                        17                        20                        24                        29                        34                         41                         49                         58                         69                         80           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         41                         49                         58                         68                         80           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         41                         48                         57                         68                         79           
              8                         9                         10                        12                        14                        17                        20                        24                        29                        34                         40                         48                         57                         68                         79           
              8                         9                         10                        12                        14                        17                        20                        24                        28                        34                         40                         48                         57                         67                         79           
              7                         9                         10                        12                        14                        17                        20                        24                        28                        34                         40                         48                         57                         67                         78           

</pre><h2 id="8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</h2><p>The K' and B' Optimal Choices Associated with EV opti dim(mt_ev_condi_z_max_kp): <b>I by M</b></p><pre class="codeinput">ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
<span class="keyword">end</span>

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_kp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_bp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

                1                         1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1          
              500                       500                       500                       500                       500                       500                       500                       500                       500                       500                        500                        500                        500                        500                        500          
              750                       750                       750                       750                       750                       750                       750                       750                       750                       750                        750                        750                        750                        750                        750          
             1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                       1000                       1000                       1000                       1000                       1000          
             1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                       1250                       1250                       1250                       1250                       1250          
             1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                       1500                       1500                       1500                       1500                       1500          
             1738                      1750                      1750                      1750                      1750                      1750                      1750                      1750                      1750                      1750                       1750                       1750                       1750                       1750                       1750          
             1954                      1990                      2000                      2000                      2000                      2000                      2000                      2000                      2000                      2000                       2000                       2000                       2000                       2000                       2000          
             2179                      2210                      2250                      2250                      2250                      2250                      2250                      2250                      2250                      2250                       2250                       2250                       2250                       2250                       2250          
             2409                      2437                      2472                      2500                      2500                      2500                      2500                      2500                      2500                      2500                       2500                       2500                       2500                       2500                       2500          
             2644                      2669                      2701                      2739                      2750                      2750                      2750                      2750                      2750                      2750                       2750                       2750                       2750                       2750                       2750          
             2881                      2904                      2933                      2967                      3000                      3000                      3000                      3000                      3000                      3000                       3000                       3000                       3000                       3000                       3000          
             3120                      3141                      3168                      3200                      3238                      3250                      3250                      3250                      3250                      3250                       3250                       3250                       3250                       3250                       3250          
             3361                      3380                      3405                      3435                      3470                      3500                      3500                      3500                      3500                      3500                       3500                       3500                       3500                       3500                       3500          
             3603                      3621                      3644                      3672                      3704                      3744                      3750                      3750                      3750                      3750                       3750                       3750                       3750                       3750                       3750          
             3846                      3863                      3885                      3910                      3941                      3978                      4000                      4000                      4000                      4000                       4000                       4000                       4000                       4000                       4000          
             4090                      4106                      4126                      4150                      4179                      4214                      4250                      4250                      4250                      4250                       4250                       4250                       4250                       4250                       4250          
             4335                      4350                      4369                      4392                      4419                      4451                      4490                      4500                      4500                      4500                       4500                       4500                       4500                       4500                       4500          
             4580                      4595                      4612                      4634                      4660                      4690                      4727                      4750                      4750                      4750                       4750                       4750                       4750                       4750                       4750          
             4826                      4840                      4857                      4877                      4901                      4931                      4965                      5000                      5000                      5000                       5000                       5000                       5000                       5000                       5000          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

            57258                     57259                     57261                     57263                     57265                     57268                     57272                     57276                     57281                      57286                      57293                      57302                      57311                      57323                      57335         
            57508                     57509                     57511                     57513                     57515                     57518                     57522                     57526                     57530                      57536                      57543                      57551                      57561                      57572                      57585         
            57758                     57759                     57761                     57763                     57765                     57768                     57771                     57776                     57780                      57786                      57793                      57801                      57811                      57822                      57834         
            58008                     58009                     58011                     58013                     58015                     58018                     58021                     58025                     58030                      58036                      58043                      58051                      58061                      58072                      58084         
            58258                     58259                     58261                     58263                     58265                     58268                     58271                     58275                     58280                      58286                      58293                      58301                      58310                      58321                      58333         
            58508                     58509                     58511                     58513                     58515                     58518                     58521                     58525                     58530                      58536                      58542                      58551                      58560                      58571                      58583         
            58758                     58759                     58761                     58763                     58765                     58768                     58771                     58775                     58780                      58785                      58792                      58800                      58810                      58821                      58833         
            59008                     59009                     59011                     59013                     59015                     59018                     59021                     59025                     59030                      59035                      59042                      59050                      59060                      59071                      59082         
            59258                     59259                     59261                     59263                     59265                     59268                     59271                     59275                     59280                      59285                      59292                      59300                      59309                      59320                      59332         
            59508                     59509                     59511                     59513                     59515                     59518                     59521                     59525                     59529                      59535                      59542                      59550                      59559                      59570                      59582         
            59758                     59759                     59761                     59762                     59765                     59767                     59771                     59775                     59779                      59785                      59792                      59800                      59809                      59820                      59831         
            60008                     60009                     60011                     60012                     60015                     60017                     60021                     60025                     60029                      60035                      60041                      60049                      60059                      60069                      60081         
            60258                     60259                     60260                     60262                     60265                     60267                     60271                     60274                     60279                      60285                      60291                      60299                      60308                      60319                      60331         
            60508                     60509                     60510                     60512                     60515                     60517                     60521                     60524                     60529                      60534                      60541                      60549                      60558                      60569                      60580         
            60758                     60759                     60760                     60762                     60765                     60767                     60770                     60774                     60779                      60784                      60791                      60799                      60808                      60819                      60830         
            61008                     61009                     61010                     61012                     61014                     61017                     61020                     61024                     61029                      61034                      61041                      61049                      61058                      61068                      61080         
            61258                     61259                     61260                     61262                     61264                     61267                     61270                     61274                     61279                      61284                      61291                      61298                      61307                      61318                      61329         
            61508                     61509                     61510                     61512                     61514                     61517                     61520                     61524                     61529                      61534                      61540                      61548                      61557                      61568                      61579         
            61758                     61759                     61760                     61762                     61764                     61767                     61770                     61774                     61778                      61784                      61790                      61798                      61807                      61817                      61829         
            62007                     62009                     62010                     62012                     62014                     62017                     62020                     62024                     62028                      62034                      62040                      62048                      62057                      62067                      62078         

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_kp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

                 0                        0                        0                        0                        0                        0                        0                        0                        0                        0                         0                         0                         0                         0                         0        
           0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                  0.28312                   0.28312                   0.28312                   0.28312                   0.28312                   0.28312        
           0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                  0.56623                   0.56623                   0.56623                   0.56623                   0.56623                   0.56623        
           0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                  0.84935                   0.84935                   0.84935                   0.84935                   0.84935                   0.84935        
            1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                   1.1325                    1.1325                    1.1325                    1.1325                    1.1325                    1.1325        
            1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                   1.4156                    1.4156                    1.4156                    1.4156                    1.4156                    1.4156        
            1.6169                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                   1.6987                    1.6987                    1.6987                    1.6987                    1.6987                    1.6987        
            1.6161                   1.9023                   1.9818                   1.9818                   1.9818                   1.9818                   1.9818                   1.9818                   1.9818                   1.9818                    1.9818                    1.9818                    1.9818                    1.9818                    1.9818        
            1.6198                   1.9015                   2.2649                   2.2649                   2.2649                   2.2649                   2.2649                   2.2649                   2.2649                   2.2649                    2.2649                    2.2649                    2.2649                    2.2649                    2.2649        
            1.6178                    1.904                   2.2618                   2.5481                   2.5481                   2.5481                   2.5481                   2.5481                   2.5481                   2.5481                    2.5481                    2.5481                    2.5481                    2.5481                    2.5481        
            1.6271                   1.9111                   2.2746                   2.7062                   2.8312                   2.8312                   2.8312                   2.8312                   2.8312                   2.8312                    2.8312                    2.8312                    2.8312                    2.8312                    2.8312        
            1.6274                   1.9148                   2.2771                    2.702                   3.1143                   3.1143                   3.1143                   3.1143                   3.1143                   3.1143                    3.1143                    3.1143                    3.1143                    3.1143                    3.1143        
            1.6254                   1.9117                   2.2797                   2.7159                   3.2338                   3.3974                   3.3974                   3.3974                   3.3974                   3.3974                    3.3974                    3.3974                    3.3974                    3.3974                    3.3974        
             1.628                   1.9086                   2.2777                   2.7207                   3.2375                   3.6805                   3.6805                   3.6805                   3.6805                   3.6805                    3.6805                    3.6805                    3.6805                    3.6805                    3.6805        
             1.626                   1.9122                    2.278                   2.7233                   3.2321                   3.8682                   3.9636                   3.9636                   3.9636                   3.9636                    3.9636                    3.9636                    3.9636                    3.9636                    3.9636        
            1.6229                   1.9125                   2.2874                   2.7133                   3.2415                   3.8719                   4.2468                   4.2468                   4.2468                   4.2468                    4.2468                    4.2468                    4.2468                    4.2468                    4.2468        
             1.622                   1.9128                   2.2763                   2.7125                   3.2395                   3.8756                   4.5299                   4.5299                   4.5299                   4.5299                    4.5299                    4.5299                    4.5299                    4.5299                    4.5299        
            1.6269                   1.9165                   2.2834                   2.7275                   3.2489                   3.8668                   4.6199                    4.813                    4.813                    4.813                     4.813                     4.813                     4.813                     4.813                     4.813        
            1.6203                    1.927                   2.2746                   2.7244                    3.256                   3.8694                   4.6259                   5.0961                   5.0961                   5.0961                    5.0961                    5.0961                    5.0961                    5.0961                    5.0961        
             1.624                   1.9262                    2.293                   2.7247                   3.2426                   3.8901                   4.6239                   5.3792                   5.3792                   5.3792                    5.3792                    5.3792                    5.3792                    5.3792                    5.3792        

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           1.8775                   2.1365                   2.6544                   3.1724                   3.6903                   4.4673                   5.5032                   6.5391                    7.834                    9.1289                    10.942                    13.273                    15.603                    18.711                    21.819        
           1.8857                   2.1458                   2.6661                   3.1863                   3.7065                   4.4869                   5.5273                   6.5678                   7.6083                     9.169                     10.99                    13.071                    15.672                    18.533                    21.915        
           1.8939                   2.1552                   2.6777                   3.2002                   3.7227                   4.5065                   5.2902                   6.5965                   7.6415                     9.209                    11.038                    13.128                     15.74                    18.614                    21.749        
           1.9022                   2.1646                   2.6893                   3.2141                   3.7389                   4.5261                   5.3132                   6.3628                   7.6747                    9.2491                    11.086                    13.185                    15.809                    18.695                    21.844        
           1.9104                   2.1739                    2.701                    3.228                   3.7551                   4.5457                   5.3362                   6.3903                   7.7079                    9.2891                    11.134                    13.242                    15.614                    18.512                    21.675        
           1.9187                   2.1833                   2.7126                    3.242                   3.7713                   4.5653                   5.3592                   6.4179                   7.7412                    9.3291                    10.917                    13.299                    15.681                    18.592                    21.768        
           1.9269                   2.1927                   2.7243                   3.2559                   3.7875                   4.5848                   5.3822                   6.4454                   7.7744                    9.1034                    10.964                     13.09                    15.748                    18.672                    21.862        
           1.9351                   2.2021                   2.7359                   3.2698                   3.8036                   4.6044                   5.4052                    6.473                   7.8076                    9.1423                    11.011                    13.146                    15.816                    18.752                    21.688        
           1.9434                   2.2114                   2.7476                   3.2837                   3.8198                    4.624                   5.4282                   6.5005                   7.8408                    9.1812                    11.058                    13.202                    15.615                    18.564                     21.78        
           1.9516                   2.2208                   2.7592                   3.2976                    3.836                   4.6436                   5.4512                    6.528                   7.6049                    9.2201                    11.105                    13.258                    15.681                    18.642                    21.873        
           1.9598                   2.2302                   2.7708                   3.0412                   3.8522                   4.3929                   5.4742                   6.5556                    7.637                     9.259                    11.151                    13.314                    15.747                    18.721                    21.695        
           1.9681                   2.2395                   2.7825                    3.054                   3.8684                   4.4113                   5.4972                   6.5831                    7.669                    9.2979                    10.927                    13.099                    15.813                    18.528                    21.786        
           1.9763                   2.2489                   2.5215                   3.0667                   3.8846                   4.4298                   5.5202                   6.3381                   7.7011                    9.3368                    10.972                    13.153                    15.607                    18.606                    21.877        
           1.9845                   2.2583                    2.532                   3.0795                   3.9008                   4.4483                   5.5432                   6.3645                   7.7332                    9.1019                    11.018                    13.208                    15.672                    18.683                    21.694        
           1.9928                   2.2676                   2.5425                   3.0923                   3.9169                   4.4667                   5.2914                   6.3909                   7.7653                    9.1397                    11.064                    13.263                    15.737                    18.761                    21.784        
            2.001                    2.277                    2.553                   3.1051                   3.6571                   4.4852                   5.3132                   6.4173                   7.7974                    9.1775                     11.11                    13.318                    15.802                    18.562                    21.874        
           2.0092                   2.2864                   2.5635                   3.1179                   3.6722                   4.5036                   5.3351                   6.4437                   7.8295                    9.2153                    11.155                    13.095                     15.59                    18.639                    21.687        
           2.0175                   2.2958                    2.574                   3.1306                   3.6872                   4.5221                    5.357                   6.4701                   7.8616                     9.253                    10.923                    13.149                    15.654                    18.715                    21.776        
           2.0257                   2.3051                   2.5846                   3.1434                   3.7023                   4.5405                   5.3788                   6.4965                   7.6142                    9.2908                    10.967                    13.203                    15.718                    18.512                    21.865        
           1.7534                   2.3145                   2.5951                   3.1562                   3.7173                    4.559                   5.4007                   6.5229                   7.6452                    9.3286                    11.012                    13.256                    15.781                    18.587                    21.673        

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_bp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   249    15

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

               -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                       -20                       -20                       -20                       -20                       -20        
               -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                      -20                       -20                       -20                       -20                       -20                       -20        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                  -19.999                   -19.999                   -19.999                   -19.999                   -19.999                   -19.999        
           -19.917                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
           -19.632                  -19.919                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
           -19.353                  -19.634                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                  -19.998                   -19.998                   -19.998                   -19.998                   -19.998                   -19.998        
           -19.067                  -19.353                  -19.711                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -18.793                  -19.077                  -19.441                  -19.872                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
            -18.51                  -18.797                   -19.16                  -19.585                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -18.225                  -18.511                  -18.879                  -19.315                  -19.833                  -19.997                  -19.997                  -19.997                  -19.997                  -19.997                   -19.997                   -19.997                   -19.997                   -19.997                   -19.997        
           -17.944                  -18.224                  -18.594                  -19.036                  -19.553                  -19.996                  -19.996                  -19.996                  -19.996                  -19.996                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -17.658                  -17.945                   -18.31                  -18.756                  -19.265                  -19.901                  -19.996                  -19.996                  -19.996                  -19.996                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -17.372                  -17.662                  -18.036                  -18.462                   -18.99                  -19.621                  -19.996                  -19.996                  -19.996                  -19.996                   -19.996                   -19.996                   -19.996                   -19.996                   -19.996        
           -17.088                  -17.378                  -17.742                  -18.178                  -18.705                  -19.341                  -19.995                  -19.995                  -19.995                  -19.995                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        
           -16.809                  -17.099                  -17.466                   -17.91                  -18.431                  -19.049                  -19.802                  -19.995                  -19.995                  -19.995                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        
           -16.519                  -16.826                  -17.173                  -17.623                  -18.155                  -18.768                  -19.525                  -19.995                  -19.995                  -19.995                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        
           -16.239                  -16.542                  -16.908                   -17.34                  -17.858                  -18.505                  -19.239                  -19.995                  -19.995                  -19.995                   -19.995                   -19.995                   -19.995                   -19.995                   -19.995        

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           42.738                   42.479                   41.961                   41.443                   40.925                   40.148                   39.112                   38.076                   36.781                    35.486                    33.674                    31.343                    29.012                    25.904                    22.796        
           43.013                   42.753                   42.233                   41.712                   41.192                   40.412                   39.371                   38.331                   37.291                     35.73                    33.909                    31.828                    29.227                    26.366                    22.984        
           43.288                   43.027                   42.504                   41.982                   41.459                   40.676                   39.892                   38.586                   37.541                    35.973                    34.144                    32.054                    29.442                    26.568                    23.433        
           43.563                   43.301                   42.776                   42.251                   41.727                    40.94                   40.152                   39.103                   37.791                    36.217                     34.38                    32.281                    29.657                    26.771                    23.622        
           43.839                   43.575                   43.048                   42.521                   41.994                   41.203                   40.413                   39.359                   38.041                     36.46                    34.615                    32.507                    30.135                    27.237                    24.074        
           44.114                   43.849                    43.32                    42.79                   42.261                   41.467                   40.673                   39.615                   38.291                    36.703                    35.115                    32.733                    30.351                     27.44                    24.264        
           44.389                   44.123                   43.592                    43.06                   42.528                   41.731                   40.934                    39.87                   38.541                    37.212                    35.352                    33.225                    30.568                    27.644                    24.454        
           44.664                   44.397                   43.863                   43.329                   42.796                   41.995                   41.194                   40.126                   38.792                    37.457                    35.588                    33.453                    30.784                    27.847                    24.911        
           44.939                   44.671                   44.135                   43.599                   43.063                   42.259                   41.454                   40.382                   39.042                    37.701                    35.825                     33.68                    31.268                    28.319                    25.102        
           45.214                   44.945                   44.407                   43.868                    43.33                   42.522                   41.715                   40.638                   39.561                    37.946                    36.061                    33.908                    31.485                    28.524                    25.293        
            45.49                   45.219                   44.679                   44.408                   43.597                   43.057                   41.975                   40.894                   39.812                     38.19                    36.298                    34.135                    31.702                    28.729                    25.755        
           45.765                   45.493                    44.95                   44.679                   43.864                   43.321                   42.236                    41.15                   40.064                    38.435                    36.806                    34.634                    31.919                    29.205                    25.947        
            46.04                   45.767                   45.495                   44.949                   44.132                   43.586                   42.496                   41.678                   40.315                    38.679                    37.044                    34.863                    32.409                    29.411                    26.139        
           46.315                   46.041                   45.768                    45.22                   44.399                   43.851                   42.756                   41.935                   40.566                    39.198                    37.281                    35.091                    32.628                    29.617                    26.605        
            46.59                   46.315                    46.04                   45.491                   44.666                   44.116                   43.292                   42.192                   40.818                    39.443                    37.519                     35.32                    32.846                    29.822                    26.799        
           46.865                   46.589                   46.313                   45.761                   45.209                   44.381                   43.553                   42.449                   41.069                    39.689                    37.757                    35.549                    33.064                    30.304                    26.992        
           47.141                   46.863                   46.586                   46.032                   45.478                   44.646                   43.815                   42.706                    41.32                    39.935                    37.994                    36.054                     33.56                    30.511                    27.463        
           47.416                   47.137                   46.859                   46.303                   45.746                   44.911                   44.076                   42.963                   41.572                     40.18                     38.51                    36.284                    33.779                    30.718                    27.657        
           47.691                   47.411                   47.132                   46.573                   46.014                   45.176                   44.338                    43.22                   42.102                    40.426                    38.749                    36.514                    33.999                    31.205                    27.852        
           48.247                   47.686                   47.405                   46.844                   46.283                   45.441                   44.599                   43.477                   42.355                    40.671                    38.988                    36.744                    34.219                    31.413                    28.327        

</pre><h2 id="9">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_evf)
</pre><h2 id="11">Graph 1, V and EV</h2><pre class="codeinput">    <span class="keyword">if</span> (~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
        hold <span class="string">on</span>;
    <span class="keyword">end</span>


    <span class="keyword">for</span> subplot_j=1:1:2

        <span class="keyword">if</span> (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (subplot_j==1)
            chart = plot(mt_val);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        <span class="keyword">end</span>

        clr = jet(numel(chart));
        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>

        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        <span class="keyword">if</span> (subplot_j==1)
            title(<span class="string">'V(coh,zp); w(k+b),k,z'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            title(<span class="string">'E_z(V(coh,zp|z))'</span>);
        <span class="keyword">end</span>

        ylabel(<span class="string">'Next Period Value'</span>);
        xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span><span class="keyword">...</span>
            <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
            <span class="string">'EV and V identical if shock is fully persistent'</span>});
        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
    <span class="keyword">end</span>

    <span class="comment">% Share y axis</span>
    <span class="keyword">if</span> (~bl_graph_onebyones)
        linkaxes(hAxis,<span class="string">'y'</span>);
    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_vev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_02.png" alt=""> <h2 id="12">Graph 2, max(EV)</h2><pre class="codeinput">    <span class="keyword">if</span>(~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="keyword">end</span>

    <span class="keyword">for</span> sub_j=1:1:1

        <span class="keyword">if</span>(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = <span class="string">'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span>(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>
        hold <span class="string">on</span>;

        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        <span class="keyword">for</span> i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, <span class="keyword">...</span>
                <span class="string">'MarkerEdgeColor'</span>, clr(i_ctr,:), <span class="keyword">...</span>
                <span class="string">'MarkerFaceColor'</span>, clr(i_ctr,:));
        <span class="keyword">end</span>

        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
        title([<span class="string">'2nd Stage Exp Value at Optimal K given W=K''+B'''</span>])
        ylabel(st_y_label)
        xlabel({<span class="string">'Aggregate Savings'</span>})

        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legendCell{length(legendCell) + 1} = <span class="string">'max-agg-save'</span>;
        legend(legendCell([ar_it_z_graph length(legendCell)]), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_03.png" alt=""> <h2 id="13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</h2><pre class="codeinput">    <span class="comment">% Borrow Vs Save</span>
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) &gt; 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));

    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="comment">% States: ar_w, ar_z</span>
    <span class="comment">% Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp</span>
    hold <span class="string">on</span>;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_borr_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'blue'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_br], {'Borrow'}, 'Location','northeast');</span>
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'black'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_khalf], {'Save &gt;0.5 K'}, 'Location','northeast');</span>
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'red'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_sv], {'Save &lt;0.5 K'}, 'Location','northeast');</span>
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'yellow'</span>, <span class="string">'filled'</span>);
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], <span class="keyword">...</span>
        {<span class="string">'Borrow'</span>,<span class="string">'Save &gt;0.5 K'</span>,<span class="string">'Save &lt;0.5 K'</span>, <span class="string">'k=0 or k=nan'</span>}, <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
    title(<span class="string">'Borrow and Save Regions'</span>)
    ylabel(<span class="string">'Shocks'</span>)
    xlabel({<span class="string">'Total Savings w=k+b'</span>})
    grid <span class="string">on</span>;

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxbrsv'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_04.png" alt=""> <h2 id="14">Graph 4, Optimal K' and B' Levels</h2><pre class="codeinput">    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    <span class="keyword">for</span> sub_j=1:1:4

        <span class="keyword">if</span> (bl_graph_onebyones)
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_bp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            <span class="keyword">end</span>

            mt_y = mt_ev_condi_z_max_kp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==3)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        <span class="keyword">end</span>

        hold <span class="string">on</span>;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));

        <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
        <span class="keyword">end</span>

        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;
        grid <span class="string">on</span>;
        <span class="keyword">if</span> (sub_j&lt;=2)
            hline = refline([1 0]);
            hline.Color = <span class="string">'k'</span>;
            hline.LineStyle = <span class="string">':'</span>;
            hline.HandleVisibility = <span class="string">'off'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            title(<span class="string">'B Choices of W'</span>);
            ylabel(<span class="string">'B Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            title(<span class="string">'K Choices of W'</span>);
            ylabel(<span class="string">'K Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==3)
            title(<span class="string">'B Fraction of Borrow Max and Save'</span>);
            ylabel(<span class="string">'B/bar(B) if br or B/W if sv'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            title(<span class="string">'K Fraction Choices of Total K Possible'</span>);
            ylabel(<span class="string">'K/(W-bar(b)) '</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
        <span class="keyword">end</span>

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_wkbopti'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkbz_evf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_evf_08.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans =

  Columns 1 through 7

   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078
   -1.2797   -1.1781   -1.0688   -0.9567   -0.8438   -0.7307   -0.6174
   -0.4800   -0.4193   -0.3517   -0.2797   -0.2045   -0.1264   -0.0455
   -0.0661   -0.0191    0.0339    0.0911    0.1518    0.2157    0.2828
    0.2168    0.2564    0.3013    0.3501    0.4024    0.4579    0.5166
    0.4326    0.4674    0.5070    0.5502    0.5967    0.6465    0.6994
    0.6076    0.6388    0.6745    0.7137    0.7560    0.8014    0.8500
    0.7560    0.7833    0.8160    0.8521    0.8911    0.9332    0.9783
    0.8851    0.9093    0.9387    0.9723    1.0087    1.0480    1.0902
    0.9994    1.0211    1.0475    1.0785    1.1127    1.1497    1.1896
    1.1020    1.1216    1.1455    1.1738    1.2061    1.2412    1.2791
    1.1950    1.2129    1.2348    1.2608    1.2909    1.3243    1.3604
    1.2801    1.2966    1.3168    1.3407    1.3686    1.4005    1.4350
    1.3586    1.3738    1.3925    1.4147    1.4407    1.4708    1.5040
    1.4313    1.4454    1.4629    1.4836    1.5079    1.5362    1.5682
    1.4990    1.5123    1.5286    1.5481    1.5709    1.5975    1.6281
    1.5625    1.5749    1.5903    1.6086    1.6301    1.6552    1.6844
    1.6222    1.6339    1.6484    1.6657    1.6861    1.7098    1.7374
    1.6785    1.6896    1.7033    1.7197    1.7390    1.7616    1.7878
    1.7318    1.7423    1.7554    1.7710    1.7893    1.8108    1.8358
    1.7824    1.7924    1.8048    1.8197    1.8372    1.8577    1.8816
    1.8306    1.8401    1.8520    1.8661    1.8829    1.9024    1.9253
    1.8766    1.8857    1.8970    1.9105    1.9265    1.9453    1.9673
    1.9205    1.9292    1.9401    1.9531    1.9684    1.9864    2.0075
    1.9626    1.9710    1.9814    1.9938    2.0086    2.0259    2.0462
    2.0030    2.0110    2.0210    2.0330    2.0472    2.0639    2.0834
    2.0418    2.0495    2.0592    2.0707    2.0844    2.1004    2.1193
    2.0792    2.0866    2.0959    2.1070    2.1202    2.1357    2.1539
    2.1152    2.1224    2.1313    2.1421    2.1548    2.1698    2.1874
    2.1499    2.1569    2.1656    2.1760    2.1883    2.2028    2.2198
    2.1835    2.1903    2.1987    2.2087    2.2206    2.2347    2.2512
    2.2160    2.2226    2.2307    2.2404    2.2520    2.2656    2.2816
    2.2475    2.2539    2.2617    2.2712    2.2824    2.2956    2.3112
    2.2781    2.2842    2.2918    2.3010    2.3119    2.3247    2.3398
    2.3077    2.3136    2.3210    2.3299    2.3405    2.3530    2.3677
    2.3364    2.3422    2.3494    2.3581    2.3684    2.3805    2.3948
    2.3644    2.3700    2.3770    2.3855    2.3955    2.4073    2.4212
    2.3916    2.3971    2.4039    2.4121    2.4219    2.4334    2.4470
    2.4181    2.4234    2.4301    2.4381    2.4476    2.4588    2.4721
    2.4439    2.4491    2.4556    2.4634    2.4726    2.4836    2.4965
    2.4690    2.4741    2.4804    2.4880    2.4971    2.5078    2.5204
    2.4936    2.4985    2.5047    2.5121    2.5209    2.5314    2.5437
    2.5175    2.5223    2.5284    2.5356    2.5442    2.5545    2.5665
    2.5409    2.5456    2.5515    2.5586    2.5670    2.5770    2.5888
    2.5637    2.5684    2.5741    2.5810    2.5893    2.5991    2.6106
    2.5861    2.5906    2.5962    2.6030    2.6111    2.6206    2.6319
    2.6079    2.6124    2.6179    2.6245    2.6324    2.6418    2.6528
    2.6293    2.6336    2.6390    2.6455    2.6533    2.6624    2.6733
    2.6503    2.6545    2.6598    2.6661    2.6737    2.6827    2.6933
    2.6708    2.6749    2.6801    2.6863    2.6938    2.7026    2.7130
    2.6909    2.6949    2.7000    2.7061    2.7134    2.7220    2.7323
    2.7106    2.7145    2.7195    2.7255    2.7327    2.7411    2.7512
    2.7299    2.7338    2.7387    2.7446    2.7516    2.7599    2.7697
    2.7488    2.7527    2.7575    2.7632    2.7701    2.7783    2.7879
    2.7674    2.7712    2.7759    2.7816    2.7883    2.7963    2.8058
    2.7857    2.7894    2.7940    2.7996    2.8062    2.8141    2.8234
    2.8036    2.8073    2.8118    2.8173    2.8238    2.8315    2.8407
    2.8212    2.8248    2.8293    2.8346    2.8411    2.8487    2.8577
    2.8385    2.8421    2.8464    2.8517    2.8580    2.8655    2.8744
    2.8556    2.8590    2.8633    2.8685    2.8747    2.8821    2.8908
    2.8723    2.8757    2.8799    2.8850    2.8911    2.8984    2.9070
    2.8888    2.8921    2.8963    2.9013    2.9073    2.9144    2.9229
    2.9049    2.9082    2.9123    2.9173    2.9232    2.9302    2.9385
    2.9209    2.9241    2.9282    2.9330    2.9388    2.9457    2.9539
    2.9366    2.9397    2.9437    2.9485    2.9542    2.9610    2.9691
    2.9520    2.9551    2.9591    2.9638    2.9694    2.9761    2.9841
    2.9672    2.9703    2.9742    2.9788    2.9844    2.9910    2.9988
    2.9822    2.9852    2.9890    2.9936    2.9991    3.0056    3.0133
    2.9969    2.9999    3.0037    3.0082    3.0136    3.0200    3.0276
    3.0115    3.0144    3.0181    3.0226    3.0279    3.0342    3.0417
    3.0258    3.0287    3.0324    3.0368    3.0420    3.0482    3.0556
    3.0339    3.0368    3.0404    3.0448    3.0500    3.0562    3.0635
    3.0399    3.0428    3.0464    3.0507    3.0559    3.0621    3.0694
    3.0539    3.0567    3.0603    3.0645    3.0696    3.0757    3.0829
    3.0676    3.0704    3.0739    3.0781    3.0832    3.0891    3.0962
    3.0812    3.0839    3.0874    3.0915    3.0965    3.1024    3.1094
    3.0946    3.0973    3.1007    3.1048    3.1097    3.1155    3.1224
    3.1078    3.1104    3.1138    3.1178    3.1227    3.1284    3.1353
    3.1207    3.1234    3.1267    3.1307    3.1355    3.1412    3.1479
    3.1335    3.1362    3.1395    3.1435    3.1482    3.1538    3.1605
    3.1461    3.1488    3.1521    3.1561    3.1607    3.1662    3.1728
    3.1585    3.1612    3.1645    3.1685    3.1731    3.1785    3.1850
    3.1707    3.1734    3.1767    3.1807    3.1853    3.1907    3.1971
    3.1829    3.1855    3.1888    3.1927    3.1973    3.2027    3.2090
    3.1948    3.1974    3.2007    3.2046    3.2092    3.2145    3.2208
    3.2067    3.2092    3.2124    3.2163    3.2209    3.2262    3.2324
    3.2184    3.2209    3.2241    3.2279    3.2324    3.2378    3.2440
    3.2299    3.2324    3.2356    3.2393    3.2438    3.2492    3.2553
    3.2414    3.2438    3.2469    3.2507    3.2551    3.2604    3.2666
    3.2526    3.2551    3.2582    3.2618    3.2663    3.2715    3.2777
    3.2638    3.2662    3.2693    3.2729    3.2773    3.2825    3.2886
    3.2749    3.2773    3.2803    3.2839    3.2882    3.2933    3.2994
    3.2858    3.2882    3.2911    3.2947    3.2990    3.3040    3.3101
    3.2966    3.2989    3.3019    3.3054    3.3096    3.3147    3.3206
    3.3073    3.3096    3.3125    3.3160    3.3202    3.3252    3.3311
    3.3179    3.3202    3.3230    3.3265    3.3306    3.3356    3.3414
    3.3283    3.3306    3.3335    3.3369    3.3410    3.3458    3.3516
    3.3387    3.3410    3.3438    3.3472    3.3512    3.3560    3.3618
    3.3490    3.3512    3.3540    3.3573    3.3613    3.3661    3.3718
    3.3591    3.3613    3.3641    3.3674    3.3714    3.3761    3.3817
    3.3692    3.3713    3.3741    3.3774    3.3813    3.3860    3.3915
    3.3791    3.3813    3.3840    3.3872    3.3911    3.3957    3.4013
    3.3890    3.3911    3.3938    3.3970    3.4008    3.4054    3.4109
    3.3987    3.4008    3.4035    3.4067    3.4105    3.4150    3.4204
    3.4084    3.4105    3.4131    3.4163    3.4200    3.4245    3.4299
    3.4179    3.4200    3.4226    3.4257    3.4295    3.4340    3.4393
    3.4274    3.4295    3.4320    3.4352    3.4389    3.4433    3.4485
    3.4368    3.4388    3.4414    3.4445    3.4481    3.4525    3.4577
    3.4461    3.4481    3.4506    3.4537    3.4573    3.4617    3.4668
    3.4553    3.4573    3.4598    3.4628    3.4665    3.4708    3.4759
    3.4645    3.4664    3.4689    3.4719    3.4755    3.4797    3.4848
    3.4735    3.4755    3.4779    3.4809    3.4844    3.4887    3.4937
    3.4825    3.4844    3.4868    3.4898    3.4933    3.4975    3.5025
    3.4914    3.4933    3.4957    3.4986    3.5021    3.5062    3.5112
    3.5002    3.5021    3.5045    3.5074    3.5108    3.5149    3.5198
    3.5089    3.5108    3.5132    3.5160    3.5195    3.5235    3.5284
    3.5176    3.5194    3.5218    3.5246    3.5280    3.5321    3.5369
    3.5261    3.5280    3.5303    3.5331    3.5365    3.5405    3.5453
    3.5346    3.5365    3.5388    3.5416    3.5449    3.5489    3.5536
    3.5431    3.5449    3.5472    3.5500    3.5533    3.5572    3.5619
    3.5515    3.5533    3.5555    3.5583    3.5616    3.5655    3.5701
    3.5597    3.5616    3.5638    3.5665    3.5698    3.5737    3.5783
    3.5680    3.5698    3.5720    3.5747    3.5779    3.5818    3.5864
    3.5761    3.5779    3.5801    3.5828    3.5860    3.5898    3.5944
    3.5842    3.5860    3.5882    3.5908    3.5940    3.5978    3.6023
    3.5923    3.5940    3.5962    3.5988    3.6020    3.6057    3.6102
    3.6002    3.6020    3.6041    3.6067    3.6099    3.6136    3.6180
    3.6081    3.6099    3.6120    3.6146    3.6177    3.6214    3.6258
    3.6160    3.6177    3.6198    3.6224    3.6255    3.6291    3.6335
    3.6238    3.6255    3.6276    3.6301    3.6332    3.6368    3.6412
    3.6315    3.6332    3.6353    3.6378    3.6408    3.6444    3.6487
    3.6391    3.6408    3.6429    3.6454    3.6484    3.6520    3.6563
    3.6467    3.6484    3.6505    3.6530    3.6560    3.6595    3.6637
    3.6543    3.6559    3.6580    3.6605    3.6634    3.6670    3.6712
    3.6618    3.6634    3.6654    3.6679    3.6708    3.6744    3.6785
    3.6692    3.6708    3.6729    3.6753    3.6782    3.6817    3.6858
    3.6766    3.6782    3.6802    3.6826    3.6855    3.6890    3.6931
    3.6839    3.6855    3.6875    3.6899    3.6928    3.6962    3.7003
    3.6912    3.6928    3.6947    3.6971    3.7000    3.7034    3.7075
    3.6984    3.7000    3.7019    3.7043    3.7072    3.7105    3.7146
    3.7056    3.7071    3.7091    3.7114    3.7143    3.7176    3.7216
    3.7127    3.7142    3.7162    3.7185    3.7213    3.7247    3.7286
    3.7198    3.7213    3.7232    3.7255    3.7283    3.7316    3.7356
    3.7268    3.7283    3.7302    3.7325    3.7353    3.7386    3.7425
    3.7337    3.7353    3.7372    3.7394    3.7422    3.7455    3.7493
    3.7407    3.7422    3.7441    3.7463    3.7490    3.7523    3.7562
    3.7475    3.7490    3.7509    3.7532    3.7559    3.7591    3.7629
    3.7544    3.7558    3.7577    3.7599    3.7626    3.7658    3.7696
    3.7611    3.7626    3.7645    3.7667    3.7694    3.7725    3.7763
    3.7679    3.7693    3.7712    3.7734    3.7760    3.7792    3.7830
    3.7746    3.7760    3.7778    3.7800    3.7827    3.7858    3.7895
    3.7812    3.7827    3.7845    3.7866    3.7893    3.7924    3.7961
    3.7878    3.7892    3.7910    3.7932    3.7958    3.7989    3.8026
    3.7944    3.7958    3.7976    3.7997    3.8023    3.8054    3.8091
    3.8009    3.8023    3.8041    3.8062    3.8088    3.8118    3.8155
    3.8073    3.8088    3.8105    3.8126    3.8152    3.8182    3.8219
    3.8138    3.8152    3.8169    3.8190    3.8216    3.8246    3.8282
    3.8202    3.8216    3.8233    3.8254    3.8279    3.8309    3.8345
    3.8265    3.8279    3.8296    3.8317    3.8342    3.8372    3.8407
    3.8328    3.8342    3.8359    3.8380    3.8405    3.8434    3.8470
    3.8391    3.8405    3.8422    3.8442    3.8467    3.8496    3.8531
    3.8453    3.8467    3.8484    3.8504    3.8529    3.8558    3.8593
    3.8515    3.8529    3.8545    3.8566    3.8590    3.8619    3.8654
    3.8577    3.8590    3.8607    3.8627    3.8651    3.8680    3.8715
    3.8638    3.8651    3.8668    3.8688    3.8712    3.8741    3.8775
    3.8699    3.8712    3.8728    3.8748    3.8772    3.8801    3.8835
    3.8759    3.8772    3.8789    3.8809    3.8832    3.8861    3.8895
    3.8819    3.8832    3.8848    3.8868    3.8892    3.8920    3.8954
    3.8879    3.8892    3.8908    3.8928    3.8951    3.8979    3.9013
    3.8938    3.8951    3.8967    3.8987    3.9010    3.9038    3.9071
    3.8997    3.9010    3.9026    3.9045    3.9069    3.9096    3.9129
    3.9056    3.9069    3.9084    3.9104    3.9127    3.9154    3.9187
    3.9114    3.9127    3.9143    3.9162    3.9185    3.9212    3.9245
    3.9172    3.9185    3.9200    3.9220    3.9242    3.9270    3.9302
    3.9230    3.9242    3.9258    3.9277    3.9300    3.9327    3.9359
    3.9287    3.9299    3.9315    3.9334    3.9356    3.9383    3.9416
    3.9344    3.9356    3.9372    3.9391    3.9413    3.9440    3.9472
    3.9401    3.9413    3.9428    3.9447    3.9469    3.9496    3.9528
    3.9457    3.9469    3.9485    3.9503    3.9525    3.9552    3.9583
    3.9513    3.9525    3.9540    3.9559    3.9581    3.9607    3.9639
    3.9569    3.9581    3.9596    3.9614    3.9636    3.9662    3.9694
    3.9624    3.9636    3.9651    3.9669    3.9691    3.9717    3.9748
    3.9679    3.9691    3.9706    3.9724    3.9746    3.9772    3.9803
    3.9734    3.9746    3.9761    3.9779    3.9800    3.9826    3.9857
    3.9788    3.9800    3.9815    3.9833    3.9855    3.9880    3.9911
    3.9843    3.9854    3.9869    3.9887    3.9908    3.9934    3.9964
    3.9896    3.9908    3.9923    3.9941    3.9962    3.9987    4.0018
    3.9950    3.9962    3.9976    3.9994    4.0015    4.0040    4.0070
    4.0003    4.0015    4.0030    4.0047    4.0068    4.0093    4.0123
    4.0056    4.0068    4.0082    4.0100    4.0121    4.0146    4.0176
    4.0109    4.0121    4.0135    4.0152    4.0173    4.0198    4.0228
    4.0162    4.0173    4.0187    4.0205    4.0225    4.0250    4.0280
    4.0214    4.0225    4.0240    4.0257    4.0277    4.0302    4.0331
    4.0266    4.0277    4.0291    4.0308    4.0329    4.0353    4.0383
    4.0318    4.0329    4.0343    4.0360    4.0380    4.0405    4.0434
    4.0369    4.0380    4.0394    4.0411    4.0431    4.0456    4.0484
    4.0420    4.0431    4.0445    4.0462    4.0482    4.0506    4.0535
    4.0471    4.0482    4.0496    4.0513    4.0533    4.0557    4.0585
    4.0522    4.0533    4.0546    4.0563    4.0583    4.0607    4.0635
    4.0572    4.0583    4.0597    4.0613    4.0633    4.0657    4.0685
    4.0622    4.0633    4.0647    4.0663    4.0683    4.0707    4.0735
    4.0672    4.0683    4.0696    4.0713    4.0733    4.0756    4.0784
    4.0722    4.0732    4.0746    4.0762    4.0782    4.0805    4.0833
    4.0771    4.0782    4.0795    4.0811    4.0831    4.0854    4.0882
    4.0820    4.0831    4.0844    4.0860    4.0880    4.0903    4.0931
    4.0869    4.0880    4.0893    4.0909    4.0928    4.0951    4.0979
    4.0918    4.0928    4.0942    4.0958    4.0977    4.1000    4.1027
    4.0966    4.0977    4.0990    4.1006    4.1025    4.1048    4.1075
    4.1014    4.1025    4.1038    4.1054    4.1073    4.1096    4.1123
    4.1062    4.1073    4.1086    4.1102    4.1121    4.1143    4.1170
    4.1110    4.1120    4.1133    4.1149    4.1168    4.1190    4.1217
    4.1157    4.1168    4.1181    4.1196    4.1215    4.1238    4.1264
    4.1205    4.1215    4.1228    4.1244    4.1262    4.1284    4.1311
    4.1252    4.1262    4.1275    4.1290    4.1309    4.1331    4.1358
    4.1299    4.1309    4.1322    4.1337    4.1356    4.1378    4.1404
    4.1345    4.1355    4.1368    4.1384    4.1402    4.1424    4.1450
    4.1392    4.1402    4.1414    4.1430    4.1448    4.1470    4.1496
    4.1438    4.1448    4.1460    4.1476    4.1494    4.1516    4.1542
    4.1484    4.1494    4.1506    4.1522    4.1540    4.1561    4.1587
    4.1530    4.1540    4.1552    4.1567    4.1585    4.1607    4.1632
    4.1575    4.1585    4.1597    4.1612    4.1631    4.1652    4.1678
    4.1620    4.1630    4.1643    4.1658    4.1676    4.1697    4.1722
    4.1666    4.1675    4.1688    4.1703    4.1721    4.1742    4.1767
    4.1711    4.1720    4.1733    4.1747    4.1765    4.1786    4.1812
    4.1755    4.1765    4.1777    4.1792    4.1810    4.1831    4.1856
    4.1800    4.1810    4.1822    4.1836    4.1854    4.1875    4.1900
    4.1844    4.1854    4.1866    4.1881    4.1898    4.1919    4.1944
    4.1888    4.1898    4.1910    4.1925    4.1942    4.1963    4.1988
    4.1932    4.1942    4.1954    4.1968    4.1986    4.2006    4.2031
    4.1976    4.1986    4.1998    4.2012    4.2029    4.2050    4.2074
    4.2020    4.2029    4.2041    4.2055    4.2073    4.2093    4.2118
    4.2063    4.2072    4.2084    4.2099    4.2116    4.2136    4.2161
    4.2106    4.2116    4.2127    4.2142    4.2159    4.2179    4.2203
    4.2149    4.2159    4.2170    4.2184    4.2201    4.2222    4.2246
    4.2192    4.2201    4.2213    4.2227    4.2244    4.2264    4.2288
    4.2235    4.2244    4.2256    4.2270    4.2287    4.2307    4.2331
    4.2277    4.2286    4.2298    4.2312    4.2329    4.2349    4.2373
    4.2319    4.2329    4.2340    4.2354    4.2371    4.2391    4.2415
    4.2362    4.2371    4.2382    4.2396    4.2413    4.2433    4.2456
    4.2403    4.2413    4.2424    4.2438    4.2454    4.2474    4.2498
    4.2445    4.2454    4.2466    4.2479    4.2496    4.2516    4.2539
    4.2487    4.2496    4.2507    4.2521    4.2537    4.2557    4.2580
    4.2528    4.2537    4.2548    4.2562    4.2579    4.2598    4.2621
    4.2569    4.2578    4.2590    4.2603    4.2620    4.2639    4.2662
    4.2610    4.2619    4.2631    4.2644    4.2660    4.2680    4.2703
    4.2651    4.2660    4.2671    4.2685    4.2701    4.2720    4.2743
    4.2692    4.2701    4.2712    4.2726    4.2742    4.2761    4.2784
    4.2733    4.2741    4.2753    4.2766    4.2782    4.2801    4.2824
    4.2773    4.2782    4.2793    4.2806    4.2822    4.2841    4.2864

  Columns 8 through 14

   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078   -6.9078
   -0.5041   -0.3906   -0.2770   -0.1634   -0.0498    0.0631    0.1735
    0.0381    0.1241    0.2124    0.3029    0.3954    0.4892    0.5824
    0.3529    0.4262    0.5023    0.5812    0.6628    0.7463    0.8301
    0.5785    0.6437    0.7119    0.7833    0.8575    0.9341    1.0113
    0.7555    0.8149    0.8774    0.9432    1.0120    1.0833    1.1556
    0.9017    0.9566    1.0148    1.0762    1.1406    1.2078    1.2761
    1.0265    1.0779    1.1325    1.1903    1.2512    1.3149    1.3799
    1.1355    1.1840    1.2356    1.2904    1.3484    1.4092    1.4713
    1.2325    1.2785    1.3275    1.3798    1.4352    1.4934    1.5531
    1.3198    1.3637    1.4106    1.4606    1.5138    1.5697    1.6272
    1.3994    1.4413    1.4863    1.5344    1.5855    1.6395    1.6951
    1.4724    1.5127    1.5559    1.6023    1.6517    1.7039    1.7577
    1.5400    1.5787    1.6205    1.6652    1.7130    1.7636    1.8158
    1.6028    1.6402    1.6806    1.7239    1.7703    1.8194    1.8701
    1.6616    1.6978    1.7369    1.7789    1.8239    1.8717    1.9211
    1.7168    1.7519    1.7898    1.8306    1.8744    1.9209    1.9691
    1.7688    1.8029    1.8398    1.8795    1.9222    1.9675    2.0145
    1.8181    1.8513    1.8871    1.9259    1.9674    2.0117    2.0577
    1.8649    1.8971    1.9321    1.9699    2.0105    2.0538    2.0987
    1.9094    1.9408    1.9750    2.0118    2.0515    2.0939    2.1379
    1.9520    1.9825    2.0159    2.0519    2.0908    2.1322    2.1753
    1.9928    2.0224    2.0550    2.0903    2.1283    2.1689    2.2112
    2.0321    2.0607    2.0926    2.1271    2.1644    2.2042    2.2457
    2.0699    2.0974    2.1286    2.1625    2.1990    2.2381    2.2789
    2.1062    2.1328    2.1633    2.1965    2.2324    2.2707    2.3108
    2.1413    2.1670    2.1967    2.2293    2.2645    2.3022    2.3416
    2.1753    2.2001    2.2290    2.2610    2.2956    2.3326    2.3714
    2.2081    2.2321    2.2601    2.2916    2.3256    2.3621    2.4002
    2.2398    2.2632    2.2903    2.3212    2.3546    2.3905    2.4281
    2.2706    2.2932    2.3196    2.3498    2.3828    2.4181    2.4551
    2.3004    2.3224    2.3481    2.3777    2.4101    2.4449    2.4813
    2.3294    2.3508    2.3758    2.4047    2.4366    2.4709    2.5068
    2.3576    2.3784    2.4027    2.4309    2.4623    2.4962    2.5316
    2.3850    2.4053    2.4289    2.4564    2.4874    2.5207    2.5557
    2.4117    2.4314    2.4544    2.4813    2.5118    2.5447    2.5792
    2.4376    2.4569    2.4794    2.5055    2.5355    2.5680    2.6020
    2.4630    2.4817    2.5037    2.5292    2.5587    2.5907    2.6243
    2.4877    2.5060    2.5274    2.5524    2.5813    2.6129    2.6461
    2.5117    2.5296    2.5506    2.5750    2.6033    2.6345    2.6674
    2.5353    2.5528    2.5732    2.5971    2.6248    2.6557    2.6881
    2.5583    2.5753    2.5954    2.6187    2.6459    2.6764    2.7084
    2.5807    2.5974    2.6170    2.6399    2.6665    2.6966    2.7283
    2.6027    2.6191    2.6382    2.6606    2.6867    2.7164    2.7477
    2.6242    2.6402    2.6590    2.6810    2.7065    2.7357    2.7667
    2.6453    2.6609    2.6793    2.7009    2.7259    2.7547    2.7854
    2.6659    2.6812    2.6993    2.7204    2.7450    2.7732    2.8036
    2.6861    2.7011    2.7188    2.7395    2.7637    2.7915    2.8215
    2.7059    2.7206    2.7380    2.7583    2.7820    2.8093    2.8391
    2.7253    2.7398    2.7568    2.7768    2.8000    2.8269    2.8563
    2.7443    2.7585    2.7753    2.7949    2.8177    2.8441    2.8732
    2.7630    2.7770    2.7934    2.8127    2.8351    2.8610    2.8898
    2.7814    2.7951    2.8112    2.8301    2.8522    2.8777    2.9061
    2.7994    2.8128    2.8287    2.8473    2.8690    2.8941    2.9221
    2.8171    2.8303    2.8459    2.8642    2.8855    2.9102    2.9379
    2.8345    2.8475    2.8628    2.8808    2.9018    2.9261    2.9533
    2.8515    2.8643    2.8794    2.8971    2.9178    2.9417    2.9686
    2.8683    2.8809    2.8958    2.9132    2.9335    2.9571    2.9835
    2.8849    2.8973    2.9118    2.9290    2.9490    2.9722    2.9983
    2.9011    2.9133    2.9277    2.9445    2.9643    2.9871    3.0128
    2.9171    2.9291    2.9433    2.9599    2.9793    3.0018    3.0272
    2.9329    2.9447    2.9586    2.9750    2.9941    3.0163    3.0413
    2.9484    2.9600    2.9737    2.9898    3.0087    3.0306    3.0552
    2.9636    2.9751    2.9886    3.0045    3.0231    3.0447    3.0690
    2.9787    2.9899    3.0033    3.0189    3.0373    3.0585    3.0825
    2.9935    3.0046    3.0177    3.0332    3.0513    3.0722    3.0959
    3.0081    3.0190    3.0320    3.0472    3.0650    3.0857    3.1091
    3.0225    3.0333    3.0460    3.0610    3.0786    3.0991    3.1221
    3.0366    3.0473    3.0599    3.0747    3.0921    3.1122    3.1350
    3.0506    3.0611    3.0735    3.0882    3.1053    3.1252    3.1476
    3.0644    3.0748    3.0870    3.1014    3.1184    3.1380    3.1602
    3.0722    3.0825    3.0946    3.1090    3.1258    3.1453    3.1673
    3.0780    3.0882    3.1003    3.1146    3.1313    3.1507    3.1726
    3.0914    3.1015    3.1134    3.1275    3.1440    3.1631    3.1848
    3.1047    3.1146    3.1264    3.1403    3.1566    3.1755    3.1969
    3.1177    3.1276    3.1392    3.1529    3.1690    3.1877    3.2088
    3.1306    3.1403    3.1518    3.1654    3.1812    3.1997    3.2206
    3.1434    3.1530    3.1643    3.1777    3.1934    3.2116    3.2322
    3.1559    3.1654    3.1766    3.1898    3.2053    3.2234    3.2437
    3.1684    3.1777    3.1888    3.2018    3.2172    3.2350    3.2551
    3.1806    3.1899    3.2008    3.2137    3.2288    3.2465    3.2664
    3.1927    3.2019    3.2127    3.2254    3.2404    3.2578    3.2775
    3.2047    3.2137    3.2244    3.2370    3.2518    3.2691    3.2885
    3.2166    3.2255    3.2360    3.2485    3.2631    3.2802    3.2994
    3.2282    3.2371    3.2475    3.2598    3.2743    3.2911    3.3102
    3.2398    3.2485    3.2588    3.2710    3.2853    3.3020    3.3209
    3.2512    3.2598    3.2700    3.2821    3.2962    3.3127    3.3314
    3.2625    3.2710    3.2811    3.2930    3.3071    3.3234    3.3418
    3.2737    3.2821    3.2921    3.3039    3.3177    3.3339    3.3522
    3.2847    3.2931    3.3029    3.3146    3.3283    3.3443    3.3624
    3.2957    3.3039    3.3137    3.3252    3.3388    3.3546    3.3725
    3.3065    3.3146    3.3243    3.3357    3.3491    3.3648    3.3825
    3.3172    3.3252    3.3348    3.3461    3.3594    3.3749    3.3924
    3.3277    3.3357    3.3452    3.3564    3.3695    3.3849    3.4023
    3.3381    3.3461    3.3555    3.3666    3.3796    3.3948    3.4120
    3.3484    3.3564    3.3657    3.3766    3.3895    3.4046    3.4216
    3.3585    3.3666    3.3758    3.3866    3.3994    3.4143    3.4312
    3.3686    3.3766    3.3857    3.3965    3.4091    3.4239    3.4406
    3.3785    3.3865    3.3956    3.4062    3.4188    3.4334    3.4500
    3.3884    3.3963    3.4054    3.4159    3.4283    3.4428    3.4592
    3.3981    3.4060    3.4151    3.4255    3.4378    3.4522    3.4684
    3.4078    3.4156    3.4247    3.4350    3.4472    3.4614    3.4775
    3.4174    3.4251    3.4341    3.4444    3.4565    3.4706    3.4866
    3.4269    3.4345    3.4435    3.4538    3.4657    3.4797    3.4955
    3.4363    3.4438    3.4527    3.4630    3.4748    3.4887    3.5044
    3.4456    3.4530    3.4619    3.4721    3.4839    3.4976    3.5131
    3.4548    3.4622    3.4710    3.4812    3.4928    3.5064    3.5219
    3.4639    3.4713    3.4800    3.4902    3.5017    3.5152    3.5305
    3.4730    3.4803    3.4889    3.4990    3.5105    3.5239    3.5390
    3.4819    3.4892    3.4977    3.5078    3.5193    3.5325    3.5475
    3.4908    3.4980    3.5065    3.5165    3.5279    3.5410    3.5559
    3.4997    3.5067    3.5151    3.5251    3.5365    3.5495    3.5643
    3.5084    3.5154    3.5237    3.5336    3.5450    3.5579    3.5726
    3.5171    3.5240    3.5323    3.5420    3.5534    3.5662    3.5808
    3.5256    3.5325    3.5407    3.5504    3.5618    3.5745    3.5889
    3.5342    3.5410    3.5491    3.5587    3.5700    3.5827    3.5970
    3.5426    3.5494    3.5574    3.5670    3.5782    3.5908    3.6050
    3.5510    3.5577    3.5657    3.5751    3.5863    3.5989    3.6129
    3.5593    3.5659    3.5739    3.5832    3.5943    3.6069    3.6208
    3.5675    3.5741    3.5820    3.5913    3.6023    3.6148    3.6286
    3.5757    3.5822    3.5900    3.5993    3.6102    3.6227    3.6364
    3.5838    3.5903    3.5980    3.6072    3.6180    3.6304    3.6441
    3.5918    3.5983    3.6059    3.6150    3.6258    3.6382    3.6517
    3.5998    3.6062    3.6138    3.6228    3.6335    3.6458    3.6593
    3.6077    3.6140    3.6216    3.6305    3.6411    3.6534    3.6669
    3.6155    3.6218    3.6293    3.6382    3.6487    3.6609    3.6743
    3.6233    3.6296    3.6370    3.6458    3.6562    3.6684    3.6817
    3.6310    3.6373    3.6446    3.6534    3.6637    3.6758    3.6891
    3.6387    3.6449    3.6522    3.6609    3.6711    3.6831    3.6964
    3.6463    3.6524    3.6597    3.6683    3.6785    3.6904    3.7037
    3.6539    3.6599    3.6672    3.6757    3.6858    3.6976    3.7109
    3.6614    3.6674    3.6746    3.6830    3.6931    3.7048    3.7180
    3.6688    3.6748    3.6819    3.6903    3.7003    3.7119    3.7251
    3.6762    3.6821    3.6892    3.6975    3.7074    3.7190    3.7321
    3.6835    3.6894    3.6964    3.7047    3.7145    3.7260    3.7390
    3.6908    3.6966    3.7036    3.7118    3.7216    3.7330    3.7459
    3.6980    3.7038    3.7107    3.7189    3.7286    3.7399    3.7528
    3.7052    3.7109    3.7178    3.7259    3.7356    3.7468    3.7596
    3.7123    3.7180    3.7248    3.7329    3.7425    3.7536    3.7663
    3.7194    3.7251    3.7318    3.7398    3.7493    3.7604    3.7730
    3.7264    3.7320    3.7388    3.7467    3.7561    3.7672    3.7797
    3.7334    3.7390    3.7456    3.7536    3.7629    3.7738    3.7863
    3.7403    3.7459    3.7525    3.7603    3.7696    3.7805    3.7929
    3.7471    3.7527    3.7593    3.7671    3.7763    3.7871    3.7994
    3.7540    3.7595    3.7660    3.7738    3.7829    3.7937    3.8059
    3.7608    3.7662    3.7727    3.7804    3.7895    3.8002    3.8123
    3.7675    3.7729    3.7794    3.7870    3.7961    3.8067    3.8187
    3.7742    3.7796    3.7860    3.7936    3.8026    3.8131    3.8251
    3.7808    3.7862    3.7926    3.8001    3.8090    3.8195    3.8314
    3.7874    3.7928    3.7991    3.8066    3.8155    3.8258    3.8377
    3.7940    3.7993    3.8056    3.8130    3.8218    3.8322    3.8439
    3.8005    3.8058    3.8120    3.8194    3.8282    3.8384    3.8501
    3.8070    3.8122    3.8184    3.8258    3.8345    3.8447    3.8563
    3.8134    3.8186    3.8248    3.8321    3.8407    3.8509    3.8624
    3.8198    3.8250    3.8311    3.8384    3.8470    3.8570    3.8685
    3.8262    3.8313    3.8374    3.8446    3.8531    3.8631    3.8745
    3.8325    3.8376    3.8436    3.8508    3.8593    3.8692    3.8806
    3.8387    3.8438    3.8498    3.8569    3.8654    3.8753    3.8865
    3.8450    3.8500    3.8560    3.8631    3.8715    3.8813    3.8925
    3.8512    3.8562    3.8621    3.8692    3.8775    3.8873    3.8984
    3.8573    3.8623    3.8682    3.8752    3.8835    3.8932    3.9043
    3.8634    3.8684    3.8742    3.8812    3.8894    3.8991    3.9101
    3.8695    3.8744    3.8803    3.8872    3.8954    3.9050    3.9159
    3.8756    3.8804    3.8862    3.8931    3.9013    3.9108    3.9217
    3.8816    3.8864    3.8922    3.8990    3.9071    3.9166    3.9274
    3.8875    3.8924    3.8981    3.9049    3.9129    3.9224    3.9331
    3.8935    3.8983    3.9040    3.9107    3.9187    3.9281    3.9388
    3.8994    3.9041    3.9098    3.9165    3.9245    3.9338    3.9444
    3.9052    3.9100    3.9156    3.9223    3.9302    3.9395    3.9501
    3.9111    3.9158    3.9214    3.9280    3.9359    3.9451    3.9556
    3.9169    3.9216    3.9271    3.9337    3.9416    3.9507    3.9612
    3.9226    3.9273    3.9328    3.9394    3.9472    3.9563    3.9667
    3.9284    3.9330    3.9385    3.9450    3.9528    3.9618    3.9722
    3.9341    3.9387    3.9441    3.9506    3.9583    3.9674    3.9776
    3.9397    3.9443    3.9498    3.9562    3.9639    3.9728    3.9831
    3.9454    3.9499    3.9553    3.9618    3.9694    3.9783    3.9885
    3.9510    3.9555    3.9609    3.9673    3.9748    3.9837    3.9938
    3.9566    3.9611    3.9664    3.9728    3.9803    3.9891    3.9992
    3.9621    3.9666    3.9719    3.9782    3.9857    3.9945    4.0045
    3.9676    3.9721    3.9773    3.9836    3.9911    3.9998    4.0098
    3.9731    3.9775    3.9828    3.9890    3.9964    4.0051    4.0150
    3.9785    3.9829    3.9882    3.9944    4.0018    4.0104    4.0202
    3.9840    3.9883    3.9935    3.9997    4.0071    4.0156    4.0255
    3.9894    3.9937    3.9989    4.0050    4.0123    4.0209    4.0306
    3.9947    3.9990    4.0042    4.0103    4.0176    4.0261    4.0358
    4.0000    4.0044    4.0095    4.0156    4.0228    4.0312    4.0409
    4.0054    4.0096    4.0147    4.0208    4.0280    4.0364    4.0460
    4.0106    4.0149    4.0200    4.0260    4.0331    4.0415    4.0511
    4.0159    4.0201    4.0252    4.0312    4.0383    4.0466    4.0561
    4.0211    4.0253    4.0303    4.0363    4.0434    4.0517    4.0611
    4.0263    4.0305    4.0355    4.0414    4.0485    4.0567    4.0661
    4.0315    4.0356    4.0406    4.0465    4.0535    4.0617    4.0711
    4.0366    4.0408    4.0457    4.0516    4.0585    4.0667    4.0760
    4.0417    4.0459    4.0508    4.0566    4.0635    4.0717    4.0809
    4.0468    4.0509    4.0558    4.0616    4.0685    4.0766    4.0858
    4.0519    4.0560    4.0608    4.0666    4.0735    4.0815    4.0907
    4.0569    4.0610    4.0658    4.0716    4.0784    4.0864    4.0956
    4.0619    4.0660    4.0708    4.0765    4.0833    4.0913    4.1004
    4.0669    4.0710    4.0758    4.0815    4.0882    4.0961    4.1052
    4.0719    4.0759    4.0807    4.0863    4.0931    4.1010    4.1100
    4.0768    4.0808    4.0856    4.0912    4.0979    4.1058    4.1147
    4.0817    4.0857    4.0904    4.0961    4.1027    4.1105    4.1195
    4.0866    4.0906    4.0953    4.1009    4.1075    4.1153    4.1242
    4.0915    4.0954    4.1001    4.1057    4.1123    4.1200    4.1289
    4.0963    4.1003    4.1049    4.1105    4.1170    4.1247    4.1335
    4.1012    4.1051    4.1097    4.1152    4.1217    4.1294    4.1382
    4.1060    4.1098    4.1145    4.1199    4.1264    4.1341    4.1428
    4.1107    4.1146    4.1192    4.1246    4.1311    4.1387    4.1474
    4.1155    4.1193    4.1239    4.1293    4.1358    4.1433    4.1520
    4.1202    4.1240    4.1286    4.1340    4.1404    4.1479    4.1565
    4.1249    4.1287    4.1333    4.1386    4.1450    4.1525    4.1611
    4.1296    4.1334    4.1379    4.1433    4.1496    4.1571    4.1656
    4.1343    4.1380    4.1425    4.1479    4.1542    4.1616    4.1701
    4.1389    4.1427    4.1471    4.1524    4.1587    4.1661    4.1746
    4.1435    4.1473    4.1517    4.1570    4.1633    4.1706    4.1790
    4.1481    4.1518    4.1563    4.1615    4.1678    4.1751    4.1835
    4.1527    4.1564    4.1608    4.1661    4.1723    4.1796    4.1879
    4.1573    4.1610    4.1653    4.1706    4.1767    4.1840    4.1923
    4.1618    4.1655    4.1698    4.1750    4.1812    4.1884    4.1967
    4.1663    4.1700    4.1743    4.1795    4.1856    4.1928    4.2010
    4.1708    4.1744    4.1788    4.1839    4.1900    4.1972    4.2054
    4.1753    4.1789    4.1832    4.1883    4.1944    4.2015    4.2097
    4.1797    4.1833    4.1876    4.1927    4.1988    4.2059    4.2140
    4.1842    4.1878    4.1920    4.1971    4.2031    4.2102    4.2183
    4.1886    4.1922    4.1964    4.2015    4.2075    4.2145    4.2226
    4.1930    4.1965    4.2008    4.2058    4.2118    4.2188    4.2268
    4.1974    4.2009    4.2051    4.2101    4.2161    4.2231    4.2310
    4.2017    4.2053    4.2094    4.2144    4.2204    4.2273    4.2353
    4.2061    4.2096    4.2138    4.2187    4.2246    4.2315    4.2395
    4.2104    4.2139    4.2180    4.2230    4.2289    4.2358    4.2436
    4.2147    4.2182    4.2223    4.2272    4.2331    4.2399    4.2478
    4.2190    4.2224    4.2266    4.2315    4.2373    4.2441    4.2519
    4.2232    4.2267    4.2308    4.2357    4.2415    4.2483    4.2561
    4.2275    4.2309    4.2350    4.2399    4.2456    4.2524    4.2602
    4.2317    4.2351    4.2392    4.2441    4.2498    4.2566    4.2643
    4.2359    4.2393    4.2434    4.2482    4.2539    4.2607    4.2683
    4.2401    4.2435    4.2475    4.2524    4.2581    4.2648    4.2724
    4.2443    4.2477    4.2517    4.2565    4.2622    4.2688    4.2764
    4.2485    4.2518    4.2558    4.2606    4.2662    4.2729    4.2805
    4.2526    4.2559    4.2599    4.2647    4.2703    4.2769    4.2845
    4.2567    4.2601    4.2640    4.2688    4.2744    4.2810    4.2885
    4.2608    4.2641    4.2681    4.2728    4.2784    4.2850    4.2925
    4.2649    4.2682    4.2722    4.2769    4.2824    4.2890    4.2964
    4.2690    4.2723    4.2762    4.2809    4.2864    4.2929    4.3004
    4.2730    4.2763    4.2802    4.2849    4.2904    4.2969    4.3043
    4.2771    4.2804    4.2843    4.2889    4.2944    4.3008    4.3082
    4.2811    4.2844    4.2882    4.2929    4.2983    4.3048    4.3121
    4.2851    4.2884    4.2922    4.2968    4.3023    4.3087    4.3160
    4.2891    4.2923    4.2962    4.3008    4.3062    4.3126    4.3199

  Column 15

   -6.9078
    0.2762
    0.6704
    0.9097
    1.0852
    1.2250
    1.3418
    1.4426
    1.5314
    1.6109
    1.6830
    1.7491
    1.8100
    1.8667
    1.9196
    1.9693
    2.0162
    2.0606
    2.1027
    2.1428
    2.1811
    2.2177
    2.2528
    2.2865
    2.3190
    2.3502
    2.3804
    2.4096
    2.4378
    2.4651
    2.4916
    2.5173
    2.5423
    2.5666
    2.5902
    2.6133
    2.6357
    2.6576
    2.6790
    2.6998
    2.7202
    2.7402
    2.7597
    2.7788
    2.7975
    2.8158
    2.8337
    2.8513
    2.8686
    2.8855
    2.9021
    2.9185
    2.9345
    2.9503
    2.9658
    2.9810
    2.9960
    3.0107
    3.0252
    3.0395
    3.0536
    3.0674
    3.0811
    3.0945
    3.1078
    3.1208
    3.1337
    3.1464
    3.1590
    3.1714
    3.1836
    3.1905
    3.1957
    3.2077
    3.2195
    3.2311
    3.2427
    3.2541
    3.2653
    3.2765
    3.2875
    3.2984
    3.3092
    3.3199
    3.3304
    3.3409
    3.3512
    3.3614
    3.3716
    3.3816
    3.3915
    3.4014
    3.4111
    3.4207
    3.4303
    3.4397
    3.4491
    3.4584
    3.4676
    3.4767
    3.4857
    3.4947
    3.5035
    3.5123
    3.5210
    3.5297
    3.5383
    3.5467
    3.5552
    3.5635
    3.5718
    3.5800
    3.5882
    3.5962
    3.6043
    3.6122
    3.6201
    3.6279
    3.6357
    3.6434
    3.6510
    3.6586
    3.6662
    3.6736
    3.6811
    3.6884
    3.6957
    3.7030
    3.7102
    3.7174
    3.7245
    3.7315
    3.7385
    3.7455
    3.7524
    3.7592
    3.7661
    3.7728
    3.7795
    3.7862
    3.7928
    3.7994
    3.8059
    3.8124
    3.8188
    3.8252
    3.8316
    3.8378
    3.8441
    3.8503
    3.8565
    3.8626
    3.8687
    3.8747
    3.8807
    3.8867
    3.8926
    3.8986
    3.9044
    3.9103
    3.9161
    3.9218
    3.9276
    3.9333
    3.9390
    3.9446
    3.9502
    3.9558
    3.9613
    3.9668
    3.9723
    3.9778
    3.9832
    3.9886
    3.9940
    3.9993
    4.0046
    4.0099
    4.0152
    4.0204
    4.0256
    4.0308
    4.0359
    4.0410
    4.0461
    4.0512
    4.0562
    4.0613
    4.0663
    4.0712
    4.0762
    4.0811
    4.0860
    4.0909
    4.0957
    4.1005
    4.1053
    4.1101
    4.1149
    4.1196
    4.1243
    4.1290
    4.1337
    4.1383
    4.1429
    4.1475
    4.1521
    4.1567
    4.1612
    4.1657
    4.1702
    4.1747
    4.1792
    4.1836
    4.1880
    4.1924
    4.1968
    4.2012
    4.2055
    4.2098
    4.2141
    4.2184
    4.2227
    4.2269
    4.2312
    4.2354
    4.2396
    4.2438
    4.2479
    4.2521
    4.2562
    4.2603
    4.2644
    4.2685
    4.2725
    4.2766
    4.2806
    4.2846
    4.2886
    4.2926
    4.2965
    4.3005
    4.3044
    4.3083
    4.3122
    4.3161
    4.3200
    4.3239
    4.3277

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 2nd Stage Optimization for Risky + Safe Asset (Save + Borr) Interpolated-Percentage
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkbz_evf(varargin)
%% FF_IPWKBZ_EVF solves the k' vs b' problem given aggregate savings
% This function follows the structure set up here:
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html
% ff_wkz_evf> but now we solve the second stage with percentage choice grid
%
% We solve along a vector of w_n vector, that is an interpolation vector,
% not a vector of actual w choices picked in the first stage. k' choices
% are in terms of percentages. Compared to ff_wkz_evf where we only had an
% upper triangle of choices, now we have a full matrix of percentage
% choices.
%
% @param mt_val matrix state_n I^2 by shock_n. This is the value
% matrix each row is a feasible reachable state given the choice
% vectors/matrix and each column is a shock state.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @return mt_ev_condi_z_max matrix choice_w_n by shock_n
% max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the
% optimal k' choice (w=k'+b') what is the expected utility? This is the
% value result from the 2nd stage problem. Note the result integrates over
% z'.
%
% @return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the
% argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k'
% choices, which index maximized conditional on z and w integrating over
% z'/
%
% @return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m ffs_ipwkbz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m ffs_ipwkbz_get_funcgrid>
%

%% Default

params_len = length(varargin);
bl_input_override = 0;
if (params_len == 5)
    bl_input_override = varargin{5};
end
if (bl_input_override)
    % override when called from outside
    [mt_val, param_map, support_map, armt_map, ~] = varargin{:};
else
    clear all;
    close all;
    
    % Not default parameters, but parameters that generate defaults
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);
    
    support_map('bl_graph_evf') = true;
    support_map('bl_display_evf') = true;
        
    param_map('it_ak_perc_n') = 250;
    param_map('fl_w_interp_grid_gap') = (param_map('fl_w_max')-param_map('fl_b_bd'))/param_map('it_ak_perc_n');    

    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generating Defaults
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z'});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {'f_util_standin', 'f_coh'});
    [f_util_standin, f_coh] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
    mt_coh = f_coh(ar_z, ar_a_meshk, ar_k_mesha);
       
end

%% Parse Parameters
params_group = values(armt_map, {'mt_z_trans', 'ar_z',...
    'ar_w_level', 'ar_k_mesha', 'ar_a_meshk', 'mt_k'});
[mt_z_trans, ar_z, ar_w_level, ...
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {'it_z_n', 'fl_nan_replace', 'fl_b_bd'});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {'bl_graph_onebyones','bl_display_evf', 'bl_graph_evf'});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {'bl_img_save', 'st_img_path', 'st_img_prefix', 'st_img_name_main', 'st_img_suffix'});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

% append function name
st_func_name = 'ff_ipwkbz_evf';
st_img_name_main = [st_func_name st_img_name_main];

%% Integrate *E(V(coh(k',b'), z')|z, w)*
% Each column for a different state z, each value *E(V(coh,z')|z)* integrated already
% Here, each column is a current z, more to right higher EV
% dim(mt_ev_condi_z): *Q by M*
% Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be
% what we do in the
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbz/paramfunc/html/ffs_ipwkbz_set_functions.html
% ffs_ipwkbz_set_functions> code where we loop over current z, and for each
% current z, grab out a particular row from the mt_z_trans that corresponds
% to a current shock's transition into all future states.
%
% here, each column of mt_val corresponds to a state z, think of that as
% future state z. The input mt_val is *V(coh, z)*, we need to integrate to
% get *E(V(coh,z')|z)*.
%

mt_ev_condi_z = mt_val*mt_z_trans';
if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z: Q by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));
end

%% Reshape *E(V(coh,z'|z,w))* to allow for maxing
% dim(mt_ev_condi_z): *IxJ by M*

[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);

%% Maximize *max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))* optimal value and index
% Maximization, find optimal k'/b' combination given z and w=k'+b'

[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_full: J by IxM');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_full));
%     disp(head(array2table(mt_ev_condi_z_full), 20));
%     disp(tail(array2table(mt_ev_condi_z_full), 20));
        
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));
    

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
    
end

%% Reindex K' and B' Choices for each State at the Optimal *w'=k'+b'* choice
% The K' and B' Optimal Choices Associated with EV opti
% dim(mt_ev_condi_z_max_kp): *I by M*
ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));    
end

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_kp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));        
    
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_bp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));    
end

%% Graph

if (bl_graph_evf)
    
    %% Graph 1, V and EV
    if (~bl_graph_onebyones)
        figure('PaperPosition', [0 0 14 4]);
        hold on;
    end
    
    
    for subplot_j=1:1:2
        
        if (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (subplot_j==1)
            chart = plot(mt_val);
        end
        if (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        end
        
        clr = jet(numel(chart));
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legend(chart(legend2plot), legendCell(legend2plot), 'Location','southeast');
        
        if (subplot_j==1)
            title('V(coh,zp); w(k+b),k,z');
        end
        if (subplot_j==2)
            title('E_z(V(coh,zp|z))');
        end
        
        ylabel('Next Period Value');
        xlabel({'Index of Cash-on-Hand Discrete Point'...
            'Each Segment is a w=k+b; within segment increasing k'...
            'EV and V identical if shock is fully persistent'});
        grid on;
        grid minor;
    end
    
    % Share y axis
    if (~bl_graph_onebyones)
        linkaxes(hAxis,'y');
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_vev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 2, max(EV)
    
    if(~bl_graph_onebyones)
        figure('PaperPosition', [0 0 7 4]);
    end
    
    for sub_j=1:1:1
        
        if(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = 'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))';
        end
        
        if(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        hold on;
        
        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        for i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, ...
                'MarkerEdgeColor', clr(i_ctr,:), ...
                'MarkerFaceColor', clr(i_ctr,:));
        end
        
        grid on;
        grid minor;
        title(['2nd Stage Exp Value at Optimal K given W=K''+B'''])
        ylabel(st_y_label)
        xlabel({'Aggregate Savings'})
        
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legendCell{length(legendCell) + 1} = 'max-agg-save';
        legend(legendCell([ar_it_z_graph length(legendCell)]), 'Location','southeast');
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 3, at max(EV) optimal choice category, color regions, borrow save
    
    % Borrow Vs Save
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) > 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));
    
    figure('PaperPosition', [0 0 7 4]);
    % States: ar_w, ar_z
    % Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp
    hold on;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),...
        ar_z_mw(mt_it_borr_idx),...
        it_sca_size, 'blue', 'filled');
    %     legend([chart_br], {'Borrow'}, 'Location','northeast');
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        it_sca_size, 'black', 'filled');
    %     legend([chart_khalf], {'Save >0.5 K'}, 'Location','northeast');
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        it_sca_size, 'red', 'filled');
    %     legend([chart_sv], {'Save <0.5 K'}, 'Location','northeast');
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),...
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),...
        it_sca_size, 'yellow', 'filled');
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], ...
        {'Borrow','Save >0.5 K','Save <0.5 K', 'k=0 or k=nan'}, 'Location','northeast');
    title('Borrow and Save Regions')
    ylabel('Shocks')
    xlabel({'Total Savings w=k+b'})
    grid on;
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxbrsv' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 4, Optimal K' and B' Levels
    
    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    for sub_j=1:1:4
        
        if (bl_graph_onebyones)
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (sub_j==1)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j);
            end
            mt_y = mt_ev_condi_z_max_bp;
        end
        if (sub_j==2)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            end
            
            mt_y = mt_ev_condi_z_max_kp;
        end
        if (sub_j==3)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j-2);
            end
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        end
        if (sub_j==4)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            end
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        end
        
        hold on;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));
        
        if (length(ar_w_level) <= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
        end
        
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        grid on;
        if (sub_j<=2)
            hline = refline([1 0]);
            hline.Color = 'k';
            hline.LineStyle = ':';
            hline.HandleVisibility = 'off';
        end
        
        if (sub_j==1)
            title('B Choices of W');
            ylabel('B Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==2)
            title('K Choices of W');
            ylabel('K Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        
        if (sub_j==3)
            title('B Fraction of Borrow Max and Save');
            ylabel('B/bar(B) if br or B/W if sv');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==4)
            title('K Fraction Choices of Total K Possible');
            ylabel('K/(W-bar(b)) ');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northeast');
        end
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_wkbopti' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
end

end

##### SOURCE END #####
--></body></html>