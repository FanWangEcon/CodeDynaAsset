
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Risky + Safe Asset (Save + Borr) Interpolated-Percentage (Optimized-Vectorized)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-27"><meta name="DC.source" content="ff_ipwkbz_vf_vecsv.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Risky + Safe Asset (Save + Borr) Interpolated-Percentage (Optimized-Vectorized)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Pre-calculate u(c)</a></li><li><a href="#9">Iterate Value Function</a></li><li><a href="#11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</a></li><li><a href="#12">Solve Second Stage Problem k*(w,z)</a></li><li><a href="#13">Solve First Stage Problem w*(z) given k*(w,z)</a></li><li><a href="#15">A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)</a></li><li><a href="#16">B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp</a></li><li><a href="#17">C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))</a></li><li><a href="#18">D. Compute FULL U(coh_level, w_perc, z) over all w_perc</a></li><li><a href="#19">E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)</a></li><li><a href="#20">F. Store Results</a></li><li><a href="#22">Check Tolerance and Continuation</a></li><li><a href="#24">Process Optimal Choices</a></li><li><a href="#25">Display Various Containers</a></li><li><a href="#27">Display 1 support_map</a></li><li><a href="#28">Display 2 armt_map</a></li><li><a href="#29">Display 3 param_map</a></li><li><a href="#30">Display 4 func_map</a></li><li><a href="#31">Display 5 result_map</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_ipwkbz_vf_vecsv(varargin)
</pre><h2 id="2">FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the two step solution with interpolation and with percentage asset grids version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html">ff_iwkz_vf_vecsv</a>. See that file for more descriptions.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ff_ipwkbz_evf.m">ff_ipwkbz_evf</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m">ffs_ipwkbz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m">ffs_ipwkbz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

<span class="comment">% parameters can be set inside ffs_ipwkbz_set_default_param or updated here</span>
<span class="comment">% param_map('it_w_perc_n') = 50;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('it_z_n') = 15;</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.025;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 0.001;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.25;</span>
<span class="comment">% param_map('it_w_perc_n') = 100;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('it_z_n') = 11;</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.1;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 10^-4;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.1;</span>

<span class="comment">% get armt and func map</span>
[armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkbz_vf_vecsv'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_w_perc'</span>, <span class="string">'ar_w_level'</span>, <span class="string">'ar_z'</span>});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {<span class="string">'ar_interp_c_grid'</span>, <span class="string">'ar_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z'</span>, <span class="string">'mt_z_mesh_coh_interp_grid'</span>,<span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>,<span class="keyword">...</span>
    <span class="string">'mt_w_by_interp_coh_interp_grid'</span>});
[ar_interp_c_grid, ar_interp_coh_grid, ar_a_meshk, ar_k_mesha, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_w_perc,<span class="keyword">...</span>
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {<span class="string">'mt_coh_wkb'</span>, <span class="string">'mt_z_mesh_coh_wkb'</span>});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'fl_c_min'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_wprime'</span>});
[it_z_n, fl_crra, fl_beta, fl_nan_replace, fl_c_min, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display_defparam'</span>, <span class="string">'bl_graph_evf'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display_defparam, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));

<span class="comment">% We did not need these in ff_oz_vf or ff_oz_vf_vec</span>
<span class="comment">% see</span>
<span class="comment">% &lt;https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html</span>
<span class="comment">% fs_u_c_partrepeat_main&gt; for why store using cells.</span>
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
<span class="keyword">for</span> it_z_i = 1:length(ar_z)
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
<span class="keyword">end</span>
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Pre-calculate u(c)</h2><p>Interpolation, see <a href="https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html">fs_u_c_partrepeat_main</a> for why interpolate over u(c)</p><pre class="codeinput"><span class="comment">% Evaluate</span>
<span class="keyword">if</span> (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
<span class="keyword">else</span>
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
<span class="keyword">end</span>
ar_interp_u_of_c_grid(ar_interp_c_grid &lt;= fl_c_min) = fl_u_cmin;

<span class="comment">% Get Interpolant</span>
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, <span class="string">'spline'</span>, <span class="string">'nearest'</span>);
</pre><h2 id="9">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</h2><p>v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see ffs_ipwkbz_get_funcgrid.m. Generate interpolant based on that, Then interpolate for the coh reachable levels given the k(w,z) percentage choice grids in the second stage of the problem</p><pre class="codeinput">    <span class="comment">% Generate Interpolant for v(coh,z)</span>
    f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

    <span class="comment">% Interpolate for v(coh(k(w,z),b(w,z),z),z)</span>
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
<span class="comment">%     ar_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb(:), mt_coh_wkb(:));</span>
<span class="comment">%     mt_val_wkb_interpolated = reshape(ar_val_wkb_interpolated, size(mt_z_mesh_coh_wkb));</span>
</pre><h2 id="12">Solve Second Stage Problem k*(w,z)</h2><p>This is the key difference between this function and <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> which solves the two stages jointly Interpolation first, because solution coh grid is not the same as all points reachable by k and b choices given w.</p><pre class="codeinput">    support_map(<span class="string">'bl_graph_evf'</span>) = false;
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        support_map(<span class="string">'bl_graph_evf'</span>) = bl_graph_evf;
    <span class="keyword">end</span>
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = <span class="keyword">...</span>
        ff_ipwkbz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
</pre><h2 id="13">Solve First Stage Problem w*(z) given k*(w,z)</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:length(ar_z)
</pre><h2 id="15">A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)</h2><p>Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z) There are two w=k'+b' arrays. ar_w_level is the level even grid based on which we solve the 2nd stage problem in ff_ipwkbz_evf.m. Here for each coh level, we have a different vector of w levels, but the same vector of percentage ws. So we need to interpolate to get the optimal k* and b* choices at each percentage level of w.</p><pre class="codeinput">        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

        <span class="comment">% Interpolate (2), shift from w_level to w_perc</span>
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;

        <span class="comment">% changes in w_perc kstar choices</span>
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);
</pre><h2 id="16">B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp</h2><p>Note that compared to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> the mt_c here is much smaller the same number of columns (states) as in the ffs_akz_set_functions file, but the number of rows equal to ar_w length.</p><pre class="codeinput">        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), <span class="keyword">...</span>
                      mt_w_astar_interp_z(mt_w_kstar_diff_idx), <span class="keyword">...</span>
                      mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c &lt;= fl_c_min);
        <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        <span class="comment">% Update Storage</span>
        <span class="keyword">if</span> (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        <span class="keyword">else</span>
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        <span class="keyword">end</span>
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;
</pre><h2 id="17">C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))</h2><p>Generate Interpolant for (3) EV(k*(ar_w_perc),Z)</p><pre class="codeinput">        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);
        <span class="comment">% Interpolate (3), EVAL add on future utility, N by N + N by N</span>
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);
</pre><h2 id="18">D. Compute FULL U(coh_level, w_perc, z) over all w_perc</h2><pre class="codeinput">        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        <span class="comment">% Index update</span>
        <span class="comment">% using the method below is much faster than index replace</span>
        <span class="comment">% see &lt;https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript&gt;</span>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        <span class="comment">% Default or Not Utility Handling</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if default: only today u(cmin), transition out next period, debt wiped out</span>
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed: v = u(cmin)</span>
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        <span class="keyword">end</span>

        <span class="comment">% percentage algorithm does not have invalid (check to make sure</span>
        <span class="comment">% min percent is not 0 in ffs_ipwkbz_get_funcgrid.m)</span>
        <span class="comment">% mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);</span>
</pre><h2 id="19">E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)</h2><p>Optimization: remember matlab is column major, rows must be choices, columns must be states <a href="https://en.wikipedia.org/wiki/Row-_and_column-major_order">COLUMN-MAJOR</a></p><pre class="codeinput">        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        <span class="comment">% Generate Linear Opti Index</span>
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        <span class="comment">% Handle Default is optimal or not</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
            <span class="comment">% to default, non-default possible, but default could be optimal</span>
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_opti_kprime;
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed, then next period same state as now</span>
            <span class="comment">% this is absorbing state, this is the limiting case, single</span>
            <span class="comment">% state space point, lowest a and lowest shock has this.</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = min(ar_a_meshk);
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = min(ar_k_mesha);
        <span class="keyword">end</span>
</pre><h2 id="20">F. Store Results</h2><pre class="codeinput">        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        <span class="keyword">end</span>
</pre><pre class="codeinput">    <span class="keyword">end</span>
</pre><h2 id="22">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
                                      mean(mt_pol_a_cur,1); <span class="keyword">...</span>
                                      mean(mt_pol_k_cur,1); <span class="keyword">...</span>
                                      mt_val_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_ameshk_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><h2 id="24">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_idx'</span>) = mt_pol_idx;

result_map(<span class="string">'cl_mt_coh'</span>) = {mt_interp_coh_grid_mesh_z, zeros(1)};
result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_pol_k'</span>) = {mt_pol_k, zeros(1)};
result_map(<span class="string">'cl_mt_pol_c'</span>) = {f_cons(mt_interp_coh_grid_mesh_z, mt_pol_a, mt_pol_k), zeros(1)};
result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_coh"</span>, <span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_pol_k"</span>, <span class="string">"cl_mt_pol_c"</span>];


<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    armt_map(<span class="string">'mt_coh_wkb_ori'</span>) = mt_coh_wkb;
    armt_map(<span class="string">'ar_a_meshk_ori'</span>) = ar_a_meshk;
    armt_map(<span class="string">'ar_k_mesha_ori'</span>) = ar_k_mesha;

    <span class="comment">% graphing based on coh_wkb, but that does not match optimal choice</span>
    <span class="comment">% matrixes for graphs.</span>
    armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_interp_coh_grid_mesh_z;
    armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_interp_coh_grid);
    armt_map(<span class="string">'ar_a_meshk'</span>) = mt_interp_coh_grid_mesh_z(:,1);
    armt_map(<span class="string">'ar_k_mesha'</span>) = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: (sum((mt_pol_a ~= mt_pol_a_cur))+sum((mt_pol_k ~= mt_pol_k_cur)))/(2*it_ameshk_n):percentage of state space points conditional on shock where the policy function is changing across iterations
                 valgap      polgap        z1           z2           z3           z4           z5           z6           z7           z8           z9           z10          z11          z12          z13          z14          z15   
                _________    _______    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________

    iter=1         179.68     2146.7            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=2         173.52     2427.7            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=3         133.72     884.15      0.98316      0.98316      0.98446      0.98446      0.98575      0.98705      0.98705      0.98834      0.98964      0.98834      0.98964      0.99158      0.99093      0.99028      0.99223
    iter=4         108.39     438.54       0.9715       0.9715       0.9728      0.97409      0.97668      0.97798      0.98187      0.98316      0.98187      0.98187      0.98251      0.98187      0.98381      0.98834      0.98769
    iter=5         91.272     262.58      0.95337      0.95466      0.95725      0.95855      0.96114      0.96373      0.96762      0.96891       0.9728      0.96956      0.97927      0.97409      0.98187      0.98316      0.99547
    iter=6         78.322     191.53      0.93912      0.93912      0.94171       0.9443      0.94689      0.95078      0.95466       0.9592      0.96244      0.96567      0.96503      0.97539       0.9728      0.97409      0.97668
    iter=7         67.711     136.21      0.92617      0.93005      0.93264       0.9443       0.9456       0.9456      0.94624      0.94754      0.95402      0.96114      0.96503      0.95855      0.96503      0.97474      0.97409
    iter=8         59.066     101.89      0.84585      0.84326      0.87565      0.81606      0.53238      0.44041      0.43523      0.82254      0.87694      0.91062      0.92358      0.89508      0.95402      0.73381       0.7513
    iter=9         51.742     81.796      0.31736      0.31606      0.28497      0.31347      0.58938      0.68653      0.77979      0.81477      0.85363      0.84067      0.80052      0.57254      0.41839      0.55959      0.68782
    iter=10        45.504     86.187      0.63472      0.64896      0.70466      0.73446      0.75777      0.78886      0.36658      0.27979      0.24482      0.26036      0.31218      0.67746      0.69236       0.6956      0.74158
    iter=11        40.158      60.96      0.18653      0.18264      0.17098      0.16839       0.1671      0.16192      0.60104      0.70596      0.76684      0.76813      0.50907       0.2772      0.34326        0.375      0.27979
    iter=12        35.504     48.863      0.37176      0.32383      0.27202      0.24352      0.22539      0.19689       0.1943      0.16969      0.16192      0.21244      0.48187      0.66321      0.57902      0.32772      0.46244
    iter=13        31.496     69.972       0.3614      0.42487      0.50648      0.56282      0.62694      0.68782      0.44689      0.21632      0.18912      0.15415      0.14767      0.20855      0.37953      0.42228      0.39767
    iter=14        28.004     50.215      0.09456     0.093264      0.10104      0.10363      0.10233      0.10751      0.41451      0.67358      0.72539      0.38601      0.19301      0.15155      0.15803      0.28238      0.18264
    iter=15        24.923       41.1      0.10363     0.099741      0.10168      0.11658       0.1101      0.11399      0.11917      0.12047      0.13472      0.50259      0.61917      0.37435      0.18912      0.12306       0.2908
    iter=16        22.208     35.731      0.13212      0.12565      0.12824       0.1101      0.10751      0.11399      0.12176      0.10233      0.11658      0.10104      0.20725      0.47021      0.35492      0.26554      0.15285
    iter=17        19.817     34.939       0.4171       0.1943      0.14961      0.13018      0.13472      0.12694     0.098446     0.098446      0.11658     0.093264      0.10492      0.13601      0.38342      0.26166      0.25389
    iter=18        17.733      47.66      0.15933      0.40285      0.47668      0.53368      0.22668      0.12176       0.1101       0.1114     0.085492     0.098446     0.080311      0.09456      0.15415      0.31347       0.1956
    iter=19         15.89     44.736     0.050518     0.051813     0.055699     0.051813      0.41839      0.55959      0.28886       0.1114      0.10104      0.07513     0.064767     0.076425     0.072539      0.18005      0.24741
    iter=20        14.257     32.861     0.041451     0.046632     0.047927     0.040155     0.037565      0.05829      0.37694       0.3899      0.22668     0.084197     0.068653     0.054404     0.062824     0.098446      0.12694
    iter=21        12.801     28.789     0.037565     0.037565     0.049223     0.045337      0.03886     0.040155     0.040155       0.2785      0.28756      0.24482       0.1399     0.060881     0.051813     0.071244      0.14249
    iter=22        11.508     24.675      0.03886     0.037565     0.033679     0.029793     0.029793     0.032383     0.034974     0.036269      0.26554      0.21373      0.18264      0.12435     0.067358     0.047927     0.072539
    iter=23        10.362     23.796     0.032383     0.034974     0.028497     0.028497     0.032383     0.015544     0.029793     0.044041     0.041451      0.21503      0.16839      0.15544      0.11658     0.045337     0.059585
    iter=24        9.3456     21.498     0.036269     0.022021     0.015544     0.025907     0.025907     0.029793     0.020725     0.020725     0.018135      0.11658      0.13342      0.14637      0.11528      0.11528     0.041451
    iter=25          8.44     15.991     0.046632     0.027202     0.023316     0.023316     0.020725     0.020725     0.034974     0.027202     0.022021     0.020725      0.12176      0.11788      0.10622      0.10622      0.10492
    iter=26        7.6294     25.725     0.032383     0.031088     0.022021     0.016839     0.020725     0.015544     0.016839     0.016839     0.018135     0.018135      0.13601     0.098446     0.089378     0.099741      0.09456
    iter=27         6.899     23.069     0.028497     0.027202     0.018135     0.018135     0.016839     0.014249    0.0090674     0.015544     0.012953      0.01943     0.023316     0.081606     0.073834     0.085492     0.082902
    iter=28        6.2374      22.46      0.03044     0.021373     0.011658     0.020725     0.014249     0.010363     0.018135     0.014249     0.015544     0.014249     0.011658     0.069948     0.088083     0.072539     0.072539
    iter=29        5.6354      10.71     0.025907     0.018135     0.028497    0.0090674     0.014249     0.007772    0.0051813     0.012953     0.022021    0.0090674     0.012953     0.071244     0.067358     0.054404     0.056995
    iter=30        5.0869     9.7328     0.016839     0.011658     0.014249     0.012953    0.0051813    0.0090674    0.0090674    0.0090674     0.012953    0.0064767     0.016839     0.072539     0.051813     0.041451     0.042746
    iter=31        4.5864     24.132     0.016839      0.01943     0.014249     0.007772     0.007772    0.0025907    0.0051813    0.0064767     0.014249     0.007772      0.01943     0.010363      0.05829     0.045337     0.050518
    iter=32        4.1297     7.5767      0.01943     0.014249     0.011658     0.010363    0.0064767     0.010363     0.003886    0.0025907    0.0025907     0.014249    0.0064767    0.0090674     0.056995      0.03886     0.040155
    iter=33        3.7135     8.1135     0.018135     0.010363     0.011658    0.0064767     0.007772     0.003886    0.0090674     0.007772    0.0025907     0.007772     0.010363    0.0064767      0.05829     0.044041     0.028497
    iter=34         3.335     15.607      0.07772     0.012953     0.007772     0.016839    0.0025907    0.0012953     0.003886    0.0090674    0.0064767    0.0051813     0.007772     0.014249     0.051813     0.033679     0.023316
    iter=35        2.9918     13.823     0.072539     0.055699    0.0090674    0.0064767    0.0012953     0.003886    0.0051813    0.0051813    0.0090674    0.0025907     0.007772    0.0090674     0.033679     0.034974     0.031088
    iter=36        2.6808     14.213     0.080311     0.055699     0.041451     0.010363     0.007772    0.0025907    0.0012953     0.003886    0.0051813     0.007772     0.003886    0.0025907    0.0064767     0.020725     0.023316
    iter=37        2.3996     20.991      0.12694      0.05829     0.049223     0.014249     0.003886    0.0012953    0.0025907    0.0025907    0.0064767    0.0090674     0.007772    0.0090674     0.011658     0.047927     0.015544
    iter=38         2.146     14.001      0.12047     0.068653     0.045337      0.03886    0.0064767    0.0012953    0.0051813    0.0025907    0.0025907    0.0051813    0.0064767    0.0090674    0.0090674     0.055699     0.022021
    iter=39        1.9164     20.036            0     0.066062     0.046632     0.036269     0.016839    0.0025907            0    0.0090674    0.0064767    0.0051813    0.0090674     0.010363    0.0090674     0.046632     0.031088
    iter=40        1.7096     20.039            0     0.064767     0.041451     0.034974     0.031088    0.0012953     0.003886    0.0025907     0.010363    0.0090674     0.014249     0.003886    0.0064767     0.018135     0.015544
    iter=41        1.5229     12.634            0     0.073834     0.034974     0.028497     0.029793     0.010363    0.0051813    0.0025907    0.0051813    0.0025907    0.0012953     0.010363     0.003886     0.024611     0.014249
    iter=42        1.3556     10.617    0.0012953     0.068653     0.029793     0.027202     0.031088     0.027202     0.003886            0    0.0051813    0.0025907    0.0012953    0.0051813     0.010363     0.014249      0.01943
    iter=43        1.2051      25.53    0.0025907    0.0025907      0.01943     0.028497     0.023316     0.031088    0.0051813    0.0064767    0.0064767     0.010363     0.003886    0.0051813    0.0025907     0.014249     0.015544
    iter=44        1.0709     7.5475            0            0      0.01943     0.018135     0.020725     0.018135            0            0            0     0.007772    0.0012953    0.0025907    0.0012953     0.007772     0.010363
    iter=45       0.95109     6.6405            0            0      0.01943      0.01943     0.015544     0.027202     0.020725    0.0012953            0            0    0.0012953    0.0051813    0.0025907     0.007772     0.007772
    iter=46        0.8446     9.6033    0.0012953    0.0012953     0.015544     0.014249     0.018135     0.010363     0.016839            0    0.0025907    0.0012953    0.0025907    0.0025907    0.0064767    0.0051813      0.01943
    iter=47       0.75027     9.8151            0    0.0051813     0.014249     0.011658     0.011658     0.011658     0.011658            0    0.0025907    0.0051813    0.0012953    0.0051813            0     0.003886     0.012953
    iter=48       0.66675     6.0024    0.0051813    0.0012953     0.012953    0.0090674     0.014249    0.0090674     0.011658     0.003886            0    0.0051813     0.003886            0    0.0051813     0.003886    0.0064767
    iter=49        0.5929     7.0306    0.0012953            0     0.011658    0.0090674    0.0090674     0.010363     0.010363    0.0064767    0.0025907     0.007772    0.0012953    0.0012953     0.003886    0.0012953     0.010363
    iter=50       0.52765      9.114            0            0     0.010363    0.0051813    0.0064767     0.012953    0.0090674     0.011658    0.0025907            0            0    0.0064767            0     0.003886    0.0090674
    iter=79      0.029079          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=80      0.026879    0.31193            0            0            0            0            0            0            0            0            0    0.0025907            0            0            0            0            0
    iter=81      0.024876    0.11038            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0012953            0
    iter=82      0.023047     1.4104            0            0            0            0    0.0012953            0            0    0.0012953            0            0            0            0            0            0            0
    iter=83      0.021375     3.9181            0            0            0            0            0            0            0            0    0.0012953            0            0            0            0            0            0
    iter=84      0.019843     1.7536            0            0            0    0.0012953            0            0            0            0            0            0            0            0            0            0    0.0025907
    iter=85      0.018437          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=86      0.017144    0.75835            0            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0012953
    iter=87      0.015952     1.3266            0            0            0            0            0            0    0.0012953            0            0            0            0            0            0            0            0
    iter=88      0.014854          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=89      0.013839          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=90        0.0129     1.2448            0            0            0            0            0    0.0012953            0            0            0            0            0            0            0            0            0
    iter=91       0.01203          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=92      0.011224          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=93      0.010476    0.11856            0            0            0            0            0            0            0            0            0            0            0            0    0.0012953            0            0
    iter=94     0.0097818          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=95     0.0091363          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=96     0.0085359    0.50844            0            0            0    0.0012953            0            0            0            0            0            0            0            0            0            0            0
    iter=97     0.0079771          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=98     0.0074568          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=99     0.0069719          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=100    0.0065199          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=101    0.0060983          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=102     0.005705     3.1252            0            0            0            0    0.0012953            0            0            0            0            0            0            0            0            0            0
    iter=103    0.0053379          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=104    0.0049952          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=105    0.0046751          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=106    0.0043761          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=107    0.0040967          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=108    0.0038356          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=109    0.0035916          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=110    0.0033634          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=111    0.0031501          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=112    0.0029506          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=113     0.002764          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=114    0.0025894          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=115    0.0024261          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=116    0.0022733          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=117    0.0021303          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=118    0.0019965          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=119    0.0018712          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=120    0.0017539          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=121    0.0016442          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=122    0.0015414          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=123    0.0014451          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=124     0.001355          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=125    0.0012706          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=126    0.0011915          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=127    0.0011175          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=128    0.0010481          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0

tb_val: V(a,z) value at each state space point
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0            -9.948       -9.7084       -9.4239      -9.1066      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh2:k=-19.8996,b=0       -9.948       -9.7084       -9.4239      -9.1066      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh3:k=-19.7993,b=0       -9.948       -9.7084       -9.4239      -9.1066      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh4:k=-19.6989,b=0       -9.948       -9.7084       -9.4239      -9.1066      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh5:k=-19.5986,b=0       -9.948       -9.7084       -9.4239      -9.1066      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh6:k=-19.4982,b=0      -9.7911       -9.5867       -9.3512      -9.0918      -8.7546       -8.3721       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh7:k=-19.3978,b=0      -9.5449       -9.3405        -9.105      -8.8457       -8.566       -8.2675       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh8:k=-19.2975,b=0      -9.3537       -9.1493       -8.9138      -8.6544      -8.3747       -8.0763       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh9:k=-19.1971,b=0      -9.1995       -8.9951       -8.7596      -8.5002      -8.2205       -7.9221       -6.5528       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh10:k=-19.0968,b=0     -9.0718       -8.8674       -8.6319      -8.3725      -8.0928       -7.7943       -6.4337       -6.0415       -5.5171       -4.9871       -4.4637       -3.9723 
    coh11:k=-18.9964,b=0     -8.9637       -8.7593       -8.5238      -8.2645      -7.9848       -7.6863       -6.3256       -5.9515       -5.5171       -4.9871       -4.4637       -3.9723 
    coh12:k=-18.896,b=0      -8.8708       -8.6664       -8.4309      -8.1715      -7.8918       -7.5933       -6.2327       -5.8586        -5.476       -4.9871       -4.4637       -3.9723 
    coh13:k=-18.7957,b=0     -8.7897       -8.5853       -8.3498      -8.0904      -7.8107       -7.5123       -6.1516       -5.7775       -5.3949       -4.9871       -4.4637       -3.9723 
    coh14:k=-18.6953,b=0     -8.7181       -8.5137       -8.2782      -8.0189      -7.7392       -7.4407         -6.08        -5.706       -5.3234       -4.9375       -4.4637       -3.9723 
    coh15:k=-18.595,b=0      -8.6544         -8.45       -8.2145      -7.9552      -7.6755        -7.377       -6.0163       -5.6423       -5.2597       -4.8738       -4.4637       -3.9723 
    coh16:k=-18.4946,b=0     -8.5972       -8.3928       -8.1573      -7.8979      -7.6182       -7.3198       -5.9591        -5.585       -5.2024       -4.8165       -4.4378       -3.9723 
    coh17:k=-18.3942,b=0     -8.5454        -8.341       -8.1055      -7.8461      -7.5665        -7.268       -5.9073       -5.5332       -5.1506       -4.7647        -4.386       -3.9723 
    coh18:k=-18.2939,b=0     -8.4982       -8.2938       -8.0583       -7.799      -7.5193       -7.2208       -5.8601       -5.4861       -5.1035       -4.7176       -4.3389       -3.9723 
    coh19:k=-18.1935,b=0     -8.4551       -8.2507       -8.0152      -7.7558      -7.4762       -7.1777        -5.817       -5.4429       -5.0603       -4.6744       -4.2957       -3.9443 
    coh20:k=-18.0932,b=0     -8.4154        -8.211       -7.9755      -7.7161      -7.4364        -7.138       -5.7773       -5.4032       -5.0206       -4.6347        -4.256       -3.9046 
    coh21:k=-17.9928,b=0     -8.3787       -8.1743       -7.9388      -7.6794      -7.3998       -7.1013       -5.7406       -5.3665       -4.9839        -4.598       -4.2193       -3.8679 
    coh22:k=-17.8924,b=0     -8.3446       -8.1402       -7.9047      -7.6454      -7.3657       -7.0672       -5.7065       -5.3325       -4.9499        -4.564       -4.1853       -3.8339 
    coh23:k=-17.7921,b=0      -8.313       -8.1086       -7.8731      -7.6137       -7.334       -7.0355       -5.6749       -5.3008       -4.9182       -4.5323       -4.1536       -3.8022 
    coh24:k=-17.6917,b=0     -8.2834        -8.079       -7.8435      -7.5841      -7.3044       -7.0059       -5.6453       -5.2712       -4.8886       -4.5027        -4.124       -3.7726 
    coh25:k=-17.5914,b=0     -8.2556       -8.0512       -7.8157      -7.5564      -7.2767       -6.9782       -5.6175       -5.2435       -4.8609        -4.475       -4.0963       -3.7448 
    coh26:k=-17.491,b=0      -8.2296       -8.0252       -7.7897      -7.5303      -7.2506       -6.9522       -5.5915       -5.2174       -4.8348       -4.4489       -4.0702       -3.7188 
    coh27:k=-17.3906,b=0      -8.205       -8.0006       -7.7651      -7.5058      -7.2261       -6.9276       -5.5669       -5.1929       -4.8103       -4.4244       -4.0457       -3.6943 
    coh28:k=-17.2903,b=0     -8.1819       -7.9775        -7.742      -7.4826       -7.203       -6.9045       -5.5438       -5.1697       -4.7871       -4.4012       -4.0225       -3.6711 
    coh29:k=-17.1899,b=0       -8.16       -7.9556       -7.7201      -7.4607      -7.1811       -6.8826       -5.5219       -5.1478       -4.7652       -4.3793       -4.0006       -3.6492 
    coh30:k=-17.0896,b=0     -8.1392       -7.9348       -7.6993        -7.44      -7.1603       -6.8618       -5.5011       -5.1271       -4.7445       -4.3586       -3.9799       -3.6284 
    coh31:k=-16.9892,b=0     -8.1052       -7.8976        -7.657       -7.393      -7.1066       -6.8046       -5.4618       -5.1027       -4.7248       -4.3389       -3.9602       -3.6087 
    coh32:k=-16.8888,b=0     -8.0078        -7.802       -7.5649      -7.3055      -7.0247       -6.7242       -5.3983       -5.0441       -4.6836       -4.3201       -3.9414         -3.59 
    coh33:k=-16.7885,b=0     -7.9164       -7.7127       -7.4798      -7.2228      -6.9471       -6.6516       -5.3397       -4.9875       -4.6312        -4.273       -3.9223       -3.5721 
    coh34:k=-16.6881,b=0     -7.8322       -7.6316       -7.4001      -7.1459      -6.8736       -6.5823       -5.2837       -4.9355       -4.5811       -4.2257       -3.8783       -3.5551 
    coh35:k=-16.5878,b=0     -7.7528        -7.555       -7.3259      -7.0754      -6.8046       -6.5173       -5.2312       -4.8849        -4.534       -4.1812       -3.8354       -3.5158 
    coh36:k=-16.4874,b=0     -7.6792       -7.4818       -7.2554      -7.0083      -6.7404       -6.4558       -5.1812        -4.838       -4.4887       -4.1383       -3.7955       -3.4774 
    coh37:k=-16.387,b=0      -7.6095       -7.4139       -7.1902      -6.9435       -6.679       -6.3974       -5.1329       -4.7926        -4.446       -4.0977       -3.7567       -3.4406 
    coh38:k=-16.2867,b=0     -7.5438       -7.3502       -7.1288       -6.884      -6.6223       -6.3419       -5.0877       -4.7495       -4.4048       -4.0583       -3.7196       -3.4057 
    coh39:k=-16.1863,b=0     -7.4812       -7.2895       -7.0693      -6.8271      -6.5677       -6.2902        -5.044       -4.7084       -4.3658       -4.0209       -3.6834       -3.3598 
    coh40:k=-16.086,b=0      -7.4235       -7.2328       -7.0131      -6.7732       -6.515       -6.2403       -5.0028       -4.6686       -4.3279       -3.9845       -3.6475       -3.3003 
    coh41:k=-15.9856,b=0     -7.3685       -7.1785       -6.9606      -6.7227      -6.4658       -6.1935       -4.9632       -4.6309       -4.2917       -3.9496       -3.6042       -3.2349 
    coh42:k=-15.8852,b=0     -7.3154       -7.1262         -6.91      -6.6738      -6.4187       -6.1483       -4.9254       -4.5943       -4.2562       -3.9143       -3.5478       -3.1698 
    coh43:k=-15.7849,b=0     -7.2652       -7.0774       -6.8627      -6.6268      -6.3737       -6.1044        -4.889       -4.5595       -4.2222       -3.8739       -3.4898       -3.1056 
    coh44:k=-15.6845,b=0     -7.2173       -7.0307       -6.8173      -6.5825      -6.3311       -6.0634       -4.8539       -4.5256       -4.1882       -3.8217       -3.4328        -3.041 
    coh45:k=-15.5842,b=0     -7.1714       -6.9859       -6.7731      -6.5395      -6.2898       -6.0235       -4.8202       -4.4924       -4.1479       -3.7686        -3.375       -2.9752 
    coh46:k=-15.4838,b=0     -7.1284       -6.9438       -6.7314      -6.4992      -6.2509       -5.9856       -4.7873       -4.4598       -4.0977       -3.7155       -3.3161       -2.9077 
    coh47:k=-15.3834,b=0     -7.0868       -6.9027       -6.6911      -6.4602      -6.2128       -5.9491       -4.7553       -4.4158       -4.0455       -3.6605       -3.2561       -2.8408 
    coh48:k=-15.2831,b=0     -7.0472       -6.8631       -6.6526      -6.4229      -6.1762        -5.914        -4.722       -4.3634       -3.9929       -3.6064       -3.1971       -2.7747 
    coh49:k=-15.1827,b=0     -7.0089       -6.8255       -6.6159      -6.3873      -6.1413       -5.8804       -4.6703       -4.3116       -3.9413       -3.5532       -3.1388       -2.7081 
    coh50:k=-15.0824,b=0     -6.9715       -6.7889       -6.5803      -6.3525      -6.1073       -5.8478       -4.6174       -4.2605       -3.8907       -3.5003       -3.0796       -2.6406 
    coh723:k=52.3596,b=0      15.043        15.087        15.138       15.195       15.257        15.324        15.666        15.774        15.891        16.016        16.147        16.275 
    coh724:k=52.46,b=0        15.052        15.096        15.147       15.204       15.266        15.333        15.675        15.782        15.899        16.024        16.154        16.283 
    coh725:k=52.5603,b=0      15.061        15.105        15.157       15.213       15.275        15.342        15.683         15.79        15.907        16.031        16.162         16.29 
    coh726:k=52.6607,b=0      15.071        15.115        15.166       15.222       15.284        15.351        15.691        15.798        15.914        16.039        16.169        16.297 
    coh727:k=52.7611,b=0       15.08        15.124        15.175       15.231       15.293         15.36        15.699        15.806        15.922        16.047        16.177        16.304 
    coh728:k=52.8614,b=0       15.09        15.133        15.184        15.24       15.302        15.369        15.707        15.814         15.93        16.054        16.184        16.312 
    coh729:k=52.9618,b=0      15.099        15.143        15.193       15.249       15.311        15.378        15.716        15.822        15.938        16.062        16.192        16.319 
    coh730:k=53.0621,b=0      15.108        15.152        15.203       15.259        15.32        15.387        15.724         15.83        15.946         16.07        16.199        16.326 
    coh731:k=53.1625,b=0      15.118        15.161        15.212       15.268       15.329        15.395        15.732        15.838        15.954        16.077        16.206        16.334 
    coh732:k=53.2629,b=0      15.127         15.17        15.221       15.277       15.338        15.404         15.74        15.846        15.961        16.085        16.214        16.341 
    coh733:k=53.3632,b=0      15.136         15.18         15.23       15.286       15.346        15.413        15.748        15.854        15.969        16.093        16.221        16.348 
    coh734:k=53.4636,b=0      15.146        15.189        15.239       15.295       15.355        15.422        15.756        15.862        15.977          16.1        16.229        16.355 
    coh735:k=53.5639,b=0      15.155        15.198        15.248       15.304       15.364        15.431        15.764         15.87        15.985        16.108        16.236        16.362 
    coh736:k=53.6643,b=0      15.164        15.207        15.257       15.313       15.373        15.439        15.773        15.878        15.993        16.115        16.243        16.369 
    coh737:k=53.7647,b=0      15.173        15.216        15.266       15.322       15.382        15.448        15.781        15.886            16        16.123        16.251        16.376 
    coh738:k=53.865,b=0       15.183        15.225        15.276       15.331       15.391        15.457        15.789        15.894        16.008         16.13        16.258        16.384 
    coh739:k=53.9654,b=0      15.192        15.235        15.285        15.34         15.4        15.466        15.797        15.902        16.016        16.138        16.265        16.391 
    coh740:k=54.0657,b=0      15.201        15.244        15.294       15.349       15.409        15.474        15.805         15.91        16.023        16.145        16.273        16.398 
    coh741:k=54.1661,b=0       15.21        15.253        15.303       15.358       15.417        15.483        15.813        15.918        16.031        16.153         16.28        16.405 
    coh742:k=54.2665,b=0      15.219        15.262        15.312       15.366       15.426        15.492        15.821        15.925        16.039         16.16        16.287        16.412 
    coh743:k=54.3668,b=0      15.229        15.271        15.321       15.375       15.435          15.5        15.829        15.933        16.046        16.168        16.295        16.419 
    coh744:k=54.4672,b=0      15.238         15.28         15.33       15.384       15.444        15.509        15.837        15.941        16.054        16.175        16.302        16.426 
    coh745:k=54.5675,b=0      15.247        15.289        15.339       15.393       15.452        15.518        15.845        15.949        16.062        16.183        16.309        16.433 
    coh746:k=54.6679,b=0      15.253        15.295        15.345       15.399       15.459        15.524        15.853        15.957        16.069         16.19        16.316         16.44 
    coh747:k=54.7683,b=0      15.254        15.296        15.345         15.4        15.46        15.527        15.861        15.965        16.077        16.198        16.323        16.447 
    coh748:k=54.8686,b=0      15.258        15.301        15.352       15.408       15.469        15.535        15.869        15.972        16.085        16.205         16.33        16.453 
    coh749:k=54.969,b=0       15.267         15.31        15.361       15.416       15.477        15.544        15.877         15.98        16.092        16.212        16.338         16.46 
    coh750:k=55.0693,b=0      15.276        15.319         15.37       15.425       15.486        15.552        15.885        15.988          16.1         16.22        16.345        16.467 
    coh751:k=55.1697,b=0      15.285        15.328        15.378       15.434       15.495        15.561        15.892        15.996        16.107        16.227        16.352        16.475 
    coh752:k=55.2701,b=0      15.294        15.337        15.387       15.443       15.503        15.569          15.9        16.003        16.115        16.235        16.359        16.482 
    coh753:k=55.3704,b=0      15.303        15.346        15.396       15.451       15.512        15.578        15.908        16.011        16.122        16.242        16.366        16.488 
    coh754:k=55.4708,b=0      15.312        15.355        15.405        15.46        15.52        15.586        15.916        16.019         16.13        16.249        16.373        16.494 
    coh755:k=55.5711,b=0      15.321        15.364        15.414       15.469       15.529        15.595        15.924        16.026        16.138        16.257         16.38          16.5 
    coh756:k=55.6715,b=0       15.33        15.372        15.422       15.477       15.537        15.603        15.932        16.034        16.145        16.264        16.387        16.505 
    coh757:k=55.7719,b=0      15.339        15.381        15.431       15.486       15.546        15.612         15.94        16.042        16.153        16.271        16.393        16.511 
    coh758:k=55.8722,b=0      15.348         15.39         15.44       15.495       15.555         15.62        15.948        16.049         16.16        16.278          16.4        16.518 
    coh759:k=55.9726,b=0      15.356        15.399        15.449       15.503       15.563        15.628        15.955        16.057        16.167        16.285        16.407        16.525 
    coh760:k=56.0729,b=0      15.365        15.408        15.457       15.512       15.572        15.637        15.963        16.065        16.175        16.292        16.414        16.532 
    coh761:k=56.1733,b=0      15.374        15.416        15.466       15.521        15.58        15.645        15.971        16.072        16.182          16.3        16.421        16.539 
    coh762:k=56.2737,b=0      15.383        15.425        15.475       15.529       15.588        15.654        15.979         16.08         16.19        16.307        16.428        16.545 
    coh763:k=56.374,b=0       15.385        15.427        15.477       15.531        15.59        15.656        15.981        16.082        16.191        16.309         16.43        16.547 
    coh764:k=56.4744,b=0      15.386        15.428        15.477       15.532       15.591        15.656        15.981        16.082        16.192        16.309         16.43        16.547 
    coh765:k=56.5747,b=0      15.386        15.428        15.478       15.532       15.591        15.657        15.982        16.083        16.192         16.31        16.431        16.548 
    coh766:k=56.6751,b=0      15.387        15.429        15.478       15.533       15.592        15.657        15.982        16.083        16.193         16.31        16.431        16.553 
    coh767:k=56.7755,b=0      15.387        15.429        15.479       15.533       15.592        15.658        15.983        16.084        16.193        16.312        16.437         16.56 
    coh768:k=56.8758,b=0      15.388         15.43        15.479       15.534       15.593        15.658        15.984        16.087        16.199        16.319        16.444        16.566 
    coh769:k=56.9762,b=0      15.388         15.43         15.48       15.534       15.595        15.661        15.992        16.095        16.207        16.326        16.451        16.573 
    coh770:k=57.0765,b=0      15.394        15.437        15.488       15.543       15.603        15.669            16        16.102        16.214        16.333        16.458         16.58 
    coh771:k=57.1769,b=0      15.403        15.446        15.496       15.551       15.612        15.678        16.007         16.11        16.221        16.341        16.465        16.585 
    coh772:k=57.2773,b=0      15.412        15.454        15.505        15.56        15.62        15.686        16.015        16.117        16.229        16.348        16.471        16.591 

tb_pol_a: optimal safe savings choice for each state space point
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0           -0.83469      -0.83469       -1.242       -1.242      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh2:k=-19.8996,b=0      -0.83469      -0.83469       -1.242       -1.242      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh3:k=-19.7993,b=0      -0.83469      -0.83469       -1.242       -1.242      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh4:k=-19.6989,b=0      -0.83469      -0.83469       -1.242       -1.242      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh5:k=-19.5986,b=0      -0.83469      -0.83469       -1.242       -1.242      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh6:k=-19.4982,b=0       -19.999       -19.999      -19.999      -19.999      -1.6494       -2.0567       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh7:k=-19.3978,b=0       -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh8:k=-19.2975,b=0       -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh9:k=-19.1971,b=0       -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -4.0935       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh10:k=-19.0968,b=0      -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -4.9082       -5.7229       -6.5376       -7.7596        -9.389 
    coh11:k=-18.9964,b=0      -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -5.7229       -6.5376       -7.7596        -9.389 
    coh12:k=-18.896,b=0       -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -6.5376       -7.7596        -9.389 
    coh13:k=-18.7957,b=0      -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -6.5376       -7.7596        -9.389 
    coh14:k=-18.6953,b=0      -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -7.7596        -9.389 
    coh15:k=-18.595,b=0       -19.999       -19.999      -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -7.7596        -9.389 
    coh16:k=-18.4946,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998        -9.389 
    coh17:k=-18.3942,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998        -9.389 
    coh18:k=-18.2939,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998        -9.389 
    coh19:k=-18.1935,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh20:k=-18.0932,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh21:k=-17.9928,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh22:k=-17.8924,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh23:k=-17.7921,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh24:k=-17.6917,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh25:k=-17.5914,b=0      -19.998       -19.998      -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh26:k=-17.491,b=0       -19.997       -19.997      -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh27:k=-17.3906,b=0      -19.997       -19.997      -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh28:k=-17.2903,b=0      -19.997       -19.997      -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh29:k=-17.1899,b=0      -19.997       -19.997      -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh30:k=-17.0896,b=0      -19.997       -19.997      -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh31:k=-16.9892,b=0      -18.792       -18.957      -19.173      -19.456      -19.689       -19.998       -19.998       -19.998       -19.997       -19.997       -19.997       -19.997 
    coh32:k=-16.8888,b=0      -18.723       -18.953      -19.119      -19.387      -19.627       -19.998       -19.998       -19.998       -19.998       -19.997       -19.997       -19.997 
    coh33:k=-16.7885,b=0      -18.721       -18.892      -19.063      -19.325      -19.563       -19.925       -19.998       -19.998       -19.998       -19.998       -19.998       -19.997 
    coh34:k=-16.6881,b=0      -18.652       -18.828      -19.064      -19.277      -19.567       -19.856       -19.998       -19.998       -19.998       -19.998       -19.998       -19.997 
    coh35:k=-16.5878,b=0      -18.591       -18.763      -19.008      -19.204      -19.502       -19.863       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh36:k=-16.4874,b=0       -18.55       -18.769      -18.943      -19.131      -19.453       -19.809       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh37:k=-16.387,b=0       -18.555       -18.704      -18.854       -19.14       -19.41       -19.766       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh38:k=-16.2867,b=0      -18.495       -18.638      -18.871      -19.087       -19.42       -19.733       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh39:k=-16.1863,b=0      -18.423       -18.571      -18.796      -19.033      -19.377       -19.675       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh40:k=-16.086,b=0        -18.35       -18.588      -18.734      -18.978      -19.328       -19.616       -19.998       -19.998       -19.998       -19.998       -19.998       -19.997 
    coh41:k=-15.9856,b=0      -18.291       -18.521      -18.696      -18.921      -19.253       -19.577       -19.998       -19.998       -19.998       -19.998       -19.998       -19.997 
    coh42:k=-15.8852,b=0      -18.305       -18.453      -18.658      -18.942       -19.19       -19.593       -19.998       -19.998       -19.998       -19.998       -19.997       -19.997 
    coh43:k=-15.7849,b=0      -18.264       -18.383      -18.593      -18.887       -19.14       -19.555       -19.998       -19.998       -19.998       -19.997       -19.997       -19.997 
    coh44:k=-15.6845,b=0      -18.204        -18.33      -18.526      -18.829      -19.089       -19.486       -19.998       -19.998       -19.998       -19.997       -19.997       -19.997 
    coh45:k=-15.5842,b=0      -18.129       -18.291      -18.558      -18.771      -19.037       -19.424       -19.998       -19.998       -19.997       -19.997       -19.997       -19.997 
    coh46:k=-15.4838,b=0      -18.083        -18.22      -18.492       -18.71      -19.066       -19.381       -19.998       -19.998       -19.997       -19.997       -19.997       -19.997 
    coh47:k=-15.3834,b=0       -18.03       -18.259      -18.426      -18.649      -19.014        -19.32       -19.998       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh48:k=-15.2831,b=0      -17.951       -18.188      -18.358      -18.586      -18.961       -19.243       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh49:k=-15.1827,b=0      -17.999        -18.14      -18.314      -18.521      -18.907       -19.187       -19.997       -19.997       -19.997       -19.997       -19.997       -19.996 
    coh50:k=-15.0824,b=0      -17.923         -18.1      -18.278      -18.566      -18.852       -19.138       -19.997       -19.997       -19.997       -19.997       -19.996       -19.996 
    coh723:k=52.3596,b=0       46.416        45.034       45.034       45.034       43.651        43.651         36.86        35.508        32.803        31.451        27.395         24.69 
    coh724:k=52.46,b=0         46.508        45.124       45.124       45.124        43.74         43.74        36.939        35.585        32.877        31.523         27.46        24.752 
    coh725:k=52.5603,b=0         46.6        45.214       45.214       45.214       43.828        43.828        37.018        35.662         32.95        31.594        27.526        24.814 
    coh726:k=52.6607,b=0       46.692        45.304       45.304       45.304       43.916        43.916        37.097        35.739        33.023        31.665        27.592        24.876 
    coh727:k=52.7611,b=0       46.784        45.394       45.394       45.394       44.004        44.004        37.176        35.816        33.096        31.737        27.657        24.938 
    coh728:k=52.8614,b=0       46.876        45.485       45.485       45.485       44.093        44.093        37.254        35.893         33.17        31.808        28.562            25 
    coh729:k=52.9618,b=0       46.969        45.575       45.575       45.575       44.181        44.181        37.333         35.97        33.243        31.879        29.152        25.062 
    coh730:k=53.0621,b=0       47.061        45.665       45.665       45.665       44.269        44.269        37.412        36.047        33.934        31.951         29.22        25.124 
    coh731:k=53.1625,b=0       47.153        45.755       45.755       45.755       44.358        44.358        37.491        36.124        34.757        32.022        29.288        25.186 
    coh732:k=53.2629,b=0       47.245        45.845       45.845       45.845       44.446        44.446         37.57        36.201        34.832        32.093        29.355        25.248 
    coh733:k=53.3632,b=0       47.337        45.936       45.936       45.936       44.534        44.534        37.649        36.278        34.907        32.165        29.423         25.31 
    coh734:k=53.4636,b=0       47.429        46.026       46.026       46.026       44.622        44.622        37.728        36.355        34.982        32.236         29.49        25.372 
    coh735:k=53.5639,b=0       47.521        46.116       46.116       46.116       44.711        44.711        37.807        36.432        35.057        32.308        29.558        25.434 
    coh736:k=53.6643,b=0       47.613        46.206       46.206       46.206       44.799        44.799        37.885        36.509        35.132        32.379        29.626        25.496 
    coh737:k=53.7647,b=0       47.705        46.296       46.296       46.296       44.887        44.887        37.964        36.586        35.207         32.45        29.693        25.558 
    coh738:k=53.865,b=0        47.798        46.387       46.387       46.387       44.976        44.976        38.043        36.663        35.282        32.522        29.761         25.62 
    coh739:k=53.9654,b=0        47.89        46.477       46.477       46.477       45.064        45.064        38.122         36.74        35.357        32.593        29.829        25.682 
    coh740:k=54.0657,b=0       47.982        46.567       46.567       46.567       45.152        45.152        38.201        36.817        35.433        32.664        29.896        25.744 
    coh741:k=54.1661,b=0       48.074        46.657       46.657       46.657        45.24         45.24         38.28        36.894        35.508        32.736        29.964        25.806 
    coh742:k=54.2665,b=0       48.166        46.747       46.747       46.747       45.329        45.329        38.359        36.971        35.583        32.807        30.031        26.521 
    coh743:k=54.3668,b=0       48.258        46.838       46.838       46.838       45.417        45.417        38.437        37.048        35.658        32.878        30.099        27.319 
    coh744:k=54.4672,b=0        48.35        46.928       46.928       46.928       45.505        45.505        38.516        37.125        35.733         32.95        30.167        27.383 
    coh745:k=54.5675,b=0       48.442        47.018       47.018       47.018       45.594        45.594        38.595        37.202        35.808        33.021        30.234        27.447 
    coh746:k=54.6679,b=0       48.535        47.109       47.109       47.109       45.684        45.684        38.674        37.279        35.883        33.093        30.302        27.511 
    coh747:k=54.7683,b=0       48.629        47.204       47.204       47.204       44.342        44.342        38.839        37.356        35.958        33.164        30.369        27.575 
    coh748:k=54.8686,b=0       47.226        45.827       45.827       45.827       44.428        44.428        40.203        37.433        36.033        33.235        30.437        27.639 
    coh749:k=54.969,b=0        47.317        45.916       45.916       45.916       44.515        44.515        40.312         37.51        36.109        33.307        30.505        27.703 
    coh750:k=55.0693,b=0       47.407        46.004       46.004       46.004       44.601        44.601        40.392        37.587        36.184        33.378        30.572        27.766 
    coh751:k=55.1697,b=0       47.497        46.092       46.092       46.092       44.687        44.687        40.473        37.664        36.259        33.449         30.64         27.83 
    coh752:k=55.2701,b=0       47.587         46.18        46.18        46.18       44.774        44.774        40.554        37.741        36.334        33.521        30.707        27.894 
    coh753:k=55.3704,b=0       47.677        46.269       46.269       46.269        44.86         44.86        40.635        37.818        36.409        33.592        30.775        28.763 
    coh754:k=55.4708,b=0       47.767        46.357       46.357       46.357       44.946        44.946        40.715        37.895        36.484        33.663        31.533        29.432 
    coh755:k=55.5711,b=0       47.857        46.445       46.445       46.445       45.033        45.033        40.796        37.972        36.559        33.735        32.323        29.498 
    coh756:k=55.6715,b=0       47.947        46.533       46.533       46.533       45.119        45.119        40.877        38.048        36.634        33.806        32.392        29.103 
    coh757:k=55.7719,b=0       48.037        46.621       46.621       46.621       45.205        45.205        40.957        38.125        36.709        33.877        32.116        28.213 
    coh758:k=55.8722,b=0       48.128         46.71        46.71        46.71       45.292        45.292        41.038        38.202        36.785        33.949        31.113        28.277 
    coh759:k=55.9726,b=0       48.218        46.798       46.798       46.798       45.378        45.378        41.119        38.279         36.86         34.02        31.181        28.341 
    coh760:k=56.0729,b=0       48.308        46.886       46.886       46.886       45.465        45.465          41.2        38.356        36.935        34.092        31.248        28.405 
    coh761:k=56.1733,b=0       48.398        46.974       46.974       46.974       45.551        45.551         41.28        38.433         37.01        34.163        31.316        28.469 
    coh762:k=56.2737,b=0       48.488        47.063       47.063       47.063       45.637        45.637        41.361         38.51        37.085        34.234        31.384        28.533 
    coh763:k=56.374,b=0         48.58        47.154       47.154       47.154       45.728        45.728        41.451          38.6        37.174        34.323        31.471         28.62 
    coh764:k=56.4744,b=0       48.672        47.246       47.246       47.246        45.82         45.82        41.543        38.692        37.266        34.415        31.563        28.712 
    coh765:k=56.5747,b=0       48.764        47.338       47.338       47.338       45.913        45.913        41.635        38.784        37.358        34.507        31.655        28.804 
    coh766:k=56.6751,b=0       48.856         47.43        47.43        47.43       46.005        46.005        41.727        38.876         37.45        34.599        31.747        27.705 
    coh767:k=56.7755,b=0       48.948        47.522       47.522       47.522       46.097        46.097         41.82        38.968        37.542        33.379        30.573        27.768 
    coh768:k=56.8758,b=0        49.04        47.614       47.614       47.614       46.189        46.189        40.473        37.663        36.259        33.449         30.64         27.83 
    coh769:k=56.9762,b=0       49.132        47.707       47.707       46.178       44.771        44.771        40.552        37.739        36.332        33.519        30.706        27.893 
    coh770:k=57.0765,b=0       47.673        46.264       46.264       46.264       44.856        44.856        40.631        37.814        36.405        33.589        30.772        28.697 
    coh771:k=57.1769,b=0       47.761        46.351       46.351       46.351        44.94         44.94         40.71        37.889        36.479        33.658        31.437        29.428 
    coh772:k=57.2773,b=0       47.849        46.437       46.437       46.437       45.025        45.025        40.789        37.964        36.552        33.728        32.316        29.492 

tb_pol_k: optimal risky investment choice for each state space point
                            z1_0_34741    z2_0_40076    z3_0_4623     z4_0_5333     z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567 
                            __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________

    coh1:k=-20,b=0             0.83469       0.83469         1.242         1.242        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh2:k=-19.8996,b=0        0.83469       0.83469         1.242         1.242        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh3:k=-19.7993,b=0        0.83469       0.83469         1.242         1.242        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh4:k=-19.6989,b=0        0.83469       0.83469         1.242         1.242        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh5:k=-19.5986,b=0        0.83469       0.83469         1.242         1.242        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh6:k=-19.4982,b=0      5.018e-07     5.018e-07     5.018e-07     5.018e-07        1.6494        2.0567        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh7:k=-19.3978,b=0     6.0216e-07    6.0216e-07    6.0216e-07    6.0216e-07    6.0216e-07    6.0216e-07        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh8:k=-19.2975,b=0     7.0252e-07    7.0252e-07    7.0252e-07    7.0252e-07    7.0252e-07    7.0252e-07        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh9:k=-19.1971,b=0     8.0288e-07    8.0288e-07    8.0288e-07    8.0288e-07    8.0288e-07    8.0288e-07        4.0935        4.9082        5.7229        6.5376        7.7596         9.389
    coh10:k=-19.0968,b=0    9.0324e-07    9.0324e-07    9.0324e-07    9.0324e-07    9.0324e-07    9.0324e-07    9.0324e-07        4.9082        5.7229        6.5376        7.7596         9.389
    coh11:k=-18.9964,b=0    1.0036e-06    1.0036e-06    1.0036e-06    1.0036e-06    1.0036e-06    1.0036e-06    1.0036e-06    1.0036e-06        5.7229        6.5376        7.7596         9.389
    coh12:k=-18.896,b=0      1.104e-06     1.104e-06     1.104e-06     1.104e-06     1.104e-06     1.104e-06     1.104e-06     1.104e-06     1.104e-06        6.5376        7.7596         9.389
    coh13:k=-18.7957,b=0    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06    1.2043e-06        6.5376        7.7596         9.389
    coh14:k=-18.6953,b=0    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06    1.3047e-06        7.7596         9.389
    coh15:k=-18.595,b=0      1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06     1.405e-06        7.7596         9.389
    coh16:k=-18.4946,b=0    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06    1.5054e-06         9.389
    coh17:k=-18.3942,b=0    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06    1.6058e-06         9.389
    coh18:k=-18.2939,b=0    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06    1.7061e-06         9.389
    coh19:k=-18.1935,b=0    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06    1.8065e-06
    coh20:k=-18.0932,b=0    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06    1.9068e-06
    coh21:k=-17.9928,b=0    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06    2.0072e-06
    coh22:k=-17.8924,b=0    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06    2.1076e-06
    coh23:k=-17.7921,b=0    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06    2.2079e-06
    coh24:k=-17.6917,b=0    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06    2.3083e-06
    coh25:k=-17.5914,b=0    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06    2.4086e-06
    coh26:k=-17.491,b=0      2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06     2.509e-06
    coh27:k=-17.3906,b=0    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06    2.6094e-06
    coh28:k=-17.2903,b=0    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06    2.7097e-06
    coh29:k=-17.1899,b=0    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06    2.8101e-06
    coh30:k=-17.0896,b=0    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06    2.9104e-06
    coh31:k=-16.9892,b=0       0.81863       0.98374        1.1384        1.3597        1.5929        1.8408         1.657        1.5958    3.0108e-06    3.0108e-06    3.0108e-06    3.0108e-06
    coh32:k=-16.8888,b=0       0.81732         0.984        1.1494         1.354        1.5944        1.9022        1.7123         1.649        1.5857    3.1112e-06    3.1112e-06    3.1112e-06
    coh33:k=-16.7885,b=0       0.81728       0.98807        1.1589        1.3563        1.5937        1.8901        1.7675        1.7022        1.6368        1.5715        1.5061    3.2115e-06
    coh34:k=-16.6881,b=0       0.81374       0.98986        1.1586        1.3719        1.5939        1.8829        1.8228        1.7554         1.688        1.6206        1.5532    3.3119e-06
    coh35:k=-16.5878,b=0        0.8188        0.9904        1.1656        1.3621        1.5902        1.8823         1.878        1.8086        1.7391        1.6697        1.6003        1.5308
    coh36:k=-16.4874,b=0       0.84289       0.99052        1.1645        1.3525        1.6026        1.8872        1.9332        1.8618        1.7903        1.7188        1.6473        1.5759
    coh37:k=-16.387,b=0        0.83992       0.98929        1.1387         1.351        1.6212        1.9036        1.9149        1.9149        1.8414        1.7679        1.6944        1.6209
    coh38:k=-16.2867,b=0       0.84288       0.98636        1.1436        1.3598        1.6171        1.9303        1.9681        1.8926        1.8926         1.817        1.7415        1.6659
    coh39:k=-16.1863,b=0       0.83499       0.98235        1.1298        1.3675        1.6332        1.9315        2.0213        1.9437        1.9437        1.8661        1.8661        2.3317
    coh40:k=-16.086,b=0        0.82471       0.98353        1.1299        1.3738        1.6442        1.9316        2.0745        1.9949        1.9949        1.9152        1.9152        2.5524
    coh41:k=-15.9856,b=0       0.82983        0.9778        1.1534        1.3781        1.6285        1.9523        2.1277         2.046         2.046        1.9644        2.4544        2.6995
    coh42:k=-15.8852,b=0       0.82318       0.97115        1.1763        1.3767        1.6247        1.9438        2.1809        2.0972        2.0972        2.0972        2.6832         2.767
    coh43:k=-15.7849,b=0       0.84326       0.96245        1.1726        1.3804        1.6344         1.963        2.2341        2.1483        2.1483        2.6629        2.7487        2.8345
    coh44:k=-15.6845,b=0        0.8448       0.97092        1.1676        1.3822        1.6422        1.9514        2.2873        2.1995        2.2873        2.8141        2.8141        2.9898
    coh45:k=-15.5842,b=0        0.8311        0.9935        1.1704        1.3833        1.6493        1.9468        2.3405        2.3405        2.7897        2.8796        2.9694        3.0593
    coh46:k=-15.4838,b=0        0.8472       0.98399        1.1644        1.3821        1.6455        1.9608        2.3937        2.4856         2.945        3.0369        3.1288        3.2207
    coh47:k=-15.3834,b=0       0.85574        0.9906        1.1575          1.38        1.6514        1.9572        2.4469        3.1044        3.1044        3.1044        3.1983        3.2923
    coh48:k=-15.2831,b=0       0.83829       0.97857        1.1491        1.3765        1.6561        1.9374        3.1719        3.1719        3.1719        3.1719        3.2679        3.3638
    coh49:k=-15.1827,b=0       0.84871        0.9897        1.1639        1.3712         1.659        1.9393        3.2394        3.2394        3.2394        3.2394        3.3374        3.5334
    coh50:k=-15.0824,b=0       0.83254        1.0096        1.1874        1.3753        1.6614        1.9475        3.4069        3.3069        3.3069        3.4069         3.507         3.607
    coh723:k=52.3596,b=0        1.4501        2.8324        2.8324        2.8324        4.2146        4.2146         9.532        10.884        13.589        14.941        18.998        21.702
    coh724:k=52.46,b=0          1.4521        2.8363        2.8363        2.8363        4.2205        4.2205        9.5452        10.899        13.608        14.962        19.024        21.732
    coh725:k=52.5603,b=0        1.4541        2.8402        2.8402        2.8402        4.2263        4.2263        9.5585        10.914        13.626        14.982         19.05        21.762
    coh726:k=52.6607,b=0        1.4561        2.8441        2.8441        2.8441        4.2321        4.2321        9.5717         10.93        13.645        15.003        19.077        21.792
    coh727:k=52.7611,b=0        1.4582        2.8481        2.8481        2.8481         4.238         4.238        9.5849        10.945        13.664        15.024        19.103        21.823
    coh728:k=52.8614,b=0        1.4602         2.852         2.852         2.852        4.2438        4.2438        9.5981         10.96        13.683        15.045        18.291        21.853
    coh729:k=52.9618,b=0        1.4622        2.8559        2.8559        2.8559        4.2497        4.2497        9.6113        10.975        13.702        15.065        17.792        21.883
    coh730:k=53.0621,b=0        1.4642        2.8599        2.8599        2.8599        4.2555        4.2555        9.6246         10.99        13.103        15.086        17.817        21.913
    coh731:k=53.1625,b=0        1.4662        2.8638        2.8638        2.8638        4.2614        4.2614        9.6378        11.005        12.372        15.107        17.841        21.943
    coh732:k=53.2629,b=0        1.4682        2.8677        2.8677        2.8677        4.2672        4.2672         9.651         11.02        12.389        15.127        17.866        21.973
    coh733:k=53.3632,b=0        1.4702        2.8716        2.8716        2.8716        4.2731        4.2731        9.6642        11.035        12.406        15.148         17.89        22.003
    coh734:k=53.4636,b=0        1.4722        2.8756        2.8756        2.8756        4.2789        4.2789        9.6774         11.05        12.423        15.169        17.915        22.033
    coh735:k=53.5639,b=0        1.4743        2.8795        2.8795        2.8795        4.2848        4.2848        9.6907        11.065         12.44         15.19        17.939        22.063
    coh736:k=53.6643,b=0        1.4763        2.8834        2.8834        2.8834        4.2906        4.2906        9.7039         11.08        12.457         15.21        17.964        22.093
    coh737:k=53.7647,b=0        1.4783        2.8874        2.8874        2.8874        4.2965        4.2965        9.7171        11.096        12.474        15.231        17.988        22.124
    coh738:k=53.865,b=0         1.4803        2.8913        2.8913        2.8913        4.3023        4.3023        9.7303        11.111        12.491        15.252        18.013        22.154
    coh739:k=53.9654,b=0        1.4823        2.8952        2.8952        2.8952        4.3081        4.3081        9.7435        11.126        12.508        15.273        18.037        22.184
    coh740:k=54.0657,b=0        1.4843        2.8991        2.8991        2.8991         4.314         4.314        9.7568        11.141        12.525        15.293        18.061        22.214
    coh741:k=54.1661,b=0        1.4863        2.9031        2.9031        2.9031        4.3198        4.3198          9.77        11.156        12.542        15.314        18.086        22.244
    coh742:k=54.2665,b=0        1.4883         2.907         2.907         2.907        4.3257        4.3257        9.7832        11.171        12.559        15.335         18.11         21.62
    coh743:k=54.3668,b=0        1.4903        2.9109        2.9109        2.9109        4.3315        4.3315        9.7964        11.186        12.576        15.355        18.135        20.914
    coh744:k=54.4672,b=0        1.4924        2.9149        2.9149        2.9149        4.3374        4.3374        9.8096        11.201        12.593        15.376        18.159        20.943
    coh745:k=54.5675,b=0        1.4944        2.9188        2.9188        2.9188        4.3432        4.3432        9.8229        11.216         12.61        15.397        18.184        20.971
    coh746:k=54.6679,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        9.8361        11.231        12.627        15.418        18.208        20.999
    coh747:k=54.7683,b=0        1.4957        2.9214        2.9214        2.9214        4.2603        4.2603        9.7631        11.247        12.644        15.438        18.233        21.027
    coh748:k=54.8686,b=0        1.4678        2.8669        2.8669        2.8669        4.2661        4.2661        8.4916        11.262        12.661        15.459        18.257        21.055
    coh749:k=54.969,b=0         1.4698        2.8708        2.8708        2.8708        4.2718        4.2718        8.4748        11.277        12.678         15.48        18.282        21.084
    coh750:k=55.0693,b=0        1.4717        2.8746        2.8746        2.8746        4.2775        4.2775        8.4861        11.292        12.695          15.5        18.306        21.112
    coh751:k=55.1697,b=0        1.4737        2.8785        2.8785        2.8785        4.2832        4.2832        8.4974        11.307        12.712        15.521        18.331         21.14
    coh752:k=55.2701,b=0        1.4757        2.8823        2.8823        2.8823        4.2889        4.2889        8.5088        11.322        12.729        15.542        18.355        21.168
    coh753:k=55.3704,b=0        1.4777        2.8861        2.8861        2.8861        4.2946        4.2946        8.5201        11.337        12.746        15.563         18.38        20.392
    coh754:k=55.4708,b=0        1.4796          2.89          2.89          2.89        4.3004        4.3004        8.5315        11.352        12.763        15.583        17.714        19.814
    coh755:k=55.5711,b=0        1.4816        2.8938        2.8938        2.8938        4.3061        4.3061        8.5428        11.367         12.78        15.604        17.016        19.841
    coh756:k=55.6715,b=0        1.4836        2.8977        2.8977        2.8977        4.3118        4.3118        8.5542        11.382        12.797        15.625        17.039        20.328
    coh757:k=55.7719,b=0        1.4855        2.9015        2.9015        2.9015        4.3175        4.3175        8.5655        11.398        12.814        15.646        17.407         21.31
    coh758:k=55.8722,b=0        1.4875        2.9054        2.9054        2.9054        4.3232        4.3232        8.5769        11.413         12.83        15.666        18.502        21.338
    coh759:k=55.9726,b=0        1.4895        2.9092        2.9092        2.9092         4.329         4.329        8.5882        11.428        12.847        15.687        18.526        21.366
    coh760:k=56.0729,b=0        1.4914        2.9131        2.9131        2.9131        4.3347        4.3347        8.5996        11.443        12.864        15.708        18.551        21.394
    coh761:k=56.1733,b=0        1.4934        2.9169        2.9169        2.9169        4.3404        4.3404        8.6109        11.458        12.881        15.728        18.575        21.422
    coh762:k=56.2737,b=0        1.4954        2.9207        2.9207        2.9207        4.3461        4.3461        8.6222        11.473        12.898        15.749          18.6        21.451
    coh763:k=56.374,b=0         1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604        21.456
    coh764:k=56.4744,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604        21.456
    coh765:k=56.5747,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604        21.456
    coh766:k=56.6751,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604        21.085
    coh767:k=56.7755,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.501        18.307        21.112
    coh768:k=56.8758,b=0        1.4957        2.9214        2.9214        2.9214        4.3471        4.3471        8.4974        11.307        12.712        15.521        18.331         21.14
    coh769:k=56.9762,b=0        1.4957        2.9214        2.9214        2.8822        4.2888        4.2888        8.5085        11.322        12.728        15.541        18.355        21.168
    coh770:k=57.0765,b=0        1.4776         2.886         2.886         2.886        4.2944        4.2944        8.5196        11.336        12.745        15.562        18.378        20.453
    coh771:k=57.1769,b=0        1.4795        2.8897        2.8897        2.8897           4.3           4.3        8.5307        11.351        12.761        15.582        17.803        19.813
    coh772:k=57.2773,b=0        1.4814        2.8935        2.8935        2.8935        4.3056        4.3056        8.5418        11.366        12.778        15.602        17.014        19.838

tb_pol_w: risky + safe investment choices (first stage choice, choose within risky vs safe)
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0                 0             0             0            0            0             0             0             0             0             0             0             0 
    coh2:k=-19.8996,b=0            0             0             0            0            0             0             0             0             0             0             0             0 
    coh3:k=-19.7993,b=0            0             0             0            0            0             0             0             0             0             0             0             0 
    coh4:k=-19.6989,b=0            0             0             0            0            0             0             0             0             0             0             0             0 
    coh5:k=-19.5986,b=0            0             0             0            0            0             0             0             0             0             0             0             0 
    coh6:k=-19.4982,b=0      -19.999       -19.999       -19.999      -19.999            0             0             0             0             0             0             0             0 
    coh7:k=-19.3978,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999             0             0             0             0             0             0 
    coh8:k=-19.2975,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999             0             0             0             0             0             0 
    coh9:k=-19.1971,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999             0             0             0             0             0             0 
    coh10:k=-19.0968,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999             0             0             0             0             0 
    coh11:k=-18.9964,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999             0             0             0             0 
    coh12:k=-18.896,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999             0             0             0 
    coh13:k=-18.7957,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999             0             0             0 
    coh14:k=-18.6953,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999             0             0 
    coh15:k=-18.595,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999             0             0 
    coh16:k=-18.4946,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998             0 
    coh17:k=-18.3942,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998             0 
    coh18:k=-18.2939,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998             0 
    coh19:k=-18.1935,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh20:k=-18.0932,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh21:k=-17.9928,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh22:k=-17.8924,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh23:k=-17.7921,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh24:k=-17.6917,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh25:k=-17.5914,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh26:k=-17.491,b=0      -19.997       -19.997       -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh27:k=-17.3906,b=0     -19.997       -19.997       -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh28:k=-17.2903,b=0     -19.997       -19.997       -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh29:k=-17.1899,b=0     -19.997       -19.997       -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh30:k=-17.0896,b=0     -19.997       -19.997       -19.997      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh31:k=-16.9892,b=0     -17.973       -17.973       -18.035      -18.096      -18.096       -18.157       -18.341       -18.403       -19.997       -19.997       -19.997       -19.997 
    coh32:k=-16.8888,b=0     -17.906       -17.969       -17.969      -18.033      -18.033       -18.096       -18.286       -18.349       -18.413       -19.997       -19.997       -19.997 
    coh33:k=-16.7885,b=0     -17.904       -17.904       -17.904      -17.969      -17.969       -18.034       -18.231       -18.296       -18.362       -18.427       -18.492       -19.997 
    coh34:k=-16.6881,b=0     -17.838       -17.838       -17.906      -17.906      -17.973       -17.973       -18.175       -18.243        -18.31       -18.378       -18.445       -19.997 
    coh35:k=-16.5878,b=0     -17.773       -17.773       -17.842      -17.842      -17.912       -17.981        -18.12        -18.19       -18.259       -18.329       -18.398       -18.468 
    coh36:k=-16.4874,b=0     -17.707       -17.779       -17.779      -17.779       -17.85       -17.922       -18.065       -18.136       -18.208       -18.279       -18.351       -18.423 
    coh37:k=-16.387,b=0      -17.715       -17.715       -17.715      -17.789      -17.789       -17.862       -18.083       -18.083       -18.157        -18.23       -18.304       -18.377 
    coh38:k=-16.2867,b=0     -17.652       -17.652       -17.727      -17.727      -17.803       -17.803        -18.03       -18.106       -18.106       -18.181       -18.257       -18.332 
    coh39:k=-16.1863,b=0     -17.588       -17.588       -17.666      -17.666      -17.744       -17.744       -17.977       -18.054       -18.054       -18.132       -18.132       -17.666 
    coh40:k=-16.086,b=0      -17.525       -17.605       -17.605      -17.605      -17.684       -17.684       -17.923       -18.003       -18.003       -18.083       -18.083       -17.445 
    coh41:k=-15.9856,b=0     -17.461       -17.543       -17.543      -17.543      -17.625       -17.625        -17.87       -17.952       -17.952       -18.034       -17.543       -17.298 
    coh42:k=-15.8852,b=0     -17.482       -17.482       -17.482      -17.565      -17.565       -17.649       -17.817       -17.901       -17.901       -17.901       -17.314        -17.23 
    coh43:k=-15.7849,b=0      -17.42        -17.42        -17.42      -17.506      -17.506       -17.592       -17.764        -17.85        -17.85       -17.334       -17.249       -17.163 
    coh44:k=-15.6845,b=0     -17.359       -17.359       -17.359      -17.447      -17.447       -17.535        -17.71       -17.798        -17.71       -17.183       -17.183       -17.007 
    coh45:k=-15.5842,b=0     -17.297       -17.297       -17.387      -17.387      -17.387       -17.477       -17.657       -17.657       -17.207       -17.118       -17.028       -16.938 
    coh46:k=-15.4838,b=0     -17.236       -17.236       -17.328      -17.328       -17.42        -17.42       -17.604       -17.512       -17.052        -16.96       -16.868       -16.776 
    coh47:k=-15.3834,b=0     -17.175       -17.269       -17.269      -17.269      -17.363       -17.363       -17.551       -16.892       -16.892       -16.892       -16.798       -16.704 
    coh48:k=-15.2831,b=0     -17.113       -17.209       -17.209      -17.209      -17.305       -17.305       -16.825       -16.825       -16.825       -16.825       -16.729       -16.633 
    coh49:k=-15.1827,b=0      -17.15        -17.15        -17.15       -17.15      -17.248       -17.248       -16.757       -16.757       -16.757       -16.757       -16.659       -16.463 
    coh50:k=-15.0824,b=0      -17.09        -17.09        -17.09      -17.191      -17.191       -17.191        -16.59        -16.69        -16.69        -16.59        -16.49       -16.389 
    coh723:k=52.3596,b=0      47.866        47.866        47.866       47.866       47.866        47.866        46.392        46.392        46.392        46.392        46.392        46.392 
    coh724:k=52.46,b=0         47.96         47.96         47.96        47.96        47.96         47.96        46.484        46.484        46.484        46.484        46.484        46.484 
    coh725:k=52.5603,b=0      48.054        48.054        48.054       48.054       48.054        48.054        46.576        46.576        46.576        46.576        46.576        46.576 
    coh726:k=52.6607,b=0      48.148        48.148        48.148       48.148       48.148        48.148        46.668        46.668        46.668        46.668        46.668        46.668 
    coh727:k=52.7611,b=0      48.242        48.242        48.242       48.242       48.242        48.242         46.76         46.76         46.76         46.76         46.76         46.76 
    coh728:k=52.8614,b=0      48.337        48.337        48.337       48.337       48.337        48.337        46.853        46.853        46.853        46.853        46.853        46.853 
    coh729:k=52.9618,b=0      48.431        48.431        48.431       48.431       48.431        48.431        46.945        46.945        46.945        46.945        46.945        46.945 
    coh730:k=53.0621,b=0      48.525        48.525        48.525       48.525       48.525        48.525        47.037        47.037        47.037        47.037        47.037        47.037 
    coh731:k=53.1625,b=0      48.619        48.619        48.619       48.619       48.619        48.619        47.129        47.129        47.129        47.129        47.129        47.129 
    coh732:k=53.2629,b=0      48.713        48.713        48.713       48.713       48.713        48.713        47.221        47.221        47.221        47.221        47.221        47.221 
    coh733:k=53.3632,b=0      48.807        48.807        48.807       48.807       48.807        48.807        47.313        47.313        47.313        47.313        47.313        47.313 
    coh734:k=53.4636,b=0      48.901        48.901        48.901       48.901       48.901        48.901        47.405        47.405        47.405        47.405        47.405        47.405 
    coh735:k=53.5639,b=0      48.995        48.995        48.995       48.995       48.995        48.995        47.497        47.497        47.497        47.497        47.497        47.497 
    coh736:k=53.6643,b=0       49.09         49.09         49.09        49.09        49.09         49.09        47.589        47.589        47.589        47.589        47.589        47.589 
    coh737:k=53.7647,b=0      49.184        49.184        49.184       49.184       49.184        49.184        47.681        47.681        47.681        47.681        47.681        47.681 
    coh738:k=53.865,b=0       49.278        49.278        49.278       49.278       49.278        49.278        47.773        47.773        47.773        47.773        47.773        47.773 
    coh739:k=53.9654,b=0      49.372        49.372        49.372       49.372       49.372        49.372        47.865        47.865        47.865        47.865        47.865        47.865 
    coh740:k=54.0657,b=0      49.466        49.466        49.466       49.466       49.466        49.466        47.958        47.958        47.958        47.958        47.958        47.958 
    coh741:k=54.1661,b=0       49.56         49.56         49.56        49.56        49.56         49.56         48.05         48.05         48.05         48.05         48.05         48.05 
    coh742:k=54.2665,b=0      49.654        49.654        49.654       49.654       49.654        49.654        48.142        48.142        48.142        48.142        48.142        48.142 
    coh743:k=54.3668,b=0      49.748        49.748        49.748       49.748       49.748        49.748        48.234        48.234        48.234        48.234        48.234        48.234 
    coh744:k=54.4672,b=0      49.843        49.843        49.843       49.843       49.843        49.843        48.326        48.326        48.326        48.326        48.326        48.326 
    coh745:k=54.5675,b=0      49.937        49.937        49.937       49.937       49.937        49.937        48.418        48.418        48.418        48.418        48.418        48.418 
    coh746:k=54.6679,b=0      50.031        50.031        50.031       50.031       50.031        50.031         48.51         48.51         48.51         48.51         48.51         48.51 
    coh747:k=54.7683,b=0      50.125        50.125        50.125       50.125       48.602        48.602        48.602        48.602        48.602        48.602        48.602        48.602 
    coh748:k=54.8686,b=0      48.694        48.694        48.694       48.694       48.694        48.694        48.694        48.694        48.694        48.694        48.694        48.694 
    coh749:k=54.969,b=0       48.786        48.786        48.786       48.786       48.786        48.786        48.786        48.786        48.786        48.786        48.786        48.786 
    coh750:k=55.0693,b=0      48.878        48.878        48.878       48.878       48.878        48.878        48.878        48.878        48.878        48.878        48.878        48.878 
    coh751:k=55.1697,b=0       48.97         48.97         48.97        48.97        48.97         48.97         48.97         48.97         48.97         48.97         48.97         48.97 
    coh752:k=55.2701,b=0      49.063        49.063        49.063       49.063       49.063        49.063        49.063        49.063        49.063        49.063        49.063        49.063 
    coh753:k=55.3704,b=0      49.155        49.155        49.155       49.155       49.155        49.155        49.155        49.155        49.155        49.155        49.155        49.155 
    coh754:k=55.4708,b=0      49.247        49.247        49.247       49.247       49.247        49.247        49.247        49.247        49.247        49.247        49.247        49.247 
    coh755:k=55.5711,b=0      49.339        49.339        49.339       49.339       49.339        49.339        49.339        49.339        49.339        49.339        49.339        49.339 
    coh756:k=55.6715,b=0      49.431        49.431        49.431       49.431       49.431        49.431        49.431        49.431        49.431        49.431        49.431        49.431 
    coh757:k=55.7719,b=0      49.523        49.523        49.523       49.523       49.523        49.523        49.523        49.523        49.523        49.523        49.523        49.523 
    coh758:k=55.8722,b=0      49.615        49.615        49.615       49.615       49.615        49.615        49.615        49.615        49.615        49.615        49.615        49.615 
    coh759:k=55.9726,b=0      49.707        49.707        49.707       49.707       49.707        49.707        49.707        49.707        49.707        49.707        49.707        49.707 
    coh760:k=56.0729,b=0      49.799        49.799        49.799       49.799       49.799        49.799        49.799        49.799        49.799        49.799        49.799        49.799 
    coh761:k=56.1733,b=0      49.891        49.891        49.891       49.891       49.891        49.891        49.891        49.891        49.891        49.891        49.891        49.891 
    coh762:k=56.2737,b=0      49.983        49.983        49.983       49.983       49.983        49.983        49.983        49.983        49.983        49.983        49.983        49.983 
    coh763:k=56.374,b=0       50.076        50.076        50.076       50.076       50.076        50.076        50.076        50.076        50.076        50.076        50.076        50.076 
    coh764:k=56.4744,b=0      50.168        50.168        50.168       50.168       50.168        50.168        50.168        50.168        50.168        50.168        50.168        50.168 
    coh765:k=56.5747,b=0       50.26         50.26         50.26        50.26        50.26         50.26         50.26         50.26         50.26         50.26         50.26         50.26 
    coh766:k=56.6751,b=0      50.352        50.352        50.352       50.352       50.352        50.352        50.352        50.352        50.352        50.352        50.352         48.79 
    coh767:k=56.7755,b=0      50.444        50.444        50.444       50.444       50.444        50.444        50.444        50.444        50.444         48.88         48.88         48.88 
    coh768:k=56.8758,b=0      50.536        50.536        50.536       50.536       50.536        50.536         48.97         48.97         48.97         48.97         48.97         48.97 
    coh769:k=56.9762,b=0      50.628        50.628        50.628        49.06        49.06         49.06         49.06         49.06         49.06         49.06         49.06         49.06 
    coh770:k=57.0765,b=0       49.15         49.15         49.15        49.15        49.15         49.15         49.15         49.15         49.15         49.15         49.15         49.15 
    coh771:k=57.1769,b=0       49.24         49.24         49.24        49.24        49.24         49.24         49.24         49.24         49.24         49.24         49.24         49.24 
    coh772:k=57.2773,b=0       49.33         49.33         49.33        49.33        49.33         49.33         49.33         49.33         49.33         49.33         49.33         49.33 

</pre><img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_02.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_03.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_04.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_08.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_09.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_10.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_11.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_12.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_13.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_14.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_15.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_16.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_17.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_18.png" alt=""> <h2 id="25">Display Various Containers</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_defparam)
</pre><h2 id="27">Display 1 support_map</h2><pre class="codeinput">    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 42
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = true
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = false
pos = 9 ; key = bl_graph ; val = true
pos = 10 ; key = bl_graph_coh_t_coh ; val = true
pos = 11 ; key = bl_graph_evf ; val = false
pos = 12 ; key = bl_graph_funcgrids ; val = false
pos = 13 ; key = bl_graph_funcgrids_detail ; val = false
pos = 14 ; key = bl_graph_onebyones ; val = true
pos = 15 ; key = bl_graph_pol_lvl ; val = true
pos = 16 ; key = bl_graph_pol_pct ; val = true
pos = 17 ; key = bl_graph_val ; val = true
pos = 18 ; key = bl_img_save ; val = false
pos = 19 ; key = bl_mat ; val = false
pos = 20 ; key = bl_post ; val = true
pos = 21 ; key = bl_profile ; val = false
pos = 22 ; key = bl_profile_dist ; val = false
pos = 23 ; key = bl_time ; val = false
pos = 24 ; key = it_display_every ; val = 5
pos = 25 ; key = it_display_final_colmax ; val = 12
pos = 26 ; key = it_display_final_rowmax ; val = 100
pos = 27 ; key = it_display_summmat_colmax ; val = 5
pos = 28 ; key = it_display_summmat_rowmax ; val = 5
pos = 29 ; key = st_img_name_main ; val = ff_ipwkbz_vf_vecsv_default
pos = 30 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbz//solve/img/
pos = 31 ; key = st_img_prefix ; val = 
pos = 32 ; key = st_img_suffix ; val = _p4.png
pos = 33 ; key = st_mat_name_main ; val = ff_ipwkbz_vf_vecsv_default
pos = 34 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbz//solve/mat/
pos = 35 ; key = st_mat_prefix ; val = 
pos = 36 ; key = st_mat_suffix ; val = _p4
pos = 37 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbz/
pos = 38 ; key = st_profile_name_main ; val = ff_ipwkbz_vf_vecsv_default
pos = 39 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbz//solve/profile/
pos = 40 ; key = st_profile_prefix ; val = 
pos = 41 ; key = st_profile_suffix ; val = _p4
pos = 42 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_evf                   4     4        0 
    bl_display_final                 5     5        1 
    bl_display_final_dist            6     6        0 
    bl_display_final_dist_detail     7     7        0 
    bl_display_funcgrids             8     8        0 
    bl_graph                         9     9        1 
    bl_graph_coh_t_coh              10    10        1 
    bl_graph_evf                    11    11        0 
    bl_graph_funcgrids              12    12        0 
    bl_graph_funcgrids_detail       13    13        0 
    bl_graph_onebyones              14    14        1 
    bl_graph_pol_lvl                15    15        1 
    bl_graph_pol_pct                16    16        1 
    bl_graph_val                    17    17        1 
    bl_img_save                     18    18        0 
    bl_mat                          19    19        0 
    bl_post                         20    20        1 
    bl_profile                      21    21        0 
    bl_profile_dist                 22    22        0 
    bl_time                         23    23        0 
    it_display_every                24    24        5 
    it_display_final_colmax         25    25       12 
    it_display_final_rowmax         26    26      100 
    it_display_summmat_colmax       27    27        5 
    it_display_summmat_rowmax       28    28        5 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    29 
    st_img_path              2    30 
    st_img_prefix            3    31 
    st_img_suffix            4    32 
    st_mat_name_main         5    33 
    st_mat_path              6    34 
    st_mat_prefix            7    35 
    st_mat_suffix            8    36 
    st_matimg_path_root      9    37 
    st_profile_name_main    10    38 
    st_profile_path         11    39 
    st_profile_prefix       12    40 
    st_profile_suffix       13    41 
    st_title_prefix         14    42 

</pre><h2 id="28">Display 2 armt_map</h2><pre class="codeinput">    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 21
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a_meshk ;rown= 772 ,coln= 1
ar_a_meshk :mu= 18.6145 ,sd= 22.347 ,min= -20 ,max= 57.2773
                   zi_1_c1
                   _______

    zi_1_R1           -20 
    zi_2_R2         -19.9 
    zi_386_r386    18.538 
    zi_771_r771    57.177 
    zi_772_r772    57.277 

pos = 2 ; key = ar_a_meshk_ori ;rown= 35000 ,coln= 1
ar_a_meshk_ori :mu= -2.5107 ,sd= 15.6002 ,min= -20 ,max= 49.93
                       zi_1_c1
                       _______

    zi_1_R1                -20
    zi_2_R2                -20
    zi_17500_r17500    -19.965
    zi_34999_r34999    -18.504
    zi_35000_r35000     -19.93

pos = 3 ; key = ar_ak_perc ;rown= 1 ,coln= 50
ar_ak_perc :mu= 0.5 ,sd= 0.2969 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_25_c25    zi_49_c49    zi_50_c50
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.021367     0.48982      0.97863       0.999  

pos = 4 ; key = ar_interp_c_grid ;rown= 1 ,coln= 772572
ar_interp_c_grid :mu= 38.6486 ,sd= 22.3023 ,min= 0.02 ,max= 77.2773
               zi_1_C1    zi_2_C2    zi_386286_c386286    zi_772571_c772571    zi_772572_c772572
               _______    _______    _________________    _________________    _________________

    zi_1_r1     0.02      0.0201          38.649               77.277               77.277      

pos = 5 ; key = ar_interp_coh_grid ;rown= 1 ,coln= 772
ar_interp_coh_grid :mu= 18.6145 ,sd= 22.347 ,min= -20 ,max= 57.2773
               zi_1_C1    zi_2_C2    zi_386_c386    zi_771_c771    zi_772_c772
               _______    _______    ___________    ___________    ___________

    zi_1_r1      -20       -19.9       18.538         57.177         57.277   

pos = 6 ; key = ar_k_mesha ;rown= 772 ,coln= 1
ar_k_mesha :mu= 0 ,sd= 0 ,min= 0 ,max= 0
                   zi_1_c1
                   _______

    zi_1_R1           0   
    zi_2_R2           0   
    zi_386_r386       0   
    zi_771_r771       0   
    zi_772_r772       0   

pos = 7 ; key = ar_k_mesha_ori ;rown= 35000 ,coln= 1
ar_k_mesha_ori :mu= 17.4893 ,sd= 15.6002 ,min= 0 ,max= 69.93
                       zi_1_c1
                       _______

    zi_1_R1                 0 
    zi_2_R2                 0 
    zi_17500_r17500    34.865 
    zi_34999_r34999    68.504 
    zi_35000_r35000     69.93 

pos = 8 ; key = ar_stationary ;rown= 1 ,coln= 15
ar_stationary :mu= 0.066667 ,sd= 0.060897 ,min= 0.0027089 ,max= 0.16757
                zi_1_C1      zi_2_C2     zi_8_C8    zi_14_c14    zi_15_c15
               _________    _________    _______    _________    _________

    zi_1_r1    0.0027089    0.0069499    0.16757    0.0069499    0.0027089

pos = 9 ; key = ar_w_level ;rown= 1 ,coln= 700
ar_w_level :mu= 14.9786 ,sd= 20.2441 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_350_c350    zi_699_c699    zi_700_c700
               _______    _______    ___________    ___________    ___________

    zi_1_r1      -20       -19.9        14.9           49.9            50     

pos = 10 ; key = ar_w_perc ;rown= 1 ,coln= 50
ar_w_perc :mu= 0.5 ,sd= 0.2969 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_25_c25    zi_49_c49    zi_50_c50
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.021367     0.48982      0.97863       0.999  

pos = 11 ; key = ar_z ;rown= 1 ,coln= 15
ar_z :mu= 1.1347 ,sd= 0.69878 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
               _______    _______    _______    _________    _________

    zi_1_r1    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 12 ; key = it_ameshk_n ; val = 772
pos = 13 ; key = mt_coh_wkb ;rown= 772 ,coln= 15
mt_coh_wkb :mu= 18.6145 ,sd= 22.3335 ,min= -20 ,max= 57.2773
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1           -20        -20        -20         -20          -20  
    zi_2_R2         -19.9      -19.9      -19.9       -19.9        -19.9  
    zi_386_r386    18.538     18.538     18.538      18.538       18.538  
    zi_771_r771    57.177     57.177     57.177      57.177       57.177  
    zi_772_r772    57.277     57.277     57.277      57.277       57.277  

pos = 14 ; key = mt_coh_wkb_ori ;rown= 35000 ,coln= 15
mt_coh_wkb_ori :mu= 16.2187 ,sd= 20.8435 ,min= -21.4564 ,max= 57.2773
                       zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                       _______    _______    _______    _________    _________

    zi_1_R1            -21.456    -21.456    -21.456     -21.456      -21.456 
    zi_2_R2            -21.456    -21.456    -21.456     -21.456      -21.456 
    zi_17500_r17500     11.905     12.097     14.049      18.649       19.877 
    zi_34999_r34999     44.797     45.041      47.53      53.397       54.962 
    zi_35000_r35000     44.559     44.805     47.313      53.223         54.8 

pos = 15 ; key = mt_interp_coh_grid_mesh_w_perc ;rown= 50 ,coln= 772
mt_interp_coh_grid_mesh_w_perc :mu= 18.6145 ,sd= 22.3329 ,min= -20 ,max= 57.2773
                 zi_1_C1    zi_2_C2    zi_386_c386    zi_771_c771    zi_772_c772
                 _______    _______    ___________    ___________    ___________

    zi_1_R1        -20       -19.9       18.538         57.177         57.277   
    zi_2_R2        -20       -19.9       18.538         57.177         57.277   
    zi_25_r25      -20       -19.9       18.538         57.177         57.277   
    zi_49_r49      -20       -19.9       18.538         57.177         57.277   
    zi_50_r50      -20       -19.9       18.538         57.177         57.277   

pos = 16 ; key = mt_interp_coh_grid_mesh_z ;rown= 772 ,coln= 15
mt_interp_coh_grid_mesh_z :mu= 18.6145 ,sd= 22.3335 ,min= -20 ,max= 57.2773
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1           -20        -20        -20         -20          -20  
    zi_2_R2         -19.9      -19.9      -19.9       -19.9        -19.9  
    zi_386_r386    18.538     18.538     18.538      18.538       18.538  
    zi_771_r771    57.177     57.177     57.177      57.177       57.177  
    zi_772_r772    57.277     57.277     57.277      57.277       57.277  

pos = 17 ; key = mt_k ;rown= 50 ,coln= 700
mt_k :mu= 17.4893 ,sd= 15.6002 ,min= 0 ,max= 69.93
                 zi_1_C1     zi_2_C2      zi_350_c350    zi_699_c699    zi_700_c700
                 _______    __________    ___________    ___________    ___________

    zi_1_R1         0       0.00010029       0.0349        0.0699           0.07   
    zi_2_R2         0        0.0021429      0.74571        1.4936         1.4957   
    zi_25_r25       0         0.049122       17.094        34.238         34.287   
    zi_49_r49       0         0.098144       34.154        68.406         68.504   
    zi_50_r50       0          0.10019       34.865         69.83          69.93   

pos = 18 ; key = mt_w_by_interp_coh_interp_grid ;rown= 50 ,coln= 772
mt_w_by_interp_coh_interp_grid :mu= -0.69276 ,sd= 17.2218 ,min= -20 ,max= 57.2
                 zi_1_C1    zi_2_C2    zi_386_c386    zi_771_c771    zi_772_c772
                 _______    _______    ___________    ___________    ___________

    zi_1_R1        -20          -20      -19.961        -19.923        -19.923  
    zi_2_R2        -20      -19.998      -19.177        -18.351        -18.349  
    zi_25_r25      -20      -19.951      -1.1233         17.803         17.852  
    zi_49_r49      -20      -19.902       17.715         55.528         55.626  
    zi_50_r50      -20        -19.9         18.5           57.1           57.2  

pos = 19 ; key = mt_z_mesh_coh_interp_grid ;rown= 772 ,coln= 15
mt_z_mesh_coh_interp_grid :mu= 1.1347 ,sd= 0.67511 ,min= 0.34741 ,max= 2.567
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1        0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2        0.34741    0.40076    0.94436     2.2253        2.567  
    zi_386_r386    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_771_r771    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_772_r772    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 20 ; key = mt_z_mesh_coh_wkb ;rown= 35000 ,coln= 15
mt_z_mesh_coh_wkb :mu= 1.1347 ,sd= 0.67508 ,min= 0.34741 ,max= 2.567
                       zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                       _______    _______    _______    _________    _________

    zi_1_R1            0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2            0.34741    0.40076    0.94436     2.2253        2.567  
    zi_17500_r17500    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_34999_r34999    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_35000_r35000    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 21 ; key = mt_z_trans ;rown= 15 ,coln= 15
mt_z_trans :mu= 0.066667 ,sd= 0.095337 ,min= 0 ,max= 0.27902
                  zi_1_C1       zi_2_C2       zi_8_C8      zi_14_c14     zi_15_c15 
                 __________    __________    __________    __________    __________

    zi_1_R1         0.26016       0.26831    0.00012823    1.1102e-15             0
    zi_2_R2         0.11232       0.19622    0.00098855    9.3592e-14    3.3307e-16
    zi_8_R8      1.7181e-06    4.1008e-05       0.27902    4.1008e-05    1.7181e-06
    zi_14_r14     3.474e-16    9.3597e-14    0.00098855       0.19622       0.11232
    zi_15_r15    2.7412e-18    1.1057e-15    0.00012823       0.26831       0.26016

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                      i     idx    rowN        colN         mean        std          min         max  
                                      __    ___    _____    __________    ________    ________    _________    _______

    ar_a_meshk                         1     1       772             1      18.614      22.347          -20     57.277
    ar_a_meshk_ori                     2     2     35000             1     -2.5107        15.6          -20      49.93
    ar_ak_perc                         3     3         1            50         0.5      0.2969        0.001      0.999
    ar_interp_c_grid                   4     4         1    7.7257e+05      38.649      22.302         0.02     77.277
    ar_interp_coh_grid                 5     5         1           772      18.614      22.347          -20     57.277
    ar_k_mesha                         6     6       772             1           0           0            0          0
    ar_k_mesha_ori                     7     7     35000             1      17.489        15.6            0      69.93
    ar_stationary                      8     8         1            15    0.066667    0.060897    0.0027089    0.16757
    ar_w_level                         9     9         1           700      14.979      20.244          -20         50
    ar_w_perc                         10    10         1            50         0.5      0.2969        0.001      0.999
    ar_z                              11    11         1            15      1.1347     0.69878      0.34741      2.567
    mt_coh_wkb                        12    13       772            15      18.614      22.334          -20     57.277
    mt_coh_wkb_ori                    13    14     35000            15      16.219      20.843      -21.456     57.277
    mt_interp_coh_grid_mesh_w_perc    14    15        50           772      18.614      22.333          -20     57.277
    mt_interp_coh_grid_mesh_z         15    16       772            15      18.614      22.334          -20     57.277
    mt_k                              16    17        50           700      17.489        15.6            0      69.93
    mt_w_by_interp_coh_interp_grid    17    18        50           772    -0.69276      17.222          -20       57.2
    mt_z_mesh_coh_interp_grid         18    19       772            15      1.1347     0.67511      0.34741      2.567
    mt_z_mesh_coh_wkb                 19    20     35000            15      1.1347     0.67508      0.34741      2.567
    mt_z_trans                        20    21        15            15    0.066667    0.095337            0    0.27902

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    value
                   _    ___    _____

    it_ameshk_n    1    12      772 

</pre><h2 id="29">Display 3 param_map</h2><pre class="codeinput">    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 34
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_default ; val = true
pos = 2 ; key = fl_Amean ; val = 1
pos = 3 ; key = fl_alpha ; val = 0.36
pos = 4 ; key = fl_b_bd ; val = -20
pos = 5 ; key = fl_beta ; val = 0.94
pos = 6 ; key = fl_c_min ; val = 0.02
pos = 7 ; key = fl_coh_interp_grid_gap ; val = 0.1
pos = 8 ; key = fl_crra ; val = 1.5
pos = 9 ; key = fl_default_wprime ; val = 0
pos = 10 ; key = fl_delta ; val = 0.08
pos = 11 ; key = fl_k_max ; val = 70
pos = 12 ; key = fl_k_min ; val = 0
pos = 13 ; key = fl_nan_replace ; val = -9999
pos = 14 ; key = fl_r_borr ; val = 0.095
pos = 15 ; key = fl_r_save ; val = 0.025
pos = 16 ; key = fl_tol_dist ; val = 1e-05
pos = 17 ; key = fl_tol_pol ; val = 1e-05
pos = 18 ; key = fl_tol_val ; val = 1e-05
pos = 19 ; key = fl_w ; val = 0.44365
pos = 20 ; key = fl_w_interp_grid_gap ; val = 0.1
pos = 21 ; key = fl_w_max ; val = 50
pos = 22 ; key = fl_w_min ; val = -20
pos = 23 ; key = fl_z_mu ; val = 0
pos = 24 ; key = fl_z_rho ; val = 0.8
pos = 25 ; key = fl_z_sig ; val = 0.2
pos = 26 ; key = it_ak_perc_n ; val = 50
pos = 27 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 28 ; key = it_maxiter_dist ; val = 1000
pos = 29 ; key = it_maxiter_val ; val = 250
pos = 30 ; key = it_tol_pol_nochange ; val = 25
pos = 31 ; key = it_w_perc_n ; val = 50
pos = 32 ; key = it_z_n ; val = 15
pos = 33 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 34 ; key = st_model ; val = ipwkbz
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx     value 
                              __    ___    _______

    bl_default                 1     1           1
    fl_Amean                   2     2           1
    fl_alpha                   3     3        0.36
    fl_b_bd                    4     4         -20
    fl_beta                    5     5        0.94
    fl_c_min                   6     6        0.02
    fl_coh_interp_grid_gap     7     7         0.1
    fl_crra                    8     8         1.5
    fl_default_wprime          9     9           0
    fl_delta                  10    10        0.08
    fl_k_max                  11    11          70
    fl_k_min                  12    12           0
    fl_nan_replace            13    13       -9999
    fl_r_borr                 14    14       0.095
    fl_r_save                 15    15       0.025
    fl_tol_dist               16    16       1e-05
    fl_tol_pol                17    17       1e-05
    fl_tol_val                18    18       1e-05
    fl_w                      19    19     0.44365
    fl_w_interp_grid_gap      20    20         0.1
    fl_w_max                  21    21          50
    fl_w_min                  22    22         -20
    fl_z_mu                   23    23           0
    fl_z_rho                  24    24         0.8
    fl_z_sig                  25    25         0.2
    it_ak_perc_n              26    26          50
    it_c_interp_grid_gap      27    27      0.0001
    it_maxiter_dist           28    28        1000
    it_maxiter_val            29    29         250
    it_tol_pol_nochange       30    30          25
    it_w_perc_n               31    31          50
    it_z_n                    32    32          15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    33 
    st_model                         2    34 

</pre><h2 id="30">Display 4 func_map</h2><pre class="codeinput">    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 7
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(z,b,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0))
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(z,b,k)(f_prod(z,k)-(fl_delta)*k+fl_w+b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(z,b,k)f_util_log((f_coh(z,b,k)-fl_b_bd).*((f_coh(z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(z,b,k)-fl_b_bd)&lt;=fl_c_min))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                      i    idx    xFunction
                      _    ___    _________

    f_coh             1     1         1    
    f_cons            2     2         2    
    f_inc             3     3         3    
    f_prod            4     4         4    
    f_util_crra       5     5         5    
    f_util_log        6     6         6    
    f_util_standin    7     7         7    

</pre><h2 id="31">Display 5 result_map</h2><pre class="codeinput">    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: RESULT_MAP
----------------------------------------
  Map with properties:

        Count: 14
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_pol_diff_norm ;rown= 128 ,coln= 1
ar_pol_diff_norm :mu= 60.95 ,sd= 296.7255 ,min= 0 ,max= 2427.7329
                   zi_1_c1
                   _______

    zi_1_R1        2146.7 
    zi_2_R2        2427.7 
    zi_64_R64      2.7178 
    zi_127_r127         0 
    zi_128_r128         0 

pos = 2 ; key = ar_st_pol_names ; val = cl_mt_coh cl_mt_pol_a cl_mt_pol_k cl_mt_pol_c
pos = 3 ; key = ar_val_diff_norm ;rown= 128 ,coln= 1
ar_val_diff_norm :mu= 10.6776 ,sd= 29.7648 ,min= 0.0010481 ,max= 179.6801
                    zi_1_c1 
                   _________

    zi_1_R1           179.68
    zi_2_R2           173.52
    zi_64_R64        0.11449
    zi_127_r127    0.0011175
    zi_128_r128    0.0010481

pos = 4 ; key = cl_mt_coh ;rown= 772 ,coln= 15
cl_mt_coh :mu= 18.6145 ,sd= 22.3335 ,min= -20 ,max= 57.2773
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1           -20        -20        -20         -20          -20  
    zi_2_R2         -19.9      -19.9      -19.9       -19.9        -19.9  
    zi_386_r386    18.538     18.538     18.538      18.538       18.538  
    zi_771_r771    57.177     57.177     57.177      57.177       57.177  
    zi_772_r772    57.277     57.277     57.277      57.277       57.277  

pos = 5 ; key = cl_mt_cons ;rown= 772 ,coln= 15
cl_mt_cons :mu= 2.8778 ,sd= 2.8307 ,min= -20 ,max= 7.9469
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1           -20        -20        -20         -20          -20  
    zi_2_R2         -19.9      -19.9      -19.9       -19.9        -19.9  
    zi_386_r386    2.3933     2.3933     3.1782      3.1782       3.1782  
    zi_771_r771    7.9366     7.9366     7.9366      7.9366       7.9366  
    zi_772_r772    7.9469     7.9469     7.9469      7.9469       7.9469  

pos = 6 ; key = cl_mt_pol_a ;rown= 772 ,coln= 15
cl_mt_pol_a :mu= 9.4167 ,sd= 19.0743 ,min= -19.9995 ,max= 49.1323
                   zi_1_C1     zi_2_C2     zi_8_C8    zi_14_c14    zi_15_c15
                   ________    ________    _______    _________    _________

    zi_1_R1        -0.83469    -0.83469    -2.8714     -7.7596       -9.389 
    zi_2_R2        -0.83469    -0.83469    -2.8714     -7.7596       -9.389 
    zi_386_r386        13.9        13.9      8.843     0.20069      0.20069 
    zi_771_r771      47.761      46.351      42.12      31.437       29.428 
    zi_772_r772      47.849      46.437     42.656      32.316       29.492 

pos = 7 ; key = cl_mt_pol_c ;rown= 772 ,coln= 15
cl_mt_pol_c :mu= 2.8778 ,sd= 2.8307 ,min= -20 ,max= 7.9469
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1           -20        -20        -20         -20          -20  
    zi_2_R2         -19.9      -19.9      -19.9       -19.9        -19.9  
    zi_386_r386    2.3933     2.3933     3.1782      3.1782       3.1782  
    zi_771_r771    7.9366     7.9366     7.9366      7.9366       7.9366  
    zi_772_r772    7.9469     7.9469     7.9469      7.9469       7.9469  

pos = 8 ; key = cl_mt_pol_k ;rown= 772 ,coln= 15
cl_mt_pol_k :mu= 6.32 ,sd= 5.1688 ,min= 5.018e-07 ,max= 22.2439
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1        0.83469    0.83469    2.8714      7.7596        9.389  
    zi_2_R2        0.83469    0.83469    2.8714      7.7596        9.389  
    zi_386_r386     2.2447     2.2447    6.5171      15.159       15.159  
    zi_771_r771     1.4795     2.8897    7.1204      17.803       19.813  
    zi_772_r772     1.4814     2.8935    6.6741      17.014       19.838  

pos = 9 ; key = mt_pol_idx ;rown= 772 ,coln= 15
mt_pol_idx :mu= 19319.018 ,sd= 11146.9597 ,min= 1 ,max= 38595
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1             1          1          1           1            1  
    zi_2_R2            91         91         91          91           91  
    zi_386_r386     19297      19297      19296       19296        19296  
    zi_771_r771     38545      38545      38545       38545        38545  
    zi_772_r772     38595      38595      38595       38595        38595  

pos = 10 ; key = mt_pol_perc_change ;rown= 128 ,coln= 15
mt_pol_perc_change :mu= 0.09405 ,sd= 0.24872 ,min= 0 ,max= 1
                   zi_1_C1    zi_2_C2     zi_8_C8     zi_14_c14    zi_15_c15
                   _______    _______    _________    _________    _________

    zi_1_R1           1          1               1            1            1
    zi_2_R2           1          1               1            1            1
    zi_64_R64         0          0       0.0012953    0.0012953    0.0012953
    zi_127_r127       0          0               0            0            0
    zi_128_r128       0          0               0            0            0

pos = 11 ; key = mt_val ;rown= 772 ,coln= 15
mt_val :mu= 8.522 ,sd= 7.1189 ,min= -9.948 ,max= 16.5907
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                   _______    _______    _______    _________    _________

    zi_1_R1        -9.948     -9.7084    -7.5157     -4.4637      -3.9723 
    zi_2_R2        -9.948     -9.7084    -7.5157     -4.4637      -3.9723 
    zi_386_r386    10.256      10.359      11.26      12.589       12.823 
    zi_771_r771    15.403      15.446     15.828      16.465       16.585 
    zi_772_r772    15.412      15.454     15.835      16.471       16.591 

pos = 12 ; key = tb_pol_a ;rown= 100 ,coln= 12
tb_pol_a :mu= 11.4254 ,sd= 29.2601 ,min= -19.9995 ,max= 49.1323
                   zi_1_C1     zi_2_C2     zi_6_C6    zi_11_c11    zi_12_c12
                   ________    ________    _______    _________    _________

    zi_1_R1        -0.83469    -0.83469    -2.0567     -7.7596       -9.389 
    zi_2_R2        -0.83469    -0.83469    -2.0567     -7.7596       -9.389 
    zi_50_R50       -17.923       -18.1    -19.138     -19.996      -19.996 
    zi_99_R99        47.761      46.351      44.94      31.437       29.428 
    zi_100_r100      47.849      46.437     45.025      32.316       29.492 

pos = 13 ; key = tb_val ;rown= 100 ,coln= 12
tb_val :mu= 4.7976 ,sd= 11.0433 ,min= -9.948 ,max= 16.5907
                   zi_1_C1    zi_2_C2    zi_6_C6    zi_11_c11    zi_12_c12
                   _______    _______    _______    _________    _________

    zi_1_R1         -9.948    -9.7084    -8.3721     -4.4637      -3.9723 
    zi_2_R2         -9.948    -9.7084    -8.3721     -4.4637      -3.9723 
    zi_50_R50      -6.9715    -6.7889    -5.8478     -3.0796      -2.6406 
    zi_99_R99       15.403     15.446     15.678      16.465       16.585 
    zi_100_r100     15.412     15.454     15.686      16.471       16.591 

pos = 14 ; key = tb_valpol_alliter ;rown= 100 ,coln= 17
tb_valpol_alliter :mu= 5.4416 ,sd= 83.1045 ,min= 0 ,max= 2427.7329
                    zi_1_C1     zi_2_C2     zi_9_C9     zi_16_c16    zi_17_c17
                   _________    _______    _________    _________    _________

    zi_1_R1           179.68    2146.7             1           1             1
    zi_2_R2           173.52    2427.7             1           1             1
    zi_50_R50        0.52765     9.114     0.0090674    0.003886     0.0090674
    zi_99_R99      0.0011175         0             0           0             0
    zi_100_r100    0.0010481         0             0           0             0

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i     idx    rowN    colN     mean        std         min        max  
                          __    ___    ____    ____    _______    _______    _________    ______

    ar_pol_diff_norm       1     1     128       1       60.95     296.73            0    2427.7
    ar_val_diff_norm       2     3     128       1      10.678     29.765    0.0010481    179.68
    cl_mt_coh              3     4     772      15      18.614     22.334          -20    57.277
    cl_mt_cons             4     5     772      15      2.8778     2.8307          -20    7.9469
    cl_mt_pol_a            5     6     772      15      9.4167     19.074      -19.999    49.132
    cl_mt_pol_c            6     7     772      15      2.8778     2.8307          -20    7.9469
    cl_mt_pol_k            7     8     772      15        6.32     5.1688    5.018e-07    22.244
    mt_pol_idx             8     9     772      15       19319      11147            1     38595
    mt_pol_perc_change     9    10     128      15     0.09405    0.24872            0         1
    mt_val                10    11     772      15       8.522     7.1189       -9.948    16.591
    tb_pol_a              11    12     100      12      11.425      29.26      -19.999    49.132
    tb_val                12    13     100      12      4.7976     11.043       -9.948    16.591
    tb_valpol_alliter     13    14     100      17      5.4416     83.104            0    2427.7

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                       i    idx
                       _    ___

    ar_st_pol_names    1     2 

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 14
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Risky + Safe Asset (Save + Borr) Interpolated-Percentage (Optimized-Vectorized)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_ipwkbz_vf_vecsv(varargin)
%% FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the two step solution
% with interpolation and with percentage asset grids version of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html
% ff_iwkz_vf_vecsv>. See that file for more descriptions.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ff_ipwkbz_evf.m ff_ipwkbz_evf>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m ffs_ipwkbz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m ffs_ipwkbz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

% parameters can be set inside ffs_ipwkbz_set_default_param or updated here
% param_map('it_w_perc_n') = 50;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('it_z_n') = 15;
% param_map('fl_coh_interp_grid_gap') = 0.025;
% param_map('it_c_interp_grid_gap') = 0.001;
% param_map('fl_w_interp_grid_gap') = 0.25;
% param_map('it_w_perc_n') = 100;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('it_z_n') = 11;
% param_map('fl_coh_interp_grid_gap') = 0.1;
% param_map('it_c_interp_grid_gap') = 10^-4;
% param_map('fl_w_interp_grid_gap') = 0.1;

% get armt and func map
[armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_ipwkbz_vf_vecsv';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_w_perc', 'ar_w_level', 'ar_z'});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {'ar_interp_c_grid', 'ar_interp_coh_grid', ...
    'ar_a_meshk', 'ar_k_mesha', ...
    'mt_interp_coh_grid_mesh_z', 'mt_z_mesh_coh_interp_grid',...
    'mt_interp_coh_grid_mesh_w_perc',...
    'mt_w_by_interp_coh_interp_grid'});
[ar_interp_c_grid, ar_interp_coh_grid, ar_a_meshk, ar_k_mesha, ...
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, ...
    mt_interp_coh_grid_mesh_w_perc,...
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {'mt_coh_wkb', 'mt_z_mesh_coh_wkb'});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};

% param_map
params_group = values(param_map, {'it_z_n', 'fl_crra', 'fl_beta', ...
    'fl_nan_replace', 'fl_c_min', 'bl_default', 'fl_default_wprime'});
[it_z_n, fl_crra, fl_beta, fl_nan_replace, fl_c_min, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display_defparam', 'bl_graph_evf', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display_defparam, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));

% We did not need these in ff_oz_vf or ff_oz_vf_vec
% see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why store using cells.
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
for it_z_i = 1:length(ar_z)
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
end

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Pre-calculate u(c)
% Interpolation, see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why interpolate over u(c)

% Evaluate
if (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
else
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
end
ar_interp_u_of_c_grid(ar_interp_c_grid <= fl_c_min) = fl_u_cmin;

% Get Interpolant
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, 'spline', 'nearest');

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)
    % v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see
    % ffs_ipwkbz_get_funcgrid.m. Generate interpolant based on that, Then
    % interpolate for the coh reachable levels given the k(w,z) percentage
    % choice grids in the second stage of the problem

    % Generate Interpolant for v(coh,z)
    f_grid_interpolant_value = griddedInterpolant(...
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', 'linear', 'nearest');

    % Interpolate for v(coh(k(w,z),b(w,z),z),z)
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
%     ar_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb(:), mt_coh_wkb(:));
%     mt_val_wkb_interpolated = reshape(ar_val_wkb_interpolated, size(mt_z_mesh_coh_wkb));

    %% Solve Second Stage Problem k*(w,z)
    % This is the key difference between this function and
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
    % ffs_akz_set_functions> which solves the two stages jointly
    % Interpolation first, because solution coh grid is not the same as all
    % points reachable by k and b choices given w.
    support_map('bl_graph_evf') = false;
    if (it_iter == (it_maxiter_val + 1))
        support_map('bl_graph_evf') = bl_graph_evf;
    end
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = ...
        ff_ipwkbz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);

    %% Solve First Stage Problem w*(z) given k*(w,z)

    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)

        %% A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)
        % Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z)
        % There are two w=k'+b' arrays. ar_w_level is the level even grid based
        % on which we solve the 2nd stage problem in ff_ipwkbz_evf.m. Here for
        % each coh level, we have a different vector of w levels, but the same
        % vector of percentage ws. So we need to interpolate to get the optimal
        % k* and b* choices at each percentage level of w.
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', 'linear', 'nearest');

        % Interpolate (2), shift from w_level to w_perc
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;

        % changes in w_perc kstar choices
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);

        %% B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp
        % Note that compared to
        % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
        % ffs_akz_set_functions> the mt_c here is much smaller the same
        % number of columns (states) as in the ffs_akz_set_functions file,
        % but the number of rows equal to ar_w length.
        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), ...
                      mt_w_astar_interp_z(mt_w_kstar_diff_idx), ...
                      mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c <= fl_c_min);
        % EVAL current utility: N by N, f_util defined earlier
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        % Update Storage
        if (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        else
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        end
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;

        %% C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))
        % Generate Interpolant for (3) EV(k*(ar_w_perc),Z)
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', 'linear', 'nearest');
        % Interpolate (3), EVAL add on future utility, N by N + N by N
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);

        %% D. Compute FULL U(coh_level, w_perc, z) over all w_perc
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        % Index update
        % using the method below is much faster than index replace
        % see <https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        % Default or Not Utility Handling
        if (bl_default)
            % if default: only today u(cmin), transition out next period, debt wiped out
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        else
            % if default is not allowed: v = u(cmin)
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        end

        % percentage algorithm does not have invalid (check to make sure
        % min percent is not 0 in ffs_ipwkbz_get_funcgrid.m)
        % mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);

        %% E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)
        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        % Generate Linear Opti Index
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        % Handle Default is optimal or not
        if (bl_default)
            % if defaulting is optimal choice, at these states, not required
            % to default, non-default possible, but default could be optimal
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = fl_default_opti_kprime;
        else
            % if default is not allowed, then next period same state as now
            % this is absorbing state, this is the limiting case, single
            % state space point, lowest a and lowest shock has this.
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = min(ar_a_meshk);
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = min(ar_k_mesha);
        end

        %% F. Store Results
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        end

    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
                                      mean(mt_pol_a_cur,1); ...
                                      mean(mt_pol_k_cur,1); ...
                                      mt_val_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(it_ameshk_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice')
        disp('mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_idx') = mt_pol_idx;

result_map('cl_mt_coh') = {mt_interp_coh_grid_mesh_z, zeros(1)};
result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_pol_k') = {mt_pol_k, zeros(1)};
result_map('cl_mt_pol_c') = {f_cons(mt_interp_coh_grid_mesh_z, mt_pol_a, mt_pol_k), zeros(1)};
result_map('ar_st_pol_names') = ["cl_mt_coh", "cl_mt_pol_a", "cl_mt_pol_k", "cl_mt_pol_c"];


if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);

    armt_map('mt_coh_wkb_ori') = mt_coh_wkb;
    armt_map('ar_a_meshk_ori') = ar_a_meshk;
    armt_map('ar_k_mesha_ori') = ar_k_mesha;
    
    % graphing based on coh_wkb, but that does not match optimal choice
    % matrixes for graphs.
    armt_map('mt_coh_wkb') = mt_interp_coh_grid_mesh_z;
    armt_map('it_ameshk_n') = length(ar_interp_coh_grid);
    armt_map('ar_a_meshk') = mt_interp_coh_grid_mesh_z(:,1);
    armt_map('ar_k_mesha') = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

%% Display Various Containers

if (bl_display_defparam)

    %% Display 1 support_map
    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 2 armt_map
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 3 param_map
    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 4 func_map
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 5 result_map
    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);

end

end

##### SOURCE END #####
--></body></html>