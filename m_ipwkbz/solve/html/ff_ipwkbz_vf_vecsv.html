
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_ipwkbz_vf_vecsv</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-11"><meta name="DC.source" content="ff_ipwkbz_vf_vecsv.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Pre-calculate u(c)</a></li><li><a href="#9">Iterate Value Function</a></li><li><a href="#11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</a></li><li><a href="#12">Solve Second Stage Problem k*(w,z)</a></li><li><a href="#13">Solve First Stage Problem w*(z) given k*(w,z)</a></li><li><a href="#14">Check Tolerance and Continuation</a></li><li><a href="#16">Process Optimal Choices</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> result_map = ff_ipwkbz_vf_vecsv(varargin)
</pre><h2 id="2">FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the two step solution with interpolation and with percentage asset grids version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html">ff_iwkz_vf_vecsv</a>. See that file for more descriptions.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ff_ipwkbz_evf.m">ff_ipwkbz_evf</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m">ffs_ipwkbz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m">ffs_ipwkbz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

<span class="comment">% parameters can be set inside ffs_ipwkbz_set_default_param or updated here</span>
<span class="comment">% param_map('it_w_perc_n') = 50;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('it_z_n') = 15;</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.025;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 0.001;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.25;</span>
<span class="comment">% param_map('it_w_perc_n') = 100;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('it_z_n') = 11;</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.1;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 10^-4;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.1;</span>
<span class="comment">%</span>
<span class="comment">% get armt and func map</span>
[armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkbz_vf_vecsv'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_w_perc'</span>, <span class="string">'ar_w_level'</span>, <span class="string">'ar_z'</span>});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {<span class="string">'ar_interp_c_grid'</span>, <span class="string">'ar_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z'</span>, <span class="string">'mt_z_mesh_coh_interp_grid'</span>,<span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>,<span class="keyword">...</span>
    <span class="string">'mt_w_by_interp_coh_interp_grid'</span>});
[ar_interp_c_grid, ar_interp_coh_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_w_perc,<span class="keyword">...</span>
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {<span class="string">'mt_coh_wkb'</span>, <span class="string">'mt_z_mesh_coh_wkb'</span>});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};


<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>,<span class="keyword">...</span>
    <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>, <span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_wprime'</span>});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min <span class="keyword">...</span>
    fl_nan_replace, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_graph_evf'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));

<span class="comment">% We did not need these in ff_oz_vf or ff_oz_vf_vec</span>
<span class="comment">% see</span>
<span class="comment">% &lt;https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html</span>
<span class="comment">% fs_u_c_partrepeat_main&gt; for why store using cells.</span>
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
<span class="keyword">for</span> it_z_i = 1:length(ar_z)
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
<span class="keyword">end</span>
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Pre-calculate u(c)</h2><p>Interpolation, see <a href="https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html">fs_u_c_partrepeat_main</a> for why interpolate over u(c)</p><pre class="codeinput"><span class="comment">% Evaluate</span>
<span class="keyword">if</span> (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
<span class="keyword">else</span>
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
<span class="keyword">end</span>
ar_interp_u_of_c_grid(ar_interp_c_grid &lt;= fl_c_min) = fl_u_cmin;

<span class="comment">% Get Interpolant</span>
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, <span class="string">'spline'</span>, <span class="string">'nearest'</span>);
</pre><h2 id="9">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</h2><p>v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see ffs_ipwkbz_get_funcgrid.m. Generate interpolant based on that, Then interpolate for the coh reachable levels given the k(w,z) percentage choice grids in the second stage of the problem</p><pre class="codeinput">    <span class="comment">% Generate Interpolant for v(coh,z)</span>
    f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

    <span class="comment">% Interpoalte for v(coh(k(w,z),b(w,z),z),z)</span>
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
</pre><h2 id="12">Solve Second Stage Problem k*(w,z)</h2><p>This is the key difference between this function and <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> which solves the two stages jointly Interpolation first, because solution coh grid is not the same as all points reachable by k and b choices given w.</p><pre class="codeinput">    support_map(<span class="string">'bl_graph_evf'</span>) = false;
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        support_map(<span class="string">'bl_graph_evf'</span>) = bl_graph_evf;
    <span class="keyword">end</span>
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = <span class="keyword">...</span>
        ff_ipwkbz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
</pre><h2 id="13">Solve First Stage Problem w*(z) given k*(w,z)</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:length(ar_z)

        <span class="comment">% Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z)</span>
        <span class="comment">% There are two w=k'+b' arrays. ar_w_level is the level even grid based</span>
        <span class="comment">% on which we solve the 2nd stage problem in ff_ipwkbz_evf.m. Here for</span>
        <span class="comment">% each coh level, we have a different vector of w levels, but the same</span>
        <span class="comment">% vector of percentage ws. So we need to interpolate to get the optimal</span>
        <span class="comment">% k* and b* choices at each percentage level of w.</span>
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

        <span class="comment">% Interpolate (2), shift from w_level to w_perc</span>
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;

        <span class="comment">% changes in w_perc kstar choices</span>
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);


        <span class="comment">% Consumption Update</span>
        <span class="comment">% Note that compared to</span>
        <span class="comment">% &lt;https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html</span>
        <span class="comment">% ffs_akz_set_functions&gt; the mt_c here is much smaller the same</span>
        <span class="comment">% number of columns (states) as in the ffs_akz_set_functions file,</span>
        <span class="comment">% but the number of rows equal to ar_w length.</span>
        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), <span class="keyword">...</span>
                      mt_w_astar_interp_z(mt_w_kstar_diff_idx), <span class="keyword">...</span>
                      mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c &lt;= fl_c_min);
        <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        <span class="comment">% Update Storage</span>
        <span class="keyword">if</span> (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        <span class="keyword">else</span>
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        <span class="keyword">end</span>
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;

        <span class="comment">% Generate Interpolant for (3) EV(k*(ar_w_perc),Z)</span>
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);
        <span class="comment">% Interpolate (3), EVAL add on future utility, N by N + N by N</span>
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        <span class="comment">% Index update</span>
        <span class="comment">% using the method below is much faster than index replace</span>
        <span class="comment">% see &lt;https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript&gt;</span>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        <span class="comment">% Default or Not Utility Handling</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if default: only today u(cmin), transition out next period, debt wiped out</span>
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed: v = u(cmin)</span>
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        <span class="keyword">end</span>

        <span class="comment">% percentage algorithm does not have invalid (check to make sure</span>
        <span class="comment">% min percent is not 0 in ffs_ipwkbz_get_funcgrid.m)</span>
        <span class="comment">% mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);</span>

        <span class="comment">% Optimization: remember matlab is column major, rows must be</span>
        <span class="comment">% choices, columns must be states</span>
        <span class="comment">% &lt;https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR&gt;</span>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        <span class="comment">% Generate Linear Opti Index</span>
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        <span class="comment">% Handle Default is optimal or not</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
            <span class="comment">% to default, non-default possible, but default could be optimal</span>
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_opti_kprime;
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed, then next period same state as now</span>
            <span class="comment">% this is absorbing state, this is the limiting case, single</span>
            <span class="comment">% state space point, lowest a and lowest shock has this.</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = min(ar_a);
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = 0;
        <span class="keyword">end</span>

        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        <span class="keyword">end</span>

    <span class="keyword">end</span>
</pre><h2 id="14">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
                                      mean(mt_pol_a_cur,1); <span class="keyword">...</span>
                                      mean(mt_pol_k_cur,1); <span class="keyword">...</span>
                                      mt_val_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_ameshk_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeoutput">VAL it_iter:5, fl_diff:8.513697e+01, fl_diff_pol:2.553271e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10        z11         z12       z13       z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    ________    _______    ______    ______    _______

    mval     4.888    4.9206     4.957     4.996    5.0373    5.0806    5.1262     5.174    5.2241     5.2765      5.3313     5.3882     5.447    5.5061     5.5624
    map     7.9571    7.6675    7.2433    6.6574    6.0625    5.2685    4.3478    3.2656    1.9667    0.60686    -0.89948    -2.6477    -4.627    -6.805    -9.0177
    mak     1.9108    2.1708    2.5534    3.0826    3.5997    4.2913    5.0799    5.9903    7.0527     8.2977      9.7085     11.329    13.137      15.1     17.055
    Hval    6.6926    6.6959    6.6998    6.7043    6.7095    6.7153    6.7219    6.7294    6.7378     6.7476      6.7586      6.771    6.7847    6.7995     6.8145
    Hap     37.387    37.387    37.387    36.168    36.168    34.948    34.948    33.728    32.508     28.753      27.565      25.19    22.815    20.439     16.876
    Hak     2.4994    2.4994    2.4994    3.7191    3.7191    4.9388    4.9388    6.1586    7.3783     9.5597      10.747     13.123    15.498    17.873     21.436

</pre><pre class="codeoutput">VAL it_iter:10, fl_diff:4.567689e+01, fl_diff_pol:5.303679e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11        z12        z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______    _______    _______

    mval    6.9369     7.015    7.1025    7.1962    7.2947    7.3975    7.5047    7.6163    7.7324    7.8531    7.9782     8.1075     8.2399     8.3723     8.4976
    map     11.332    10.868    10.459    9.9317    9.3396    8.6268    7.8023    6.8058    5.6491    4.3074     2.742    0.92393    -1.1377    -3.4011    -5.7358
    mak      1.859    2.2099    2.5519    3.0556    3.6177     4.295    5.0739     6.014    7.1004    8.3555    9.8128     11.495     13.392     15.453     17.559
    Hval    10.319    10.331    10.346    10.362    10.379    10.399     10.42    10.444     10.47    10.499     10.53     10.564     10.602     10.641      10.68
    Hap     46.309    44.929     43.42     43.42    42.072    42.072    40.724    39.376    38.029    36.681    35.333     32.637     31.289     27.245     24.549
    Hak     1.4478    2.8278    2.7621    2.7621    4.1101    4.1101     5.458     6.806    8.1539    9.5019     10.85     13.546     14.894     18.938     21.634

</pre><pre class="codeoutput">VAL it_iter:15, fl_diff:2.622958e+01, fl_diff_pol:3.505681e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12         z13         z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _________    _______    _______

    mval     8.038    8.1431    8.2612    8.3876    8.5207    8.6597    8.8047    8.9557    9.1129    9.2765    9.4464    9.6221       9.8023     9.9826     10.153
    map     12.569    12.162    11.787    11.269    10.602    9.8985    9.0027    7.9526    6.7566    5.3443    3.7237    1.9386    -0.048281    -2.2438    -4.5057
    mak     1.8589    2.2327    2.5668    3.0351    3.6452    4.2781    5.0937    6.0465     7.128    8.4005    9.8492    11.553        13.46     15.561     17.719
    Hval    12.469    12.489    12.513    12.538    12.567    12.598    12.632    12.668    12.709    12.753    12.802    12.855       12.913     12.974     13.033
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    35.268       32.508     29.748     25.608
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.488       15.248     18.008     22.148

</pre><pre class="codeoutput">VAL it_iter:20, fl_diff:1.546125e+01, fl_diff_pol:2.786622e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12        z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______    _______

    mval     8.676    8.7957    8.9303    9.0746    9.2267    9.3858     9.552    9.7254    9.9062    10.095    10.291    10.495     10.704     10.914     11.114
    map     12.965    12.511    12.116    11.562    10.863    10.176    9.3383    8.3363    7.2143    5.8815     4.356    2.5832    0.57132    -1.6434    -3.9291
    mak     1.8447    2.2416    2.5718    3.0455    3.6449    4.2872    5.0917    6.0556    7.1311    8.4121    9.8743    11.574       13.5     15.616     17.794
    Hval    13.773    13.799     13.83    13.864    13.901    13.942    13.986    14.033    14.085    14.142    14.204    14.271     14.343     14.418     14.492
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552     33.728     30.904      28.08
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778     15.602     18.426      21.25

</pre><pre class="codeoutput">VAL it_iter:25, fl_diff:9.198897e+00, fl_diff_pol:1.749720e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12        z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______    _______

    mval    9.0536    9.1809    9.3242     9.478    9.6404    9.8105    9.9886    10.175    10.369    10.573    10.785    11.006     11.233     11.462      11.68
    map     13.265    12.847    12.488     11.98    11.316    10.637    9.7528    8.7263    7.5837     6.214    4.6079    2.8028    0.72208    -1.4642    -3.7291
    mak     1.8572    2.2448    2.5702    3.0381    3.6575    4.2826    5.1079    6.0605    7.1224    8.3974    9.8917    11.573     13.529     15.653     17.852
    Hval    14.567    14.597    14.632    14.671    14.714     14.76    14.811    14.866    14.926    14.992    15.063    15.141     15.226     15.314     15.401
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552     33.728     30.904      28.08
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778     15.602     18.426      21.25

</pre><pre class="codeoutput">VAL it_iter:30, fl_diff:5.496980e+00, fl_diff_pol:1.303039e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______

    mval    9.2784      9.41    9.5581    9.7173    9.8855    10.062    10.247     10.44    10.643    10.854    11.076    11.307    11.545     11.786     12.015
    map     13.342    12.923     12.58    12.076    11.427    10.752    9.8883    8.8831    7.7557    6.4024    4.8304    3.0679    1.0162    -1.2203    -3.5165
    mak     1.8518    2.2493    2.5655     3.039    3.6542    4.2913    5.1111    6.0646    7.1312    8.4168    9.9121    11.588    13.543     15.674     17.856
    Hval    15.053    15.087    15.126    15.169    15.215    15.266    15.322    15.382    15.448    15.519    15.597    15.682    15.773     15.868     15.962
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728     30.904      28.08
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602     18.426      21.25

</pre><pre class="codeoutput">VAL it_iter:35, fl_diff:3.275763e+00, fl_diff_pol:8.900365e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______

    mval    9.4113    9.5454    9.6964    9.8587     10.03     10.21    10.399    10.597    10.804    11.021    11.248    11.486    11.731     11.978     12.214
    map     13.367    12.951    12.609    12.111    11.463    10.802    9.9469    8.9475    7.8217    6.4734    4.9168    3.1648    1.1458    -1.0698    -3.3463
    mak     1.8537    2.2508    2.5707    3.0431    3.6618    4.2889     5.106    6.0619    7.1352    8.4262     9.922    11.606    13.548     15.681      17.87
    Hval    15.348    15.383    15.425    15.471     15.52    15.575    15.634    15.698    15.769    15.845    15.928    16.019    16.116     16.218     16.317
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728     31.874      28.08
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602     17.456      21.25

</pre><pre class="codeoutput">VAL it_iter:40, fl_diff:1.933569e+00, fl_diff_pol:6.452966e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14        z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    _______    _______

    mval    9.4895     9.625    9.7776    9.9417    10.115    10.298    10.489    10.689    10.899     11.12     11.35    11.591     11.84     12.092     12.333
    map     13.379    12.964    12.624    12.134    11.478    10.822    9.9644    8.9684    7.8506    6.5158    4.9603    3.2158    1.2029    -1.0041    -3.2704
    mak     1.8545    2.2527     2.572    3.0377    3.6647    4.2902    5.1126    6.0681      7.14    8.4248     9.922    11.609    13.557     15.693     17.885
    Hval    15.523     15.56    15.604    15.651    15.704    15.761    15.822     15.89    15.963    16.043     16.13    16.225    16.327     16.433     16.536
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728     32.316      29.05
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602     17.014      20.28

</pre><pre class="codeoutput">VAL it_iter:45, fl_diff:1.129819e+00, fl_diff_pol:4.303910e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5351    9.6715    9.8251    9.9903    10.165    10.349    10.541    10.743    10.955    11.177     11.41    11.653    11.905       12.16     12.403
    map     13.384     12.97     12.63    12.141    11.488    10.831    9.9733    8.9796    7.8631    6.5351    4.9782    3.2367    1.2261    -0.96582    -3.2301
    mak     1.8548    2.2515    2.5727    3.0383    3.6664    4.2932    5.1153    6.0702    7.1444     8.423    9.9293    11.616    13.569      15.697     17.891
    Hval    15.626    15.664    15.709    15.758    15.812    15.871    15.934    16.004    16.079    16.161    16.251    16.349    16.453      16.563     16.669
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316      29.05
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014      20.28

</pre><pre class="codeoutput">VAL it_iter:50, fl_diff:6.551068e-01, fl_diff_pol:3.384479e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5619    9.6987    9.8528    10.019    10.194    10.378    10.572    10.775    10.988    11.211    11.445     11.69    11.943      12.199     12.444
    map     13.387    12.976    12.632    12.145    11.493    10.834    9.9782     8.987    7.8718    6.5408    4.9924    3.2487    1.2465    -0.95197    -3.2046
    mak     1.8546    2.2494    2.5729    3.0387    3.6661    4.2956    5.1199    6.0709     7.143    8.4272    9.9276    11.621    13.567      15.708     17.889
    Hval    15.686    15.725     15.77    15.821    15.875    15.935        16     16.07    16.147    16.231    16.323    16.422    16.529       16.64     16.748
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316      29.05
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014      20.28

</pre><pre class="codeoutput">VAL it_iter:55, fl_diff:3.787799e-01, fl_diff_pol:2.765822e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5777    9.7148    9.8692    10.035    10.211    10.396     10.59    10.793    11.007    11.231    11.466    11.711    11.965      12.222     12.468
    map     13.389    12.977    12.635    12.146    11.495    10.836     9.982    8.9925    7.8779     6.545    5.0022    3.2579    1.2564    -0.94103    -3.1957
    mak     1.8543    2.2486    2.5732    3.0389    3.6654    4.2958    5.1183    6.0696    7.1411    8.4287    9.9228    11.619    13.569      15.709     17.892
    Hval     15.72     15.76    15.806    15.856    15.912    15.972    16.038    16.109    16.187    16.272    16.364    16.464    16.572      16.685     16.794
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316      29.05
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014      20.28

</pre><pre class="codeoutput">VAL it_iter:60, fl_diff:2.200380e-01, fl_diff_pol:2.014029e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5871    9.7243    9.8789    10.045    10.221    10.406    10.601    10.804    11.018    11.242    11.478    11.723    11.978      12.235     12.482
    map     13.389    12.979    12.635    12.147    11.497    10.838    9.9843     8.995    7.8793    6.5459    5.0074    3.2632     1.261    -0.93117    -3.1904
    mak     1.8544    2.2479    2.5733    3.0392    3.6647    4.2962    5.1187    6.0708    7.1413    8.4309    9.9209    11.618    13.571      15.706     17.895
    Hval     15.74    15.779    15.826    15.877    15.933    15.993    16.059    16.131     16.21    16.295    16.388    16.489    16.598      16.711     16.821
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:65, fl_diff:1.296484e-01, fl_diff_pol:1.188686e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5929    9.7302    9.8849    10.051    10.228    10.413    10.607    10.811    11.025    11.249    11.485    11.731    11.986      12.243      12.49
    map     13.393    12.979    12.635    12.147    11.499    10.838    9.9843    8.9959    7.8823    6.5468    5.0094    3.2646     1.263    -0.92714    -3.1886
    mak     1.8544    2.2479    2.5733    3.0392    3.6639    4.2962    5.1187     6.071    7.1394    8.4311    9.9201    11.619    13.572      15.705     17.898
    Hval    15.751    15.791    15.837    15.889    15.945    16.006    16.072    16.144    16.223    16.308    16.402    16.503    16.612      16.726     16.836
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:70, fl_diff:7.824502e-02, fl_diff_pol:8.696438e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5965    9.7338    9.8886    10.055    10.231    10.417    10.611    10.815    11.029    11.253    11.489    11.735     11.99      12.248     12.495
    map     13.401    12.979    12.635    12.147    11.499    10.838    9.9843    8.9959    7.8828    6.5468    5.0075    3.2667    1.2638    -0.92533    -3.1873
    mak     1.8546    2.2479    2.5733    3.0392    3.6639    4.2962    5.1187     6.071    7.1407    8.4311    9.9232    11.618    13.572      15.704     17.898
    Hval    15.757    15.797    15.844    15.895    15.951    16.013    16.079    16.151     16.23    16.316    16.409    16.511     16.62      16.734     16.845
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:75, fl_diff:4.873003e-02, fl_diff_pol:9.598137e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.5988    9.7362    9.8909    10.058    10.234    10.419    10.613    10.817    11.031    11.256    11.492    11.738    11.993      12.251     12.498
    map     13.403    12.979    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8828    6.5468    5.0075    3.2667    1.2631    -0.92175    -3.1873
    mak     1.8546    2.2479    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1407    8.4311    9.9232    11.618    13.573      15.703     17.898
    Hval    15.761    15.801    15.848    15.899    15.955    16.017    16.083    16.155    16.234     16.32    16.414    16.516    16.625      16.739      16.85
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:80, fl_diff:3.140952e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6004    9.7377    9.8925    10.059    10.235    10.421    10.615    10.819    11.033    11.258    11.493     11.74    11.995      12.253       12.5
    map     13.405     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5468    5.0075    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4311    9.9232    11.618    13.573      15.703     17.897
    Hval    15.764    15.803     15.85    15.902    15.958    16.019    16.086    16.158    16.237    16.323    16.417    16.519    16.628      16.742     16.853
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:85, fl_diff:2.091260e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6014    9.7388    9.8936     10.06    10.236    10.422    10.616     10.82    11.034    11.259    11.495    11.741    11.996      12.254     12.501
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5468    5.0075    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4311    9.9232    11.618    13.573      15.703     17.897
    Hval    15.765    15.805    15.852    15.903    15.959    16.021    16.087    16.159    16.238    16.324    16.418     16.52     16.63      16.744     16.854
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:90, fl_diff:1.430825e-02, fl_diff_pol:9.043479e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6021    9.7395    9.8943    10.061    10.237    10.422    10.617    10.821    11.035     11.26    11.495    11.742    11.997      12.255     12.502
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0075    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9232    11.618    13.573      15.703     17.897
    Hval    15.766    15.806    15.853    15.904     15.96    16.022    16.088     16.16    16.239    16.326    16.419    16.521    16.631      16.745     16.855
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:95, fl_diff:9.997484e-03, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6027      9.74    9.8948    10.061    10.238    10.423    10.617    10.821    11.036     11.26    11.496    11.742    11.998      12.256     12.502
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0084    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9236    11.618    13.573      15.703     17.897
    Hval    15.766    15.806    15.853    15.905    15.961    16.022    16.089    16.161     16.24    16.326     16.42    16.522    16.631      16.745     16.856
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:100, fl_diff:7.093413e-03, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval     9.603    9.7404    9.8952    10.062    10.238    10.423    10.618    10.822    11.036    11.261    11.496    11.743    11.998      12.256     12.503
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0084    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9236    11.618    13.573      15.703     17.897
    Hval    15.767    15.807    15.854    15.905    15.961    16.023    16.089    16.162    16.241    16.327     16.42    16.522    16.632      16.746     16.857
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:105, fl_diff:5.087594e-03, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6033    9.7407    9.8955    10.062    10.238    10.424    10.618    10.822    11.036    11.261    11.497    11.743    11.998      12.256     12.503
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0084    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9236    11.618    13.573      15.703     17.897
    Hval    15.767    15.807    15.854    15.905    15.962    16.023    16.089    16.162    16.241    16.327    16.421    16.523    16.632      16.746     16.857
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:110, fl_diff:3.676229e-03, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6035    9.7409    9.8957    10.062    10.239    10.424    10.618    10.822    11.036    11.261    11.497    11.743    11.998      12.256     12.503
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0084    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9236    11.618    13.573      15.703     17.897
    Hval    15.767    15.807    15.854    15.906    15.962    16.023     16.09    16.162    16.241    16.327    16.421    16.523    16.632      16.746     16.857
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeoutput">VAL it_iter:115, fl_diff:2.669908e-03, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13        z14         z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ________    _______

    mval    9.6036     9.741    9.8958    10.062    10.239    10.424    10.618    10.822    11.037    11.261    11.497    11.743    11.999      12.257     12.503
    map     13.407     12.98    12.635    12.147    11.499    10.839    9.9852    8.9951    7.8847    6.5477    5.0084    3.2681    1.2639    -0.92175    -3.1853
    mak     1.8547    2.2474    2.5733    3.0392    3.6639    4.2963    5.1189    6.0718    7.1408    8.4314    9.9236    11.618    13.573      15.703     17.897
    Hval    15.768    15.807    15.854    15.906    15.962    16.023     16.09    16.162    16.241    16.327    16.421    16.523    16.633      16.747     16.857
    Hap     47.849    46.437    46.437    46.437    45.025    45.025    43.613    42.201    42.201    40.789    37.964    36.552    33.728      32.316     29.492
    Hak     1.4814    2.8935    2.8935    2.8935    4.3056    4.3056    5.7176    7.1297    7.1297    8.5418    11.366    12.778    15.602      17.014     19.838

</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 7.737290 seconds.
</pre><h2 id="16">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    <span class="comment">% graphing based on coh_wkb, but that does not match optimal choice</span>
    <span class="comment">% matrixes for graphs.</span>
    armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_interp_coh_grid_mesh_z;
    armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_interp_coh_grid);
    armt_map(<span class="string">'ar_a_meshk'</span>) = mt_interp_coh_grid_mesh_z(:,1);
    armt_map(<span class="string">'ar_k_mesha'</span>) = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                 valgap      polgap        z1           z2           z3           z4           z5           z6           z7           z8           z9           z10          z11          z12          z13          z14          z15   
                _________    _______    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________

    iter=1         293.84     2146.7            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=2         156.07     2564.3            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=3         114.57      833.9      0.99741      0.99741      0.99676      0.99741      0.99547      0.99352      0.99352      0.99482      0.99352      0.99158      0.99093      0.98834      0.98705       0.9864      0.98705
    iter=4         98.166     409.26      0.99611      0.99482      0.99482      0.99611      0.99741      0.99547      0.99676      0.99417      0.99223      0.99158      0.99223      0.98834      0.99158      0.99028      0.99093
    iter=5         85.137     255.33      0.99352      0.99482      0.99352      0.99352      0.99417      0.99352      0.99288      0.99352      0.99288      0.99223      0.99158      0.99288      0.99482      0.99158      0.99223
    iter=6         74.446     154.34      0.99223      0.99352      0.99352      0.99352      0.99223      0.99223      0.99223      0.99093      0.99288      0.98899      0.98964      0.99028      0.98769      0.99093      0.98575
    iter=7         65.492     126.01      0.97021       0.9728      0.97927      0.97668      0.97798      0.97798      0.97474      0.98057      0.97992      0.98381      0.97927      0.98122      0.98575      0.98705       0.9851
    iter=8         57.891     93.765       0.6101      0.66839       0.7513      0.84845      0.85233      0.86399       0.8342      0.83808      0.81801       0.8193      0.81412      0.80505      0.79145      0.82513      0.88666
    iter=9         51.348     85.554      0.75518      0.74482      0.73057      0.70207      0.67617      0.65155       0.6399      0.59585      0.57642      0.53627      0.52267      0.58679      0.67034      0.72668      0.71244
    iter=10        45.677     53.037      0.30181      0.25777      0.24093      0.27979      0.31995      0.35233      0.40285      0.44171      0.49741      0.55894      0.60622      0.57772      0.54922      0.51101      0.46632
    iter=11         40.74     68.384      0.51554      0.56088      0.56606      0.53497      0.50259      0.45596      0.41969      0.37694      0.32383       0.2785      0.31606      0.35622      0.40803      0.46632      0.51554
    iter=12        36.418     41.864       0.1943      0.19948       0.2215      0.24611      0.27591      0.29793      0.33549      0.38083      0.41451      0.45725       0.4158      0.36528       0.3329      0.29663      0.33549
    iter=13        32.593     37.277      0.18912      0.14378      0.11658      0.13212      0.14767      0.16062      0.17617      0.21114      0.23446      0.25648      0.30181      0.32513      0.37047      0.38666      0.33225
    iter=14        29.216     49.269      0.33938      0.36788      0.35881      0.31736      0.29145      0.23834      0.19301      0.14249      0.14637      0.16451      0.19819      0.22021      0.24741      0.29404      0.30829
    iter=15         26.23     35.057      0.17228      0.18394       0.1943      0.21632      0.23057      0.25777      0.28368       0.3044      0.26295      0.20466      0.14637      0.15933      0.18005      0.19819      0.22668
    iter=16        23.572       28.8     0.098446      0.11528      0.11788      0.14119      0.14637      0.16192      0.17228      0.19171      0.21373      0.24093      0.27202      0.24093       0.1658      0.16839      0.17358
    iter=17        21.199     27.491     0.071244     0.069948     0.081606     0.086788      0.09715       0.1101      0.12565      0.13342      0.14378      0.16839      0.18199      0.20207      0.24741      0.21114      0.13666
    iter=18        19.076     22.737     0.050518     0.053109      0.05829     0.064767     0.073834      0.07513     0.086788      0.09715      0.10751      0.12176      0.13795      0.15415      0.16321      0.20207      0.21244
    iter=19        17.171      17.22     0.084197     0.036269     0.041451     0.047927     0.050518     0.064767     0.066062     0.071244     0.090674     0.090674      0.10751      0.12824      0.14637      0.15091      0.17228
    iter=20        15.461     27.866      0.15803      0.16839      0.13472      0.09456     0.051813     0.044041     0.047927     0.062176     0.055699      0.07513     0.089378     0.095855      0.12306      0.12047      0.13731
    iter=21        13.929     24.138      0.11658      0.12306      0.12306      0.13212      0.14249      0.12565     0.072539     0.047927     0.062176     0.066062      0.07772     0.079016      0.08614     0.099741      0.10492
    iter=22        12.553     20.838     0.085492     0.082902     0.090674      0.10492      0.10363      0.11528      0.12824      0.10363     0.059585     0.056995     0.051813     0.064767     0.073187     0.088083     0.091969
    iter=23        11.315     18.989     0.064767     0.064767     0.071244      0.07513      0.07513     0.091969     0.091969      0.10492      0.11528     0.082902     0.050518     0.054404     0.076425     0.066062     0.080311
    iter=24        10.202     14.892     0.047927     0.047927     0.055699     0.055699     0.060881      0.07513     0.080311     0.073834     0.088083      0.10622      0.09715     0.046632     0.067358     0.068653     0.073834
    iter=25        9.1989     17.497      0.03886     0.040155     0.044041     0.045337     0.051813     0.055699     0.060881     0.071244     0.073834     0.088083     0.089378     0.084197     0.045337     0.042746     0.054404
    iter=26        8.2961     11.413     0.028497     0.031088     0.036269     0.040155     0.040155     0.044041     0.045337     0.053109      0.05829     0.080311     0.080311     0.093264     0.081606     0.045337     0.050518
    iter=27        7.4832     14.868     0.023316     0.027202     0.024611     0.033679     0.041451     0.033679     0.041451     0.051813     0.054404     0.062176     0.059585     0.067358     0.069948     0.071244     0.042746
    iter=28        6.7513     15.925     0.022021     0.020725     0.023316     0.027202     0.032383     0.029793     0.034974     0.047927     0.047927     0.053109     0.053109     0.069301     0.073834     0.079016     0.047927
    iter=29        6.0919     12.958     0.016839     0.018135     0.018135     0.023316     0.018135     0.025907     0.028497     0.033679     0.036269     0.046632     0.053109     0.049223     0.053109     0.066062     0.070596
    iter=30         5.497      13.03     0.012953     0.015544     0.014249     0.015544     0.020725     0.024611     0.022021     0.028497     0.028497     0.033679     0.034974     0.045337     0.051813     0.056995     0.056995
    iter=31        4.9593     10.562     0.011658     0.012953     0.016839      0.01943     0.018135     0.022021     0.016839     0.027202     0.025907     0.033679     0.040155     0.033679     0.040155     0.045337     0.063472
    iter=32        4.4732     12.221     0.012953     0.010363     0.016839     0.012953     0.020725     0.018135      0.01943      0.01943     0.028497     0.023316     0.029793     0.036269     0.041451     0.054404     0.046632
    iter=33        4.0334     7.9925    0.0090674     0.007772    0.0090674     0.010363     0.012953     0.011658     0.018135     0.014249     0.020725     0.027202     0.020725     0.032383     0.033679     0.037565     0.040155
    iter=34        3.6356     8.0813    0.0064767     0.007772    0.0090674    0.0090674     0.007772     0.012953     0.018135     0.014249     0.010363     0.029793     0.024611     0.036269     0.034974     0.037565     0.033679
    iter=35        3.2758     8.9004    0.0064767     0.007772    0.0064767     0.007772     0.012953     0.007772     0.011658     0.016839     0.024611     0.015544     0.025907     0.020725     0.022021     0.022021     0.034974
    iter=36        2.9504     6.9553     0.003886    0.0051813     0.003886     0.010363    0.0064767     0.007772    0.0090674     0.007772     0.012953     0.016839     0.023316     0.018135     0.023316     0.025907     0.032383
    iter=37        2.6563     7.0117    0.0064767    0.0090674    0.0064767    0.0064767     0.003886    0.0090674     0.012953     0.014249     0.015544     0.015544     0.014249      0.01943     0.020725     0.024611     0.027202
    iter=38        2.3905     7.2077    0.0025907     0.003886    0.0064767     0.003886     0.007772    0.0051813     0.014249    0.0064767     0.010363     0.010363     0.012953     0.011658     0.018135     0.020725     0.024611
    iter=39        2.1504     6.7684     0.003886     0.003886    0.0051813     0.003886    0.0051813    0.0051813     0.011658     0.011658    0.0090674    0.0064767     0.012953     0.014249     0.010363      0.01943     0.020725
    iter=40        1.9336      6.453    0.0025907     0.003886    0.0025907     0.003886    0.0051813     0.003886    0.0051813    0.0064767    0.0051813     0.010363     0.011658     0.020725     0.018135     0.024611     0.016839
    iter=41        1.7379      5.914    0.0012953    0.0012953    0.0025907    0.0025907     0.007772    0.0064767     0.007772    0.0090674    0.0064767     0.007772     0.010363    0.0064767     0.014249     0.012953     0.018135
    iter=42        1.5614      5.791    0.0012953    0.0025907     0.003886     0.003886    0.0025907    0.0025907    0.0025907    0.0051813     0.012953     0.003886     0.014249     0.011658     0.007772      0.01943     0.015544
    iter=43        1.4023     5.0539    0.0025907    0.0025907    0.0012953    0.0025907    0.0064767    0.0064767     0.003886     0.003886     0.003886    0.0064767     0.011658    0.0064767     0.014249     0.010363     0.011658
    iter=44        1.2589     4.9605    0.0025907    0.0012953    0.0025907    0.0012953    0.0025907     0.003886     0.003886    0.0051813     0.003886    0.0051813     0.003886    0.0051813     0.010363    0.0090674     0.015544
    iter=45        1.1298     4.3039    0.0012953            0    0.0012953    0.0012953    0.0025907     0.007772     0.007772    0.0012953     0.003886     0.007772    0.0051813     0.007772    0.0064767     0.010363     0.010363
    iter=46        1.0136     3.3597    0.0051813    0.0012953    0.0012953    0.0012953    0.0012953    0.0025907    0.0025907     0.003886    0.0025907     0.003886     0.007772    0.0064767    0.0064767    0.0090674     0.007772
    iter=47       0.90915     3.9985            0    0.0012953            0    0.0025907    0.0012953    0.0012953     0.007772    0.0012953    0.0051813     0.003886    0.0051813     0.003886     0.003886     0.010363    0.0051813
    iter=48       0.81523     3.7005    0.0025907            0    0.0012953    0.0012953    0.0012953    0.0064767     0.003886     0.003886    0.0025907     0.007772    0.0025907    0.0064767    0.0025907     0.007772     0.007772
    iter=49       0.73086     3.8225            0    0.0012953    0.0012953            0    0.0025907    0.0025907    0.0012953     0.003886    0.0051813    0.0025907     0.003886    0.0025907    0.0064767     0.003886    0.0090674
    iter=50       0.65511     3.3845    0.0012953    0.0012953            0    0.0012953    0.0012953            0    0.0025907    0.0012953    0.0012953    0.0012953    0.0064767     0.003886     0.003886     0.003886     0.003886
    iter=68       0.09543          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=69      0.086358     2.0595    0.0012953            0            0            0            0            0            0            0    0.0025907            0            0            0    0.0012953            0    0.0012953
    iter=70      0.078245    0.86964            0            0            0            0            0            0            0            0    0.0012953            0            0            0            0            0            0
    iter=71      0.070984     1.1252            0            0            0            0            0            0    0.0012953            0            0            0            0            0    0.0025907            0            0
    iter=72      0.064481     1.8957    0.0012953            0            0            0            0    0.0012953            0            0            0            0            0            0            0    0.0012953            0
    iter=73      0.058653          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=74      0.053425      2.472            0            0            0            0            0            0            0            0            0            0            0            0            0     0.003886            0
    iter=75       0.04873    0.95981            0            0            0            0            0            0            0    0.0025907            0            0            0            0            0            0            0
    iter=76       0.04451     2.2878    0.0012953    0.0012953            0            0            0            0            0            0    0.0012953            0            0     0.003886            0            0            0
    iter=77      0.040712    0.99825            0            0            0            0            0            0            0            0            0            0            0            0    0.0012953            0            0
    iter=78      0.037289          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=79        0.0342     2.0206            0            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0012953
    iter=80       0.03141          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=81      0.028884          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=82      0.026596          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=83      0.024519          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=84      0.022631     1.5045    0.0012953            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=85      0.020913          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=86      0.019346          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=87      0.017915          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=88      0.016606          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=89      0.015408          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=90      0.014308    0.90435            0            0            0            0            0            0            0            0            0    0.0012953            0            0            0            0            0
    iter=91      0.013298    0.94109            0            0            0            0            0            0            0            0            0            0    0.0012953            0            0            0            0
    iter=92       0.01237          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=93      0.011514          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=94      0.010726          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=95     0.0099975          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=96     0.0093244          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=97     0.0087016          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=98     0.0081247          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=99     0.0075898          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=100    0.0070934          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=101    0.0066323          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=102    0.0062037          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=103    0.0058048          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=104    0.0054335          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=105    0.0050876          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=106    0.0047651          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=107    0.0044642          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=108    0.0041834          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=109    0.0039212          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=110    0.0036762          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=111    0.0034472          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=112    0.0032331          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=113    0.0030328          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=114    0.0028454          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=115    0.0026699          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=116    0.0025056          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=117    0.0023517          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0

tb_val
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0           -53.847        -53.722       -53.578      -53.419       -53.248      -53.064       -52.191       -51.934        -51.66       -51.371       -51.074      -50.787 
    coh2:k=-19.8998,b=0      -37.003        -35.491       -34.003      -32.593        -31.24      -29.967       -25.537       -24.553       -23.615       -22.725       -21.894      -21.153 
    coh3:k=-19.7995,b=0      -22.776        -20.966       -19.141      -17.413       -15.793      -14.271       -9.0319       -7.8945       -6.8143       -5.7923       -4.8414      -3.9946 
    coh4:k=-19.6993,b=0      -18.818        -17.502       -16.107      -14.714       -13.343       -12.01       -7.1088       -5.9932       -4.9213       -3.9013       -2.9519      -2.1065 
    coh5:k=-19.5991,b=0      -16.625        -15.419       -14.132      -12.833       -11.553      -10.308       -5.7784       -4.7516       -3.7676       -2.8295       -1.9458      -1.1481 
    coh6:k=-19.4989,b=0       -14.93        -13.817       -12.628      -11.437       -10.267      -9.1271       -4.8876        -3.897       -2.9356       -2.0105       -1.1374     -0.35545 
    coh7:k=-19.3986,b=0      -13.605        -12.592       -11.504      -10.402       -9.3072      -8.2271       -4.1332       -3.1804       -2.2601       -1.3745      -0.54185      0.20781 
    coh8:k=-19.2984,b=0      -12.583        -11.627       -10.596      -9.5421       -8.4911      -7.4534       -3.5375       -2.6234       -1.7313      -0.86802     -0.049216      0.69149 
    coh9:k=-19.1982,b=0      -11.707        -10.794       -9.8072      -8.7973       -7.7899      -6.8023       -3.0323       -2.1365       -1.2626      -0.42005       0.37615       1.0961 
    coh10:k=-19.0979,b=0     -10.937        -10.063       -9.1166      -8.1548       -7.1936      -6.2454       -2.5825       -1.7102      -0.86258     -0.044684       0.73375       1.4399 
    coh11:k=-18.9977,b=0     -10.259        -9.4213       -8.5189      -7.5961       -6.6692      -5.7477       -2.1883       -1.3427      -0.51409       0.29135        1.0585       1.7526 
    coh12:k=-18.8975,b=0     -9.6585        -8.8569       -7.9877      -7.0929       -6.1932      -5.2969       -1.8391       -1.0084      -0.19364       0.59658        1.3455        2.026 
    coh13:k=-18.7972,b=0     -9.1224        -8.3449       -7.5019      -6.6336       -5.7585      -4.8925       -1.5171      -0.70306       0.09257       0.86629        1.6036       2.2743 
    coh14:k=-18.697,b=0      -8.6299        -7.8749        -7.056      -6.2111       -5.3656      -4.5227       -1.2217      -0.42631       0.35402        1.1153        1.8429       2.5028 
    coh15:k=-18.5968,b=0     -8.1753        -7.4417       -6.6457      -5.8291       -5.0049      -4.1818      -0.95378      -0.17221       0.59708        1.3481        2.0636       2.7121 
    coh16:k=-18.4966,b=0     -7.7537        -7.0435       -6.2728      -5.4746       -4.6691      -3.8638      -0.70315      0.066249       0.82184        1.5605        2.2644       2.9061 
    coh17:k=-18.3963,b=0     -7.3695        -6.6763       -5.9243      -5.1433       -4.3551      -3.5676      -0.46751       0.28791        1.0321        1.7582        2.4541       3.0887 
    coh18:k=-18.2961,b=0     -7.0077        -6.3323       -5.5969      -4.8328       -4.0637      -3.2924      -0.24836        0.4955         1.228        1.9453        2.6329       3.2574 
    coh19:k=-18.1959,b=0     -6.6689        -6.0086       -5.2883      -4.5435       -3.7886      -3.0345     -0.041789       0.69043        1.4138        2.1226        2.7989       3.4172 
    coh20:k=-18.0956,b=0      -6.349        -5.7042       -4.9979      -4.2691       -3.5306      -2.7901       0.15309       0.87561          1.59         2.287        2.9567       3.5687 
    coh21:k=-17.9954,b=0      -6.046        -5.4152       -4.7264      -4.0105       -3.2855      -2.5568       0.33865        1.0517        1.7544        2.4439        3.1069       3.7115 
    coh22:k=-17.8952,b=0     -5.7615        -5.1424       -4.4683      -3.7645       -3.0523      -2.3349       0.51534        1.2177        1.9119        2.5942        3.2489       3.8472 
    coh23:k=-17.7949,b=0     -5.4922         -4.884       -4.2213      -3.5302       -2.8306      -2.1268       0.68324         1.376        2.0631        2.7376        3.3846       3.9766 
    coh24:k=-17.6947,b=0     -5.2338        -4.6372       -3.9854      -3.3076       -2.6185      -1.9276       0.84284        1.5278        2.2079        2.8733        3.5143        4.101 
    coh25:k=-17.5945,b=0     -4.9872        -4.4013       -3.7599      -3.0953       -2.4171      -1.7361        0.9961        1.6739        2.3443        3.0038        3.6389       4.2192 
    coh26:k=-17.4943,b=0     -4.7508         -4.177       -3.5452      -2.8903       -2.2237      -1.5518        1.1436        1.8132        2.4758        3.1292        3.7575       4.3333 
    coh27:k=-17.394,b=0      -4.5236        -3.9605       -3.3401      -2.6944       -2.0378      -1.3746        1.2862        1.9465        2.6031          3.25        3.8718       4.4422 
    coh28:k=-17.2938,b=0     -4.3055        -3.7519       -3.1429       -2.506       -1.8602      -1.2053        1.4221        2.0755        2.7261        3.3649        3.9819       4.5475 
    coh29:k=-17.1936,b=0     -4.0973        -3.5528        -2.953      -2.3247       -1.6872       -1.043         1.553        2.2005        2.8443        3.4775        4.0886       4.6483 
    coh30:k=-17.0933,b=0      -3.896        -3.3605       -2.7697      -2.1506       -1.5209      -0.8863        1.6796        2.3212        2.9574        3.5857        4.1918       4.7475 
    coh31:k=-16.9931,b=0     -3.7014        -3.1746       -2.5921      -1.9834       -1.3613     -0.73484        1.8018        2.4371        3.0672        3.6904        4.2903       4.8423 
    coh32:k=-16.8929,b=0     -3.5128        -2.9947       -2.4205      -1.8216       -1.2069     -0.58794        1.9211        2.5489        3.1739        3.7914        4.3868       4.9343 
    coh33:k=-16.7926,b=0     -3.3297         -2.822       -2.2559       -1.664       -1.0574     -0.44525        2.0362        2.6574        3.2775        3.8887        4.4801       5.0232 
    coh34:k=-16.6924,b=0     -3.1522        -2.6546       -2.0965      -1.5115      -0.91292     -0.30722        2.1474        2.7628        3.3777        3.9833        4.5706       5.1088 
    coh35:k=-16.5922,b=0     -2.9798        -2.4905       -1.9417      -1.3636      -0.77349     -0.17399        2.2555        2.8661        3.4746         4.076        4.6583        5.193 
    coh36:k=-16.492,b=0      -2.8134        -2.3312       -1.7913      -1.2199      -0.63741    -0.044549        2.3607        2.9665        3.5691        4.1663        4.7431       5.2746 
    coh37:k=-16.3917,b=0     -2.6521        -2.1767       -1.6455       -1.081      -0.50445     0.081267         2.462        3.0634        3.6611        4.2543        4.8265       5.3542 
    coh38:k=-16.2915,b=0     -2.4951        -2.0263       -1.5043      -0.9464      -0.37573      0.20339        2.5621        3.1576        3.7511        4.3392        4.9078       5.4319 
    coh39:k=-16.1913,b=0     -2.3421        -1.8797       -1.3652     -0.81535      -0.25041      0.32153        2.6594        3.2495        3.8389        4.4219        4.9872       5.5069 
    coh40:k=-16.091,b=0      -2.1928        -1.7368       -1.2291      -0.6877      -0.12836      0.43729        2.7539        3.3387        3.9241        4.5027        5.0646       5.5805 
    coh41:k=-15.9908,b=0     -2.0482        -1.5984        -1.097     -0.56334    -0.0095101      0.55089        2.8461        3.4255        4.0069        4.5812        5.1395       5.6526 
    coh42:k=-15.8906,b=0     -1.9075        -1.4635      -0.96846     -0.44262        0.1058      0.66116        2.9361        3.5115        4.0877        4.6585        5.2126       5.7229 
    coh43:k=-15.7903,b=0     -1.7686        -1.3317      -0.84278     -0.32404       0.21825      0.76868        3.0238        3.5952        4.1668        4.7342         5.284       5.7917 
    coh44:k=-15.6901,b=0     -1.6324        -1.2028      -0.71988      -0.2072        0.3281      0.87372        3.1092        3.6769        4.2437        4.8076        5.3536       5.8587 
    coh45:k=-15.5899,b=0     -1.4997        -1.0768      -0.59972    -0.092973       0.43547      0.97641        3.1928        3.7568        4.3193        4.8795        5.4221        5.924 
    coh46:k=-15.4897,b=0     -1.3706       -0.95429      -0.48293     0.018128       0.54019       1.0766        3.2748        3.8351        4.3943        4.9501        5.4897       5.9879 
    coh47:k=-15.3894,b=0     -1.2443        -0.8332      -0.36862       0.1269       0.64223       1.1743        3.3554        3.9113        4.4673        5.0192         5.556       6.0506 
    coh48:k=-15.2892,b=0     -1.1205        -0.7143      -0.25657      0.23352       0.74341         1.27        3.4344        3.9858        4.5386        5.0866        5.6208       6.1127 
    coh49:k=-15.189,b=0      -0.9992       -0.59784      -0.14673      0.33804       0.84268       1.3637        3.5118        4.0588        4.6085        5.1531        5.6843       6.1738 
    coh50:k=-15.0887,b=0     -0.8803       -0.48379     -0.039096      0.44044       0.93995       1.4556        3.5877        4.1305        4.6771        5.2188        5.7465       6.2337 
    coh723:k=52.366,b=0       15.415         15.457        15.506       15.559        15.618       15.682        15.999        16.096        16.203        16.317        16.437       16.555 
    coh724:k=52.4662,b=0      15.423         15.465        15.514       15.567        15.626        15.69        16.006        16.104         16.21        16.324        16.444       16.562 
    coh725:k=52.5665,b=0      15.432         15.474        15.522       15.576        15.634       15.698        16.014        16.111        16.217        16.331        16.451       16.569 
    coh726:k=52.6667,b=0       15.44         15.482         15.53       15.584        15.642       15.706        16.021        16.119        16.225        16.338        16.458       16.576 
    coh727:k=52.7669,b=0      15.448          15.49        15.539       15.592         15.65       15.714        16.029        16.126        16.232        16.346        16.465       16.583 
    coh728:k=52.8671,b=0      15.457         15.498        15.547         15.6        15.658       15.722        16.037        16.134        16.239        16.353        16.472       16.589 
    coh729:k=52.9674,b=0      15.465         15.507        15.555       15.608        15.666        15.73        16.044        16.141        16.246         16.36        16.479       16.596 
    coh730:k=53.0676,b=0      15.473         15.515        15.563       15.616        15.674       15.738        16.052        16.149        16.254        16.367        16.486       16.603 
    coh731:k=53.1678,b=0      15.482         15.523        15.571       15.624        15.682       15.746        16.059        16.156        16.261        16.374        16.493        16.61 
    coh732:k=53.2681,b=0       15.49         15.531        15.579       15.632         15.69       15.753        16.067        16.163        16.268        16.381          16.5       16.617 
    coh733:k=53.3683,b=0      15.498         15.539        15.588        15.64        15.698       15.761        16.074        16.171        16.275        16.388        16.507       16.623 
    coh734:k=53.4685,b=0      15.506         15.548        15.596       15.649        15.706       15.769        16.082        16.178        16.283        16.395        16.514        16.63 
    coh735:k=53.5688,b=0      15.515         15.556        15.604       15.657        15.714       15.777        16.089        16.185         16.29        16.403         16.52       16.637 
    coh736:k=53.669,b=0       15.523         15.564        15.612       15.665        15.722       15.785        16.097        16.193        16.297         16.41        16.527       16.644 
    coh737:k=53.7692,b=0      15.531         15.572         15.62       15.673         15.73       15.793        16.104          16.2        16.304        16.417        16.534        16.65 
    coh738:k=53.8694,b=0      15.539          15.58        15.628       15.681        15.738       15.801        16.112        16.207        16.312        16.424        16.541       16.657 
    coh739:k=53.9697,b=0      15.548         15.588        15.636       15.689        15.746       15.809        16.119        16.215        16.319        16.431        16.548       16.664 
    coh740:k=54.0699,b=0      15.556         15.597        15.644       15.697        15.754       15.816        16.126        16.222        16.326        16.438        16.555        16.67 
    coh741:k=54.1701,b=0      15.564         15.605        15.652       15.705        15.762       15.824        16.134        16.229        16.333        16.445        16.562       16.677 
    coh742:k=54.2704,b=0      15.572         15.613         15.66       15.713         15.77       15.832        16.141        16.237         16.34        16.452        16.569       16.684 
    coh743:k=54.3706,b=0       15.58         15.621        15.668       15.721        15.778        15.84        16.149        16.244        16.347        16.459        16.575        16.69 
    coh744:k=54.4708,b=0      15.589         15.629        15.676       15.728        15.785       15.848        16.156        16.251        16.355        16.466        16.582       16.697 
    coh745:k=54.5711,b=0      15.597         15.637        15.684       15.736        15.793       15.855        16.163        16.258        16.362        16.473        16.589       16.703 
    coh746:k=54.6713,b=0      15.604         15.645        15.692       15.744        15.801       15.863        16.171        16.266        16.369         16.48        16.596        16.71 
    coh747:k=54.7715,b=0      15.613         15.653          15.7       15.752        15.809       15.871        16.178        16.273        16.376        16.487        16.602       16.716 
    coh748:k=54.8717,b=0      15.621         15.661        15.708        15.76        15.817       15.879        16.185         16.28        16.383        16.493        16.609       16.723 
    coh749:k=54.972,b=0       15.629         15.669        15.716       15.768        15.825       15.886        16.193        16.287         16.39          16.5        16.616       16.729 
    coh750:k=55.0722,b=0      15.637         15.677        15.724       15.776        15.832       15.894          16.2        16.294        16.397        16.507        16.623       16.736 
    coh751:k=55.1724,b=0      15.645         15.685        15.732       15.784         15.84       15.902        16.207        16.302        16.404        16.514        16.629       16.743 
    coh752:k=55.2727,b=0      15.653         15.693         15.74       15.792        15.848        15.91        16.215        16.309        16.411        16.521        16.636       16.749 
    coh753:k=55.3729,b=0      15.661         15.701        15.748       15.799        15.856       15.917        16.222        16.316        16.418        16.528        16.643       16.755 
    coh754:k=55.4731,b=0      15.669         15.709        15.756       15.807        15.863       15.925        16.229        16.323        16.425        16.535        16.649       16.761 
    coh755:k=55.5734,b=0      15.677         15.717        15.764       15.815        15.871       15.933        16.236         16.33        16.432        16.542        16.656       16.766 
    coh756:k=55.6736,b=0      15.685         15.725        15.771       15.823        15.879        15.94        16.244        16.337        16.439        16.548        16.662       16.772 
    coh757:k=55.7738,b=0      15.693         15.733        15.779       15.831        15.887       15.948        16.251        16.345        16.446        16.555        16.668       16.778 
    coh758:k=55.874,b=0       15.701          15.74        15.787       15.838        15.894       15.955        16.258        16.352        16.453        16.562        16.675       16.785 
    coh759:k=55.9743,b=0      15.709         15.748        15.795       15.846        15.902       15.963        16.265        16.359         16.46        16.568        16.681       16.791 
    coh760:k=56.0745,b=0      15.717         15.756        15.803       15.854         15.91       15.971        16.273        16.366        16.467        16.575        16.688       16.798 
    coh761:k=56.1747,b=0      15.724         15.764        15.811       15.862        15.917       15.978         16.28        16.373        16.474        16.582        16.695       16.804 
    coh762:k=56.275,b=0       15.732         15.772        15.818       15.869        15.925       15.986        16.287         16.38        16.481        16.589        16.701        16.81 
    coh763:k=56.3752,b=0      15.734         15.774         15.82       15.871        15.927       15.988        16.289        16.382        16.482         16.59        16.703       16.812 
    coh764:k=56.4754,b=0      15.735         15.774        15.821       15.872        15.927       15.988        16.289        16.382        16.483        16.591        16.703       16.812 
    coh765:k=56.5757,b=0      15.735         15.775        15.821       15.872        15.928       15.989         16.29        16.383        16.483        16.591        16.704       16.815 
    coh766:k=56.6759,b=0      15.736         15.775        15.822       15.873        15.928       15.989         16.29        16.383        16.484        16.593        16.708       16.822 
    coh767:k=56.7761,b=0      15.736         15.776        15.822       15.873        15.929        15.99        16.292        16.386        16.489        16.599        16.715       16.828 
    coh768:k=56.8763,b=0      15.737         15.777        15.824       15.875        15.932       15.994        16.299        16.393        16.496        16.606        16.721       16.834 
    coh769:k=56.9766,b=0      15.744         15.784        15.831       15.883        15.939       16.001        16.306          16.4        16.503        16.613        16.728       16.841 
    coh770:k=57.0768,b=0      15.752         15.792        15.839       15.891        15.947       16.009        16.313        16.407         16.51        16.619        16.734       16.847 
    coh771:k=57.177,b=0        15.76           15.8        15.847       15.898        15.955       16.016         16.32        16.414        16.516        16.626        16.741       16.852 
    coh772:k=57.2773,b=0      15.768         15.808        15.854       15.906        15.962       16.023        16.327        16.421        16.523        16.633        16.747       16.857 

tb_pol_a
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0           -2.0567       -2.0567       -2.4641      -3.2788      -3.6861       -4.5008       -8.9816       -10.727       -13.055       -15.499       -18.351        -19.98 
    coh2:k=-19.8998,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh3:k=-19.7995,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh4:k=-19.6993,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh5:k=-19.5991,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh6:k=-19.4989,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh7:k=-19.3986,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh8:k=-19.2984,b=0          -20           -20           -20          -20          -20           -20           -20           -20           -20           -20           -20           -20 
    coh9:k=-19.1982,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999           -20           -20           -20           -20           -20           -20 
    coh10:k=-19.0979,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999           -20           -20           -20           -20           -20 
    coh11:k=-18.9977,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh12:k=-18.8975,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh13:k=-18.7972,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh14:k=-18.697,b=0      -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh15:k=-18.5968,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh16:k=-18.4966,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh17:k=-18.3963,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh18:k=-18.2961,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh19:k=-18.1959,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh20:k=-18.0956,b=0     -19.999       -19.999       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh21:k=-17.9954,b=0     -19.998       -19.998       -19.999      -19.999      -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh22:k=-17.8952,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh23:k=-17.7949,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.999       -19.999       -19.999       -19.999       -19.999       -19.999 
    coh24:k=-17.6947,b=0     -19.998       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.999       -19.999 
    coh25:k=-17.5945,b=0      -19.95       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh26:k=-17.4943,b=0     -19.887       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh27:k=-17.394,b=0      -19.819       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh28:k=-17.2938,b=0     -19.746       -19.998       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh29:k=-17.1936,b=0     -19.668       -19.966       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh30:k=-17.0933,b=0     -19.584       -19.906       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh31:k=-16.9931,b=0      -19.51       -19.829       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh32:k=-16.8929,b=0     -19.375       -19.748       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh33:k=-16.7926,b=0     -19.297       -19.661       -19.998      -19.998      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh34:k=-16.6924,b=0     -19.218         -19.6       -19.966      -19.997      -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh35:k=-16.5922,b=0      -19.11       -19.442       -19.903      -19.997      -19.997       -19.997       -19.998       -19.998       -19.998       -19.998       -19.998       -19.998 
    coh36:k=-16.492,b=0      -19.039        -19.38       -19.823      -19.997      -19.997       -19.997       -19.997       -19.997       -19.998       -19.998       -19.998       -19.998 
    coh37:k=-16.3917,b=0     -18.965       -19.277       -19.774      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.998 
    coh38:k=-16.2915,b=0     -18.888       -19.188        -19.68      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.998 
    coh39:k=-16.1913,b=0     -18.809       -19.117       -19.534      -19.997      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh40:k=-16.091,b=0      -18.728       -19.044       -19.424      -19.981      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh41:k=-15.9908,b=0     -18.643       -18.968       -19.357      -19.932      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh42:k=-15.8906,b=0     -18.556       -18.889       -19.288       -19.88      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh43:k=-15.7903,b=0     -18.437       -18.807       -19.217      -19.694      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh44:k=-15.6901,b=0     -18.342       -18.724       -19.142      -19.631      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh45:k=-15.5899,b=0     -18.244       -18.637       -19.066      -19.566      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh46:k=-15.4897,b=0     -18.142       -18.548       -18.986      -19.498      -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh47:k=-15.3894,b=0     -18.081       -18.421       -18.904      -19.427      -19.996       -19.996       -19.997       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh48:k=-15.2892,b=0      -18.01       -18.323        -18.82      -19.322      -19.888       -19.996       -19.996       -19.997       -19.997       -19.997       -19.997       -19.997 
    coh49:k=-15.189,b=0      -17.903       -18.222       -18.733        -19.2      -19.824       -19.996       -19.996       -19.996       -19.996       -19.996       -19.997       -19.997 
    coh50:k=-15.0887,b=0     -17.793       -18.119       -18.643      -19.121      -19.757       -19.996       -19.996       -19.996       -19.996       -19.996       -19.996       -19.996 
    coh723:k=52.366,b=0       44.979        43.627        43.627       43.627       42.275        42.275        36.865        35.513        32.808        31.456        27.399        24.694 
    coh724:k=52.4662,b=0      45.069        43.715        43.715       43.715       42.361        42.361        36.944         35.59        32.881        31.527        27.464        24.756 
    coh725:k=52.5665,b=0      45.159        43.803        43.803       43.803       42.447        42.447        37.023        35.667        32.954        31.598         27.53        24.818 
    coh726:k=52.6667,b=0      45.249        43.891        43.891       43.891       42.533        42.533        37.101        35.743        33.028         31.67        27.596         24.88 
    coh727:k=52.7669,b=0      45.339        43.979        43.979       43.979        42.62         42.62         37.18         35.82        33.101        31.741        27.661        24.942 
    coh728:k=52.8671,b=0      45.429        44.068        44.068       44.068       42.706        42.706        37.259        35.897        33.174        31.812        27.727        25.004 
    coh729:k=52.9674,b=0      45.519        44.156        44.156       44.156       42.792        42.792        37.338        35.974        33.247        31.883        28.532        25.065 
    coh730:k=53.0676,b=0      45.609        44.244        44.244       44.244       42.878        42.878        37.416        36.051         33.32        31.955        29.224        25.127 
    coh731:k=53.1678,b=0      45.699        44.332        44.332       44.332       42.965        42.965        37.495        36.128        33.393        32.026        29.291        25.189 
    coh732:k=53.2681,b=0      45.789         44.42         44.42        44.42       43.051        43.051        37.574        36.205        33.873        32.097        29.359        25.251 
    coh733:k=53.3683,b=0      45.879        44.508        44.508       44.508       43.137        43.137        37.653        36.282        34.911        32.168        29.426        25.313 
    coh734:k=53.4685,b=0      45.969        44.596        44.596       44.596       43.223        43.223        37.732        36.359        34.986         32.24        29.494        25.375 
    coh735:k=53.5688,b=0      46.059        44.684        44.684       44.684        43.31         43.31         37.81        36.435        35.061        32.311        29.561        25.437 
    coh736:k=53.669,b=0       46.149        44.773        44.773       44.773       43.396        43.396        37.889        36.512        35.136        32.382        29.629        25.499 
    coh737:k=53.7692,b=0      46.239        44.861        44.861       44.861       43.482        43.482        37.968        36.589        35.211        32.454        29.696        25.561 
    coh738:k=53.8694,b=0      47.802        44.949        44.949       44.949       43.568        43.568        38.047        36.666        35.286        32.525        29.764        25.623 
    coh739:k=53.9697,b=0      47.894        45.037        45.037       45.037       43.655        43.655        38.125        36.743        35.361        32.596        29.831        25.684 
    coh740:k=54.0699,b=0      47.986        45.125        45.125       45.125       43.741        43.741        38.204         36.82        35.436        32.667        29.899        25.746 
    coh741:k=54.1701,b=0      48.078        45.213        45.213       45.213       43.827        43.827        38.283        36.897        35.511        32.739        29.966        25.808 
    coh742:k=54.2704,b=0       48.17        45.301        45.301       45.301       43.913        43.913        38.362        36.974        35.586         32.81        30.034        26.537 
    coh743:k=54.3706,b=0      48.262        45.389        45.389       45.389           44            44         38.44        37.051        35.661        32.881        30.101        27.322 
    coh744:k=54.4708,b=0      48.354        45.478        45.478       45.478       44.086        44.086        38.519        37.127        35.736        32.952        30.169        27.386 
    coh745:k=54.5711,b=0      48.446        45.566        45.566       45.566       44.172        44.172        38.598        37.204        35.811        33.024        30.237        27.449 
    coh746:k=54.6713,b=0      47.049        45.654        45.654       45.654       44.258        44.258        38.677        37.281        35.886        33.095        30.304        27.513 
    coh747:k=54.7715,b=0      47.139        45.742        45.742       45.742       44.345        44.345        38.755        37.358        35.961        33.166        30.372        27.577 
    coh748:k=54.8717,b=0      47.229         45.83         45.83        45.83       44.431        44.431        38.834        37.435        36.036        33.237        30.439        27.641 
    coh749:k=54.972,b=0       47.319        45.918        45.918       45.918       44.517        44.517        38.913        37.512        36.111        33.309        30.507        27.705 
    coh750:k=55.0722,b=0      47.409        46.006        46.006       46.006       44.603        44.603        40.151        37.589        36.186         33.38        30.574        27.768 
    coh751:k=55.1724,b=0      47.499        46.094        46.094       46.094        44.69         44.69        40.475        37.666        36.261        33.451        30.642        27.832 
    coh752:k=55.2727,b=0      47.589        46.183        46.183       46.183       44.776        44.776        40.556        37.743        36.336        33.523        30.709        27.896 
    coh753:k=55.3729,b=0      47.679        46.271        46.271       46.271       44.862        44.862        40.637        37.819        36.411        33.594        30.777        28.779 
    coh754:k=55.4731,b=0      47.769        46.359        46.359       46.359       44.948        44.948        40.717        37.896        36.486        33.665         31.55        29.434 
    coh755:k=55.5734,b=0      47.859        46.447        46.447       46.447       45.035        45.035        40.798        37.973        36.561        33.736        32.324        29.499 
    coh756:k=55.6736,b=0      47.949        46.535        46.535       46.535       45.121        45.121        40.878         38.05        36.636        33.808        32.393        29.089 
    coh757:k=55.7738,b=0      48.039        46.623        46.623       46.623       45.207        45.207        40.959        38.127        36.711        33.879        32.102        28.215 
    coh758:k=55.874,b=0       48.129        46.711        46.711       46.711       45.293        45.293         41.04        38.204        36.786         33.95        31.114        28.279 
    coh759:k=55.9743,b=0      48.219        46.799        46.799       46.799        45.38         45.38         41.12        38.281        36.861        34.021        31.182        28.342 
    coh760:k=56.0745,b=0      48.309        46.888        46.888       46.888       45.466        45.466        41.201        38.358        36.936        34.093        31.249        28.406 
    coh761:k=56.1747,b=0      48.399        46.976        46.976       46.976       45.552        45.552        41.282        38.435        37.011        34.164        31.317         28.47 
    coh762:k=56.275,b=0       48.489        47.064        47.064       47.064       45.638        45.638        41.362        38.511        37.086        34.235        31.384        28.534 
    coh763:k=56.3752,b=0      48.581        47.155        47.155       47.155       45.729        45.729        41.452        38.601        37.175        34.324        31.472        28.621 
    coh764:k=56.4754,b=0      48.673        47.247        47.247       47.247       45.821        45.821        41.544        38.693        37.267        34.416        31.564        28.713 
    coh765:k=56.5757,b=0      48.765        47.339        47.339       47.339       45.913        45.913        41.636        38.785        37.359        34.508        31.656        27.643 
    coh766:k=56.6759,b=0      48.857        47.431        47.431       47.431       46.005        46.005        41.728        38.877        37.451         33.31        30.508        27.706 
    coh767:k=56.7761,b=0      48.949        47.523        47.523       47.523       46.097        46.097        40.146        37.588        36.186         33.38        30.574        27.768 
    coh768:k=56.8763,b=0      49.041        46.092        46.092       46.092       44.687        44.687        40.473        37.664        36.259        33.449         30.64         27.83 
    coh769:k=56.9766,b=0      47.585        46.178        46.178       46.178       44.772        44.772        40.552        37.739        36.332        33.519        30.706        27.893 
    coh770:k=57.0768,b=0      47.673        46.265        46.265       46.265       44.856        44.856        40.631        37.814        36.406        33.589        30.772        28.684 
    coh771:k=57.177,b=0       47.761        46.351        46.351       46.351        44.94         44.94         40.71        37.889        36.479        33.658        31.423        29.428 
    coh772:k=57.2773,b=0      47.849        46.437        46.437       46.437       45.025        45.025        40.789        37.964        36.552        33.728        32.316        29.492 

tb_pol_k
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0             2.0567        2.0567       2.4641       3.2788        3.6861        4.5008        8.9816        10.727        13.055        15.499        18.351        19.98 
    coh2:k=-19.8998,b=0      0.079636      0.079636     0.079636     0.081675      0.081675      0.081675      0.083715      0.083715      0.083715      0.083715      0.083715     0.083715 
    coh3:k=-19.7995,b=0       0.11441       0.10625      0.10217      0.10217       0.10217       0.10217       0.10217       0.10217       0.10217       0.10217       0.10217      0.10217 
    coh4:k=-19.6993,b=0        0.2022       0.19608      0.19608      0.18996       0.17773       0.16549       0.12878       0.11654       0.10431       0.10431       0.10431      0.10431 
    coh5:k=-19.5991,b=0       0.26144       0.25328      0.24513      0.23697       0.22065       0.20434       0.19618       0.19618       0.19618       0.19618       0.17987      0.17171 
    coh6:k=-19.4989,b=0        0.3268        0.3166      0.30641      0.30641       0.29621       0.29621       0.25542       0.23503       0.22483       0.21464       0.20444      0.20444 
    coh7:k=-19.3986,b=0        0.4044        0.4044      0.39216      0.39216       0.37992       0.35545       0.30651       0.30651       0.29427       0.29427       0.29427      0.28203 
    coh8:k=-19.2984,b=0       0.48607        0.4718      0.45752      0.44325       0.42897       0.41469       0.40042       0.37187       0.35759       0.34332       0.32904      0.31476 
    coh9:k=-19.1982,b=0       0.55551        0.5392      0.52288      0.50657       0.50657       0.50657       0.44131       0.42499       0.40868       0.40868       0.39236      0.39236 
    coh10:k=-19.0979,b=0      0.62495        0.6066       0.6066       0.6066       0.58824       0.56989       0.51482       0.49647       0.49647       0.47812       0.45976      0.44141 
    coh11:k=-18.9977,b=0      0.71478       0.69439      0.69439        0.674        0.6536       0.63321       0.59242       0.57203       0.55163       0.53124       0.51085      0.51085 
    coh12:k=-18.8975,b=0      0.78626       0.78626      0.76383      0.74139       0.71896       0.71896       0.65166       0.62923        0.6068        0.6068       0.58436      0.58436 
    coh13:k=-18.7972,b=0      0.85774       0.85774      0.83327      0.80879       0.80879       0.80879        0.7109        0.7109       0.68643       0.68643       0.66196      0.63749 
    coh14:k=-18.697,b=0       0.95573       0.92922      0.90271      0.90271       0.90271       0.87619       0.79666       0.79666       0.77015       0.74363       0.71712      0.71712 
    coh15:k=-18.5968,b=0       1.0292        1.0007       1.0007       1.0007       0.97214       0.94359       0.88649       0.85794       0.82939       0.80084       0.80084      0.77229 
    coh16:k=-18.4966,b=0       1.1028        1.1028       1.0722       1.0722        1.0416         1.011       0.94981       0.91922       0.88863       0.88863       0.85804      0.82745 
    coh17:k=-18.3963,b=0       1.1763        1.1763       1.1437       1.1437         1.111         1.111        1.0131        1.0131        0.9805       0.94787       0.91524      0.91524 
    coh18:k=-18.2961,b=0       1.2845        1.2498       1.2498       1.2151        1.2151        1.1805        1.1111        1.0765        1.0418        1.0071        1.0071       1.0071 
    coh19:k=-18.1959,b=0         1.36        1.3233       1.3233       1.2866        1.2866        1.2499        1.1765        1.1398        1.1031        1.1031        1.1031       1.0664 
    coh20:k=-18.0956,b=0       1.4356        1.3968       1.3968       1.3968        1.3581        1.3581        1.2418        1.2031        1.2031        1.1643        1.1643       1.1256 
    coh21:k=-17.9954,b=0       1.5111        1.5111       1.4704       1.4704        1.4296        1.4296        1.3072        1.3072        1.2664        1.2664        1.2256       1.1848 
    coh22:k=-17.8952,b=0       1.5867        1.5867       1.5867       1.5439         1.501         1.501        1.4154        1.3726        1.3726        1.3297        1.2869       1.2869 
    coh23:k=-17.7949,b=0       1.6623        1.6623       1.6623       1.6174        1.6174        1.5725        1.4828        1.4379        1.4379        1.3931        1.3931       1.3482 
    coh24:k=-17.6947,b=0       1.7847        1.7378       1.7378       1.6909        1.6909         1.644        1.5502        1.5502        1.5033        1.5033        1.4564       1.4095 
    coh25:k=-17.5945,b=0       1.8146        1.8134       1.8134       1.8134        1.7644        1.7644        1.6176        1.6176        1.5686        1.5686        1.5197       1.5197 
    coh26:k=-17.4943,b=0       1.8289        1.8889       1.8889       1.8889        1.8379        1.8379         1.736         1.685         1.685         1.634         1.583        1.583 
    coh27:k=-17.394,b=0        1.8387        2.0175       1.9645       1.9645        1.9115        1.9115        1.8054        1.7524        1.7524        1.6994        1.6994       1.6463 
    coh28:k=-17.2938,b=0       1.8435        2.0951         2.04         2.04          2.04         1.985        1.8749        1.8749        1.8198        1.7647        1.7647       1.7097 
    coh29:k=-17.1936,b=0       1.8425        2.1405       2.1156       2.1156        2.1156        2.0585        1.9443        1.9443        1.8872        1.8872        1.8301       1.8301 
    coh30:k=-17.0933,b=0        1.837        2.1581       2.2503       2.1912        2.1912         2.132        2.0137        2.0137        1.9546        1.9546        1.8954       1.8954 
    coh31:k=-16.9931,b=0       1.8401        2.1592       2.3279       2.2667        2.2667        2.2055        2.1443        2.0832        2.0832         2.022        1.9608       1.9608 
    coh32:k=-16.8929,b=0       1.8461        2.1557       2.4055       2.3423        2.3423        2.3423        2.2158        2.1526        2.1526        2.0894        2.0894       2.0262 
    coh33:k=-16.7926,b=0       1.8479        2.1463       2.4831       2.4831        2.4178        2.4178        2.2873         2.222         2.222        2.1568        2.1568       2.0915 
    coh34:k=-16.6924,b=0       1.8483        2.1636       2.5291       2.5607        2.4934        2.4934        2.3588        2.3588        2.2915        2.2915        2.2242       2.1569 
    coh35:k=-16.5922,b=0       1.8207        2.1519       2.5436       2.6383        2.5689        2.5689        2.4303        2.4303        2.3609        2.3609        2.2916       2.2916 
    coh36:k=-16.492,b=0        1.8289        2.1698       2.5414       2.7159        2.7159        2.6445        2.5017        2.5017        2.4304        2.4304         2.359        2.359 
    coh37:k=-16.3917,b=0       1.8344        2.1463       2.5699       2.7935        2.7935        2.7201        2.5732        2.5732        2.4998        2.4998        2.4998       2.4264 
    coh38:k=-16.2915,b=0       1.8375        2.1379       2.5543       2.8711        2.8711        2.7956        2.7202        2.6447        2.6447        2.5692        2.5692       2.4938 
    coh39:k=-16.1913,b=0       1.8382        2.1467       2.5628       2.9487        2.9487        2.8712        2.7937        2.7162        2.7162        2.6387        2.6387       2.5612 
    coh40:k=-16.091,b=0        1.8365        2.1531        2.533       3.0105        3.0263        3.0263        2.8672        2.7877        2.7877        2.7081        2.7081       2.7081 
    coh41:k=-15.9908,b=0       1.8317        2.1564       2.5461       3.0389        3.1039        3.1039        2.9407        2.9407        2.8591        2.8591        2.7776       2.7776 
    coh42:k=-15.8906,b=0       1.8243        2.1571       2.5565       3.0643        3.1815        3.1815        3.0142        3.0142        2.9306        2.9306         2.847        2.847 
    coh43:k=-15.7903,b=0       1.8711        2.1555       2.5646       3.0419         3.259         3.259        3.0877        3.0877        3.0021        3.0021        2.9164       2.9164 
    coh44:k=-15.6901,b=0       1.8574        2.1514       2.5702       3.0589        3.3366        3.3366        3.1613        3.1613        3.0736        3.0736        2.9859       2.9859 
    coh45:k=-15.5899,b=0       1.8409        2.1448       2.5735       3.0735        3.4142        3.4142        3.2348        3.2348        3.2348         3.145         3.145       3.0553 
    coh46:k=-15.4897,b=0       1.8213        2.1352       2.5735        3.085        3.4918        3.4918        3.4001        3.3083        3.3083        3.2165        3.2165       3.1248 
    coh47:k=-15.3894,b=0       1.8421        2.1821       2.5711       3.0939        3.5694        3.5694        3.4756        3.3818        3.3818         3.288         3.288       3.1942 
    coh48:k=-15.2892,b=0       1.8527        2.1657       2.5663       3.0684        3.6346         3.647        3.5512        3.4553        3.4553        3.3595        3.3595       3.3595 
    coh49:k=-15.189,b=0         1.827        2.1467        2.559       3.0266          3.65        3.7246        3.6267        3.5288        3.5288        3.5288         3.431        3.431 
    coh50:k=-15.0887,b=0       1.7991        2.1254       2.5493        3.027        3.6631        3.8022        3.7023        3.6024        3.6024        3.6024        3.5024       3.5024 
    coh723:k=52.366,b=0        1.4187        2.7711       2.7711       2.7711        4.1235        4.1235        9.5329        10.885         13.59        14.942        18.999       21.704 
    coh724:k=52.4662,b=0       1.4207        2.7749       2.7749       2.7749        4.1292        4.1292        9.5461          10.9        13.609        14.963        19.026       21.734 
    coh725:k=52.5665,b=0       1.4227        2.7788       2.7788       2.7788        4.1349        4.1349        9.5593        10.915        13.628        14.984        19.052       21.764 
    coh726:k=52.6667,b=0       1.4246        2.7826       2.7826       2.7826        4.1406        4.1406        9.5725         10.93        13.646        15.004        19.078       21.794 
    coh727:k=52.7669,b=0       1.4266        2.7865       2.7865       2.7865        4.1463        4.1463        9.5857        10.946        13.665        15.025        19.105       21.824 
    coh728:k=52.8671,b=0       1.4286        2.7903       2.7903       2.7903         4.152         4.152        9.5989        10.961        13.684        15.046        19.131       21.854 
    coh729:k=52.9674,b=0       1.4305        2.7941       2.7941       2.7941        4.1577        4.1577        9.6121        10.976        13.703        15.066        18.418       21.884 
    coh730:k=53.0676,b=0       1.4325         2.798        2.798        2.798        4.1634        4.1634        9.6253        10.991        13.722        15.087        17.818       21.914 
    coh731:k=53.1678,b=0       1.4345        2.8018       2.8018       2.8018        4.1691        4.1691        9.6385        11.006         13.74        15.108        17.843       21.945 
    coh732:k=53.2681,b=0       1.4364        2.8056       2.8056       2.8056        4.1749        4.1749        9.6517        11.021        13.353        15.129        17.867       21.975 
    coh733:k=53.3683,b=0       1.4384        2.8095       2.8095       2.8095        4.1806        4.1806        9.6649        11.036        12.407        15.149        17.891       22.005 
    coh734:k=53.4685,b=0       1.4404        2.8133       2.8133       2.8133        4.1863        4.1863        9.6781        11.051        12.424         15.17        17.916       22.035 
    coh735:k=53.5688,b=0       1.4423        2.8172       2.8172       2.8172         4.192         4.192        9.6913        11.066        12.441        15.191         17.94       22.065 
    coh736:k=53.669,b=0        1.4443         2.821        2.821        2.821        4.1977        4.1977        9.7045        11.081        12.458        15.211        17.965       22.095 
    coh737:k=53.7692,b=0       1.4463        2.8248       2.8248       2.8248        4.2034        4.2034        9.7177        11.096        12.475        15.232        17.989       22.125 
    coh738:k=53.8694,b=0       1.4804        2.8287       2.8287       2.8287        4.2091        4.2091        9.7309        11.111        12.492        15.253        18.014       22.155 
    coh739:k=53.9697,b=0       1.4824        2.8325       2.8325       2.8325        4.2148        4.2148        9.7441        11.126        12.509        15.273        18.038       22.185 
    coh740:k=54.0699,b=0       1.4844        2.8363       2.8363       2.8363        4.2205        4.2205        9.7573        11.142        12.526        15.294        18.062       22.215 
    coh741:k=54.1701,b=0       1.4864        2.8402       2.8402       2.8402        4.2263        4.2263        9.7705        11.157        12.543        15.315        18.087       22.245 
    coh742:k=54.2704,b=0       1.4884         2.844        2.844        2.844         4.232         4.232        9.7837        11.172         12.56        15.335        18.111       21.609 
    coh743:k=54.3706,b=0       1.4904        2.8479       2.8479       2.8479        4.2377        4.2377        9.7969        11.187        12.577        15.356        18.136       20.915 
    coh744:k=54.4708,b=0       1.4924        2.8517       2.8517       2.8517        4.2434        4.2434        9.8101        11.202        12.594        15.377         18.16       20.944 
    coh745:k=54.5711,b=0       1.4944        2.8555       2.8555       2.8555        4.2491        4.2491        9.8233        11.217         12.61        15.398        18.185       20.972 
    coh746:k=54.6713,b=0       1.4639        2.8594       2.8594       2.8594        4.2548        4.2548        9.8365        11.232        12.627        15.418        18.209           21 
    coh747:k=54.7715,b=0       1.4659        2.8632       2.8632       2.8632        4.2605        4.2605        9.8497        11.247        12.644        15.439        18.234       21.028 
    coh748:k=54.8717,b=0       1.4679        2.8671       2.8671       2.8671        4.2662        4.2662        9.8629        11.262        12.661         15.46        18.258       21.056 
    coh749:k=54.972,b=0        1.4698        2.8709       2.8709       2.8709        4.2719        4.2719        9.8761        11.277        12.678         15.48        18.282       21.085 
    coh750:k=55.0722,b=0       1.4718        2.8747       2.8747       2.8747        4.2777        4.2777        8.7297        11.292        12.695        15.501        18.307       21.113 
    coh751:k=55.1724,b=0       1.4738        2.8786       2.8786       2.8786        4.2834        4.2834        8.4978        11.307        12.712        15.522        18.331       21.141 
    coh752:k=55.2727,b=0       1.4757        2.8824       2.8824       2.8824        4.2891        4.2891        8.5091        11.322        12.729        15.542        18.356       21.169 
    coh753:k=55.3729,b=0       1.4777        2.8862       2.8862       2.8862        4.2948        4.2948        8.5204        11.338        12.746        15.563         18.38       20.378 
    coh754:k=55.4731,b=0       1.4797        2.8901       2.8901       2.8901        4.3005        4.3005        8.5317        11.353        12.763        15.584        17.699       19.815 
    coh755:k=55.5734,b=0       1.4816        2.8939       2.8939       2.8939        4.3062        4.3062        8.5431        11.368         12.78        15.605        17.017       19.841 
    coh756:k=55.6736,b=0       1.4836        2.8978       2.8978       2.8978        4.3119        4.3119        8.5544        11.383        12.797        15.625        17.039       20.344 
    coh757:k=55.7738,b=0       1.4856        2.9016       2.9016       2.9016        4.3176        4.3176        8.5657        11.398        12.814        15.646        17.423        21.31 
    coh758:k=55.874,b=0        1.4875        2.9054       2.9054       2.9054        4.3233        4.3233        8.5771        11.413        12.831        15.667        18.502       21.338 
    coh759:k=55.9743,b=0       1.4895        2.9093       2.9093       2.9093        4.3291        4.3291        8.5884        11.428        12.848        15.687        18.527       21.366 
    coh760:k=56.0745,b=0       1.4915        2.9131       2.9131       2.9131        4.3348        4.3348        8.5997        11.443        12.865        15.708        18.551       21.395 
    coh761:k=56.1747,b=0       1.4934        2.9169       2.9169       2.9169        4.3405        4.3405        8.6111        11.458        12.882        15.729        18.576       21.423 
    coh762:k=56.275,b=0        1.4954        2.9208       2.9208       2.9208        4.3462        4.3462        8.6224        11.473        12.899        15.749          18.6       21.451 
    coh763:k=56.3752,b=0       1.4957        2.9214       2.9214       2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604       21.456 
    coh764:k=56.4754,b=0       1.4957        2.9214       2.9214       2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604       21.456 
    coh765:k=56.5757,b=0       1.4957        2.9214       2.9214       2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.753        18.604       21.058 
    coh766:k=56.6759,b=0       1.4957        2.9214       2.9214       2.9214        4.3471        4.3471        8.6243        11.476        12.901        15.481        18.283       21.085 
    coh767:k=56.7761,b=0       1.4957        2.9214       2.9214       2.9214        4.3471        4.3471        8.7343        11.292        12.695        15.501        18.307       21.113 
    coh768:k=56.8763,b=0       1.4957        2.8785       2.8785       2.8785        4.2832        4.2832        8.4975        11.307        12.712        15.521        18.331        21.14 
    coh769:k=56.9766,b=0       1.4756        2.8822       2.8822       2.8822        4.2888        4.2888        8.5085        11.322        12.728        15.541        18.355       21.168 
    coh770:k=57.0768,b=0       1.4776         2.886        2.886        2.886        4.2944        4.2944        8.5196        11.336        12.745        15.562        18.379       20.467 
    coh771:k=57.177,b=0        1.4795        2.8897       2.8897       2.8897           4.3           4.3        8.5307        11.351        12.761        15.582        17.817       19.813 
    coh772:k=57.2773,b=0       1.4814        2.8935       2.8935       2.8935        4.3056        4.3056        8.5418        11.366        12.778        15.602        17.014       19.838 

tb_pol_w
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=-20,b=0                 0             0             0            0            0             0             0             0             0             0             0             0 
    coh2:k=-19.8998,b=0       -19.92        -19.92        -19.92      -19.918      -19.918       -19.918       -19.916       -19.916       -19.916       -19.916       -19.916       -19.916 
    coh3:k=-19.7995,b=0      -19.885       -19.894       -19.898      -19.898      -19.898       -19.898       -19.898       -19.898       -19.898       -19.898       -19.898       -19.898 
    coh4:k=-19.6993,b=0      -19.798       -19.804       -19.804       -19.81      -19.822       -19.834       -19.871       -19.883       -19.896       -19.896       -19.896       -19.896 
    coh5:k=-19.5991,b=0      -19.738       -19.746       -19.755      -19.763      -19.779       -19.795       -19.804       -19.804       -19.804       -19.804        -19.82       -19.828 
    coh6:k=-19.4989,b=0      -19.673       -19.683       -19.693      -19.693      -19.703       -19.703       -19.744       -19.765       -19.775       -19.785       -19.795       -19.795 
    coh7:k=-19.3986,b=0      -19.595       -19.595       -19.607      -19.607       -19.62       -19.644       -19.693       -19.693       -19.705       -19.705       -19.705       -19.718 
    coh8:k=-19.2984,b=0      -19.513       -19.528       -19.542      -19.556      -19.571       -19.585       -19.599       -19.628       -19.642       -19.656       -19.671       -19.685 
    coh9:k=-19.1982,b=0      -19.444        -19.46       -19.477      -19.493      -19.493       -19.493       -19.558       -19.575       -19.591       -19.591       -19.607       -19.607 
    coh10:k=-19.0979,b=0     -19.374       -19.393       -19.393      -19.393      -19.411        -19.43       -19.485       -19.503       -19.503       -19.521        -19.54       -19.558 
    coh11:k=-18.9977,b=0     -19.285       -19.305       -19.305      -19.325      -19.346       -19.366       -19.407       -19.427       -19.448       -19.468       -19.489       -19.489 
    coh12:k=-18.8975,b=0     -19.213       -19.213       -19.235      -19.258       -19.28        -19.28       -19.348        -19.37       -19.393       -19.393       -19.415       -19.415 
    coh13:k=-18.7972,b=0     -19.141       -19.141       -19.166       -19.19       -19.19        -19.19       -19.288       -19.288       -19.313       -19.313       -19.337       -19.362 
    coh14:k=-18.697,b=0      -19.043        -19.07       -19.096      -19.096      -19.096       -19.123       -19.203       -19.203       -19.229       -19.256       -19.282       -19.282 
    coh15:k=-18.5968,b=0      -18.97       -18.998       -18.998      -18.998      -19.027       -19.055       -19.113       -19.141        -19.17       -19.198       -19.198       -19.227 
    coh16:k=-18.4966,b=0     -18.896       -18.896       -18.927      -18.927      -18.957       -18.988       -19.049        -19.08        -19.11        -19.11       -19.141       -19.172 
    coh17:k=-18.3963,b=0     -18.823       -18.823       -18.855      -18.855      -18.888       -18.888       -18.986       -18.986       -19.019       -19.051       -19.084       -19.084 
    coh18:k=-18.2961,b=0     -18.714       -18.749       -18.749      -18.784      -18.784       -18.818       -18.888       -18.922       -18.957       -18.992       -18.992       -18.992 
    coh19:k=-18.1959,b=0     -18.639       -18.675       -18.675      -18.712      -18.712       -18.749       -18.822       -18.859       -18.896       -18.896       -18.896       -18.933 
    coh20:k=-18.0956,b=0     -18.563       -18.602       -18.602      -18.602      -18.641       -18.641       -18.757       -18.796       -18.796       -18.834       -18.834       -18.873 
    coh21:k=-17.9954,b=0     -18.487       -18.487       -18.528      -18.528      -18.569       -18.569       -18.691       -18.691       -18.732       -18.732       -18.773       -18.814 
    coh22:k=-17.8952,b=0     -18.412       -18.412       -18.412      -18.455      -18.497       -18.497       -18.583       -18.626       -18.626       -18.669       -18.712       -18.712 
    coh23:k=-17.7949,b=0     -18.336       -18.336       -18.336      -18.381      -18.381       -18.426       -18.516       -18.561       -18.561       -18.606       -18.606        -18.65 
    coh24:k=-17.6947,b=0     -18.213        -18.26        -18.26      -18.307      -18.307       -18.354       -18.448       -18.448       -18.495       -18.495       -18.542       -18.589 
    coh25:k=-17.5945,b=0     -18.136       -18.185       -18.185      -18.185      -18.234       -18.234       -18.381       -18.381        -18.43        -18.43       -18.479       -18.479 
    coh26:k=-17.4943,b=0     -18.058       -18.109       -18.109      -18.109       -18.16        -18.16       -18.262       -18.313       -18.313       -18.364       -18.415       -18.415 
    coh27:k=-17.394,b=0       -17.98        -17.98       -18.034      -18.034      -18.087       -18.087       -18.193       -18.246       -18.246       -18.299       -18.299       -18.352 
    coh28:k=-17.2938,b=0     -17.903       -17.903       -17.958      -17.958      -17.958       -18.013       -18.123       -18.123       -18.178       -18.234       -18.234       -18.289 
    coh29:k=-17.1936,b=0     -17.825       -17.825       -17.882      -17.882      -17.882       -17.939       -18.054       -18.054       -18.111       -18.111       -18.168       -18.168 
    coh30:k=-17.0933,b=0     -17.747       -17.747       -17.747      -17.807      -17.807       -17.866       -17.984       -17.984       -18.043       -18.043       -18.103       -18.103 
    coh31:k=-16.9931,b=0      -17.67        -17.67        -17.67      -17.731      -17.731       -17.792       -17.854       -17.915       -17.915       -17.976       -18.037       -18.037 
    coh32:k=-16.8929,b=0     -17.529       -17.592       -17.592      -17.655      -17.655       -17.655       -17.782       -17.845       -17.845       -17.909       -17.909       -17.972 
    coh33:k=-16.7926,b=0     -17.449       -17.514       -17.514      -17.514       -17.58        -17.58        -17.71       -17.776       -17.776       -17.841       -17.841       -17.906 
    coh34:k=-16.6924,b=0     -17.369       -17.437       -17.437      -17.437      -17.504       -17.504       -17.639       -17.639       -17.706       -17.706       -17.774       -17.841 
    coh35:k=-16.5922,b=0      -17.29        -17.29       -17.359      -17.359      -17.428       -17.428       -17.567       -17.567       -17.637       -17.637       -17.706       -17.706 
    coh36:k=-16.492,b=0       -17.21        -17.21       -17.281      -17.281      -17.281       -17.353       -17.496       -17.496       -17.567       -17.567       -17.639       -17.639 
    coh37:k=-16.3917,b=0      -17.13        -17.13       -17.204      -17.204      -17.204       -17.277       -17.424       -17.424       -17.498       -17.498       -17.498       -17.571 
    coh38:k=-16.2915,b=0     -17.051       -17.051       -17.126      -17.126      -17.126       -17.202       -17.277       -17.353       -17.353       -17.428       -17.428       -17.504 
    coh39:k=-16.1913,b=0     -16.971       -16.971       -16.971      -17.048      -17.048       -17.126       -17.204       -17.281       -17.281       -17.359       -17.359       -17.436 
    coh40:k=-16.091,b=0      -16.891       -16.891       -16.891      -16.971      -16.971       -16.971        -17.13        -17.21        -17.21       -17.289       -17.289       -17.289 
    coh41:k=-15.9908,b=0     -16.811       -16.811       -16.811      -16.893      -16.893       -16.893       -17.056       -17.056       -17.138       -17.138        -17.22        -17.22 
    coh42:k=-15.8906,b=0     -16.732       -16.732       -16.732      -16.815      -16.815       -16.815       -16.983       -16.983       -17.066       -17.066        -17.15        -17.15 
    coh43:k=-15.7903,b=0     -16.566       -16.652       -16.652      -16.652      -16.738       -16.738       -16.909       -16.909       -16.995       -16.995       -17.081       -17.081 
    coh44:k=-15.6901,b=0     -16.484       -16.572       -16.572      -16.572       -16.66        -16.66       -16.836       -16.836       -16.923       -16.923       -17.011       -17.011 
    coh45:k=-15.5899,b=0     -16.403       -16.493       -16.493      -16.493      -16.582       -16.582       -16.762       -16.762       -16.762       -16.852       -16.852       -16.942 
    coh46:k=-15.4897,b=0     -16.321       -16.413       -16.413      -16.413      -16.505       -16.505       -16.597       -16.688       -16.688        -16.78        -16.78       -16.872 
    coh47:k=-15.3894,b=0     -16.239       -16.239       -16.333      -16.333      -16.427       -16.427       -16.521       -16.615       -16.615       -16.709       -16.709       -16.803 
    coh48:k=-15.2892,b=0     -16.157       -16.157       -16.253      -16.253      -16.253       -16.349       -16.445       -16.541       -16.541       -16.637       -16.637       -16.637 
    coh49:k=-15.189,b=0      -16.076       -16.076       -16.174      -16.174      -16.174       -16.272        -16.37       -16.468       -16.468       -16.468       -16.566       -16.566 
    coh50:k=-15.0887,b=0     -15.994       -15.994       -16.094      -16.094      -16.094       -16.194       -16.294       -16.394       -16.394       -16.394       -16.494       -16.494 
    coh723:k=52.366,b=0       46.398        46.398        46.398       46.398       46.398        46.398        46.398        46.398        46.398        46.398        46.398        46.398 
    coh724:k=52.4662,b=0       46.49         46.49         46.49        46.49        46.49         46.49         46.49         46.49         46.49         46.49         46.49         46.49 
    coh725:k=52.5665,b=0      46.582        46.582        46.582       46.582       46.582        46.582        46.582        46.582        46.582        46.582        46.582        46.582 
    coh726:k=52.6667,b=0      46.674        46.674        46.674       46.674       46.674        46.674        46.674        46.674        46.674        46.674        46.674        46.674 
    coh727:k=52.7669,b=0      46.766        46.766        46.766       46.766       46.766        46.766        46.766        46.766        46.766        46.766        46.766        46.766 
    coh728:k=52.8671,b=0      46.858        46.858        46.858       46.858       46.858        46.858        46.858        46.858        46.858        46.858        46.858        46.858 
    coh729:k=52.9674,b=0       46.95         46.95         46.95        46.95        46.95         46.95         46.95         46.95         46.95         46.95         46.95         46.95 
    coh730:k=53.0676,b=0      47.042        47.042        47.042       47.042       47.042        47.042        47.042        47.042        47.042        47.042        47.042        47.042 
    coh731:k=53.1678,b=0      47.134        47.134        47.134       47.134       47.134        47.134        47.134        47.134        47.134        47.134        47.134        47.134 
    coh732:k=53.2681,b=0      47.226        47.226        47.226       47.226       47.226        47.226        47.226        47.226        47.226        47.226        47.226        47.226 
    coh733:k=53.3683,b=0      47.318        47.318        47.318       47.318       47.318        47.318        47.318        47.318        47.318        47.318        47.318        47.318 
    coh734:k=53.4685,b=0       47.41         47.41         47.41        47.41        47.41         47.41         47.41         47.41         47.41         47.41         47.41         47.41 
    coh735:k=53.5688,b=0      47.502        47.502        47.502       47.502       47.502        47.502        47.502        47.502        47.502        47.502        47.502        47.502 
    coh736:k=53.669,b=0       47.594        47.594        47.594       47.594       47.594        47.594        47.594        47.594        47.594        47.594        47.594        47.594 
    coh737:k=53.7692,b=0      47.686        47.686        47.686       47.686       47.686        47.686        47.686        47.686        47.686        47.686        47.686        47.686 
    coh738:k=53.8694,b=0      49.282        47.777        47.777       47.777       47.777        47.777        47.777        47.777        47.777        47.777        47.777        47.777 
    coh739:k=53.9697,b=0      49.376        47.869        47.869       47.869       47.869        47.869        47.869        47.869        47.869        47.869        47.869        47.869 
    coh740:k=54.0699,b=0       49.47        47.961        47.961       47.961       47.961        47.961        47.961        47.961        47.961        47.961        47.961        47.961 
    coh741:k=54.1701,b=0      49.564        48.053        48.053       48.053       48.053        48.053        48.053        48.053        48.053        48.053        48.053        48.053 
    coh742:k=54.2704,b=0      49.658        48.145        48.145       48.145       48.145        48.145        48.145        48.145        48.145        48.145        48.145        48.145 
    coh743:k=54.3706,b=0      49.752        48.237        48.237       48.237       48.237        48.237        48.237        48.237        48.237        48.237        48.237        48.237 
    coh744:k=54.4708,b=0      49.846        48.329        48.329       48.329       48.329        48.329        48.329        48.329        48.329        48.329        48.329        48.329 
    coh745:k=54.5711,b=0       49.94        48.421        48.421       48.421       48.421        48.421        48.421        48.421        48.421        48.421        48.421        48.421 
    coh746:k=54.6713,b=0      48.513        48.513        48.513       48.513       48.513        48.513        48.513        48.513        48.513        48.513        48.513        48.513 
    coh747:k=54.7715,b=0      48.605        48.605        48.605       48.605       48.605        48.605        48.605        48.605        48.605        48.605        48.605        48.605 
    coh748:k=54.8717,b=0      48.697        48.697        48.697       48.697       48.697        48.697        48.697        48.697        48.697        48.697        48.697        48.697 
    coh749:k=54.972,b=0       48.789        48.789        48.789       48.789       48.789        48.789        48.789        48.789        48.789        48.789        48.789        48.789 
    coh750:k=55.0722,b=0      48.881        48.881        48.881       48.881       48.881        48.881        48.881        48.881        48.881        48.881        48.881        48.881 
    coh751:k=55.1724,b=0      48.973        48.973        48.973       48.973       48.973        48.973        48.973        48.973        48.973        48.973        48.973        48.973 
    coh752:k=55.2727,b=0      49.065        49.065        49.065       49.065       49.065        49.065        49.065        49.065        49.065        49.065        49.065        49.065 
    coh753:k=55.3729,b=0      49.157        49.157        49.157       49.157       49.157        49.157        49.157        49.157        49.157        49.157        49.157        49.157 
    coh754:k=55.4731,b=0      49.249        49.249        49.249       49.249       49.249        49.249        49.249        49.249        49.249        49.249        49.249        49.249 
    coh755:k=55.5734,b=0      49.341        49.341        49.341       49.341       49.341        49.341        49.341        49.341        49.341        49.341        49.341        49.341 
    coh756:k=55.6736,b=0      49.433        49.433        49.433       49.433       49.433        49.433        49.433        49.433        49.433        49.433        49.433        49.433 
    coh757:k=55.7738,b=0      49.525        49.525        49.525       49.525       49.525        49.525        49.525        49.525        49.525        49.525        49.525        49.525 
    coh758:k=55.874,b=0       49.617        49.617        49.617       49.617       49.617        49.617        49.617        49.617        49.617        49.617        49.617        49.617 
    coh759:k=55.9743,b=0      49.709        49.709        49.709       49.709       49.709        49.709        49.709        49.709        49.709        49.709        49.709        49.709 
    coh760:k=56.0745,b=0      49.801        49.801        49.801       49.801       49.801        49.801        49.801        49.801        49.801        49.801        49.801        49.801 
    coh761:k=56.1747,b=0      49.893        49.893        49.893       49.893       49.893        49.893        49.893        49.893        49.893        49.893        49.893        49.893 
    coh762:k=56.275,b=0       49.985        49.985        49.985       49.985       49.985        49.985        49.985        49.985        49.985        49.985        49.985        49.985 
    coh763:k=56.3752,b=0      50.077        50.077        50.077       50.077       50.077        50.077        50.077        50.077        50.077        50.077        50.077        50.077 
    coh764:k=56.4754,b=0      50.169        50.169        50.169       50.169       50.169        50.169        50.169        50.169        50.169        50.169        50.169        50.169 
    coh765:k=56.5757,b=0      50.261        50.261        50.261       50.261       50.261        50.261        50.261        50.261        50.261        50.261        50.261        48.701 
    coh766:k=56.6759,b=0      50.352        50.352        50.352       50.352       50.352        50.352        50.352        50.352        50.352        48.791        48.791        48.791 
    coh767:k=56.7761,b=0      50.444        50.444        50.444       50.444       50.444        50.444        48.881        48.881        48.881        48.881        48.881        48.881 
    coh768:k=56.8763,b=0      50.536        48.971        48.971       48.971       48.971        48.971        48.971        48.971        48.971        48.971        48.971        48.971 
    coh769:k=56.9766,b=0      49.061        49.061        49.061       49.061       49.061        49.061        49.061        49.061        49.061        49.061        49.061        49.061 
    coh770:k=57.0768,b=0       49.15         49.15         49.15        49.15        49.15         49.15         49.15         49.15         49.15         49.15         49.15         49.15 
    coh771:k=57.177,b=0        49.24         49.24         49.24        49.24        49.24         49.24         49.24         49.24         49.24         49.24         49.24         49.24 
    coh772:k=57.2773,b=0       49.33         49.33         49.33        49.33        49.33         49.33         49.33         49.33         49.33         49.33         49.33         49.33 

</pre><img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_02.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_03.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_04.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_08.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_09.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_10.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_11.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_12.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_13.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_14.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_15.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbz_vf_vecsv_16.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%%
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

function result_map = ff_ipwkbz_vf_vecsv(varargin)
%% FF_IPWKBZ_VF_VECSV solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the two step solution
% with interpolation and with percentage asset grids version of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html
% ff_iwkz_vf_vecsv>. See that file for more descriptions.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ff_ipwkbz_evf.m ff_ipwkbz_evf>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_set_default_param.m ffs_ipwkbz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbz/paramfunc/ffs_ipwkbz_get_funcgrid.m ffs_ipwkbz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkbz_set_default_param(it_param_set);

% parameters can be set inside ffs_ipwkbz_set_default_param or updated here
% param_map('it_w_perc_n') = 50;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('it_z_n') = 15;
% param_map('fl_coh_interp_grid_gap') = 0.025;
% param_map('it_c_interp_grid_gap') = 0.001;
% param_map('fl_w_interp_grid_gap') = 0.25;
% param_map('it_w_perc_n') = 100;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('it_z_n') = 11;
% param_map('fl_coh_interp_grid_gap') = 0.1;
% param_map('it_c_interp_grid_gap') = 10^-4;
% param_map('fl_w_interp_grid_gap') = 0.1;
%
% get armt and func map
[armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_ipwkbz_vf_vecsv';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_w_perc', 'ar_w_level', 'ar_z'});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {'ar_interp_c_grid', 'ar_interp_coh_grid', ...
    'mt_interp_coh_grid_mesh_z', 'mt_z_mesh_coh_interp_grid',...
    'mt_interp_coh_grid_mesh_w_perc',...
    'mt_w_by_interp_coh_interp_grid'});
[ar_interp_c_grid, ar_interp_coh_grid, ...
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, ...
    mt_interp_coh_grid_mesh_w_perc,...
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {'mt_coh_wkb', 'mt_z_mesh_coh_wkb'});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};


% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};

% param_map
params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w',...
    'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min', ...
    'fl_nan_replace', 'bl_default', 'fl_default_wprime'});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min ...
    fl_nan_replace, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_graph_evf', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));

% We did not need these in ff_oz_vf or ff_oz_vf_vec
% see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why store using cells.
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
for it_z_i = 1:length(ar_z)
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
end

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Pre-calculate u(c)
% Interpolation, see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why interpolate over u(c)

% Evaluate
if (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
else
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
end
ar_interp_u_of_c_grid(ar_interp_c_grid <= fl_c_min) = fl_u_cmin;

% Get Interpolant
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, 'spline', 'nearest');

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;


    %% Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)
    % v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see
    % ffs_ipwkbz_get_funcgrid.m. Generate interpolant based on that, Then
    % interpolate for the coh reachable levels given the k(w,z) percentage
    % choice grids in the second stage of the problem

    % Generate Interpolant for v(coh,z)
    f_grid_interpolant_value = griddedInterpolant(...
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', 'linear', 'nearest');

    % Interpoalte for v(coh(k(w,z),b(w,z),z),z)
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);

    %% Solve Second Stage Problem k*(w,z)
    % This is the key difference between this function and
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
    % ffs_akz_set_functions> which solves the two stages jointly
    % Interpolation first, because solution coh grid is not the same as all
    % points reachable by k and b choices given w.
    support_map('bl_graph_evf') = false;
    if (it_iter == (it_maxiter_val + 1))
        support_map('bl_graph_evf') = bl_graph_evf;
    end
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = ...
        ff_ipwkbz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);

    %% Solve First Stage Problem w*(z) given k*(w,z)

    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)

        % Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z)
        % There are two w=k'+b' arrays. ar_w_level is the level even grid based
        % on which we solve the 2nd stage problem in ff_ipwkbz_evf.m. Here for
        % each coh level, we have a different vector of w levels, but the same
        % vector of percentage ws. So we need to interpolate to get the optimal
        % k* and b* choices at each percentage level of w.
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', 'linear', 'nearest');

        % Interpolate (2), shift from w_level to w_perc
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;

        % changes in w_perc kstar choices
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);


        % Consumption Update
        % Note that compared to
        % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
        % ffs_akz_set_functions> the mt_c here is much smaller the same
        % number of columns (states) as in the ffs_akz_set_functions file,
        % but the number of rows equal to ar_w length.
        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), ...
                      mt_w_astar_interp_z(mt_w_kstar_diff_idx), ...
                      mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c <= fl_c_min);
        % EVAL current utility: N by N, f_util defined earlier
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        % Update Storage
        if (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        else
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        end
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;

        % Generate Interpolant for (3) EV(k*(ar_w_perc),Z)
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', 'linear', 'nearest');
        % Interpolate (3), EVAL add on future utility, N by N + N by N
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        % Index update
        % using the method below is much faster than index replace
        % see <https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        % Default or Not Utility Handling
        if (bl_default)
            % if default: only today u(cmin), transition out next period, debt wiped out
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        else
            % if default is not allowed: v = u(cmin)
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        end

        % percentage algorithm does not have invalid (check to make sure
        % min percent is not 0 in ffs_ipwkbz_get_funcgrid.m)
        % mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);

        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        % Generate Linear Opti Index
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        % Handle Default is optimal or not
        if (bl_default)
            % if defaulting is optimal choice, at these states, not required
            % to default, non-default possible, but default could be optimal
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = fl_default_opti_kprime;
        else
            % if default is not allowed, then next period same state as now
            % this is absorbing state, this is the limiting case, single
            % state space point, lowest a and lowest shock has this.
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = min(ar_a);
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = 0;
        end

        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        end

    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
                                      mean(mt_pol_a_cur,1); ...
                                      mean(mt_pol_k_cur,1); ...
                                      mt_val_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(it_ameshk_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice')
        disp('mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_a') = mt_pol_a;
result_map('mt_pol_k') = mt_pol_k;

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);

    % graphing based on coh_wkb, but that does not match optimal choice
    % matrixes for graphs.
    armt_map('mt_coh_wkb') = mt_interp_coh_grid_mesh_z;
    armt_map('it_ameshk_n') = length(ar_interp_coh_grid);
    armt_map('ar_a_meshk') = mt_interp_coh_grid_mesh_z(:,1);
    armt_map('ar_k_mesha') = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>