
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Solve Save + Borr Dynamic Programming Problem (Loop)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-07"><meta name="DC.source" content="ff_abz_vf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Solve Save + Borr Dynamic Programming Problem (Loop)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_ABZ_VF solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Iterate Value Function</a></li><li><a href="#10">Iterate over a and z states</a></li><li><a href="#12">Store Optimal Choices and Value Given(a,z)</a></li><li><a href="#14">Check Tolerance and Continuation</a></li><li><a href="#16">Process Optimal Choices</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_abz_vf(varargin)
</pre><h2 id="2">FF_ABZ_VF solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic single asset and single shock problem with loops. This file contains codes that processes borrowing.</p><p>The borrowing problem is very similar to the savings problem. The code could be identical if one does not have to deal with default. The main addition here in comparison to the savings only code <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html">ff_az_vf</a> is the ability to deal with default.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><pre>  % Get Default Parameters
  it_param_set = 2;
  [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
  % Chnage param_map keys for borrowing
  param_map('fl_b_bd') = -20; % borrow bound
  param_map('bl_default') = false; % true if allow for default
  param_map('fl_c_min') = 0.0001; % u(c_min) when default
  % Change Keys in param_map
  param_map('it_a_n') = 500;
  param_map('fl_z_r_borr_n') = 5;
  param_map('it_z_wage_n') = 15;
  param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
  param_map('fl_a_max') = 100;
  param_map('fl_w') = 1.3;
  % Change Keys support_map
  support_map('bl_display') = false;
  support_map('bl_post') = true;
  support_map('bl_display_final') = false;
  % Call Program with external parameters that override defaults.
  ff_abz_vf(param_map, support_map);</pre><p>@include</p><div><ul><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html">ffs_abz_set_default_param</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html">ffs_abz_get_funcgrid</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html">ff_az_vf_post</a></li></ul></div><p>@seealso</p><div><ul><li>save loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html">ff_az_vf</a></li><li>save vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html">ff_az_vf_vec</a></li><li>save optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html">ff_az_vf_vecsv</a></li><li>save + borr loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html">ff_abz_vf</a></li><li>save + borr vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_abz_vf_vec</a></li><li>save + borr optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html">ff_abz_vf_vecsv</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% Note: param_map and support_map can be adjusted here or outside to override defaults</span>
param_map(<span class="string">'it_a_n'</span>) = 75;
param_map(<span class="string">'fl_z_r_borr_n'</span>) = 3;
param_map(<span class="string">'it_z_wage_n'</span>) = 5;
param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);
<span class="comment">% param_map('fl_r_save') = 0.025;</span>
<span class="comment">% param_map('fl_r_borr') = 0.035;</span>

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_abz_vf'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'mt_z_trans'</span>, <span class="string">'ar_z_r_borr_mesh_wage'</span>, <span class="string">'ar_z_wage_mesh_r_borr'</span>});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons_checkcmin'</span>, <span class="string">'f_coh'</span>, <span class="string">'f_cons_coh'</span>});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'it_a_n'</span>, <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>,<span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_aprime'</span>});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, <span class="keyword">...</span>
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_a),it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a),it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Utility at-Default/at-limiting-case-when-nodefault</span>
<span class="keyword">if</span> (fl_crra == 1)
    fl_u_cmin = f_util_log(fl_c_min);
<span class="keyword">else</span>
    fl_u_cmin = f_util_crra(fl_c_min);
<span class="keyword">end</span>


<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="10">Iterate over a and z states</h2><p>Solve Problem if Default: coh &lt; borr_bound, then: u(c_min) + EV(a'=0,z') these are the values for defaulter if do not borrow enough to pay debt: a'=0 if save more than what you have: a'=0 if borrowing, possible that all ar_val_cur values are u(cmin), when that is the case, utility equal to c_min, this means given current choice set, can only default, get utility at c_min level, and a' go to 0. See maximization over loop 3 choices for loop 1+2 states. see <a href="https://fanwangecon.github.io/CodeDynaAsset/docs/README_cminymin_borrsave.html">README_cminymin_borrsave</a> for additional discussions.</p><p>when default is not allowed, there should be exactly one element of the state space where we enter this condition. That is at a_min and z_min. At this point, the natural borrowing constraint when fully used up leads to c = 0. When default is not allowed, this is the limiting case. We solve the limiting case as if default is possible. see the figure here: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html">ffs_abz_get_funcgrid_nodefault</a>. For the figure under section <b>Generate Borrowing A Grid with Default</b>, there are no points to the lower right of the red horizontal and verticle lines, because no default is allowed. But the intersection of the two red lines is this limiting case where c = 0.</p><p>when default is allowed. See again <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html">ffs_abz_get_funcgrid_nodefault</a>. Again under section <b>Generate Borrowing A Grid with Default</b>, see that there is an area to the right bottom of the two blue horizontal and vertical lines. For all points in that area, the household has to default, they can not borrow even at max to get positive consumption. At other points higher than the blue horizontal line, it is also possible for defaulting to be the optimal choice.</p><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n

        <span class="comment">% Current Shock</span>
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        <span class="comment">% loop 2: over endogenous states</span>
        <span class="keyword">for</span> it_a_j = 1:length(ar_a)
</pre><pre class="codeinput">            fl_a = ar_a(it_a_j);
            ar_val_cur = zeros(size(ar_a));

            <span class="comment">% calculate cash on hand</span>
            fl_coh = f_coh(fl_z_r_borr, fl_z_wage, fl_a);

            <span class="comment">% loop 3: over choices</span>
            <span class="keyword">for</span> it_ap_k = 1:length(ar_a)

                <span class="comment">% get next period asset choice</span>
                fl_ap = ar_a(it_ap_k);

                <span class="comment">% calculate consumption</span>
                fl_c = f_cons_coh(fl_coh, fl_ap);

                <span class="comment">% assign u(c)</span>
                <span class="keyword">if</span> (fl_c &lt;= fl_c_min)
                    <span class="keyword">if</span> (bl_default)
                        <span class="comment">% defaults</span>
                        <span class="comment">% current utility: only today u(cmin)</span>
                        ar_val_cur(it_ap_k) = fl_u_cmin;
                        <span class="comment">% transition out next period, debt wiped out</span>
                        <span class="keyword">for</span> it_az_q = 1:it_z_n
                            ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + <span class="keyword">...</span>
                                fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur((ar_a == fl_default_aprime), it_az_q);
                        <span class="keyword">end</span>
                    <span class="keyword">else</span>
                        <span class="comment">% if default is not allowed: v = fl_nan_replace</span>
                        ar_val_cur(it_ap_k) = fl_nan_replace;
                    <span class="keyword">end</span>
                <span class="keyword">else</span>
                    <span class="comment">% Solve Optimization Problem: max_{a'} u(c(a,a',z)) + beta*EV(a',z')</span>
                    <span class="comment">% borrowed enough to pay debt (and borrowing limit not exceeded)</span>
                    <span class="comment">% saved only the coh available.</span>
                    <span class="comment">% current utility</span>
                    <span class="keyword">if</span> (fl_crra == 1)
                        ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    <span class="keyword">else</span>
                        ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    <span class="keyword">end</span>
                    <span class="comment">% loop 4: add future utility, integration--loop over future shocks</span>
                    <span class="keyword">for</span> it_az_q = 1:it_z_n
                        ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + <span class="keyword">...</span>
                            fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur(it_ap_k, it_az_q);
                    <span class="keyword">end</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>

            <span class="comment">% optimal choice value</span>
            [fl_opti_val_z, fl_opti_idx_z] = max(ar_val_cur);
            fl_opti_aprime_z = ar_a(fl_opti_idx_z);
            fl_opti_c_z = f_cons_coh(fl_coh, fl_opti_aprime_z);

            <span class="comment">% Handle Default is optimal or not</span>
            <span class="keyword">if</span> (fl_opti_c_z &lt;= fl_c_min)
                <span class="keyword">if</span> (bl_default)
                    <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
                    <span class="comment">% to default, non-default possible, but default could be optimal</span>
                    fl_opti_aprime_z = fl_default_aprime;
                <span class="keyword">else</span>
                    <span class="comment">% if default is not allowed, then next period same state as now</span>
                    <span class="comment">% this is absorbing state, this is the limiting case, single</span>
                    <span class="comment">% state space point, lowest a and lowest shock has this.</span>
                    fl_opti_aprime_z = fl_a;
                <span class="keyword">end</span>
            <span class="keyword">end</span>
</pre><h2 id="12">Store Optimal Choices and Value Given(a,z)</h2><pre class="codeinput">            mt_val(it_a_j,it_z_i) = fl_opti_val_z;
            mt_pol_a(it_a_j,it_z_i) = fl_opti_aprime_z;
</pre><pre class="codeinput">        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="14">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_a_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_a_n,:), highest a state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 915.994630 seconds.
</pre><h2 id="16">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;

result_map(<span class="string">'cl_mt_coh'</span>) = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_pol_c'</span>) = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_coh"</span>, <span class="string">"cl_mt_pol_c"</span>];

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
Warning: Using only the real component of complex data. 
valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n): percentage of state space points conditional on shock where the policy function is changing across iterations
                 valgap     polgap       z1          z2          z3          z4          z5          z6          z7          z8          z9         z10         z11         z12         z13         z14         z15   
                ________    ______    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________    ________

    iter=1        174.62    633.02           1           1           1           1           1           1           1           1           1           1           1           1           1           1           1
    iter=2        111.55    678.82     0.97333     0.98667     0.98667           1           1     0.97333     0.97333     0.98667     0.98667           1        0.96        0.96     0.97333     0.98667     0.98667
    iter=3        79.528    228.13     0.94667        0.96        0.96     0.97333           1     0.94667     0.94667     0.97333     0.97333     0.97333     0.93333     0.94667     0.94667        0.96     0.97333
    iter=4         58.14    114.78     0.93333        0.92        0.92        0.96        0.96     0.90667     0.90667        0.92     0.93333        0.96     0.89333     0.89333     0.90667        0.92     0.94667
    iter=5        45.756    68.577     0.86667     0.86667     0.85333     0.86667     0.90667        0.84     0.85333     0.86667        0.88     0.89333        0.88     0.86667     0.85333     0.86667     0.90667
    iter=6        38.292    46.424     0.77333         0.8     0.81333     0.82667     0.86667     0.78667     0.78667     0.81333     0.78667        0.84     0.74667     0.78667         0.8         0.8     0.85333
    iter=7        32.882    33.229     0.70667        0.68     0.70667     0.74667     0.77333     0.66667     0.65333        0.72     0.74667     0.77333     0.69333     0.69333     0.70667     0.74667        0.76
    iter=8        28.879     24.87     0.58667        0.64     0.62667         0.6        0.64     0.58667     0.62667     0.61333     0.61333     0.65333     0.58667     0.62667         0.6     0.61333     0.66667
    iter=9        25.603    19.641        0.48        0.52     0.50667        0.56         0.6     0.46667     0.50667        0.52     0.54667     0.61333        0.48     0.50667     0.50667        0.56     0.58667
    iter=10       22.793    15.184     0.38667     0.33333     0.38667         0.4     0.45333        0.36        0.32         0.4         0.4     0.45333        0.36        0.32         0.4     0.38667     0.45333
    iter=11       20.523     13.57        0.32     0.33333     0.30667     0.34667     0.38667     0.30667     0.33333     0.30667     0.33333         0.4        0.32     0.34667     0.29333     0.33333     0.38667
    iter=12       18.589    11.797     0.26667        0.28     0.26667     0.25333     0.30667        0.28     0.26667     0.26667     0.25333     0.30667     0.29333     0.26667        0.24     0.26667     0.29333
    iter=13       16.884    10.593     0.21333     0.21333     0.21333     0.26667     0.30667     0.18667     0.21333     0.21333     0.26667     0.29333     0.18667     0.21333         0.2        0.28     0.29333
    iter=14       15.387    9.5391         0.2     0.18667         0.2     0.18667         0.2     0.18667     0.17333         0.2     0.17333     0.22667     0.18667     0.17333     0.18667     0.18667     0.25333
    iter=15       14.018    8.2037        0.16        0.16        0.16        0.16     0.17333        0.16     0.17333        0.16     0.14667     0.17333        0.16     0.14667     0.18667     0.14667        0.16
    iter=16       12.734    7.6847     0.13333        0.12     0.13333     0.14667        0.16        0.12     0.13333     0.14667        0.16     0.17333        0.12        0.12        0.16     0.13333        0.16
    iter=17       11.537    6.9549        0.08        0.12     0.13333        0.12     0.14667        0.08        0.12        0.16     0.14667     0.14667        0.08     0.10667     0.13333        0.12     0.13333
    iter=18       10.434    6.8559        0.12     0.13333     0.13333     0.10667        0.12    0.093333        0.12     0.13333    0.093333        0.12    0.093333        0.12        0.16    0.093333     0.10667
    iter=19       9.4665     7.373     0.10667        0.08        0.08     0.13333     0.14667     0.10667    0.093333        0.08     0.14667        0.16     0.10667        0.08     0.10667     0.13333     0.14667
    iter=20       8.6119    6.3927        0.08        0.08        0.08     0.10667     0.10667        0.08        0.08        0.08    0.093333    0.093333        0.08        0.08        0.08    0.093333    0.093333
    iter=21       7.8477    4.6392        0.04    0.053333    0.066667        0.04        0.08    0.026667    0.053333    0.066667    0.053333        0.08        0.04    0.053333    0.066667        0.04    0.066667
    iter=22       7.1671    5.7942    0.066667    0.093333    0.066667    0.066667    0.066667        0.08    0.093333    0.066667    0.053333        0.08    0.066667        0.08    0.066667    0.053333    0.066667
    iter=23       6.5619    4.8213        0.04        0.04    0.066667    0.066667    0.066667        0.04    0.053333    0.066667        0.08    0.053333        0.04        0.04    0.066667    0.066667    0.053333
    iter=24       6.0248    4.2499        0.04    0.066667    0.066667        0.04    0.066667        0.04    0.053333    0.066667    0.026667        0.08        0.04    0.053333    0.066667    0.026667    0.066667
    iter=25       5.5442    4.8991    0.066667    0.053333    0.026667    0.053333    0.066667    0.053333    0.066667    0.026667    0.066667    0.066667    0.053333    0.053333    0.026667    0.053333    0.053333
    iter=26       5.1119    4.8488        0.04        0.04    0.053333    0.093333    0.053333        0.04    0.053333    0.053333        0.08    0.053333        0.04        0.04    0.053333    0.066667    0.053333
    iter=27       4.7201    3.5821        0.04    0.053333    0.026667    0.026667        0.04        0.04    0.053333    0.026667        0.04    0.053333        0.04    0.053333    0.026667    0.026667        0.04
    iter=28       4.3652    4.1734        0.04    0.026667    0.053333        0.04    0.066667        0.04    0.026667    0.053333    0.053333    0.066667        0.04    0.026667    0.053333    0.053333    0.053333
    iter=29       4.0418    3.4829        0.04    0.026667    0.026667    0.053333        0.04        0.04    0.026667    0.026667        0.04    0.026667        0.04        0.04    0.026667        0.04    0.026667
    iter=30       3.7458    2.7543        0.04    0.026667    0.026667    0.026667    0.013333    0.026667    0.026667    0.026667        0.04    0.026667    0.026667        0.04    0.026667    0.026667    0.013333
    iter=31       3.4718    3.5195    0.053333    0.013333    0.026667    0.026667    0.026667        0.04    0.026667    0.026667        0.04    0.026667        0.04    0.026667    0.026667    0.026667    0.026667
    iter=32       3.2189    2.9109           0    0.026667    0.026667    0.013333    0.026667           0    0.026667    0.026667    0.026667        0.04           0    0.026667    0.026667    0.013333    0.026667
    iter=33       2.9894    2.3488    0.013333    0.013333    0.026667    0.026667    0.013333    0.013333    0.013333    0.026667    0.026667    0.013333    0.013333    0.013333    0.026667    0.026667    0.013333
    iter=34        2.781    2.3488    0.026667    0.013333    0.026667           0    0.026667    0.026667    0.013333    0.026667           0    0.026667    0.026667    0.013333    0.026667           0    0.026667
    iter=35       2.5911    2.4206           0    0.026667    0.026667    0.026667    0.013333           0    0.026667    0.026667    0.026667    0.013333           0        0.04    0.026667    0.026667    0.013333
    iter=36       2.4174    1.6609    0.013333           0           0    0.013333    0.013333    0.013333           0           0    0.013333    0.013333    0.013333           0           0    0.013333    0.013333
    iter=37       2.2585    2.3488    0.026667    0.013333    0.026667    0.013333    0.026667    0.026667    0.013333    0.026667    0.013333    0.026667    0.026667    0.013333    0.026667    0.013333    0.026667
    iter=38       2.1124    2.3488    0.013333    0.026667    0.026667    0.013333           0           0    0.026667    0.026667    0.013333    0.013333           0    0.026667    0.026667    0.013333           0
    iter=39       1.9778    2.3488    0.013333           0    0.026667    0.013333    0.026667    0.013333           0    0.026667    0.013333    0.026667    0.013333           0    0.026667    0.013333    0.026667
    iter=40       1.8539    1.6609           0    0.013333    0.013333           0    0.013333           0    0.013333    0.013333           0    0.013333           0    0.013333    0.013333    0.013333    0.013333
    iter=41       1.7395    2.3488    0.013333    0.013333    0.013333    0.026667    0.013333    0.013333    0.013333    0.013333    0.026667    0.013333    0.013333    0.013333    0.013333    0.026667    0.013333
    iter=42       1.6335    1.6609    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333
    iter=43       1.5353    1.6609    0.013333    0.013333    0.013333           0           0    0.013333    0.013333    0.013333           0           0    0.013333    0.013333    0.013333           0           0
    iter=44       1.4443    2.3488           0           0    0.013333    0.013333    0.026667           0           0    0.013333    0.013333    0.026667           0           0    0.013333    0.013333    0.026667
    iter=45       1.3597    2.3488    0.013333    0.026667           0           0           0    0.013333    0.026667           0           0           0    0.013333    0.026667           0           0           0
    iter=46       1.2809    2.3488           0           0           0    0.026667    0.013333           0           0           0    0.026667    0.013333           0           0           0    0.026667    0.013333
    iter=47       1.2074    1.6609    0.013333    0.013333    0.013333           0    0.013333    0.013333    0.013333    0.013333           0    0.013333    0.013333    0.013333    0.013333    0.013333    0.013333
    iter=48       1.1387    1.6609           0           0           0    0.013333    0.013333           0           0           0    0.013333    0.013333           0           0           0    0.013333    0.013333
    iter=49       1.0744    1.6609    0.013333    0.013333           0           0           0    0.013333    0.013333           0           0           0    0.013333    0.013333           0           0           0
    iter=50       1.0142    1.6609           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333           0
    iter=57      0.68117    1.6609           0    0.013333    0.013333    0.013333           0           0    0.013333    0.013333    0.013333           0           0    0.013333    0.013333    0.013333           0
    iter=58       0.6435    1.6609           0           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333
    iter=59      0.60784         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=60      0.57408         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=61      0.54209    1.6609    0.013333    0.013333           0    0.013333           0    0.013333    0.013333           0    0.013333           0    0.013333    0.013333           0    0.013333           0
    iter=62      0.51176    1.6609           0           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333
    iter=63      0.48303         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=64      0.45582         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=65      0.43005    1.6609           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333           0
    iter=66      0.40564    0.9589           0           0           0           0           0           0           0           0           0           0           0           0           0           0    0.013333
    iter=67      0.38251    1.6609           0           0           0    0.013333    0.013333           0           0           0    0.013333    0.013333           0           0           0    0.013333    0.013333
    iter=68      0.36062         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=69      0.33992         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=70      0.32035    1.6609           0    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0
    iter=71      0.30187         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=72       0.2844         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=73      0.26791         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=74      0.25234         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=75      0.23765         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=76      0.22379         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=77      0.21071         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=78      0.19838         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=79      0.18676         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=80      0.17579    1.6609    0.013333           0           0           0           0    0.013333           0           0           0           0    0.013333           0           0           0           0
    iter=81      0.16546         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=82      0.15573         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=83      0.14656         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=84      0.13792         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=85      0.12978         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=86      0.12212         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=87       0.1149         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=88       0.1081         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=89       0.1017         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=90     0.095681         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=91     0.090011         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=92     0.084674         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=93     0.079651         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=94     0.074924         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=95     0.070475         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=96     0.066288         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=97     0.062349         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=98     0.058642         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=99     0.055154         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=100    0.051872         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=101    0.048785         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=102     0.04588         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=103    0.043147         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=104    0.040577         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=105    0.038158         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0
    iter=106    0.035884         0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0

tb_val: V(a,z) value at each state space point
                     zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                     _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    a1=-20                   -62.254                   -58.487                    -54.172                    -41.577                  -26.366                   -62.254                  -60.723                   -59.139                  -47.015                  -29.932                    -62.254                    -60.723                     -59.139                    -53.917                    -31.356       
    a2=-19.0411              -57.825                    -55.68                    -49.782                    -37.111                  -22.898                    -59.73                  -56.926                   -53.751                  -40.944                  -25.849                    -62.254                    -60.723                     -55.225                    -44.095                    -27.126       
    a3=-18.0822              -55.796                   -51.966                    -45.593                    -32.974                  -19.752                   -57.336                  -54.203                   -49.347                   -36.47                  -21.961                    -58.248                    -56.276                     -50.479                    -38.493                    -23.422       
    a4=-17.1233              -52.797                   -48.428                    -41.292                    -29.169                   -16.86                   -54.067                  -50.561                   -44.091                  -32.328                  -18.594                    -56.082                    -53.592                     -46.042                    -33.776                    -20.101       
    a5=-16.1644               -49.95                   -44.731                    -37.131                    -25.667                  -14.181                   -51.013                  -47.084                   -39.214                  -28.519                   -15.58                    -52.974                    -49.984                      -41.56                    -29.614                    -17.073       
    a6=-15.2055              -46.873                    -40.76                    -33.178                    -22.402                  -11.669                   -47.769                  -43.441                   -34.802                  -25.016                  -12.819                    -50.039                    -45.316                      -37.26                    -25.871                    -14.285       
    a7=-14.2466              -43.566                   -36.831                    -29.465                    -19.264                  -9.3555                   -44.328                  -39.518                   -30.765                  -21.751                  -10.312                    -46.887                    -40.836                     -33.198                    -22.433                    -11.686       
    a8=-13.2877              -40.128                   -33.064                    -25.977                    -16.319                   -7.272                   -40.777                  -35.632                   -27.035                  -18.427                  -8.0733                    -43.518                     -36.61                     -29.398                    -19.165                    -9.2997       
    a9=-12.3288              -36.659                   -29.486                     -22.72                     -13.63                  -5.3852                   -37.213                  -31.905                    -23.59                  -15.217                  -6.0594                    -38.983                    -32.654                     -25.839                    -16.121                    -7.1554       
    a10=-11.3699             -32.711                   -26.116                    -19.701                     -11.11                  -3.7169                   -33.499                  -28.363                   -20.421                  -12.342                  -4.2853                    -34.701                    -28.948                     -22.522                    -13.353                    -5.2172       
    a11=-10.411              -28.935                   -22.938                    -16.832                    -8.7138                   -2.261                   -29.831                  -25.024                   -17.429                  -9.6867                  -2.7399                    -30.696                    -25.487                     -19.313                    -10.769                    -3.5052       
    a12=-9.45205             -25.426                   -19.806                    -13.715                    -6.6514                 -0.98209                   -26.343                  -21.876                    -14.21                  -7.4271                  -1.3844                    -26.985                    -22.245                     -15.416                    -8.3222                    -2.0116       
    a13=-8.49315             -22.022                   -16.686                        -11                    -4.8564                  0.14653                    -23.06                  -18.268                   -11.409                  -5.4768                 -0.18952                    -23.544                    -19.066                     -12.238                    -6.2179                   -0.70003       
    a14=-7.53425             -18.771                   -13.765                    -8.6168                    -3.2897                   1.1485                    -19.84                  -14.903                   -8.9519                  -3.7849                  0.87021                    -20.209                    -15.911                     -9.5416                    -4.3882                    0.45699       
    a15=-6.57534             -15.763                   -11.156                    -6.5467                    -1.9127                   2.0388                    -16.74                   -11.99                   -6.8183                  -2.3049                   1.8113                     -17.02                    -12.963                     -7.2445                    -2.7926                     1.4838       
    a16=-5.61644             -13.048                   -8.8671                    -4.7483                   -0.69097                   2.8315                    -13.86                   -9.479                   -4.9647                 -0.99723                   2.6488                    -14.071                    -10.336                     -5.2733                    -1.3914                      2.399       
    a17=-4.65753             -10.634                    -6.867                    -3.1775                    0.40621                   3.5289                   -11.254                  -7.3107                   -3.3455                   0.1726                    3.386                     -11.41                     -8.033                     -3.5664                    -0.1493                     3.2079       
    a18=-3.69863             -8.4188                   -4.9662                    -1.7267                     1.3678                   4.1526                    -8.935                  -5.2785                    -1.852                   1.1963                   4.0454                    -9.0464                    -5.7448                     -2.0056                    0.97477                     3.9222       
    a19=-2.73973             -6.4458                   -3.3303                   -0.47062                     2.2155                   4.6925                   -6.8029                  -3.5375                  -0.55804                   2.0975                   4.6172                    -6.8777                    -3.8071                    -0.65878                     1.9568                      4.561       
    a20=-1.78082             -4.7271                   -1.9434                    0.61202                     2.9711                    5.185                   -4.9031                  -2.0651                   0.55836                   2.8996                   5.1455                    -4.9474                    -2.2071                     0.49981                       2.82                     5.1142       
    a21=-0.821918            -3.2312                   -0.7456                     1.5615                     3.6457                   5.5907                   -3.2494                 -0.79677                     1.538                   3.6204                    5.582                    -3.2681                   -0.85135                      1.5137                     3.5941                     5.5731       
    a22=0                    -1.9103                    0.1597                     2.2659                     4.1245                   5.9223                   -1.9103                   0.1597                    2.2659                   4.1245                   5.9223                    -1.9103                     0.1597                      2.2659                     4.1245                     5.9223       
    a23=0.136986             -1.6458                   0.36202                     2.3748                      4.179                   5.9658                   -1.6458                  0.36202                    2.3748                    4.179                   5.9658                    -1.6458                    0.36202                      2.3748                      4.179                     5.9658       
    a24=1.09589             -0.46099                    1.1626                     2.9255                     4.6279                   6.3183                  -0.46099                   1.1626                    2.9255                   4.6279                   6.3183                   -0.46099                     1.1626                      2.9255                     4.6279                     6.3183       
    a25=2.05479              0.52109                    1.8871                     3.4323                     5.0438                    6.653                   0.52109                   1.8871                    3.4323                   5.0438                    6.653                    0.52109                     1.8871                      3.4323                     5.0438                      6.653       
    a26=3.0137                1.3601                    2.5418                     3.8989                     5.4303                   6.9759                    1.3601                   2.5418                    3.8989                   5.4303                   6.9759                     1.3601                     2.5418                      3.8989                     5.4303                     6.9759       
    a27=3.9726                 2.092                    3.1343                     4.3467                     5.8021                    7.288                     2.092                   3.1343                    4.3467                   5.8021                    7.288                      2.092                     3.1343                      4.3467                     5.8021                      7.288       
    a28=4.93151                 2.74                    3.6757                     4.7816                      6.163                   7.5884                      2.74                   3.6757                    4.7816                    6.163                   7.5884                       2.74                     3.6757                      4.7816                      6.163                     7.5884       
    a29=5.89041               3.3213                    4.1757                     5.2006                      6.511                   7.8769                    3.3213                   4.1757                    5.2006                    6.511                   7.8769                     3.3213                     4.1757                      5.2006                      6.511                     7.8769       
    a30=6.84932               3.8492                    4.6411                     5.6023                     6.8454                   8.1534                    3.8492                   4.6411                    5.6023                   6.8454                   8.1534                     3.8492                     4.6411                      5.6023                     6.8454                     8.1534       
    a31=7.80822               4.3338                    5.0768                     5.9863                     7.1657                   8.4184                    4.3338                   5.0768                    5.9863                   7.1657                   8.4184                     4.3338                     5.0768                      5.9863                     7.1657                     8.4184       
    a32=8.76712               4.7826                    5.4865                     6.3528                     7.4722                   8.6723                    4.7826                   5.4865                    6.3528                   7.4722                   8.6723                     4.7826                     5.4865                      6.3528                     7.4722                     8.6723       
    a33=9.72603               5.2011                    5.8729                     6.7022                     7.7653                   8.9156                    5.2011                   5.8729                    6.7022                   7.7653                   8.9156                     5.2011                     5.8729                      6.7022                     7.7653                     8.9156       
    a34=10.6849               5.5936                    6.2383                     7.0351                     8.0456                   9.1489                    5.5936                   6.2383                    7.0351                   8.0456                   9.1489                     5.5936                     6.2383                      7.0351                     8.0456                     9.1489       
    a35=11.6438               5.9634                    6.5847                     7.3525                     8.3136                   9.3728                    5.9634                   6.5847                    7.3525                   8.3136                   9.3728                     5.9634                     6.5847                      7.3525                     8.3136                     9.3728       
    a36=12.6027               6.3129                    6.9136                      7.655                     8.5701                   9.5881                    6.3129                   6.9136                     7.655                   8.5701                   9.5881                     6.3129                     6.9136                       7.655                     8.5701                     9.5881       
    a37=13.5616               6.6442                    7.2263                     7.9437                     8.8156                   9.7953                    6.6442                   7.2263                    7.9437                   8.8156                   9.7953                     6.6442                     7.2263                      7.9437                     8.8156                     9.7953       
    a38=14.5205                6.959                    7.5242                     8.2192                      9.051                   9.9953                     6.959                   7.5242                    8.2192                    9.051                   9.9953                      6.959                     7.5242                      8.2192                      9.051                     9.9953       
    a39=15.4795               7.2597                    7.8082                     8.4824                     9.2768                   10.189                    7.2597                   7.8082                    8.4824                   9.2768                   10.189                     7.2597                     7.8082                      8.4824                     9.2768                     10.189       
    a40=16.4384               7.5544                    8.0793                     8.7341                     9.4937                   10.378                    7.5544                   8.0793                    8.7341                   9.4937                   10.378                     7.5544                     8.0793                      8.7341                     9.4937                     10.378       
    a41=17.3973               7.8359                    8.3388                     8.9751                     9.7025                   10.563                    7.8359                   8.3388                    8.9751                   9.7025                   10.563                     7.8359                     8.3388                      8.9751                     9.7025                     10.563       
    a42=18.3562               8.1091                    8.5874                      9.206                     9.9081                   10.744                    8.1091                   8.5874                     9.206                   9.9081                   10.744                     8.1091                     8.5874                       9.206                     9.9081                     10.744       
    a43=19.3151               8.3704                    8.8258                     9.4279                      10.11                   10.921                    8.3704                   8.8258                    9.4279                    10.11                   10.921                     8.3704                     8.8258                      9.4279                      10.11                     10.921       
    a44=20.274                8.6228                    9.0587                     9.6418                     10.306                   11.094                    8.6228                   9.0587                    9.6418                   10.306                   11.094                     8.6228                     9.0587                      9.6418                     10.306                     11.094       
    a45=21.2329               8.8647                    9.2845                     9.8485                     10.498                   11.265                    8.8647                   9.2845                    9.8485                   10.498                   11.265                     8.8647                     9.2845                      9.8485                     10.498                     11.265       
    a46=22.1918               9.0994                    9.5043                     10.049                     10.684                   11.433                    9.0994                   9.5043                    10.049                   10.684                   11.433                     9.0994                     9.5043                      10.049                     10.684                     11.433       
    a47=23.1507               9.3255                    9.7172                     10.243                     10.865                   11.597                    9.3255                   9.7172                    10.243                   10.865                   11.597                     9.3255                     9.7172                      10.243                     10.865                     11.597       
    a48=24.1096               9.5452                    9.9244                     10.431                     11.041                   11.756                    9.5452                   9.9244                    10.431                   11.041                   11.756                     9.5452                     9.9244                      10.431                     11.041                     11.756       
    a49=25.0685               9.7574                    10.125                     10.614                     11.212                   11.911                    9.7574                   10.125                    10.614                   11.212                   11.911                     9.7574                     10.125                      10.614                     11.212                     11.911       
    a50=26.0274               9.9638                     10.32                     10.792                     11.379                   12.062                    9.9638                    10.32                    10.792                   11.379                   12.062                     9.9638                      10.32                      10.792                     11.379                     12.062       
    a51=26.9863               10.163                     10.51                     10.965                      11.54                   12.209                    10.163                    10.51                    10.965                    11.54                   12.209                     10.163                      10.51                      10.965                      11.54                     12.209       
    a52=27.9452               10.358                    10.694                     11.133                     11.698                   12.352                    10.358                   10.694                    11.133                   11.698                   12.352                     10.358                     10.694                      11.133                     11.698                     12.352       
    a53=28.9041               10.546                    10.873                     11.297                     11.851                   12.491                    10.546                   10.873                    11.297                   11.851                   12.491                     10.546                     10.873                      11.297                     11.851                     12.491       
    a54=29.863                10.729                    11.047                     11.458                         12                   12.627                    10.729                   11.047                    11.458                       12                   12.627                     10.729                     11.047                      11.458                         12                     12.627       
    a55=30.8219               10.907                    11.216                     11.616                     12.146                   12.759                    10.907                   11.216                    11.616                   12.146                   12.759                     10.907                     11.216                      11.616                     12.146                     12.759       
    a56=31.7808                11.08                    11.381                     11.771                     12.288                   12.889                     11.08                   11.381                    11.771                   12.288                   12.889                      11.08                     11.381                      11.771                     12.288                     12.889       
    a57=32.7397               11.248                    11.541                     11.922                     12.428                   13.017                    11.248                   11.541                    11.922                   12.428                   13.017                     11.248                     11.541                      11.922                     12.428                     13.017       
    a58=33.6986               11.411                    11.698                     12.071                     12.564                   13.141                    11.411                   11.698                    12.071                   12.564                   13.141                     11.411                     11.698                      12.071                     12.564                     13.141       
    a59=34.6575               11.571                    11.851                     12.216                     12.698                   13.263                    11.571                   11.851                    12.216                   12.698                   13.263                     11.571                     11.851                      12.216                     12.698                     13.263       
    a60=35.6164               11.726                    12.001                     12.358                     12.829                   13.383                    11.726                   12.001                    12.358                   12.829                   13.383                     11.726                     12.001                      12.358                     12.829                     13.383       
    a61=36.5753               11.878                    12.147                     12.497                     12.957                     13.5                    11.878                   12.147                    12.497                   12.957                     13.5                     11.878                     12.147                      12.497                     12.957                       13.5       
    a62=37.5342               12.026                     12.29                     12.634                     13.083                   13.615                    12.026                    12.29                    12.634                   13.083                   13.615                     12.026                      12.29                      12.634                     13.083                     13.615       
    a63=38.4932                12.17                    12.429                     12.767                     13.206                   13.728                     12.17                   12.429                    12.767                   13.206                   13.728                      12.17                     12.429                      12.767                     13.206                     13.728       
    a64=39.4521               12.311                    12.566                     12.897                     13.327                   13.839                    12.311                   12.566                    12.897                   13.327                   13.839                     12.311                     12.566                      12.897                     13.327                     13.839       
    a65=40.411                12.449                    12.699                     13.025                     13.445                   13.947                    12.449                   12.699                    13.025                   13.445                   13.947                     12.449                     12.699                      13.025                     13.445                     13.947       
    a66=41.3699               12.583                     12.83                      13.15                     13.561                   14.054                    12.583                    12.83                     13.15                   13.561                   14.054                     12.583                      12.83                       13.15                     13.561                     14.054       
    a67=42.3288               12.715                    12.957                     13.273                     13.675                   14.158                    12.715                   12.957                    13.273                   13.675                   14.158                     12.715                     12.957                      13.273                     13.675                     14.158       
    a68=43.2877               12.844                    13.083                     13.393                     13.786                    14.26                    12.844                   13.083                    13.393                   13.786                    14.26                     12.844                     13.083                      13.393                     13.786                      14.26       
    a69=44.2466               12.972                    13.205                     13.511                     13.895                   14.361                    12.972                   13.205                    13.511                   13.895                   14.361                     12.972                     13.205                      13.511                     13.895                     14.361       
    a70=45.2055               13.096                    13.325                     13.626                     14.002                   14.459                    13.096                   13.325                    13.626                   14.002                   14.459                     13.096                     13.325                      13.626                     14.002                     14.459       
    a71=46.1644               13.219                    13.443                     13.739                     14.108                   14.556                    13.219                   13.443                    13.739                   14.108                   14.556                     13.219                     13.443                      13.739                     14.108                     14.556       
    a72=47.1233               13.339                    13.558                      13.85                     14.211                   14.651                    13.339                   13.558                     13.85                   14.211                   14.651                     13.339                     13.558                       13.85                     14.211                     14.651       
    a73=48.0822               13.457                    13.671                     13.958                     14.312                   14.744                    13.457                   13.671                    13.958                   14.312                   14.744                     13.457                     13.671                      13.958                     14.312                     14.744       
    a74=49.0411               13.573                    13.782                     14.065                     14.412                   14.837                    13.573                   13.782                    14.065                   14.412                   14.837                     13.573                     13.782                      14.065                     14.412                     14.837       
    a75=50                    13.687                    13.891                     14.169                      14.51                   14.927                    13.687                   13.891                    14.169                    14.51                   14.927                     13.687                     13.891                      14.169                      14.51                     14.927       

tb_pol_a: optimal asset choice for each state space point
                     zi1_zr_0_025_zw_0_33942    zi2_zr_0_025_zw_0_5596    zi3_zr_0_025_zw_0_92263    zi4_zr_0_025_zw_1_5212    zi5_zr_0_025_zw_2_508    zi6_zr_0_06_zw_0_33942    zi7_zr_0_06_zw_0_5596    zi8_zr_0_06_zw_0_92263    zi9_zr_0_06_zw_1_5212    zi10_zr_0_06_zw_2_508    zi11_zr_0_095_zw_0_33942    zi12_zr_0_095_zw_0_5596    zi13_zr_0_095_zw_0_92263    zi14_zr_0_095_zw_1_5212    zi15_zr_0_095_zw_2_508
                     _______________________    ______________________    _______________________    ______________________    _____________________    ______________________    _____________________    ______________________    _____________________    _____________________    ________________________    _______________________    ________________________    _______________________    ______________________

    a1=-20                         0                        -20                       -20                    -19.041                  -18.082                         0                        0                         0                      -20                  -19.041                          0                          0                           0                        -20                    -19.041       
    a2=-19.0411                  -20                    -19.041                   -19.041                    -18.082                  -17.123                       -20                      -20                       -20                  -19.041                  -17.123                          0                          0                         -20                    -19.041                    -18.082       
    a3=-18.0822              -19.041                    -18.082                   -18.082                    -17.123                  -16.164                   -19.041                  -19.041                   -19.041                  -18.082                  -16.164                        -20                        -20                     -19.041                    -18.082                    -17.123       
    a4=-17.1233              -18.082                    -17.123                   -17.123                    -16.164                  -15.205                   -18.082                  -18.082                   -17.123                  -17.123                  -15.205                    -19.041                    -19.041                     -18.082                    -17.123                    -16.164       
    a5=-16.1644              -17.123                    -16.164                   -16.164                    -15.205                  -14.247                   -17.123                  -17.123                   -16.164                  -16.164                  -14.247                    -18.082                    -18.082                     -17.123                    -16.164                    -15.205       
    a6=-15.2055              -16.164                    -15.205                   -15.205                    -14.247                  -13.288                   -16.164                  -16.164                   -15.205                  -15.205                  -13.288                    -17.123                    -16.164                     -16.164                    -15.205                    -14.247       
    a7=-14.2466              -15.205                    -14.247                   -14.247                    -13.288                  -12.329                   -15.205                  -15.205                   -14.247                  -14.247                  -12.329                    -16.164                    -15.205                     -15.205                    -14.247                    -13.288       
    a8=-13.2877              -14.247                    -13.288                   -13.288                    -12.329                   -11.37                   -14.247                  -14.247                   -13.288                  -12.329                   -11.37                    -15.205                    -14.247                     -14.247                    -13.288                    -12.329       
    a9=-12.3288              -13.288                    -12.329                   -12.329                     -11.37                  -10.411                   -13.288                  -13.288                   -12.329                   -11.37                  -10.411                    -13.288                    -13.288                     -13.288                    -12.329                     -11.37       
    a10=-11.3699              -11.37                     -11.37                    -11.37                    -10.411                  -9.4521                   -12.329                  -12.329                    -11.37                  -10.411                  -9.4521                    -12.329                    -12.329                     -12.329                     -11.37                    -10.411       
    a11=-10.411              -10.411                    -10.411                   -10.411                    -9.4521                  -8.4932                    -11.37                   -11.37                   -10.411                  -9.4521                  -8.4932                     -11.37                     -11.37                     -10.411                    -10.411                    -9.4521       
    a12=-9.45205             -9.4521                    -9.4521                   -9.4521                    -8.4932                  -7.5342                   -10.411                  -10.411                   -9.4521                  -8.4932                  -7.5342                    -10.411                    -10.411                     -9.4521                    -9.4521                    -8.4932       
    a13=-8.49315             -8.4932                    -8.4932                   -8.4932                    -7.5342                  -6.5753                   -9.4521                  -8.4932                   -8.4932                  -7.5342                  -6.5753                    -9.4521                    -9.4521                     -8.4932                    -8.4932                    -7.5342       
    a14=-7.53425             -7.5342                    -7.5342                   -7.5342                    -6.5753                  -5.6164                   -8.4932                  -7.5342                   -7.5342                  -6.5753                  -5.6164                    -8.4932                    -8.4932                     -7.5342                    -7.5342                    -6.5753       
    a15=-6.57534             -6.5753                    -6.5753                   -6.5753                    -5.6164                  -4.6575                   -7.5342                  -6.5753                   -6.5753                  -5.6164                  -4.6575                    -7.5342                    -7.5342                     -6.5753                    -6.5753                    -5.6164       
    a16=-5.61644             -5.6164                    -5.6164                   -5.6164                    -4.6575                  -3.6986                   -6.5753                  -5.6164                   -5.6164                  -4.6575                  -3.6986                    -6.5753                    -6.5753                     -5.6164                    -5.6164                    -3.6986       
    a17=-4.65753             -4.6575                    -4.6575                   -4.6575                    -3.6986                  -2.7397                   -5.6164                  -4.6575                   -4.6575                  -3.6986                  -2.7397                    -5.6164                    -5.6164                     -4.6575                    -4.6575                    -3.6986       
    a18=-3.69863             -3.6986                    -3.6986                   -3.6986                    -2.7397                  -1.7808                   -4.6575                  -3.6986                   -3.6986                  -2.7397                  -1.7808                    -4.6575                    -3.6986                     -3.6986                    -2.7397                    -2.7397       
    a19=-2.73973             -2.7397                    -2.7397                   -2.7397                    -1.7808                 -0.82192                   -3.6986                  -2.7397                   -2.7397                  -1.7808                 -0.82192                    -3.6986                    -2.7397                     -2.7397                    -1.7808                    -1.7808       
    a20=-1.78082             -1.7808                    -1.7808                   -1.7808                   -0.82192                        0                   -2.7397                  -1.7808                   -1.7808                 -0.82192                        0                    -2.7397                    -1.7808                     -1.7808                   -0.82192                   -0.82192       
    a21=-0.821918            -1.7808                   -0.82192                  -0.82192                          0                  0.13699                   -1.7808                 -0.82192                  -0.82192                        0                  0.13699                    -1.7808                   -0.82192                    -0.82192                          0                    0.13699       
    a22=0                   -0.82192                          0                         0                    0.13699                   1.0959                  -0.82192                        0                         0                  0.13699                   1.0959                   -0.82192                          0                           0                    0.13699                     1.0959       
    a23=0.136986                   0                          0                   0.13699                    0.13699                   1.0959                         0                        0                   0.13699                  0.13699                   1.0959                          0                          0                     0.13699                    0.13699                     1.0959       
    a24=1.09589              0.13699                    0.13699                    1.0959                     1.0959                   2.0548                   0.13699                  0.13699                    1.0959                   1.0959                   2.0548                    0.13699                    0.13699                      1.0959                     1.0959                     2.0548       
    a25=2.05479               1.0959                     1.0959                    2.0548                     2.0548                   3.0137                    1.0959                   1.0959                    2.0548                   2.0548                   3.0137                     1.0959                     1.0959                      2.0548                     2.0548                     3.0137       
    a26=3.0137                2.0548                     2.0548                    3.0137                     3.0137                   3.9726                    2.0548                   2.0548                    3.0137                   3.0137                   3.9726                     2.0548                     2.0548                      3.0137                     3.0137                     3.9726       
    a27=3.9726                3.0137                     3.0137                    3.0137                     3.9726                   4.9315                    3.0137                   3.0137                    3.0137                   3.9726                   4.9315                     3.0137                     3.0137                      3.0137                     3.9726                     4.9315       
    a28=4.93151               3.9726                     3.9726                    3.9726                     4.9315                   5.8904                    3.9726                   3.9726                    3.9726                   4.9315                   5.8904                     3.9726                     3.9726                      3.9726                     4.9315                     5.8904       
    a29=5.89041               4.9315                     4.9315                    4.9315                     5.8904                   6.8493                    4.9315                   4.9315                    4.9315                   5.8904                   6.8493                     4.9315                     4.9315                      4.9315                     5.8904                     6.8493       
    a30=6.84932               5.8904                     5.8904                    5.8904                     6.8493                   7.8082                    5.8904                   5.8904                    5.8904                   6.8493                   7.8082                     5.8904                     5.8904                      5.8904                     6.8493                     7.8082       
    a31=7.80822               6.8493                     6.8493                    6.8493                     7.8082                   8.7671                    6.8493                   6.8493                    6.8493                   7.8082                   8.7671                     6.8493                     6.8493                      6.8493                     7.8082                     8.7671       
    a32=8.76712               7.8082                     7.8082                    7.8082                     8.7671                    9.726                    7.8082                   7.8082                    7.8082                   8.7671                    9.726                     7.8082                     7.8082                      7.8082                     8.7671                      9.726       
    a33=9.72603               8.7671                     8.7671                    8.7671                      9.726                   10.685                    8.7671                   8.7671                    8.7671                    9.726                   10.685                     8.7671                     8.7671                      8.7671                      9.726                     10.685       
    a34=10.6849                9.726                      9.726                     9.726                     10.685                   11.644                     9.726                    9.726                     9.726                   10.685                   11.644                      9.726                      9.726                       9.726                     10.685                     11.644       
    a35=11.6438               10.685                     10.685                    10.685                     11.644                   12.603                    10.685                   10.685                    10.685                   11.644                   12.603                     10.685                     10.685                      10.685                     11.644                     12.603       
    a36=12.6027               11.644                     11.644                    11.644                     12.603                   13.562                    11.644                   11.644                    11.644                   12.603                   13.562                     11.644                     11.644                      11.644                     12.603                     13.562       
    a37=13.5616               12.603                     12.603                    12.603                     13.562                   14.521                    12.603                   12.603                    12.603                   13.562                   14.521                     12.603                     12.603                      12.603                     13.562                     14.521       
    a38=14.5205               13.562                     13.562                    13.562                     14.521                   15.479                    13.562                   13.562                    13.562                   14.521                   15.479                     13.562                     13.562                      13.562                     14.521                     15.479       
    a39=15.4795               13.562                     14.521                    14.521                     15.479                   16.438                    13.562                   14.521                    14.521                   15.479                   16.438                     13.562                     14.521                      14.521                     15.479                     16.438       
    a40=16.4384               14.521                     15.479                    15.479                     16.438                   17.397                    14.521                   15.479                    15.479                   16.438                   17.397                     14.521                     15.479                      15.479                     16.438                     17.397       
    a41=17.3973               15.479                     16.438                    16.438                     17.397                   18.356                    15.479                   16.438                    16.438                   17.397                   18.356                     15.479                     16.438                      16.438                     17.397                     18.356       
    a42=18.3562               16.438                     17.397                    17.397                     17.397                   19.315                    16.438                   17.397                    17.397                   17.397                   19.315                     16.438                     17.397                      17.397                     17.397                     19.315       
    a43=19.3151               17.397                     18.356                    18.356                     18.356                   20.274                    17.397                   18.356                    18.356                   18.356                   20.274                     17.397                     18.356                      18.356                     18.356                     20.274       
    a44=20.274                18.356                     18.356                    19.315                     19.315                   21.233                    18.356                   18.356                    19.315                   19.315                   21.233                     18.356                     18.356                      19.315                     19.315                     21.233       
    a45=21.2329               19.315                     19.315                    20.274                     20.274                   21.233                    19.315                   19.315                    20.274                   20.274                   21.233                     19.315                     19.315                      20.274                     20.274                     21.233       
    a46=22.1918               20.274                     20.274                    21.233                     21.233                   22.192                    20.274                   20.274                    21.233                   21.233                   22.192                     20.274                     20.274                      21.233                     21.233                     22.192       
    a47=23.1507               21.233                     21.233                    22.192                     22.192                   23.151                    21.233                   21.233                    22.192                   22.192                   23.151                     21.233                     21.233                      22.192                     22.192                     23.151       
    a48=24.1096               22.192                     22.192                    23.151                     23.151                    24.11                    22.192                   22.192                    23.151                   23.151                    24.11                     22.192                     22.192                      23.151                     23.151                      24.11       
    a49=25.0685               23.151                     23.151                     24.11                      24.11                   25.068                    23.151                   23.151                     24.11                    24.11                   25.068                     23.151                     23.151                       24.11                      24.11                     25.068       
    a50=26.0274                24.11                      24.11                    25.068                     25.068                   26.027                     24.11                    24.11                    25.068                   25.068                   26.027                      24.11                      24.11                      25.068                     25.068                     26.027       
    a51=26.9863               25.068                     25.068                    26.027                     26.027                   26.986                    25.068                   25.068                    26.027                   26.027                   26.986                     25.068                     25.068                      26.027                     26.027                     26.986       
    a52=27.9452               26.027                     26.027                    26.986                     26.986                   27.945                    26.027                   26.027                    26.986                   26.986                   27.945                     26.027                     26.027                      26.986                     26.986                     27.945       
    a53=28.9041               26.986                     26.986                    26.986                     27.945                   28.904                    26.986                   26.986                    26.986                   27.945                   28.904                     26.986                     26.986                      26.986                     27.945                     28.904       
    a54=29.863                27.945                     27.945                    27.945                     28.904                   29.863                    27.945                   27.945                    27.945                   28.904                   29.863                     27.945                     27.945                      27.945                     28.904                     29.863       
    a55=30.8219               28.904                     28.904                    28.904                     29.863                   30.822                    28.904                   28.904                    28.904                   29.863                   30.822                     28.904                     28.904                      28.904                     29.863                     30.822       
    a56=31.7808               29.863                     29.863                    29.863                     30.822                   31.781                    29.863                   29.863                    29.863                   30.822                   31.781                     29.863                     29.863                      29.863                     30.822                     31.781       
    a57=32.7397               30.822                     30.822                    30.822                     31.781                    32.74                    30.822                   30.822                    30.822                   31.781                    32.74                     30.822                     30.822                      30.822                     31.781                      32.74       
    a58=33.6986               31.781                     31.781                    31.781                      32.74                   33.699                    31.781                   31.781                    31.781                    32.74                   33.699                     31.781                     31.781                      31.781                      32.74                     33.699       
    a59=34.6575                32.74                      32.74                     32.74                     33.699                   34.658                     32.74                    32.74                     32.74                   33.699                   34.658                      32.74                      32.74                       32.74                     33.699                     34.658       
    a60=35.6164               33.699                     33.699                    33.699                     34.658                   35.616                    33.699                   33.699                    33.699                   34.658                   35.616                     33.699                     33.699                      33.699                     34.658                     35.616       
    a61=36.5753               34.658                     34.658                    34.658                     35.616                   36.575                    34.658                   34.658                    34.658                   35.616                   36.575                     34.658                     34.658                      34.658                     35.616                     36.575       
    a62=37.5342               35.616                     35.616                    35.616                     36.575                   37.534                    35.616                   35.616                    35.616                   36.575                   37.534                     35.616                     35.616                      35.616                     36.575                     37.534       
    a63=38.4932               36.575                     36.575                    36.575                     37.534                   38.493                    36.575                   36.575                    36.575                   37.534                   38.493                     36.575                     36.575                      36.575                     37.534                     38.493       
    a64=39.4521               37.534                     37.534                    37.534                     38.493                   39.452                    37.534                   37.534                    37.534                   38.493                   39.452                     37.534                     37.534                      37.534                     38.493                     39.452       
    a65=40.411                38.493                     38.493                    38.493                     39.452                   40.411                    38.493                   38.493                    38.493                   39.452                   40.411                     38.493                     38.493                      38.493                     39.452                     40.411       
    a66=41.3699               39.452                     39.452                    39.452                     40.411                    41.37                    39.452                   39.452                    39.452                   40.411                    41.37                     39.452                     39.452                      39.452                     40.411                      41.37       
    a67=42.3288               40.411                     40.411                    40.411                      41.37                   42.329                    40.411                   40.411                    40.411                    41.37                   42.329                     40.411                     40.411                      40.411                      41.37                     42.329       
    a68=43.2877                41.37                      41.37                     41.37                     42.329                   43.288                     41.37                    41.37                     41.37                   42.329                   43.288                      41.37                      41.37                       41.37                     42.329                     43.288       
    a69=44.2466                41.37                     42.329                    42.329                     43.288                   44.247                     41.37                   42.329                    42.329                   43.288                   44.247                      41.37                     42.329                      42.329                     43.288                     44.247       
    a70=45.2055               42.329                     43.288                    43.288                     44.247                   45.205                    42.329                   43.288                    43.288                   44.247                   45.205                     42.329                     43.288                      43.288                     44.247                     45.205       
    a71=46.1644               43.288                     44.247                    44.247                     45.205                   46.164                    43.288                   44.247                    44.247                   45.205                   46.164                     43.288                     44.247                      44.247                     45.205                     46.164       
    a72=47.1233               44.247                     45.205                    45.205                     46.164                   47.123                    44.247                   45.205                    45.205                   46.164                   47.123                     44.247                     45.205                      45.205                     46.164                     47.123       
    a73=48.0822               45.205                     46.164                    46.164                     46.164                   48.082                    45.205                   46.164                    46.164                   46.164                   48.082                     45.205                     46.164                      46.164                     46.164                     48.082       
    a74=49.0411               46.164                     47.123                    47.123                     47.123                   49.041                    46.164                   47.123                    47.123                   47.123                   49.041                     46.164                     47.123                      47.123                     47.123                     49.041       
    a75=50                    47.123                     47.123                    48.082                     48.082                       50                    47.123                   47.123                    48.082                   48.082                       50                     47.123                     47.123                      48.082                     48.082                         50       

</pre><img vspace="5" hspace="5" src="ff_abz_vf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_02.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_03.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_04.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_08.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_09.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_10.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_11.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_12.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Solve Save + Borr Dynamic Programming Problem (Loop)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_abz_vf(varargin)
%% FF_ABZ_VF solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic single asset and single
% shock problem with loops. This file contains codes that processes
% borrowing.
%
% The borrowing problem is very similar to the savings problem. The code
% could be identical if one does not have to deal with default. The main
% addition here in comparison to the savings only code
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html
% ff_az_vf> is the ability to deal with default. 
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
%    % Get Default Parameters
%    it_param_set = 2;
%    [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
%    % Chnage param_map keys for borrowing
%    param_map('fl_b_bd') = -20; % borrow bound
%    param_map('bl_default') = false; % true if allow for default
%    param_map('fl_c_min') = 0.0001; % u(c_min) when default
%    % Change Keys in param_map
%    param_map('it_a_n') = 500;
%    param_map('fl_z_r_borr_n') = 5;
%    param_map('it_z_wage_n') = 15;
%    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
%    param_map('fl_a_max') = 100;
%    param_map('fl_w') = 1.3;
%    % Change Keys support_map
%    support_map('bl_display') = false;
%    support_map('bl_post') = true;
%    support_map('bl_display_final') = false;
%    % Call Program with external parameters that override defaults.
%    ff_abz_vf(param_map, support_map);
%
% @include
%
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html ffs_abz_set_default_param>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html ffs_abz_get_funcgrid>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html ff_az_vf_post>
%
% @seealso
%
% * save loop: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html ff_az_vf>
% * save vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html ff_az_vf_vec>
% * save optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html ff_az_vf_vecsv>
% * save + borr loop: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html ff_abz_vf>
% * save + borr vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html ff_abz_vf_vec>
% * save + borr optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html ff_abz_vf_vecsv>
%

%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% Note: param_map and support_map can be adjusted here or outside to override defaults
param_map('it_a_n') = 75;
param_map('fl_z_r_borr_n') = 3;
param_map('it_z_wage_n') = 5;
param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
% param_map('fl_r_save') = 0.025;
% param_map('fl_r_borr') = 0.035;

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_abz_vf';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_a', 'mt_z_trans', 'ar_z_r_borr_mesh_wage', 'ar_z_wage_mesh_r_borr'});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons_checkcmin', 'f_coh', 'f_cons_coh'});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

% param_map
params_group = values(param_map, {'it_a_n', 'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min',...
    'fl_nan_replace', 'bl_default', 'fl_default_aprime'});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, ...
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_a),it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a),it_z_n);
mt_pol_a_cur = mt_pol_a - 1;

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Utility at-Default/at-limiting-case-when-nodefault
if (fl_crra == 1)
    fl_u_cmin = f_util_log(fl_c_min);
else
    fl_u_cmin = f_util_crra(fl_c_min);
end


% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Iterate over a and z states
    % Solve Problem if Default: coh < borr_bound, then: u(c_min) + EV(a'=0,z')
    % these are the values for defaulter
    % if do not borrow enough to pay debt: a'=0
    % if save more than what you have: a'=0
    % if borrowing, possible that all ar_val_cur values are
    % u(cmin), when that is the case, utility equal to
    % c_min, this means given current choice set, can only default,
    % get utility at c_min level, and a' go to 0. See
    % maximization over loop 3 choices for loop 1+2 states. see
    % <https://fanwangecon.github.io/CodeDynaAsset/docs/README_cminymin_borrsave.html
    % README_cminymin_borrsave> for additional discussions.
    %
    % when default is not allowed, there should be exactly one
    % element of the state space where we enter this condition.
    % That is at a_min and z_min. At this point, the natural
    % borrowing constraint when fully used up leads to c = 0.
    % When default is not allowed, this is the limiting case.
    % We solve the limiting case as if default is possible. see
    % the figure here:
    % <https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html
    % ffs_abz_get_funcgrid_nodefault>. For the figure under
    % section *Generate Borrowing A Grid with Default*, there are
    % no points to the lower right of the red horizontal and
    % verticle lines, because no default is allowed. But the
    % intersection of the two red lines is this limiting case
    % where c = 0.
    %
    % when default is allowed. See again
    % <https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html
    % ffs_abz_get_funcgrid_nodefault>. Again under section
    % *Generate Borrowing A Grid with Default*, see that there
    % is an area to the right bottom of the two blue horizontal
    % and vertical lines. For all points in that area, the
    % household has to default, they can not borrow even at max
    % to get positive consumption. At other points higher than
    % the blue horizontal line, it is also possible for
    % defaulting to be the optimal choice.

    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n
        
        % Current Shock
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        % loop 2: over endogenous states
        for it_a_j = 1:length(ar_a)
            fl_a = ar_a(it_a_j);
            ar_val_cur = zeros(size(ar_a));

            % calculate cash on hand
            fl_coh = f_coh(fl_z_r_borr, fl_z_wage, fl_a);
            
            % loop 3: over choices
            for it_ap_k = 1:length(ar_a)

                % get next period asset choice
                fl_ap = ar_a(it_ap_k);

                % calculate consumption
                fl_c = f_cons_coh(fl_coh, fl_ap);

                % assign u(c)
                if (fl_c <= fl_c_min)
                    if (bl_default)
                        % defaults
                        % current utility: only today u(cmin)
                        ar_val_cur(it_ap_k) = fl_u_cmin;
                        % transition out next period, debt wiped out
                        for it_az_q = 1:it_z_n
                            ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + ...
                                fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur((ar_a == fl_default_aprime), it_az_q);
                        end
                    else
                        % if default is not allowed: v = fl_nan_replace
                        ar_val_cur(it_ap_k) = fl_nan_replace;
                    end
                else
                    % Solve Optimization Problem: max_{a'} u(c(a,a',z)) + beta*EV(a',z')
                    % borrowed enough to pay debt (and borrowing limit not exceeded)
                    % saved only the coh available.
                    % current utility
                    if (fl_crra == 1)
                        ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    else
                        ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    end
                    % loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
                    for it_az_q = 1:it_z_n
                        ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + ...
                            fl_beta*mt_z_trans(it_z_i, it_az_q)*mt_val_cur(it_ap_k, it_az_q);
                    end
                end
            end

            % optimal choice value
            [fl_opti_val_z, fl_opti_idx_z] = max(ar_val_cur);
            fl_opti_aprime_z = ar_a(fl_opti_idx_z);
            fl_opti_c_z = f_cons_coh(fl_coh, fl_opti_aprime_z);

            % Handle Default is optimal or not
            if (fl_opti_c_z <= fl_c_min)
                if (bl_default)
                    % if defaulting is optimal choice, at these states, not required
                    % to default, non-default possible, but default could be optimal
                    fl_opti_aprime_z = fl_default_aprime;
                else
                    % if default is not allowed, then next period same state as now
                    % this is absorbing state, this is the limiting case, single
                    % state space point, lowest a and lowest shock has this.
                    fl_opti_aprime_z = fl_a;
                end
            end

            %% Store Optimal Choices and Value Given(a,z)
            mt_val(it_a_j,it_z_i) = fl_opti_val_z;
            mt_pol_a(it_a_j,it_z_i) = fl_opti_aprime_z;

        end
    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); ...
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'Hval', 'Hap'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('Hval = mt_val_cur(it_a_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_a_n,:), highest a state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;

result_map('cl_mt_coh') = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_pol_c') = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map('ar_st_pol_names') = ["cl_mt_pol_a", "cl_mt_coh", "cl_mt_pol_c"];

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>