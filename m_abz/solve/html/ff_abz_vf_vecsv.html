
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-14"><meta name="DC.source" content="ff_abz_vf_vecsv.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Iterate Value Function</a></li><li><a href="#10">Solve Optimization Problem Current Iteration</a></li><li><a href="#11">Check Tolerance and Continuation</a></li><li><a href="#13">Process Optimal Choices</a></li><li><a href="#14">Display Various Containers</a></li><li><a href="#16">Display 1 support_map</a></li><li><a href="#17">Display 2 armt_map</a></li><li><a href="#18">Display 3 param_map</a></li><li><a href="#19">Display 4 func_map</a></li><li><a href="#20">Display 5 result_map</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_abz_vf_vecsv(varargin)
</pre><h2 id="2">FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic single asset and two shocks problem with vectorized codes. <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html">ff_abz_vf</a> shows looped codes. <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_abz_vf_vec</a> shows vectorized codes. This file shows vectorized codes that is faster but is more memory intensive.</p><p>The borrowing problem is similar to the savings problem. The main addition here in comparison to the savings only code <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html">ff_az_vf_vec</a> is the ability to deal with default, as well as an additional shock to the borrowing interest rate.</p><p>See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_az_vf_vec</a> how vectorization works within this structure.</p><p>This <i>optimized-vectorized</i> solution method provides very large speed improvements for this infinite horizon problem because the u(c(z,a,a')) calculation within each iteration is identical. Generally the idea is to identify inside iteration whether the model is infinite horizon or life-cycle based where repeat calculations are taking place. If such calculations can be identified, then potentially they could be stored and retrieved during future iterations/periods rather than recomputed every time. This saves time.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><pre>  % Get Default Parameters
  it_param_set = 2;
  [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
  % Chnage param_map keys for borrowing
  param_map('fl_b_bd') = -20; % borrow bound
  param_map('bl_default') = false; % true if allow for default
  param_map('fl_c_min') = 0.0001; % u(c_min) when default
  % Change Keys in param_map
  param_map('it_a_n') = 500;
  param_map('fl_z_r_borr_n') = 5;
  param_map('it_z_wage_n') = 15;
  param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
  param_map('fl_a_max') = 100;
  param_map('fl_w') = 1.3;
  % Change Keys support_map
  support_map('bl_display') = false;
  support_map('bl_post') = true;
  support_map('bl_display_final') = false;
  % Call Program with external parameters that override defaults.
  ff_abz_vf_vecsv(param_map, support_map);</pre><p>@include</p><div><ul><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html">ffs_abz_set_default_param</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html">ffs_abz_get_funcgrid</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html">ff_az_vf_post</a></li></ul></div><p>@seealso</p><div><ul><li>save loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html">ff_az_vf</a></li><li>save vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html">ff_az_vf_vec</a></li><li>save optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html">ff_az_vf_vecsv</a></li><li>save + borr loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html">ff_abz_vf</a></li><li>save + borr vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_abz_vf_vec</a></li><li>save + borr optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html">ff_abz_vf_vecsv</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% Note: param_map and support_map can be adjusted here or outside to override defaults</span>
<span class="comment">% param_map('it_a_n') = 750;</span>
<span class="comment">% param_map('fl_z_r_borr_n') = 5;</span>
<span class="comment">% param_map('it_z_wage_n') = 15;</span>
<span class="comment">% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');</span>
<span class="comment">% param_map('fl_r_save') = 0.025;</span>
<span class="comment">% param_map('fl_z_r_borr_poiss_mean') = 1.75;</span>

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_abz_vf_vecsv'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'mt_z_trans'</span>, <span class="string">'ar_z_r_borr_mesh_wage'</span>, <span class="string">'ar_z_wage_mesh_r_borr'</span>});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons_checkcmin'</span>, <span class="string">'f_coh'</span>, <span class="string">'f_cons_coh'</span>});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'it_a_n'</span>, <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>,<span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_aprime'</span>});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, <span class="keyword">...</span>
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display_defparam'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><p>include mt_pol_idx which we did not have in looped code</p><pre class="codeinput">mt_val_cur = zeros(it_a_n, it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n, it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_idx = zeros(it_a_n, it_z_n);

<span class="comment">% We did not need these in ff_abz_vf or ff_abz_vf_vec</span>
<span class="comment">% see</span>
<span class="comment">% &lt;https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html</span>
<span class="comment">% fs_u_c_partrepeat_main&gt; for why store using cells.</span>
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="10">Solve Optimization Problem Current Iteration</h2><p>Only this segment of code differs between ff_abz_vf and ff_abz_vf_vec Store in cells results and retrieve, this is more memory intensive than ff_abz_vf_vec.</p><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n

        <span class="comment">% Current Shock</span>
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        <span class="comment">% cash-on-hand</span>
        ar_coh = f_coh(fl_z_r_borr, fl_z_wage, ar_a);

        <span class="comment">% Consumption and u(c) only need to be evaluated once</span>
        <span class="keyword">if</span> (it_iter == 1)

            <span class="comment">% Consumption: fl_z = 1 by 1, ar_a = 1 by N, ar_a' = N by 1</span>
            <span class="comment">% mt_c is N by N: matrix broadcasting, expand to matrix from arrays</span>
            mt_c = f_cons_coh(ar_coh, ar_a');

            <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
            <span class="comment">% slightly faster to explicitly write function</span>
            <span class="keyword">if</span> (fl_crra == 1)
                mt_utility = log(mt_c);
                fl_u_cmin = f_util_log(fl_c_min);
            <span class="keyword">else</span>
                <span class="comment">% slightly faster if write function here directly, but</span>
                <span class="comment">% speed gain is very small, more important to have single</span>
                <span class="comment">% location control of functions.</span>
                mt_utility = f_util_crra(mt_c);
                fl_u_cmin = f_util_crra(fl_c_min);
            <span class="keyword">end</span>

            <span class="comment">% Eliminate Complex Numbers</span>
            mt_it_c_valid_idx = (mt_c &lt;= fl_c_min);
            mt_utility(mt_it_c_valid_idx) = fl_u_cmin;

            <span class="comment">% Store in cells</span>
            cl_u_c_store{it_z_i} = mt_utility;
            cl_c_valid_idx{it_z_i} = mt_it_c_valid_idx;

        <span class="keyword">end</span>

        <span class="comment">% f(z'|z)</span>
        ar_z_trans_condi = mt_z_trans(it_z_i,:);

        <span class="comment">% EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1</span>
        <span class="comment">% Note: transpose ar_z_trans_condi from 1 by Z to Z by 1</span>
        <span class="comment">% Note: matrix multiply not dot multiply</span>
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';

        <span class="comment">% EVAL add on future utility, N by N + N by 1</span>
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_evzp_condi_z;

        <span class="comment">% Index update</span>
        <span class="comment">% using the method below is much faster than index replace</span>
        <span class="comment">% see &lt;https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript&gt;</span>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        <span class="comment">% Default or Not Utility Handling</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if default: only today u(cmin), transition out next period, debt wiped out</span>
            fl_v_default = fl_u_cmin + fl_beta*mt_evzp_condi_z(ar_a == fl_default_aprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed: v = u(cmin)</span>
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        <span class="keyword">end</span>

        <span class="comment">% Optimization: remember matlab is column major, rows must be</span>
        <span class="comment">% choices, columns must be states</span>
        <span class="comment">% &lt;https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR&gt;</span>
        <span class="comment">% mt_utility is N by N, rows are choices, cols are states.</span>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);
        ar_opti_aprime_z = ar_a(ar_opti_idx_z);
        ar_opti_c_z = f_cons_coh(ar_coh, ar_opti_aprime_z);

        <span class="comment">% Handle Default is optimal or not</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
            <span class="comment">% to default, non-default possible, but default could be optimal</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_aprime;
            ar_opti_idx_z(ar_opti_c_z &lt;= fl_c_min) = find(ar_a == fl_default_aprime);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed, then next period same state as now</span>
            <span class="comment">% this is absorbing state, this is the limiting case, single</span>
            <span class="comment">% state space point, lowest a and lowest shock has this.</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = ar_a(ar_opti_c_z &lt;= fl_c_min);
        <span class="keyword">end</span>

        <span class="comment">% store optimal values</span>
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;

        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="11">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_a_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_a_n,:), highest a state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 15.220368 seconds.
</pre><h2 id="13">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_idx'</span>) = mt_pol_idx;

result_map(<span class="string">'cl_mt_coh'</span>) = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_pol_c'</span>) = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_coh"</span>, <span class="string">"cl_mt_pol_c"</span>];

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n): percentage of state space points conditional on shock where the policy function is changing across iterations
                 valgap      polgap     zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                _________    _______    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    iter=1         862.64     4490.5                  1                          1                          1                         1                         1                          1                          1                          1                           1                           1                         1                          1                          1                           1                         1                          1       
    iter=2         445.58     4810.5              0.996                    0.99867                    0.99867                         1                         1                          1                          1                          1                       0.988                     0.99067                   0.99333                      0.996                          1                           1                         1                          1       
    iter=3         349.76     1612.6            0.99333                    0.98267                    0.98533                   0.98533                     0.988                    0.98933                    0.99333                    0.99733                     0.98133                     0.98133                   0.98667                    0.98933                    0.99733                     0.99867                         1                          1       
    iter=4         285.55     806.65            0.98667                    0.97733                    0.97867                   0.98267                   0.98133                      0.984                    0.98667                    0.99067                     0.97333                       0.976                   0.98267                    0.98667                    0.98933                     0.99467                   0.99867                          1       
    iter=5         239.77     480.36            0.97867                    0.97067                    0.97467                   0.97333                   0.97467                    0.97467                       0.98                    0.98267                     0.96667                       0.972                   0.97467                    0.98133                    0.98667                     0.99333                   0.99867                          1       
    iter=6         205.46     320.94            0.96667                    0.96133                    0.96133                   0.96533                   0.96667                    0.96933                    0.97333                      0.976                     0.96533                     0.96267                   0.96933                      0.976                    0.98133                     0.98933                   0.99467                    0.99867       
    iter=7         178.71     229.91            0.95067                      0.952                    0.95733                   0.95867                     0.956                    0.95867                      0.964                      0.968                     0.95733                     0.95867                     0.964                    0.96933                    0.97733                       0.984                   0.99067                    0.99733       
    iter=8         157.23     170.23            0.93867                       0.94                    0.94667                     0.948                   0.95333                    0.95067                    0.95333                    0.95867                       0.948                     0.94667                     0.956                    0.96267                    0.96933                     0.97867                   0.98667                      0.992       
    iter=9         139.59        132              0.928                    0.93067                      0.932                   0.94667                     0.952                    0.93867                    0.94267                      0.948                     0.93867                        0.94                     0.948                      0.956                    0.96133                     0.97067                   0.98133                    0.99067       
    iter=10        124.79     105.44            0.91067                    0.91867                      0.924                   0.91867                   0.92267                    0.93333                      0.932                    0.93867                     0.92533                     0.92533                   0.93733                    0.94533                      0.952                     0.96133                   0.97333                    0.98133       
    iter=11        112.19     85.765            0.89867                      0.904                    0.91733                   0.90667                   0.90933                      0.936                    0.92133                      0.928                     0.91467                       0.916                   0.92533                    0.93467                    0.94133                       0.952                   0.96133                    0.97067       
    iter=12        101.36     70.522              0.884                      0.884                      0.884                   0.89067                     0.892                    0.89867                    0.90267                    0.91867                     0.89733                     0.90133                     0.912                       0.92                      0.928                     0.94133                     0.952                       0.96       
    iter=13        91.962     59.348               0.86                      0.868                    0.86933                     0.868                     0.876                       0.88                    0.88533                    0.89067                     0.88267                     0.88267                     0.896                    0.90267                    0.91067                       0.928                   0.93733                    0.95067       
    iter=14        83.723     50.643            0.84133                    0.85067                    0.84667                   0.85333                   0.85733                    0.86133                    0.87067                    0.88133                     0.86133                     0.88933                   0.87733                    0.88533                      0.896                       0.908                   0.91867                    0.93467       
    iter=15        76.463     43.285            0.81733                    0.83467                       0.82                     0.828                   0.83867                    0.83867                    0.84933                    0.85067                        0.84                       0.856                     0.856                    0.86667                    0.87467                       0.892                       0.9                    0.92133       
    iter=16        70.032     37.422            0.79067                    0.79467                    0.80667                     0.804                     0.804                    0.81467                    0.82667                      0.828                     0.82133                     0.83467                   0.83067                      0.844                    0.85333                     0.86533                      0.88                    0.89733       
    iter=17        64.302     32.735            0.76133                    0.76133                    0.76267                     0.776                      0.78                    0.78267                        0.8                    0.80667                     0.80667                     0.80667                   0.81467                    0.81867                    0.85067                     0.83733                     0.852                    0.86933       
    iter=18         59.17     28.774            0.73333                    0.73867                    0.74267                   0.74667                     0.748                    0.75733                    0.76533                    0.76933                     0.77067                     0.76267                   0.80667                      0.796                    0.82267                       0.792                   0.80933                    0.84133       
    iter=19        54.559      25.32            0.69867                    0.70267                      0.704                   0.71333                   0.71867                      0.724                    0.73733                      0.732                     0.75467                     0.74533                   0.75867                    0.75733                       0.76                       0.784                   0.79467                       0.82       
    iter=20        50.406     22.549              0.668                       0.66                    0.67467                   0.67067                   0.68533                    0.68667                    0.70533                      0.708                       0.672                     0.69867                   0.71467                      0.764                    0.73733                     0.78133                   0.81867                    0.74933       
    iter=21        46.652     20.117              0.628                    0.63467                    0.63067                     0.648                   0.63867                    0.65333                      0.656                    0.67067                        0.72                     0.67733                     0.668                      0.656                    0.68533                       0.704                   0.70933                      0.792       
    iter=22        43.252     17.974            0.59067                       0.58                    0.59867                   0.59067                   0.61067                      0.616                    0.62133                    0.63067                     0.58133                     0.57867                   0.67867                    0.72933                    0.70133                       0.656                      0.66                    0.64533       
    iter=23        40.161     16.157            0.54533                      0.548                      0.552                     0.568                   0.56267                    0.56533                    0.57733                      0.584                        0.54                     0.74267                   0.55067                    0.55867                      0.568                       0.724                   0.73467                      0.624       
    iter=24        37.347      14.62            0.50667                    0.50667                    0.50267                   0.51467                   0.52133                      0.524                    0.54133                      0.548                     0.55733                     0.50667                   0.55467                    0.52533                      0.588                       0.544                   0.56267                    0.77467       
    iter=25        34.777     13.284            0.45733                      0.448                    0.46667                   0.46667                   0.47067                      0.484                    0.49067                    0.49733                     0.54933                     0.46933                   0.55067                    0.56133                    0.61867                     0.53067                     0.552                    0.54267       
    iter=26        32.423     12.122            0.39867                    0.41867                    0.41467                   0.42667                   0.42933                      0.432                    0.43467                    0.44933                       0.432                       0.456                   0.49067                    0.50667                    0.46933                        0.52                   0.53733                    0.49067       
    iter=27        30.267     11.146            0.36267                    0.37467                    0.37067                   0.38267                   0.38933                    0.39467                      0.404                      0.408                     0.38667                     0.42133                   0.39467                      0.428                    0.42933                       0.468                   0.48267                      0.504       
    iter=28        28.285     10.405              0.344                    0.32667                    0.35067                   0.34933                   0.35867                    0.36133                      0.364                    0.37467                        0.38                       0.384                   0.40133                        0.4                    0.41333                     0.41467                   0.42133                    0.45467       
    iter=29        26.463     9.6392            0.30267                    0.30933                    0.31333                   0.31333                   0.32533                    0.32933                    0.33333                    0.34133                        0.34                     0.33733                     0.352                      0.368                    0.36533                     0.38267                   0.39733                    0.39867       
    iter=30        24.783     8.9037            0.27733                    0.28133                    0.28267                   0.30133                   0.28533                      0.296                      0.296                      0.304                         0.3                     0.31467                      0.32                    0.32267                      0.336                        0.36                   0.37867                    0.35733       
    iter=31        23.232     8.2048            0.24933                       0.26                    0.26133                   0.26267                     0.276                    0.26533                    0.27867                    0.28267                     0.27867                     0.29067                      0.28                      0.296                    0.30133                       0.316                   0.31733                    0.34267       
    iter=32        21.799     20.041              0.228                    0.23333                    0.23733                   0.24533                   0.24267                    0.25067                    0.24933                       0.26                       0.252                       0.268                   0.27067                    0.26933                    0.27333                       0.284                     0.296                    0.32667       
    iter=33        20.472     6.9241            0.21333                      0.212                      0.216                      0.22                     0.232                    0.23333                    0.23733                      0.236                     0.23867                     0.23867                     0.248                    0.24667                    0.27733                     0.25733                   0.26933                      0.296       
    iter=34        19.241     6.3731            0.19333                    0.19867                    0.19867                   0.20933                   0.20267                    0.20267                    0.20933                    0.21867                     0.22267                     0.22133                     0.236                       0.24                    0.23733                       0.244                      0.24                      0.256       
    iter=35        18.098     5.7694              0.176                       0.18                    0.19067                   0.18933                     0.192                      0.196                    0.19867                    0.19467                     0.19733                       0.196                       0.2                      0.216                      0.224                     0.20933                   0.22267                    0.23067       
    iter=36        17.036     5.3363            0.16933                    0.15867                    0.16267                   0.17333                   0.17467                      0.176                    0.17467                    0.18267                     0.18267                     0.18267                   0.19067                    0.20133                      0.196                     0.22267                   0.23067                    0.21867       
    iter=37        16.047     4.8631            0.14133                    0.15333                    0.15333                   0.16133                   0.16133                    0.16267                    0.16667                    0.16933                     0.16667                     0.16667                   0.17467                      0.176                    0.18133                     0.19867                     0.208                    0.19067       
    iter=38        15.124     20.026               0.14                      0.136                    0.14267                     0.144                   0.14533                    0.14667                      0.144                    0.15867                     0.15867                     0.16133                   0.15733                    0.15733                    0.16667                        0.18                     0.188                      0.184       
    iter=39        14.264     4.2731            0.12533                      0.128                      0.132                   0.13733                   0.13733                    0.12933                    0.13867                      0.136                       0.132                     0.15333                   0.15333                    0.15733                    0.15067                     0.16533                     0.164                    0.16133       
    iter=40        13.459     4.0176            0.11867                    0.12533                    0.12133                     0.124                   0.12933                      0.132                    0.13067                    0.13467                     0.13333                       0.128                   0.13067                    0.13867                    0.14133                     0.14533                   0.14933                      0.164       
    iter=41        12.707     3.7707            0.10267                      0.108                    0.10533                   0.10667                   0.11333                      0.116                      0.124                    0.12133                     0.11867                     0.12667                   0.12267                      0.124                    0.13067                       0.136                   0.14133                    0.15867       
    iter=42        12.003     3.5899            0.10267                   0.098667                    0.10933                     0.096                     0.104                    0.10667                    0.10133                    0.10667                     0.10267                     0.11733                   0.11333                    0.12267                    0.12267                     0.12533                   0.12933                       0.14       
    iter=43        11.342     3.2083           0.086667                      0.092                   0.090667                  0.098667                  0.097333                   0.097333                    0.10267                    0.10667                     0.10533                         0.1                     0.108                    0.11067                      0.104                     0.11733                   0.11467                    0.13467       
    iter=44        10.722     3.0892           0.082667                   0.086667                      0.084                  0.093333                  0.094667                      0.092                      0.092                   0.097333                         0.1                    0.093333                     0.092                      0.096                    0.11867                     0.10533                   0.11467                    0.12267       
    iter=45        10.139     2.9422              0.076                   0.078667                   0.082667                  0.077333                  0.085333                   0.085333                   0.089333                   0.085333                    0.086667                    0.090667                   0.10267                      0.088                    0.10667                       0.096                       0.1                    0.10267       
    iter=46        9.5906     2.7942           0.073333                      0.072                   0.073333                  0.069333                      0.08                   0.078667                       0.08                       0.08                    0.082667                        0.08                  0.086667                   0.081333                   0.089333                       0.092                     0.092                      0.096       
    iter=47        9.0745     2.6067           0.066667                   0.062667                   0.066667                  0.069333                     0.068                   0.069333                   0.070667                      0.076                       0.076                    0.078667                  0.082667                       0.08                   0.086667                    0.085333                     0.084                   0.093333       
    iter=48        8.5884     2.4433           0.065333                   0.065333                   0.069333                  0.065333                  0.062667                   0.062667                      0.068                      0.068                    0.070667                       0.068                  0.077333                   0.086667                   0.073333                    0.073333                  0.073333                   0.078667       
    iter=49          8.13     2.3257           0.054667                   0.057333                   0.053333                     0.056                     0.064                      0.064                   0.057333                   0.061333                    0.061333                    0.065333                     0.064                   0.074667                   0.069333                    0.066667                  0.073333                      0.072       
    iter=50        7.6977     2.2429              0.048                   0.053333                   0.053333                  0.057333                  0.057333                   0.053333                   0.058667                      0.056                    0.057333                    0.057333                      0.06                   0.062667                   0.066667                    0.066667                  0.069333                   0.077333       
    iter=131     0.077565          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=132     0.073033    0.20898                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                   0.0013333                         0                          0       
    iter=133     0.068762          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=134     0.064737          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=135     0.060945          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=136     0.057372    0.20898                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                  0.0013333       
    iter=137     0.054006          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=138     0.050835          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=139     0.047848          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=140     0.045035          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=141     0.042385          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=142     0.039889    0.20898                  0                          0                  0.0013333                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=143     0.037539          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=144     0.035326          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=145     0.033242    0.20898                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                  0.0013333       
    iter=146      0.03128          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=147     0.029432          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=148     0.027693          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=149     0.026056          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=150     0.024514          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=151     0.023063          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=152     0.021698          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=153     0.020412          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=154     0.019202    0.20898                  0                          0                          0                         0                         0                          0                          0                          0                           0                   0.0013333                         0                          0                          0                           0                         0                          0       
    iter=155     0.018064          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=156     0.016992          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=157     0.015983          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=158     0.015034          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=159     0.014142          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=160     0.013301          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=161     0.012511          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=162     0.011767          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=163     0.011067          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=164     0.010408          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=165    0.0097888          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=166     0.009206          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=167    0.0086577          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=168    0.0081419          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=169    0.0076568          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=170    0.0072004          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=171    0.0067711          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=172    0.0063673          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=173    0.0059875          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=174    0.0056302          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=175    0.0052942          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=176    0.0049782          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=177     0.004681          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=178    0.0044015          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=179    0.0041386          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       
    iter=180    0.0038914          0                  0                          0                          0                         0                         0                          0                          0                          0                           0                           0                         0                          0                          0                           0                         0                          0       

tb_val: V(a,z) value at each state space point
                    zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    a1=-20                  -60.094                    -59.852                   -59.582                   -57.315                    -55.433                    -53.067                    -49.506                     -44.86                     -58.04                     -57.707                    -57.369                    -57.026                    -33.549                    -27.203                    -22.143                   -17.965        
    a2=-19.9065             -60.094                    -59.768                   -57.882                   -56.425                    -54.827                    -52.343                    -48.599                     -43.87                     -58.04                     -57.707                    -57.369                    -42.121                    -32.527                    -26.601                    -21.734                   -17.637        
    a3=-19.8131             -59.437                    -58.126                   -57.021                   -55.904                    -54.323                    -51.547                     -47.77                    -43.111                     -58.04                     -57.707                    -57.369                    -38.804                    -31.757                    -26.082                    -21.336                   -17.316        
    a4=-19.7196             -58.171                    -57.353                   -56.511                   -55.492                     -53.69                    -50.829                    -46.856                    -42.205                     -58.04                     -57.707                    -54.159                    -37.595                    -31.039                    -25.563                    -20.946                       -17        
    a5=-19.6262             -57.513                    -56.882                   -56.165                   -55.096                    -53.034                    -49.967                    -46.084                    -41.446                     -58.04                     -57.707                    -43.942                     -36.57                    -30.284                    -25.078                    -20.566                    -16.69        
    a6=-19.5327             -57.092                    -56.556                   -55.891                   -54.596                     -52.43                     -49.25                    -45.199                    -40.685                     -58.04                     -57.707                    -42.379                    -35.665                    -29.673                    -24.606                    -20.193                   -16.386        
    a7=-19.4393             -56.795                    -56.313                   -55.578                   -54.093                    -51.695                    -48.393                    -44.422                    -39.964                     -58.04                     -48.201                    -41.148                    -34.779                    -29.037                    -24.149                    -19.829                   -16.086        
    a8=-19.3458             -56.569                    -56.123                   -55.163                   -53.492                    -51.035                    -47.627                    -43.642                    -39.279                     -58.04                     -46.483                     -40.12                    -33.922                    -28.474                    -23.705                    -19.471                   -15.792        
    a9=-19.2523             -56.391                    -55.873                   -54.743                   -52.904                    -50.289                     -46.86                     -42.89                    -38.598                    -51.178                     -45.221                    -39.139                    -33.226                    -27.919                    -23.271                    -19.121                   -15.502        
    a10=-19.1589            -56.246                     -55.51                    -54.24                    -52.26                    -49.578                    -46.102                    -42.179                    -37.952                    -49.748                     -44.169                     -38.12                    -32.458                    -27.392                    -22.849                    -18.777                   -15.217        
    a11=-19.0654            -56.014                     -55.11                   -53.695                   -51.619                    -48.868                    -45.383                    -41.467                    -37.312                    -48.535                     -43.114                    -37.322                    -31.823                    -26.881                    -22.435                     -18.44                   -14.937        
    a12=-18.972             -55.635                    -54.684                   -53.129                   -50.987                    -48.152                    -44.659                    -40.792                    -36.691                    -47.575                     -42.048                    -36.406                    -31.176                    -26.384                    -22.031                    -18.108                   -14.661        
    a13=-18.8785            -55.294                    -54.177                   -52.577                    -50.33                    -47.463                    -43.967                    -40.122                    -36.087                    -46.524                     -41.181                    -35.687                    -30.581                    -25.903                    -21.636                    -17.783                   -14.389        
    a14=-18.785              -54.86                    -53.697                   -52.001                   -49.688                    -46.767                    -43.282                    -39.469                    -35.493                    -45.488                     -40.169                    -34.917                    -30.004                    -25.431                    -21.249                    -17.463                   -14.121        
    a15=-18.6916            -54.425                    -53.205                   -51.419                   -49.039                     -46.09                    -42.608                    -38.834                    -34.915                    -44.524                     -39.392                    -34.238                    -29.445                    -24.974                    -20.869                    -17.148                   -13.858        
    a16=-18.5981            -54.011                    -52.692                   -50.835                   -48.395                    -45.422                    -41.951                    -38.205                    -34.347                    -43.579                     -38.512                    -33.575                    -28.908                    -24.526                    -20.497                    -16.838                   -13.598        
    a17=-18.5047            -53.569                    -52.169                   -50.244                   -47.758                    -44.759                    -41.298                    -37.594                    -33.791                    -42.682                     -37.763                     -32.94                     -28.38                    -24.089                    -20.132                    -16.534                   -13.343        
    a18=-18.4112             -53.09                    -51.646                   -49.655                   -47.122                    -44.111                    -40.659                    -36.992                    -33.247                    -41.839                     -37.023                    -32.332                    -27.872                    -23.661                    -19.773                    -16.235                   -13.089        
    a19=-18.3178            -52.632                    -51.115                   -49.062                   -46.494                    -43.462                     -40.03                    -36.402                    -32.713                    -41.011                      -36.32                    -31.733                    -27.372                    -23.241                    -19.421                    -15.937                   -12.838        
    a20=-18.2243            -52.168                    -50.574                   -48.474                   -45.866                    -42.822                     -39.41                    -35.824                    -32.189                    -40.222                     -35.651                    -31.161                    -26.887                    -22.831                    -19.075                    -15.644                   -12.592        
    a21=-18.1308            -51.677                    -50.036                   -47.884                   -45.238                     -42.19                    -38.802                    -35.256                    -31.675                    -39.475                      -34.99                    -30.597                    -26.407                    -22.428                    -18.735                    -15.356                   -12.349        
    a22=-18.0374             -51.19                    -49.497                   -47.289                   -44.615                    -41.563                    -38.203                    -34.698                    -31.169                    -38.735                     -34.361                    -30.053                    -25.936                    -22.033                    -18.401                    -15.072                    -12.11        
    a23=-17.9439            -50.703                    -48.949                   -46.692                   -43.994                    -40.945                    -37.614                     -34.15                    -30.673                    -38.035                      -33.74                    -29.521                    -25.476                    -21.645                    -18.072                    -14.793                   -11.874        
    a24=-17.8505             -50.21                    -48.392                   -46.094                   -43.376                    -40.336                    -37.034                    -33.612                    -30.185                    -37.343                     -33.141                    -29.001                    -25.025                    -21.264                    -17.749                    -14.518                   -11.642        
    a25=-17.757             -49.695                    -47.831                   -45.495                   -42.765                    -39.734                    -36.463                    -33.083                    -29.702                    -36.675                     -32.557                    -28.493                    -24.584                    -20.891                    -17.431                    -14.248                   -11.413        
    a26=-17.6636            -49.166                    -47.265                   -44.897                   -42.158                     -39.14                    -35.901                    -32.562                    -29.228                    -36.025                     -31.982                    -27.996                    -24.151                    -20.524                    -17.119                    -13.982                   -11.188        
    a27=-17.5701            -48.624                    -46.688                     -44.3                   -41.557                    -38.553                    -35.347                     -32.05                    -28.761                    -35.389                     -31.414                    -27.504                    -23.727                    -20.163                    -16.811                     -13.72                   -10.966        
    a28=-17.4766            -48.076                    -46.107                   -43.706                   -40.961                    -37.975                    -34.802                    -31.546                    -28.302                    -34.771                      -30.86                     -27.02                    -23.311                    -19.808                    -16.509                    -13.462                   -10.747        
    a29=-17.3832            -47.526                    -45.526                   -43.115                   -40.372                    -37.403                    -34.266                     -31.05                    -27.851                    -34.165                     -30.319                    -26.546                    -22.903                    -19.459                    -16.211                    -13.207                   -10.531        
    a30=-17.2897             -46.97                    -44.945                   -42.527                   -39.787                     -36.84                    -33.737                    -30.562                    -27.407                    -33.574                      -29.79                    -26.082                    -22.502                    -19.115                    -15.917                    -12.957                   -10.318        
    a31=-17.1963            -46.412                    -44.364                   -41.942                    -39.21                    -36.284                    -33.216                    -30.082                     -26.97                    -32.996                     -29.272                    -25.627                    -22.109                    -18.774                    -15.626                     -12.71                   -10.108        
    a32=-17.1028            -45.852                    -43.785                    -41.36                   -38.638                    -35.735                    -32.703                     -29.61                     -26.54                     -32.43                     -28.765                    -25.181                    -21.722                    -18.439                    -15.339                    -12.467                   -9.9008        
    a33=-17.0093            -45.291                    -43.207                    -40.78                   -38.072                    -35.194                    -32.198                    -29.145                    -26.117                    -31.876                     -28.267                    -24.743                    -21.343                    -18.109                    -15.056                    -12.228                   -9.6965        
    a34=-16.9159            -44.727                    -42.632                   -40.206                   -37.513                     -34.66                      -31.7                    -28.686                      -25.7                    -31.333                      -27.78                    -24.313                     -20.97                    -17.785                    -14.778                    -11.992                    -9.495        
    a35=-16.8224            -44.163                    -42.059                   -39.636                    -36.96                    -34.133                     -31.21                    -28.235                    -25.289                      -30.8                     -27.302                    -23.892                    -20.603                    -17.466                    -14.505                    -11.759                   -9.2963        
    a36=-16.729             -43.599                    -41.488                   -39.071                   -36.413                    -33.614                    -30.726                     -27.79                    -24.885                    -30.278                     -26.833                    -23.478                    -20.243                    -17.152                    -14.235                    -11.529                   -9.1002        
    a37=-16.6355            -43.035                     -40.92                   -38.512                   -35.873                    -33.101                    -30.249                    -27.352                    -24.487                    -29.765                     -26.373                    -23.071                    -19.889                    -16.844                     -13.97                    -11.303                   -8.9068        
    a38=-16.5421            -42.471                    -40.356                   -37.957                   -35.339                    -32.594                    -29.779                    -26.921                    -24.095                    -29.263                     -25.921                    -22.672                    -19.541                     -16.54                    -13.709                     -11.08                   -8.7159        
    a39=-16.4486             -41.91                    -39.795                   -37.408                   -34.811                    -32.095                    -29.315                    -26.495                    -23.708                    -28.769                     -25.478                     -22.28                    -19.198                    -16.242                    -13.451                     -10.86                   -8.5275        
    a40=-16.3551            -41.348                    -39.238                   -36.864                    -34.29                    -31.602                    -28.858                    -26.076                    -23.327                    -28.284                     -25.042                    -21.894                    -18.861                    -15.948                    -13.197                    -10.644                   -8.3416        
    a41=-16.2617            -40.789                    -38.684                   -36.325                   -33.774                    -31.115                    -28.407                    -25.663                    -22.952                    -27.801                     -24.614                    -21.515                    -18.529                    -15.658                    -12.947                     -10.43                   -8.1581        
    a42=-16.1682            -40.231                    -38.133                    -35.79                   -33.263                    -30.634                    -27.962                    -25.255                    -22.582                    -27.325                     -24.194                    -21.142                    -18.203                    -15.373                    -12.701                    -10.219                   -7.9771        
    a43=-16.0748            -39.675                    -37.586                    -35.26                   -32.758                    -30.159                    -27.524                    -24.854                    -22.218                    -26.857                     -23.781                    -20.776                    -17.882                    -15.092                    -12.459                    -10.011                   -7.7983        
    a44=-15.9813            -39.122                    -37.043                   -34.735                   -32.258                    -29.691                     -27.09                    -24.459                    -21.859                    -26.398                     -23.374                    -20.415                    -17.562                    -14.815                    -12.219                     -9.806                   -7.6219        
    a45=-15.8879            -38.572                    -36.505                   -34.217                   -31.765                    -29.229                    -26.662                     -24.07                    -21.506                    -25.947                     -22.975                    -20.061                    -17.247                    -14.543                    -11.984                    -9.6035                   -7.4477        
    a46=-15.7944            -38.027                    -35.973                   -33.704                   -31.279                    -28.773                     -26.24                    -23.686                    -21.157                    -25.504                     -22.582                    -19.712                    -16.937                    -14.275                    -11.751                    -9.4025                   -7.2757        
    a47=-15.7009            -37.485                    -35.445                   -33.198                   -30.798                    -28.324                    -25.825                    -23.307                    -20.813                    -25.069                     -22.192                    -19.368                    -16.632                     -14.01                    -11.522                    -9.2042                   -7.1049        
    a48=-15.6075            -36.948                    -34.923                   -32.697                   -30.324                    -27.881                    -25.415                    -22.934                    -20.475                    -24.641                     -21.806                     -19.03                    -16.332                     -13.75                    -11.297                    -9.0086                   -6.9363        
    a49=-15.514             -36.415                    -34.406                   -32.202                   -29.856                    -27.444                    -25.011                    -22.567                    -20.141                     -24.22                     -21.426                    -18.693                    -16.036                    -13.493                    -11.074                    -8.8157                   -6.7698        
    a50=-15.4206            -35.887                    -33.895                   -31.714                   -29.394                    -27.013                    -24.613                    -22.205                    -19.812                    -23.806                     -21.053                    -18.361                    -15.745                     -13.24                    -10.855                    -8.6254                   -6.6055        
    a701=45.4206             13.342                     13.395                    13.454                    13.519                     13.589                     13.664                     13.744                     13.829                     13.829                      13.921                     14.019                     14.124                     14.236                     14.354                     14.478                    14.603        
    a702=45.514              13.354                     13.406                    13.465                     13.53                       13.6                     13.675                     13.754                      13.84                      13.84                      13.931                     14.029                     14.134                     14.245                     14.364                     14.488                    14.612        
    a703=45.6075             13.365                     13.417                    13.477                    13.541                     13.611                     13.685                     13.765                      13.85                      13.85                      13.941                     14.039                     14.144                     14.255                     14.374                     14.497                    14.622        
    a704=45.7009             13.377                     13.429                    13.488                    13.552                     13.622                     13.696                     13.776                     13.861                     13.861                      13.952                     14.049                     14.154                     14.265                     14.383                     14.507                    14.631        
    a705=45.7944             13.388                      13.44                    13.499                    13.563                     13.633                     13.707                     13.786                     13.871                     13.871                      13.962                      14.06                     14.164                     14.275                     14.393                     14.516                     14.64        
    a706=45.8879             13.399                     13.451                     13.51                    13.574                     13.644                     13.718                     13.797                     13.882                     13.882                      13.973                      14.07                     14.174                     14.285                     14.403                     14.526                    14.649        
    a707=45.9813             13.411                     13.462                    13.521                    13.585                     13.655                     13.728                     13.808                     13.892                     13.892                      13.983                      14.08                     14.184                     14.295                     14.412                     14.535                    14.659        
    a708=46.0748             13.422                     13.474                    13.532                    13.596                     13.665                     13.739                     13.818                     13.903                     13.903                      13.993                      14.09                     14.194                     14.304                     14.422                     14.544                    14.668        
    a709=46.1682             13.433                     13.485                    13.543                    13.607                     13.676                      13.75                     13.829                     13.913                     13.913                      14.003                       14.1                     14.204                     14.314                     14.431                     14.554                    14.677        
    a710=46.2617             13.444                     13.496                    13.554                    13.618                     13.687                     13.761                     13.839                     13.923                     13.923                      14.014                      14.11                     14.213                     14.324                     14.441                     14.563                    14.686        
    a711=46.3551             13.456                     13.507                    13.566                    13.629                     13.698                     13.771                      13.85                     13.934                     13.934                      14.024                      14.12                     14.223                     14.334                      14.45                     14.572                    14.695        
    a712=46.4486             13.467                     13.518                    13.577                     13.64                     13.709                     13.782                      13.86                     13.944                     13.944                      14.034                      14.13                     14.233                     14.343                      14.46                     14.582                    14.704        
    a713=46.5421             13.478                     13.529                    13.588                    13.651                     13.719                     13.793                     13.871                     13.955                     13.955                      14.044                      14.14                     14.243                     14.353                      14.47                     14.591                    14.714        
    a714=46.6355             13.489                      13.54                    13.599                    13.662                      13.73                     13.803                     13.881                     13.965                     13.965                      14.055                      14.15                     14.253                     14.363                     14.479                       14.6                    14.723        
    a715=46.729                13.5                     13.552                    13.609                    13.673                     13.741                     13.814                     13.892                     13.975                     13.975                      14.065                      14.16                     14.263                     14.372                     14.488                      14.61                    14.732        
    a716=46.8224             13.512                     13.563                     13.62                    13.684                     13.752                     13.824                     13.902                     13.986                     13.986                      14.075                      14.17                     14.273                     14.382                     14.498                     14.619                    14.741        
    a717=46.9159             13.523                     13.574                    13.631                    13.694                     13.762                     13.835                     13.913                     13.996                     13.996                      14.085                      14.18                     14.282                     14.392                     14.507                     14.628                     14.75        
    a718=47.0093             13.534                     13.585                    13.642                    13.705                     13.773                     13.845                     13.923                     14.006                     14.006                      14.095                      14.19                     14.292                     14.401                     14.517                     14.637                    14.759        
    a719=47.1028             13.545                     13.596                    13.653                    13.716                     13.784                     13.856                     13.933                     14.016                     14.016                      14.105                       14.2                     14.302                     14.411                     14.526                     14.647                    14.768        
    a720=47.1963             13.556                     13.607                    13.664                    13.727                     13.794                     13.867                     13.944                     14.027                     14.027                      14.115                      14.21                     14.312                      14.42                     14.536                     14.656                    14.777        
    a721=47.2897             13.567                     13.618                    13.675                    13.737                     13.805                     13.877                     13.954                     14.037                     14.037                      14.125                      14.22                     14.322                      14.43                     14.545                     14.665                    14.786        
    a722=47.3832             13.578                     13.628                    13.686                    13.748                     13.815                     13.887                     13.965                     14.047                     14.047                      14.135                      14.23                     14.331                     14.439                     14.554                     14.674                    14.795        
    a723=47.4766             13.589                     13.639                    13.697                    13.759                     13.826                     13.898                     13.975                     14.057                     14.057                      14.145                      14.24                     14.341                     14.449                     14.564                     14.683                    14.804        
    a724=47.5701               13.6                      13.65                    13.707                     13.77                     13.837                     13.908                     13.985                     14.067                     14.067                      14.155                      14.25                     14.351                     14.459                     14.573                     14.693                    14.813        
    a725=47.6636             13.611                     13.661                    13.718                     13.78                     13.847                     13.919                     13.995                     14.078                     14.078                      14.165                      14.26                      14.36                     14.468                     14.582                     14.702                    14.822        
    a726=47.757              13.622                     13.672                    13.729                    13.791                     13.858                     13.929                     14.006                     14.088                     14.088                      14.175                     14.269                      14.37                     14.478                     14.592                     14.711                    14.831        
    a727=47.8505             13.633                     13.683                     13.74                    13.801                     13.868                      13.94                     14.016                     14.098                     14.098                      14.185                     14.279                      14.38                     14.487                     14.601                      14.72                     14.84        
    a728=47.9439             13.644                     13.694                     13.75                    13.812                     13.879                      13.95                     14.026                     14.108                     14.108                      14.195                     14.289                     14.389                     14.496                      14.61                     14.729                    14.849        
    a729=48.0374             13.655                     13.704                    13.761                    13.823                     13.889                      13.96                     14.036                     14.118                     14.118                      14.205                     14.299                     14.399                     14.506                      14.62                     14.738                    14.858        
    a730=48.1308             13.665                     13.715                    13.772                    13.833                       13.9                     13.971                     14.047                     14.128                     14.128                      14.215                     14.309                     14.409                     14.515                     14.629                     14.747                    14.866        
    a731=48.2243             13.676                     13.726                    13.782                    13.844                      13.91                     13.981                     14.057                     14.138                     14.138                      14.225                     14.318                     14.418                     14.525                     14.638                     14.756                    14.875        
    a732=48.3178             13.687                     13.737                    13.793                    13.854                      13.92                     13.991                     14.067                     14.148                     14.148                      14.235                     14.328                     14.428                     14.534                     14.647                     14.765                    14.884        
    a733=48.4112             13.698                     13.747                    13.804                    13.865                     13.931                     14.002                     14.077                     14.158                     14.158                      14.245                     14.338                     14.437                     14.544                     14.656                     14.774                    14.893        
    a734=48.5047             13.709                     13.758                    13.814                    13.875                     13.941                     14.012                     14.087                     14.168                     14.168                      14.255                     14.347                     14.447                     14.553                     14.666                     14.783                    14.902        
    a735=48.5981             13.719                     13.769                    13.825                    13.886                     13.952                     14.022                     14.097                     14.178                     14.178                      14.265                     14.357                     14.456                     14.562                     14.675                     14.792                    14.911        
    a736=48.6916              13.73                     13.779                    13.835                    13.896                     13.962                     14.032                     14.108                     14.188                     14.188                      14.274                     14.367                     14.466                     14.572                     14.684                     14.801                    14.919        
    a737=48.785              13.741                      13.79                    13.846                    13.907                     13.972                     14.042                     14.118                     14.198                     14.198                      14.284                     14.376                     14.475                     14.581                     14.693                      14.81                    14.928        
    a738=48.8785             13.752                     13.801                    13.856                    13.917                     13.983                     14.053                     14.128                     14.208                     14.208                      14.294                     14.386                     14.485                      14.59                     14.702                     14.819                    14.937        
    a739=48.972              13.762                     13.811                    13.867                    13.928                     13.993                     14.063                     14.138                     14.218                     14.218                      14.304                     14.396                     14.494                       14.6                     14.711                     14.828                    14.946        
    a740=49.0654             13.773                     13.822                    13.877                    13.938                     14.003                     14.073                     14.148                     14.228                     14.228                      14.314                     14.405                     14.504                     14.609                     14.721                     14.837                    14.954        
    a741=49.1589             13.784                     13.832                    13.888                    13.948                     14.013                     14.083                     14.158                     14.238                     14.238                      14.323                     14.415                     14.513                     14.618                      14.73                     14.846                    14.963        
    a742=49.2523             13.794                     13.843                    13.898                    13.959                     14.024                     14.093                     14.168                     14.248                     14.248                      14.333                     14.425                     14.523                     14.627                     14.739                     14.855                    14.972        
    a743=49.3458             13.805                     13.853                    13.909                    13.969                     14.034                     14.103                     14.178                     14.257                     14.257                      14.343                     14.434                     14.532                     14.637                     14.748                     14.864                    14.981        
    a744=49.4393             13.815                     13.864                    13.919                    13.979                     14.044                     14.113                     14.188                     14.267                     14.267                      14.352                     14.444                     14.541                     14.646                     14.757                     14.873                    14.989        
    a745=49.5327             13.826                     13.875                    13.929                     13.99                     14.054                     14.123                     14.198                     14.277                     14.277                      14.362                     14.453                     14.551                     14.655                     14.766                     14.882                    14.998        
    a746=49.6262             13.837                     13.885                     13.94                        14                     14.064                     14.134                     14.208                     14.287                     14.287                      14.372                     14.463                      14.56                     14.664                     14.775                      14.89                    15.007        
    a747=49.7196             13.847                     13.895                     13.95                     14.01                     14.075                     14.144                     14.217                     14.297                     14.297                      14.381                     14.472                     14.569                     14.673                     14.784                     14.899                    15.015        
    a748=49.8131             13.858                     13.906                    13.961                     14.02                     14.085                     14.154                     14.227                     14.306                     14.306                      14.391                     14.482                     14.579                     14.683                     14.793                     14.908                    15.024        
    a749=49.9065             13.868                     13.916                    13.971                    14.031                     14.095                     14.164                     14.237                     14.316                     14.316                      14.401                     14.491                     14.588                     14.692                     14.802                     14.917                    15.033        
    a750=50                  13.879                     13.927                    13.981                    14.041                     14.105                     14.174                     14.247                     14.326                     14.326                       14.41                     14.501                     14.597                     14.701                     14.811                     14.926                    15.041        

tb_pol_a: optimal asset choice for each state space point
                    zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    a1=-20                        0                          0                         0                       -20                        -20                    -19.907                     -19.72                    -19.533                          0                           0                          0                          0                        -20                     -19.72                    -19.439                   -19.065        
    a2=-19.9065                   0                        -20                       -20                       -20                    -19.907                     -19.72                    -19.626                    -19.439                          0                           0                          0                        -20                    -19.907                    -19.626                    -19.346                   -18.972        
    a3=-19.8131                 -20                        -20                       -20                       -20                    -19.813                    -19.626                    -19.439                    -19.346                          0                           0                          0                        -20                    -19.813                    -19.533                    -19.252                   -18.879        
    a4=-19.7196                 -20                        -20                       -20                   -19.907                     -19.72                    -19.533                    -19.439                    -19.252                          0                           0                        -20                    -19.907                     -19.72                    -19.439                    -19.159                   -18.785        
    a5=-19.6262                 -20                        -20                       -20                   -19.813                    -19.626                    -19.439                    -19.252                    -19.159                          0                           0                        -20                    -19.907                    -19.626                    -19.346                    -19.065                   -18.692        
    a6=-19.5327                 -20                        -20                   -19.907                   -19.626                    -19.533                    -19.346                    -19.252                    -19.065                          0                           0                        -20                    -19.813                    -19.533                    -19.252                    -18.972                   -18.598        
    a7=-19.4393                 -20                        -20                    -19.72                   -19.533                    -19.439                    -19.252                    -19.159                    -18.972                          0                         -20                    -19.907                    -19.626                    -19.439                    -19.159                    -18.879                   -18.505        
    a8=-19.3458                 -20                        -20                   -19.626                   -19.439                    -19.252                    -19.159                    -19.065                    -18.879                          0                         -20                    -19.813                    -19.626                    -19.346                    -19.065                    -18.785                   -18.411        
    a9=-19.2523                 -20                     -19.72                   -19.533                   -19.346                    -19.252                    -19.065                    -18.972                    -18.785                        -20                     -19.907                     -19.72                    -19.533                    -19.252                    -18.972                    -18.692                   -18.318        
    a10=-19.1589                -20                    -19.533                   -19.346                   -19.252                    -19.159                    -18.972                    -18.879                    -18.692                        -20                     -19.813                    -19.626                    -19.439                    -19.159                    -18.879                    -18.598                   -18.224        
    a11=-19.0654            -19.533                    -19.439                   -19.252                   -19.159                    -18.972                    -18.879                    -18.785                    -18.598                    -19.907                      -19.72                    -19.533                    -19.346                    -19.065                    -18.785                    -18.505                   -18.131        
    a12=-18.972             -19.439                    -19.252                   -19.159                   -19.065                    -18.972                    -18.785                    -18.692                    -18.505                    -19.813                     -19.626                    -19.439                    -19.252                    -18.972                    -18.692                    -18.411                   -18.037        
    a13=-18.8785            -19.346                    -19.159                   -19.065                   -18.972                    -18.879                    -18.692                    -18.598                    -18.411                     -19.72                     -19.533                    -19.346                    -19.159                    -18.879                    -18.598                    -18.318                   -17.944        
    a14=-18.785             -19.159                    -19.065                   -18.972                   -18.879                    -18.785                    -18.598                    -18.505                    -18.318                    -19.626                     -19.439                    -19.252                    -19.065                    -18.785                    -18.505                    -18.224                    -17.85        
    a15=-18.6916            -19.065                    -18.972                   -18.879                   -18.785                    -18.692                    -18.505                    -18.411                    -18.224                    -19.439                     -19.346                    -19.159                    -18.972                    -18.692                    -18.411                    -18.131                   -17.757        
    a16=-18.5981            -18.972                    -18.879                   -18.785                   -18.692                    -18.598                    -18.411                    -18.318                    -18.131                    -19.439                     -19.252                    -19.065                    -18.879                    -18.598                    -18.318                    -18.037                   -17.664        
    a17=-18.5047            -18.879                    -18.785                   -18.692                   -18.598                    -18.505                    -18.318                    -18.224                    -18.037                    -19.252                     -19.159                    -18.972                    -18.785                    -18.505                    -18.224                    -17.944                   -17.477        
    a18=-18.4112            -18.785                    -18.692                   -18.598                   -18.505                    -18.411                    -18.224                    -18.131                    -17.944                    -19.252                     -19.065                    -18.879                    -18.692                    -18.411                    -18.131                     -17.85                   -17.383        
    a19=-18.3178            -18.692                    -18.598                   -18.505                   -18.411                    -18.318                    -18.131                    -18.037                     -17.85                    -19.065                     -18.972                    -18.785                    -18.598                    -18.318                    -18.037                    -17.664                    -17.29        
    a20=-18.2243            -18.598                    -18.505                   -18.411                   -18.318                    -18.224                    -18.037                    -17.944                    -17.757                    -18.972                     -18.879                    -18.692                    -18.505                    -18.224                    -17.944                     -17.57                   -17.196        
    a21=-18.1308            -18.505                    -18.411                   -18.318                   -18.224                    -18.131                    -17.944                     -17.85                    -17.664                    -18.879                     -18.785                    -18.598                    -18.318                    -18.131                     -17.85                    -17.477                   -17.103        
    a22=-18.0374            -18.411                    -18.318                   -18.224                   -18.131                    -18.037                     -17.85                    -17.757                     -17.57                    -18.785                     -18.692                    -18.505                    -18.224                    -18.037                    -17.757                    -17.383                   -17.009        
    a23=-17.9439            -18.318                    -18.224                   -18.131                   -18.037                    -17.944                    -17.757                    -17.664                    -17.477                    -18.692                     -18.598                    -18.411                    -18.131                    -17.944                    -17.664                     -17.29                   -16.916        
    a24=-17.8505            -18.224                    -18.131                   -18.037                   -17.944                     -17.85                    -17.664                     -17.57                    -17.383                    -18.598                     -18.505                    -18.318                    -18.037                     -17.85                     -17.57                    -17.196                   -16.822        
    a25=-17.757             -18.037                    -18.037                   -17.944                    -17.85                    -17.757                     -17.57                    -17.477                    -17.383                    -18.505                     -18.411                    -18.224                    -17.944                    -17.757                    -17.477                    -17.103                   -16.729        
    a26=-17.6636            -17.944                    -17.944                    -17.85                   -17.757                    -17.664                    -17.477                    -17.383                     -17.29                    -18.411                     -18.224                    -18.131                     -17.85                    -17.664                    -17.383                    -17.009                   -16.636        
    a27=-17.5701             -17.85                    -17.757                   -17.757                   -17.664                     -17.57                    -17.383                     -17.29                    -17.196                    -18.318                     -18.131                    -17.944                    -17.757                     -17.57                     -17.29                    -16.916                   -16.542        
    a28=-17.4766            -17.757                    -17.664                   -17.664                    -17.57                    -17.477                     -17.29                    -17.196                    -17.103                    -18.224                     -18.037                     -17.85                    -17.664                    -17.477                    -17.196                    -16.822                   -16.449        
    a29=-17.3832            -17.664                     -17.57                    -17.57                   -17.477                    -17.383                    -17.196                    -17.103                    -17.009                    -18.131                     -17.944                    -17.757                     -17.57                    -17.383                    -17.103                    -16.729                   -16.355        
    a30=-17.2897             -17.57                    -17.477                   -17.477                   -17.383                     -17.29                    -17.103                    -17.009                    -16.916                    -18.037                      -17.85                    -17.664                    -17.477                    -17.196                    -16.916                    -16.636                   -16.262        
    a31=-17.1963            -17.477                    -17.383                   -17.383                    -17.29                    -17.196                    -17.009                    -16.916                    -16.822                    -17.944                     -17.757                     -17.57                    -17.383                    -17.103                    -16.822                    -16.542                   -16.168        
    a32=-17.1028            -17.383                     -17.29                   -17.196                   -17.196                    -17.103                    -16.916                    -16.822                    -16.729                     -17.85                     -17.664                    -17.477                     -17.29                    -17.009                    -16.729                    -16.449                   -16.075        
    a33=-17.0093             -17.29                    -17.196                   -17.103                   -17.103                    -17.009                    -16.822                    -16.729                    -16.636                    -17.757                      -17.57                    -17.383                    -17.196                    -16.916                    -16.636                    -16.355                   -15.981        
    a34=-16.9159            -17.196                    -17.103                   -17.009                   -17.009                    -16.916                    -16.729                    -16.636                    -16.542                    -17.664                     -17.477                     -17.29                    -17.103                    -16.822                    -16.542                    -16.262                   -15.888        
    a35=-16.8224            -17.103                    -17.009                   -16.916                   -16.916                    -16.822                    -16.636                    -16.542                    -16.449                     -17.57                     -17.383                    -17.196                    -17.009                    -16.729                    -16.449                    -16.168                   -15.794        
    a36=-16.729             -17.009                    -16.916                   -16.822                   -16.822                    -16.729                    -16.542                    -16.449                    -16.355                    -17.477                      -17.29                    -17.103                    -16.916                    -16.636                    -16.355                    -16.075                   -15.701        
    a37=-16.6355            -16.916                    -16.822                   -16.729                   -16.729                    -16.636                    -16.449                    -16.355                    -16.262                    -17.383                     -17.196                    -17.009                    -16.822                    -16.542                    -16.262                    -15.981                   -15.607        
    a38=-16.5421            -16.822                    -16.729                   -16.636                   -16.636                    -16.542                    -16.355                    -16.262                    -16.168                     -17.29                     -17.103                    -16.916                    -16.729                    -16.449                    -16.168                    -15.888                   -15.514        
    a39=-16.4486            -16.729                    -16.636                   -16.542                   -16.542                    -16.449                    -16.262                    -16.168                    -16.075                    -17.196                     -17.009                    -16.822                    -16.636                    -16.355                    -16.075                    -15.794                   -15.421        
    a40=-16.3551            -16.636                    -16.542                   -16.449                   -16.449                    -16.355                    -16.168                    -16.075                    -15.981                    -17.103                     -16.916                    -16.729                    -16.542                    -16.262                    -15.981                    -15.701                   -15.327        
    a41=-16.2617            -16.542                    -16.449                   -16.355                   -16.355                    -16.262                    -16.075                    -15.981                    -15.888                    -16.916                     -16.822                    -16.636                    -16.449                    -16.168                    -15.888                    -15.607                   -15.234        
    a42=-16.1682            -16.449                    -16.355                   -16.262                   -16.262                    -16.168                    -15.981                    -15.888                    -15.794                    -16.822                     -16.729                    -16.542                    -16.355                    -16.075                    -15.794                    -15.514                    -15.14        
    a43=-16.0748            -16.355                    -16.262                   -16.168                   -16.168                    -16.075                    -15.981                    -15.794                    -15.701                    -16.729                     -16.636                    -16.449                    -16.262                    -15.981                    -15.701                    -15.421                   -15.047        
    a44=-15.9813            -16.262                    -16.168                   -16.075                   -16.075                    -15.981                    -15.888                    -15.701                    -15.607                    -16.636                     -16.542                    -16.355                    -16.075                    -15.888                    -15.607                    -15.327                   -14.953        
    a45=-15.8879            -16.168                    -16.075                   -15.981                   -15.981                    -15.888                    -15.794                    -15.607                    -15.514                    -16.542                     -16.449                    -16.262                    -15.981                    -15.794                    -15.514                     -15.14                    -14.86        
    a46=-15.7944            -16.075                    -15.981                   -15.888                   -15.888                    -15.794                    -15.701                    -15.514                    -15.421                    -16.449                     -16.355                    -16.168                    -15.888                    -15.701                    -15.421                    -15.047                   -14.673        
    a47=-15.7009            -15.981                    -15.888                   -15.794                   -15.794                    -15.701                    -15.607                    -15.421                    -15.327                    -16.355                     -16.168                    -16.075                    -15.794                    -15.607                    -15.327                    -14.953                   -14.579        
    a48=-15.6075            -15.888                    -15.794                   -15.701                   -15.701                    -15.607                    -15.514                    -15.327                    -15.234                    -16.262                     -16.075                    -15.981                    -15.701                    -15.514                    -15.234                     -14.86                   -14.486        
    a49=-15.514             -15.794                    -15.701                   -15.607                   -15.607                    -15.514                    -15.421                    -15.234                     -15.14                    -16.168                     -15.981                    -15.794                    -15.607                    -15.421                     -15.14                    -14.766                   -14.393        
    a50=-15.4206            -15.701                    -15.607                   -15.514                   -15.514                    -15.421                    -15.327                     -15.14                    -15.047                    -16.075                     -15.888                    -15.701                    -15.514                    -15.327                    -15.047                    -14.673                   -14.299        
    a701=45.4206             42.897                     42.897                    42.991                    42.991                     43.084                     43.178                     43.271                     43.458                     43.458                      43.551                     43.738                     43.925                     44.112                     44.393                     44.766                     45.14        
    a702=45.514              42.991                     42.991                    43.084                    43.084                     43.178                     43.271                     43.364                     43.551                     43.551                      43.645                     43.832                     44.019                     44.206                     44.486                      44.86                    45.234        
    a703=45.6075             43.084                     43.084                    43.178                    43.178                     43.271                     43.364                     43.458                     43.645                     43.645                      43.738                     43.925                     44.112                     44.299                     44.579                     44.953                    45.327        
    a704=45.7009             43.178                     43.178                    43.271                    43.271                     43.364                     43.458                     43.551                     43.645                     43.645                      43.832                     44.019                     44.206                     44.393                     44.673                     45.047                    45.421        
    a705=45.7944             43.271                     43.271                    43.364                    43.364                     43.458                     43.551                     43.645                     43.738                     43.738                      43.925                     44.112                     44.299                     44.486                     44.766                      45.14                    45.421        
    a706=45.8879             43.364                     43.364                    43.458                    43.458                     43.551                     43.645                     43.738                     43.832                     43.832                      44.019                     44.206                     44.393                     44.579                      44.86                      45.14                    45.514        
    a707=45.9813             43.458                     43.458                    43.551                    43.551                     43.645                     43.738                     43.832                     43.925                     43.925                      44.112                     44.299                     44.486                     44.673                     44.953                     45.234                    45.607        
    a708=46.0748             43.551                     43.551                    43.645                    43.645                     43.738                     43.832                     43.925                     44.019                     44.019                      44.206                     44.393                     44.579                     44.766                     45.047                     45.327                    45.701        
    a709=46.1682             43.645                     43.645                    43.738                    43.738                     43.832                     43.925                     44.019                     44.112                     44.112                      44.299                     44.486                     44.673                      44.86                      45.14                     45.421                    45.794        
    a710=46.2617             43.738                     43.738                    43.832                    43.832                     43.925                     44.019                     44.112                     44.206                     44.206                      44.393                     44.579                     44.766                     44.953                     45.234                     45.514                    45.888        
    a711=46.3551             43.738                     43.832                    43.925                    43.925                     44.019                     44.112                     44.206                     44.299                     44.299                      44.486                     44.673                      44.86                     45.047                     45.327                     45.607                    45.981        
    a712=46.4486             43.832                     43.925                    43.925                    44.019                     44.112                     44.206                     44.299                     44.393                     44.393                      44.579                     44.766                     44.953                      45.14                     45.421                     45.701                    46.075        
    a713=46.5421             43.925                     44.019                    44.019                    44.112                     44.206                     44.299                     44.393                     44.486                     44.486                      44.673                      44.86                     45.047                     45.234                     45.514                     45.794                    46.168        
    a714=46.6355             44.019                     44.112                    44.112                    44.206                     44.299                     44.393                     44.486                     44.579                     44.579                      44.766                      44.86                      45.14                     45.327                     45.607                     45.888                    46.262        
    a715=46.729              44.112                     44.206                    44.206                    44.299                     44.393                     44.486                     44.579                     44.673                     44.673                       44.86                     44.953                     45.234                     45.421                     45.701                     45.981                    46.355        
    a716=46.8224             44.206                     44.299                    44.299                    44.393                     44.486                     44.579                     44.673                     44.766                     44.766                      44.953                     45.047                     45.327                     45.514                     45.794                     46.075                    46.449        
    a717=46.9159             44.299                     44.393                    44.393                    44.486                     44.579                     44.673                     44.766                      44.86                      44.86                      45.047                      45.14                     45.327                     45.607                     45.888                     46.168                    46.542        
    a718=47.0093             44.393                     44.486                    44.486                    44.579                     44.673                     44.766                      44.86                     44.953                     44.953                       45.14                     45.234                     45.421                     45.701                     45.981                     46.262                    46.636        
    a719=47.1028             44.486                     44.579                    44.579                    44.673                     44.766                      44.86                     44.953                     45.047                     45.047                      45.234                     45.327                     45.514                     45.794                     46.075                     46.355                    46.729        
    a720=47.1963             44.579                     44.673                    44.673                    44.766                      44.86                     44.953                     45.047                      45.14                      45.14                      45.327                     45.421                     45.607                     45.888                     46.168                     46.449                    46.822        
    a721=47.2897             44.673                     44.766                    44.766                     44.86                     44.953                     45.047                      45.14                     45.234                     45.234                      45.421                     45.514                     45.701                     45.981                     46.262                     46.542                    46.916        
    a722=47.3832             44.766                      44.86                     44.86                    44.953                     45.047                      45.14                     45.234                     45.327                     45.327                      45.421                     45.607                     45.794                     46.075                     46.355                     46.636                    47.009        
    a723=47.4766              44.86                     44.953                    44.953                    45.047                      45.14                     45.234                     45.327                     45.421                     45.421                      45.514                     45.701                     45.888                     46.168                     46.449                     46.729                    47.103        
    a724=47.5701             44.953                     45.047                    45.047                     45.14                     45.234                     45.327                     45.421                     45.514                     45.514                      45.607                     45.794                     45.981                     46.262                     46.542                     46.822                    47.196        
    a725=47.6636             45.047                      45.14                     45.14                    45.234                     45.327                     45.327                     45.514                     45.607                     45.607                      45.701                     45.888                     46.075                     46.355                     46.636                     46.916                     47.29        
    a726=47.757               45.14                     45.234                    45.234                    45.327                     45.421                     45.421                     45.607                     45.701                     45.701                      45.794                     45.981                     46.168                     46.449                     46.729                     47.009                    47.383        
    a727=47.8505             45.234                     45.234                    45.327                    45.421                     45.421                     45.514                     45.701                     45.794                     45.794                      45.888                     46.075                     46.262                     46.542                     46.822                     47.103                    47.477        
    a728=47.9439             45.327                     45.327                    45.421                    45.514                     45.514                     45.607                     45.701                     45.888                     45.888                      45.981                     46.168                     46.355                     46.636                     46.822                     47.196                     47.57        
    a729=48.0374             45.421                     45.421                    45.514                    45.607                     45.607                     45.701                     45.794                     45.981                     45.981                      46.075                     46.262                     46.449                     46.729                     46.916                      47.29                    47.664        
    a730=48.1308             45.514                     45.514                    45.607                    45.701                     45.701                     45.794                     45.888                     46.075                     46.075                      46.168                     46.355                     46.542                     46.822                     47.009                     47.383                    47.757        
    a731=48.2243             45.607                     45.607                    45.701                    45.794                     45.794                     45.888                     45.981                     46.168                     46.168                      46.262                     46.449                     46.636                     46.916                     47.103                     47.477                     47.85        
    a732=48.3178             45.701                     45.701                    45.794                    45.888                     45.888                     45.981                     46.075                     46.262                     46.262                      46.355                     46.542                     46.729                     47.009                     47.196                      47.57                    47.944        
    a733=48.4112             45.794                     45.794                    45.888                    45.981                     45.981                     46.075                     46.168                     46.355                     46.355                      46.449                     46.636                     46.822                     47.009                      47.29                     47.664                    48.037        
    a734=48.5047             45.888                     45.888                    45.981                    46.075                     46.075                     46.168                     46.262                     46.449                     46.449                      46.542                     46.729                     46.916                     47.103                     47.383                     47.757                    48.131        
    a735=48.5981             45.981                     45.981                    46.075                    46.075                     46.168                     46.262                     46.355                     46.542                     46.542                      46.636                     46.822                     47.009                     47.196                     47.477                      47.85                    48.224        
    a736=48.6916             46.075                     46.075                    46.168                    46.168                     46.262                     46.355                     46.449                     46.636                     46.636                      46.729                     46.916                     47.103                      47.29                      47.57                     47.944                    48.318        
    a737=48.785              46.168                     46.168                    46.262                    46.262                     46.355                     46.449                     46.542                     46.729                     46.729                      46.822                     47.009                     47.196                     47.383                     47.664                     48.037                    48.411        
    a738=48.8785             46.262                     46.262                    46.355                    46.355                     46.449                     46.542                     46.636                     46.729                     46.729                      46.916                     47.103                      47.29                     47.477                     47.757                     48.131                    48.505        
    a739=48.972              46.355                     46.355                    46.449                    46.449                     46.542                     46.636                     46.729                     46.822                     46.822                      47.009                     47.196                     47.383                      47.57                      47.85                     48.224                    48.598        
    a740=49.0654             46.449                     46.449                    46.542                    46.542                     46.636                     46.729                     46.822                     46.916                     46.916                      47.103                      47.29                     47.477                     47.664                     47.944                     48.318                    48.598        
    a741=49.1589             46.542                     46.542                    46.636                    46.636                     46.729                     46.822                     46.916                     47.009                     47.009                      47.196                     47.383                      47.57                     47.757                     48.037                     48.318                    48.692        
    a742=49.2523             46.636                     46.636                    46.729                    46.729                     46.822                     46.916                     47.009                     47.103                     47.103                       47.29                     47.477                     47.664                      47.85                     48.131                     48.411                    48.785        
    a743=49.3458             46.729                     46.729                    46.822                    46.822                     46.916                     47.009                     47.103                     47.196                     47.196                      47.383                      47.57                     47.757                     47.944                     48.224                     48.505                    48.879        
    a744=49.4393             46.822                     46.822                    46.916                    46.916                     47.009                     47.103                     47.196                      47.29                      47.29                      47.477                     47.664                      47.85                     48.037                     48.318                     48.598                    48.972        
    a745=49.5327             46.822                     46.916                    47.009                    47.009                     47.103                     47.196                      47.29                     47.383                     47.383                       47.57                     47.757                     47.944                     48.131                     48.411                     48.692                    49.065        
    a746=49.6262             46.916                     47.009                    47.009                    47.103                     47.196                      47.29                     47.383                     47.477                     47.477                      47.664                      47.85                     48.037                     48.224                     48.505                     48.785                    49.159        
    a747=49.7196             47.009                     47.103                    47.103                    47.196                      47.29                     47.383                     47.477                      47.57                      47.57                      47.757                     47.944                     48.131                     48.318                     48.598                     48.879                    49.252        
    a748=49.8131             47.103                     47.196                    47.196                     47.29                     47.383                     47.477                      47.57                     47.664                     47.664                       47.85                     48.037                     48.224                     48.411                     48.692                     48.972                    49.346        
    a749=49.9065             47.196                      47.29                     47.29                    47.383                     47.477                      47.57                     47.664                     47.757                     47.757                      47.944                     48.037                     48.318                     48.505                     48.785                     49.065                    49.439        
    a750=50                   47.29                     47.383                    47.383                    47.477                      47.57                     47.664                     47.757                      47.85                      47.85                      48.037                     48.131                     48.411                     48.598                     48.879                     49.159                    49.533        

</pre><img vspace="5" hspace="5" src="ff_abz_vf_vecsv_01.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_02.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_03.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_04.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_05.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_06.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_07.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_08.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_09.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_10.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_11.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_12.png" alt=""> <h2 id="14">Display Various Containers</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_defparam)
</pre><h2 id="16">Display 1 support_map</h2><pre class="codeinput">    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 39
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_final ; val = true
pos = 5 ; key = bl_display_final_dist ; val = false
pos = 6 ; key = bl_display_final_dist_detail ; val = false
pos = 7 ; key = bl_display_funcgrids ; val = false
pos = 8 ; key = bl_graph ; val = true
pos = 9 ; key = bl_graph_coh_t_coh ; val = true
pos = 10 ; key = bl_graph_funcgrids ; val = false
pos = 11 ; key = bl_graph_onebyones ; val = true
pos = 12 ; key = bl_graph_pol_lvl ; val = true
pos = 13 ; key = bl_graph_pol_pct ; val = true
pos = 14 ; key = bl_graph_val ; val = true
pos = 15 ; key = bl_img_save ; val = false
pos = 16 ; key = bl_mat ; val = false
pos = 17 ; key = bl_post ; val = true
pos = 18 ; key = bl_profile ; val = false
pos = 19 ; key = bl_profile_dist ; val = false
pos = 20 ; key = bl_time ; val = true
pos = 21 ; key = it_display_every ; val = 5
pos = 22 ; key = it_display_final_colmax ; val = 15
pos = 23 ; key = it_display_final_rowmax ; val = 100
pos = 24 ; key = it_display_summmat_colmax ; val = 5
pos = 25 ; key = it_display_summmat_rowmax ; val = 5
pos = 26 ; key = st_img_name_main ; val = ff_abz_vf_vecsv_default
pos = 27 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/img/
pos = 28 ; key = st_img_prefix ; val = 
pos = 29 ; key = st_img_suffix ; val = _p4.png
pos = 30 ; key = st_mat_name_main ; val = ff_abz_vf_vecsv_default
pos = 31 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/mat/
pos = 32 ; key = st_mat_prefix ; val = 
pos = 33 ; key = st_mat_suffix ; val = _p4
pos = 34 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_abz/
pos = 35 ; key = st_profile_name_main ; val = ff_abz_vf_vecsv_default
pos = 36 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/profile/
pos = 37 ; key = st_profile_prefix ; val = 
pos = 38 ; key = st_profile_suffix ; val = _p4
pos = 39 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_final                 4     4        1 
    bl_display_final_dist            5     5        0 
    bl_display_final_dist_detail     6     6        0 
    bl_display_funcgrids             7     7        0 
    bl_graph                         8     8        1 
    bl_graph_coh_t_coh               9     9        1 
    bl_graph_funcgrids              10    10        0 
    bl_graph_onebyones              11    11        1 
    bl_graph_pol_lvl                12    12        1 
    bl_graph_pol_pct                13    13        1 
    bl_graph_val                    14    14        1 
    bl_img_save                     15    15        0 
    bl_mat                          16    16        0 
    bl_post                         17    17        1 
    bl_profile                      18    18        0 
    bl_profile_dist                 19    19        0 
    bl_time                         20    20        1 
    it_display_every                21    21        5 
    it_display_final_colmax         22    22       15 
    it_display_final_rowmax         23    23      100 
    it_display_summmat_colmax       24    24        5 
    it_display_summmat_rowmax       25    25        5 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    26 
    st_img_path              2    27 
    st_img_prefix            3    28 
    st_img_suffix            4    29 
    st_mat_name_main         5    30 
    st_mat_path              6    31 
    st_mat_prefix            7    32 
    st_mat_suffix            8    33 
    st_matimg_path_root      9    34 
    st_profile_name_main    10    35 
    st_profile_path         11    36 
    st_profile_prefix       12    37 
    st_profile_suffix       13    38 
    st_title_prefix         14    39 

</pre><h2 id="17">Display 2 armt_map</h2><pre class="codeinput">    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 4
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a ;rown= 1 ,coln= 750
ar_a :mu= 15 ,sd= 20.2477 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_375_c375    zi_749_c749    zi_750_c750
               _______    _______    ___________    ___________    ___________

    zi_1_r1      -20      -19.907      14.953         49.907           50     

pos = 2 ; key = ar_z_r_borr_mesh_wage ;rown= 1 ,coln= 75
ar_z_r_borr_mesh_wage :mu= 0.06 ,sd= 0.024915 ,min= 0.025 ,max= 0.095
               zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
               _______    _______    _________    _________    _________

    zi_1_r1     0.025      0.025       0.06         0.095        0.095  

pos = 3 ; key = ar_z_wage_mesh_r_borr ;rown= 1 ,coln= 75
ar_z_wage_mesh_r_borr :mu= 1.1347 ,sd= 0.67963 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.40076     0.94436      2.2253        2.567  

pos = 4 ; key = mt_z_trans ;rown= 75 ,coln= 75
mt_z_trans :mu= 0.013333 ,sd= 0.021527 ,min= 0 ,max= 0.087736
                  zi_1_C1       zi_2_C2      zi_38_c38     zi_74_c74     zi_75_c75 
                 __________    __________    __________    __________    __________

    zi_1_R1        0.046747      0.048212    3.5281e-05    7.7959e-17             0
    zi_2_R2        0.020182      0.035258    0.00027199    6.5719e-15    2.3388e-17
    zi_38_r38    3.0872e-07    7.3685e-06      0.076769    2.8795e-06    1.2064e-07
    zi_74_r74    6.2423e-17    1.6818e-14    0.00027199      0.013778      0.007887
    zi_75_r75    4.9256e-19    1.9867e-16    3.5281e-05      0.018841      0.018268

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                             i    idx    rowN    colN      mean        std         min        max   
                             _    ___    ____    ____    ________    ________    _______    ________

    ar_a                     1     1       1     750           15      20.248        -20          50
    ar_z_r_borr_mesh_wage    2     2       1      75         0.06    0.024915      0.025       0.095
    ar_z_wage_mesh_r_borr    3     3       1      75       1.1347     0.67963    0.34741       2.567
    mt_z_trans               4     4      75      75     0.013333    0.021527          0    0.087736

</pre><h2 id="18">Display 3 param_map</h2><pre class="codeinput">    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 35
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_default ; val = true
pos = 3 ; key = bl_loglin ; val = false
pos = 4 ; key = fl_a_max ; val = 50
pos = 5 ; key = fl_a_min ; val = 0
pos = 6 ; key = fl_b_bd ; val = -20
pos = 7 ; key = fl_beta ; val = 0.94
pos = 8 ; key = fl_c_min ; val = 0.001
pos = 9 ; key = fl_crra ; val = 1.5
pos = 10 ; key = fl_default_aprime ; val = 0
pos = 11 ; key = fl_loglin_threshold ; val = 1
pos = 12 ; key = fl_nan_replace ; val = -99999
pos = 13 ; key = fl_r_save ; val = 0.025
pos = 14 ; key = fl_tol_dist ; val = 1e-05
pos = 15 ; key = fl_tol_pol ; val = 1e-05
pos = 16 ; key = fl_tol_val ; val = 1e-05
pos = 17 ; key = fl_w ; val = 1.28
pos = 18 ; key = fl_z_r_borr_max ; val = 0.095
pos = 19 ; key = fl_z_r_borr_min ; val = 0.025
pos = 20 ; key = fl_z_r_borr_n ; val = 5
pos = 21 ; key = fl_z_r_borr_poiss_mean ; val = 1.75
pos = 22 ; key = fl_z_wage_mu ; val = 0
pos = 23 ; key = fl_z_wage_rho ; val = 0.8
pos = 24 ; key = fl_z_wage_sig ; val = 0.2
pos = 25 ; key = it_a_n ; val = 750
pos = 26 ; key = it_maxiter_dist ; val = 1000
pos = 27 ; key = it_maxiter_val ; val = 1000
pos = 28 ; key = it_tol_pol_nochange ; val = 25
pos = 29 ; key = it_trans_power_dist ; val = 1000
pos = 30 ; key = it_z_n ; val = 75
pos = 31 ; key = it_z_wage_n ; val = 15
pos = 32 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 33 ; key = st_model ; val = abz
pos = 34 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 35 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx    value 
                              __    ___    ______

    bl_b_is_principle          1     1          1
    bl_default                 2     2          1
    bl_loglin                  3     3          0
    fl_a_max                   4     4         50
    fl_a_min                   5     5          0
    fl_b_bd                    6     6        -20
    fl_beta                    7     7       0.94
    fl_c_min                   8     8      0.001
    fl_crra                    9     9        1.5
    fl_default_aprime         10    10          0
    fl_loglin_threshold       11    11          1
    fl_nan_replace            12    12     -99999
    fl_r_save                 13    13      0.025
    fl_tol_dist               14    14      1e-05
    fl_tol_pol                15    15      1e-05
    fl_tol_val                16    16      1e-05
    fl_w                      17    17       1.28
    fl_z_r_borr_max           18    18      0.095
    fl_z_r_borr_min           19    19      0.025
    fl_z_r_borr_n             20    20          5
    fl_z_r_borr_poiss_mean    21    21       1.75
    fl_z_wage_mu              22    22          0
    fl_z_wage_rho             23    23        0.8
    fl_z_wage_sig             24    24        0.2
    it_a_n                    25    25        750
    it_maxiter_dist           26    26       1000
    it_maxiter_val            27    27       1000
    it_tol_pol_nochange       28    28         25
    it_trans_power_dist       29    29       1000
    it_z_n                    30    30         75
    it_z_wage_n               31    31         15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    32 
    st_model                         2    33 
    st_z_r_borr_drv_ele_type         3    34 
    st_z_r_borr_drv_prb_type         4    35 

</pre><h2 id="19">Display 4 func_map</h2><pre class="codeinput">    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(fl_r_borr,z,b)(z*fl_w+(b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0)))
pos = 2 ; key = f_cons ; val = @(z,b,bprime)(f_coh(z,b)-bprime)
pos = 3 ; key = f_cons_checkcmin ; val = @(fl_r_borr,z,b,bprime)((f_coh(fl_r_borr,z,b)-bprime).*((f_coh(fl_r_borr,z,b)-bprime)&gt;=fl_c_min)+fl_c_min.*((f_coh(fl_r_borr,z,b)-bprime)&lt;fl_c_min))
pos = 4 ; key = f_cons_coh ; val = @(coh,bprime)(coh-bprime)
pos = 5 ; key = f_inc ; val = @(fl_r_borr,z,b)(z*fl_w+(b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0)))
pos = 6 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 7 ; key = f_util_log ; val = @(c)log(c)
pos = 8 ; key = f_util_standin ; val = @(fl_r_borr,z,b)f_util_log(f_coh(fl_r_borr,z,b).*(f_coh(fl_r_borr,z,b)&gt;0)+fl_c_min.*(f_coh(fl_r_borr,z,b)&lt;=0))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                        i    idx    xFunction
                        _    ___    _________

    f_coh               1     1         1    
    f_cons              2     2         2    
    f_cons_checkcmin    3     3         3    
    f_cons_coh          4     4         4    
    f_inc               5     5         5    
    f_util_crra         6     6         6    
    f_util_log          7     7         7    
    f_util_standin      8     8         8    

</pre><h2 id="20">Display 5 result_map</h2><pre class="codeinput">    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: RESULT_MAP
----------------------------------------
  Map with properties:

        Count: 12
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_pol_diff_norm ;rown= 180 ,coln= 1
ar_pol_diff_norm :mu= 77.2872 ,sd= 506.6801 ,min= 0 ,max= 4810.5179
                   zi_1_c1
                   _______

    zi_1_R1         4490.5
    zi_2_R2         4810.5
    zi_90_R90      0.42013
    zi_179_r179          0
    zi_180_r180          0

pos = 2 ; key = ar_st_pol_names ; val = cl_mt_pol_a cl_mt_coh cl_mt_pol_c
pos = 3 ; key = ar_val_diff_norm ;rown= 180 ,coln= 1
ar_val_diff_norm :mu= 25.0721 ,sd= 85.3597 ,min= 0.0038914 ,max= 862.6376
                    zi_1_c1 
                   _________

    zi_1_R1           862.64
    zi_2_R2           445.58
    zi_90_R90        0.85842
    zi_179_r179    0.0041386
    zi_180_r180    0.0038914

pos = 4 ; key = cl_mt_coh ;rown= 750 ,coln= 75
cl_mt_coh :mu= 16.7271 ,sd= 20.8998 ,min= -21.4553 ,max= 54.5358
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1        -20.055    -19.987     -19.991      -19.052      -18.614 
    zi_2_R2         -19.96    -19.891     -19.892      -18.949      -18.512 
    zi_375_r375     15.772      15.84      16.536       18.175       18.613 
    zi_749_r749     51.599     51.667      52.363       54.003        54.44 
    zi_750_r750     51.695     51.763      52.459       54.098       54.536 

pos = 5 ; key = cl_mt_pol_a ;rown= 750 ,coln= 75
cl_mt_pol_a :mu= 14.3127 ,sd= 19.4557 ,min= -20 ,max= 49.5327
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1             0          0           0       -19.439      -19.065 
    zi_2_R2             0        -20         -20       -19.346      -18.972 
    zi_375_r375    13.458     13.458      13.925        15.234       15.607 
    zi_749_r749    47.196      47.29      47.757        49.065       49.439 
    zi_750_r750     47.29     47.383       47.85        49.159       49.533 

pos = 6 ; key = cl_mt_pol_c ;rown= 750 ,coln= 75
cl_mt_pol_c :mu= 2.5055 ,sd= 1.3428 ,min= 0.001 ,max= 5.0031
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1         0.001       0.001       0.001      0.38763      0.45121 
    zi_2_R2         0.001     0.10877     0.10784      0.39651      0.46009 
    zi_375_r375    2.3138      2.3821      2.6106       2.9418       3.0054 
    zi_749_r749    4.4026      4.3775       4.606       4.9372       5.0007 
    zi_750_r750     4.405      4.3798      4.6083       4.9395       5.0031 

pos = 7 ; key = mt_pol_idx ;rown= 750 ,coln= 75
mt_pol_idx :mu= 368.1459 ,sd= 208.1757 ,min= 1 ,max= 745
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1          215        215         215            7           11   
    zi_2_R2          215          1           1            8           12   
    zi_375_r375      359        359         364          378          382   
    zi_749_r749      720        721         726          740          744   
    zi_750_r750      721        722         727          741          745   

pos = 8 ; key = mt_pol_perc_change ;rown= 180 ,coln= 75
mt_pol_perc_change :mu= 0.14746 ,sd= 0.29479 ,min= 0 ,max= 1
                    zi_1_C1      zi_2_C2     zi_38_c38    zi_74_c74    zi_75_c75
                   _________    _________    _________    _________    _________

    zi_1_R1                1            1            1            1          1  
    zi_2_R2            0.996      0.99867      0.99733            1          1  
    zi_90_R90      0.0053333    0.0026667    0.0026667    0.0013333      0.004  
    zi_179_r179            0            0            0            0          0  
    zi_180_r180            0            0            0            0          0  

pos = 9 ; key = mt_val ;rown= 750 ,coln= 75
mt_val :mu= 4.0736 ,sd= 13.3651 ,min= -60.0936 ,max= 15.0413
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1        -60.094    -59.852      -58.04      -22.143      -17.965 
    zi_2_R2        -60.094    -59.768     -51.666      -21.734      -17.637 
    zi_375_r375     7.7648     7.8853      8.8482       10.182       10.427 
    zi_749_r749     13.868     13.916      14.316       14.917       15.033 
    zi_750_r750     13.879     13.927      14.326       14.926       15.041 

pos = 10 ; key = tb_pol_a ;rown= 100 ,coln= 16
tb_pol_a :mu= 14.3456 ,sd= 31.6001 ,min= -20 ,max= 49.5327
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_15_c15    zi_16_c16
                   _______    _______    _______    _________    _________

    zi_1_R1              0          0    -19.533     -19.439      -19.065 
    zi_2_R2              0        -20    -19.439     -19.346      -18.972 
    zi_50_R50      -15.701    -15.607    -15.047     -14.673      -14.299 
    zi_99_R99       47.196      47.29     47.757      49.065       49.439 
    zi_100_r100      47.29     47.383      47.85      49.159       49.533 

pos = 11 ; key = tb_val ;rown= 100 ,coln= 16
tb_val :mu= -9.2137 ,sd= 25.2914 ,min= -60.0936 ,max= 15.0413
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_15_c15    zi_16_c16
                   _______    _______    _______    _________    _________

    zi_1_R1        -60.094    -59.852     -44.86     -22.143      -17.965 
    zi_2_R2        -60.094    -59.768     -43.87     -21.734      -17.637 
    zi_50_R50      -35.887    -33.895    -19.812     -8.6254      -6.6055 
    zi_99_R99       13.868     13.916     14.316      14.917       15.033 
    zi_100_r100     13.879     13.927     14.326      14.926       15.041 

pos = 12 ; key = tb_valpol_alliter ;rown= 100 ,coln= 18
tb_valpol_alliter :mu= 10.3648 ,sd= 163.7741 ,min= 0 ,max= 4810.5179
                    zi_1_C1     zi_2_C2    zi_9_C9     zi_17_c17    zi_18_c18
                   _________    _______    ________    _________    _________

    zi_1_R1           862.64    4490.5            1           1            1 
    zi_2_R2           445.58    4810.5            1           1            1 
    zi_50_R50         7.6977    2.2429     0.058667    0.069333     0.077333 
    zi_99_R99      0.0041386         0            0           0            0 
    zi_100_r100    0.0038914         0            0           0            0 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i     idx    rowN    colN     mean        std         min        max  
                          __    ___    ____    ____    _______    _______    _________    ______

    ar_pol_diff_norm       1     1     180       1      77.287     506.68            0    4810.5
    ar_val_diff_norm       2     3     180       1      25.072      85.36    0.0038914    862.64
    cl_mt_coh              3     4     750      75      16.727       20.9      -21.455    54.536
    cl_mt_pol_a            4     5     750      75      14.313     19.456          -20    49.533
    cl_mt_pol_c            5     6     750      75      2.5055     1.3428        0.001    5.0031
    mt_pol_idx             6     7     750      75      368.15     208.18            1       745
    mt_pol_perc_change     7     8     180      75     0.14746    0.29479            0         1
    mt_val                 8     9     750      75      4.0736     13.365      -60.094    15.041
    tb_pol_a               9    10     100      16      14.346       31.6          -20    49.533
    tb_val                10    11     100      16     -9.2137     25.291      -60.094    15.041
    tb_valpol_alliter     11    12     100      18      10.365     163.77            0    4810.5

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                       i    idx
                       _    ___

    ar_st_pol_names    1     2 

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 12
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_abz_vf_vecsv(varargin)
%% FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic single asset and two
% shocks problem with vectorized codes.
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html
% ff_abz_vf> shows looped codes.
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html
% ff_abz_vf_vec> shows vectorized codes. This file shows vectorized codes
% that is faster but is more memory intensive.
%
% The borrowing problem is similar to the savings problem. The main
% addition here in comparison to the savings only code
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html
% ff_az_vf_vec> is the ability to deal with default, as well as an
% additional shock to the borrowing interest rate.
%
% See
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html
% ff_az_vf_vec> how vectorization works within this structure.
%
% This _optimized-vectorized_ solution method provides very large speed
% improvements for this infinite horizon problem because the u(c(z,a,a'))
% calculation within each iteration is identical. Generally the idea is to
% identify inside iteration whether the model is infinite horizon or
% life-cycle based where repeat calculations are taking place. If such
% calculations can be identified, then potentially they could be stored and
% retrieved during future iterations/periods rather than recomputed every
% time. This saves time.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
%    % Get Default Parameters
%    it_param_set = 2;
%    [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
%    % Chnage param_map keys for borrowing
%    param_map('fl_b_bd') = -20; % borrow bound
%    param_map('bl_default') = false; % true if allow for default
%    param_map('fl_c_min') = 0.0001; % u(c_min) when default
%    % Change Keys in param_map
%    param_map('it_a_n') = 500;
%    param_map('fl_z_r_borr_n') = 5;
%    param_map('it_z_wage_n') = 15;
%    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
%    param_map('fl_a_max') = 100;
%    param_map('fl_w') = 1.3;
%    % Change Keys support_map
%    support_map('bl_display') = false;
%    support_map('bl_post') = true;
%    support_map('bl_display_final') = false;
%    % Call Program with external parameters that override defaults.
%    ff_abz_vf_vecsv(param_map, support_map);
%
% @include
%
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html ffs_abz_set_default_param>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html ffs_abz_get_funcgrid>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html ff_az_vf_post>
%
% @seealso
%
% * save loop: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html ff_az_vf>
% * save vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html ff_az_vf_vec>
% * save optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html ff_az_vf_vecsv>
% * save + borr loop: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html ff_abz_vf>
% * save + borr vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html ff_abz_vf_vec>
% * save + borr optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html ff_abz_vf_vecsv>
%

%% Default
%
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button
%

it_param_set = 4;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% Note: param_map and support_map can be adjusted here or outside to override defaults
% param_map('it_a_n') = 750;
% param_map('fl_z_r_borr_n') = 5;
% param_map('it_z_wage_n') = 15;
% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
% param_map('fl_r_save') = 0.025;
% param_map('fl_z_r_borr_poiss_mean') = 1.75;

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_abz_vf_vecsv';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_a', 'mt_z_trans', 'ar_z_r_borr_mesh_wage', 'ar_z_wage_mesh_r_borr'});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons_checkcmin', 'f_coh', 'f_cons_coh'});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

% param_map
params_group = values(param_map, {'it_a_n', 'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min',...
    'fl_nan_replace', 'bl_default', 'fl_default_aprime'});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, ...
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display_defparam', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% Initialize Output Matrixes
% include mt_pol_idx which we did not have in looped code

mt_val_cur = zeros(it_a_n, it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n, it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_idx = zeros(it_a_n, it_z_n);

% We did not need these in ff_abz_vf or ff_abz_vf_vec
% see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why store using cells.
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Solve Optimization Problem Current Iteration
    % Only this segment of code differs between ff_abz_vf and ff_abz_vf_vec
    % Store in cells results and retrieve, this is more memory intensive
    % than ff_abz_vf_vec.

    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n

        % Current Shock
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        % cash-on-hand
        ar_coh = f_coh(fl_z_r_borr, fl_z_wage, ar_a);

        % Consumption and u(c) only need to be evaluated once
        if (it_iter == 1)

            % Consumption: fl_z = 1 by 1, ar_a = 1 by N, ar_a' = N by 1
            % mt_c is N by N: matrix broadcasting, expand to matrix from arrays
            mt_c = f_cons_coh(ar_coh, ar_a');

            % EVAL current utility: N by N, f_util defined earlier
            % slightly faster to explicitly write function
            if (fl_crra == 1)
                mt_utility = log(mt_c);
                fl_u_cmin = f_util_log(fl_c_min);
            else
                % slightly faster if write function here directly, but
                % speed gain is very small, more important to have single
                % location control of functions.
                mt_utility = f_util_crra(mt_c);
                fl_u_cmin = f_util_crra(fl_c_min);
            end

            % Eliminate Complex Numbers
            mt_it_c_valid_idx = (mt_c <= fl_c_min);
            mt_utility(mt_it_c_valid_idx) = fl_u_cmin;

            % Store in cells
            cl_u_c_store{it_z_i} = mt_utility;
            cl_c_valid_idx{it_z_i} = mt_it_c_valid_idx;

        end

        % f(z'|z)
        ar_z_trans_condi = mt_z_trans(it_z_i,:);

        % EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1
        % Note: transpose ar_z_trans_condi from 1 by Z to Z by 1
        % Note: matrix multiply not dot multiply
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';

        % EVAL add on future utility, N by N + N by 1
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_evzp_condi_z;

        % Index update
        % using the method below is much faster than index replace
        % see <https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        % Default or Not Utility Handling
        if (bl_default)
            % if default: only today u(cmin), transition out next period, debt wiped out
            fl_v_default = fl_u_cmin + fl_beta*mt_evzp_condi_z(ar_a == fl_default_aprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        else
            % if default is not allowed: v = u(cmin)
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        end

        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        % mt_utility is N by N, rows are choices, cols are states.
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);
        ar_opti_aprime_z = ar_a(ar_opti_idx_z);
        ar_opti_c_z = f_cons_coh(ar_coh, ar_opti_aprime_z);

        % Handle Default is optimal or not
        if (bl_default)
            % if defaulting is optimal choice, at these states, not required
            % to default, non-default possible, but default could be optimal
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = fl_default_aprime;
            ar_opti_idx_z(ar_opti_c_z <= fl_c_min) = find(ar_a == fl_default_aprime);
        else
            % if default is not allowed, then next period same state as now
            % this is absorbing state, this is the limiting case, single
            % state space point, lowest a and lowest shock has this.
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = ar_a(ar_opti_c_z <= fl_c_min);
        end

        % store optimal values
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;

        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        end
    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); ...
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'Hval', 'Hap'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('Hval = mt_val_cur(it_a_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_a_n,:), highest a state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_idx') = mt_pol_idx;

result_map('cl_mt_coh') = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_pol_c') = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map('ar_st_pol_names') = ["cl_mt_pol_a", "cl_mt_coh", "cl_mt_pol_c"];

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

%% Display Various Containers

if (bl_display_defparam)

    %% Display 1 support_map
    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 2 armt_map
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 3 param_map
    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 4 func_map
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 5 result_map
    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);

end

end

##### SOURCE END #####
--></body></html>