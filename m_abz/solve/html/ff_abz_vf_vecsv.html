
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-22"><meta name="DC.source" content="ff_abz_vf_vecsv.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Iterate Value Function</a></li><li><a href="#10">Solve Optimization Problem Current Iteration</a></li><li><a href="#11">Check Tolerance and Continuation</a></li><li><a href="#13">Process Optimal Choices</a></li><li><a href="#14">Display Various Containers</a></li><li><a href="#16">Display 1 support_map</a></li><li><a href="#17">Display 2 armt_map</a></li><li><a href="#18">Display 3 param_map</a></li><li><a href="#19">Display 4 func_map</a></li><li><a href="#20">Display 5 result_map</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_abz_vf_vecsv(varargin)
</pre><h2 id="2">FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic single asset and two shocks problem with vectorized codes. <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html">ff_abz_vf</a> shows looped codes. <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_abz_vf_vec</a> shows vectorized codes. This file shows vectorized codes that is faster but is more memory intensive.</p><p>The borrowing problem is similar to the savings problem. The main addition here in comparison to the savings only code <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html">ff_az_vf_vec</a> is the ability to deal with default, as well as an additional shock to the borrowing interest rate.</p><p>See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_az_vf_vec</a> how vectorization works within this structure.</p><p>This <i>optimized-vectorized</i> solution method provides very large speed improvements for this infinite horizon problem because the u(c(z,a,a')) calculation within each iteration is identical. Generally the idea is to identify inside iteration whether the model is infinite horizon or life-cycle based where repeat calculations are taking place. If such calculations can be identified, then potentially they could be stored and retrieved during future iterations/periods rather than recomputed every time. This saves time.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><pre>  % Get Default Parameters
  it_param_set = 2;
  [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
  % Chnage param_map keys for borrowing
  param_map('fl_b_bd') = -20; % borrow bound
  param_map('bl_default') = false; % true if allow for default
  param_map('fl_c_min') = 0.0001; % u(c_min) when default
  % Change Keys in param_map
  param_map('it_a_n') = 500;
  param_map('fl_z_r_borr_n') = 5;
  param_map('it_z_wage_n') = 15;
  param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
  param_map('fl_a_max') = 100;
  param_map('fl_w') = 1.3;
  % Change Keys support_map
  support_map('bl_display') = false;
  support_map('bl_post') = true;
  support_map('bl_display_final') = false;
  % Call Program with external parameters that override defaults.
  ff_abz_vf_vecsv(param_map, support_map);</pre><p>@include</p><div><ul><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html">ffs_abz_set_default_param</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html">ffs_abz_get_funcgrid</a></li><li><a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html">ff_az_vf_post</a></li></ul></div><p>@seealso</p><div><ul><li>save loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html">ff_az_vf</a></li><li>save vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html">ff_az_vf_vec</a></li><li>save optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html">ff_az_vf_vecsv</a></li><li>save + borr loop: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html">ff_abz_vf</a></li><li>save + borr vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html">ff_abz_vf_vec</a></li><li>save + borr optimized-vectorized: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html">ff_abz_vf_vecsv</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% Note: param_map and support_map can be adjusted here or outside to override defaults</span>
<span class="comment">% param_map('it_a_n') = 750;</span>
<span class="comment">% param_map('fl_z_r_borr_n') = 5;</span>
<span class="comment">% param_map('it_z_wage_n') = 15;</span>
<span class="comment">% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');</span>
<span class="comment">% param_map('fl_r_save') = 0.025;</span>
<span class="comment">% param_map('fl_z_r_borr_poiss_mean') = 1.75;</span>

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_abz_vf_vecsv'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'mt_z_trans'</span>, <span class="string">'ar_z_r_borr_mesh_wage'</span>, <span class="string">'ar_z_wage_mesh_r_borr'</span>});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons_checkcmin'</span>, <span class="string">'f_coh'</span>, <span class="string">'f_cons_coh'</span>});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'it_a_n'</span>, <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>,<span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_aprime'</span>});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, <span class="keyword">...</span>
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display_defparam'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><p>include mt_pol_idx which we did not have in looped code</p><pre class="codeinput">mt_val_cur = zeros(it_a_n, it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n, it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_idx = zeros(it_a_n, it_z_n);

<span class="comment">% We did not need these in ff_abz_vf or ff_abz_vf_vec</span>
<span class="comment">% see</span>
<span class="comment">% &lt;https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html</span>
<span class="comment">% fs_u_c_partrepeat_main&gt; for why store using cells.</span>
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="10">Solve Optimization Problem Current Iteration</h2><p>Only this segment of code differs between ff_abz_vf and ff_abz_vf_vec Store in cells results and retrieve, this is more memory intensive than ff_abz_vf_vec.</p><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n

        <span class="comment">% Current Shock</span>
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        <span class="comment">% cash-on-hand</span>
        ar_coh = f_coh(fl_z_r_borr, fl_z_wage, ar_a);

        <span class="comment">% Consumption and u(c) only need to be evaluated once</span>
        <span class="keyword">if</span> (it_iter == 1)

            <span class="comment">% Consumption: fl_z = 1 by 1, ar_a = 1 by N, ar_a' = N by 1</span>
            <span class="comment">% mt_c is N by N: matrix broadcasting, expand to matrix from arrays</span>
            mt_c = f_cons_coh(ar_coh, ar_a');

            <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
            <span class="comment">% slightly faster to explicitly write function</span>
            <span class="keyword">if</span> (fl_crra == 1)
                mt_utility = log(mt_c);
                fl_u_cmin = f_util_log(fl_c_min);
            <span class="keyword">else</span>
                <span class="comment">% slightly faster if write function here directly, but</span>
                <span class="comment">% speed gain is very small, more important to have single</span>
                <span class="comment">% location control of functions.</span>
                mt_utility = f_util_crra(mt_c);
                fl_u_cmin = f_util_crra(fl_c_min);
            <span class="keyword">end</span>

            <span class="comment">% Eliminate Complex Numbers</span>
            mt_it_c_valid_idx = (mt_c &lt;= fl_c_min);
            mt_utility(mt_it_c_valid_idx) = fl_u_cmin;

            <span class="comment">% Store in cells</span>
            cl_u_c_store{it_z_i} = mt_utility;
            cl_c_valid_idx{it_z_i} = mt_it_c_valid_idx;

        <span class="keyword">end</span>

        <span class="comment">% f(z'|z)</span>
        ar_z_trans_condi = mt_z_trans(it_z_i,:);

        <span class="comment">% EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1</span>
        <span class="comment">% Note: transpose ar_z_trans_condi from 1 by Z to Z by 1</span>
        <span class="comment">% Note: matrix multiply not dot multiply</span>
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';

        <span class="comment">% EVAL add on future utility, N by N + N by 1</span>
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_evzp_condi_z;

        <span class="comment">% Index update</span>
        <span class="comment">% using the method below is much faster than index replace</span>
        <span class="comment">% see &lt;https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript&gt;</span>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        <span class="comment">% Default or Not Utility Handling</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if default: only today u(cmin), transition out next period, debt wiped out</span>
            fl_v_default = fl_u_cmin + fl_beta*mt_evzp_condi_z(ar_a == fl_default_aprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed: v = u(cmin)</span>
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        <span class="keyword">end</span>

        <span class="comment">% Optimization: remember matlab is column major, rows must be</span>
        <span class="comment">% choices, columns must be states</span>
        <span class="comment">% &lt;https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR&gt;</span>
        <span class="comment">% mt_utility is N by N, rows are choices, cols are states.</span>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);
        ar_opti_aprime_z = ar_a(ar_opti_idx_z);
        ar_opti_c_z = f_cons_coh(ar_coh, ar_opti_aprime_z);

        <span class="comment">% Handle Default is optimal or not</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
            <span class="comment">% to default, non-default possible, but default could be optimal</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_aprime;
            ar_opti_idx_z(ar_opti_c_z &lt;= fl_c_min) = find(ar_a == fl_default_aprime);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed, then next period same state as now</span>
            <span class="comment">% this is absorbing state, this is the limiting case, single</span>
            <span class="comment">% state space point, lowest a and lowest shock has this.</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = ar_a(ar_opti_c_z &lt;= fl_c_min);
        <span class="keyword">end</span>

        <span class="comment">% store optimal values</span>
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;

        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="11">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_a_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_a_n,:), highest a state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 23.838922 seconds.
</pre><h2 id="13">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_idx'</span>) = mt_pol_idx;

result_map(<span class="string">'cl_mt_coh'</span>) = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_pol_c'</span>) = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_coh"</span>, <span class="string">"cl_mt_pol_c"</span>];

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n): percentage of state space points conditional on shock where the policy function is changing across iterations
                 valgap     polgap     zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                ________    _______    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    iter=1        418.71     4490.1                   1                          1                         1                         1                          1                          1                          1                          1                          1                           1                          1                          1                          1                          1                          1                         1       
    iter=2        364.35     4830.3             0.99867                          1                         1                         1                          1                          1                          1                          1                    0.99067                       0.992                      0.996                    0.99733                          1                          1                          1                         1       
    iter=3        297.92     1627.1               0.984                    0.98533                   0.98667                   0.98933                      0.992                      0.996                    0.99733                    0.99733                    0.98267                     0.98933                      0.992                      0.996                      0.996                    0.99867                          1                         1       
    iter=4        246.94      814.5             0.96933                      0.972                   0.97467                   0.97867                    0.98133                    0.98267                    0.98933                    0.99067                      0.976                        0.98                      0.988                    0.98933                    0.98933                    0.99067                    0.99733                         1       
    iter=5        209.56     481.25             0.95067                    0.95467                   0.96133                   0.96533                    0.96933                    0.97067                    0.97333                    0.98533                      0.968                       0.968                    0.97867                    0.98533                    0.98267                      0.988                      0.988                         1       
    iter=6        179.97     322.41             0.94267                    0.94267                   0.94933                     0.952                    0.95733                    0.96133                      0.964                      0.976                    0.95333                     0.96667                      0.968                    0.97733                    0.98533                    0.98533                    0.98133                   0.99067       
    iter=7        155.52     232.03             0.92667                    0.93067                   0.93867                     0.948                    0.94933                      0.956                    0.95867                    0.96133                      0.948                     0.95467                    0.96267                      0.972                    0.98533                    0.97733                    0.98133                      0.98       
    iter=8        135.46     171.25             0.90933                    0.91867                   0.92533                   0.92533                      0.932                      0.944                      0.964                      0.956                      0.948                     0.94267                    0.95867                    0.96933                    0.97333                    0.98267                      0.988                   0.97067       
    iter=9        118.43     131.79               0.908                    0.91733                   0.91333                   0.91867                    0.92667                    0.92933                      0.944                    0.95467                    0.93067                       0.948                    0.94533                    0.95467                       0.96                    0.97467                    0.97733                   0.98267       
    iter=10       103.91     105.58             0.89333                      0.908                     0.904                   0.91867                       0.92                    0.92533                    0.92667                      0.948                    0.93067                     0.93867                      0.948                    0.95467                    0.96667                    0.96133                    0.96667                     0.972       
    iter=11       91.392     86.268             0.88667                    0.88267                     0.892                     0.904                       0.92                    0.92133                    0.92933                      0.932                    0.91733                     0.91733                    0.93867                      0.944                    0.94933                      0.964                    0.97733                      0.96       
    iter=12        80.53     70.318             0.87867                    0.87733                   0.89733                   0.89333                        0.9                    0.91067                    0.91733                    0.91467                    0.90667                     0.92267                      0.916                    0.92933                    0.93467                    0.95467                      0.952                     0.976       
    iter=13       71.117     59.396             0.86533                    0.86533                     0.876                   0.88933                      0.884                      0.896                    0.90133                      0.904                    0.90267                     0.90533                    0.91467                    0.92267                    0.93867                    0.92533                    0.93733                     0.948       
    iter=14       62.888     49.987             0.83867                    0.84533                   0.86133                   0.85333                    0.86667                    0.86667                    0.89067                    0.88267                      0.876                     0.87733                    0.88933                      0.904                      0.904                      0.936                      0.948                   0.92667       
    iter=15       55.686     43.334             0.81867                      0.848                      0.84                   0.83467                      0.836                    0.84133                      0.864                    0.86933                    0.84533                       0.872                       0.86                    0.87333                    0.89067                    0.89333                      0.896                   0.93333       
    iter=16       49.398     37.688             0.78933                    0.80133                   0.81067                   0.81067                       0.82                      0.832                    0.82533                    0.83867                    0.83867                     0.83067                    0.85067                    0.85467                    0.86533                    0.85733                    0.87467                      0.88       
    iter=17       43.906     32.439               0.764                    0.77333                     0.776                   0.79067                    0.79333                    0.79067                      0.788                    0.80133                    0.79733                     0.78933                       0.82                    0.81333                    0.81867                    0.84533                    0.85467                   0.83867       
    iter=18       39.102     28.569             0.74133                    0.75333                   0.74933                     0.748                      0.744                    0.76133                    0.76533                    0.76533                    0.75333                       0.796                    0.75467                    0.77333                      0.776                    0.80133                    0.80133                     0.844       
    iter=19       34.907     25.489             0.69867                      0.708                       0.7                   0.70533                    0.72267                    0.73067                    0.73333                    0.74267                    0.74533                       0.728                    0.74933                      0.752                    0.76667                    0.74667                    0.76667                     0.784       
    iter=20       31.251      22.39             0.65733                    0.66667                   0.66533                   0.67867                    0.67867                    0.68667                    0.68267                    0.70533                    0.71067                     0.68267                      0.704                      0.708                      0.728                       0.74                    0.75867                   0.72933       
    iter=21       28.062     20.873             0.62267                       0.62                   0.62933                   0.63333                    0.63733                    0.65067                      0.656                       0.66                      0.628                     0.65467                    0.65867                      0.672                      0.656                    0.70133                    0.70533                     0.744       
    iter=22       25.289     20.333               0.592                       0.58                   0.59333                   0.60133                    0.60933                        0.6                    0.60267                    0.61067                      0.576                     0.63867                    0.58933                        0.6                    0.64667                      0.632                    0.64133                   0.68133       
    iter=23       22.882     15.596             0.54267                    0.53733                   0.53333                   0.54933                      0.564                    0.54933                    0.55867                    0.57067                      0.616                     0.54667                      0.628                    0.62133                      0.612                    0.59067                    0.63733                     0.616       
    iter=24       20.785     14.011             0.50133                    0.48667                       0.5                   0.50667                    0.50533                    0.51467                    0.51867                      0.512                        0.5                     0.50933                    0.52133                    0.54933                    0.53867                    0.61067                      0.592                   0.58267       
    iter=25       18.957     20.097                0.44                       0.44                   0.45333                   0.45333                    0.45867                       0.46                    0.46667                    0.46533                    0.44667                     0.50533                    0.47067                    0.48133                    0.48933                    0.51333                      0.528                   0.58667       
    iter=26       17.369     11.499             0.38133                    0.40533                     0.392                   0.40667                      0.412                    0.40933                    0.41467                      0.416                      0.412                     0.43333                      0.416                      0.428                      0.472                    0.45467                    0.46933                   0.49333       
    iter=27       15.986     20.072             0.35333                    0.35067                      0.36                   0.35867                    0.35733                      0.376                    0.37067                    0.37867                      0.412                       0.376                    0.42667                    0.39467                    0.42667                    0.40933                    0.42267                   0.43733       
    iter=28       14.775     20.074               0.324                    0.30667                   0.32667                     0.324                      0.324                      0.332                       0.34                    0.33467                    0.33867                     0.33467                       0.36                    0.40267                    0.36667                    0.38533                      0.412                   0.40533       
    iter=29       13.709     9.1328             0.28267                    0.28267                   0.29067                   0.29467                    0.29333                      0.304                    0.30267                      0.312                      0.304                     0.30267                    0.31467                      0.324                    0.32933                    0.37333                    0.36133                   0.36933       
    iter=30       12.769     20.045             0.24933                    0.25867                   0.25867                   0.26533                      0.256                    0.27067                    0.27067                      0.272                    0.26667                     0.28533                    0.27867                    0.29067                    0.30133                      0.312                      0.336                   0.32533       
    iter=31       11.934     20.077               0.228                    0.23333                     0.236                   0.22667                    0.24267                      0.248                    0.25867                    0.25333                      0.252                       0.276                    0.26267                    0.26533                    0.26933                    0.27733                      0.284                   0.32133       
    iter=32        11.19     7.1617             0.19733                      0.208                   0.20533                   0.21867                    0.21333                    0.21733                      0.216                    0.22133                      0.216                     0.23067                      0.228                    0.24267                    0.24933                      0.264                    0.27467                     0.284       
    iter=33       10.523     6.5636             0.19467                    0.19333                   0.19733                   0.18667                    0.20533                      0.196                    0.21067                    0.21333                    0.21333                     0.21467                    0.21467                    0.21733                    0.22133                      0.224                       0.24                   0.24533       
    iter=34       9.9213     20.031               0.164                    0.17333                   0.16933                   0.17333                    0.16933                       0.18                       0.18                    0.18533                    0.18133                     0.19333                    0.19467                        0.2                    0.21333                    0.21867                    0.21867                   0.23333       
    iter=35        9.375     5.4102             0.15067                    0.15733                     0.164                   0.15733                    0.16667                    0.16267                    0.17067                    0.16933                      0.172                     0.16667                    0.17467                      0.176                      0.192                    0.19333                    0.19067                     0.204       
    iter=36       8.8753     20.024               0.148                    0.13467                   0.14533                   0.13867                    0.13467                    0.14533                    0.15333                       0.16                    0.16667                        0.16                    0.17067                    0.16667                    0.18133                    0.16933                      0.192                   0.19333       
    iter=37       8.4152     4.5934             0.11733                      0.132                   0.12667                   0.13467                       0.14                    0.13333                    0.13467                    0.13867                      0.148                     0.14267                    0.15467                    0.15467                    0.15467                    0.16133                    0.16133                   0.17333       
    iter=38        7.989     4.1507             0.11467                      0.112                     0.124                     0.116                    0.11733                    0.12533                    0.13067                    0.12267                    0.12533                     0.12533                    0.13467                    0.13467                    0.14667                    0.14933                    0.15333                     0.164       
    iter=39       7.5922     3.9289             0.11067                    0.10667                   0.11067                   0.10533                      0.108                    0.10667                      0.112                    0.12267                    0.11733                     0.12533                      0.128                    0.12267                    0.13333                      0.136                       0.14                     0.156       
    iter=40       7.2204     3.5537               0.088                   0.094667                  0.090667                   0.10133                      0.096                    0.10533                        0.1                    0.10667                    0.10533                     0.11067                    0.11733                      0.128                      0.116                    0.12133                    0.12533                   0.13067       
    iter=41       6.8704     20.019            0.082667                   0.093333                     0.084                     0.092                   0.093333                   0.093333                    0.10133                      0.096                    0.10267                    0.097333                      0.096                    0.10533                    0.10667                    0.11333                    0.11467                   0.12133       
    iter=42       6.5401     3.1939            0.077333                      0.072                  0.082667                  0.077333                   0.085333                      0.088                      0.088                   0.090667                   0.090667                       0.092                   0.093333                      0.096                        0.1                    0.10267                      0.108                     0.108       
    iter=43       6.2275     2.9827            0.074667                   0.073333                      0.08                     0.072                      0.076                   0.074667                      0.076                   0.077333                   0.077333                    0.082667                      0.084                   0.089333                   0.093333                   0.098667                   0.094667                     0.108       
    iter=44       5.9311     2.6457            0.058667                      0.064                  0.062667                  0.069333                   0.062667                      0.068                      0.072                   0.073333                   0.073333                    0.074667                       0.08                   0.086667                   0.077333                      0.084                   0.089333                  0.089333       
    iter=45       5.6495     2.5102               0.056                   0.054667                  0.053333                  0.065333                   0.066667                      0.064                      0.064                   0.066667                   0.065333                       0.064                      0.076                   0.073333                   0.078667                   0.074667                   0.078667                  0.086667       
    iter=46       5.3814     2.3851            0.054667                   0.058667                      0.06                     0.052                   0.054667                   0.057333                       0.06                      0.064                      0.064                    0.066667                   0.065333                   0.066667                      0.068                   0.077333                   0.077333                  0.074667       
    iter=47       5.1259      2.283            0.046667                   0.049333                     0.052                  0.049333                       0.06                      0.052                      0.056                   0.050667                   0.050667                       0.056                   0.054667                      0.056                   0.066667                      0.064                   0.070667                  0.074667       
    iter=48       4.8822     2.1908            0.046667                      0.044                     0.044                  0.045333                   0.042667                   0.054667                      0.048                      0.048                      0.048                    0.050667                      0.052                      0.056                   0.062667                   0.061333                      0.064                     0.068       
    iter=49       4.6495     1.9697            0.038667                   0.038667                  0.041333                      0.04                   0.041333                      0.044                   0.045333                   0.045333                   0.045333                       0.052                   0.050667                   0.057333                      0.048                   0.057333                   0.049333                  0.057333       
    iter=50        4.427     1.9035            0.034667                      0.036                  0.037333                  0.034667                   0.038667                   0.037333                       0.04                   0.045333                   0.045333                    0.041333                   0.045333                   0.045333                   0.049333                   0.049333                      0.056                     0.052       
    iter=76       1.1054    0.46729                   0                          0                     0.004                 0.0026667                  0.0026667                  0.0053333                  0.0026667                  0.0013333                  0.0013333                   0.0026667                  0.0066667                  0.0013333                  0.0013333                      0.004                  0.0066667                 0.0013333       
    iter=77       1.0432    0.41796           0.0026667                      0.004                 0.0013333                     0.004                      0.004                  0.0013333                  0.0013333                  0.0026667                  0.0026667                           0                  0.0026667                      0.004                  0.0053333                      0.004                          0                 0.0026667       
    iter=78      0.98416    0.36196                   0                  0.0013333                         0                 0.0026667                  0.0026667                          0                  0.0026667                  0.0026667                  0.0026667                   0.0013333                  0.0013333                          0                  0.0013333                  0.0013333                  0.0013333                     0.004       
    iter=79      0.92822    0.36196                   0                  0.0013333                         0                 0.0026667                          0                      0.004                  0.0013333                          0                          0                   0.0026667                          0                  0.0026667                  0.0013333                  0.0026667                  0.0026667                 0.0026667       
    iter=80      0.87524    0.36196           0.0013333                          0                 0.0026667                         0                          0                  0.0013333                      0.004                          0                          0                       0.004                          0                  0.0013333                  0.0013333                  0.0013333                      0.004                 0.0026667       
    iter=81      0.82507    0.36196           0.0013333                  0.0013333                 0.0026667                 0.0013333                  0.0026667                          0                          0                  0.0026667                  0.0026667                   0.0013333                  0.0026667                  0.0013333                      0.004                      0.004                      0.004                         0       
    iter=82      0.77759    0.36196                   0                  0.0013333                 0.0026667                         0                  0.0026667                          0                  0.0013333                          0                          0                           0                          0                  0.0013333                          0                          0                          0                     0.004       
    iter=83      0.73268    0.29554                   0                  0.0013333                 0.0013333                         0                  0.0013333                          0                          0                          0                          0                           0                          0                          0                  0.0013333                  0.0013333                  0.0013333                 0.0013333       
    iter=84      0.69022    0.36196           0.0013333                          0                         0                 0.0013333                          0                          0                          0                  0.0026667                  0.0026667                           0                      0.004                          0                          0                  0.0013333                          0                 0.0013333       
    iter=85      0.65009    0.29554                   0                          0                         0                         0                          0                          0                  0.0013333                          0                          0                   0.0026667                          0                          0                  0.0026667                          0                          0                         0       
    iter=86      0.61217    0.41796                   0                          0                         0                         0                          0                          0                          0                  0.0026667                  0.0026667                   0.0013333                          0                          0                          0                  0.0013333                  0.0053333                 0.0026667       
    iter=87      0.57637    0.29554           0.0013333                          0                         0                 0.0013333                          0                  0.0026667                  0.0013333                          0                          0                           0                          0                          0                          0                  0.0026667                  0.0013333                 0.0013333       
    iter=88      0.54258    0.20898                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                  0.0013333                          0                          0                         0       
    iter=89      0.51069    0.20898                   0                          0                         0                         0                          0                  0.0013333                          0                          0                          0                           0                          0                          0                  0.0013333                          0                          0                         0       
    iter=90      0.48061    0.29554           0.0013333                          0                         0                         0                          0                  0.0013333                          0                          0                          0                           0                          0                  0.0026667                          0                          0                          0                         0       
    iter=91      0.45224    0.20898                   0                  0.0013333                         0                         0                          0                          0                          0                  0.0013333                  0.0013333                           0                  0.0013333                  0.0013333                          0                          0                          0                         0       
    iter=92       0.4255    0.20898                   0                  0.0013333                         0                 0.0013333                          0                          0                          0                  0.0013333                  0.0013333                           0                          0                          0                  0.0013333                          0                          0                         0       
    iter=93       0.4003    0.20898                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                  0.0013333                          0                          0                 0.0013333       
    iter=94      0.37656          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=95      0.35419    0.29554           0.0013333                          0                 0.0013333                         0                          0                          0                          0                  0.0013333                  0.0013333                           0                  0.0013333                          0                          0                          0                          0                 0.0026667       
    iter=96      0.33313    0.20898                   0                          0                         0                 0.0013333                          0                  0.0013333                          0                          0                          0                           0                          0                          0                          0                  0.0013333                  0.0013333                         0       
    iter=97      0.31331          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=98      0.29464          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=99      0.27707    0.20898                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                  0.0013333                          0                          0                          0                         0       
    iter=100     0.26054          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=101     0.24498          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=102     0.23035          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=103     0.21658          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=104     0.20363          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=105     0.19145          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=106     0.17999          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=107     0.16921          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=108     0.15908          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=109     0.14956          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=110      0.1406          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=111     0.13217          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=112     0.12425          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=113     0.11681          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=114     0.10981          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=115     0.10323          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=116    0.097038          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=117     0.09122          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=118    0.085751          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=119     0.08061          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=120    0.075776          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=121    0.071232          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=122     0.06696          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=123    0.062945          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=124     0.05917          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       
    iter=125    0.055621          0                   0                          0                         0                         0                          0                          0                          0                          0                          0                           0                          0                          0                          0                          0                          0                         0       

tb_val: V(a,z) value at each state space point
                    zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    a1=-20                    -17.8                    -17.487                    -17.14                   -16.774                    -16.397                    -16.014                    -15.318                      -14.7                    -15.242                     -14.857                    -14.474                    -14.093                    -13.715                    -13.342                    -12.309                    -11.41        
    a2=-19.9065               -17.8                    -17.487                    -17.14                   -16.774                    -16.397                    -15.722                    -15.109                    -14.554                    -15.242                     -14.857                    -14.474                    -14.093                    -13.715                    -13.141                    -12.207                   -11.313        
    a3=-19.8131               -17.8                    -17.487                    -17.14                   -16.746                    -16.082                    -15.487                    -14.942                    -14.433                    -15.242                     -14.857                    -14.474                    -14.093                    -13.715                    -12.974                    -12.113                    -11.22        
    a4=-19.7196               -17.8                    -17.487                   -17.002                   -16.394                    -15.831                    -15.303                    -14.804                    -14.329                    -15.242                     -14.857                    -14.474                    -14.093                    -13.715                    -12.837                    -12.026                   -11.125        
    a5=-19.6262              -17.75                    -17.195                   -16.656                   -16.135                    -15.635                    -15.153                    -14.688                    -14.239                    -15.242                     -14.857                    -14.474                    -14.093                    -13.567                    -12.722                    -11.943                   -11.034        
    a6=-19.5327             -17.329                    -16.869                   -16.401                   -15.935                    -15.477                    -15.028                    -14.589                     -14.16                    -15.242                     -14.857                    -14.474                    -14.093                    -13.392                    -12.624                    -11.855                   -10.945        
    a7=-19.4393             -17.032                    -16.626                   -16.203                   -15.775                    -15.347                    -14.922                    -14.503                     -14.09                    -15.242                     -14.857                    -14.474                    -14.073                    -13.249                    -12.539                    -11.759                   -10.857        
    a8=-19.3458             -16.806                    -16.437                   -16.044                   -15.642                    -15.236                    -14.831                    -14.428                    -14.028                    -15.242                     -14.857                    -14.474                    -13.863                     -13.13                    -12.464                    -11.662                   -10.769        
    a9=-19.2523             -16.628                    -16.283                   -15.913                   -15.529                    -15.141                     -14.75                     -14.36                    -13.971                    -15.242                     -14.857                    -14.474                    -13.696                    -13.029                    -12.393                    -11.569                   -10.682        
    a10=-19.1589            -16.483                    -16.156                   -15.801                   -15.433                    -15.058                     -14.68                      -14.3                     -13.92                    -15.242                     -14.857                    -14.254                    -13.559                    -12.941                    -12.327                    -11.476                   -10.596        
    a11=-19.0654            -16.362                    -16.047                   -15.706                   -15.349                    -14.985                    -14.616                    -14.246                    -13.874                    -15.242                     -14.811                    -14.071                    -13.445                    -12.865                    -12.245                    -11.385                   -10.512        
    a12=-18.972             -16.258                    -15.954                   -15.622                   -15.275                     -14.92                    -14.559                    -14.196                    -13.831                    -15.242                     -14.571                    -13.923                    -13.347                    -12.797                    -12.146                    -11.296                   -10.428        
    a13=-18.8785            -16.169                    -15.873                   -15.549                   -15.209                    -14.861                    -14.508                    -14.151                    -13.792                    -15.054                     -14.385                      -13.8                    -13.262                    -12.736                    -12.052                    -11.209                   -10.343        
    a14=-18.785              -16.09                    -15.801                   -15.483                    -15.15                    -14.808                     -14.46                    -14.109                    -13.755                    -14.826                     -14.234                    -13.696                    -13.187                    -12.681                    -11.953                    -11.123                   -10.257        
    a15=-18.6916             -16.02                    -15.736                   -15.424                   -15.097                     -14.76                    -14.417                    -14.071                    -13.722                    -14.647                     -14.109                    -13.606                    -13.121                    -12.632                    -11.859                     -11.04                   -10.172        
    a16=-18.5981            -15.958                    -15.679                   -15.371                   -15.048                    -14.716                    -14.378                    -14.035                     -13.69                    -14.502                     -14.003                    -13.527                    -13.061                     -12.56                    -11.768                    -10.959                   -10.089        
    a17=-18.5047            -15.902                    -15.626                   -15.323                   -15.003                    -14.675                    -14.341                    -14.002                    -13.661                    -14.381                     -13.912                    -13.458                    -13.008                    -12.455                    -11.681                    -10.877                   -10.006        
    a18=-18.4112            -15.851                    -15.579                   -15.278                   -14.963                    -14.638                    -14.307                    -13.971                     -13.59                    -14.278                     -13.832                    -13.396                    -12.959                    -12.356                    -11.596                    -10.793                   -9.9214        
    a19=-18.3178            -15.805                    -15.535                   -15.238                   -14.925                    -14.603                    -14.275                    -13.943                    -13.483                    -14.189                     -13.762                     -13.34                    -12.915                    -12.256                    -11.513                    -10.709                    -9.838        
    a20=-18.2243            -15.762                    -15.495                     -15.2                    -14.89                     -14.57                    -14.245                    -13.909                    -13.385                    -14.111                     -13.699                    -13.289                    -12.874                    -12.163                    -11.435                    -10.627                   -9.7559        
    a21=-18.1308            -15.723                    -15.458                   -15.165                   -14.857                     -14.54                    -14.217                    -13.798                    -13.293                    -14.043                     -13.643                    -13.243                    -12.778                    -12.076                    -11.357                    -10.545                    -9.674        
    a22=-18.0374            -15.687                    -15.423                   -15.133                   -14.827                    -14.512                     -14.19                     -13.69                    -13.208                    -13.981                     -13.592                    -13.201                    -12.673                     -11.99                    -11.275                     -10.46                    -9.591        
    a23=-17.9439            -15.653                    -15.391                   -15.102                   -14.798                    -14.485                    -14.074                    -13.596                    -13.128                    -13.926                     -13.545                    -13.162                    -12.576                     -11.91                    -11.195                    -10.377                    -9.509        
    a24=-17.8505            -15.621                    -15.361                   -15.074                   -14.771                    -14.434                    -13.962                    -13.503                    -13.053                    -13.876                     -13.503                    -13.126                    -12.479                    -11.833                    -11.116                    -10.295                   -9.4272        
    a25=-17.757             -15.592                    -15.333                   -15.047                   -14.746                    -14.313                    -13.863                    -13.421                    -12.983                     -13.83                     -13.464                    -13.023                    -12.392                    -11.756                    -11.037                    -10.213                   -9.3445        
    a26=-17.6636            -15.564                    -15.307                   -15.022                   -14.643                    -14.203                    -13.769                    -13.341                    -12.917                    -13.788                     -13.428                    -12.919                    -12.309                    -11.679                    -10.953                     -10.13                   -9.2627        
    a27=-17.5701            -15.538                    -15.282                   -14.941                    -14.52                      -14.1                    -13.683                    -13.269                    -12.854                     -13.75                     -13.394                    -12.818                    -12.229                    -11.604                    -10.872                    -10.049                   -9.1809        
    a28=-17.4766            -15.514                    -15.213                   -14.817                   -14.412                    -14.006                    -13.602                    -13.199                    -12.793                    -13.714                     -13.311                    -12.727                    -12.153                    -11.532                    -10.792                    -9.9689                   -9.0985        
    a29=-17.3832            -15.427                    -15.073                   -14.696                   -14.309                    -13.918                    -13.526                    -13.134                    -12.734                    -13.681                     -13.201                     -12.64                    -12.078                    -11.454                     -10.71                    -9.8879                   -9.0167        
    a30=-17.2897            -15.294                    -14.956                   -14.593                   -14.217                    -13.837                    -13.455                    -13.071                    -12.679                     -13.65                       -13.1                    -12.559                    -12.007                    -11.376                    -10.628                    -9.8067                    -8.935        
    a31=-17.1963            -15.166                    -14.841                    -14.49                   -14.128                    -13.759                    -13.388                    -13.013                    -12.626                    -13.545                     -13.005                    -12.483                    -11.938                    -11.299                    -10.547                    -9.7268                   -8.8527        
    a32=-17.1028            -15.054                     -14.74                   -14.401                   -14.049                    -13.689                    -13.325                    -12.956                    -12.573                    -13.432                     -12.919                    -12.409                    -11.871                    -11.219                    -10.468                    -9.6457                    -8.771        
    a33=-17.0093            -14.948                    -14.643                   -14.313                    -13.97                     -13.62                    -13.265                    -12.904                     -12.52                    -13.333                     -12.835                    -12.338                    -11.795                    -11.137                    -10.387                     -9.565                   -8.6895        
    a34=-16.9159            -14.852                    -14.557                   -14.236                   -13.901                    -13.558                    -13.209                    -12.851                    -12.467                    -13.237                     -12.759                    -12.273                    -11.724                    -11.057                    -10.308                    -9.4843                   -8.6073        
    a35=-16.8224            -14.761                    -14.473                   -14.159                   -13.832                    -13.497                    -13.155                      -12.8                    -12.405                    -13.151                     -12.685                    -12.209                    -11.651                    -10.978                    -10.229                    -9.4026                   -8.5251        
    a36=-16.729             -14.678                    -14.397                   -14.091                    -13.77                     -13.44                    -13.101                     -12.75                    -12.336                    -13.069                     -12.618                     -12.14                    -11.572                    -10.897                    -10.148                    -9.3218                   -8.4425        
    a37=-16.6355            -14.599                    -14.324                   -14.024                   -13.709                    -13.385                    -13.052                    -12.702                     -12.26                    -12.994                     -12.553                    -12.076                    -11.495                    -10.818                     -10.07                    -9.2412                     -8.36        
    a38=-16.5421            -14.526                    -14.257                   -13.962                   -13.653                    -13.333                    -13.003                    -12.648                    -12.183                    -12.922                     -12.489                     -12.01                    -11.416                     -10.74                     -9.991                    -9.1602                   -8.2774        
    a39=-16.4486            -14.457                    -14.192                   -13.902                   -13.598                    -13.283                    -12.957                     -12.58                    -12.106                    -12.855                     -12.425                    -11.937                    -11.335                    -10.662                    -9.9109                    -9.0794                   -8.1945        
    a40=-16.3551            -14.392                    -14.132                   -13.847                   -13.547                    -13.236                    -12.909                    -12.502                     -12.03                     -12.79                     -12.366                    -11.865                    -11.256                    -10.583                    -9.8319                    -8.9989                   -8.1119        
    a41=-16.2617            -14.331                    -14.075                   -13.793                   -13.497                     -13.19                    -12.861                    -12.423                    -11.957                    -12.728                     -12.307                    -11.785                    -11.178                    -10.507                    -9.7529                    -8.9181                   -8.0291        
    a42=-16.1682            -14.273                    -14.021                   -13.743                    -13.45                    -13.144                    -12.788                    -12.343                    -11.886                    -12.669                     -12.242                    -11.708                    -11.099                     -10.43                    -9.6734                     -8.837                   -7.9465        
    a43=-16.0748            -14.217                    -13.968                   -13.694                   -13.404                      -13.1                    -12.706                    -12.267                    -11.815                    -12.613                     -12.176                    -11.627                    -11.022                    -10.353                    -9.5939                     -8.755                   -7.8637        
    a44=-15.9813            -14.165                    -13.919                   -13.649                    -13.36                    -13.045                    -12.623                     -12.19                    -11.746                    -12.556                     -12.102                    -11.548                    -10.947                    -10.275                    -9.5143                    -8.6735                     -7.78        
    a45=-15.8879            -14.115                    -13.872                   -13.603                   -13.318                    -12.958                    -12.542                    -12.118                     -11.68                    -12.498                     -12.023                    -11.469                    -10.871                    -10.197                     -9.434                    -8.5918                    -7.696        
    a46=-15.7944            -14.067                    -13.827                    -13.56                   -13.271                    -12.872                    -12.463                    -12.048                    -11.615                    -12.439                     -11.943                    -11.392                    -10.796                    -10.119                     -9.354                    -8.5102                   -7.6118        
    a47=-15.7009            -14.022                    -13.783                   -13.519                    -13.18                    -12.788                    -12.388                    -11.981                    -11.551                    -12.369                     -11.862                    -11.317                    -10.721                    -10.041                    -9.2734                    -8.4288                   -7.5276        
    a48=-15.6075            -13.978                    -13.741                   -13.468                    -13.09                    -12.706                    -12.316                    -11.914                    -11.488                    -12.292                     -11.782                    -11.241                    -10.645                    -9.9628                    -9.1935                    -8.3472                   -7.4432        
    a49=-15.514             -13.935                      -13.7                   -13.373                   -13.004                    -12.628                    -12.245                     -11.85                    -11.424                    -12.209                     -11.704                    -11.168                     -10.57                    -9.8844                    -9.1134                    -8.2656                   -7.3587        
    a50=-15.4206            -13.895                    -13.624                   -13.278                    -12.92                    -12.554                    -12.178                    -11.787                     -11.36                    -12.126                     -11.627                    -11.096                    -10.494                    -9.8058                    -9.0333                    -8.1839                   -7.2743        
    a701=45.4206             13.314                     13.367                    13.427                    13.493                     13.563                     13.638                     13.719                     13.805                     13.805                      13.897                     13.996                     14.101                     14.214                     14.334                     14.459                    14.584        
    a702=45.514              13.326                     13.379                    13.438                    13.504                     13.574                     13.649                      13.73                     13.816                     13.816                      13.908                     14.006                     14.112                     14.224                     14.344                     14.468                    14.594        
    a703=45.6075             13.337                      13.39                     13.45                    13.515                     13.585                      13.66                      13.74                     13.826                     13.826                      13.918                     14.016                     14.122                     14.234                     14.353                     14.478                    14.603        
    a704=45.7009             13.349                     13.401                    13.461                    13.526                     13.596                     13.671                     13.751                     13.837                     13.837                      13.929                     14.027                     14.132                     14.244                     14.363                     14.487                    14.612        
    a705=45.7944              13.36                     13.413                    13.472                    13.537                     13.607                     13.682                     13.762                     13.847                     13.847                      13.939                     14.037                     14.142                     14.254                     14.373                     14.497                    14.622        
    a706=45.8879             13.372                     13.424                    13.484                    13.548                     13.618                     13.693                     13.773                     13.858                     13.858                      13.949                     14.047                     14.152                     14.264                     14.382                     14.506                    14.631        
    a707=45.9813             13.383                     13.435                    13.495                    13.559                     13.629                     13.704                     13.783                     13.869                     13.869                       13.96                     14.057                     14.162                     14.274                     14.392                     14.516                     14.64        
    a708=46.0748             13.395                     13.447                    13.506                     13.57                      13.64                     13.714                     13.794                     13.879                     13.879                       13.97                     14.068                     14.172                     14.283                     14.402                     14.525                    14.649        
    a709=46.1682             13.406                     13.458                    13.517                    13.582                     13.651                     13.725                     13.805                      13.89                      13.89                      13.981                     14.078                     14.182                     14.293                     14.411                     14.535                    14.659        
    a710=46.2617             13.417                     13.469                    13.528                    13.593                     13.662                     13.736                     13.815                       13.9                       13.9                      13.991                     14.088                     14.192                     14.303                     14.421                     14.544                    14.668        
    a711=46.3551             13.429                     13.481                    13.539                    13.604                     13.673                     13.747                     13.826                      13.91                      13.91                      14.001                     14.098                     14.202                     14.313                     14.431                     14.553                    14.677        
    a712=46.4486              13.44                     13.492                     13.55                    13.615                     13.684                     13.757                     13.836                     13.921                     13.921                      14.011                     14.108                     14.212                     14.323                      14.44                     14.563                    14.686        
    a713=46.5421             13.451                     13.503                    13.562                    13.626                     13.694                     13.768                     13.847                     13.931                     13.931                      14.022                     14.118                     14.222                     14.332                      14.45                     14.572                    14.695        
    a714=46.6355             13.462                     13.514                    13.573                    13.637                     13.705                     13.779                     13.858                     13.942                     13.942                      14.032                     14.129                     14.232                     14.342                     14.459                     14.581                    14.704        
    a715=46.729              13.474                     13.525                    13.584                    13.647                     13.716                      13.79                     13.868                     13.952                     13.952                      14.042                     14.139                     14.242                     14.352                     14.469                     14.591                    14.714        
    a716=46.8224             13.485                     13.536                    13.595                    13.658                     13.727                       13.8                     13.879                     13.963                     13.963                      14.052                     14.149                     14.252                     14.362                     14.478                       14.6                    14.723        
    a717=46.9159             13.496                     13.548                    13.606                    13.669                     13.738                     13.811                     13.889                     13.973                     13.973                      14.063                     14.159                     14.262                     14.371                     14.488                     14.609                    14.732        
    a718=47.0093             13.507                     13.559                    13.617                     13.68                     13.748                     13.821                       13.9                     13.983                     13.983                      14.073                     14.169                     14.271                     14.381                     14.497                     14.619                    14.741        
    a719=47.1028             13.519                      13.57                    13.628                    13.691                     13.759                     13.832                      13.91                     13.994                     13.994                      14.083                     14.179                     14.281                     14.391                     14.507                     14.628                     14.75        
    a720=47.1963              13.53                     13.581                    13.639                    13.702                      13.77                     13.843                     13.921                     14.004                     14.004                      14.093                     14.189                     14.291                       14.4                     14.516                     14.637                    14.759        
    a721=47.2897             13.541                     13.592                     13.65                    13.713                     13.781                     13.853                     13.931                     14.014                     14.014                      14.103                     14.199                     14.301                      14.41                     14.526                     14.647                    14.768        
    a722=47.3832             13.552                     13.603                     13.66                    13.723                     13.791                     13.864                     13.941                     14.025                     14.025                      14.113                     14.209                     14.311                      14.42                     14.535                     14.656                    14.777        
    a723=47.4766             13.563                     13.614                    13.671                    13.734                     13.802                     13.874                     13.952                     14.035                     14.035                      14.124                     14.219                      14.32                     14.429                     14.545                     14.665                    14.786        
    a724=47.5701             13.574                     13.625                    13.682                    13.745                     13.813                     13.885                     13.962                     14.045                     14.045                      14.134                     14.229                      14.33                     14.439                     14.554                     14.674                    14.795        
    a725=47.6636             13.585                     13.636                    13.693                    13.756                     13.823                     13.895                     13.973                     14.055                     14.055                      14.144                     14.238                      14.34                     14.448                     14.563                     14.683                    14.804        
    a726=47.757              13.596                     13.647                    13.704                    13.766                     13.834                     13.906                     13.983                     14.065                     14.065                      14.154                     14.248                      14.35                     14.458                     14.573                     14.693                    14.813        
    a727=47.8505             13.607                     13.658                    13.715                    13.777                     13.844                     13.916                     13.993                     14.076                     14.076                      14.164                     14.258                     14.359                     14.467                     14.582                     14.702                    14.822        
    a728=47.9439             13.618                     13.668                    13.726                    13.788                     13.855                     13.927                     14.004                     14.086                     14.086                      14.174                     14.268                     14.369                     14.477                     14.591                     14.711                    14.831        
    a729=48.0374             13.629                     13.679                    13.736                    13.799                     13.865                     13.937                     14.014                     14.096                     14.096                      14.184                     14.278                     14.379                     14.486                     14.601                      14.72                     14.84        
    a730=48.1308              13.64                      13.69                    13.747                    13.809                     13.876                     13.948                     14.024                     14.106                     14.106                      14.194                     14.288                     14.388                     14.496                      14.61                     14.729                    14.849        
    a731=48.2243             13.651                     13.701                    13.758                     13.82                     13.886                     13.958                     14.034                     14.116                     14.116                      14.204                     14.298                     14.398                     14.505                     14.619                     14.738                    14.858        
    a732=48.3178             13.662                     13.712                    13.769                     13.83                     13.897                     13.968                     14.045                     14.126                     14.126                      14.214                     14.307                     14.408                     14.515                     14.629                     14.747                    14.867        
    a733=48.4112             13.673                     13.723                    13.779                    13.841                     13.907                     13.979                     14.055                     14.136                     14.136                      14.224                     14.317                     14.417                     14.524                     14.638                     14.757                    14.876        
    a734=48.5047             13.684                     13.733                     13.79                    13.852                     13.918                     13.989                     14.065                     14.146                     14.146                      14.234                     14.327                     14.427                     14.534                     14.647                     14.766                    14.885        
    a735=48.5981             13.694                     13.744                    13.801                    13.862                     13.928                     13.999                     14.075                     14.156                     14.156                      14.244                     14.337                     14.437                     14.543                     14.656                     14.775                    14.894        
    a736=48.6916             13.705                     13.755                    13.811                    13.873                     13.939                      14.01                     14.085                     14.167                     14.167                      14.253                     14.346                     14.446                     14.553                     14.666                     14.784                    14.902        
    a737=48.785              13.716                     13.766                    13.822                    13.883                     13.949                      14.02                     14.096                     14.177                     14.177                      14.263                     14.356                     14.456                     14.562                     14.675                     14.793                    14.911        
    a738=48.8785             13.727                     13.776                    13.832                    13.894                      13.96                      14.03                     14.106                     14.187                     14.187                      14.273                     14.366                     14.465                     14.571                     14.684                     14.802                     14.92        
    a739=48.972              13.738                     13.787                    13.843                    13.904                      13.97                      14.04                     14.116                     14.197                     14.197                      14.283                     14.376                     14.475                     14.581                     14.693                     14.811                    14.929        
    a740=49.0654             13.748                     13.798                    13.854                    13.915                      13.98                     14.051                     14.126                     14.206                     14.206                      14.293                     14.385                     14.484                      14.59                     14.702                      14.82                    14.938        
    a741=49.1589             13.759                     13.808                    13.864                    13.925                     13.991                     14.061                     14.136                     14.216                     14.216                      14.303                     14.395                     14.494                     14.599                     14.712                     14.829                    14.947        
    a742=49.2523              13.77                     13.819                    13.875                    13.935                     14.001                     14.071                     14.146                     14.226                     14.226                      14.312                     14.405                     14.503                     14.609                     14.721                     14.838                    14.955        
    a743=49.3458             13.781                      13.83                    13.885                    13.946                     14.011                     14.081                     14.156                     14.236                     14.236                      14.322                     14.414                     14.513                     14.618                      14.73                     14.847                    14.964        
    a744=49.4393             13.791                      13.84                    13.896                    13.956                     14.021                     14.091                     14.166                     14.246                     14.246                      14.332                     14.424                     14.522                     14.627                     14.739                     14.855                    14.973        
    a745=49.5327             13.802                     13.851                    13.906                    13.967                     14.032                     14.101                     14.176                     14.256                     14.256                      14.342                     14.433                     14.532                     14.637                     14.748                     14.864                    14.982        
    a746=49.6262             13.813                     13.861                    13.917                    13.977                     14.042                     14.112                     14.186                     14.266                     14.266                      14.351                     14.443                     14.541                     14.646                     14.757                     14.873                     14.99        
    a747=49.7196             13.823                     13.872                    13.927                    13.987                     14.052                     14.122                     14.196                     14.276                     14.276                      14.361                     14.452                      14.55                     14.655                     14.766                     14.882                    14.999        
    a748=49.8131             13.834                     13.882                    13.937                    13.998                     14.062                     14.132                     14.206                     14.286                     14.286                      14.371                     14.462                      14.56                     14.664                     14.775                     14.891                    15.008        
    a749=49.9065             13.844                     13.893                    13.948                    14.008                     14.073                     14.142                     14.216                     14.295                     14.295                       14.38                     14.472                     14.569                     14.673                     14.784                       14.9                    15.016        
    a750=50                  13.855                     13.903                    13.958                    14.018                     14.083                     14.152                     14.226                     14.305                     14.305                       14.39                     14.481                     14.579                     14.683                     14.793                     14.909                    15.025        

tb_pol_a: optimal asset choice for each state space point
                    zi1_zr_0_025_zw_0_34741    zi2_zr_0_025_zw_0_40076    zi3_zr_0_025_zw_0_4623    zi4_zr_0_025_zw_0_5333    zi5_zr_0_025_zw_0_61519    zi6_zr_0_025_zw_0_70966    zi7_zr_0_025_zw_0_81864    zi8_zr_0_025_zw_0_94436    zi68_zr_0_095_zw_0_94436    zi69_zr_0_095_zw_1_0894    zi70_zr_0_095_zw_1_2567    zi71_zr_0_095_zw_1_4496    zi72_zr_0_095_zw_1_6723    zi73_zr_0_095_zw_1_9291    zi74_zr_0_095_zw_2_2253    zi75_zr_0_095_zw_2_567
                    _______________________    _______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ______________________

    a1=-20                        0                          0                         0                         0                          0                          0                        -20                        -20                          0                           0                          0                          0                          0                          0                        -20                   -19.626        
    a2=-19.9065                   0                          0                         0                         0                          0                        -20                        -20                        -20                          0                           0                          0                          0                          0                        -20                        -20                   -19.533        
    a3=-19.8131                   0                          0                         0                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                          0                          0                        -20                    -19.907                   -19.439        
    a4=-19.7196                   0                          0                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                          0                          0                        -20                    -19.907                   -19.346        
    a5=-19.6262                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                          0                        -20                        -20                    -19.813                   -19.252        
    a6=-19.5327                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                          0                        -20                        -20                    -19.626                   -19.252        
    a7=-19.4393                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                        -20                        -20                        -20                    -19.533                   -19.065        
    a8=-19.3458                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                        -20                        -20                        -20                    -19.346                   -18.972        
    a9=-19.2523                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                          0                        -20                        -20                    -19.907                    -19.346                   -18.879        
    a10=-19.1589                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                           0                        -20                        -20                        -20                    -19.907                    -19.252                   -18.785        
    a11=-19.0654                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                         -20                        -20                        -20                        -20                    -19.533                    -19.159                   -18.692        
    a12=-18.972                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                          0                         -20                        -20                        -20                        -20                    -19.346                    -19.065                   -18.598        
    a13=-18.8785                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                        -20                    -19.252                    -18.972                   -18.505        
    a14=-18.785                 -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                        -20                    -19.159                    -18.879                   -18.411        
    a15=-18.6916                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                        -20                    -19.065                    -18.785                   -18.318        
    a16=-18.5981                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                    -19.159                    -18.972                    -18.692                   -18.224        
    a17=-18.5047                -20                        -20                       -20                       -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                    -19.159                    -18.879                    -18.598                   -18.131        
    a18=-18.4112                -20                        -20                       -20                       -20                        -20                        -20                        -20                    -18.598                        -20                         -20                        -20                        -20                    -19.065                    -18.879                    -18.411                   -18.037        
    a19=-18.3178                -20                        -20                       -20                       -20                        -20                        -20                        -20                    -18.505                        -20                         -20                        -20                        -20                    -18.972                    -18.785                    -18.318                   -17.944        
    a20=-18.2243                -20                        -20                       -20                       -20                        -20                        -20                    -18.505                    -18.505                        -20                         -20                        -20                        -20                    -18.879                    -18.692                    -18.318                    -17.85        
    a21=-18.1308                -20                        -20                       -20                       -20                        -20                        -20                    -18.411                    -18.411                        -20                         -20                        -20                    -18.972                    -18.879                    -18.598                    -18.131                   -17.757        
    a22=-18.0374                -20                        -20                       -20                       -20                        -20                    -18.411                    -18.411                    -18.411                        -20                         -20                        -20                    -18.879                    -18.785                    -18.411                    -18.037                   -17.664        
    a23=-17.9439                -20                        -20                       -20                       -20                        -20                    -18.411                    -18.318                    -18.318                        -20                         -20                        -20                    -18.879                    -18.692                    -18.318                    -17.944                    -17.57        
    a24=-17.8505                -20                        -20                       -20                       -20                    -18.318                    -18.318                    -18.318                    -18.318                        -20                         -20                        -20                    -18.785                    -18.598                    -18.318                     -17.85                   -17.383        
    a25=-17.757                 -20                        -20                       -20                       -20                    -18.318                    -18.318                    -18.318                    -18.224                        -20                         -20                    -18.785                    -18.692                    -18.505                    -18.131                    -17.757                    -17.29        
    a26=-17.6636                -20                        -20                       -20                   -18.224                    -18.224                    -18.224                    -18.224                    -18.224                        -20                         -20                    -18.692                    -18.692                    -18.411                    -18.037                    -17.664                   -17.196        
    a27=-17.5701                -20                        -20                   -18.224                   -18.224                    -18.224                    -18.224                    -18.224                    -18.131                        -20                         -20                    -18.692                    -18.598                    -18.318                    -17.944                     -17.57                   -17.103        
    a28=-17.4766                -20                    -18.131                   -18.131                   -18.131                    -18.131                    -18.131                    -18.131                    -18.037                        -20                     -18.692                    -18.598                    -18.505                    -18.318                     -17.85                    -17.477                   -17.009        
    a29=-17.3832            -18.131                    -18.131                   -18.131                   -18.131                    -18.131                    -18.131                    -18.037                    -18.037                        -20                     -18.598                    -18.598                    -18.411                    -18.037                    -17.757                    -17.383                   -16.916        
    a30=-17.2897            -18.131                    -18.131                   -18.131                   -18.037                    -18.037                    -18.037                    -18.037                    -17.944                        -20                     -18.598                    -18.505                    -18.318                    -18.037                    -17.664                     -17.29                   -16.822        
    a31=-17.1963            -18.037                    -18.037                   -18.037                   -18.037                    -18.037                    -18.037                    -17.944                    -17.944                    -18.505                     -18.505                    -18.411                    -18.318                    -17.944                     -17.57                    -17.196                   -16.729        
    a32=-17.1028            -18.037                    -18.037                   -18.037                   -17.944                    -17.944                    -17.944                    -17.944                    -17.757                    -18.505                     -18.505                    -18.411                    -18.131                    -17.757                    -17.477                    -17.009                   -16.636        
    a33=-17.0093            -17.944                    -17.944                   -17.944                   -17.944                    -17.944                    -17.944                     -17.85                    -17.664                    -18.411                     -18.411                    -18.318                    -18.037                    -17.664                     -17.29                    -16.916                   -16.542        
    a34=-16.9159            -17.944                    -17.944                   -17.944                   -17.944                     -17.85                     -17.85                    -17.757                    -17.664                    -18.411                     -18.318                    -18.318                    -17.944                     -17.57                     -17.29                    -16.822                   -16.355        
    a35=-16.8224             -17.85                     -17.85                    -17.85                    -17.85                     -17.85                     -17.85                    -17.757                    -17.383                    -18.318                     -18.318                    -18.131                    -17.757                    -17.477                    -17.103                    -16.729                   -16.262        
    a36=-16.729              -17.85                     -17.85                    -17.85                    -17.85                    -17.757                    -17.757                    -17.664                    -17.103                    -18.318                     -18.224                    -18.037                    -17.664                    -17.383                    -17.009                    -16.636                   -16.168        
    a37=-16.6355            -17.757                    -17.757                   -17.757                   -17.757                    -17.757                    -17.664                    -17.477                    -17.009                    -18.224                     -18.224                    -17.944                     -17.57                     -17.29                    -16.916                    -16.542                   -16.075        
    a38=-16.5421            -17.757                    -17.757                   -17.757                   -17.757                    -17.664                    -17.664                    -17.383                    -16.916                    -18.224                     -18.037                    -17.757                    -17.383                    -17.196                    -16.822                    -16.449                   -15.981        
    a39=-16.4486            -17.664                    -17.664                   -17.664                   -17.664                    -17.664                     -17.57                    -17.009                    -16.822                    -18.131                     -18.037                    -17.664                    -17.383                    -17.103                    -16.729                    -16.355                   -15.888        
    a40=-16.3551            -17.664                    -17.664                   -17.664                   -17.664                     -17.57                    -17.477                    -16.822                    -16.729                    -18.037                     -17.944                    -17.477                    -17.196                    -17.009                    -16.636                    -16.262                   -15.794        
    a41=-16.2617             -17.57                     -17.57                    -17.57                    -17.57                    -17.477                    -17.196                    -16.729                    -16.636                    -18.037                     -17.757                    -17.383                    -17.196                    -16.916                    -16.542                    -16.168                   -15.701        
    a42=-16.1682             -17.57                     -17.57                    -17.57                   -17.477                    -17.477                    -16.822                    -16.636                    -16.542                    -17.944                     -17.664                     -17.29                    -17.009                    -16.729                    -16.449                    -15.981                   -15.607        
    a43=-16.0748            -17.477                    -17.477                   -17.477                   -17.477                    -17.383                    -16.636                    -16.636                    -16.542                    -17.944                     -17.477                    -17.196                    -17.009                    -16.636                    -16.355                    -15.888                   -15.421        
    a44=-15.9813            -17.477                    -17.477                   -17.477                   -17.383                    -16.636                    -16.542                    -16.542                    -16.449                    -17.757                     -17.383                    -17.103                    -16.916                    -16.542                    -16.168                    -15.794                   -15.327        
    a45=-15.8879            -17.383                    -17.383                   -17.383                    -17.29                    -16.542                    -16.542                    -16.449                    -16.355                    -17.664                     -17.196                    -17.009                    -16.729                    -16.449                    -16.075                    -15.701                   -15.234        
    a46=-15.7944            -17.383                    -17.383                    -17.29                   -16.542                    -16.449                    -16.449                    -16.355                    -16.262                    -17.383                     -17.103                    -16.916                    -16.636                    -16.355                    -15.981                    -15.607                    -15.14        
    a47=-15.7009             -17.29                     -17.29                    -17.29                   -16.449                    -16.449                    -16.355                    -16.355                    -16.168                    -17.196                     -17.009                    -16.822                    -16.542                    -16.262                    -15.888                    -15.514                   -15.047        
    a48=-15.6075             -17.29                    -17.196                   -16.449                   -16.355                    -16.355                    -16.355                    -16.262                    -16.075                    -17.009                     -16.916                    -16.729                    -16.449                    -16.168                    -15.794                    -15.421                   -14.953        
    a49=-15.514             -17.196                    -17.196                   -16.355                   -16.262                    -16.262                    -16.262                    -16.168                    -15.981                    -16.916                     -16.822                    -16.636                    -16.355                    -16.075                    -15.701                    -15.327                    -14.86        
    a50=-15.4206            -17.103                    -16.262                   -16.262                   -16.262                    -16.262                    -16.168                    -16.075                    -15.888                    -16.822                     -16.729                    -16.542                    -16.262                    -15.888                    -15.607                    -15.234                   -14.766        
    a701=45.4206             42.897                     42.991                    42.991                    43.084                     43.084                     43.178                     43.364                     43.458                     43.458                      43.551                     43.738                     43.925                     44.206                     44.393                     44.766                     45.14        
    a702=45.514              42.991                     42.991                    43.084                    43.178                     43.178                     43.271                     43.364                     43.551                     43.551                      43.645                     43.832                     44.019                     44.299                     44.486                      44.86                    45.234        
    a703=45.6075             43.084                     43.084                    43.178                    43.271                     43.271                     43.364                     43.458                     43.645                     43.645                      43.738                     43.925                     44.112                     44.393                     44.579                     44.953                    45.327        
    a704=45.7009             43.178                     43.178                    43.271                    43.364                     43.364                     43.458                     43.551                     43.738                     43.738                      43.832                     44.019                     44.206                     44.486                     44.673                     45.047                    45.421        
    a705=45.7944             43.271                     43.271                    43.364                    43.458                     43.458                     43.551                     43.645                     43.832                     43.832                      43.925                     44.112                     44.299                     44.579                     44.766                      45.14                    45.514        
    a706=45.8879             43.364                     43.364                    43.458                    43.551                     43.551                     43.645                     43.738                     43.925                     43.925                      44.019                     44.206                     44.393                     44.579                      44.86                     45.234                    45.607        
    a707=45.9813             43.458                     43.458                    43.551                    43.645                     43.645                     43.738                     43.832                     44.019                     44.019                      44.112                     44.299                     44.486                     44.673                     44.953                     45.327                    45.701        
    a708=46.0748             43.551                     43.551                    43.645                    43.738                     43.738                     43.832                     43.925                     44.112                     44.112                      44.206                     44.393                     44.579                     44.766                     45.047                     45.421                    45.794        
    a709=46.1682             43.645                     43.645                    43.738                    43.738                     43.832                     43.925                     44.019                     44.206                     44.206                      44.299                     44.486                     44.673                      44.86                      45.14                     45.514                    45.888        
    a710=46.2617             43.738                     43.738                    43.832                    43.832                     43.925                     44.019                     44.112                     44.299                     44.299                      44.393                     44.579                     44.766                     44.953                     45.234                     45.607                    45.981        
    a711=46.3551             43.832                     43.832                    43.925                    43.925                     44.019                     44.112                     44.206                     44.393                     44.393                      44.486                     44.673                      44.86                     45.047                     45.327                     45.701                    46.075        
    a712=46.4486             43.925                     43.925                    44.019                    44.019                     44.112                     44.206                     44.299                     44.393                     44.393                      44.579                     44.766                     44.953                      45.14                     45.421                     45.794                    46.075        
    a713=46.5421             44.019                     44.019                    44.112                    44.112                     44.206                     44.299                     44.393                     44.486                     44.486                      44.673                      44.86                     45.047                     45.234                     45.514                     45.888                    46.168        
    a714=46.6355             44.112                     44.112                    44.206                    44.206                     44.299                     44.393                     44.486                     44.579                     44.579                      44.766                     44.953                      45.14                     45.327                     45.607                     45.888                    46.262        
    a715=46.729              44.206                     44.206                    44.299                    44.299                     44.393                     44.486                     44.579                     44.673                     44.673                       44.86                     45.047                     45.234                     45.421                     45.701                     45.981                    46.355        
    a716=46.8224             44.299                     44.299                    44.393                    44.393                     44.486                     44.579                     44.673                     44.766                     44.766                      44.953                      45.14                     45.327                     45.514                     45.794                     46.075                    46.449        
    a717=46.9159             44.393                     44.393                    44.486                    44.486                     44.579                     44.673                     44.766                      44.86                      44.86                      45.047                     45.234                     45.421                     45.607                     45.888                     46.168                    46.542        
    a718=47.0093             44.486                     44.486                    44.579                    44.579                     44.673                     44.766                      44.86                     44.953                     44.953                       45.14                     45.327                     45.514                     45.701                     45.981                     46.262                    46.636        
    a719=47.1028             44.486                     44.579                    44.673                    44.673                     44.766                      44.86                     44.953                     45.047                     45.047                      45.234                     45.421                     45.607                     45.794                     46.075                     46.355                    46.729        
    a720=47.1963             44.579                     44.673                    44.673                    44.766                      44.86                     44.953                     45.047                      45.14                      45.14                      45.327                     45.514                     45.701                     45.888                     46.168                     46.449                    46.822        
    a721=47.2897             44.673                     44.766                    44.766                     44.86                     44.953                     45.047                      45.14                     45.234                     45.234                      45.421                     45.607                     45.794                     45.981                     46.262                     46.542                    46.916        
    a722=47.3832             44.766                      44.86                     44.86                    44.953                     45.047                      45.14                     45.234                     45.327                     45.327                      45.514                     45.607                     45.888                     46.075                     46.355                     46.636                    47.009        
    a723=47.4766              44.86                     44.953                    44.953                    45.047                      45.14                     45.234                     45.327                     45.421                     45.421                      45.607                     45.701                     45.981                     46.168                     46.449                     46.729                    47.103        
    a724=47.5701             44.953                     45.047                    45.047                     45.14                     45.234                     45.327                     45.421                     45.514                     45.514                      45.701                     45.794                     46.075                     46.262                     46.542                     46.822                    47.196        
    a725=47.6636             45.047                      45.14                     45.14                    45.234                     45.327                     45.421                     45.514                     45.607                     45.607                      45.794                     45.888                     46.075                     46.355                     46.636                     46.916                     47.29        
    a726=47.757               45.14                     45.234                    45.234                    45.327                     45.421                     45.514                     45.607                     45.701                     45.701                      45.888                     45.981                     46.168                     46.449                     46.729                     47.009                    47.383        
    a727=47.8505             45.234                     45.327                    45.327                    45.421                     45.514                     45.607                     45.701                     45.794                     45.794                      45.981                     46.075                     46.262                     46.542                     46.822                     47.103                    47.477        
    a728=47.9439             45.327                     45.421                    45.421                    45.514                     45.607                     45.701                     45.794                     45.888                     45.888                      46.075                     46.168                     46.355                     46.636                     46.916                     47.196                     47.57        
    a729=48.0374             45.421                     45.514                    45.514                    45.607                     45.701                     45.794                     45.888                     45.981                     45.981                      46.075                     46.262                     46.449                     46.729                     47.009                      47.29                    47.664        
    a730=48.1308             45.514                     45.607                    45.607                    45.701                     45.794                     45.888                     45.981                     46.075                     46.075                      46.168                     46.355                     46.542                     46.822                     47.103                     47.383                    47.757        
    a731=48.2243             45.607                     45.701                    45.701                    45.794                     45.888                     45.981                     46.075                     46.168                     46.168                      46.262                     46.449                     46.636                     46.916                     47.196                     47.477                     47.85        
    a732=48.3178             45.701                     45.794                    45.794                    45.888                     45.981                     46.075                     46.168                     46.262                     46.262                      46.355                     46.542                     46.729                     47.009                      47.29                      47.57                    47.944        
    a733=48.4112             45.794                     45.888                    45.888                    45.981                     46.075                     46.075                     46.262                     46.355                     46.355                      46.449                     46.636                     46.822                     47.103                     47.383                     47.664                    48.037        
    a734=48.5047             45.888                     45.981                    45.981                    46.075                     46.168                     46.168                     46.355                     46.449                     46.449                      46.542                     46.729                     46.916                     47.196                     47.477                     47.757                    48.131        
    a735=48.5981             45.981                     45.981                    46.075                    46.168                     46.168                     46.262                     46.449                     46.542                     46.542                      46.636                     46.822                     47.009                      47.29                      47.57                      47.85                    48.224        
    a736=48.6916             46.075                     46.075                    46.168                    46.262                     46.262                     46.355                     46.449                     46.636                     46.636                      46.729                     46.916                     47.103                     47.383                      47.57                     47.944                    48.318        
    a737=48.785              46.168                     46.168                    46.262                    46.355                     46.355                     46.449                     46.542                     46.729                     46.729                      46.822                     47.009                     47.196                     47.477                     47.664                     48.037                    48.411        
    a738=48.8785             46.262                     46.262                    46.355                    46.449                     46.449                     46.542                     46.636                     46.822                     46.822                      46.916                     47.103                      47.29                      47.57                     47.757                     48.131                    48.505        
    a739=48.972              46.355                     46.355                    46.449                    46.542                     46.542                     46.636                     46.729                     46.916                     46.916                      47.009                     47.196                     47.383                     47.664                      47.85                     48.224                    48.598        
    a740=49.0654             46.449                     46.449                    46.542                    46.636                     46.636                     46.729                     46.822                     47.009                     47.009                      47.103                      47.29                     47.477                     47.664                     47.944                     48.318                    48.692        
    a741=49.1589             46.542                     46.542                    46.636                    46.729                     46.729                     46.822                     46.916                     47.103                     47.103                      47.196                     47.383                      47.57                     47.757                     48.037                     48.411                    48.785        
    a742=49.2523             46.636                     46.636                    46.729                    46.822                     46.822                     46.916                     47.009                     47.196                     47.196                       47.29                     47.477                     47.664                      47.85                     48.131                     48.505                    48.879        
    a743=49.3458             46.729                     46.729                    46.822                    46.822                     46.916                     47.009                     47.103                      47.29                      47.29                      47.383                      47.57                     47.757                     47.944                     48.224                     48.598                    48.972        
    a744=49.4393             46.822                     46.822                    46.916                    46.916                     47.009                     47.103                     47.196                     47.383                     47.383                      47.477                     47.664                      47.85                     48.037                     48.318                     48.692                    49.065        
    a745=49.5327             46.916                     46.916                    47.009                    47.009                     47.103                     47.196                      47.29                     47.477                     47.477                       47.57                     47.757                     47.944                     48.131                     48.411                     48.785                    49.159        
    a746=49.6262             47.009                     47.009                    47.103                    47.103                     47.196                      47.29                     47.383                     47.477                     47.477                      47.664                      47.85                     48.037                     48.224                     48.505                     48.879                    49.252        
    a747=49.7196             47.103                     47.103                    47.196                    47.196                      47.29                     47.383                     47.477                      47.57                      47.57                      47.757                     47.944                     48.131                     48.318                     48.598                     48.972                    49.252        
    a748=49.8131             47.196                     47.196                     47.29                     47.29                     47.383                     47.477                      47.57                     47.664                     47.664                       47.85                     48.037                     48.224                     48.411                     48.692                     48.972                    49.346        
    a749=49.9065              47.29                      47.29                    47.383                    47.383                     47.477                      47.57                     47.664                     47.757                     47.757                      47.944                     48.131                     48.318                     48.505                     48.785                     49.065                    49.439        
    a750=50                  47.383                     47.383                    47.477                    47.477                      47.57                     47.664                     47.757                      47.85                      47.85                      48.037                     48.224                     48.411                     48.598                     48.879                     49.159                    49.533        

</pre><img vspace="5" hspace="5" src="ff_abz_vf_vecsv_01.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_02.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_03.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_04.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_05.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_06.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_07.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_08.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_09.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_10.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_11.png" alt=""> <img vspace="5" hspace="5" src="ff_abz_vf_vecsv_12.png" alt=""> <h2 id="14">Display Various Containers</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_defparam)
</pre><h2 id="16">Display 1 support_map</h2><pre class="codeinput">    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 39
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_final ; val = true
pos = 5 ; key = bl_display_final_dist ; val = false
pos = 6 ; key = bl_display_final_dist_detail ; val = false
pos = 7 ; key = bl_display_funcgrids ; val = false
pos = 8 ; key = bl_graph ; val = true
pos = 9 ; key = bl_graph_coh_t_coh ; val = true
pos = 10 ; key = bl_graph_funcgrids ; val = false
pos = 11 ; key = bl_graph_onebyones ; val = true
pos = 12 ; key = bl_graph_pol_lvl ; val = true
pos = 13 ; key = bl_graph_pol_pct ; val = true
pos = 14 ; key = bl_graph_val ; val = true
pos = 15 ; key = bl_img_save ; val = false
pos = 16 ; key = bl_mat ; val = false
pos = 17 ; key = bl_post ; val = true
pos = 18 ; key = bl_profile ; val = false
pos = 19 ; key = bl_profile_dist ; val = false
pos = 20 ; key = bl_time ; val = true
pos = 21 ; key = it_display_every ; val = 5
pos = 22 ; key = it_display_final_colmax ; val = 15
pos = 23 ; key = it_display_final_rowmax ; val = 100
pos = 24 ; key = it_display_summmat_colmax ; val = 5
pos = 25 ; key = it_display_summmat_rowmax ; val = 5
pos = 26 ; key = st_img_name_main ; val = ff_abz_vf_vecsv_default
pos = 27 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/img/
pos = 28 ; key = st_img_prefix ; val = 
pos = 29 ; key = st_img_suffix ; val = _p4.png
pos = 30 ; key = st_mat_name_main ; val = ff_abz_vf_vecsv_default
pos = 31 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/mat/
pos = 32 ; key = st_mat_prefix ; val = 
pos = 33 ; key = st_mat_suffix ; val = _p4
pos = 34 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_abz/
pos = 35 ; key = st_profile_name_main ; val = ff_abz_vf_vecsv_default
pos = 36 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_abz//solve/profile/
pos = 37 ; key = st_profile_prefix ; val = 
pos = 38 ; key = st_profile_suffix ; val = _p4
pos = 39 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_final                 4     4        1 
    bl_display_final_dist            5     5        0 
    bl_display_final_dist_detail     6     6        0 
    bl_display_funcgrids             7     7        0 
    bl_graph                         8     8        1 
    bl_graph_coh_t_coh               9     9        1 
    bl_graph_funcgrids              10    10        0 
    bl_graph_onebyones              11    11        1 
    bl_graph_pol_lvl                12    12        1 
    bl_graph_pol_pct                13    13        1 
    bl_graph_val                    14    14        1 
    bl_img_save                     15    15        0 
    bl_mat                          16    16        0 
    bl_post                         17    17        1 
    bl_profile                      18    18        0 
    bl_profile_dist                 19    19        0 
    bl_time                         20    20        1 
    it_display_every                21    21        5 
    it_display_final_colmax         22    22       15 
    it_display_final_rowmax         23    23      100 
    it_display_summmat_colmax       24    24        5 
    it_display_summmat_rowmax       25    25        5 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    26 
    st_img_path              2    27 
    st_img_prefix            3    28 
    st_img_suffix            4    29 
    st_mat_name_main         5    30 
    st_mat_path              6    31 
    st_mat_prefix            7    32 
    st_mat_suffix            8    33 
    st_matimg_path_root      9    34 
    st_profile_name_main    10    35 
    st_profile_path         11    36 
    st_profile_prefix       12    37 
    st_profile_suffix       13    38 
    st_title_prefix         14    39 

</pre><h2 id="17">Display 2 armt_map</h2><pre class="codeinput">    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 4
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a ;rown= 1 ,coln= 750
ar_a :mu= 15 ,sd= 20.2477 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_375_c375    zi_749_c749    zi_750_c750
               _______    _______    ___________    ___________    ___________

    zi_1_r1      -20      -19.907      14.953         49.907           50     

pos = 2 ; key = ar_z_r_borr_mesh_wage ;rown= 1 ,coln= 75
ar_z_r_borr_mesh_wage :mu= 0.06 ,sd= 0.024915 ,min= 0.025 ,max= 0.095
               zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
               _______    _______    _________    _________    _________

    zi_1_r1     0.025      0.025       0.06         0.095        0.095  

pos = 3 ; key = ar_z_wage_mesh_r_borr ;rown= 1 ,coln= 75
ar_z_wage_mesh_r_borr :mu= 1.1347 ,sd= 0.67963 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.40076     0.94436      2.2253        2.567  

pos = 4 ; key = mt_z_trans ;rown= 75 ,coln= 75
mt_z_trans :mu= 0.013333 ,sd= 0.033888 ,min= 0 ,max= 0.18043
                  zi_1_C1       zi_2_C2      zi_38_c38     zi_74_c74     zi_75_c75 
                 __________    __________    __________    __________    __________

    zi_1_R1      0.00040376    0.00041642    9.9503e-06    7.1794e-16             0
    zi_2_R2      0.00017432    0.00030453    7.6711e-05    6.0522e-14    2.1538e-16
    zi_38_r38    2.6665e-09    6.3644e-08      0.021651    2.6518e-05     1.111e-06
    zi_74_r74    5.3916e-19    1.4526e-16    7.6711e-05       0.12689      0.072633
    zi_75_r75    4.2544e-21     1.716e-18    9.9503e-06       0.17351       0.16823

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                             i    idx    rowN    colN      mean        std         min        max  
                             _    ___    ____    ____    ________    ________    _______    _______

    ar_a                     1     1       1     750           15      20.248        -20         50
    ar_z_r_borr_mesh_wage    2     2       1      75         0.06    0.024915      0.025      0.095
    ar_z_wage_mesh_r_borr    3     3       1      75       1.1347     0.67963    0.34741      2.567
    mt_z_trans               4     4      75      75     0.013333    0.033888          0    0.18043

</pre><h2 id="18">Display 3 param_map</h2><pre class="codeinput">    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 35
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_b_is_principle ; val = true
pos = 2 ; key = bl_default ; val = true
pos = 3 ; key = bl_loglin ; val = false
pos = 4 ; key = fl_a_max ; val = 50
pos = 5 ; key = fl_a_min ; val = 0
pos = 6 ; key = fl_b_bd ; val = -20
pos = 7 ; key = fl_beta ; val = 0.94
pos = 8 ; key = fl_c_min ; val = 0.01
pos = 9 ; key = fl_crra ; val = 1.5
pos = 10 ; key = fl_default_aprime ; val = 0
pos = 11 ; key = fl_loglin_threshold ; val = 1
pos = 12 ; key = fl_nan_replace ; val = -99999
pos = 13 ; key = fl_r_save ; val = 0.025
pos = 14 ; key = fl_tol_dist ; val = 1e-05
pos = 15 ; key = fl_tol_pol ; val = 1e-05
pos = 16 ; key = fl_tol_val ; val = 1e-05
pos = 17 ; key = fl_w ; val = 1.28
pos = 18 ; key = fl_z_r_borr_max ; val = 0.095
pos = 19 ; key = fl_z_r_borr_min ; val = 0.025
pos = 20 ; key = fl_z_r_borr_n ; val = 5
pos = 21 ; key = fl_z_r_borr_poiss_mean ; val = 10
pos = 22 ; key = fl_z_wage_mu ; val = 0
pos = 23 ; key = fl_z_wage_rho ; val = 0.8
pos = 24 ; key = fl_z_wage_sig ; val = 0.2
pos = 25 ; key = it_a_n ; val = 750
pos = 26 ; key = it_maxiter_dist ; val = 1000
pos = 27 ; key = it_maxiter_val ; val = 1000
pos = 28 ; key = it_tol_pol_nochange ; val = 25
pos = 29 ; key = it_trans_power_dist ; val = 1000
pos = 30 ; key = it_z_n ; val = 75
pos = 31 ; key = it_z_wage_n ; val = 15
pos = 32 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 33 ; key = st_model ; val = abz
pos = 34 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 35 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx    value 
                              __    ___    ______

    bl_b_is_principle          1     1          1
    bl_default                 2     2          1
    bl_loglin                  3     3          0
    fl_a_max                   4     4         50
    fl_a_min                   5     5          0
    fl_b_bd                    6     6        -20
    fl_beta                    7     7       0.94
    fl_c_min                   8     8       0.01
    fl_crra                    9     9        1.5
    fl_default_aprime         10    10          0
    fl_loglin_threshold       11    11          1
    fl_nan_replace            12    12     -99999
    fl_r_save                 13    13      0.025
    fl_tol_dist               14    14      1e-05
    fl_tol_pol                15    15      1e-05
    fl_tol_val                16    16      1e-05
    fl_w                      17    17       1.28
    fl_z_r_borr_max           18    18      0.095
    fl_z_r_borr_min           19    19      0.025
    fl_z_r_borr_n             20    20          5
    fl_z_r_borr_poiss_mean    21    21         10
    fl_z_wage_mu              22    22          0
    fl_z_wage_rho             23    23        0.8
    fl_z_wage_sig             24    24        0.2
    it_a_n                    25    25        750
    it_maxiter_dist           26    26       1000
    it_maxiter_val            27    27       1000
    it_tol_pol_nochange       28    28         25
    it_trans_power_dist       29    29       1000
    it_z_n                    30    30         75
    it_z_wage_n               31    31         15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    32 
    st_model                         2    33 
    st_z_r_borr_drv_ele_type         3    34 
    st_z_r_borr_drv_prb_type         4    35 

</pre><h2 id="19">Display 4 func_map</h2><pre class="codeinput">    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(fl_r_borr,z,b)(z*fl_w+(b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0)))
pos = 2 ; key = f_cons ; val = @(z,b,bprime)(f_coh(z,b)-bprime)
pos = 3 ; key = f_cons_checkcmin ; val = @(fl_r_borr,z,b,bprime)((f_coh(fl_r_borr,z,b)-bprime).*((f_coh(fl_r_borr,z,b)-bprime)&gt;=fl_c_min)+fl_c_min.*((f_coh(fl_r_borr,z,b)-bprime)&lt;fl_c_min))
pos = 4 ; key = f_cons_coh ; val = @(coh,bprime)(coh-bprime)
pos = 5 ; key = f_inc ; val = @(fl_r_borr,z,b)(z*fl_w+(b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0)))
pos = 6 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 7 ; key = f_util_log ; val = @(c)log(c)
pos = 8 ; key = f_util_standin ; val = @(fl_r_borr,z,b)f_util_log(f_coh(fl_r_borr,z,b).*(f_coh(fl_r_borr,z,b)&gt;0)+fl_c_min.*(f_coh(fl_r_borr,z,b)&lt;=0))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                        i    idx    xFunction
                        _    ___    _________

    f_coh               1     1         1    
    f_cons              2     2         2    
    f_cons_checkcmin    3     3         3    
    f_cons_coh          4     4         4    
    f_inc               5     5         5    
    f_util_crra         6     6         6    
    f_util_log          7     7         7    
    f_util_standin      8     8         8    

</pre><h2 id="20">Display 5 result_map</h2><pre class="codeinput">    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: RESULT_MAP
----------------------------------------
  Map with properties:

        Count: 12
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_pol_diff_norm ;rown= 125 ,coln= 1
ar_pol_diff_norm :mu= 112.0079 ,sd= 607.1645 ,min= 0 ,max= 4830.2858
                   zi_1_c1
                   _______

    zi_1_R1         4490.1
    zi_2_R2         4830.3
    zi_63_R63      0.80854
    zi_124_r124          0
    zi_125_r125          0

pos = 2 ; key = ar_st_pol_names ; val = cl_mt_pol_a cl_mt_coh cl_mt_pol_c
pos = 3 ; key = ar_val_diff_norm ;rown= 125 ,coln= 1
ar_val_diff_norm :mu= 25.6719 ,sd= 67.1652 ,min= 0.055621 ,max= 418.7119
                   zi_1_c1 
                   ________

    zi_1_R1          418.71
    zi_2_R2          364.35
    zi_63_R63        2.2794
    zi_124_r124     0.05917
    zi_125_r125    0.055621

pos = 4 ; key = cl_mt_coh ;rown= 750 ,coln= 75
cl_mt_coh :mu= 16.7271 ,sd= 20.8998 ,min= -21.4553 ,max= 54.5358
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1        -20.055    -19.987     -19.991      -19.052      -18.614 
    zi_2_R2         -19.96    -19.891     -19.892      -18.949      -18.512 
    zi_375_r375     15.772      15.84      16.536       18.175       18.613 
    zi_749_r749     51.599     51.667      52.363       54.003        54.44 
    zi_750_r750     51.695     51.763      52.459       54.098       54.536 

pos = 5 ; key = cl_mt_pol_a ;rown= 750 ,coln= 75
cl_mt_pol_a :mu= 14.2969 ,sd= 19.5498 ,min= -20 ,max= 49.5327
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1             0          0           0          -20       -19.626 
    zi_2_R2             0          0           0          -20       -19.533 
    zi_375_r375    13.458     13.551      14.019       15.234        15.607 
    zi_749_r749     47.29      47.29      47.757       49.065        49.439 
    zi_750_r750    47.383     47.383       47.85       49.159        49.533 

pos = 6 ; key = cl_mt_pol_c ;rown= 750 ,coln= 75
cl_mt_pol_c :mu= 2.5726 ,sd= 1.2129 ,min= 0.01 ,max= 5.0031
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1          0.01       0.01        0.01       0.94838       1.012  
    zi_2_R2          0.01       0.01        0.01        1.0507      1.0208  
    zi_375_r375    2.3138     2.2887      2.5172        2.9418      3.0054  
    zi_749_r749    4.3092     4.3775       4.606        4.9372      5.0007  
    zi_750_r750    4.3115     4.3798      4.6083        4.9395      5.0031  

pos = 7 ; key = mt_pol_idx ;rown= 750 ,coln= 75
mt_pol_idx :mu= 367.977 ,sd= 209.1831 ,min= 1 ,max= 745
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1          215        215         215            1            5   
    zi_2_R2          215        215         215            1            6   
    zi_375_r375      359        360         365          378          382   
    zi_749_r749      721        721         726          740          744   
    zi_750_r750      722        722         727          741          745   

pos = 8 ; key = mt_pol_perc_change ;rown= 125 ,coln= 75
mt_pol_perc_change :mu= 0.20379 ,sd= 0.33392 ,min= 0 ,max= 1
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1              1         1             1           1           1  
    zi_2_R2        0.99867         1       0.99867           1           1  
    zi_63_R63        0.012     0.008     0.0093333    0.018667       0.016  
    zi_124_r124          0         0             0           0           0  
    zi_125_r125          0         0             0           0           0  

pos = 9 ; key = mt_val ;rown= 750 ,coln= 75
mt_val :mu= 5.54 ,sd= 8.6064 ,min= -17.7995 ,max= 15.025
                   zi_1_C1    zi_2_C2    zi_38_c38    zi_74_c74    zi_75_c75
                   _______    _______    _________    _________    _________

    zi_1_R1         -17.8     -17.487     -15.242      -12.309       -11.41 
    zi_2_R2         -17.8     -17.487     -15.242      -12.207      -11.313 
    zi_375_r375    7.6387      7.7628      8.7516       10.114       10.363 
    zi_749_r749    13.844      13.893      14.295         14.9       15.016 
    zi_750_r750    13.855      13.903      14.305       14.909       15.025 

pos = 10 ; key = tb_pol_a ;rown= 100 ,coln= 16
tb_pol_a :mu= 14.3933 ,sd= 31.6874 ,min= -20 ,max= 49.5327
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_15_c15    zi_16_c16
                   _______    _______    _______    _________    _________

    zi_1_R1              0          0        -20         -20      -19.626 
    zi_2_R2              0          0        -20         -20      -19.533 
    zi_50_R50      -17.103    -16.262    -15.888     -15.234      -14.766 
    zi_99_R99        47.29      47.29     47.757      49.065       49.439 
    zi_100_r100     47.383     47.383      47.85      49.159       49.533 

pos = 11 ; key = tb_val ;rown= 100 ,coln= 16
tb_val :mu= 0.50526 ,sd= 13.6875 ,min= -17.7995 ,max= 15.025
                   zi_1_C1    zi_2_C2    zi_8_C8    zi_15_c15    zi_16_c16
                   _______    _______    _______    _________    _________

    zi_1_R1          -17.8    -17.487      -14.7     -12.309       -11.41 
    zi_2_R2          -17.8    -17.487    -14.554     -12.207      -11.313 
    zi_50_R50      -13.895    -13.624     -11.36     -8.1839      -7.2743 
    zi_99_R99       13.844     13.893     14.295        14.9       15.016 
    zi_100_r100     13.855     13.903     14.305      14.909       15.025 

pos = 12 ; key = tb_valpol_alliter ;rown= 100 ,coln= 18
tb_valpol_alliter :mu= 9.7376 ,sd= 162.922 ,min= 0 ,max= 4830.2858
                   zi_1_C1     zi_2_C2    zi_9_C9    zi_17_c17    zi_18_c18
                   ________    _______    _______    _________    _________

    zi_1_R1          418.71    4490.1         1            1            1  
    zi_2_R2          364.35    4830.3         1            1            1  
    zi_50_R50         4.427    1.9035      0.04        0.056        0.052  
    zi_99_R99       0.05917         0         0            0            0  
    zi_100_r100    0.055621         0         0            0            0  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i     idx    rowN    colN     mean        std        min        max  
                          __    ___    ____    ____    _______    _______    ________    ______

    ar_pol_diff_norm       1     1     125       1      112.01     607.16           0    4830.3
    ar_val_diff_norm       2     3     125       1      25.672     67.165    0.055621    418.71
    cl_mt_coh              3     4     750      75      16.727       20.9     -21.455    54.536
    cl_mt_pol_a            4     5     750      75      14.297      19.55         -20    49.533
    cl_mt_pol_c            5     6     750      75      2.5726     1.2129        0.01    5.0031
    mt_pol_idx             6     7     750      75      367.98     209.18           1       745
    mt_pol_perc_change     7     8     125      75     0.20379    0.33392           0         1
    mt_val                 8     9     750      75        5.54     8.6064       -17.8    15.025
    tb_pol_a               9    10     100      16      14.393     31.687         -20    49.533
    tb_val                10    11     100      16     0.50526     13.688       -17.8    15.025
    tb_valpol_alliter     11    12     100      18      9.7376     162.92           0    4830.3

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                       i    idx
                       _    ___

    ar_st_pol_names    1     2 

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 12
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Solve Save + Borr (RShock) Dynamic Programming Problem (Optimized-Vectorized)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_abz_vf_vecsv(varargin)
%% FF_ABZ_VF_VECSV solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic single asset and two
% shocks problem with vectorized codes.
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html
% ff_abz_vf> shows looped codes.
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html
% ff_abz_vf_vec> shows vectorized codes. This file shows vectorized codes
% that is faster but is more memory intensive.
%
% The borrowing problem is similar to the savings problem. The main
% addition here in comparison to the savings only code
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html
% ff_az_vf_vec> is the ability to deal with default, as well as an
% additional shock to the borrowing interest rate.
%
% See
% <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html
% ff_az_vf_vec> how vectorization works within this structure.
%
% This _optimized-vectorized_ solution method provides very large speed
% improvements for this infinite horizon problem because the u(c(z,a,a'))
% calculation within each iteration is identical. Generally the idea is to
% identify inside iteration whether the model is infinite horizon or
% life-cycle based where repeat calculations are taking place. If such
% calculations can be identified, then potentially they could be stored and
% retrieved during future iterations/periods rather than recomputed every
% time. This saves time.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
%    % Get Default Parameters
%    it_param_set = 2;
%    [param_map, support_map] = ffs_abz_set_default_param(it_param_set);
%    % Chnage param_map keys for borrowing
%    param_map('fl_b_bd') = -20; % borrow bound
%    param_map('bl_default') = false; % true if allow for default
%    param_map('fl_c_min') = 0.0001; % u(c_min) when default
%    % Change Keys in param_map
%    param_map('it_a_n') = 500;
%    param_map('fl_z_r_borr_n') = 5;
%    param_map('it_z_wage_n') = 15;
%    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
%    param_map('fl_a_max') = 100;
%    param_map('fl_w') = 1.3;
%    % Change Keys support_map
%    support_map('bl_display') = false;
%    support_map('bl_post') = true;
%    support_map('bl_display_final') = false;
%    % Call Program with external parameters that override defaults.
%    ff_abz_vf_vecsv(param_map, support_map);
%
% @include
%
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_set_default_param.html ffs_abz_set_default_param>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_abz/paramfunc/html/ffs_abz_get_funcgrid.html ffs_abz_get_funcgrid>
% * <https://fanwangecon.github.io/CodeDynaAsset/m_az/solvepost/html/ff_az_vf_post.html ff_az_vf_post>
%
% @seealso
%
% * save loop: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html ff_az_vf>
% * save vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vec.html ff_az_vf_vec>
% * save optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf_vecsv.html ff_az_vf_vecsv>
% * save + borr loop: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf.html ff_abz_vf>
% * save + borr vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vec.html ff_abz_vf_vec>
% * save + borr optimized-vectorized: <https://fanwangecon.github.io/CodeDynaAsset/m_abz/solve/html/ff_abz_vf_vecsv.html ff_abz_vf_vecsv>
%

%% Default
%
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button
%

it_param_set = 4;
[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% Note: param_map and support_map can be adjusted here or outside to override defaults
% param_map('it_a_n') = 750;
% param_map('fl_z_r_borr_n') = 5;
% param_map('it_z_wage_n') = 15;
% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
% param_map('fl_r_save') = 0.025;
% param_map('fl_z_r_borr_poiss_mean') = 1.75;

[armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    [armt_map, func_map] = ffs_abz_get_funcgrid(param_map, support_map);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_abz_vf_vecsv';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_a', 'mt_z_trans', 'ar_z_r_borr_mesh_wage', 'ar_z_wage_mesh_r_borr'});
[ar_a, mt_z_trans, ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons_checkcmin', 'f_coh', 'f_cons_coh'});
[f_util_log, f_util_crra, f_cons_checkcmin, f_coh, f_cons_coh] = params_group{:};

% param_map
params_group = values(param_map, {'it_a_n', 'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min',...
    'fl_nan_replace', 'bl_default', 'fl_default_aprime'});
[it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min, ...
    fl_nan_replace, bl_default, fl_default_aprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display_defparam', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display_defparam, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% Initialize Output Matrixes
% include mt_pol_idx which we did not have in looped code

mt_val_cur = zeros(it_a_n, it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(it_a_n, it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_idx = zeros(it_a_n, it_z_n);

% We did not need these in ff_abz_vf or ff_abz_vf_vec
% see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why store using cells.
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Solve Optimization Problem Current Iteration
    % Only this segment of code differs between ff_abz_vf and ff_abz_vf_vec
    % Store in cells results and retrieve, this is more memory intensive
    % than ff_abz_vf_vec.

    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n

        % Current Shock
        fl_z_r_borr = ar_z_r_borr_mesh_wage(it_z_i);
        fl_z_wage = ar_z_wage_mesh_r_borr(it_z_i);

        % cash-on-hand
        ar_coh = f_coh(fl_z_r_borr, fl_z_wage, ar_a);

        % Consumption and u(c) only need to be evaluated once
        if (it_iter == 1)

            % Consumption: fl_z = 1 by 1, ar_a = 1 by N, ar_a' = N by 1
            % mt_c is N by N: matrix broadcasting, expand to matrix from arrays
            mt_c = f_cons_coh(ar_coh, ar_a');

            % EVAL current utility: N by N, f_util defined earlier
            % slightly faster to explicitly write function
            if (fl_crra == 1)
                mt_utility = log(mt_c);
                fl_u_cmin = f_util_log(fl_c_min);
            else
                % slightly faster if write function here directly, but
                % speed gain is very small, more important to have single
                % location control of functions.
                mt_utility = f_util_crra(mt_c);
                fl_u_cmin = f_util_crra(fl_c_min);
            end

            % Eliminate Complex Numbers
            mt_it_c_valid_idx = (mt_c <= fl_c_min);
            mt_utility(mt_it_c_valid_idx) = fl_u_cmin;

            % Store in cells
            cl_u_c_store{it_z_i} = mt_utility;
            cl_c_valid_idx{it_z_i} = mt_it_c_valid_idx;

        end

        % f(z'|z)
        ar_z_trans_condi = mt_z_trans(it_z_i,:);

        % EVAL EV((A',K'),Z'|Z) = V((A',K'),Z') x p(z'|z)', (N by Z) x (Z by 1) = N by 1
        % Note: transpose ar_z_trans_condi from 1 by Z to Z by 1
        % Note: matrix multiply not dot multiply
        mt_evzp_condi_z = mt_val_cur * ar_z_trans_condi';

        % EVAL add on future utility, N by N + N by 1
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_evzp_condi_z;

        % Index update
        % using the method below is much faster than index replace
        % see <https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        % Default or Not Utility Handling
        if (bl_default)
            % if default: only today u(cmin), transition out next period, debt wiped out
            fl_v_default = fl_u_cmin + fl_beta*mt_evzp_condi_z(ar_a == fl_default_aprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        else
            % if default is not allowed: v = u(cmin)
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        end

        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        % mt_utility is N by N, rows are choices, cols are states.
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);
        ar_opti_aprime_z = ar_a(ar_opti_idx_z);
        ar_opti_c_z = f_cons_coh(ar_coh, ar_opti_aprime_z);

        % Handle Default is optimal or not
        if (bl_default)
            % if defaulting is optimal choice, at these states, not required
            % to default, non-default possible, but default could be optimal
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = fl_default_aprime;
            ar_opti_idx_z(ar_opti_c_z <= fl_c_min) = find(ar_a == fl_default_aprime);
        else
            % if default is not allowed, then next period same state as now
            % this is absorbing state, this is the limiting case, single
            % state space point, lowest a and lowest shock has this.
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = ar_a(ar_opti_c_z <= fl_c_min);
        end

        % store optimal values
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;

        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_idx_z;
        end
    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); ...
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'Hval', 'Hap'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('Hval = mt_val_cur(it_a_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_a_n,:), highest a state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_idx') = mt_pol_idx;

result_map('cl_mt_coh') = {f_coh(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a'), zeros(1)};
result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_pol_c') = {f_cons_checkcmin(ar_z_r_borr_mesh_wage, ar_z_wage_mesh_r_borr, ar_a', mt_pol_a), zeros(1)};
result_map('ar_st_pol_names') = ["cl_mt_pol_a", "cl_mt_coh", "cl_mt_pol_c"];

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

%% Display Various Containers

if (bl_display_defparam)

    %% Display 1 support_map
    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 2 armt_map
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 3 param_map
    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 4 func_map
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 5 result_map
    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);

end

end

##### SOURCE END #####
--></body></html>