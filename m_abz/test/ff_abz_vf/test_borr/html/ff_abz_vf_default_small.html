
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_abz_vf_default_small</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-11"><meta name="DC.source" content="ff_abz_vf_default_small.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">ABZ_VF Algorithm Testing, Small Grids</a></li><li><a href="#2">Simulate Savinags only</a></li><li><a href="#3">Simulate Save/Borrow No Default</a></li><li><a href="#4">Simulate Save/Borrow, Can Default: cmin = 0.00001, choose not to default</a></li><li><a href="#5">Simulate Save/Borrow, Can Default: cmin = 0.001, default takes place</a></li><li><a href="#6">Simulate Save/Borrow, Can Default: cmin = 1, degenerate, borrow to max</a></li></ul></div><h2 id="1">ABZ_VF Algorithm Testing, Small Grids</h2><pre class="codeinput">close <span class="string">all</span>;

it_param_set = 1;

<span class="comment">% Shared parameters</span>
fl_a_max = 50;
it_a_n = 60;
fl_r_save = 0.025; <span class="comment">% 10 percent savings interest rate</span>
fl_r_borr = 0.035;
fl_w = 1;
it_maxiter_val = 1000;
it_z_n = 7;

<span class="comment">% Display Etc.</span>
bl_display = false;
bl_post = true;
bl_display_final = true;
</pre><h2 id="2">Simulate Savinags only</h2><p>for the output optimal choice matrix, look at each row, if the next period a at the lowest level of shock is below current a, that means there is nonzero chance of going to lower asset level from this point. Similarly for higher point. If at a current asset point, for all shock levels, next period a choice is equal or below current period asset level, this asset level will have zero probability in the stationary distribution. For the distribution to be non-degenerate, there must be no rows where a'(a,z) == a for all z. see <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html">ffs_abz_get_funcgrid_nodefault</a> for additional information.</p><pre class="codeinput">[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% control saving, borrowing, default</span>
param_map(<span class="string">'fl_b_bd'</span>) = 0;
param_map(<span class="string">'bl_default'</span>) = 0;

<span class="comment">% shared parameters</span>
param_map(<span class="string">'fl_a_min'</span>) = 0;
param_map(<span class="string">'fl_a_max'</span>) = fl_a_max;
param_map(<span class="string">'it_a_n'</span>) = it_a_n;
param_map(<span class="string">'fl_r_save'</span>) = fl_r_save;
param_map(<span class="string">'fl_r_borr'</span>) = fl_r_borr;
param_map(<span class="string">'fl_w'</span>) = fl_w;

<span class="comment">% solution</span>
param_map(<span class="string">'it_z_n'</span>) = it_z_n;
param_map(<span class="string">'it_maxiter_val'</span>) = it_maxiter_val;

<span class="comment">% Display Parameters</span>
support_map(<span class="string">'bl_display'</span>) = bl_display;
support_map(<span class="string">'bl_post'</span>) = bl_post;
support_map(<span class="string">'bl_display_final'</span>) = bl_display_final;

<span class="comment">% Call Program</span>
ff_abz_vf(param_map, support_map);
</pre><pre class="codeoutput">Warning: "C:\Users\fan\CodeDynaAsset\m_abz\test\ff_abz_vf\test_borr\html" not
found in path. 
Elapsed time is 1.226957 seconds.
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                  valgap      polgap        z1          z2          z3          z4          z5          z6          z7   
                __________    _______    ________    ________    ________    ________    ________    ________    ________

    iter=1           31.45     20.494           1           1           1           1           1           1           1
    iter=2          23.709     296.54     0.96667     0.96667     0.96667     0.98333     0.98333     0.98333     0.98333
    iter=3          19.289      98.43     0.93333     0.93333     0.93333     0.93333        0.95        0.95        0.95
    iter=4          16.101     49.574     0.88333     0.88333     0.88333     0.88333         0.9         0.9        0.95
    iter=5          13.637     30.254     0.81667     0.81667     0.81667        0.85     0.81667     0.83333     0.88333
    iter=6           11.66     20.399     0.73333     0.73333     0.73333     0.73333     0.73333        0.75     0.81667
    iter=7          10.037     14.696     0.63333     0.63333     0.63333     0.63333     0.63333        0.65         0.7
    iter=8          8.6829     11.312     0.51667     0.51667     0.51667     0.51667     0.51667     0.53333         0.6
    iter=9          7.5394     9.2392         0.4         0.4         0.4     0.41667     0.36667     0.41667     0.46667
    iter=10         6.5663     8.2216     0.33333     0.33333     0.33333     0.33333     0.33333        0.35     0.38333
    iter=11         5.7322     6.9111        0.25        0.25        0.25        0.25     0.26667        0.25     0.31667
    iter=12         5.0095     6.5453         0.2     0.23333     0.23333     0.23333     0.16667        0.25     0.21667
    iter=13         4.3865     5.2113        0.15        0.15     0.16667     0.16667     0.18333     0.16667     0.23333
    iter=14         3.8451     4.8264     0.11667     0.13333     0.16667     0.16667        0.15     0.16667     0.16667
    iter=15         3.3667     4.2955     0.11667     0.13333        0.15        0.15     0.11667        0.15     0.11667
    iter=16         2.9546     3.1411    0.083333         0.1         0.1         0.1         0.1         0.1     0.13333
    iter=17         2.5943     2.8704    0.066667    0.066667    0.083333         0.1         0.1         0.1     0.13333
    iter=18         2.2743     2.5033        0.05    0.066667    0.083333         0.1         0.1    0.066667         0.1
    iter=19          1.992     2.1659        0.05        0.05    0.066667         0.1        0.05    0.083333        0.05
    iter=20         1.7445      1.895        0.05        0.05    0.066667    0.083333        0.05    0.066667    0.066667
    iter=21         1.5298     2.1708        0.05    0.033333    0.066667        0.05        0.05    0.083333    0.066667
    iter=22         1.3418     1.9392        0.05    0.066667    0.033333        0.05        0.05    0.066667    0.066667
    iter=23         1.1736     1.6949        0.05        0.05    0.033333    0.066667        0.05    0.016667    0.033333
    iter=24         1.0238     1.6949        0.05    0.033333    0.016667    0.016667    0.033333    0.033333    0.066667
    iter=25         0.8919     1.4678    0.016667    0.016667    0.033333    0.033333        0.05    0.016667        0.05
    iter=26        0.77683     1.5659    0.016667           0    0.016667    0.033333        0.05    0.033333        0.05
    iter=27        0.67681     1.1985    0.016667    0.033333    0.016667    0.033333    0.033333    0.016667           0
    iter=28        0.58999     1.4678    0.016667    0.016667    0.016667    0.033333        0.05    0.033333    0.016667
    iter=29        0.51444     1.3712    0.016667    0.016667    0.033333    0.033333           0    0.016667    0.016667
    iter=30        0.44859     1.1985    0.016667    0.016667           0    0.016667    0.016667    0.016667    0.033333
    iter=31        0.39138    0.84746    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667
    iter=32        0.34151     1.1985           0           0    0.016667    0.033333    0.016667    0.033333           0
    iter=33        0.29796    0.84746    0.016667    0.016667    0.016667           0           0           0    0.016667
    iter=34        0.26003     1.1985    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667
    iter=35        0.22727    0.84746           0    0.016667           0    0.016667           0    0.016667           0
    iter=36        0.19937     1.1985    0.016667           0    0.016667    0.033333    0.033333    0.016667    0.016667
    iter=37        0.17612    0.84746           0    0.016667    0.016667    0.016667           0           0    0.016667
    iter=38        0.15718    0.84746    0.016667           0           0           0    0.016667    0.016667           0
    iter=39        0.14211    0.84746           0    0.016667    0.016667           0           0    0.016667    0.016667
    iter=40        0.13035    0.84746           0           0           0           0    0.016667    0.016667           0
    iter=41        0.12116     1.1985           0    0.016667    0.033333           0           0    0.016667    0.016667
    iter=42        0.11394    0.84746    0.016667           0           0           0           0    0.016667           0
    iter=43        0.10811    0.84746           0           0    0.016667           0           0           0           0
    iter=44        0.10323    0.84746           0           0           0           0           0    0.016667    0.016667
    iter=45       0.098924    0.84746           0           0           0           0           0           0    0.016667
    iter=46       0.094946    0.84746           0    0.016667    0.016667           0    0.016667           0           0
    iter=47       0.091161    0.84746           0           0           0           0           0    0.016667           0
    iter=48       0.087486    0.84746           0           0           0           0           0           0    0.016667
    iter=49       0.083876    0.84746    0.016667           0           0           0           0           0           0
    iter=50       0.080319          0           0           0           0           0           0           0           0
    iter=150    0.00020411          0           0           0           0           0           0           0           0
    iter=151    0.00019186          0           0           0           0           0           0           0           0
    iter=152    0.00018035          0           0           0           0           0           0           0           0
    iter=153    0.00016953          0           0           0           0           0           0           0           0
    iter=154    0.00015936          0           0           0           0           0           0           0           0
    iter=155     0.0001498          0           0           0           0           0           0           0           0
    iter=156    0.00014081          0           0           0           0           0           0           0           0
    iter=157    0.00013236          0           0           0           0           0           0           0           0
    iter=158    0.00012442          0           0           0           0           0           0           0           0
    iter=159    0.00011696          0           0           0           0           0           0           0           0
    iter=160    0.00010994          0           0           0           0           0           0           0           0
    iter=161    0.00010334          0           0           0           0           0           0           0           0
    iter=162    9.7144e-05          0           0           0           0           0           0           0           0
    iter=163    9.1316e-05          0           0           0           0           0           0           0           0
    iter=164    8.5837e-05          0           0           0           0           0           0           0           0
    iter=165    8.0687e-05          0           0           0           0           0           0           0           0
    iter=166    7.5846e-05          0           0           0           0           0           0           0           0
    iter=167    7.1296e-05          0           0           0           0           0           0           0           0
    iter=168    6.7018e-05          0           0           0           0           0           0           0           0
    iter=169    6.2997e-05          0           0           0           0           0           0           0           0
    iter=170    5.9217e-05          0           0           0           0           0           0           0           0
    iter=171    5.5664e-05          0           0           0           0           0           0           0           0
    iter=172    5.2325e-05          0           0           0           0           0           0           0           0
    iter=173    4.9185e-05          0           0           0           0           0           0           0           0
    iter=174    4.6234e-05          0           0           0           0           0           0           0           0
    iter=175     4.346e-05          0           0           0           0           0           0           0           0
    iter=176    4.0853e-05          0           0           0           0           0           0           0           0
    iter=177    3.8401e-05          0           0           0           0           0           0           0           0
    iter=178    3.6097e-05          0           0           0           0           0           0           0           0
    iter=179    3.3932e-05          0           0           0           0           0           0           0           0
    iter=180    3.1896e-05          0           0           0           0           0           0           0           0
    iter=181    2.9982e-05          0           0           0           0           0           0           0           0
    iter=182    2.8183e-05          0           0           0           0           0           0           0           0
    iter=183    2.6492e-05          0           0           0           0           0           0           0           0
    iter=184    2.4903e-05          0           0           0           0           0           0           0           0
    iter=185    2.3408e-05          0           0           0           0           0           0           0           0
    iter=186    2.2004e-05          0           0           0           0           0           0           0           0
    iter=187    2.0684e-05          0           0           0           0           0           0           0           0
    iter=188    1.9443e-05          0           0           0           0           0           0           0           0
    iter=189    1.8276e-05          0           0           0           0           0           0           0           0
    iter=190     1.718e-05          0           0           0           0           0           0           0           0
    iter=191    1.6149e-05          0           0           0           0           0           0           0           0
    iter=192     1.518e-05          0           0           0           0           0           0           0           0
    iter=193    1.4269e-05          0           0           0           0           0           0           0           0
    iter=194    1.3413e-05          0           0           0           0           0           0           0           0
    iter=195    1.2608e-05          0           0           0           0           0           0           0           0
    iter=196    1.1852e-05          0           0           0           0           0           0           0           0
    iter=197    1.1141e-05          0           0           0           0           0           0           0           0
    iter=198    1.0472e-05          0           0           0           0           0           0           0           0
    iter=199    9.8439e-06          0           0           0           0           0           0           0           0

tb_val
                   z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                   __________    __________    __________    __________    _________    _________    _________

    a1=0               -6.46       -4.7322       -3.1017       -1.6231     -0.28345      0.94796      2.2797  
    a2=0.847458      -4.8657       -3.5674       -2.2703      -0.95867      0.29411       1.4658      2.7244  
    a3=1.69492        -3.601       -2.5734       -1.4885      -0.33268      0.83963       1.9554       3.144  
    a4=2.54237       -2.5544       -1.7004      -0.76424       0.25086       1.3501       2.4148      3.5422  
    a5=3.38983       -1.6576      -0.92121     -0.097369       0.79304       1.8266       2.8458      3.9266  
    a6=4.23729      -0.86982      -0.21863       0.51584        1.3183       2.2874       3.2626      4.2964  
    a7=5.08475      -0.16615       0.42015        1.0864        1.8249       2.7313       3.6643      4.6507  
    a8=5.9322        0.47025        1.0068        1.6212        2.3095       3.1564       4.0492      4.9894  
    a9=6.77966        1.0522        1.5503        2.1242        2.7711       3.5621       4.4169      5.3131  
    a10=7.62712       1.5894        2.0572        2.5986          3.21       3.9488        4.768      5.6225  
    a11=8.47458       2.0891        2.5325        3.0466        3.6269       4.3171       5.1029      5.9188  
    a12=9.32203       2.5566        2.9796        3.4705         4.023       4.6681       5.4226      6.2032  
    a13=10.1695       2.9961        3.4016         3.872        4.3992       5.0027       5.7282      6.4776  
    a14=11.0169       3.4107        3.8008        4.2528         4.757       5.3219       6.0208      6.7454  
    a15=11.8644       3.8028        4.1791        4.6144        5.0974        5.635       6.3068      7.0055  
    a16=12.7119       4.1745        4.5382        4.9583        5.4232       5.9398       6.5851      7.2574  
    a17=13.5593       4.5276        4.8797        5.2862        5.7357        6.235       6.8545      7.5011  
    a18=14.4068       4.8635        5.2052        5.5996        6.0359       6.5201       7.1149       7.737  
    a19=15.2542       5.1838        5.5161        5.8998        6.3243        6.795       7.3664      7.9658  
    a20=16.1017       5.4986        5.8135        6.1876        6.6016       7.0601       7.6094      8.1888  
    a21=16.9492       5.7995        6.0992        6.4639        6.8684       7.3155       7.8443      8.4087  
    a22=17.7966        6.091        6.3749        6.7296        7.1252       7.5617       8.0712      8.6216  
    a23=18.6441       6.3706        6.6452        6.9855        7.3726       7.7992       8.2903      8.8274  
    a24=19.4915       6.6408        6.9059        7.2326         7.611       8.0282       8.5019      9.0262  
    a25=20.339         6.903        7.1593        7.4712        7.8411       8.2493       8.7064      9.2185  
    a26=21.1864       7.1563         7.404        7.7019        8.0634       8.4627       8.9041      9.4046  
    a27=22.0339       7.4023        7.6411        7.9285        8.2783        8.669       9.0955      9.5848  
    a28=22.8814       7.6399        7.8704        8.1487        8.4867       8.8686       9.2832      9.7613  
    a29=23.7288       7.8708        8.0938        8.3635         8.689       9.0623       9.4676      9.9345  
    a30=24.5763        8.094        8.3103        8.5722        8.8856       9.2505       9.6479      10.104  
    a31=25.4237       8.3114        8.5214        8.7755        9.0768       9.4337       9.8237      10.269  
    a32=26.2712        8.522        8.7263        8.9729        9.2629       9.6121       9.9951       10.43  
    a33=27.1186       8.7273         8.926        9.1654        9.4441       9.7858       10.162      10.587  
    a34=27.9661       8.9264        9.1199        9.3524         9.623       9.9551       10.325       10.74  
    a35=28.8136       9.1206         9.309        9.5347        9.7975       10.121       10.484       10.89  
    a36=29.661        9.3091        9.4928        9.7127        9.9689       10.283       10.639      11.036  
    a37=30.5085       9.4931         9.672        9.8863        10.136       10.441       10.791      11.179  
    a38=31.3559       9.6719        9.8467        10.056          10.3       10.596       10.939      11.319  
    a39=32.2034       9.8464        10.017        10.222         10.46       10.748       11.084      11.456  
    a40=33.0508       10.016        10.184        10.384        10.617       10.897       11.226       11.59  
    a41=33.8983       10.182        10.346        10.542         10.77       11.042       11.366      11.722  
    a42=34.7458       10.344        10.505        10.697         10.92       11.184       11.502      11.851  
    a43=35.5932       10.502         10.66        10.848        11.067       11.324       11.636      11.977  
    a44=36.4407       10.657        10.811        10.996        11.211        11.46       11.767      12.101  
    a45=37.2881       10.808        10.959        11.141        11.351       11.595       11.895      12.223  
    a46=38.1356       10.955        11.104        11.283        11.489       11.727       12.021      12.342  
    a47=38.9831       11.099        11.246        11.421        11.624       11.857       12.144      12.459  
    a48=39.8305        11.24        11.385        11.557        11.756       11.985       12.266      12.575  
    a49=40.678        11.378         11.52         11.69        11.885       12.111       12.386      12.688  
    a50=41.5254       11.514        11.653         11.82        12.013       12.234       12.503        12.8  
    a51=42.3729       11.647        11.784        11.948        12.137       12.355       12.619       12.91  
    a52=43.2203       11.778        11.911        12.073         12.26       12.474       12.733      13.018  
    a53=44.0678       11.906        12.036        12.196         12.38       12.591       12.844      13.125  
    a54=44.9153       12.032        12.159        12.316        12.498       12.706       12.954       13.23  
    a55=45.7627       12.156         12.28        12.434        12.613       12.819       13.062      13.334  
    a56=46.6102       12.278        12.399         12.55        12.727        12.93       13.168      13.437  
    a57=47.4576       12.397        12.516        12.664        12.838       13.038       13.273      13.538  
    a58=48.3051       12.514        12.632        12.776        12.948       13.145       13.375      13.637  
    a59=49.1525       12.629        12.745        12.885        13.055        13.25       13.476      13.734  
    a60=50            12.743        12.856        12.993        13.161       13.353       13.575       13.83  

tb_pol_a
                   z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                   __________    __________    __________    __________    _________    _________    _________

    a1=0                  0             0             0             0             0            0      0.84746 
    a2=0.847458           0             0             0       0.84746       0.84746      0.84746       1.6949 
    a3=1.69492      0.84746       0.84746       0.84746        1.6949        1.6949       1.6949       2.5424 
    a4=2.54237       1.6949        1.6949        1.6949        2.5424        2.5424       2.5424       3.3898 
    a5=3.38983       2.5424        2.5424        2.5424        3.3898        3.3898       3.3898       4.2373 
    a6=4.23729       3.3898        3.3898        3.3898        3.3898        4.2373       4.2373       5.0847 
    a7=5.08475       4.2373        4.2373        4.2373        4.2373        5.0847       5.0847       5.9322 
    a8=5.9322        5.0847        5.0847        5.0847        5.0847        5.9322       5.9322       6.7797 
    a9=6.77966       5.9322        5.9322        5.9322        5.9322        6.7797       6.7797       7.6271 
    a10=7.62712      6.7797        6.7797        6.7797        6.7797        7.6271       7.6271       8.4746 
    a11=8.47458      7.6271        7.6271        7.6271        7.6271        8.4746       8.4746        9.322 
    a12=9.32203      8.4746        8.4746        8.4746        8.4746         9.322        9.322       10.169 
    a13=10.1695       9.322         9.322         9.322         9.322        10.169       10.169       11.017 
    a14=11.0169      10.169        10.169        10.169        10.169        11.017       11.017       11.864 
    a15=11.8644      11.017        11.017        11.017        11.017        11.017       11.864       12.712 
    a16=12.7119      11.864        11.864        11.864        11.864        11.864       12.712       13.559 
    a17=13.5593      12.712        12.712        12.712        12.712        12.712       13.559       14.407 
    a18=14.4068      13.559        13.559        13.559        13.559        13.559       14.407       15.254 
    a19=15.2542      14.407        14.407        14.407        14.407        14.407       15.254       16.102 
    a20=16.1017      14.407        15.254        15.254        15.254        15.254       16.102       16.949 
    a21=16.9492      15.254        16.102        16.102        16.102        16.102       16.949       16.949 
    a22=17.7966      16.102        16.102        16.949        16.949        16.949       17.797       17.797 
    a23=18.6441      16.949        16.949        17.797        17.797        17.797       18.644       18.644 
    a24=19.4915      17.797        17.797        18.644        18.644        18.644       19.492       19.492 
    a25=20.339       18.644        18.644        19.492        19.492        19.492       20.339       20.339 
    a26=21.1864      19.492        19.492        20.339        20.339        20.339       21.186       21.186 
    a27=22.0339      20.339        20.339        20.339        21.186        21.186       22.034       22.034 
    a28=22.8814      21.186        21.186        21.186        22.034        22.034       22.034       22.881 
    a29=23.7288      22.034        22.034        22.034        22.881        22.881       22.881       23.729 
    a30=24.5763      22.881        22.881        22.881        23.729        23.729       23.729       24.576 
    a31=25.4237      23.729        23.729        23.729        24.576        24.576       24.576       25.424 
    a32=26.2712      24.576        24.576        24.576        25.424        25.424       25.424       26.271 
    a33=27.1186      25.424        25.424        25.424        26.271        26.271       26.271       27.119 
    a34=27.9661      26.271        26.271        26.271        26.271        27.119       27.119       27.966 
    a35=28.8136      27.119        27.119        27.119        27.119        27.966       27.966       28.814 
    a36=29.661       27.966        27.966        27.966        27.966        28.814       28.814       29.661 
    a37=30.5085      28.814        28.814        28.814        28.814        29.661       29.661       30.508 
    a38=31.3559      29.661        29.661        29.661        29.661        30.508       30.508       31.356 
    a39=32.2034      30.508        30.508        30.508        30.508        31.356       31.356       32.203 
    a40=33.0508      31.356        31.356        31.356        31.356        32.203       32.203       33.051 
    a41=33.8983      32.203        32.203        32.203        32.203        33.051       33.051       33.898 
    a42=34.7458      33.051        33.051        33.051        33.051        33.898       33.898       34.746 
    a43=35.5932      33.898        33.898        33.898        33.898        34.746       34.746       35.593 
    a44=36.4407      34.746        34.746        34.746        34.746        35.593       35.593       36.441 
    a45=37.2881      35.593        35.593        35.593        35.593        35.593       36.441       37.288 
    a46=38.1356      36.441        36.441        36.441        36.441        36.441       37.288       38.136 
    a47=38.9831      37.288        37.288        37.288        37.288        37.288       38.136       38.983 
    a48=39.8305      38.136        38.136        38.136        38.136        38.136       38.983       39.831 
    a49=40.678       38.983        38.983        38.983        38.983        38.983       39.831       40.678 
    a50=41.5254      39.831        39.831        39.831        39.831        39.831       40.678       41.525 
    a51=42.3729      39.831        40.678        40.678        40.678        40.678       41.525       42.373 
    a52=43.2203      40.678        41.525        41.525        41.525        41.525       42.373       42.373 
    a53=44.0678      41.525        42.373        42.373        42.373        42.373        43.22        43.22 
    a54=44.9153      42.373         43.22         43.22         43.22         43.22       44.068       44.068 
    a55=45.7627       43.22         43.22        44.068        44.068        44.068       44.915       44.915 
    a56=46.6102      44.068        44.068        44.915        44.915        44.915       45.763       45.763 
    a57=47.4576      44.915        44.915        45.763        45.763        45.763        46.61        46.61 
    a58=48.3051      45.763        45.763         46.61         46.61         46.61       47.458       47.458 
    a59=49.1525       46.61         46.61        47.458        47.458        47.458       48.305       48.305 
    a60=50           47.458        47.458        47.458        48.305        48.305       49.153       49.153 

</pre><h2 id="3">Simulate Save/Borrow No Default</h2><p>See each asset state row, if for negative asset levels, at all levels of shocks, a'(a,z) &gt;= a for all a &lt;0 for all z, that means there will be no borrowing in the stationary distribution. Similarly if a'(a,z) &lt;= a for all a &gt; 0 and all z, there will be no savings in the stationary distribution. For the distribution to be non-degenerate, there must be no rows where a'(a,z) == a for all z.</p><pre class="codeinput">[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% allow for borrowing, when using a very large negative value for fl_b_bd</span>
<span class="comment">% that means the natural borrowing constraint will bind.</span>
param_map(<span class="string">'fl_b_bd'</span>) = -100;
param_map(<span class="string">'bl_default'</span>) = 0;

<span class="comment">% shared parameters</span>
param_map(<span class="string">'fl_a_min'</span>) = 0;
param_map(<span class="string">'fl_a_max'</span>) = fl_a_max;
param_map(<span class="string">'it_a_n'</span>) = it_a_n;
param_map(<span class="string">'fl_r_save'</span>) = fl_r_save;
param_map(<span class="string">'fl_r_borr'</span>) = fl_r_borr;
param_map(<span class="string">'fl_w'</span>) = fl_w;

<span class="comment">% solution</span>
param_map(<span class="string">'it_z_n'</span>) = it_z_n;
param_map(<span class="string">'it_maxiter_val'</span>) = it_maxiter_val;

<span class="comment">% Display Parameters</span>
support_map(<span class="string">'bl_display'</span>) = bl_display;
support_map(<span class="string">'bl_post'</span>) = bl_post;
support_map(<span class="string">'bl_display_final'</span>) = bl_display_final;


<span class="comment">% Call Program</span>
ff_abz_vf(param_map, support_map);
</pre><pre class="codeoutput">Elapsed time is 1.444138 seconds.
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                  valgap      polgap       z1          z2          z3          z4          z5          z6          z7   
                __________    ______    ________    ________    ________    ________    ________    ________    ________

    iter=1            9999    182.36      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167
    iter=2          630.61     355.3           1           1           1           1           1           1           1
    iter=3          315.91    118.02        0.95     0.96667     0.96667     0.96667     0.96667     0.96667     0.96667
    iter=4          193.96    59.497         0.9         0.9     0.88333     0.91667     0.91667     0.91667     0.93333
    iter=5          136.32     35.77        0.85        0.85     0.86667     0.81667        0.85        0.85     0.91667
    iter=6          104.86    24.577     0.71667        0.75        0.75     0.78333     0.78333     0.76667     0.78333
    iter=7          85.682    17.331     0.63333         0.6     0.61667        0.65     0.63333     0.66667     0.71667
    iter=8            72.8     13.56     0.51667     0.51667        0.55         0.5     0.51667     0.53333         0.6
    iter=9          63.389    11.248         0.4         0.4         0.4     0.38333     0.38333     0.41667        0.45
    iter=10         56.037    10.147        0.35     0.36667     0.33333     0.36667     0.33333        0.35     0.36667
    iter=11         50.006    8.1879     0.26667     0.26667     0.26667     0.26667     0.31667        0.25     0.28333
    iter=12         44.884    7.8515     0.21667     0.23333        0.25     0.26667     0.16667     0.26667     0.31667
    iter=13         40.439    6.2364     0.16667        0.15     0.16667        0.15         0.2         0.2         0.2
    iter=14         36.524    6.2789     0.16667     0.16667     0.16667        0.15        0.15     0.16667     0.18333
    iter=15         33.041    5.8713     0.13333        0.15     0.13333        0.15     0.11667     0.16667     0.13333
    iter=16         29.925    4.9029     0.13333         0.1         0.1         0.1     0.11667         0.1     0.11667
    iter=17         27.124     4.544    0.066667         0.1     0.11667         0.1     0.11667         0.1     0.13333
    iter=18         24.598    4.0808    0.066667         0.1         0.1         0.1         0.1    0.066667     0.11667
    iter=19         22.317    3.4637         0.1        0.05         0.1    0.066667    0.066667         0.1    0.083333
    iter=20         20.253    3.6883    0.083333         0.1    0.083333    0.083333    0.033333    0.083333    0.066667
    iter=21         18.385    3.2414        0.05    0.083333        0.05        0.05    0.066667         0.1        0.05
    iter=22         16.692    2.5433    0.066667        0.05    0.033333        0.05        0.05    0.066667        0.05
    iter=23         15.157    2.4459    0.033333    0.033333        0.05        0.05        0.05    0.033333    0.083333
    iter=24         13.765    2.1033    0.016667    0.033333        0.05        0.05    0.033333    0.033333    0.066667
    iter=25         12.502    2.0706    0.016667    0.016667        0.05        0.05        0.05        0.05    0.033333
    iter=26         11.357     2.028        0.05        0.05    0.033333    0.033333        0.05    0.016667    0.066667
    iter=27         10.318     2.028    0.016667           0        0.05    0.066667        0.05    0.033333        0.05
    iter=28         9.3746    1.7563    0.016667        0.05    0.016667        0.05    0.016667    0.016667    0.033333
    iter=29         8.5191    1.7563    0.033333    0.016667        0.05    0.033333    0.016667    0.033333    0.033333
    iter=30         7.7428    1.7563           0    0.033333    0.016667        0.05    0.016667    0.033333    0.033333
    iter=31         7.0383     1.434    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667
    iter=32         6.3989     1.434    0.016667           0    0.033333    0.016667    0.033333    0.033333           0
    iter=33         5.8185    1.9287    0.016667    0.033333    0.033333    0.016667           0        0.05    0.033333
    iter=34         5.2917     1.434    0.016667    0.016667    0.033333           0    0.016667           0    0.016667
    iter=35         4.8134     1.014    0.016667           0           0    0.016667    0.016667    0.016667    0.016667
    iter=36         4.3792    1.7563    0.016667    0.033333    0.016667    0.016667    0.016667    0.033333           0
    iter=37         3.9851     1.014           0    0.016667    0.016667    0.016667           0           0    0.016667
    iter=38         3.6274     1.434    0.033333           0    0.016667    0.016667    0.016667    0.016667    0.016667
    iter=39         3.3027     1.434    0.016667    0.016667           0           0    0.016667    0.033333           0
    iter=40         3.0079     1.434           0    0.016667    0.016667    0.016667    0.016667           0    0.033333
    iter=41         2.7403     1.434    0.016667    0.016667           0    0.016667           0    0.016667    0.016667
    iter=42         2.4974     1.014    0.016667    0.016667           0           0    0.016667    0.016667    0.016667
    iter=43         2.2768     1.014    0.016667    0.016667           0    0.016667    0.016667           0           0
    iter=44         2.0765     1.014           0           0           0    0.016667    0.016667           0    0.016667
    iter=45         1.8947     1.014    0.016667           0    0.016667           0    0.016667    0.016667           0
    iter=46         1.7295     1.014    0.016667           0           0           0           0           0    0.016667
    iter=47         1.5794     1.014           0           0           0    0.016667    0.016667           0    0.016667
    iter=48          1.443         0           0           0           0           0           0           0           0
    iter=49         1.3191     1.014    0.016667           0           0           0    0.016667           0    0.016667
    iter=50         1.2064         0           0           0           0           0           0           0           0
    iter=182    0.00019951         0           0           0           0           0           0           0           0
    iter=183    0.00018759         0           0           0           0           0           0           0           0
    iter=184    0.00017637         0           0           0           0           0           0           0           0
    iter=185    0.00016583         0           0           0           0           0           0           0           0
    iter=186    0.00015591         0           0           0           0           0           0           0           0
    iter=187    0.00014659         0           0           0           0           0           0           0           0
    iter=188    0.00013783         0           0           0           0           0           0           0           0
    iter=189    0.00012959         0           0           0           0           0           0           0           0
    iter=190    0.00012184         0           0           0           0           0           0           0           0
    iter=191    0.00011455         0           0           0           0           0           0           0           0
    iter=192     0.0001077         0           0           0           0           0           0           0           0
    iter=193    0.00010126         0           0           0           0           0           0           0           0
    iter=194      9.52e-05         0           0           0           0           0           0           0           0
    iter=195    8.9506e-05         0           0           0           0           0           0           0           0
    iter=196    8.4151e-05         0           0           0           0           0           0           0           0
    iter=197    7.9117e-05         0           0           0           0           0           0           0           0
    iter=198    7.4383e-05         0           0           0           0           0           0           0           0
    iter=199    6.9933e-05         0           0           0           0           0           0           0           0
    iter=200    6.5748e-05         0           0           0           0           0           0           0           0
    iter=201    6.1814e-05         0           0           0           0           0           0           0           0
    iter=202    5.8115e-05         0           0           0           0           0           0           0           0
    iter=203    5.4637e-05         0           0           0           0           0           0           0           0
    iter=204    5.1367e-05         0           0           0           0           0           0           0           0
    iter=205    4.8293e-05         0           0           0           0           0           0           0           0
    iter=206    4.5402e-05         0           0           0           0           0           0           0           0
    iter=207    4.2685e-05         0           0           0           0           0           0           0           0
    iter=208    4.0129e-05         0           0           0           0           0           0           0           0
    iter=209    3.7727e-05         0           0           0           0           0           0           0           0
    iter=210    3.5469e-05         0           0           0           0           0           0           0           0
    iter=211    3.3345e-05         0           0           0           0           0           0           0           0
    iter=212    3.1349e-05         0           0           0           0           0           0           0           0
    iter=213    2.9472e-05         0           0           0           0           0           0           0           0
    iter=214    2.7707e-05         0           0           0           0           0           0           0           0
    iter=215    2.6048e-05         0           0           0           0           0           0           0           0
    iter=216    2.4488e-05         0           0           0           0           0           0           0           0
    iter=217    2.3022e-05         0           0           0           0           0           0           0           0
    iter=218    2.1643e-05         0           0           0           0           0           0           0           0
    iter=219    2.0347e-05         0           0           0           0           0           0           0           0
    iter=220    1.9128e-05         0           0           0           0           0           0           0           0
    iter=221    1.7983e-05         0           0           0           0           0           0           0           0
    iter=222    1.6906e-05         0           0           0           0           0           0           0           0
    iter=223    1.5893e-05         0           0           0           0           0           0           0           0
    iter=224    1.4941e-05         0           0           0           0           0           0           0           0
    iter=225    1.4046e-05         0           0           0           0           0           0           0           0
    iter=226    1.3205e-05         0           0           0           0           0           0           0           0
    iter=227    1.2414e-05         0           0           0           0           0           0           0           0
    iter=228     1.167e-05         0           0           0           0           0           0           0           0
    iter=229    1.0971e-05         0           0           0           0           0           0           0           0
    iter=230    1.0314e-05         0           0           0           0           0           0           0           0
    iter=231    9.6957e-06         0           0           0           0           0           0           0           0

tb_val
                     z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                     __________    __________    __________    __________    _________    _________    _________

    a1=-9.82487          -9999       -1762.3       -767.26       -475.21      -307.94      -8.1817      -5.2722 
    a2=-8.81089        -32.612       -20.746       -15.305       -11.792      -9.1338      -6.7605      -4.1305 
    a3=-7.79691        -23.916       -17.051       -12.859       -9.8795      -7.5399      -5.5059      -3.0872 
    a4=-6.78293        -18.452        -14.29       -10.898       -8.2961      -6.1863      -4.3578      -2.1225 
    a5=-5.76895        -14.775       -11.988       -9.2066       -6.9026      -4.9745       -3.279      -1.2465 
    a6=-4.75497        -12.061       -9.9727        -7.706       -5.6539      -3.8832      -2.3043     -0.44686 
    a7=-3.74099        -9.8877       -8.2295       -6.3772       -4.5358      -2.9004      -1.4225      0.29154 
    a8=-2.72701        -8.0743       -6.7176       -5.1939       -3.5286      -2.0098     -0.61886      0.98605 
    a9=-1.71303        -6.5265        -5.396       -4.1243       -2.6098      -1.1925      0.12377       1.6565 
    a10=-0.699046      -5.1843       -4.2267       -3.1179       -1.7316     -0.39176      0.91797       2.2131 
    a11=0              -4.2514       -3.3793        -2.348       -1.1005      0.15493       1.3774       2.5047 
    a12=0.314935        -3.916       -3.0036       -1.9547      -0.81202        0.387       1.5283       2.7071 
    a13=1.32892        -2.8245       -2.0353       -1.1371      -0.14122      0.97705       2.0608       3.1721 
    a14=2.3429         -1.8583       -1.1701      -0.38372       0.48216       1.5279       2.5603       3.6203 
    a15=3.35688       -0.99619      -0.38728       0.30965        1.0861       2.0603       3.0429         4.05 
    a16=4.37086       -0.21921       0.32691       0.95553        1.6661       2.5713       3.5064       4.4608 
    a17=5.38484        0.48748        0.9846         1.561        2.2193       3.0594       3.9494       4.8529 
    a18=6.39882         1.1361         1.595        2.1303        2.7452       3.5242       4.3719        5.227 
    a19=7.4128          1.7362        2.1648        2.6668        3.2445       3.9664       4.7744       5.5842 
    a20=8.42678         2.2952        2.6991        3.1732         3.718       4.3871       5.1579       5.9256 
    a21=9.44076         2.8185        3.2018        3.6518        4.1672       4.7873       5.5235        6.253 
    a22=10.4547         3.3103        3.6759        4.1047        4.5935       5.1683       5.8724       6.5685 
    a23=11.4687         3.7739        4.1239        4.5338        4.9982       5.5313       6.2061       6.8759 
    a24=12.4827         4.2121        4.5481        4.9407        5.3828       5.8837       6.5299       7.1769 
    a25=13.4967         4.6271        4.9503        5.3272        5.7497       6.2272       6.8454       7.4723 
    a26=14.5107         5.0207        5.3323        5.6951        6.1011       6.5597       7.1509       7.7585 
    a27=15.5246         5.3948        5.6957        6.0461        6.4381       6.8806       7.4459       8.0349 
    a28=16.5386         5.7508        6.0422        6.3815        6.7614       7.1897       7.7304       8.3017 
    a29=17.5526         6.0903        6.3731        6.7027        7.0717       7.4873       8.0045       8.5589 
    a30=18.5666         6.4147        6.6898        7.0106        7.3698       7.7737       8.2685       8.8068 
    a31=19.5806         6.7251        6.9932        7.3059        7.6563       8.0493        8.523       9.0459 
    a32=20.5946         7.0227        7.2842        7.5896        7.9317       8.3145       8.7682       9.2765 
    a33=21.6085         7.3122        7.5638        7.8623        8.1967       8.5698       9.0047        9.499 
    a34=22.6225          7.593        7.8328        8.1247        8.4518       8.8158       9.2327       9.7137 
    a35=23.6365         7.8644         8.092        8.3773        8.6974       9.0528       9.4528       9.9211 
    a36=24.6505         8.1266        8.3456        8.6207        8.9342       9.2813       9.6653       10.121 
    a37=25.6645         8.3797        8.5917        8.8558        9.1625       9.5017       9.8738       10.318 
    a38=26.6784         8.6258        8.8308        9.0831        9.3829       9.7149       10.078        10.51 
    a39=27.6924          8.864        9.0623        9.3031        9.5961       9.9213       10.277       10.697 
    a40=28.7064         9.0955        9.2868        9.5183        9.8023       10.121        10.47       10.878 
    a41=29.7204         9.3198        9.5043        9.7283        10.002       10.315       10.658       11.055 
    a42=30.7344         9.5377         9.716         9.933        10.197       10.503        10.84       11.226 
    a43=31.7483          9.749        9.9218        10.132        10.386       10.686       11.017       11.393 
    a44=32.7623         9.9546        10.122        10.326         10.57       10.864       11.189       11.555 
    a45=33.7763         10.154        10.317        10.515         10.75       11.037       11.356       11.713 
    a46=34.7903         10.349        10.507        10.699        10.925       11.205       11.519       11.867 
    a47=35.8043         10.538        10.692        10.878        11.097       11.369       11.677       12.016 
    a48=36.8182         10.722        10.872        11.053        11.265        11.53       11.832       12.162 
    a49=37.8322         10.901        11.047        11.223         11.43       11.687       11.982       12.305 
    a50=38.8462         11.076        11.218         11.39        11.592        11.84        12.13       12.445 
    a51=39.8602         11.246        11.385        11.553         11.75        11.99       12.274       12.582 
    a52=40.8742         11.413        11.548        11.712        11.904       12.137       12.415       12.715 
    a53=41.8882         11.575        11.707        11.867        12.055       12.281       12.553       12.846 
    a54=42.9021         11.733        11.863        12.019        12.202       12.421       12.688       12.975 
    a55=43.9161         11.887        12.014        12.168        12.347       12.559       12.821         13.1 
    a56=44.9301         12.038        12.163        12.313        12.488       12.694        12.95       13.224 
    a57=45.9441         12.185        12.308        12.455        12.627       12.827       13.077       13.347 
    a58=46.9581          12.33         12.45        12.594        12.762       12.958       13.202       13.467 
    a59=47.972           12.47        12.588         12.73        12.895       13.087       13.325       13.585 
    a60=48.986          12.608        12.724        12.863        13.025       13.213       13.446       13.702 

tb_pol_a
                     z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                     __________    __________    __________    __________    _________    _________    _________

    a1=-9.82487        -9.8249       -9.8249       -9.8249       -9.8249      -9.8249      -8.8109      -8.8109 
    a2=-8.81089        -8.8109       -8.8109       -8.8109       -8.8109      -8.8109      -7.7969      -7.7969 
    a3=-7.79691        -8.8109       -7.7969       -7.7969       -7.7969      -7.7969      -6.7829      -6.7829 
    a4=-6.78293        -7.7969       -6.7829       -6.7829       -6.7829      -6.7829       -5.769       -5.769 
    a5=-5.76895        -6.7829       -6.7829        -5.769        -5.769       -5.769       -5.769       -4.755 
    a6=-4.75497         -5.769        -5.769        -4.755        -4.755       -4.755       -4.755       -3.741 
    a7=-3.74099         -4.755        -4.755        -3.741        -3.741       -3.741       -3.741       -2.727 
    a8=-2.72701         -3.741        -3.741        -2.727        -2.727       -2.727       -2.727       -1.713 
    a9=-1.71303         -2.727        -2.727        -2.727        -1.713       -1.713       -1.713     -0.69905 
    a10=-0.699046       -1.713        -1.713        -1.713      -0.69905     -0.69905            0      0.31494 
    a11=0             -0.69905      -0.69905      -0.69905             0            0      0.31494       1.3289 
    a12=0.314935             0             0             0       0.31494      0.31494      0.31494       1.3289 
    a13=1.32892        0.31494       0.31494       0.31494        1.3289       1.3289       1.3289       2.3429 
    a14=2.3429          1.3289        1.3289        1.3289        2.3429       2.3429       2.3429       3.3569 
    a15=3.35688         2.3429        2.3429        2.3429        2.3429       3.3569       3.3569       4.3709 
    a16=4.37086         3.3569        3.3569        3.3569        3.3569       4.3709       4.3709       5.3848 
    a17=5.38484         4.3709        4.3709        4.3709        4.3709       5.3848       5.3848       6.3988 
    a18=6.39882         5.3848        5.3848        5.3848        5.3848       6.3988       6.3988       7.4128 
    a19=7.4128          6.3988        6.3988        6.3988        6.3988       7.4128       7.4128       8.4268 
    a20=8.42678         7.4128        7.4128        7.4128        7.4128       8.4268       8.4268       9.4408 
    a21=9.44076         8.4268        8.4268        8.4268        8.4268       9.4408       9.4408       10.455 
    a22=10.4547         9.4408        9.4408        9.4408        9.4408       10.455       10.455       11.469 
    a23=11.4687         10.455        10.455        10.455        10.455       11.469       11.469       12.483 
    a24=12.4827         11.469        11.469        11.469        11.469       11.469       12.483       12.483 
    a25=13.4967         12.483        12.483        12.483        12.483       12.483       13.497       13.497 
    a26=14.5107         13.497        13.497        13.497        13.497       13.497       14.511       14.511 
    a27=15.5246         14.511        14.511        14.511        14.511       14.511       15.525       15.525 
    a28=16.5386         15.525        15.525        15.525        15.525       15.525       16.539       16.539 
    a29=17.5526         16.539        16.539        16.539        16.539       16.539       17.553       17.553 
    a30=18.5666         17.553        17.553        17.553        17.553       17.553       18.567       18.567 
    a31=19.5806         18.567        18.567        18.567        18.567       18.567       19.581       19.581 
    a32=20.5946         19.581        19.581        19.581        19.581       19.581       20.595       20.595 
    a33=21.6085         19.581        20.595        20.595        20.595       20.595       21.609       21.609 
    a34=22.6225         20.595        21.609        21.609        21.609       21.609       22.623       22.623 
    a35=23.6365         21.609        22.623        22.623        22.623       22.623       23.636       23.636 
    a36=24.6505         22.623        22.623        23.636        23.636       23.636        24.65        24.65 
    a37=25.6645         23.636        23.636         24.65         24.65        24.65        24.65       25.664 
    a38=26.6784          24.65         24.65        25.664        25.664       25.664       25.664       26.678 
    a39=27.6924         25.664        25.664        26.678        26.678       26.678       26.678       27.692 
    a40=28.7064         26.678        26.678        26.678        27.692       27.692       27.692       28.706 
    a41=29.7204         27.692        27.692        27.692        28.706       28.706       28.706        29.72 
    a42=30.7344         28.706        28.706        28.706         29.72        29.72        29.72       30.734 
    a43=31.7483          29.72         29.72         29.72        30.734       30.734       30.734       31.748 
    a44=32.7623         30.734        30.734        30.734        31.748       31.748       31.748       32.762 
    a45=33.7763         31.748        31.748        31.748        32.762       32.762       32.762       33.776 
    a46=34.7903         32.762        32.762        32.762        32.762       33.776       33.776        34.79 
    a47=35.8043         33.776        33.776        33.776        33.776        34.79        34.79       35.804 
    a48=36.8182          34.79         34.79         34.79         34.79       35.804       35.804       36.818 
    a49=37.8322         35.804        35.804        35.804        35.804       36.818       36.818       37.832 
    a50=38.8462         36.818        36.818        36.818        36.818       37.832       37.832       38.846 
    a51=39.8602         37.832        37.832        37.832        37.832       38.846       38.846        39.86 
    a52=40.8742         38.846        38.846        38.846        38.846        39.86        39.86       40.874 
    a53=41.8882          39.86         39.86         39.86         39.86       40.874       40.874       41.888 
    a54=42.9021         40.874        40.874        40.874        40.874       41.888       41.888       42.902 
    a55=43.9161         41.888        41.888        41.888        41.888       42.902       42.902       43.916 
    a56=44.9301         42.902        42.902        42.902        42.902       43.916       43.916       43.916 
    a57=45.9441         43.916        43.916        43.916        43.916       43.916        44.93        44.93 
    a58=46.9581          44.93         44.93         44.93         44.93        44.93       45.944       45.944 
    a59=47.972          45.944        45.944        45.944        45.944       45.944       46.958       46.958 
    a60=48.986          46.958        46.958        46.958        46.958       46.958       47.972       47.972 

</pre><h2 id="4">Simulate Save/Borrow, Can Default: cmin = 0.00001, choose not to default</h2><p>Allow for default, but very low cmin.</p><p>see that the resulting policy function does not allow distribution to exceed below -9.32203, the additional borrowing allowed for default does not matter because utility from default is so terrible with c min = 0.00001.</p><pre class="codeinput">[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% allow for borrowing, when using a very large negative value for fl_b_bd</span>
<span class="comment">% that means the natural borrowing constraint will bind.</span>
param_map(<span class="string">'fl_b_bd'</span>) = -20;
param_map(<span class="string">'bl_default'</span>) = 1;
param_map(<span class="string">'fl_c_min'</span>) = 0.00001;

<span class="comment">% shared parameters</span>
param_map(<span class="string">'fl_a_min'</span>) = 0;
param_map(<span class="string">'fl_a_max'</span>) = fl_a_max;
param_map(<span class="string">'it_a_n'</span>) = it_a_n;
param_map(<span class="string">'fl_r_save'</span>) = fl_r_save;
param_map(<span class="string">'fl_r_borr'</span>) = fl_r_borr;
param_map(<span class="string">'fl_w'</span>) = fl_w;

<span class="comment">% solution</span>
param_map(<span class="string">'it_z_n'</span>) = it_z_n;
param_map(<span class="string">'it_maxiter_val'</span>) = it_maxiter_val;

<span class="comment">% Display Parameters</span>
support_map(<span class="string">'bl_display'</span>) = bl_display;
support_map(<span class="string">'bl_post'</span>) = bl_post;
support_map(<span class="string">'bl_display_final'</span>) = bl_display_final;


<span class="comment">% Call Program</span>
ff_abz_vf(param_map, support_map);
</pre><pre class="codeoutput">Elapsed time is 21.409253 seconds.
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                  valgap      polgap       z1          z2          z3          z4          z5          z6          z7   
                __________    ______    ________    ________    ________    ________    ________    ________    ________

    iter=1          1092.2    390.36      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167
    iter=2          824.24    417.84     0.98333     0.98333           1           1           1           1           1
    iter=3          599.51    138.76        0.95        0.95     0.96667     0.96667     0.96667     0.96667     0.98333
    iter=4          399.81    69.234     0.86667     0.88333     0.91667     0.91667     0.91667     0.91667     0.91667
    iter=5          257.13    41.633     0.81667         0.8     0.81667     0.83333        0.85        0.85         0.9
    iter=6          164.58    28.138     0.76667     0.76667     0.76667     0.73333        0.75     0.76667     0.81667
    iter=7          97.029    20.504     0.61667        0.65     0.68333     0.66667        0.65        0.65     0.68333
    iter=8          54.645    15.809     0.51667     0.53333     0.51667     0.53333     0.56667     0.53333     0.58333
    iter=9          43.717    13.259     0.41667     0.41667         0.4     0.41667         0.4     0.43333     0.46667
    iter=10         39.054    11.585     0.33333     0.36667     0.36667     0.31667     0.31667        0.35     0.41667
    iter=11         35.394    9.5817        0.25     0.26667     0.26667     0.26667     0.26667        0.25         0.3
    iter=12         32.079     9.223     0.23333     0.23333        0.25     0.18333     0.23333     0.26667        0.25
    iter=13         28.759    7.3554     0.16667     0.16667     0.18333     0.21667     0.16667     0.21667     0.16667
    iter=14          25.83     7.339     0.18333     0.18333        0.15        0.15        0.15     0.16667     0.16667
    iter=15         23.298    7.2765        0.15        0.15     0.13333     0.16667     0.13333     0.16667     0.18333
    iter=16         21.113    5.5514     0.11667     0.11667    0.083333     0.11667     0.11667         0.1     0.11667
    iter=17         19.196     5.709     0.11667     0.11667     0.13333    0.083333     0.11667         0.1     0.11667
    iter=18         17.528    5.3839         0.1         0.1     0.11667         0.1     0.11667     0.11667         0.1
    iter=19          16.19    5.4906         0.1    0.083333         0.1     0.11667    0.066667     0.11667     0.13333
    iter=20         14.945    4.8396    0.083333    0.083333    0.083333    0.066667        0.05         0.1     0.11667
    iter=21         13.767    3.5947        0.05    0.066667        0.05        0.05    0.066667    0.083333    0.066667
    iter=22         12.681    3.4966        0.05        0.05        0.05    0.033333    0.066667        0.05        0.05
    iter=23         11.685    3.5102        0.05        0.05        0.05        0.05        0.05        0.05    0.033333
    iter=24         10.773    3.4842        0.05        0.05    0.033333    0.033333    0.083333    0.033333        0.05
    iter=25         9.9368    3.9035        0.05        0.05        0.05    0.033333        0.05    0.033333    0.016667
    iter=26          9.173    3.9831    0.033333        0.05    0.066667    0.066667        0.05        0.05    0.066667
    iter=27         8.4693    3.4614        0.05        0.05        0.05        0.05    0.033333        0.05        0.05
    iter=28         7.8242    2.7939    0.033333    0.016667        0.05    0.033333    0.016667    0.033333    0.033333
    iter=29         7.2339    3.2438    0.033333        0.05        0.05    0.066667    0.033333        0.05    0.066667
    iter=30         6.6939    2.5944    0.033333    0.033333    0.033333    0.033333           0    0.016667        0.05
    iter=31         6.1997    2.4356    0.033333        0.05    0.016667           0    0.033333    0.033333    0.016667
    iter=32         5.7468    2.1923    0.016667    0.016667    0.033333    0.016667    0.016667    0.033333    0.016667
    iter=33         5.3311     2.292    0.033333    0.033333    0.016667    0.033333           0    0.033333    0.016667
    iter=34         4.9493    2.1923    0.033333    0.016667    0.016667    0.016667    0.033333    0.033333    0.016667
    iter=35         4.5982     2.055    0.016667    0.016667    0.016667           0           0    0.016667           0
    iter=36         4.2749    2.1923    0.033333    0.016667    0.016667    0.016667    0.016667    0.016667    0.033333
    iter=37         3.9769     2.055    0.016667    0.016667    0.016667    0.016667           0    0.033333           0
    iter=38         3.7017    1.6779           0    0.016667    0.016667    0.016667    0.033333    0.033333    0.016667
    iter=39         3.4464    1.6779    0.016667    0.016667    0.016667    0.016667    0.016667           0    0.016667
    iter=40         3.2104    1.1864           0           0    0.016667    0.016667           0    0.016667           0
    iter=41         2.9922     2.055    0.016667    0.016667    0.016667    0.033333    0.016667           0    0.033333
    iter=42         2.7906    1.1864           0    0.016667    0.016667           0    0.016667    0.016667    0.016667
    iter=43         2.6043    1.6779           0           0    0.016667    0.016667           0           0           0
    iter=44         2.4319    1.6779    0.016667           0           0    0.016667    0.016667           0    0.016667
    iter=45         2.2723    1.9197           0    0.016667    0.016667    0.016667    0.016667    0.016667    0.033333
    iter=46         2.1245    1.1864           0           0    0.016667    0.016667    0.016667           0           0
    iter=47         1.9874    1.1864           0           0           0    0.016667    0.016667           0    0.016667
    iter=48         1.8601    1.1864           0           0           0    0.016667    0.016667    0.016667    0.016667
    iter=49         1.7416    1.5626    0.033333    0.016667    0.016667    0.016667    0.016667           0    0.016667
    iter=50         1.6312    1.1864           0           0           0    0.016667    0.016667           0    0.016667
    iter=194    0.00019778         0           0           0           0           0           0           0           0
    iter=195    0.00018594         0           0           0           0           0           0           0           0
    iter=196    0.00017481         0           0           0           0           0           0           0           0
    iter=197    0.00016435         0           0           0           0           0           0           0           0
    iter=198    0.00015451         0           0           0           0           0           0           0           0
    iter=199    0.00014526         0           0           0           0           0           0           0           0
    iter=200    0.00013656         0           0           0           0           0           0           0           0
    iter=201    0.00012839         0           0           0           0           0           0           0           0
    iter=202     0.0001207         0           0           0           0           0           0           0           0
    iter=203    0.00011348         0           0           0           0           0           0           0           0
    iter=204    0.00010668         0           0           0           0           0           0           0           0
    iter=205     0.0001003         0           0           0           0           0           0           0           0
    iter=206    9.4292e-05         0           0           0           0           0           0           0           0
    iter=207    8.8647e-05         0           0           0           0           0           0           0           0
    iter=208     8.334e-05         0           0           0           0           0           0           0           0
    iter=209    7.8351e-05         0           0           0           0           0           0           0           0
    iter=210    7.3661e-05         0           0           0           0           0           0           0           0
    iter=211    6.9251e-05         0           0           0           0           0           0           0           0
    iter=212    6.5105e-05         0           0           0           0           0           0           0           0
    iter=213    6.1207e-05         0           0           0           0           0           0           0           0
    iter=214    5.7543e-05         0           0           0           0           0           0           0           0
    iter=215    5.4098e-05         0           0           0           0           0           0           0           0
    iter=216    5.0859e-05         0           0           0           0           0           0           0           0
    iter=217    4.7814e-05         0           0           0           0           0           0           0           0
    iter=218    4.4951e-05         0           0           0           0           0           0           0           0
    iter=219     4.226e-05         0           0           0           0           0           0           0           0
    iter=220     3.973e-05         0           0           0           0           0           0           0           0
    iter=221    3.7351e-05         0           0           0           0           0           0           0           0
    iter=222    3.5115e-05         0           0           0           0           0           0           0           0
    iter=223    3.3012e-05         0           0           0           0           0           0           0           0
    iter=224    3.1036e-05         0           0           0           0           0           0           0           0
    iter=225    2.9178e-05         0           0           0           0           0           0           0           0
    iter=226    2.7431e-05         0           0           0           0           0           0           0           0
    iter=227    2.5788e-05         0           0           0           0           0           0           0           0
    iter=228    2.4244e-05         0           0           0           0           0           0           0           0
    iter=229    2.2792e-05         0           0           0           0           0           0           0           0
    iter=230    2.1428e-05         0           0           0           0           0           0           0           0
    iter=231    2.0145e-05         0           0           0           0           0           0           0           0
    iter=232    1.8938e-05         0           0           0           0           0           0           0           0
    iter=233    1.7804e-05         0           0           0           0           0           0           0           0
    iter=234    1.6738e-05         0           0           0           0           0           0           0           0
    iter=235    1.5736e-05         0           0           0           0           0           0           0           0
    iter=236    1.4794e-05         0           0           0           0           0           0           0           0
    iter=237    1.3908e-05         0           0           0           0           0           0           0           0
    iter=238    1.3075e-05         0           0           0           0           0           0           0           0
    iter=239    1.2292e-05         0           0           0           0           0           0           0           0
    iter=240    1.1556e-05         0           0           0           0           0           0           0           0
    iter=241    1.0864e-05         0           0           0           0           0           0           0           0
    iter=242    1.0213e-05         0           0           0           0           0           0           0           0
    iter=243    9.6016e-06         0           0           0           0           0           0           0           0

tb_val
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20             -634.4       -633.62       -632.71       -424.29       -340.43     -278.74      -103.64 
    a2=-18.8136       -595.85       -588.71       -318.26       -221.55       -177.94     -145.91      -57.544 
    a3=-17.6271       -539.34       -440.46       -214.09       -146.96       -112.35     -72.061      -39.824 
    a4=-16.4407       -440.14       -325.73       -157.05       -107.91       -81.602     -48.906      -27.941 
    a5=-15.2542       -342.22       -242.92       -117.57       -80.912       -60.639     -34.272      -19.041 
    a6=-14.0678        -260.9       -182.16       -88.628        -60.81       -44.702     -22.033      -13.909 
    a7=-12.8814       -197.37       -74.249       -43.252       -31.562       -24.508     -16.679      -10.743 
    a8=-11.6949       -117.93        -46.89       -29.868       -22.422       -17.671     -13.055      -8.3318 
    a9=-10.5085       -71.828       -32.849       -22.345       -17.058       -13.475     -10.287       -6.368 
    a10=-9.32203      -42.871       -23.931       -17.232       -13.285        -10.43      -8.036      -4.7213 
    a11=-8.13559      -26.366       -18.182       -13.641       -10.513       -8.0965     -6.0455      -3.4352 
    a12=-6.94915      -19.904       -14.826       -11.256       -8.5824       -6.4332      -4.579      -2.3209 
    a13=-5.76271      -15.516       -12.231       -9.3121       -6.9749       -5.0342     -3.3348      -1.3258 
    a14=-4.57627      -12.361       -10.069        -7.645       -5.5764       -3.8082      -2.238     -0.42194 
    a15=-3.38983       -9.929       -8.1628       -6.1622       -4.3215       -2.7028     -1.2461      0.40216 
    a16=-2.20339      -7.9254       -6.4965       -4.8434       -3.1945       -1.7048    -0.34722       1.1585 
    a17=-1.01695      -6.2202       -5.0364       -3.6644        -2.177      -0.79912     0.47179       1.8583 
    a18=0             -4.8442       -3.8368       -2.6929        -1.329     -0.025881      1.1948       2.3036 
    a19=0.169492      -4.7245       -3.6341       -2.4278       -1.1498       0.10315      1.2708       2.4251 
    a20=1.35593       -3.3832       -2.4861       -1.4887      -0.37554       0.78483       1.886       2.9604 
    a21=2.54237       -2.2235        -1.472      -0.61943       0.34505        1.4216      2.4621       3.4663 
    a22=3.72881       -1.2055      -0.56043       0.18126        1.0141        2.0153      3.0016       3.9506 
    a23=4.91525      -0.29817       0.26629       0.91834        1.6516        2.5812      3.5167       4.4157 
    a24=6.10169       0.51989         1.021        1.6023        2.2652        3.1252       4.012       4.8609 
    a25=7.28814        1.2641        1.7153        2.2423        2.8507        3.6448      4.4857       5.2874 
    a26=8.47458        1.9467        2.3589        2.8436        3.4074        4.1397      4.9378       5.6977 
    a27=9.66102        2.5776         2.959        3.4097        3.9357        4.6106      5.3695       6.0967 
    a28=10.8475        3.1645        3.5211        3.9437        4.4366        5.0584       5.781       6.4812 
    a29=12.0339        3.7134        4.0494        4.4481        4.9116        5.4842      6.1728       6.8475 
    a30=13.2203        4.2287        4.5473         4.925         5.362         5.889      6.5459       7.1966 
    a31=14.4068        4.7139        5.0174        5.3765        5.7894        6.2743      6.9014       7.5295 
    a32=15.5932        5.1721         5.462        5.8044        6.1952         6.646      7.2444       7.8508 
    a33=16.7797        5.6056        5.8832        6.2103        6.5816        7.0084      7.5781       8.1638 
    a34=17.9661        6.0163        6.2829        6.5963        6.9512        7.3588       7.901       8.4666 
    a35=19.1525        6.4061        6.6627         6.964        7.3051        7.6967      8.2124       8.7589 
    a36=20.339         6.7768        7.0243        7.3151        7.6443        8.0218      8.5123       9.0406 
    a37=21.5254        7.1298        7.3692        7.6508        7.9696        8.3344       8.801        9.312 
    a38=22.7119        7.4666        7.6989        7.9721        8.2816        8.6349      9.0789       9.5733 
    a39=23.8983        7.7885        8.0143          8.28         8.581        8.9237      9.3463       9.8249 
    a40=25.0847        8.0966        8.3165        8.5754        8.8686        9.2014      9.6037       10.067 
    a41=26.2712         8.392        8.6064        8.8589        9.1449        9.4683      9.8515       10.301 
    a42=27.4576        8.6753        8.8847        9.1314        9.4105        9.7251       10.09       10.526 
    a43=28.6441        8.9475        9.1521        9.3933         9.666        9.9723       10.32       10.743 
    a44=29.8305        9.2092        9.4094        9.6452        9.9118         10.21      10.544       10.954 
    a45=31.0169        9.4647        9.6569        9.8878        10.149         10.44      10.763       11.161 
    a46=32.2034        9.7125        9.8956        10.122        10.377        10.661      10.977       11.362 
    a47=33.3898        9.9525        10.126        10.347        10.597        10.876      11.184       11.557 
    a48=34.5763        10.185        10.353        10.564         10.81        11.083      11.386       11.747 
    a49=35.7627        10.409        10.572        10.775        11.015        11.284      11.581        11.93 
    a50=36.9492        10.629        10.786        10.979        11.214        11.478      11.769       12.109 
    a51=38.1356        10.841        10.993        11.178        11.407        11.666      11.952       12.281 
    a52=39.322         11.047        11.194        11.373        11.594        11.848       12.13       12.449 
    a53=40.5085        11.247        11.389        11.563        11.775        12.024      12.301       12.611 
    a54=41.6949        11.442         11.58        11.748        11.952        12.196      12.468       12.769 
    a55=42.8814        11.632        11.765        11.928        12.124        12.363       12.63       12.922 
    a56=44.0678        11.816        11.946        12.104        12.291        12.525      12.787       13.071 
    a57=45.2542        11.996        12.121        12.275        12.456        12.683       12.94       13.217 
    a58=46.4407        12.171        12.293        12.441        12.617        12.837      13.089       13.358 
    a59=47.6271        12.341         12.46        12.604        12.775        12.988      13.235       13.496 
    a60=48.8136        12.507        12.623        12.763        12.929        13.135      13.377       13.633 

tb_pol_a
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20                 0             0             0           -20           -20          -20      -18.814 
    a2=-18.8136          -20           -20       -18.814       -18.814       -18.814      -18.814      -17.627 
    a3=-17.6271      -18.814       -18.814       -17.627       -17.627       -17.627      -16.441      -16.441 
    a4=-16.4407      -17.627       -17.627       -16.441       -16.441       -16.441      -15.254      -15.254 
    a5=-15.2542      -16.441       -16.441       -15.254       -15.254       -15.254      -14.068      -14.068 
    a6=-14.0678      -15.254       -15.254       -14.068       -14.068       -14.068      -12.881      -12.881 
    a7=-12.8814      -14.068       -12.881       -12.881       -12.881       -12.881      -11.695      -11.695 
    a8=-11.6949      -12.881       -11.695       -11.695       -11.695       -11.695      -10.508      -10.508 
    a9=-10.5085      -11.695       -10.508       -10.508       -10.508       -10.508       -9.322       -9.322 
    a10=-9.32203      -9.322        -9.322        -9.322        -9.322        -9.322      -8.1356      -8.1356 
    a11=-8.13559     -8.1356       -8.1356       -8.1356       -8.1356       -8.1356      -8.1356      -6.9492 
    a12=-6.94915     -8.1356       -6.9492       -6.9492       -6.9492       -6.9492      -6.9492      -5.7627 
    a13=-5.76271     -6.9492       -5.7627       -5.7627       -5.7627       -5.7627      -5.7627      -4.5763 
    a14=-4.57627     -5.7627       -5.7627       -4.5763       -4.5763       -4.5763      -4.5763      -3.3898 
    a15=-3.38983     -4.5763       -4.5763       -3.3898       -3.3898       -3.3898      -3.3898      -2.2034 
    a16=-2.20339     -3.3898       -3.3898       -2.2034       -2.2034       -2.2034      -2.2034      -1.0169 
    a17=-1.01695     -2.2034       -2.2034       -1.0169       -1.0169       -1.0169      -1.0169            0 
    a18=0            -1.0169       -1.0169       -1.0169             0       0.16949      0.16949       1.3559 
    a19=0.169492           0             0             0       0.16949       0.16949      0.16949       1.3559 
    a20=1.35593      0.16949       0.16949       0.16949        1.3559        1.3559       1.3559       2.5424 
    a21=2.54237       1.3559        1.3559        1.3559        2.5424        2.5424       2.5424       3.7288 
    a22=3.72881       2.5424        2.5424        2.5424        3.7288        3.7288       3.7288       4.9153 
    a23=4.91525       3.7288        3.7288        3.7288        3.7288        4.9153       4.9153       6.1017 
    a24=6.10169       4.9153        4.9153        4.9153        4.9153        6.1017       6.1017       7.2881 
    a25=7.28814       6.1017        6.1017        6.1017        6.1017        7.2881       7.2881       8.4746 
    a26=8.47458       7.2881        7.2881        7.2881        7.2881        8.4746       8.4746        9.661 
    a27=9.66102       8.4746        8.4746        8.4746        8.4746         9.661        9.661        9.661 
    a28=10.8475        9.661         9.661         9.661         9.661        10.847       10.847       10.847 
    a29=12.0339       10.847        10.847        10.847        10.847        12.034       12.034       12.034 
    a30=13.2203       12.034        12.034        12.034        12.034         13.22        13.22        13.22 
    a31=14.4068        13.22         13.22         13.22         13.22        14.407       14.407       14.407 
    a32=15.5932       14.407        14.407        14.407        14.407        14.407       15.593       15.593 
    a33=16.7797       15.593        15.593        15.593        15.593        15.593        16.78        16.78 
    a34=17.9661        16.78         16.78         16.78         16.78         16.78       17.966       17.966 
    a35=19.1525       17.966        17.966        17.966        17.966        17.966       19.153       19.153 
    a36=20.339        19.153        19.153        19.153        19.153        19.153       20.339       20.339 
    a37=21.5254       20.339        20.339        20.339        20.339        20.339       21.525       21.525 
    a38=22.7119       21.525        21.525        21.525        21.525        21.525       22.712       22.712 
    a39=23.8983       22.712        22.712        22.712        22.712        22.712       23.898       23.898 
    a40=25.0847       23.898        23.898        23.898        23.898        23.898       25.085       25.085 
    a41=26.2712       25.085        25.085        25.085        25.085        25.085       26.271       26.271 
    a42=27.4576       26.271        26.271        26.271        26.271        26.271       27.458       27.458 
    a43=28.6441       27.458        27.458        27.458        27.458        27.458       28.644       28.644 
    a44=29.8305       28.644        28.644        28.644        28.644        28.644       28.644       29.831 
    a45=31.0169       28.644        29.831        29.831        29.831        29.831       29.831       31.017 
    a46=32.2034       29.831        31.017        31.017        31.017        31.017       31.017       32.203 
    a47=33.3898       31.017        31.017        32.203        32.203        32.203       32.203        33.39 
    a48=34.5763       32.203        32.203         33.39         33.39         33.39        33.39       34.576 
    a49=35.7627        33.39         33.39        34.576        34.576        34.576       34.576       35.763 
    a50=36.9492       34.576        34.576        35.763        35.763        35.763       35.763       36.949 
    a51=38.1356       35.763        35.763        35.763        36.949        36.949       36.949       38.136 
    a52=39.322        36.949        36.949        36.949        38.136        38.136       38.136       39.322 
    a53=40.5085       38.136        38.136        38.136        39.322        39.322       39.322       40.508 
    a54=41.6949       39.322        39.322        39.322        40.508        40.508       40.508       41.695 
    a55=42.8814       40.508        40.508        40.508        41.695        41.695       41.695       42.881 
    a56=44.0678       41.695        41.695        41.695        42.881        42.881       42.881       44.068 
    a57=45.2542       42.881        42.881        42.881        42.881        44.068       44.068       45.254 
    a58=46.4407       44.068        44.068        44.068        44.068        45.254       45.254       46.441 
    a59=47.6271       45.254        45.254        45.254        45.254        46.441       46.441       47.627 
    a60=48.8136       46.441        46.441        46.441        46.441        47.627       47.627       47.627 

</pre><h2 id="5">Simulate Save/Borrow, Can Default: cmin = 0.001, default takes place</h2><p>now borrowing level feasible increases significantly given minimum consumption and default. see <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html">ffs_abz_get_funcgrid_nodefault</a> for additional information.</p><p>higher cmin than before, see that the lowest asset level reached is now lower. See that around -10, there is no a' below the 45 degree line in the asset choice graph.</p><pre class="codeinput">[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% allow for borrowing, when using a very large negative value for fl_b_bd</span>
<span class="comment">% that means the natural borrowing constraint will bind.</span>
param_map(<span class="string">'fl_b_bd'</span>) = -20;
param_map(<span class="string">'bl_default'</span>) = 1;
param_map(<span class="string">'fl_c_min'</span>) = 0.001;

<span class="comment">% shared parameters</span>
param_map(<span class="string">'fl_a_min'</span>) = 0;
param_map(<span class="string">'fl_a_max'</span>) = fl_a_max;
param_map(<span class="string">'it_a_n'</span>) = it_a_n;
param_map(<span class="string">'fl_r_save'</span>) = fl_r_save;
param_map(<span class="string">'fl_r_borr'</span>) = fl_r_borr;
param_map(<span class="string">'fl_w'</span>) = fl_w;

<span class="comment">% solution</span>
param_map(<span class="string">'it_z_n'</span>) = it_z_n;
param_map(<span class="string">'it_maxiter_val'</span>) = it_maxiter_val;

<span class="comment">% Display Parameters</span>
support_map(<span class="string">'bl_display'</span>) = bl_display;
support_map(<span class="string">'bl_post'</span>) = bl_post;
support_map(<span class="string">'bl_display_final'</span>) = bl_display_final;


<span class="comment">% Call Program</span>
ff_abz_vf(param_map, support_map);
</pre><pre class="codeoutput">Elapsed time is 21.959105 seconds.
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                  valgap      polgap       z1          z2          z3          z4          z5          z6          z7   
                __________    ______    ________    ________    ________    ________    ________    ________    ________

    iter=1           108.4    390.36      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167
    iter=2          83.362    417.84     0.98333     0.98333           1           1           1           1           1
    iter=3          63.794    138.76        0.95        0.95     0.96667     0.96667     0.96667     0.96667     0.96667
    iter=4          45.901    69.236     0.86667     0.88333     0.91667     0.91667     0.91667     0.91667     0.93333
    iter=5          32.638     41.63     0.81667         0.8     0.83333     0.83333        0.85        0.85         0.9
    iter=6          23.982    28.134     0.76667     0.76667     0.76667     0.73333        0.75     0.76667         0.8
    iter=7          18.632    20.467     0.61667     0.63333     0.68333     0.66667        0.65        0.65         0.7
    iter=8          15.388    15.751     0.51667     0.51667     0.51667     0.53333     0.56667     0.53333     0.58333
    iter=9            13.3    13.189     0.41667         0.4         0.4     0.41667         0.4     0.43333     0.46667
    iter=10         11.845    11.504     0.33333        0.35     0.36667     0.31667     0.31667        0.35     0.41667
    iter=11         10.748     9.485        0.25        0.25     0.26667     0.26667     0.26667        0.25         0.3
    iter=12         9.8412    9.1434     0.23333     0.23333     0.23333     0.18333     0.23333        0.25        0.25
    iter=13         9.0693     7.318     0.16667     0.16667     0.18333     0.21667     0.16667     0.16667     0.16667
    iter=14         8.3906    7.3218     0.18333     0.18333     0.13333        0.15        0.15     0.16667     0.16667
    iter=15         7.7786    7.2765        0.15        0.15     0.13333     0.16667     0.13333     0.16667     0.18333
    iter=16          7.242    5.4781         0.1         0.1         0.1     0.11667     0.11667         0.1     0.11667
    iter=17          6.745    5.6831     0.11667     0.11667     0.13333    0.066667     0.11667         0.1     0.11667
    iter=18         6.3219    5.3965         0.1         0.1     0.11667     0.11667     0.11667     0.11667         0.1
    iter=19         5.9818    5.5015         0.1    0.083333     0.11667         0.1    0.066667     0.11667     0.13333
    iter=20         5.6658    4.8469    0.083333    0.083333    0.083333    0.083333        0.05    0.083333     0.11667
    iter=21         5.3844    3.5118        0.05        0.05    0.033333        0.05    0.066667    0.083333    0.066667
    iter=22         5.1092    3.4966        0.05        0.05        0.05    0.033333    0.066667        0.05        0.05
    iter=23         4.8432    3.5614        0.05        0.05    0.066667        0.05        0.05        0.05    0.033333
    iter=24         4.5871    3.4842        0.05        0.05    0.033333    0.033333    0.066667    0.033333        0.05
    iter=25          4.343    3.9035        0.05        0.05        0.05    0.033333        0.05    0.033333    0.016667
    iter=26         4.1118    3.9028    0.033333        0.05        0.05        0.05    0.066667        0.05    0.066667
    iter=27         3.8937    3.4539    0.033333        0.05        0.05        0.05    0.033333    0.033333        0.05
    iter=28         3.6888    2.9402    0.033333    0.033333    0.066667    0.033333    0.016667    0.033333    0.033333
    iter=29         3.4968    3.0463    0.033333        0.05        0.05        0.05    0.033333        0.05    0.066667
    iter=30         3.3168    2.5944    0.033333    0.033333    0.033333        0.05           0    0.016667    0.033333
    iter=31         3.1481     2.292    0.033333    0.033333    0.016667           0    0.016667    0.033333    0.033333
    iter=32         2.9889     2.055    0.016667    0.016667    0.016667    0.016667    0.033333    0.033333    0.016667
    iter=33         2.8383     2.292    0.033333    0.033333    0.016667    0.033333           0    0.033333           0
    iter=34         2.6957    2.1923    0.033333    0.016667    0.016667    0.016667    0.016667    0.033333    0.033333
    iter=35         2.5606    2.1923    0.016667    0.016667    0.033333           0           0           0           0
    iter=36         2.4325    2.1923    0.033333    0.016667    0.016667    0.016667    0.033333    0.033333    0.016667
    iter=37          2.311    1.6779           0    0.016667    0.016667    0.016667           0    0.033333           0
    iter=38         2.1956    1.6779    0.016667    0.016667    0.016667    0.016667    0.016667    0.016667    0.033333
    iter=39         2.0864    1.6779    0.016667    0.016667    0.016667    0.016667    0.016667           0    0.016667
    iter=40         1.9826    1.1864           0           0    0.016667    0.016667           0    0.016667           0
    iter=41         1.8843    1.6779           0    0.016667    0.016667    0.016667    0.033333           0    0.016667
    iter=42         1.7909    1.1864    0.016667           0    0.016667           0    0.016667    0.016667    0.016667
    iter=43         1.7022    1.6779           0    0.016667    0.016667    0.016667           0           0    0.016667
    iter=44         1.6179    1.6822           0           0           0    0.033333    0.016667           0    0.016667
    iter=45         1.5379    1.6779           0           0    0.016667    0.016667    0.016667           0    0.016667
    iter=46         1.4618    1.1864    0.016667    0.016667           0    0.016667    0.016667    0.016667           0
    iter=47         1.3893    1.1864           0           0    0.016667    0.016667    0.016667           0    0.016667
    iter=48         1.3204    1.1864           0           0           0    0.016667           0           0    0.016667
    iter=49         1.2546    1.1864           0           0           0    0.016667    0.016667           0    0.016667
    iter=50         1.1918    1.1864           0    0.016667    0.016667           0    0.016667    0.016667    0.016667
    iter=195    0.00019535         0           0           0           0           0           0           0           0
    iter=196    0.00018368         0           0           0           0           0           0           0           0
    iter=197    0.00017271         0           0           0           0           0           0           0           0
    iter=198    0.00016239         0           0           0           0           0           0           0           0
    iter=199    0.00015269         0           0           0           0           0           0           0           0
    iter=200    0.00014357         0           0           0           0           0           0           0           0
    iter=201    0.00013499         0           0           0           0           0           0           0           0
    iter=202    0.00012693         0           0           0           0           0           0           0           0
    iter=203    0.00011934         0           0           0           0           0           0           0           0
    iter=204    0.00011221         0           0           0           0           0           0           0           0
    iter=205     0.0001055         0           0           0           0           0           0           0           0
    iter=206    9.9193e-05         0           0           0           0           0           0           0           0
    iter=207    9.3262e-05         0           0           0           0           0           0           0           0
    iter=208    8.7686e-05         0           0           0           0           0           0           0           0
    iter=209    8.2442e-05         0           0           0           0           0           0           0           0
    iter=210    7.7512e-05         0           0           0           0           0           0           0           0
    iter=211    7.2876e-05         0           0           0           0           0           0           0           0
    iter=212    6.8517e-05         0           0           0           0           0           0           0           0
    iter=213    6.4419e-05         0           0           0           0           0           0           0           0
    iter=214    6.0565e-05         0           0           0           0           0           0           0           0
    iter=215    5.6941e-05         0           0           0           0           0           0           0           0
    iter=216    5.3534e-05         0           0           0           0           0           0           0           0
    iter=217    5.0331e-05         0           0           0           0           0           0           0           0
    iter=218    4.7319e-05         0           0           0           0           0           0           0           0
    iter=219    4.4487e-05         0           0           0           0           0           0           0           0
    iter=220    4.1825e-05         0           0           0           0           0           0           0           0
    iter=221    3.9321e-05         0           0           0           0           0           0           0           0
    iter=222    3.6967e-05         0           0           0           0           0           0           0           0
    iter=223    3.4754e-05         0           0           0           0           0           0           0           0
    iter=224    3.2674e-05         0           0           0           0           0           0           0           0
    iter=225    3.0718e-05         0           0           0           0           0           0           0           0
    iter=226    2.8878e-05         0           0           0           0           0           0           0           0
    iter=227    2.7149e-05         0           0           0           0           0           0           0           0
    iter=228    2.5523e-05         0           0           0           0           0           0           0           0
    iter=229    2.3995e-05         0           0           0           0           0           0           0           0
    iter=230    2.2558e-05         0           0           0           0           0           0           0           0
    iter=231    2.1207e-05         0           0           0           0           0           0           0           0
    iter=232    1.9936e-05         0           0           0           0           0           0           0           0
    iter=233    1.8742e-05         0           0           0           0           0           0           0           0
    iter=234     1.762e-05         0           0           0           0           0           0           0           0
    iter=235    1.6564e-05         0           0           0           0           0           0           0           0
    iter=236    1.5572e-05         0           0           0           0           0           0           0           0
    iter=237    1.4639e-05         0           0           0           0           0           0           0           0
    iter=238    1.3762e-05         0           0           0           0           0           0           0           0
    iter=239    1.2937e-05         0           0           0           0           0           0           0           0
    iter=240    1.2162e-05         0           0           0           0           0           0           0           0
    iter=241    1.1433e-05         0           0           0           0           0           0           0           0
    iter=242    1.0748e-05         0           0           0           0           0           0           0           0
    iter=243    1.0104e-05         0           0           0           0           0           0           0           0
    iter=244    9.4982e-06         0           0           0           0           0           0           0           0

tb_val
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20            -64.928        -64.22        -63.37       -50.096      -41.602      -35.403      -26.449 
    a2=-18.8136       -60.734       -59.638       -55.523        -43.71       -36.24      -30.719      -22.748 
    a3=-17.6271       -56.333       -54.031       -48.929       -38.334      -31.691      -26.691      -19.191 
    a4=-16.4407       -51.446       -48.434       -42.059       -32.954      -27.159      -22.712      -15.918 
    a5=-15.2542       -46.353        -42.71       -34.986        -27.58      -22.662      -18.828      -13.211 
    a6=-14.0678       -41.106       -36.839       -29.403       -23.253      -19.019      -15.664      -10.919 
    a7=-12.8814       -35.822       -31.484       -24.841       -19.666      -15.982      -13.013      -8.9495 
    a8=-11.6949       -30.832       -26.779        -21.04       -16.641      -13.406      -10.757      -7.2389 
    a9=-10.5085       -26.317       -22.703        -17.83       -14.058      -11.195      -8.8118      -5.7386 
    a10=-9.32203      -22.328       -19.189       -15.092       -11.831      -9.2773      -7.1188      -4.4117 
    a11=-8.13559       -18.85       -16.163       -12.735       -9.8931      -7.5997      -5.6319      -3.2288 
    a12=-6.94915      -15.835       -13.551       -10.688       -8.1931      -6.1201      -4.3155      -2.1665 
    a13=-5.76271      -13.223       -11.288       -8.8974       -6.6903       -4.805      -3.1411      -1.2056 
    a14=-4.57627      -10.957       -9.3173       -7.3179       -5.3518      -3.6275      -2.0856     -0.33051 
    a15=-3.38983       -8.983       -7.5914       -5.9145       -4.1515      -2.5659      -1.1306      0.47231 
    a16=-2.20339      -7.2559       -6.0703       -4.6589       -3.0676      -1.6026     -0.26048       1.2148 
    a17=-1.01695      -5.7357       -4.7209       -3.5276       -2.0827     -0.72278      0.53755        1.909 
    a18=0             -4.4899       -3.6038       -2.5561       -1.2391     0.042836        1.254       2.3493 
    a19=0.169492        -4.39       -3.4482       -2.3019        -1.065      0.17187       1.3299       2.4708 
    a20=1.35593       -3.1516       -2.3277       -1.3753      -0.29941      0.84657       1.9392       3.0016 
    a21=2.54237       -2.0476        -1.338      -0.51854       0.41267       1.4765       2.5096       3.5043 
    a22=3.72881       -1.0646      -0.44641       0.27014        1.0737       2.0639        3.044       3.9877 
    a23=4.91525      -0.18162       0.36399       0.99617        1.7112       2.6292       3.5585       4.4509 
    a24=6.10169       0.61815        1.1054        1.6723        2.3225       3.1712        4.052       4.8942 
    a25=7.28814        1.3481        1.7892        2.3059         2.905       3.6882       4.5235       5.3189 
    a26=8.47458        2.0196        2.4245        2.9017        3.4582       4.1803       4.9732        5.728 
    a27=9.66102        2.6418        3.0179         3.463        3.9829       4.6484       5.4027       6.1271 
    a28=10.8475        3.2217        3.5743        3.9926        4.4804       5.0935       5.8118       6.5093 
    a29=12.0339        3.7647        4.0977        4.4929         4.952       5.5166       6.2012       6.8734 
    a30=13.2203        4.2751        4.5913        4.9661        5.3993       5.9189       6.5721       7.2205 
    a31=14.4068        4.7561        5.0576        5.4143        5.8238       6.3018       6.9256       7.5516 
    a32=15.5932        5.2106        5.4988        5.8391        6.2268       6.6735       7.2683       7.8728 
    a33=16.7797        5.6407         5.917        6.2422        6.6112        7.035       7.6013        8.185 
    a34=17.9661        6.0485        6.3139        6.6257        6.9789       7.3844       7.9231       8.4869 
    a35=19.1525        6.4357        6.6912        6.9913        7.3311       7.7209       8.2334       8.7781 
    a36=20.339         6.8039        7.0506        7.3405        7.6687       8.0448       8.5322       9.0588 
    a37=21.5254        7.1548        7.3937        7.6744        7.9924       8.3561       8.8198       9.3291 
    a38=22.7119        7.4897        7.7215        7.9941        8.3029       8.6553       9.0965       9.5894 
    a39=23.8983          7.81        8.0354        8.3006        8.6011       8.9428       9.3628       9.8401 
    a40=25.0847        8.1166        8.3361        8.5946        8.8873       9.2193       9.6192       10.082 
    a41=26.2712        8.4105        8.6247        8.8769        9.1624       9.4851       9.8661       10.314 
    a42=27.4576        8.6926        8.9017        9.1481        9.4269       9.7409       10.104       10.539 
    a43=28.6441        8.9636        9.1681        9.4089        9.6813       9.9871       10.333       10.755 
    a44=29.8305        9.2243        9.4242        9.6599        9.9262       10.224       10.556       10.966 
    a45=31.0169        9.4797        9.6708        9.9015        10.162       10.453       10.775       11.172 
    a46=32.2034        9.7265        9.9087        10.134        10.389       10.674       10.989       11.373 
    a47=33.3898        9.9661        10.139        10.359        10.609       10.887       11.196       11.567 
    a48=34.5763        10.197        10.365        10.576        10.821       11.094       11.396       11.756 
    a49=35.7627        10.422        10.584        10.786        11.026       11.294       11.591        11.94 
    a50=36.9492         10.64        10.797        10.989        11.224       11.487       11.779       12.117 
    a51=38.1356        10.852        11.004        11.188        11.416       11.675       11.961       12.289 
    a52=39.322         11.058        11.204        11.383        11.602       11.856       12.138       12.456 
    a53=40.5085        11.258        11.399        11.572        11.784       12.033       12.309       12.618 
    a54=41.6949        11.452        11.589        11.757         11.96       12.204       12.476       12.776 
    a55=42.8814        11.641        11.774        11.937        12.131        12.37       12.637       12.929 
    a56=44.0678        11.825        11.954        12.112        12.298       12.532       12.794       13.077 
    a57=45.2542        12.004         12.13        12.283        12.463       12.689       12.947       13.222 
    a58=46.4407        12.179        12.301        12.449        12.624       12.843       13.096       13.364 
    a59=47.6271        12.349        12.467        12.611        12.782       12.994       13.241       13.502 
    a60=48.8136        12.514         12.63         12.77        12.936       13.141       13.383       13.638 

tb_pol_a
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20                 0             0             0           -20           -20          -20      -18.814 
    a2=-18.8136          -20           -20           -20       -18.814       -18.814      -18.814      -17.627 
    a3=-17.6271      -18.814       -18.814       -18.814       -17.627       -17.627      -17.627      -16.441 
    a4=-16.4407      -17.627       -17.627       -16.441       -16.441       -16.441      -16.441      -15.254 
    a5=-15.2542      -16.441       -16.441       -15.254       -15.254       -15.254      -15.254      -14.068 
    a6=-14.0678      -15.254       -15.254       -14.068       -14.068       -14.068      -14.068      -12.881 
    a7=-12.8814      -14.068       -14.068       -12.881       -12.881       -12.881      -12.881      -11.695 
    a8=-11.6949      -12.881       -12.881       -11.695       -11.695       -11.695      -11.695      -10.508 
    a9=-10.5085      -11.695       -11.695       -10.508       -10.508       -10.508      -10.508       -9.322 
    a10=-9.32203     -10.508       -10.508        -9.322        -9.322        -9.322       -9.322      -8.1356 
    a11=-8.13559      -9.322        -9.322       -8.1356       -8.1356       -8.1356      -8.1356      -6.9492 
    a12=-6.94915     -8.1356       -8.1356       -6.9492       -6.9492       -6.9492      -6.9492      -5.7627 
    a13=-5.76271     -6.9492       -6.9492       -5.7627       -5.7627       -5.7627      -5.7627      -4.5763 
    a14=-4.57627     -5.7627       -5.7627       -4.5763       -4.5763       -4.5763      -4.5763      -3.3898 
    a15=-3.38983     -4.5763       -4.5763       -3.3898       -3.3898       -3.3898      -3.3898      -2.2034 
    a16=-2.20339     -3.3898       -3.3898       -2.2034       -2.2034       -2.2034      -2.2034      -1.0169 
    a17=-1.01695     -2.2034       -2.2034       -1.0169       -1.0169       -1.0169      -1.0169            0 
    a18=0            -1.0169       -1.0169       -1.0169             0       0.16949      0.16949       1.3559 
    a19=0.169492     -1.0169             0             0       0.16949       0.16949      0.16949       1.3559 
    a20=1.35593      0.16949       0.16949       0.16949        1.3559        1.3559       1.3559       2.5424 
    a21=2.54237       1.3559        1.3559        1.3559        2.5424        2.5424       2.5424       3.7288 
    a22=3.72881       2.5424        2.5424        2.5424        3.7288        3.7288       3.7288       4.9153 
    a23=4.91525       3.7288        3.7288        3.7288        3.7288        4.9153       4.9153       6.1017 
    a24=6.10169       4.9153        4.9153        4.9153        4.9153        6.1017       6.1017       7.2881 
    a25=7.28814       6.1017        6.1017        6.1017        6.1017        7.2881       7.2881       8.4746 
    a26=8.47458       7.2881        7.2881        7.2881        7.2881        8.4746       8.4746        9.661 
    a27=9.66102       8.4746        8.4746        8.4746        8.4746         9.661        9.661        9.661 
    a28=10.8475        9.661         9.661         9.661         9.661        10.847       10.847       10.847 
    a29=12.0339       10.847        10.847        10.847        10.847        12.034       12.034       12.034 
    a30=13.2203       12.034        12.034        12.034        12.034         13.22        13.22        13.22 
    a31=14.4068        13.22         13.22         13.22         13.22        14.407       14.407       14.407 
    a32=15.5932       14.407        14.407        14.407        14.407        14.407       15.593       15.593 
    a33=16.7797       15.593        15.593        15.593        15.593        15.593        16.78        16.78 
    a34=17.9661        16.78         16.78         16.78         16.78         16.78       17.966       17.966 
    a35=19.1525       17.966        17.966        17.966        17.966        17.966       19.153       19.153 
    a36=20.339        19.153        19.153        19.153        19.153        19.153       20.339       20.339 
    a37=21.5254       20.339        20.339        20.339        20.339        20.339       21.525       21.525 
    a38=22.7119       21.525        21.525        21.525        21.525        21.525       22.712       22.712 
    a39=23.8983       22.712        22.712        22.712        22.712        22.712       23.898       23.898 
    a40=25.0847       23.898        23.898        23.898        23.898        23.898       25.085       25.085 
    a41=26.2712       25.085        25.085        25.085        25.085        25.085       26.271       26.271 
    a42=27.4576       26.271        26.271        26.271        26.271        26.271       27.458       27.458 
    a43=28.6441       27.458        27.458        27.458        27.458        27.458       28.644       28.644 
    a44=29.8305       28.644        28.644        28.644        28.644        28.644       28.644       29.831 
    a45=31.0169       28.644        29.831        29.831        29.831        29.831       29.831       31.017 
    a46=32.2034       29.831        31.017        31.017        31.017        31.017       31.017       32.203 
    a47=33.3898       31.017        31.017        32.203        32.203        32.203       32.203        33.39 
    a48=34.5763       32.203        32.203         33.39         33.39         33.39        33.39       34.576 
    a49=35.7627        33.39         33.39        34.576        34.576        34.576       34.576       35.763 
    a50=36.9492       34.576        34.576        35.763        35.763        35.763       35.763       36.949 
    a51=38.1356       35.763        35.763        35.763        36.949        36.949       36.949       38.136 
    a52=39.322        36.949        36.949        36.949        38.136        38.136       38.136       39.322 
    a53=40.5085       38.136        38.136        38.136        39.322        39.322       39.322       40.508 
    a54=41.6949       39.322        39.322        39.322        40.508        40.508       40.508       41.695 
    a55=42.8814       40.508        40.508        40.508        41.695        41.695       41.695       42.881 
    a56=44.0678       41.695        41.695        41.695        42.881        42.881       42.881       44.068 
    a57=45.2542       42.881        42.881        42.881        42.881        44.068       44.068       45.254 
    a58=46.4407       44.068        44.068        44.068        44.068        45.254       45.254       46.441 
    a59=47.6271       45.254        45.254        45.254        45.254        46.441       46.441       47.627 
    a60=48.8136       46.441        46.441        46.441        46.441        47.627       47.627       47.627 

</pre><h2 id="6">Simulate Save/Borrow, Can Default: cmin = 1, degenerate, borrow to max</h2><p>with cmin = 1, we have garanteed consumption regardless debt owed. Now the distribution generated by the policy functions will be degenerate. In the negative asset region, all choices move towards the defaulting states.</p><pre class="codeinput">[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

<span class="comment">% allow for borrowing, when using a very large negative value for fl_b_bd</span>
<span class="comment">% that means the natural borrowing constraint will bind.</span>
param_map(<span class="string">'fl_b_bd'</span>) = -20;
param_map(<span class="string">'bl_default'</span>) = 1;
param_map(<span class="string">'fl_c_min'</span>) = 1;

<span class="comment">% shared parameters</span>
param_map(<span class="string">'fl_a_min'</span>) = 0;
param_map(<span class="string">'fl_a_max'</span>) = fl_a_max;
param_map(<span class="string">'it_a_n'</span>) = it_a_n;
param_map(<span class="string">'fl_r_save'</span>) = fl_r_save;
param_map(<span class="string">'fl_r_borr'</span>) = fl_r_borr;
param_map(<span class="string">'fl_w'</span>) = fl_w;

<span class="comment">% solution</span>
param_map(<span class="string">'it_z_n'</span>) = it_z_n;
param_map(<span class="string">'it_maxiter_val'</span>) = it_maxiter_val;

<span class="comment">% Display Parameters</span>
support_map(<span class="string">'bl_display'</span>) = bl_display;
support_map(<span class="string">'bl_post'</span>) = bl_post;
support_map(<span class="string">'bl_display_final'</span>) = bl_display_final;


<span class="comment">% Call Program</span>
ff_abz_vf(param_map, support_map);
</pre><pre class="codeoutput">Elapsed time is 21.124568 seconds.
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                  valgap      polgap       z1          z2          z3          z4          z5          z6          z7   
                __________    ______    ________    ________    ________    ________    ________    ________    ________

    iter=1          32.804    388.69      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167      1.0167
    iter=2          25.842    425.62     0.98333           1           1           1           1      1.0167      1.0167
    iter=3          21.904    140.53     0.93333     0.93333     0.93333        0.95        0.95     0.96667     0.98333
    iter=4           19.22    96.642        0.85     0.86667     0.88333         0.9     0.91667     0.91667     0.93333
    iter=5          16.884    56.623        0.85        0.85     0.83333        0.85        0.85     0.88333     0.88333
    iter=6          15.052    41.412     0.76667        0.75        0.75        0.75     0.76667     0.76667         0.8
    iter=7          13.695     28.23     0.71667         0.7     0.66667     0.66667     0.63333     0.66667     0.66667
    iter=8          12.639    21.263     0.56667     0.58333     0.56667     0.58333     0.61667     0.61667         0.6
    iter=9          11.706    31.803         0.5     0.53333     0.51667         0.5     0.46667        0.55     0.53333
    iter=10         10.862    24.816     0.46667         0.5     0.46667     0.46667         0.5     0.56667     0.51667
    iter=11         10.226    24.343     0.41667     0.41667     0.41667         0.5     0.41667     0.48333        0.45
    iter=12         9.6967    17.436     0.38333     0.41667         0.4         0.5     0.41667     0.53333     0.51667
    iter=13         9.1212    30.983     0.43333     0.38333     0.41667     0.41667     0.41667     0.48333        0.45
    iter=14         8.4803    18.057     0.41667     0.43333     0.41667        0.45         0.4     0.46667     0.41667
    iter=15         7.9841    31.299     0.38333     0.38333        0.35     0.38333        0.35     0.43333     0.38333
    iter=16         7.5778    14.528     0.31667     0.36667        0.35     0.43333     0.38333     0.36667     0.48333
    iter=17         7.1269    30.339     0.33333     0.36667     0.31667     0.36667     0.33333     0.33333     0.41667
    iter=18         6.6218     14.55     0.38333     0.36667     0.36667         0.3     0.36667     0.33333        0.35
    iter=19         6.2346    21.364     0.31667        0.35     0.26667         0.3        0.35        0.25     0.36667
    iter=20          5.923    11.571         0.3     0.28333         0.3         0.3     0.31667        0.25     0.43333
    iter=21         5.5674     22.17     0.31667         0.3     0.26667     0.18333         0.3     0.23333         0.4
    iter=22         5.1705    12.014     0.31667     0.31667     0.36667     0.21667     0.33333     0.21667     0.33333
    iter=23         4.8685    21.105     0.28333         0.3        0.25     0.13333        0.35        0.15     0.36667
    iter=24         4.6283    9.2925     0.21667     0.31667     0.26667     0.11667         0.3        0.15     0.38333
    iter=25         4.3482    20.966     0.26667        0.25     0.23333     0.11667     0.26667     0.16667     0.38333
    iter=26          4.037     10.57         0.3     0.28333     0.28333    0.083333         0.3     0.16667     0.31667
    iter=27         3.8022    20.866     0.23333     0.21667     0.23333        0.05     0.31667     0.11667     0.33333
    iter=28          3.615    7.3499     0.18333     0.23333         0.2        0.05     0.26667     0.13333     0.31667
    iter=29         3.3955    20.805         0.2     0.21667         0.2    0.066667     0.23333        0.15         0.3
    iter=30         3.1522    7.2131     0.21667     0.28333     0.18333    0.083333     0.23333     0.11667     0.31667
    iter=31         2.9693     20.75     0.18333         0.2     0.18333    0.033333     0.26667    0.083333     0.21667
    iter=32         2.8226    6.7402     0.16667     0.18333         0.2        0.05         0.2     0.11667        0.25
    iter=33         2.6514    20.578        0.15        0.15     0.18333        0.05     0.16667     0.11667         0.3
    iter=34         2.4616     6.506     0.16667         0.2     0.16667        0.05     0.21667         0.1     0.23333
    iter=35         2.3184    20.539     0.13333        0.15     0.16667    0.016667     0.21667    0.083333     0.18333
    iter=36         2.2036    20.406     0.16667        0.15     0.21667        0.05     0.11667    0.066667     0.21667
    iter=37         2.0703     20.28        0.15        0.15     0.13333    0.033333        0.15         0.1     0.26667
    iter=38         1.9224    6.3892        0.15     0.18333     0.16667    0.033333     0.16667        0.05     0.13333
    iter=39         1.8104     20.21         0.1         0.1     0.11667    0.033333     0.18333    0.066667        0.15
    iter=40         1.7204    5.9322     0.11667     0.11667     0.16667    0.016667         0.1    0.033333     0.16667
    iter=41         1.6167    20.245    0.083333    0.083333     0.13333    0.016667     0.11667    0.083333     0.18333
    iter=42         1.5014    5.9322    0.083333     0.11667     0.13333    0.016667     0.13333        0.05    0.083333
    iter=43         1.4136     20.21    0.066667     0.11667     0.11667    0.016667     0.11667    0.066667     0.13333
    iter=44         1.3431    5.1547         0.1    0.066667     0.16667           0    0.083333    0.033333     0.11667
    iter=45         1.2625     20.21    0.083333    0.066667    0.083333    0.016667        0.05    0.066667         0.1
    iter=46         1.1724    3.8325        0.05         0.1     0.13333           0         0.1    0.033333    0.066667
    iter=47         1.1037    20.175    0.066667    0.083333    0.066667    0.016667    0.083333        0.05     0.11667
    iter=48         1.0486    4.0065        0.05    0.066667    0.083333           0        0.05        0.05     0.13333
    iter=49        0.98585     20.21    0.033333    0.066667    0.066667    0.016667        0.05    0.066667    0.083333
    iter=50        0.91541    3.2887        0.05    0.083333    0.066667           0    0.083333    0.016667    0.016667
    iter=186     0.0002032         0           0           0           0           0           0           0           0
    iter=187    0.00019082         0           0           0           0           0           0           0           0
    iter=188    0.00018087         0           0           0           0           0           0           0           0
    iter=189    0.00017028         0           0           0           0           0           0           0           0
    iter=190    0.00015865         0           0           0           0           0           0           0           0
    iter=191    0.00014898         0           0           0           0           0           0           0           0
    iter=192     0.0001412         0           0           0           0           0           0           0           0
    iter=193    0.00013295         0           0           0           0           0           0           0           0
    iter=194    0.00012387         0           0           0           0           0           0           0           0
    iter=195    0.00011632         0           0           0           0           0           0           0           0
    iter=196    0.00011024         0           0           0           0           0           0           0           0
    iter=197    0.00010379         0           0           0           0           0           0           0           0
    iter=198     9.672e-05         0           0           0           0           0           0           0           0
    iter=199    9.0813e-05         0           0           0           0           0           0           0           0
    iter=200     8.606e-05         0           0           0           0           0           0           0           0
    iter=201    8.1035e-05         0           0           0           0           0           0           0           0
    iter=202    7.5518e-05         0           0           0           0           0           0           0           0
    iter=203    7.0902e-05         0           0           0           0           0           0           0           0
    iter=204    6.7186e-05         0           0           0           0           0           0           0           0
    iter=205    6.3266e-05         0           0           0           0           0           0           0           0
    iter=206    5.8963e-05         0           0           0           0           0           0           0           0
    iter=207    5.5357e-05         0           0           0           0           0           0           0           0
    iter=208    5.2452e-05         0           0           0           0           0           0           0           0
    iter=209    4.9393e-05         0           0           0           0           0           0           0           0
    iter=210    4.6038e-05         0           0           0           0           0           0           0           0
    iter=211     4.322e-05         0           0           0           0           0           0           0           0
    iter=212    4.0949e-05         0           0           0           0           0           0           0           0
    iter=213    3.8563e-05         0           0           0           0           0           0           0           0
    iter=214    3.5946e-05         0           0           0           0           0           0           0           0
    iter=215    3.3744e-05         0           0           0           0           0           0           0           0
    iter=216    3.1968e-05         0           0           0           0           0           0           0           0
    iter=217    3.0107e-05         0           0           0           0           0           0           0           0
    iter=218    2.8066e-05         0           0           0           0           0           0           0           0
    iter=219    2.6345e-05         0           0           0           0           0           0           0           0
    iter=220    2.4958e-05         0           0           0           0           0           0           0           0
    iter=221    2.3505e-05         0           0           0           0           0           0           0           0
    iter=222    2.1914e-05         0           0           0           0           0           0           0           0
    iter=223    2.0569e-05         0           0           0           0           0           0           0           0
    iter=224    1.9484e-05         0           0           0           0           0           0           0           0
    iter=225    1.8351e-05         0           0           0           0           0           0           0           0
    iter=226     1.711e-05         0           0           0           0           0           0           0           0
    iter=227    1.6059e-05         0           0           0           0           0           0           0           0
    iter=228    1.5211e-05         0           0           0           0           0           0           0           0
    iter=229    1.4327e-05         0           0           0           0           0           0           0           0
    iter=230    1.3359e-05         0           0           0           0           0           0           0           0
    iter=231    1.2538e-05         0           0           0           0           0           0           0           0
    iter=232    1.1875e-05         0           0           0           0           0           0           0           0
    iter=233    1.1186e-05         0           0           0           0           0           0           0           0
    iter=234    1.0431e-05         0           0           0           0           0           0           0           0
    iter=235    9.7893e-06         0           0           0           0           0           0           0           0

tb_val
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20            15.208        15.235        15.268        15.306        15.35       15.401       15.456  
    a2=-18.8136       15.208        15.235        15.268        15.306        15.35       15.401       15.456  
    a3=-17.6271       15.208        15.235        15.268        15.306        15.35       15.401       15.531  
    a4=-16.4407       15.215        15.259        15.313        15.379       15.456       15.546       15.645  
    a5=-15.2542       15.375        15.411        15.455        15.507        15.57       15.644       15.727  
    a6=-14.0678        15.48        15.512        15.551        15.597       15.652       15.716       15.788  
    a7=-12.8814       15.557        15.586        15.621        15.664       15.714       15.772       15.837  
    a8=-11.6949       15.615        15.643        15.676        15.716       15.762       15.817       15.896  
    a9=-10.5085       15.662        15.688        15.721        15.758       15.803       15.875       15.974  
    a10=-9.32203        15.7        15.726        15.757        15.799       15.868       15.949        16.04  
    a11=-8.13559      15.754        15.788        15.832        15.883       15.945       16.018         16.1  
    a12=-6.94915      15.827        15.859          15.9        15.948       16.006       16.074       16.151  
    a13=-5.76271      15.899        15.929        15.967        16.012       16.065       16.128       16.207  
    a14=-4.57627      15.955        15.984         16.02        16.063       16.113       16.174       16.275  
    a15=-3.38983       16.01        16.038        16.072        16.112        16.16       16.243       16.338  
    a16=-2.20339      16.055        16.082        16.115        16.165       16.231       16.308       16.395  
    a17=-1.01695      16.099        16.132        16.176        16.228       16.291       16.365       16.448  
    a18=0             16.157         16.19        16.231        16.281        16.34       16.411       16.494  
    a19=0.169492      16.165        16.199         16.24         16.29       16.349        16.42       16.501  
    a20=1.35593       16.233        16.264        16.303        16.349       16.405        16.47       16.563  
    a21=2.54237       16.286        16.317        16.354        16.399       16.452       16.525       16.623  
    a22=3.72881       16.339        16.368        16.404        16.446       16.507       16.588       16.677  
    a23=4.91525       16.391        16.419        16.453          16.5       16.566       16.644        16.73  
    a24=6.10169       16.434        16.464        16.508         16.56       16.623       16.698       16.782  
    a25=7.28814       16.493        16.526        16.568        16.617       16.677       16.749       16.837  
    a26=8.47458       16.556        16.588        16.628        16.675       16.731       16.799       16.893  
    a27=9.66102       16.607        16.638        16.676        16.722       16.778       16.856       16.947  
    a28=10.8475       16.658        16.688        16.724         16.77       16.831       16.911       16.999  
    a29=12.0339       16.708        16.737        16.773        16.822       16.887       16.964        17.05  
    a30=13.2203       16.757        16.785        16.827        16.878        16.94       17.015       17.101  
    a31=14.4068       16.808        16.842        16.884        16.933       16.992       17.065       17.153  
    a32=15.5932       16.869        16.901         16.94        16.988       17.044       17.116       17.205  
    a33=16.7797       16.918        16.949        16.987        17.034       17.091       17.168       17.256  
    a34=17.9661       16.967        16.997        17.034        17.081       17.142        17.22       17.307  
    a35=19.1525       17.015        17.044        17.082        17.131       17.194        17.27       17.356  
    a36=20.339        17.062        17.092        17.134        17.184       17.245        17.32       17.405  
    a37=21.5254       17.113        17.147        17.188        17.237       17.296       17.369       17.455  
    a38=22.7119        17.17        17.203        17.242        17.289       17.346       17.417       17.504  
    a39=23.8983       17.218        17.249        17.288        17.334       17.391       17.466       17.553  
    a40=25.0847       17.265        17.295        17.333         17.38       17.439       17.515       17.601  
    a41=26.2712       17.311        17.341         17.38        17.428       17.489       17.564       17.649  
    a42=27.4576       17.357        17.389        17.429        17.479       17.538       17.612       17.696  
    a43=28.6441       17.408        17.441        17.481        17.529       17.587       17.659       17.743  
    a44=29.8305       17.462        17.494        17.533         17.58       17.636       17.705        17.79  
    a45=31.0169       17.508        17.539        17.577        17.623        17.68       17.752       17.837  
    a46=32.2034       17.554        17.584        17.621        17.668       17.726       17.799       17.883  
    a47=33.3898       17.598        17.628        17.666        17.714       17.773       17.846       17.929  
    a48=34.5763       17.642        17.674        17.714        17.762        17.82       17.892       17.975  
    a49=35.7627       17.691        17.724        17.764        17.811       17.868       17.938        18.02  
    a50=36.9492       17.743        17.774        17.813        17.859       17.915       17.982       18.064  
    a51=38.1356       17.788        17.819        17.856        17.902       17.957       18.027       18.109  
    a52=39.322        17.832        17.862        17.898        17.945       18.001       18.072       18.154  
    a53=40.5085       17.875        17.905        17.942        17.989       18.046       18.117       18.199  
    a54=41.6949       17.918        17.949        17.988        18.035       18.092       18.162       18.242  
    a55=42.8814       17.965        17.997        18.036        18.082       18.138       18.206       18.285  
    a56=44.0678       18.014        18.045        18.083        18.129       18.183       18.248       18.328  
    a57=45.2542       18.058        18.088        18.125         18.17       18.224       18.291       18.371  
    a58=46.4407       18.101         18.13        18.166        18.211       18.266       18.335       18.415  
    a59=47.6271       18.143        18.171        18.208        18.254        18.31       18.378       18.457  
    a60=48.8136       18.184        18.214        18.253        18.299       18.354       18.421       18.499  

tb_pol_a
                    z1_0_34387    z2_0_47991    z3_0_66977    z4_0_93474    z5_1_3045    z6_1_8206    z7_2_5409
                    __________    __________    __________    __________    _________    _________    _________

    a1=-20                 0             0             0             0             0            0            0 
    a2=-18.8136            0             0             0             0             0            0            0 
    a3=-17.6271            0             0             0             0             0            0          -20 
    a4=-16.4407          -20           -20           -20           -20           -20          -20          -20 
    a5=-15.2542          -20           -20           -20           -20           -20          -20          -20 
    a6=-14.0678          -20           -20           -20           -20           -20          -20          -20 
    a7=-12.8814          -20           -20           -20           -20           -20          -20          -20 
    a8=-11.6949          -20           -20           -20           -20           -20          -20      -15.254 
    a9=-10.5085          -20           -20           -20           -20           -20      -15.254      -15.254 
    a10=-9.32203         -20           -20           -20       -14.068       -14.068      -14.068      -14.068 
    a11=-8.13559     -14.068       -14.068       -14.068       -14.068       -14.068      -14.068      -14.068 
    a12=-6.94915     -12.881       -12.881       -12.881       -12.881       -12.881      -12.881      -12.881 
    a13=-5.76271     -12.881       -12.881       -12.881       -12.881       -12.881      -12.881      -10.508 
    a14=-4.57627     -11.695       -11.695       -11.695       -11.695       -11.695      -11.695       -9.322 
    a15=-3.38983     -11.695       -11.695       -11.695       -11.695       -11.695      -8.1356      -8.1356 
    a16=-2.20339     -10.508       -10.508       -10.508       -8.1356       -8.1356      -8.1356      -8.1356 
    a17=-1.01695     -10.508       -6.9492       -6.9492       -6.9492       -6.9492      -6.9492      -6.9492 
    a18=0            -6.9492       -6.9492       -6.9492       -6.9492       -6.9492      -5.7627      -5.7627 
    a19=0.169492     -5.7627       -5.7627       -5.7627       -5.7627       -5.7627      -5.7627      -5.7627 
    a20=1.35593      -5.7627       -5.7627       -5.7627       -5.7627       -5.7627      -5.7627      -3.3898 
    a21=2.54237      -4.5763       -4.5763       -4.5763       -4.5763       -4.5763      -2.2034      -2.2034 
    a22=3.72881      -4.5763       -3.3898       -3.3898       -3.3898       -2.2034      -2.2034      -2.2034 
    a23=4.91525      -3.3898       -3.3898       -3.3898       -1.0169       -1.0169      -1.0169      -1.0169 
    a24=6.10169      -2.2034             0             0             0             0      0.16949      0.16949 
    a25=7.28814      0.16949       0.16949       0.16949       0.16949        1.3559       1.3559       2.5424 
    a26=8.47458       1.3559        1.3559        1.3559        1.3559        1.3559       2.5424       3.7288 
    a27=9.66102       1.3559        1.3559        2.5424        2.5424        2.5424       3.7288       4.9153 
    a28=10.8475       2.5424        2.5424        2.5424        3.7288        4.9153       4.9153       4.9153 
    a29=12.0339       3.7288        3.7288        4.9153        4.9153        6.1017       6.1017       6.1017 
    a30=13.2203       4.9153        4.9153        6.1017        6.1017        7.2881       7.2881       7.2881 
    a31=14.4068       7.2881        7.2881        7.2881        7.2881        8.4746       8.4746        9.661 
    a32=15.5932       8.4746        8.4746        8.4746        8.4746        8.4746        9.661       10.847 
    a33=16.7797       8.4746        8.4746        8.4746         9.661         9.661       10.847       10.847 
    a34=17.9661        9.661         9.661        10.847        10.847        12.034       12.034       12.034 
    a35=19.1525       10.847        10.847        12.034        12.034         13.22        13.22        13.22 
    a36=20.339        12.034         13.22         13.22         13.22        14.407       14.407       14.407 
    a37=21.5254       14.407        14.407        14.407        14.407        15.593       15.593       15.593 
    a38=22.7119       15.593        15.593        15.593        15.593        15.593        16.78        16.78 
    a39=23.8983       15.593        15.593        15.593         16.78         16.78       17.966       17.966 
    a40=25.0847        16.78         16.78        17.966        17.966        17.966       19.153       19.153 
    a41=26.2712       17.966        17.966        19.153        19.153        20.339       20.339       20.339 
    a42=27.4576       19.153        20.339        20.339        20.339        21.525       21.525       21.525 
    a43=28.6441       21.525        21.525        21.525        21.525        22.712       22.712       22.712 
    a44=29.8305       22.712        22.712        22.712        22.712        22.712       23.898       23.898 
    a45=31.0169       22.712        22.712        22.712        23.898        23.898       25.085       25.085 
    a46=32.2034       23.898        23.898        25.085        25.085        25.085       26.271       26.271 
    a47=33.3898       25.085        25.085        26.271        26.271        26.271       27.458       27.458 
    a48=34.5763       26.271        27.458        27.458        27.458        27.458       28.644       28.644 
    a49=35.7627       28.644        28.644        28.644        28.644        28.644       29.831       29.831 
    a50=36.9492       29.831        29.831        29.831        29.831        29.831       31.017       31.017 
    a51=38.1356       29.831        29.831        29.831        31.017        31.017       32.203       32.203 
    a52=39.322        31.017        31.017        32.203        32.203        32.203        33.39        33.39 
    a53=40.5085       32.203        32.203         33.39         33.39         33.39       34.576       34.576 
    a54=41.6949        33.39        34.576        34.576        34.576        34.576       35.763       35.763 
    a55=42.8814       35.763        35.763        35.763        35.763        35.763       36.949       36.949 
    a56=44.0678       36.949        36.949        36.949        36.949        36.949       38.136       38.136 
    a57=45.2542       36.949        36.949        36.949        38.136        38.136       39.322       39.322 
    a58=46.4407       38.136        38.136        38.136        39.322        39.322       40.508       40.508 
    a59=47.6271       39.322        39.322        40.508        40.508        40.508       41.695       41.695 
    a60=48.8136       40.508        41.695        41.695        41.695        41.695       42.881       42.881 

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% ABZ_VF Algorithm Testing, Small Grids

close all;

it_param_set = 1;

% Shared parameters
fl_a_max = 50;
it_a_n = 60;
fl_r_save = 0.025; % 10 percent savings interest rate
fl_r_borr = 0.035;
fl_w = 1;
it_maxiter_val = 1000;
it_z_n = 7;

% Display Etc.
bl_display = false;
bl_post = true;
bl_display_final = true;

%% Simulate Savinags only
% for the output optimal choice matrix, look at each row, if the next
% period a at the lowest level of shock is below current a, that means
% there is nonzero chance of going to lower asset level from this point.
% Similarly for higher point. If at a current asset point, for all shock
% levels, next period a choice is equal or below current period asset
% level, this asset level will have zero probability in the stationary
% distribution. For the distribution to be non-degenerate, there must be no
% rows where a'(a,z) == a for all z. see
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html
% ffs_abz_get_funcgrid_nodefault> for additional information.

[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% control saving, borrowing, default
param_map('fl_b_bd') = 0;
param_map('bl_default') = 0;

% shared parameters
param_map('fl_a_min') = 0;
param_map('fl_a_max') = fl_a_max;
param_map('it_a_n') = it_a_n;
param_map('fl_r_save') = fl_r_save;
param_map('fl_r_borr') = fl_r_borr;
param_map('fl_w') = fl_w;

% solution
param_map('it_z_n') = it_z_n;
param_map('it_maxiter_val') = it_maxiter_val;

% Display Parameters
support_map('bl_display') = bl_display;
support_map('bl_post') = bl_post;
support_map('bl_display_final') = bl_display_final;

% Call Program
ff_abz_vf(param_map, support_map);

%% Simulate Save/Borrow No Default
% See each asset state row, if for negative asset levels, at all levels of
% shocks, a'(a,z) >= a for all a <0 for all z, that means there will be no
% borrowing in the stationary distribution. Similarly if a'(a,z) <= a for
% all a > 0 and all z, there will be no savings in the stationary
% distribution. For the distribution to be non-degenerate, there must be no
% rows where a'(a,z) == a for all z.
%

[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% allow for borrowing, when using a very large negative value for fl_b_bd
% that means the natural borrowing constraint will bind. 
param_map('fl_b_bd') = -100;
param_map('bl_default') = 0;

% shared parameters
param_map('fl_a_min') = 0;
param_map('fl_a_max') = fl_a_max;
param_map('it_a_n') = it_a_n;
param_map('fl_r_save') = fl_r_save;
param_map('fl_r_borr') = fl_r_borr;
param_map('fl_w') = fl_w;

% solution
param_map('it_z_n') = it_z_n;
param_map('it_maxiter_val') = it_maxiter_val;

% Display Parameters
support_map('bl_display') = bl_display;
support_map('bl_post') = bl_post;
support_map('bl_display_final') = bl_display_final;


% Call Program
ff_abz_vf(param_map, support_map);

%% Simulate Save/Borrow, Can Default: cmin = 0.00001, choose not to default
% Allow for default, but very low cmin. 
%
% see that the resulting policy function does not allow distribution to
% exceed below -9.32203, the additional borrowing allowed for default does
% not matter because utility from default is so terrible with c min =
% 0.00001.
%

[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% allow for borrowing, when using a very large negative value for fl_b_bd
% that means the natural borrowing constraint will bind. 
param_map('fl_b_bd') = -20;
param_map('bl_default') = 1;
param_map('fl_c_min') = 0.00001;

% shared parameters
param_map('fl_a_min') = 0;
param_map('fl_a_max') = fl_a_max;
param_map('it_a_n') = it_a_n;
param_map('fl_r_save') = fl_r_save;
param_map('fl_r_borr') = fl_r_borr;
param_map('fl_w') = fl_w;

% solution
param_map('it_z_n') = it_z_n;
param_map('it_maxiter_val') = it_maxiter_val;

% Display Parameters
support_map('bl_display') = bl_display;
support_map('bl_post') = bl_post;
support_map('bl_display_final') = bl_display_final;


% Call Program
ff_abz_vf(param_map, support_map);

%% Simulate Save/Borrow, Can Default: cmin = 0.001, default takes place
% now borrowing level feasible increases significantly given minimum
% consumption and default. see
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/test/ffs_abz_get_funcgrid/test_borr/html/ffs_abz_get_funcgrid_nodefault.html
% ffs_abz_get_funcgrid_nodefault> for additional information.
%
% higher cmin than before, see that the lowest asset level reached is now
% lower. See that around -10, there is no a' below the 45 degree line in
% the asset choice graph.
%

[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% allow for borrowing, when using a very large negative value for fl_b_bd
% that means the natural borrowing constraint will bind. 
param_map('fl_b_bd') = -20;
param_map('bl_default') = 1;
param_map('fl_c_min') = 0.001;

% shared parameters
param_map('fl_a_min') = 0;
param_map('fl_a_max') = fl_a_max;
param_map('it_a_n') = it_a_n;
param_map('fl_r_save') = fl_r_save;
param_map('fl_r_borr') = fl_r_borr;
param_map('fl_w') = fl_w;

% solution
param_map('it_z_n') = it_z_n;
param_map('it_maxiter_val') = it_maxiter_val;

% Display Parameters
support_map('bl_display') = bl_display;
support_map('bl_post') = bl_post;
support_map('bl_display_final') = bl_display_final;


% Call Program
ff_abz_vf(param_map, support_map);


%% Simulate Save/Borrow, Can Default: cmin = 1, degenerate, borrow to max
% with cmin = 1, we have garanteed consumption regardless debt owed. Now
% the distribution generated by the policy functions will be degenerate. In
% the negative asset region, all choices move towards the defaulting
% states. 
%

[param_map, support_map] = ffs_abz_set_default_param(it_param_set);

% allow for borrowing, when using a very large negative value for fl_b_bd
% that means the natural borrowing constraint will bind. 
param_map('fl_b_bd') = -20;
param_map('bl_default') = 1;
param_map('fl_c_min') = 1;

% shared parameters
param_map('fl_a_min') = 0;
param_map('fl_a_max') = fl_a_max;
param_map('it_a_n') = it_a_n;
param_map('fl_r_save') = fl_r_save;
param_map('fl_r_borr') = fl_r_borr;
param_map('fl_w') = fl_w;

% solution
param_map('it_z_n') = it_z_n;
param_map('it_maxiter_val') = it_maxiter_val;

% Display Parameters
support_map('bl_display') = bl_display;
support_map('bl_post') = bl_post;
support_map('bl_display_final') = bl_display_final;


% Call Program
ff_abz_vf(param_map, support_map);
##### SOURCE END #####
--></body></html>