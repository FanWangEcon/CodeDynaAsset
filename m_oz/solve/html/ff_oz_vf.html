
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_oz_vf</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-05-29"><meta name="DC.source" content="ff_oz_vf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_OZ_VF solve infinite horizon exo shock + cash-on-hand problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Iterate Value Function</a></li><li><a href="#10">Solve Optimization Problem Current Iteration</a></li><li><a href="#11">Check Tolerance and Continuation</a></li><li><a href="#13">Process Optimal Choices</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> result_map = ff_oz_vf(varargin)
</pre><h2 id="2">FF_OZ_VF solve infinite horizon exo shock + cash-on-hand problem</h2><p>similar to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html">ff_az_vf</a> except that rather than savings/borrow, cash-on-hand is the endogenous asset variable. The solution algorithm is basically the same. The algorithm varies more when there are two assets for states and choices. One difference is that now a = principle + interests, rather than just principles in the az model. So functions change accordingly.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/paramfunc/ffs_oz_set_default_param.m">ffs_oz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/paramfunc/ffs_oz_get_funcgrid.m">ffs_oz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/solvepost/ff_oz_vf_post.m">ff_oz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_oz_set_default_param(it_param_set);
[armt_map, func_map] = ffs_oz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_oz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_oz_vf'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'mt_z_trans'</span>, <span class="string">'ar_z'</span>, <span class="string">'mt_coh'</span>});
[ar_a, mt_z_trans, ar_z, mt_coh] = params_group{:};
<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};
<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>,<span class="keyword">...</span>
    <span class="string">'it_a_n'</span>, <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>});
[fl_r_save, fl_r_borr, fl_wage, it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><p>now val and pol matrix rows = size(ar_coh, 1) = length(ar_a). note that this is different from 2 choice problems where we have larger state grid than choice. Here the state and choice grids are still the same just like in the az model. We in fact have the same val and pol functions, is that now we can interpret the rows as coh, whereas before the rows are asset levels. But this is just a rescaling. The mt_val and mt_pol would be identical except for the change from a = principle to a = principle + interests.</p><pre class="codeinput">mt_val_cur = zeros(length(ar_a),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="10">Solve Optimization Problem Current Iteration</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:length(ar_z)

        <span class="comment">% loop 2: over endogenous states (now cash-on-hand)</span>
        <span class="keyword">for</span> it_coh_j = 1:length(ar_a)

            <span class="comment">% Current cash on hand determined by ar and z index</span>
            fl_coh = mt_coh(it_coh_j, it_z_i);

            <span class="comment">% loop 3: over choices</span>
            ar_val_cur = zeros(size(ar_a));
            <span class="keyword">for</span> it_ap_k = 1:length(ar_a)
                fl_ap = ar_a(it_ap_k);
                fl_c = f_cons(fl_coh, fl_ap);

                <span class="comment">% current utility</span>
                <span class="keyword">if</span> (fl_crra == 1)
                    ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    fl_u_neg_c = f_util_log(fl_c_min);
                <span class="keyword">else</span>
                    ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    fl_u_neg_c = f_util_crra(fl_c_min);
                <span class="keyword">end</span>

                <span class="comment">% loop 4: add future utility, integration--loop over future shocks</span>
                <span class="keyword">for</span> it_ap_q = 1:length(ar_z)
                    ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + fl_beta*mt_z_trans(it_z_i, it_ap_q)*mt_val_cur(it_ap_k, it_ap_q);
                <span class="keyword">end</span>

                <span class="comment">% Replace if negative consumption</span>
                <span class="keyword">if</span> fl_c &lt;= 0
                    ar_val_cur(it_ap_k) = fl_u_neg_c;
                <span class="keyword">end</span>

            <span class="keyword">end</span>

            <span class="comment">% maximization over loop 3 choices for loop 1+2 states</span>
            it_max_lin_idx = find(ar_val_cur == max(ar_val_cur));
            mt_val(it_coh_j, it_z_i) = ar_val_cur(it_max_lin_idx(1));
            mt_pol_a(it_coh_j, it_z_i) = ar_a(it_max_lin_idx(1));

        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="11">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'Hval'</span>, <span class="string">'Hpol'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_a_n,:), highest a state val'</span>)
        disp(<span class="string">'mval = mt_pol_a_cur(it_a_n,:), highest a state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeoutput">VAL it_iter:5, fl_diff:7.299434e+01, fl_diff_pol:1.528523e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    4.5792    4.6232    4.6715    4.7229    4.7767    4.8327    4.8909    4.9513    5.0139    5.0788    5.1459    5.2152    5.2862     5.358    5.4283
    map     19.745    19.756    19.768    19.782    19.801    19.827    19.862    19.908    19.964    20.035    20.124    20.232    20.366    20.534    20.747
    Hval    6.2149    6.2216    6.2294    6.2381    6.2476    6.2581    6.2696    6.2821    6.2959    6.3109    6.3273    6.3452    6.3645     6.385    6.4061
    Hpol     39.72     39.72     39.72    39.786    39.786    39.786    39.853    39.853     39.92    39.987     40.12    40.187     40.32    40.521    40.721

</pre><pre class="codeoutput">VAL it_iter:10, fl_diff:3.757377e+01, fl_diff_pol:3.275416e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    6.3915    6.4758     6.569     6.668    6.7714    6.8788    6.9902    7.1056    7.2251    7.3488    7.4768    7.6088    7.7442    7.8807     8.014
    map     22.006    22.028    22.052    22.084    22.124    22.173    22.236    22.314    22.407    22.522     22.66    22.825    23.025    23.265    23.559
    Hval    9.3099    9.3302    9.3533    9.3786     9.406    9.4355    9.4671    9.5011    9.5376    9.5768    9.6189    9.6638    9.7116    9.7615    9.8118
    Hpol    44.459    44.459    44.459    44.526    44.526    44.593     44.66    44.726     44.86    44.927     45.06     45.26    45.461    45.661    45.995

</pre><pre class="codeoutput">VAL it_iter:15, fl_diff:2.115651e+01, fl_diff_pol:1.301154e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    7.3798    7.4839    7.5993    7.7221    7.8506    7.9844    8.1235     8.268    8.4182    8.5743    8.7364    8.9044    9.0774    9.2527    9.4243
    map     22.663    22.693    22.728    22.769     22.82    22.884    22.962    23.055    23.168    23.303    23.466    23.657    23.886     24.16    24.488
    Hval    11.055    11.086    11.121     11.16    11.201    11.245    11.293    11.343    11.397    11.455    11.517    11.583    11.653    11.725    11.798
    Hpol    45.861    45.928    45.928    45.995    46.061    46.128    46.195    46.262    46.395    46.529    46.729    46.862     47.13    47.397     47.73

</pre><pre class="codeoutput">VAL it_iter:20, fl_diff:1.242469e+01, fl_diff_pol:6.417428e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    7.9673    8.0807    8.2065    8.3406    8.4814    8.6282    8.7811    8.9405    9.1066    9.2798    9.4602    9.6479    9.8419    10.039    10.233
    map     22.942    22.977    23.016    23.064    23.122    23.193    23.279    23.382    23.505    23.652    23.826    24.032    24.277    24.567    24.914
    Hval    12.081    12.119    12.162    12.209     12.26    12.314    12.372    12.434      12.5    12.571    12.647    12.727    12.812    12.901     12.99
    Hpol    46.529    46.595    46.595    46.662    46.729    46.796    46.862    46.996     47.13    47.263    47.463    47.664    47.931    48.198    48.531

</pre><pre class="codeoutput">VAL it_iter:25, fl_diff:7.500730e+00, fl_diff_pol:3.538042e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.3297    8.4476    8.5785    8.7183    8.8651    9.0185    9.1785    9.3456      9.52    9.7022    9.8925    10.091    10.297    10.506    10.713
    map     23.078    23.116    23.159    23.211    23.273    23.348    23.438    23.546    23.676    23.828     24.01    24.225    24.479    24.778    25.136
    Hval    12.694    12.737    12.785    12.838    12.895    12.956    13.021     13.09    13.165    13.244    13.328    13.419    13.514    13.614    13.714
    Hpol    46.862    46.929    46.996    47.063     47.13    47.196    47.263    47.397     47.53    47.664    47.864    48.064    48.331    48.598    48.999

</pre><pre class="codeoutput">VAL it_iter:30, fl_diff:4.642368e+00, fl_diff_pol:2.053803e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.5597    8.6798    8.8132    8.9558    9.1057    9.2624    9.4261    9.5971    9.7759     9.963    10.159    10.363    10.575    10.791    11.005
    map     23.149    23.188    23.232    23.286    23.351    23.429    23.521    23.633    23.765    23.923    24.109    24.328    24.587    24.893    25.256
    Hval    13.064     13.11    13.161    13.218    13.279    13.344    13.413    13.488    13.567    13.652    13.743    13.839    13.942    14.049    14.156
    Hpol    47.063     47.13    47.196    47.263     47.33    47.397    47.463    47.597     47.73    47.864    48.064    48.331    48.598    48.865    49.266

</pre><pre class="codeoutput">VAL it_iter:35, fl_diff:2.955431e+00, fl_diff_pol:1.219826e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.7096    8.8308    8.9655    9.1095    9.2609    9.4193    9.5849    9.7579     9.939    10.129    10.327    10.534     10.75     10.97    11.188
    map     23.184    23.224    23.271    23.325    23.392    23.471    23.565    23.679    23.813    23.973    24.161    24.384    24.646    24.955    25.322
    Hval    13.288    13.336     13.39    13.448    13.512    13.579    13.652    13.729    13.812      13.9    13.995    14.096    14.203    14.315    14.427
    Hpol    47.196    47.263    47.263     47.33    47.397     47.53    47.597     47.73    47.864    48.064    48.198    48.465    48.732    49.065    49.399

</pre><pre class="codeoutput">VAL it_iter:40, fl_diff:1.944285e+00, fl_diff_pol:7.331167e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.8103     8.932    9.0673    9.2119    9.3641    9.5233    9.6898    9.8638    10.046    10.237    10.437    10.645    10.863    11.085    11.304
    map     23.202    23.243    23.289    23.344    23.412    23.492    23.587    23.702    23.837    23.999    24.189    24.413    24.677    24.988    25.358
    Hval    13.426    13.474     13.53     13.59    13.654    13.724    13.798    13.877    13.962    14.052    14.149    14.253    14.363    14.478    14.593
    Hpol    47.263     47.33     47.33    47.397    47.463    47.597    47.664    47.797    47.931    48.131    48.331    48.531    48.798    49.132    49.466

</pre><pre class="codeoutput">VAL it_iter:45, fl_diff:1.322879e+00, fl_diff_pol:4.342152e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.8798    9.0017    9.1373    9.2822    9.4347    9.5943    9.7612    9.9357    10.118     10.31     10.51     10.72    10.938    11.161    11.382
    map      23.21    23.251    23.297    23.354    23.421    23.501    23.598    23.713    23.849    24.011    24.202    24.427    24.692    25.005    25.376
    Hval    13.512    13.561    13.617    13.678    13.744    13.814    13.889    13.969    14.055    14.147    14.245     14.35    14.462    14.578    14.695
    Hpol    47.263     47.33    47.397    47.463     47.53    47.597     47.73    47.864    47.997    48.131    48.331    48.598    48.865    49.199    49.533

</pre><pre class="codeoutput">VAL it_iter:50, fl_diff:9.259303e-01, fl_diff_pol:2.946957e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.9289    9.0509    9.1866    9.3316    9.4843     9.644    9.8111    9.9858    10.169     10.36    10.561    10.771    10.989    11.213    11.434
    map     23.214    23.255    23.301    23.357    23.425    23.506    23.602    23.717    23.854    24.016    24.208    24.434    24.699    25.012    25.384
    Hval    13.569    13.618    13.674    13.735    13.801    13.872    13.947    14.028    14.115    14.207    14.306    14.412    14.525    14.642     14.76
    Hpol     47.33     47.33    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.865    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:55, fl_diff:6.610658e-01, fl_diff_pol:1.564258e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.9641    9.0861    9.2219     9.367    9.5197    9.6795    9.8466    10.021    10.204    10.396    10.597    10.807    11.026    11.249    11.471
    map     23.215    23.256    23.303    23.359    23.427    23.508    23.604     23.72    23.856    24.019     24.21    24.436    24.703    25.016    25.388
    Hval    13.607    13.656    13.713    13.774     13.84    13.911    13.987    14.068    14.154    14.247    14.347    14.453    14.566    14.683    14.802
    Hpol     47.33     47.33    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.865    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:60, fl_diff:4.777741e-01, fl_diff_pol:1.766189e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    8.9896    9.1117    9.2474    9.3925    9.5452    9.7051    9.8723    10.047     10.23    10.422    10.623    10.833    11.052    11.275    11.497
    map     23.215    23.257    23.303     23.36    23.428    23.508    23.605     23.72    23.857     24.02    24.211    24.437    24.704    25.018    25.389
    Hval    13.634    13.683    13.739    13.801    13.867    13.938    14.014    14.095    14.182    14.275    14.374    14.481    14.594    14.711     14.83
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.865    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:65, fl_diff:3.477328e-01, fl_diff_pol:1.384722e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0082    9.1303     9.266    9.4112    9.5639    9.7237    9.8909    10.066    10.249    10.441    10.642    10.852     11.07    11.294    11.516
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.605    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.653    13.702    13.759     13.82    13.886    13.957    14.033    14.114    14.201    14.294    14.394      14.5    14.613    14.731     14.85
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.865    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:70, fl_diff:2.540666e-01, fl_diff_pol:9.440678e-02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0218    9.1439    9.2796    9.4248    9.5775    9.7373    9.9045    10.079    10.263    10.454    10.655    10.865    11.084    11.308    11.529
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.666    13.716    13.772    13.834      13.9    13.971    14.047    14.128    14.215    14.308    14.408    14.514    14.627    14.745    14.864
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:75, fl_diff:1.860186e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0317    9.1538    9.2896    9.4347    9.5874    9.7473    9.9145    10.089    10.272    10.464    10.665    10.875    11.094    11.318    11.539
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.677    13.726    13.782    13.844     13.91    13.981    14.057    14.138    14.225    14.318    14.418    14.524    14.637    14.755    14.874
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:80, fl_diff:1.363483e-01, fl_diff_pol:6.675567e-02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     9.039    9.1611    9.2969     9.442    9.5947    9.7546    9.9218    10.097     10.28    10.472    10.673    10.883    11.101    11.325    11.547
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.684    13.733     13.79    13.851    13.917    13.988    14.064    14.145    14.232    14.325    14.425    14.531    14.645    14.763    14.881
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:85, fl_diff:1.000000e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0444    9.1665    9.3022    9.4474    9.6001      9.76    9.9271    10.102    10.285    10.477    10.678    10.888    11.107    11.331    11.552
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.689    13.739    13.795    13.857    13.923    13.994    14.069    14.151    14.238    14.331     14.43    14.537     14.65    14.768    14.887
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:90, fl_diff:7.336466e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0483    9.1704    9.3062    9.4513     9.604    9.7639    9.9311    10.106    10.289    10.481    10.682    10.892    11.111    11.334    11.556
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.693    13.743    13.799    13.861    13.927    13.998    14.073    14.155    14.242    14.335    14.434    14.541    14.654    14.772    14.891
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:95, fl_diff:5.383263e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0512    9.1733    9.3091    9.4542    9.6069    9.7668     9.934    10.109    10.292    10.484    10.685    10.895    11.114    11.337    11.559
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.696    13.746    13.802    13.863     13.93        14    14.076    14.157    14.244    14.337    14.437    14.544    14.657    14.775    14.894
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:100, fl_diff:3.950412e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0533    9.1754    9.3112    9.4563     9.609    9.7689    9.9361    10.111    10.294    10.486    10.687    10.897    11.116    11.339    11.561
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.698    13.748    13.804    13.866    13.932    14.003    14.078     14.16    14.247     14.34    14.439    14.546    14.659    14.777    14.896
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:105, fl_diff:2.899073e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.0549    9.1769    9.3127    9.4579    9.6106    9.7704    9.9376    10.113    10.296    10.487    10.688    10.899    11.117    11.341    11.562
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval      13.7    13.749    13.806    13.867    13.933    14.004     14.08    14.161    14.248    14.341    14.441    14.547     14.66    14.778    14.897
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeoutput">VAL it_iter:110, fl_diff:2.127584e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
Hval = mt_val_cur(it_a_n,:), highest a state val
mval = mt_pol_a_cur(it_a_n,:), highest a state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     9.056    9.1781    9.3139     9.459    9.6117    9.7716    9.9388    10.114    10.297    10.489    10.689      10.9    11.118    11.342    11.564
    map     23.215    23.257    23.304     23.36    23.428    23.509    23.606    23.721    23.858     24.02    24.212    24.438    24.705    25.018     25.39
    Hval    13.701     13.75    13.807    13.868    13.934    14.005    14.081    14.162    14.249    14.342    14.442    14.548    14.662     14.78    14.898
    Hpol     47.33    47.397    47.397    47.463     47.53    47.664     47.73    47.864    47.997    48.198    48.398    48.598    48.932    49.199    49.599

</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 3197.006840 seconds.
</pre><h2 id="13">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_oz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                 valgap      polgap        z1           z2           z3           z4           z5           z6           z7           z8           z9           z10          z11          z12          z13          z14          z15   
                ________    ________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________

    iter=1        163.25      106.07            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=2        123.62      1532.8        0.996        0.996        0.996        0.996      0.99733      0.99733      0.99733      0.99867      0.99867            1            1            1            1            1            1
    iter=3         101.3       510.9        0.988      0.99067      0.99067      0.99067      0.99333        0.992      0.99467      0.99467      0.99867      0.99867            1            1            1            1            1
    iter=4        85.313      255.33         0.98      0.98133         0.98      0.98267        0.984        0.984      0.98933      0.98933      0.99333      0.99733      0.99867            1            1            1            1
    iter=5        72.994      152.85      0.96533      0.96933      0.96933      0.97067        0.976        0.976      0.97867      0.98533        0.988      0.99333      0.99733      0.99867            1            1            1
    iter=6        63.122      101.45        0.952        0.956      0.95733      0.95733      0.96133        0.964      0.96933        0.972      0.98133      0.98667        0.992      0.99467            1            1            1
    iter=7        55.011        72.1        0.936      0.93733         0.94      0.94267      0.94933        0.952         0.96      0.96533      0.97067      0.97467      0.98267      0.99333        0.996            1            1
    iter=8         48.23      53.674      0.91733      0.91867        0.924        0.928      0.93467         0.94      0.94267      0.94933         0.96      0.96667      0.97467      0.98267        0.992      0.99867            1
    iter=9        42.487      41.346      0.89867          0.9        0.904      0.91067        0.912      0.91867      0.92667      0.93467      0.94533      0.95333        0.964      0.97333      0.98267      0.99333      0.99733
    iter=10       37.574      32.754      0.87067      0.88267        0.884      0.88933      0.89867      0.89867      0.90933      0.91733      0.92533        0.944      0.95067      0.95867        0.972         0.98      0.99067
    iter=11       33.336       26.48      0.85067      0.85467      0.86133        0.868      0.87733      0.88133      0.89067          0.9      0.90933      0.91333      0.93467      0.94533      0.95867      0.97067      0.98133
    iter=12       29.658      21.788        0.824        0.832      0.83467      0.84267      0.85067         0.86      0.86667        0.876        0.884      0.90133      0.91333      0.92667         0.94      0.95733      0.96933
    iter=13       26.448      18.147      0.79867      0.79867      0.81067      0.81333      0.81867      0.83333         0.84      0.85067        0.864        0.876      0.88933      0.90667         0.92        0.936      0.95333
    iter=14       23.633      15.331        0.764      0.77067         0.78      0.78933      0.79467      0.81067      0.81067      0.82533         0.84      0.85733        0.868      0.88533      0.89733         0.92        0.932
    iter=15       21.157      13.012        0.736      0.74533      0.74933         0.76        0.768        0.772        0.788      0.80267      0.81467      0.81867      0.84133      0.85067         0.88        0.888        0.912
    iter=16        18.97      11.166        0.708      0.70533      0.71467        0.724      0.73067         0.74      0.75333        0.768      0.77867      0.79733        0.808        0.828      0.84667      0.86267      0.88267
    iter=17       17.033      9.6453      0.66533        0.672      0.67867        0.688      0.70133        0.708      0.72267        0.732        0.748        0.764        0.776      0.79733      0.81733      0.83333      0.85467
    iter=18       15.315      8.3674        0.624        0.636      0.64267      0.65733         0.66        0.672         0.68        0.696      0.71067        0.724      0.73867      0.75867      0.77867      0.80267      0.82667
    iter=19       13.787      7.3129        0.584      0.59333      0.60133      0.61067      0.62667      0.63733      0.64267         0.66        0.672        0.692      0.70933      0.72267      0.74533        0.764        0.788
    iter=20       12.425      6.4174      0.54267      0.55467      0.55867        0.568      0.57467      0.58533      0.60667      0.61733        0.636        0.648      0.66267      0.68133      0.70267      0.72933      0.75067
    iter=21       11.209      5.6904      0.49867      0.50267      0.51467      0.52267      0.54133      0.55333      0.55867      0.57733        0.588      0.60133      0.62133      0.64667        0.664        0.684        0.708
    iter=22       10.123      5.0143      0.45467      0.45867      0.47067      0.48533        0.488      0.49867      0.51467      0.52133      0.53867         0.56      0.58133        0.596      0.62133         0.64         0.66
    iter=23       9.1515      4.4464          0.4        0.412      0.41867      0.42133      0.43733      0.44933      0.46133         0.48        0.492      0.51067      0.52533      0.54267      0.57067      0.59067        0.612
    iter=24       8.2811      3.9706      0.35067      0.35733      0.36667         0.38      0.38933          0.4      0.40933      0.42133        0.444      0.45467        0.476      0.50133        0.516         0.54        0.564
    iter=25       7.5007       3.538      0.30133        0.312        0.324      0.33733      0.33733      0.35067      0.36667        0.372      0.38933      0.40667      0.42267      0.43467        0.468      0.47733        0.512
    iter=26       6.8006      3.1256      0.27733      0.27333         0.28      0.27867      0.29733      0.30533      0.31467        0.336      0.33867      0.35333      0.37333        0.392        0.404      0.43333      0.45067
    iter=27       6.1719      2.7748        0.236        0.244        0.244      0.25467      0.26133      0.27467      0.28133      0.28533      0.30267      0.31867      0.32933        0.344      0.36133      0.38133      0.40533
    iter=28        5.607      2.4861      0.20667      0.20267      0.21467        0.232      0.23733      0.23467      0.24267      0.25333      0.26667      0.27867        0.284        0.312        0.324         0.34      0.35467
    iter=29       5.0992       2.235        0.176      0.19467      0.19467        0.188      0.19733      0.20667      0.21733        0.232      0.23067      0.24133      0.25733      0.26533        0.284        0.296      0.30933
    iter=30       4.6424      2.0538      0.16267      0.15733        0.164        0.176      0.18267      0.18267      0.19067        0.196      0.20267         0.22        0.228      0.24133        0.252      0.26933        0.284
    iter=31       4.2312       1.804      0.13467      0.14133      0.14667        0.148      0.15067      0.16267      0.16933      0.17733      0.18933      0.18667      0.19733      0.21067         0.22      0.23067      0.24933
    iter=32        3.861      1.6081         0.12        0.128      0.13467      0.13333         0.14        0.144        0.144      0.14667        0.152      0.17333      0.17733      0.19067      0.19733      0.20933      0.22267
    iter=33       3.5274      1.4222      0.11067        0.104      0.11067         0.12      0.12133      0.12267        0.132         0.14      0.14533      0.14533      0.15733        0.156      0.17467        0.184      0.19333
    iter=34       3.2267      1.2926     0.086667          0.1     0.090667     0.093333     0.098667      0.10533      0.10933        0.112      0.12133        0.128        0.136      0.14533      0.15333        0.164        0.176
    iter=35       2.9554      1.2198         0.08     0.074667     0.089333     0.090667     0.097333     0.098667     0.093333      0.10533      0.10667      0.11733      0.12133        0.124      0.13333        0.148      0.14933
    iter=36       2.7106      1.0335     0.070667     0.073333        0.072     0.078667         0.08        0.076     0.093333     0.090667     0.098667     0.098667      0.10267        0.116        0.124      0.12133      0.13467
    iter=37       2.4894     0.88282     0.061333     0.061333     0.062667     0.062667        0.064     0.073333     0.073333        0.084     0.081333        0.084     0.093333     0.097333      0.10267        0.112         0.12
    iter=38       2.2893     0.81646        0.048     0.054667     0.054667     0.054667     0.061333     0.061333        0.064         0.06     0.065333        0.076     0.081333        0.084        0.092        0.104        0.104
    iter=39       2.1083      0.8035     0.041333     0.049333     0.046667        0.052     0.049333     0.054667        0.056     0.062667     0.062667     0.069333     0.070667        0.072     0.078667     0.081333     0.090667
    iter=40       1.9443     0.73312     0.038667     0.037333        0.044     0.038667     0.046667     0.045333     0.046667        0.048     0.054667     0.062667     0.061333     0.066667        0.064     0.074667     0.078667
    iter=41       1.7955     0.67103     0.034667        0.032     0.033333     0.042667     0.037333     0.041333     0.046667     0.050667     0.053333     0.041333     0.053333     0.057333     0.065333     0.062667        0.072
    iter=42       1.6603     0.57408     0.022667     0.026667        0.028        0.028     0.033333     0.029333     0.038667     0.037333         0.04        0.044     0.037333        0.052        0.052     0.057333     0.057333
    iter=43       1.5373     0.49231     0.029333     0.022667         0.02     0.026667        0.024     0.030667     0.030667        0.032     0.029333     0.034667     0.041333     0.042667     0.045333     0.050667     0.053333
    iter=44       1.4252     0.45972     0.022667     0.018667        0.024     0.025333         0.02     0.026667         0.02     0.029333     0.030667     0.033333        0.036     0.034667     0.037333     0.046667     0.041333
    iter=45       1.3229     0.43422         0.02         0.02     0.017333        0.016     0.021333     0.018667     0.025333         0.02     0.021333     0.026667        0.028     0.030667     0.029333     0.034667     0.042667
    iter=46       1.2293      0.4063        0.012     0.013333     0.013333        0.016         0.02     0.018667     0.018667     0.017333     0.022667     0.022667     0.026667     0.022667        0.032        0.028     0.030667
    iter=47       1.1436     0.40105    0.0093333        0.012        0.016        0.012        0.012     0.017333     0.014667     0.014667     0.017333         0.02     0.021333        0.024     0.021333     0.022667     0.030667
    iter=48       1.0649     0.37008        0.012     0.010667    0.0093333     0.010667     0.013333        0.012     0.013333        0.016        0.016     0.017333        0.016     0.018667     0.021333     0.025333     0.030667
    iter=49      0.99256     0.30303    0.0066667        0.012    0.0066667    0.0093333     0.010667     0.013333     0.013333     0.010667     0.013333     0.014667     0.017333        0.016     0.017333     0.018667        0.016
    iter=50      0.92593      0.2947        0.008     0.010667        0.012        0.008    0.0093333     0.010667        0.008        0.008     0.010667    0.0093333        0.008     0.014667     0.017333        0.012     0.022667
    iter=61      0.44817     0.11562            0            0            0    0.0013333    0.0013333    0.0013333    0.0013333    0.0013333            0    0.0026667    0.0013333        0.004    0.0026667            0    0.0013333
    iter=62      0.42049     0.10801    0.0026667    0.0013333            0    0.0013333            0    0.0013333    0.0013333            0            0            0    0.0013333    0.0013333            0    0.0013333            0
    iter=63      0.39462     0.11562            0    0.0026667    0.0026667            0            0    0.0013333    0.0013333        0.004            0            0    0.0013333        0.004    0.0013333            0    0.0013333
    iter=64       0.3704    0.066756            0            0            0    0.0013333            0            0    0.0013333    0.0013333    0.0013333            0            0            0    0.0013333    0.0013333            0
    iter=65      0.34773     0.13847            0            0    0.0013333    0.0013333    0.0013333            0            0    0.0013333            0            0            0    0.0013333    0.0053333    0.0013333        0.004
    iter=66       0.3265    0.066756            0            0            0            0            0    0.0013333    0.0013333            0    0.0013333            0            0            0            0            0    0.0013333
    iter=67       0.3066    0.094407            0            0    0.0013333            0    0.0013333            0            0            0    0.0026667            0    0.0026667            0    0.0013333    0.0026667    0.0013333
    iter=68      0.28796    0.094407            0            0    0.0013333            0            0            0            0            0            0    0.0026667            0    0.0013333            0            0            0
    iter=69      0.27047    0.066756            0            0            0            0    0.0013333            0    0.0013333    0.0013333            0            0    0.0013333            0            0    0.0013333            0
    iter=70      0.25407    0.094407            0            0            0            0            0    0.0026667            0            0            0            0            0            0            0            0            0
    iter=71      0.23868    0.066756            0            0            0            0    0.0013333            0            0            0            0            0            0            0            0            0            0
    iter=72      0.22424           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=73      0.21069    0.066756            0            0            0            0            0            0            0            0            0    0.0013333            0            0            0            0            0
    iter=74      0.19796           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=75      0.18602           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=76       0.1748    0.066756            0            0            0            0            0            0            0            0            0    0.0013333            0            0            0            0            0
    iter=77      0.16427    0.066756            0            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0013333
    iter=78      0.15437    0.066756            0            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0013333
    iter=79      0.14508    0.066756            0            0            0            0            0            0            0            0    0.0013333            0    0.0013333            0            0            0            0
    iter=80      0.13635    0.066756            0            0            0            0            0            0            0            0            0            0    0.0013333            0            0            0            0
    iter=81      0.12815           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=82      0.12044           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=83       0.1132           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=84      0.10639    0.066756            0            0            0            0            0            0            0            0            0            0            0            0            0            0    0.0013333
    iter=85          0.1           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=86     0.093992           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=87     0.088345           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=88     0.083039           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=89     0.078052           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=90     0.073365           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=91      0.06896           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=92     0.064819           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=93     0.060928           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=94      0.05727           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=95     0.053833           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=96     0.050601           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=97     0.047564           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=98      0.04471           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=99     0.042026           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=100    0.039504           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=101    0.037133           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=102    0.034905           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=103     0.03281           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=104    0.030841           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=105    0.028991           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=106    0.027251           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=107    0.025616           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=108    0.024079           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=109    0.022634           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=110    0.021276           0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0

tb_val
                    z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                    __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    a1=0              -1.4949      -0.85626      -0.20565     0.43373       1.0521        1.6473        3.8352        4.3545        4.8693        5.3799         5.881       6.3588  
    a2=0.0667557      -1.2923      -0.69057     -0.070342     0.54406        1.142        1.7204        3.8744        4.3897        4.9011        5.4088        5.9074       6.3831  
    a3=0.133511       -1.1259      -0.55125      0.045823     0.64057       1.2223        1.7889        3.9132        4.4246        4.9325        5.4375        5.9337       6.4073  
    a4=0.200267      -0.97753       -0.4223       0.15627      0.7346       1.3019        1.8547        3.9516        4.4591        4.9638         5.466        5.9598       6.4313  
    a5=0.267023      -0.83825      -0.30346       0.25709      0.8197       1.3751        1.9189        3.9898        4.4934         4.995        5.4944        5.9859       6.4553  
    a6=0.333778      -0.71298      -0.19301       0.35335     0.90339       1.4464        1.9811        4.0278        4.5273         5.026        5.5226        6.0117       6.4792  
    a7=0.400534      -0.59417      -0.08862       0.44566     0.98439       1.5173        2.0406        4.0652        4.5612        5.0567        5.5506        6.0375        6.503  
    a8=0.46729       -0.47814      0.013976       0.53399        1.06       1.5839        2.0999        4.1023        4.5948        5.0873        5.5785        6.0631       6.5267  
    a9=0.534045      -0.37081       0.10984       0.61884       1.135       1.6489        2.1579        4.1389        4.6281        5.1177        5.6063        6.0886       6.5502  
    a10=0.600801     -0.26823       0.20087       0.70046      1.2078       1.7129        2.2146        4.1752        4.6612        5.1478        5.6339         6.114       6.5737  
    a11=0.667557      -0.1682       0.29061       0.77935      1.2785       1.7761        2.2697        4.2112         4.694        5.1778        5.6615        6.1392       6.5971  
    a12=0.734312    -0.072653       0.37777       0.85735      1.3462       1.8371        2.3238        4.2469        4.7266        5.2076        5.6888        6.1644       6.6204  
    a13=0.801068     0.019818       0.46154       0.93259      1.4136       1.8967        2.3776        4.2823         4.759        5.2372        5.7161        6.1894       6.6435  
    a14=0.867824      0.10928       0.54185        1.0055      1.4795        1.955        2.4304        4.3175        4.7911        5.2666        5.7431        6.2144       6.6666  
    a15=0.934579      0.19664       0.62101        1.0761      1.5436       2.0127        2.4822        4.3526         4.823        5.2959        5.7701        6.2393       6.6896  
    a16=1.00134       0.28046       0.69818        1.1457      1.6064       2.0697        2.5331        4.3873        4.8547        5.3249        5.7969         6.264       6.7126  
    a17=1.06809       0.36232       0.77352        1.2145      1.6674       2.1253        2.5833        4.4217        4.8861        5.3539        5.8236        6.2887       6.7354  
    a18=1.13485       0.44166       0.84668        1.2813      1.7279       2.1801        2.6327        4.4559        4.9175        5.3828        5.8501        6.3132       6.7582  
    a19=1.2016        0.52037       0.91792        1.3467      1.7878       2.2338        2.6816        4.4898        4.9487        5.4115        5.8765        6.3377       6.7809  
    a20=1.26836       0.59711       0.98824        1.4104      1.8462       2.2866        2.7301        4.5235        4.9796          5.44        5.9027         6.362       6.8035  
    a21=1.33511       0.67139        1.0572        1.4728      1.9036       2.3389        2.7779        4.5568        5.0104        5.4683        5.9289        6.3862        6.826  
    a22=1.40187       0.74402        1.1246         1.535      1.9599       2.3907        2.8249        4.5899         5.041        5.4965        5.9549        6.4103       6.8484  
    a23=1.46862       0.81478        1.1906         1.596      2.0151       2.4416        2.8713        4.6228        5.0714        5.5246        5.9808        6.4343       6.8708  
    a24=1.53538       0.88473        1.2552        1.6558      2.0698       2.4918        2.9172        4.6555        5.1016        5.5524        6.0066        6.4582        6.893  
    a25=1.60214       0.95387        1.3184        1.7145      2.1241       2.5413        2.9626         4.688        5.1316        5.5802        6.0323         6.482       6.9152  
    a26=1.66889        1.0212        1.3813        1.7722      2.1775       2.5901        3.0073        4.7204        5.1614        5.6078        6.0579        6.5057       6.9372  
    a27=1.73565        1.0875        1.4433        1.8288      2.2301       2.6383         3.052        4.7526         5.191        5.6352        6.0834        6.5293       6.9592  
    a28=1.8024         1.1523         1.504        1.8849      2.2818       2.6858        3.0961        4.7845        5.2205        5.6625        6.1087        6.5528       6.9811  
    a29=1.86916        1.2157        1.5635        1.9404      2.3329       2.7333        3.1397        4.8162        5.2498        5.6897         6.134        6.5762        7.003  
    a30=1.93591        1.2783        1.6222        1.9952      2.3831         2.78        3.1828        4.8478         5.279        5.7167        6.1591        6.5995       7.0247  
    a31=2.00267        1.3406        1.6797        2.0489      2.4327       2.8262        3.2254        4.8791         5.308        5.7436        6.1841        6.6228       7.0464  
    a32=2.06943        1.4015        1.7363        2.1019      2.4822       2.8718        3.2675        4.9102        5.3369        5.7705         6.209        6.6459        7.068  
    a33=2.13618        1.4615        1.7928        2.1542       2.531       2.9169        3.3093        4.9411        5.3657        5.7972        6.2337         6.669       7.0895  
    a34=2.20294        1.5205        1.8485        2.2058      2.5792       2.9615        3.3507        4.9718        5.3942        5.8237        6.2584         6.692       7.1109  
    a35=2.26969        1.5786        1.9034        2.2566      2.6268       3.0056        3.3917        5.0023        5.4227        5.8502         6.283        6.7149       7.1323  
    a36=2.33645        1.6358        1.9574        2.3073      2.6738       3.0493        3.4325        5.0326         5.451        5.8765        6.3074        6.7377       7.1536  
    a37=2.4032         1.6921        2.0106        2.3574      2.7203       3.0927         3.473        5.0627        5.4791        5.9027        6.3317        6.7605       7.1748  
    a38=2.46996        1.7482        2.0631        2.4068      2.7663       3.1358         3.513        5.0928        5.5071        5.9287         6.356        6.7831        7.196  
    a39=2.53672        1.8035        2.1149        2.4556      2.8116       3.1784        3.5527        5.1228        5.5349        5.9546        6.3801        6.8056       7.2171  
    a40=2.60347         1.858         2.166        2.5038      2.8567       3.2206         3.592        5.1525        5.5626        5.9804        6.4042        6.8281       7.2381  
    a41=2.67023        1.9117         2.217        2.5514      2.9016       3.2623         3.631        5.1821        5.5901        6.0061        6.4281        6.8504        7.259  
    a42=2.73698        1.9647        2.2673        2.5985      2.9459       3.3037        3.6695        5.2115        5.6175        6.0317         6.452        6.8727       7.2799  
    a43=2.80374        2.0171        2.3171         2.645      2.9897       3.3446        3.7078        5.2408        5.6447        6.0571        6.4758        6.8949       7.3007  
    a44=2.87049        2.0688        2.3662        2.6911      3.0331       3.3852        3.7459        5.2699        5.6718        6.0824        6.4995         6.917       7.3214  
    a45=2.93725        2.1198        2.4147         2.737      3.0761       3.4254        3.7836        5.2988        5.6988        6.1076        6.5231         6.939       7.3421  
    a46=3.00401        2.1705        2.4626        2.7824      3.1187       3.4653         3.821        5.3275        5.7258        6.1327        6.5466        6.9609       7.3627  
    a47=3.07076        2.2208          2.51        2.8274      3.1608        3.505        3.8583        5.3561        5.7525        6.1578          6.57        6.9828       7.3832  
    a48=3.13752        2.2704         2.557        2.8719      3.2025       3.5444        3.8953        5.3845        5.7792        6.1828        6.5933        7.0046       7.4036  
    a49=3.20427        2.3195        2.6034        2.9158      3.2438       3.5835         3.932        5.4128        5.8057        6.2076        6.6166        7.0263        7.424  
    a50=3.27103         2.368        2.6496        2.9594       3.285       3.6223        3.9684        5.4409        5.8321        6.2323        6.6397         7.048       7.4443  
    a701=46.729         13.32        13.373        13.432      13.498       13.568        13.643        14.001        14.106        14.219        14.338        14.463       14.588  
    a702=46.7957       13.328         13.38         13.44      13.506       13.576        13.651        14.008        14.113        14.226        14.345         14.47       14.595  
    a703=46.8625       13.336        13.388        13.448      13.513       13.583        13.658        14.015         14.12        14.233        14.352        14.476       14.601  
    a704=46.9292       13.344        13.396        13.456      13.521       13.591        13.666        14.022        14.127        14.239        14.359        14.483       14.608  
    a705=46.996        13.352        13.404        13.464      13.529       13.599        13.674        14.029        14.134        14.246        14.365        14.489       14.614  
    a706=47.0628        13.36        13.412        13.472      13.537       13.606        13.681        14.036        14.141        14.253        14.372        14.496       14.621  
    a707=47.1295       13.368         13.42         13.48      13.544       13.614        13.689        14.043        14.148         14.26        14.379        14.503       14.627  
    a708=47.1963       13.376        13.428        13.487      13.552       13.622        13.696        14.051        14.155        14.267        14.386        14.509       14.634  
    a709=47.263        13.384        13.436        13.495       13.56       13.629        13.704        14.058        14.162        14.274        14.392        14.516        14.64  
    a710=47.3298       13.392        13.444        13.503      13.568       13.637        13.711        14.065        14.169        14.281        14.399        14.522       14.647  
    a711=47.3965         13.4        13.452        13.511      13.575       13.645        13.719        14.072        14.176        14.288        14.406        14.529       14.653  
    a712=47.4633       13.407        13.459        13.518      13.583       13.652        13.726        14.079        14.183        14.294        14.412        14.536       14.659  
    a713=47.53         13.415        13.467        13.526      13.591        13.66        13.734        14.086         14.19        14.301        14.419        14.542       14.666  
    a714=47.5968       13.423        13.475        13.534      13.598       13.667        13.741        14.093        14.197        14.308        14.426        14.549       14.672  
    a715=47.6636       13.431        13.483        13.542      13.606       13.675        13.749          14.1        14.204        14.315        14.432        14.555       14.679  
    a716=47.7303       13.439        13.491        13.549      13.614       13.683        13.756        14.107        14.211        14.322        14.439        14.562       14.685  
    a717=47.7971       13.447        13.499        13.557      13.621        13.69        13.764        14.114        14.218        14.328        14.446        14.568       14.691  
    a718=47.8638       13.455        13.506        13.565      13.629       13.698        13.771        14.121        14.225        14.335        14.452        14.575       14.698  
    a719=47.9306       13.463        13.514        13.573      13.637       13.705        13.779        14.128        14.232        14.342        14.459        14.581       14.704  
    a720=47.9973        13.47        13.522         13.58      13.644       13.713        13.786        14.135        14.239        14.349        14.466        14.588       14.711  
    a721=48.0641       13.478         13.53        13.588      13.652        13.72        13.794        14.142        14.246        14.356        14.472        14.594       14.717  
    a722=48.1308       13.486        13.537        13.596      13.659       13.728        13.801         14.15        14.252        14.362        14.479        14.601       14.723  
    a723=48.1976       13.494        13.545        13.603      13.667       13.735        13.809        14.157        14.259        14.369        14.486        14.607        14.73  
    a724=48.2644       13.502        13.553        13.611      13.675       13.743        13.816        14.163        14.266        14.376        14.492        14.614       14.736  
    a725=48.3311       13.509        13.561        13.619      13.682        13.75        13.823         14.17        14.273        14.383        14.499         14.62       14.742  
    a726=48.3979       13.517        13.568        13.626       13.69       13.758        13.831        14.177         14.28        14.389        14.506        14.627       14.749  
    a727=48.4646       13.525        13.576        13.634      13.697       13.765        13.838        14.184        14.287        14.396        14.512        14.633       14.755  
    a728=48.5314       13.533        13.584        13.642      13.705       13.773        13.846        14.191        14.294        14.403        14.519         14.64       14.761  
    a729=48.5981        13.54        13.591        13.649      13.712        13.78        13.853        14.198          14.3         14.41        14.525        14.646       14.768  
    a730=48.6649       13.548        13.599        13.657       13.72       13.788         13.86        14.205        14.307        14.416        14.532        14.653       14.774  
    a731=48.7316       13.556        13.607        13.664      13.727       13.795        13.868        14.212        14.314        14.423        14.538        14.659        14.78  
    a732=48.7984       13.564        13.614        13.672      13.735       13.803        13.875        14.219        14.321         14.43        14.545        14.665       14.787  
    a733=48.8652       13.571        13.622         13.68      13.742        13.81        13.882        14.226        14.328        14.436        14.552        14.672       14.793  
    a734=48.9319       13.579         13.63        13.687       13.75       13.817         13.89        14.233        14.334        14.443        14.558        14.678       14.799  
    a735=48.9987       13.587        13.637        13.695      13.757       13.825        13.897         14.24        14.341         14.45        14.565        14.685       14.805  
    a736=49.0654       13.594        13.645        13.702      13.765       13.832        13.904        14.247        14.348        14.456        14.571        14.691       14.812  
    a737=49.1322       13.602        13.653         13.71      13.772        13.84        13.911        14.254        14.355        14.463        14.578        14.697       14.818  
    a738=49.1989        13.61         13.66        13.717       13.78       13.847        13.919        14.261        14.362         14.47        14.584        14.704       14.824  
    a739=49.2657       13.617        13.668        13.725      13.787       13.854        13.926        14.267        14.368        14.476        14.591         14.71        14.83  
    a740=49.3324       13.625        13.675        13.732      13.795       13.862        13.933        14.274        14.375        14.483        14.597        14.717       14.837  
    a741=49.3992       13.633        13.683         13.74      13.802       13.869        13.941        14.281        14.382        14.489        14.604        14.723       14.843  
    a742=49.466         13.64        13.691        13.747      13.809       13.876        13.948        14.288        14.389        14.496         14.61        14.729       14.849  
    a743=49.5327       13.648        13.698        13.755      13.817       13.884        13.955        14.295        14.395        14.503        14.617        14.736       14.855  
    a744=49.5995       13.656        13.706        13.762      13.824       13.891        13.962        14.302        14.402        14.509        14.623        14.742       14.862  
    a745=49.6662       13.663        13.713         13.77      13.832       13.898        13.969        14.308        14.409        14.516         14.63        14.748       14.868  
    a746=49.733        13.671        13.721        13.777      13.839       13.905        13.977        14.315        14.415        14.522        14.636        14.755       14.874  
    a747=49.7997       13.678        13.728        13.785      13.846       13.913        13.984        14.322        14.422        14.529        14.642        14.761        14.88  
    a748=49.8665       13.686        13.736        13.792      13.854        13.92        13.991        14.329        14.429        14.536        14.649        14.767       14.886  
    a749=49.9332       13.693        13.743          13.8      13.861       13.927        13.998        14.336        14.435        14.542        14.655        14.774       14.892  
    a750=50            13.701        13.751        13.807      13.868       13.935        14.005        14.342        14.442        14.549        14.662         14.78       14.899  

tb_pol_a
                    z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                    __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    a1=0                    0             0            0            0             0             0      0.20027       0.33378       0.53405       0.73431        1.0013       1.3351  
    a2=0.0667557            0             0            0            0             0             0      0.26702       0.40053        0.6008       0.80107        1.0681       1.4019  
    a3=0.133511             0             0            0            0      0.066756      0.066756      0.33378       0.46729       0.66756       0.86782        1.1348       1.4686  
    a4=0.200267      0.066756      0.066756     0.066756     0.066756      0.066756      0.066756      0.40053       0.53405       0.66756       0.93458        1.2016       1.5354  
    a5=0.267023      0.066756      0.066756     0.066756     0.066756       0.13351       0.13351      0.40053        0.6008       0.73431        1.0013        1.2684       1.6021  
    a6=0.333778       0.13351       0.13351      0.13351      0.13351       0.13351       0.20027      0.46729        0.6008       0.80107        1.0681        1.3351       1.6689  
    a7=0.400534       0.13351       0.20027      0.20027      0.20027       0.20027       0.20027      0.53405       0.66756       0.86782        1.1348        1.4019       1.7356  
    a8=0.46729        0.20027       0.20027      0.20027      0.20027       0.26702       0.26702       0.6008       0.73431       0.93458        1.2016        1.4686       1.8024  
    a9=0.534045       0.26702       0.26702      0.26702      0.26702       0.33378       0.33378      0.66756       0.80107        1.0013        1.2684        1.5354       1.8692  
    a10=0.600801      0.26702       0.33378      0.33378      0.33378       0.33378       0.40053      0.73431       0.86782        1.0681        1.2684        1.6021       1.9359  
    a11=0.667557      0.33378       0.33378      0.40053      0.40053       0.40053       0.46729      0.80107       0.93458        1.1348        1.3351        1.6689       2.0027  
    a12=0.734312      0.40053       0.40053      0.40053      0.46729       0.46729       0.53405      0.86782        1.0013        1.2016        1.4019        1.7356       2.0694  
    a13=0.801068      0.46729       0.46729      0.46729      0.46729       0.53405       0.53405      0.93458        1.0681        1.2684        1.4686        1.7356       2.1362  
    a14=0.867824      0.46729       0.53405      0.53405      0.53405        0.6008        0.6008      0.93458        1.1348        1.3351        1.5354        1.8024       2.2029  
    a15=0.934579      0.53405       0.53405       0.6008       0.6008        0.6008       0.66756       1.0013        1.2016        1.4019        1.6021        1.8692       2.2697  
    a16=1.00134        0.6008        0.6008       0.6008      0.66756       0.66756       0.73431       1.0681        1.2684        1.4019        1.6689        1.9359       2.2697  
    a17=1.06809       0.66756       0.66756      0.66756      0.73431       0.73431       0.80107       1.1348        1.3351        1.4686        1.7356        2.0027       2.3364  
    a18=1.13485       0.73431       0.73431      0.73431      0.73431       0.80107       0.86782       1.2016        1.3351        1.5354        1.8024        2.0694       2.4032  
    a19=1.2016        0.73431       0.80107      0.80107      0.80107       0.86782       0.86782       1.2684        1.4019        1.6021        1.8692        2.1362         2.47  
    a20=1.26836       0.80107       0.80107      0.86782      0.86782       0.93458       0.93458       1.3351        1.4686        1.6689        1.9359        2.2029       2.5367  
    a21=1.33511       0.86782       0.86782      0.86782      0.93458       0.93458        1.0013       1.4019        1.5354        1.7356        2.0027        2.2697       2.6035  
    a22=1.40187       0.93458       0.93458      0.93458       1.0013        1.0013        1.0681       1.4686        1.6021        1.8024        2.0694        2.3364       2.6702  
    a23=1.46862        1.0013        1.0013       1.0013       1.0681        1.0681        1.1348       1.5354        1.6689        1.8692        2.1362        2.4032        2.737  
    a24=1.53538        1.0013        1.0681       1.0681       1.0681        1.1348        1.2016       1.6021        1.7356        1.9359        2.1362          2.47       2.8037  
    a25=1.60214        1.0681        1.1348       1.1348       1.1348        1.2016        1.2684       1.6021        1.8024        2.0027        2.2029        2.5367       2.8705  
    a26=1.66889        1.1348        1.1348       1.2016       1.2016        1.2684        1.3351       1.6689        1.8692        2.0694        2.2697        2.6035       2.9372  
    a27=1.73565        1.2016        1.2016       1.2684       1.2684        1.3351        1.3351       1.7356        1.9359        2.1362        2.3364        2.6702        3.004  
    a28=1.8024         1.2684        1.2684       1.2684       1.3351        1.3351        1.4019       1.8024        2.0027        2.2029        2.4032         2.737       3.0708  
    a29=1.86916        1.3351        1.3351       1.3351       1.4019        1.4019        1.4686       1.8692        2.0694        2.2697          2.47        2.8037       3.1375  
    a30=1.93591        1.3351        1.4019       1.4019       1.4686        1.4686        1.5354       1.9359        2.1362        2.2697        2.5367        2.8037       3.2043  
    a31=2.00267        1.4019        1.4686       1.4686       1.4686        1.5354        1.6021       2.0027        2.1362        2.3364        2.6035        2.8705        3.271  
    a32=2.06943        1.4686        1.4686       1.5354       1.5354        1.6021        1.6689       2.0694        2.2029        2.4032        2.6702        2.9372       3.3378  
    a33=2.13618        1.5354        1.5354       1.6021       1.6021        1.6689        1.7356       2.1362        2.2697          2.47         2.737         3.004       3.4045  
    a34=2.20294        1.6021        1.6021       1.6689       1.6689        1.7356        1.8024       2.2029        2.3364        2.5367        2.8037        3.0708       3.4713  
    a35=2.26969        1.6689        1.6689       1.6689       1.7356        1.8024        1.8692       2.2697        2.4032        2.6035        2.8705        3.1375       3.4713  
    a36=2.33645        1.7356        1.7356       1.7356       1.8024        1.8692        1.8692       2.3364          2.47        2.6702        2.9372        3.2043       3.5381  
    a37=2.4032         1.8024        1.8024       1.8024       1.8692        1.8692        1.9359       2.3364        2.5367         2.737         3.004         3.271       3.6048  
    a38=2.46996        1.8024        1.8692       1.8692       1.9359        1.9359        2.0027       2.4032        2.6035        2.8037        3.0708        3.3378       3.6716  
    a39=2.53672        1.8692        1.9359       1.9359       2.0027        2.0027        2.0694         2.47        2.6702        2.8705        3.1375        3.4045       3.7383  
    a40=2.60347        1.9359        1.9359       2.0027       2.0027        2.0694        2.1362       2.5367         2.737        2.9372        3.2043        3.4713       3.8051  
    a41=2.67023        2.0027        2.0027       2.0694       2.0694        2.1362        2.2029       2.6035        2.8037         3.004        3.2043        3.5381       3.8718  
    a42=2.73698        2.0694        2.0694       2.1362       2.1362        2.2029        2.2697       2.6702        2.8705        3.0708         3.271        3.6048       3.9386  
    a43=2.80374        2.1362        2.1362       2.2029       2.2029        2.2697        2.3364        2.737        2.9372        3.1375        3.3378        3.6716       4.0053  
    a44=2.87049        2.2029        2.2029       2.2029       2.2697        2.3364        2.4032       2.8037         3.004        3.2043        3.4045        3.7383       4.0721  
    a45=2.93725        2.2697        2.2697       2.2697       2.3364        2.4032          2.47       2.8705         3.004         3.271        3.4713        3.8051       4.1389  
    a46=3.00401        2.2697        2.3364       2.3364       2.4032          2.47          2.47       2.9372        3.0708         3.271        3.5381        3.8718       4.2056  
    a47=3.07076        2.3364        2.4032       2.4032         2.47          2.47        2.5367        3.004        3.1375        3.3378        3.6048        3.9386       4.2724  
    a48=3.13752        2.4032          2.47         2.47       2.5367        2.5367        2.6035       3.0708        3.2043        3.4045        3.6716        3.9386       4.3391  
    a49=3.20427          2.47          2.47       2.5367       2.6035        2.6035        2.6702       3.1375         3.271        3.4713        3.7383        4.0053       4.4059  
    a50=3.27103        2.5367        2.5367       2.6035       2.6035        2.6702         2.737       3.2043        3.3378        3.5381        3.8051        4.0721       4.4726  
    a701=46.729        44.126        44.192       44.259       44.326        44.393        44.459       44.993        45.194        45.461        45.728        46.061       46.395  
    a702=46.7957       44.192        44.259       44.326       44.393        44.459        44.526        45.06         45.26        45.527        45.794        46.128       46.462  
    a703=46.8625       44.259        44.326       44.393       44.459        44.526        44.593       45.127        45.327        45.594        45.861        46.195       46.529  
    a704=46.9292       44.326        44.393       44.459       44.526        44.593         44.66       45.194        45.394        45.661        45.928        46.262       46.595  
    a705=46.996        44.393        44.459       44.526       44.593         44.66        44.726        45.26        45.461        45.728        45.995        46.328       46.662  
    a706=47.0628       44.459        44.526       44.593        44.66        44.726        44.793       45.327        45.527        45.794        46.061        46.395       46.729  
    a707=47.1295       44.526        44.593        44.66       44.726        44.793         44.86       45.394        45.594        45.861        46.128        46.462       46.796  
    a708=47.1963       44.593         44.66       44.726       44.793         44.86        44.927       45.461        45.661        45.928        46.195        46.529       46.862  
    a709=47.263         44.66        44.726       44.793       44.793        44.927        44.993       45.527        45.728        45.995        46.262        46.595       46.929  
    a710=47.3298       44.726        44.793        44.86        44.86        44.993         45.06       45.594        45.794        46.061        46.328        46.595       46.996  
    a711=47.3965       44.793         44.86        44.86       44.927         45.06        45.127       45.661        45.861        46.128        46.395        46.662       47.063  
    a712=47.4633        44.86        44.927       44.927       44.993        45.127        45.194       45.728        45.928        46.128        46.462        46.729        47.13  
    a713=47.53         44.927        44.993       44.993        45.06        45.194         45.26       45.794        45.995        46.195        46.529        46.796       47.196  
    a714=47.5968       44.993         45.06        45.06       45.127        45.194        45.327       45.861        46.061        46.262        46.595        46.862       47.263  
    a715=47.6636        45.06        45.127       45.127       45.194         45.26        45.394       45.928        46.128        46.328        46.662        46.929        47.33  
    a716=47.7303       45.127        45.194       45.194        45.26        45.327        45.461       45.995        46.195        46.395        46.662        46.996       47.397  
    a717=47.7971       45.194         45.26        45.26       45.327        45.394        45.527       46.061        46.262        46.462        46.729        47.063       47.463  
    a718=47.8638        45.26         45.26       45.327       45.394        45.461        45.594       46.128        46.328        46.529        46.796         47.13        47.53  
    a719=47.9306       45.327        45.327       45.394       45.461        45.527        45.661       46.195        46.395        46.595        46.862        47.196       47.597  
    a720=47.9973       45.394        45.394       45.461       45.527        45.594        45.728       46.262        46.462        46.662        46.929        47.263       47.664  
    a721=48.0641       45.461        45.461       45.527       45.594        45.661        45.794       46.328        46.529        46.729        46.996         47.33        47.73  
    a722=48.1308       45.527        45.527       45.594       45.661        45.728        45.861       46.395        46.595        46.796        47.063        47.397       47.797  
    a723=48.1976       45.594        45.594       45.661       45.728        45.794        45.928       46.462        46.662        46.862         47.13        47.463       47.864  
    a724=48.2644       45.661        45.661       45.728       45.794        45.861        45.995       46.529        46.729        46.929        47.196         47.53       47.931  
    a725=48.3311       45.728        45.728       45.794       45.861        45.928        45.995       46.595        46.796        46.996        47.263        47.597       47.997  
    a726=48.3979       45.794        45.794       45.861       45.928        45.995        46.061       46.662        46.862        47.063         47.33        47.664       48.064  
    a727=48.4646       45.861        45.861       45.928       45.995        46.061        46.128       46.729        46.929         47.13        47.397         47.73       48.131  
    a728=48.5314       45.928        45.928       45.995       46.061        46.128        46.195       46.796        46.996        47.196        47.463        47.797       48.198  
    a729=48.5981       45.928        45.995       46.061       46.128        46.195        46.262       46.862        47.063        47.263         47.53        47.864       48.264  
    a730=48.6649       45.995        46.061       46.128       46.195        46.262        46.328       46.862        47.063         47.33        47.597        47.931       48.331  
    a731=48.7316       46.061        46.128       46.195       46.262        46.328        46.395       46.929         47.13        47.397        47.664        47.997       48.398  
    a732=48.7984       46.128        46.195       46.262       46.328        46.395        46.462       46.996        47.196        47.463         47.73        48.064       48.465  
    a733=48.8652       46.195        46.262       46.328       46.395        46.462        46.529       47.063        47.263         47.53        47.797        48.131       48.531  
    a734=48.9319       46.262        46.328       46.395       46.462        46.529        46.595        47.13         47.33        47.597        47.864        48.198       48.531  
    a735=48.9987       46.328        46.395       46.462       46.529        46.595        46.662       47.196        47.397        47.664        47.931        48.264       48.598  
    a736=49.0654       46.395        46.462       46.529       46.595        46.662        46.729       47.263        47.463         47.73        47.997        48.331       48.665  
    a737=49.1322       46.462        46.529       46.595       46.662        46.729        46.796        47.33         47.53        47.797        48.064        48.398       48.732  
    a738=49.1989       46.529        46.595       46.662       46.729        46.796        46.862       47.397        47.597        47.864        48.131        48.465       48.798  
    a739=49.2657       46.595        46.662       46.729       46.796        46.862        46.929       47.463        47.664        47.931        48.198        48.531       48.865  
    a740=49.3324       46.662        46.729       46.796       46.862        46.929        46.996        47.53         47.73        47.997        48.264        48.598       48.932  
    a741=49.3992       46.729        46.796       46.862       46.929        46.996        47.063       47.597        47.797        48.064        48.331        48.665       48.999  
    a742=49.466        46.796        46.862       46.929       46.996        47.063         47.13       47.664        47.864        48.131        48.398        48.732       49.065  
    a743=49.5327       46.862        46.929       46.996       46.996         47.13        47.196        47.73        47.931        48.198        48.465        48.798       49.132  
    a744=49.5995       46.929        46.996       47.063       47.063        47.196        47.263       47.797        47.997        48.264        48.531        48.865       49.199  
    a745=49.6662       46.996        47.063       47.063        47.13        47.263         47.33       47.864        48.064        48.331        48.598        48.865       49.266  
    a746=49.733        47.063         47.13        47.13       47.196         47.33        47.397       47.931        48.131        48.398        48.665        48.932       49.332  
    a747=49.7997        47.13        47.196       47.196       47.263         47.33        47.463       47.997        48.198        48.398        48.732        48.999       49.399  
    a748=49.8665       47.196        47.263       47.263        47.33        47.397         47.53       48.064        48.264        48.465        48.798        49.065       49.466  
    a749=49.9332       47.263         47.33        47.33       47.397        47.463        47.597       48.131        48.331        48.531        48.865        49.132       49.533  
    a750=50             47.33        47.397       47.397       47.463         47.53        47.664       48.198        48.398        48.598        48.932        49.199       49.599  

</pre><img vspace="5" hspace="5" src="ff_oz_vf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_02.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_03.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_04.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_oz_vf_07.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function result_map = ff_oz_vf(varargin)
%% FF_OZ_VF solve infinite horizon exo shock + cash-on-hand problem
% similar to
% <https://fanwangecon.github.io/CodeDynaAsset/m_az/solve/html/ff_az_vf.html
% ff_az_vf> except that rather than savings/borrow, cash-on-hand is the
% endogenous asset variable. The solution algorithm is basically the same.
% The algorithm varies more when there are two assets for states and
% choices. One difference is that now a = principle + interests, rather
% than just principles in the az model. So functions change accordingly.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables. 
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/paramfunc/ffs_oz_set_default_param.m ffs_oz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/paramfunc/ffs_oz_get_funcgrid.m ffs_oz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_oz/solvepost/ff_oz_vf_post.m ff_oz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_oz_set_default_param(it_param_set);
[armt_map, func_map] = ffs_oz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_oz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_oz_vf';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_a', 'mt_z_trans', 'ar_z', 'mt_coh'});
[ar_a, mt_z_trans, ar_z, mt_coh] = params_group{:};
% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};
% param_map
params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w',...
    'it_a_n', 'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min'});
[fl_r_save, fl_r_borr, fl_wage, it_a_n, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes
% now val and pol matrix rows = size(ar_coh, 1) = length(ar_a). note that
% this is different from 2 choice problems where we have larger state grid
% than choice. Here the state and choice grids are still the same just like
% in the az model. We in fact have the same val and pol functions, is that
% now we can interpret the rows as coh, whereas before the rows are asset
% levels. But this is just a rescaling. The mt_val and mt_pol would be
% identical except for the change from a = principle to a = principle +
% interests.

mt_val_cur = zeros(length(ar_a),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_a),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;
    
    %% Solve Optimization Problem Current Iteration
    
    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)
        
        % loop 2: over endogenous states (now cash-on-hand)        
        for it_coh_j = 1:length(ar_a)
            
            % Current cash on hand determined by ar and z index
            fl_coh = mt_coh(it_coh_j, it_z_i);
                        
            % loop 3: over choices
            ar_val_cur = zeros(size(ar_a));
            for it_ap_k = 1:length(ar_a)
                fl_ap = ar_a(it_ap_k);
                fl_c = f_cons(fl_coh, fl_ap);
                
                % current utility
                if (fl_crra == 1)
                    ar_val_cur(it_ap_k) = f_util_log(fl_c);
                    fl_u_neg_c = f_util_log(fl_c_min);
                else
                    ar_val_cur(it_ap_k) = f_util_crra(fl_c);
                    fl_u_neg_c = f_util_crra(fl_c_min);
                end

                % loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
                for it_ap_q = 1:length(ar_z)
                    ar_val_cur(it_ap_k) = ar_val_cur(it_ap_k) + fl_beta*mt_z_trans(it_z_i, it_ap_q)*mt_val_cur(it_ap_k, it_ap_q);
                end
                
                % Replace if negative consumption
                if fl_c <= 0
                    ar_val_cur(it_ap_k) = fl_u_neg_c;
                end
                
            end
            
            % maximization over loop 3 choices for loop 1+2 states
            it_max_lin_idx = find(ar_val_cur == max(ar_val_cur));
            mt_val(it_coh_j, it_z_i) = ar_val_cur(it_max_lin_idx(1));
            mt_pol_a(it_coh_j, it_z_i) = ar_a(it_max_lin_idx(1));
            
        end
    end
    
    %% Check Tolerance and Continuation
    
    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur);
    mt_pol_perc_change(it_iter, :) = sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n);
    
    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    
    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1); mean(mt_pol_a_cur,1); ...
            mt_val_cur(it_a_n,:); mt_pol_a_cur(it_a_n,:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'Hval', 'Hpol'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('Hval = mt_val_cur(it_a_n,:), highest a state val')
        disp('mval = mt_pol_a_cur(it_a_n,:), highest a state choice')
        disp(tb_valpol_iter);
    end
    
    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;        
    end
    
end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_a') = mt_pol_a;

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    result_map = ff_oz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>