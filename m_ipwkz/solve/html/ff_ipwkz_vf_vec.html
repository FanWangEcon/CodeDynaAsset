
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_ipwkz_vf_vec</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-06-07"><meta name="DC.source" content="ff_ipwkz_vf_vec.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKZ_VF_VEC solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2</a></li><li><a href="#6">Initialize Output Matrixes</a></li><li><a href="#7">Initialize Convergence Conditions</a></li><li><a href="#8">Pre-calculate u(c)</a></li><li><a href="#9">Iterate Value Function</a></li><li><a href="#11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</a></li><li><a href="#12">Solve Second Stage Problem k*(w,z)</a></li><li><a href="#13">Solve First Stage Problem w*(z) given k*(w,z)</a></li><li><a href="#14">Check Tolerance and Continuation</a></li><li><a href="#16">Process Optimal Choices</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> result_map = ff_ipwkz_vf_vec(varargin)
</pre><h2 id="2">FF_IPWKZ_VF_VEC solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the two step solution with interpolation and with percentage asset grids version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vec.html">ff_iwkz_vf_vec</a>. See that file for more descriptions.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ff_ipwkz_evf.m">ff_ipwkz_evf</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_set_default_param.m">ffs_ipwkz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_get_funcgrid.m">ffs_ipwkz_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkz_set_default_param(it_param_set);

<span class="comment">% parameters can be set inside ffs_ipwkz_set_default_param or updated here</span>
<span class="comment">% param_map('it_w_perc_n') = 50;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('it_z_n') = 15;</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.025;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 0.001;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.25;</span>

<span class="comment">% get armt and func map</span>
[armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkz_vf_vec'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% armt_map</span>
params_group = values(armt_map, {<span class="string">'ar_w_perc'</span>, <span class="string">'ar_w_level'</span>, <span class="string">'ar_z'</span>});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {<span class="string">'ar_interp_c_grid'</span>, <span class="string">'ar_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z'</span>, <span class="string">'mt_z_mesh_coh_interp_grid'</span>,<span class="keyword">...</span>
    <span class="string">'mt_w_by_interp_coh_interp_grid'</span>});
[ar_interp_c_grid, ar_interp_coh_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, <span class="keyword">...</span>
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {<span class="string">'mt_coh_wkb'</span>, <span class="string">'mt_z_mesh_coh_wkb'</span>});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_r_borr'</span>, <span class="string">'fl_w'</span>,<span class="keyword">...</span>
    <span class="string">'it_z_n'</span>, <span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="string">'fl_c_min'</span>});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};
</pre><h2 id="6">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));
</pre><h2 id="7">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="8">Pre-calculate u(c)</h2><p>Interpolation, see <a href="https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html">fs_u_c_partrepeat_main</a> for why interpolate over u(c)</p><pre class="codeinput"><span class="comment">% Evaluate</span>
<span class="keyword">if</span> (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_neg_c = f_util_log(fl_c_min);
<span class="keyword">else</span>
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_neg_c = f_util_crra(fl_c_min);
<span class="keyword">end</span>
ar_interp_u_of_c_grid(ar_interp_c_grid &lt;= fl_c_min) = fl_u_neg_c;

<span class="comment">% Get Interpolant</span>
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, <span class="string">'spline'</span>);
</pre><h2 id="9">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="11">Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)</h2><p>v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see ffs_ipwkz_get_funcgrid.m. Generate interpolant based on that, Then interpolate for the coh reachable levels given the k(w,z) percentage choice grids in the second stage of the problem</p><pre class="codeinput">    <span class="comment">% Generate Interpolant for v(coh,z)</span>
    f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', <span class="string">'linear'</span>);

    <span class="comment">% Interpoalte for v(coh(k(w,z),b(w,z),z),z)</span>
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
</pre><h2 id="12">Solve Second Stage Problem k*(w,z)</h2><p>This is the key difference between this function and <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> which solves the two stages jointly Interpolation first, because solution coh grid is not the same as all points reachable by k and b choices given w.</p><pre class="codeinput">    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = <span class="keyword">...</span>
        ff_ipwkz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
</pre><h2 id="13">Solve First Stage Problem w*(z) given k*(w,z)</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:length(ar_z)

        <span class="comment">% State Array fixed</span>
        ar_coh_z = mt_interp_coh_grid_mesh_z(:,it_z_i);

        <span class="comment">% Get 2nd Stage Arrays</span>
        ar_ev_condi_z_max_z = mt_ev_condi_z_max(:, it_z_i);
        ar_w_level_kstar_z = mt_ev_condi_z_max_kp(:, it_z_i);

        <span class="comment">% Interpolate (2) k*(ar_w_perc) from k*(ar_w_level,z)</span>
        <span class="comment">% There are two w=k'+b' arrays. ar_w_level is the level even grid based</span>
        <span class="comment">% on which we solve the 2nd stage problem in ff_ipwkz_evf.m. Here for</span>
        <span class="comment">% each coh level, we have a different vector of w levels, but the same</span>
        <span class="comment">% vector of percentage ws. So we need to interpolate to get the optimal</span>
        <span class="comment">% k* and b* choices at each percentage level of w.</span>
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, ar_w_level_kstar_z', <span class="string">'linear'</span>);

        <span class="comment">% Interpolant for (3) EV(k*(ar_w_perc),Z)</span>
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, ar_ev_condi_z_max_z', <span class="string">'linear'</span>);

        <span class="comment">% Interpolat (2) and (3)</span>
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);

        <span class="comment">% Consumption</span>
        <span class="comment">% Note that compared to</span>
        <span class="comment">% &lt;https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html</span>
        <span class="comment">% ffs_akz_set_functions&gt; the mt_c here is much smaller the same</span>
        <span class="comment">% number of columns (states) as in the ffs_akz_set_functions file,</span>
        <span class="comment">% but the number of rows equal to ar_w length.</span>
        mt_c = f_cons(ar_coh_z', mt_w_astar_interp_z, mt_w_kstar_interp_z);

        <span class="comment">% Interpolate for (4) EVAL current utility: N by N, f_util defined earlier</span>
        mt_utility = f_grid_interpolant_spln(mt_c);

        <span class="comment">% EVAL add on future utility, N by N + N by N</span>
        <span class="comment">% previously mt_ev_condi_z_max_interp_z was N by 1, not N by N</span>
        mt_utility = mt_utility + fl_beta*mt_ev_condi_z_max_interp_z;

        <span class="comment">% Optimization: remember matlab is column major, rows must be</span>
        <span class="comment">% choices, columns must be states</span>
        <span class="comment">% &lt;https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR&gt;</span>
        [ar_opti_val1_z, ar_opti_idx_z] = max(mt_utility);
        mt_val(:,it_z_i) = ar_opti_val1_z;

        <span class="comment">% Generate Linear Opti Index</span>
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        <span class="comment">% Store Optimal</span>
        mt_pol_a(:,it_z_i) = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        mt_pol_k(:,it_z_i) = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        <span class="keyword">end</span>

    <span class="keyword">end</span>
</pre><h2 id="14">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
                                      mean(mt_pol_a_cur,1); <span class="keyword">...</span>
                                      mean(mt_pol_k_cur,1); <span class="keyword">...</span>
                                      mt_val_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_ameshk_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeoutput">VAL it_iter:5, fl_diff:6.886454e+01, fl_diff_pol:1.567225e+02
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     4.882     4.906     4.934    4.9652    4.9993    5.0364    5.0765    5.1197    5.1661    5.2157    5.2686    5.3245    5.3829    5.4424    5.4996
    map     19.864    19.427    19.028    18.498    17.923    17.226    16.405    15.442    14.325    13.039    11.562    9.9353    8.2406    6.4537    4.7263
    mak     1.8225      2.17    2.5263    3.0224    3.5531    4.1944    4.9466    5.8227    6.8284    7.9737    9.2731    10.706    12.267    13.885    15.415
    Hval    6.3898    6.3944    6.4001    6.4067    6.4143    6.4229    6.4326    6.4435    6.4559    6.4698    6.4854    6.5029    6.5226    6.5436    6.5647
    Hap     42.535    42.535    40.537    39.656    39.656    38.776    37.896    37.016    35.255    34.375    32.614    29.164    26.595    24.025    20.599
    Hak     1.8525    1.8525    2.6841    3.5644    3.5644    4.4447     5.325    6.2053    7.9659    8.8462    10.607     12.89     15.46    18.029    21.455

</pre><pre class="codeoutput">VAL it_iter:10, fl_diff:3.879889e+01, fl_diff_pol:4.294370e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    7.0738    7.1324    7.1996    7.2734    7.3531    7.4384    7.5293    7.6262     7.729    7.8378    7.9527    8.0732    8.1982    8.3245     8.445
    map     22.453    22.101    21.637    21.127    20.501    19.744    18.903    17.901    16.759    15.504    14.066    12.445    10.654    8.7286      6.83
    mak     1.8249    2.1398    2.5541    3.0049    3.5642    4.2383    4.9811    5.8645     6.893    8.0726    9.4204     10.93    12.589    14.359    16.085
    Hval    9.7431    9.7598    9.7793    9.8012    9.8252    9.8516    9.8804     9.912    9.9468    9.9855    10.028    10.074    10.124    10.176    10.228
    Hap     47.007    47.007    46.007    46.007    45.008    45.008    44.009     43.01    40.037    39.061    37.111     35.16    32.234    29.308    26.382
    Hak     2.0472    2.0472    3.0463    3.0463    4.0454    4.0454    5.0445    6.0436    7.8506    8.8259    10.777    12.727    15.653    18.579    21.505

</pre><pre class="codeoutput">VAL it_iter:15, fl_diff:2.402075e+01, fl_diff_pol:1.571199e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval     8.409    8.4872    8.5767    8.6747      8.78    8.8924     9.012     9.139    9.2736    9.4159    9.5661    9.7237    9.8873    10.053    10.211
    map     23.092    22.766      22.3    21.831    21.212    20.504    19.688    18.726     17.61    16.338    14.851    13.198    11.346    9.4444    7.5597
    mak     1.8356    2.1358    2.5703    3.0011    3.5755    4.2347    4.9907    5.8859    6.9224    8.0992    9.4773    11.003    12.709    14.519    16.309
    Hval    11.748    11.775    11.805    11.839    11.876    11.916     11.96    12.007    12.059    12.116    12.178    12.244    12.316    12.393    12.469
    Hap     48.124    48.124    47.102    47.102    46.079    46.079    45.056    44.033     43.01    40.964    38.919    36.873    34.018    31.021    27.025
    Hak     2.0959    2.0959    3.1188    3.1188    4.1416    4.1416    5.1645    6.1874    7.2102    9.2559    11.302    13.347    15.035    18.033    22.029

</pre><pre class="codeoutput">VAL it_iter:20, fl_diff:1.557668e+01, fl_diff_pol:1.309243e+01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.2929    9.3807    9.4812    9.5912    9.7094    9.8354    9.9696    10.112    10.263    10.423    10.592     10.77    10.955    11.142    11.321
    map     23.451     23.13    22.633    22.172    21.521    20.831    20.004     19.03    17.892    16.602     15.16    13.542    11.756    9.8273    7.9357
    mak     1.8442     2.132    2.5891    3.0036    3.6006    4.2281    4.9849     5.878    6.9215    8.1305    9.5007    11.047    12.752    14.592    16.391
    Hval     13.01    13.042    13.079    13.121    13.165    13.214    13.268    13.325    13.389    13.457    13.533    13.615    13.703    13.796    13.886
    Hap     49.242    49.242    48.196    48.196    47.149    47.149    46.102    45.056    44.009    41.916    38.919    36.873    34.827    31.759     28.69
    Hak     2.1446    2.1446    3.1912    3.1912    4.2379    4.2379    5.2845    6.3311    7.3777    9.4709    11.302    13.347    15.393    18.462     21.53

</pre><pre class="codeoutput">VAL it_iter:25, fl_diff:1.040300e+01, fl_diff_pol:9.485659e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    9.8968    9.9893    10.095    10.211    10.335    10.468     10.61     10.76     10.92    11.089    11.268    11.457    11.653    11.853    12.044
    map     23.562    23.234    22.762    22.302    21.677    20.998    20.183    19.225    18.112    16.835    15.366    13.725    11.904    9.9622    8.0642
    mak     1.8402    2.1428    2.5836    3.0095    3.5948    4.2286    4.9928    5.8927    6.9388    8.1396    9.5241     11.07    12.785    14.626     16.45
    Hval    13.824     13.86    13.902    13.948    13.998    14.053    14.112    14.177    14.247    14.323    14.406    14.497    14.593    14.695    14.796
    Hap     49.242    49.242    48.196    48.196    47.149    47.149    46.102    45.056    44.009    41.916    39.823     37.73    35.636    32.496     28.69
    Hak     2.1446    2.1446    3.1912    3.1912    4.2379    4.2379    5.2845    6.3311    7.3777    9.4709    11.564    13.657    15.751     18.89     21.53

</pre><pre class="codeoutput">VAL it_iter:30, fl_diff:7.102924e+00, fl_diff_pol:6.719119e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9       z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______    ______

    mval    10.316    10.411     10.52    10.638    10.766    10.902    11.047    11.202    11.366     11.54    11.725    11.919    12.122    12.328    12.526
    map      23.61    23.275    22.803    22.355    21.724    21.049    20.237    19.296    18.194    16.919    15.464    13.837    12.034    10.105    8.1763
    mak     1.8389     2.145    2.5869    3.0034    3.5992    4.2369     5.004    5.8937    6.9383    8.1492    9.5362    11.085    12.808    14.649    16.489
    Hval    14.358    14.396     14.44    14.489    14.543    14.602    14.666    14.735     14.81    14.892    14.981    15.077    15.181     15.29    15.398
    Hap      50.36     50.36    48.196    48.196    47.149    47.149    46.102    45.056    44.009    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.1912    3.1912    4.2379    4.2379    5.2845    6.3311    7.3777    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:35, fl_diff:4.935534e+00, fl_diff_pol:4.431593e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    10.611    10.707    10.817    10.937    11.067    11.205    11.352    11.508     11.675    11.852    12.039    12.236    12.443    12.653    12.854
    map     23.643    23.318    22.835    22.382    21.749     21.08     20.27    19.325     18.421     16.96    15.506    13.885    12.094    10.172     8.259
    mak     1.8418     2.139    2.5892    3.0079    3.5982     4.229    4.9968    5.8961     6.7472    8.1491    9.5374    11.095    12.817    14.665    16.499
    Hval    14.715    14.755      14.8    14.851    14.905    14.966    15.033    15.105     15.183    15.269    15.362    15.463    15.572    15.686    15.799
    Hap      50.36     50.36     49.29     49.29    48.219    47.149    46.102    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.2379    5.2845    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:40, fl_diff:3.479401e+00, fl_diff_pol:3.132458e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    10.821    10.918    11.028    11.149    11.279    11.418    11.566    11.724     11.892     12.07    12.259    12.458    12.666    12.878    13.082
    map     23.664    23.338    22.857    22.401    21.771    21.091    20.281    19.337     18.437    16.969    15.527    13.907    12.125    10.207    8.2898
    mak     1.8428    2.1398    2.5902    3.0097    3.6004    4.2336    4.9994    5.8979     6.7497    8.1585    9.5418      11.1    12.819    14.672     16.51
    Hval    14.957    14.997    15.043    15.095    15.152    15.213     15.28    15.354     15.435    15.522    15.618    15.722    15.833    15.951    16.067
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    46.102    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.2845    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:45, fl_diff:2.482086e+00, fl_diff_pol:2.167364e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    10.972    11.069     11.18    11.301    11.432    11.571    11.719    11.878     12.046    12.225    12.414    12.615    12.824    13.037    13.241
    map     23.678    23.349    22.865    22.409    21.779    21.102     20.29     19.34     18.445    16.977    15.533    13.913    12.138    10.219    8.3025
    mak     1.8434    2.1409    2.5908    3.0116     3.601     4.235    4.9997    5.9011     6.7478    8.1601     9.545    11.106    12.824     14.68    16.518
    Hval    15.123    15.164    15.211    15.263     15.32    15.383     15.45    15.525     15.606    15.695    15.792    15.897    16.011     16.13    16.248
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:50, fl_diff:1.786917e+00, fl_diff_pol:2.139869e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.081    11.178    11.289    11.411    11.541    11.681     11.83    11.988     12.157    12.336    12.526    12.726    12.936     13.15    13.355
    map     23.686    23.355    22.869    22.414    21.784    21.108    20.291    19.343     18.449     16.98    15.533    13.917    12.143    10.221    8.3136
    mak     1.8439    2.1412    2.5911    3.0121    3.6015    4.2359    5.0033    5.9016     6.7464    8.1599    9.5494    11.108    12.829    14.687     16.52
    Hval     15.24    15.281    15.328    15.381    15.438    15.501    15.569    15.644     15.726    15.815    15.913    16.019    16.133    16.253    16.372
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:55, fl_diff:1.295034e+00, fl_diff_pol:1.437215e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval     11.16    11.257    11.368     11.49    11.621     11.76    11.909    12.068     12.237    12.416    12.606    12.807    13.017    13.231    13.436
    map     23.691    23.359    22.873    22.416    21.787    21.109    20.293    19.345      18.45    16.981    15.535    13.919    12.144    10.226    8.3143
    mak     1.8436    2.1414    2.5914    3.0125    3.6018    4.2361    5.0035    5.9017     6.7467    8.1615    9.5498    11.109    12.831    14.686    16.522
    Hval    15.322    15.364    15.411    15.464    15.522    15.585    15.653    15.728      15.81      15.9    15.998    16.104    16.219     16.34    16.459
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:60, fl_diff:9.428553e-01, fl_diff_pol:9.134338e-01
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.218    11.315    11.426    11.548    11.679    11.818    11.967    12.126     12.295    12.474    12.664    12.865    13.075    13.289    13.495
    map     23.694    23.361    22.875    22.416    21.788    21.111    20.296    19.344     18.453    16.982    15.536     13.92    12.145     10.23    8.3161
    mak     1.8437    2.1415    2.5917    3.0125    3.6014    4.2362     5.004    5.9026     6.7454    8.1618    9.5504    11.109    12.832    14.685    16.523
    Hval    15.382    15.423     15.47    15.524    15.581    15.644    15.713    15.788      15.87     15.96    16.058    16.165     16.28    16.401     16.52
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:65, fl_diff:6.885223e-01, fl_diff_pol:1.531831e+00
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.261    11.358    11.469     11.59    11.721    11.861     12.01    12.168     12.337    12.517    12.707    12.908    13.118    13.332    13.538
    map     23.694    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.453     16.98    15.536     13.92    12.146    10.232    8.3184
    mak     1.8437    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7454    8.1634    9.5504    11.109    12.832    14.685    16.523
    Hval    15.425    15.466    15.513    15.567    15.624    15.688    15.756    15.831     15.913    16.004    16.102    16.209    16.324    16.444    16.564
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:70, fl_diff:5.037644e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.292    11.389      11.5    11.621    11.752    11.892    12.041      12.2     12.368    12.548    12.738    12.939    13.149    13.363    13.569
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.453     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7454    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.456    15.497    15.545    15.598    15.656    15.719    15.787    15.862     15.945    16.035    16.133     16.24    16.355    16.476    16.596
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:75, fl_diff:3.690277e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.314    11.411    11.522    11.644    11.775    11.915    12.064    12.222     12.391     12.57    12.761    12.962    13.172    13.386    13.592
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.453     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7454    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.479     15.52    15.568    15.621    15.679    15.742     15.81    15.885     15.968    16.058    16.156    16.263    16.378    16.499    16.619
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:80, fl_diff:2.705269e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.331    11.428    11.539    11.661    11.791    11.931     12.08    12.239     12.408    12.587    12.777    12.978    13.189    13.403    13.608
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.452     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7466    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.495    15.537    15.584    15.638    15.695    15.759    15.827    15.902     15.984    16.075    16.173     16.28    16.395    16.516    16.636
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:85, fl_diff:1.984067e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.343     11.44    11.551    11.673    11.804    11.943    12.092    12.251      12.42    12.599     12.79    12.991    13.201    13.415    13.621
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.452     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7466    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.508    15.549    15.597     15.65    15.708    15.771    15.839    15.914     15.997    16.087    16.185    16.292    16.407    16.528    16.648
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:90, fl_diff:1.455523e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.352    11.449     11.56    11.682    11.813    11.952    12.101     12.26     12.429    12.608    12.799        13     13.21    13.424    13.629
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.452     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7466    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.517    15.558    15.605    15.659    15.717     15.78    15.848    15.923     16.006    16.096    16.194    16.301    16.416    16.537    16.657
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:95, fl_diff:1.067954e-01, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.359    11.456    11.567    11.688    11.819    11.959    12.108    12.267     12.435    12.615    12.805    13.006    13.216     13.43    13.636
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.452     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7466    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.523    15.565    15.612    15.665    15.723    15.786    15.855     15.93     16.012    16.103    16.201    16.308    16.423    16.544    16.663
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeoutput">VAL it_iter:100, fl_diff:7.836612e-02, fl_diff_pol:0
mval = mean(mt_val_cur,1), average value over a
map  = mean(mt_pol_a_cur,1), average choice over a
mkp  = mean(mt_pol_k_cur,1), average choice over k
Hval = mt_val_cur(it_ameshk_n,:), highest a state val
Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice
mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice
              z1        z2        z3        z4        z5        z6        z7        z8        z9        z10       z11       z12       z13       z14       z15  
            ______    ______    ______    ______    ______    ______    ______    ______    _______    ______    ______    ______    ______    ______    ______

    mval    11.363     11.46    11.572    11.693    11.824    11.964    12.113    12.271      12.44     12.62     12.81    13.011    13.221    13.435    13.641
    map     23.696    23.361    22.875    22.419    21.788    21.111    20.296    19.344     18.452     16.98    15.536    13.923    12.146    10.232    8.3184
    mak     1.8438    2.1415    2.5917    3.0127    3.6014    4.2362     5.004    5.9026     6.7466    8.1634    9.5504    11.108    12.832    14.685    16.523
    Hval    15.528    15.569    15.617     15.67    15.728    15.791     15.86    15.934     16.017    16.107    16.206    16.312    16.428    16.549    16.668
    Hap      50.36     50.36     49.29     49.29    48.219    48.219    47.149    45.056     58.077    41.916    39.823     37.73    35.636    32.496    29.357
    Hak     2.1933    2.1933    3.2637    3.2637    4.3341    4.3341    5.4044    6.3311    -6.6901    9.4709    11.564    13.657    15.751     18.89     22.03

</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 10.135634 seconds.
</pre><h2 id="16">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
result_map(<span class="string">'mt_pol_k'</span>) = mt_pol_k;

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    <span class="comment">% graphing based on coh_wkb, but that does not match optimal choice</span>
    <span class="comment">% matrixes for graphs.</span>
    armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_interp_coh_grid_mesh_z;
    armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_interp_coh_grid);
    armt_map(<span class="string">'ar_a_meshk'</span>) = mt_interp_coh_grid_mesh_z(:,1);
    armt_map(<span class="string">'ar_k_mesha'</span>) = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_ameshk_n)
                 valgap     polgap        z1           z2           z3           z4           z5           z6           z7           z8           z9           z10          z11          z12          z13          z14          z15   
                ________    _______    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________    _________

    iter=1        142.93     187.28            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=2        110.44     1633.1            1            1            1            1            1            1            1            1            1            1            1            1            1            1            1
    iter=3        92.187     549.07      0.99648      0.99648      0.99648       0.9956      0.99472       0.9956      0.99384      0.99384       0.9956      0.98856      0.98856       0.9868      0.99032      0.99472      0.99472
    iter=4        79.058     269.06      0.99472      0.99472      0.99296      0.99472      0.99472      0.99384      0.99472      0.99296      0.99208      0.98856      0.98768       0.9868      0.98504       0.9868       0.9868
    iter=5        68.865     156.72      0.99296      0.99472      0.99472      0.99472      0.99296      0.99032      0.99296      0.99296      0.98944       0.9868      0.99472      0.98856      0.98592      0.98151      0.98415
    iter=6        60.626     111.18      0.98944      0.98239      0.98944      0.98592      0.98768       0.9868      0.98944      0.98592      0.98592      0.98944      0.98504      0.98151      0.98592      0.98415      0.98063
    iter=7        53.789       75.6      0.94014      0.93838       0.9419      0.93662      0.94718      0.94102      0.94718      0.95599      0.95335      0.96127      0.96479      0.96831      0.96127      0.96567      0.97183
    iter=8        48.015     57.429      0.72007      0.72359      0.69542      0.69366      0.67958      0.67782       0.6743      0.69718      0.77817      0.78433      0.78697      0.78169      0.77025      0.78081      0.81778
    iter=9        43.078     43.803      0.41549      0.42254      0.45246      0.48592      0.51408      0.57042      0.62148      0.64261      0.62412      0.60035      0.58099      0.55634      0.58627      0.63908      0.68662
    iter=10       38.799     42.944      0.53169      0.53521      0.51056      0.48768      0.47359       0.4419      0.41549      0.38908       0.3662      0.40581      0.45687      0.51761      0.53873      0.53081      0.49296
    iter=11       35.069     30.095      0.25352      0.27289      0.29401      0.29754      0.31514      0.35035      0.37412      0.41725      0.44542      0.39437      0.36268      0.34507       0.3838      0.40669      0.46127
    iter=12       31.784     26.726      0.29754      0.28521      0.26232      0.22711      0.19542      0.22535      0.22887       0.2588      0.28345      0.29577      0.34507      0.37148      0.35035      0.32658       0.3257
    iter=13       28.889     28.131      0.24824      0.27465      0.27289      0.29225      0.30986      0.27289      0.24296       0.2007      0.19366      0.21479      0.23856      0.26585      0.29754      0.34067      0.34507
    iter=14       26.318     20.638      0.16549      0.17077      0.18486       0.1919      0.19718      0.22535      0.22359      0.25704      0.27113      0.22711      0.17782      0.19366      0.23151      0.25352      0.27113
    iter=15       24.021     15.712      0.10739      0.11092      0.13556       0.1162      0.14261      0.14789      0.16725       0.1875      0.20599      0.20599      0.25528      0.21655      0.16725      0.18662      0.22271
    iter=16        21.96     16.068     0.088028      0.09507     0.089789      0.09507      0.10915      0.12324      0.13028      0.13556      0.14789      0.16901      0.18134      0.21039      0.22183      0.19014      0.17165
    iter=17       20.108     17.228      0.14261      0.14437      0.11796     0.088028      0.10035     0.077465      0.09331     0.089789      0.11268      0.12148      0.15141      0.15405      0.17958      0.19718      0.19542
    iter=18       18.443     16.125      0.11796      0.11972      0.12852      0.12676        0.125     0.091549     0.082746     0.088028     0.089789      0.09507      0.11972      0.12852      0.12676      0.17254      0.16725
    iter=19       16.939     13.742     0.096831     0.089789      0.10035     0.098592       0.1162      0.10563      0.11092     0.084507     0.075704     0.079225      0.09507      0.12148      0.13204      0.13028      0.12676
    iter=20       15.577     13.092     0.073944     0.077465     0.073944     0.079225      0.10035      0.10211     0.098592      0.10915     0.091549     0.084507     0.079225     0.082746      0.10035      0.10035       0.1162
    iter=21        14.34     10.246     0.056338     0.049296     0.059859     0.058099     0.065141     0.077465     0.075704     0.089789      0.10563     0.084507     0.080986     0.084507     0.075704     0.089789     0.091549
    iter=22       13.215     9.0761     0.038732     0.040493     0.047535     0.052817     0.058099     0.065141      0.06162     0.073944     0.073944     0.091549      0.09243     0.072183     0.053697     0.072183     0.075704
    iter=23       12.191     9.3209     0.033451     0.042254      0.02993     0.044014     0.052817     0.045775     0.065141      0.06162     0.065141     0.075704     0.080106     0.084507     0.059859     0.072183     0.072183
    iter=24       11.256     9.1799     0.022887     0.033451      0.03169     0.035211     0.033451     0.042254     0.042254     0.047535     0.056338     0.065141     0.059859     0.072183     0.070423     0.054577     0.070423
    iter=25       10.403     9.4857     0.022887     0.024648     0.022887     0.022887     0.024648      0.02993     0.040493     0.044014     0.042254     0.047535     0.056338     0.065141     0.072183     0.049296     0.044894
    iter=26       9.6228     7.3426     0.017606     0.022887     0.022887     0.022887     0.022887     0.026408     0.024648      0.03169     0.048415     0.045775     0.052817      0.06338     0.058099      0.06338     0.034331
    iter=27       8.9088     7.7562     0.015845     0.019366     0.015845     0.017606     0.021127     0.017606      0.02993     0.024648     0.038732     0.045775     0.036972     0.038732     0.052817     0.051056      0.06162
    iter=28       8.2547     8.0561     0.012324     0.015845     0.015845     0.012324     0.024648     0.024648     0.017606     0.021127     0.021127     0.035211     0.033451     0.040493     0.051056     0.058099      0.06162
    iter=29       7.6544     6.8656     0.014085    0.0088028     0.010563     0.015845     0.012324     0.014085     0.019366     0.017606     0.024648     0.021127     0.026408     0.049296     0.045775     0.044014     0.051056
    iter=30       7.1029     6.7191     0.017606     0.014085    0.0088028     0.012324    0.0088028     0.014085     0.019366     0.015845     0.014085     0.026408     0.036972     0.026408     0.042254     0.040493     0.044014
    iter=31       6.5957     6.5863     0.010563     0.012324    0.0088028    0.0088028     0.012324     0.010563    0.0088028     0.014085     0.017606     0.021127     0.015845     0.026408     0.022887      0.02993     0.038732
    iter=32       6.1287     66.964    0.0070423    0.0088028     0.010563    0.0088028    0.0070423     0.014085     0.014085     0.022887     0.044014     0.021127     0.022887     0.028169      0.02993      0.02993     0.028169
    iter=33       5.6985     5.0945     0.010563    0.0088028     0.012324     0.010563     0.012324    0.0070423    0.0088028    0.0088028     0.014085     0.024648     0.017606     0.021127     0.026408     0.035211     0.035211
    iter=34       5.3017     5.0218    0.0088028    0.0070423    0.0088028    0.0088028     0.014085    0.0052817    0.0035211    0.0070423     0.014085    0.0088028     0.014085     0.017606     0.021127     0.017606     0.022887
    iter=35       4.9355     4.4316     0.010563    0.0052817    0.0035211    0.0070423    0.0052817    0.0070423    0.0070423     0.012324     0.012324     0.022887    0.0088028     0.019366     0.019366     0.015845     0.014085
    iter=36       4.5973      4.367    0.0052817    0.0052817    0.0052817    0.0070423    0.0088028    0.0035211    0.0070423    0.0052817     0.015845    0.0070423     0.012324     0.012324     0.017606     0.028169     0.021127
    iter=37       4.2846     3.5049    0.0070423    0.0088028    0.0070423    0.0052817    0.0052817    0.0035211    0.0017606    0.0052817     0.015845    0.0070423     0.014085    0.0070423     0.015845      0.02993     0.017606
    iter=38       3.9954     3.6668    0.0088028    0.0070423    0.0052817    0.0070423    0.0052817     0.010563    0.0035211    0.0035211    0.0052817     0.015845    0.0070423    0.0088028     0.012324     0.014085     0.012324
    iter=39       3.7275     3.9324    0.0035211    0.0035211    0.0052817    0.0035211    0.0052817    0.0088028    0.0035211    0.0035211    0.0017606    0.0052817     0.010563     0.012324     0.015845    0.0070423     0.017606
    iter=40       3.4794     3.1325    0.0070423    0.0035211    0.0052817    0.0035211    0.0070423    0.0035211    0.0052817    0.0035211    0.0088028    0.0070423    0.0052817    0.0070423    0.0088028    0.0088028    0.0088028
    iter=41       3.2493     3.0994    0.0017606    0.0052817    0.0035211    0.0017606    0.0017606    0.0052817    0.0017606    0.0070423    0.0088028    0.0017606    0.0017606    0.0070423     0.014085    0.0070423     0.010563
    iter=42       3.0358     2.5947    0.0017606    0.0017606    0.0017606    0.0070423    0.0035211    0.0035211    0.0035211    0.0017606            0    0.0070423    0.0035211    0.0070423    0.0035211    0.0052817     0.010563
    iter=43       2.8376     2.3457    0.0035211    0.0052817    0.0017606    0.0017606    0.0035211    0.0017606            0            0    0.0017606    0.0017606    0.0017606     0.012324    0.0052817    0.0088028    0.0052817
    iter=44       2.6534     2.4174    0.0052817    0.0017606    0.0017606    0.0035211            0    0.0017606    0.0035211    0.0017606    0.0035211    0.0017606    0.0070423    0.0035211    0.0088028    0.0052817    0.0052817
    iter=45       2.4821     2.1674    0.0017606    0.0017606    0.0017606            0    0.0017606    0.0017606    0.0070423    0.0017606            0    0.0017606    0.0035211    0.0035211    0.0052817    0.0070423    0.0070423
    iter=46       2.3227     2.2706    0.0035211    0.0017606    0.0017606    0.0017606    0.0017606    0.0017606    0.0017606    0.0035211    0.0017606    0.0017606    0.0052817            0    0.0070423    0.0052817    0.0052817
    iter=47       2.1743     1.8758    0.0017606            0            0            0    0.0017606    0.0035211    0.0035211            0    0.0052817    0.0017606    0.0035211    0.0017606    0.0017606    0.0035211    0.0035211
    iter=48        2.036     1.9047    0.0035211    0.0017606            0    0.0035211            0    0.0035211    0.0017606            0            0            0    0.0017606    0.0035211    0.0017606    0.0017606    0.0070423
    iter=49       1.9071     2.0207    0.0017606    0.0035211    0.0017606    0.0017606            0            0            0    0.0035211            0    0.0017606    0.0017606            0    0.0017606    0.0035211    0.0088028
    iter=50       1.7869     2.1399            0            0            0            0    0.0017606    0.0017606    0.0052817            0    0.0017606            0    0.0017606    0.0017606    0.0035211    0.0035211    0.0052817
    iter=55        1.295     1.4372            0    0.0017606            0            0    0.0017606            0            0    0.0017606            0            0            0    0.0017606    0.0017606            0    0.0017606
    iter=56        1.215     2.1041    0.0017606            0    0.0017606            0    0.0017606    0.0017606            0            0    0.0017606            0            0    0.0017606            0    0.0035211    0.0070423
    iter=57       1.1401      1.902    0.0017606            0            0            0            0            0    0.0017606    0.0035211    0.0017606    0.0017606    0.0017606            0            0            0            0
    iter=58         1.07     1.5583            0            0    0.0017606            0            0            0    0.0017606            0            0            0    0.0017606            0            0            0    0.0017606
    iter=59       1.0044     1.1865            0    0.0017606            0            0            0            0    0.0017606            0            0            0            0            0            0            0            0
    iter=60      0.94286    0.91343            0            0            0            0            0            0            0            0            0            0            0            0    0.0017606            0            0
    iter=61      0.88522          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=62       0.8312     1.6575            0            0            0    0.0017606            0            0            0            0            0            0            0            0            0            0    0.0017606
    iter=63      0.78056          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=64      0.73307     1.7213            0            0            0    0.0017606            0            0            0            0            0            0            0            0            0    0.0017606            0
    iter=65      0.68852     1.5318            0            0            0            0            0            0            0            0            0    0.0035211            0            0    0.0017606            0            0
    iter=66      0.64673          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=67      0.60752      1.091    0.0017606            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=68      0.57072     1.8752            0            0            0            0            0            0            0            0            0            0            0    0.0017606            0            0            0
    iter=69      0.53619          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=70      0.50376          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=71      0.47333          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=72      0.44474          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=73      0.41791          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=74       0.3927          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=75      0.36903          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=76      0.34679          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=77       0.3259          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=78      0.30628    0.96214            0            0            0            0            0            0            0            0    0.0035211            0            0            0            0            0            0
    iter=79      0.28785          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=80      0.27053          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=81      0.25425          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=82      0.23896          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=83       0.2246          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=84      0.21109          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=85      0.19841          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=86      0.18648          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=87      0.17528          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=88      0.16475          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=89      0.15485          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=90      0.14555          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=91      0.13681          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=92       0.1286          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=93      0.12087          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=94      0.11362          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=95       0.1068          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=96      0.10038          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=97     0.094358          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=98     0.088694          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=99      0.08337          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=100    0.078366          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=101    0.073663          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=102    0.069241          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=103    0.065086          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0
    iter=104     0.06118          0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0

tb_val
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0      -0.27805     -0.0021088      0.3078      0.63974      0.98775        1.3492        2.9117        3.3277        3.7508        4.1766        4.5947       4.9837  
    coh2:k=0.543883,b=0       0.13838        0.41572     0.72707       1.0604       1.4098        1.7728        3.3415        3.7583        4.1819         4.608        5.0262       5.4152  
    coh3:k=0.644119,b=0       0.50582        0.78563      1.0993       1.4348       1.7862        2.1513        3.7256        4.1429        4.5667        4.9926        5.4104       5.7989  
    coh4:k=0.744354,b=0       0.80629         1.0864      1.4004        1.736       2.0874        2.4522        4.0237          4.44        4.8631        5.2882        5.7052       6.0928  
    coh5:k=0.84459,b=0         1.0824         1.3627      1.6768       2.0123       2.3633        2.7273        4.2944        4.7095        5.1308        5.5541        5.9691       6.3549  
    coh6:k=0.944825,b=0        1.3257         1.6053      1.9182       2.2523       2.6016         2.964        4.5241        4.9375         5.357        5.7786        6.1924        6.577  
    coh7:k=1.04506,b=0         1.5482         1.8271      2.1393       2.4725       2.8209        3.1821        4.7374        5.1489        5.5664        5.9857        6.3967       6.7787  
    coh8:k=1.1453,b=0          1.7561         2.0334      2.3437       2.6753       3.0222        3.3817        4.9255        5.3339         5.749        6.1659        6.5754        6.956  
    coh9:k=1.24553,b=0         1.9472         2.2232      2.5319       2.8612       3.2055        3.5628        5.0994        5.5068        5.9203        6.3356        6.7428       7.1213  
    coh10:k=1.34577,b=0        2.1257         2.4001      2.7075       3.0354        3.378        3.7334        5.2617        5.6658        6.0757        6.4881        6.8928        7.269  
    coh11:k=1.446,b=0          2.2952         2.5684      2.8738       3.1996         3.54        3.8926        5.4098        5.8118          6.22        6.6307        7.0338       7.4085  
    coh12:k=1.54624,b=0        2.4542         2.7255       3.029       3.3527       3.6908        4.0412        5.5504          5.95        6.3562        6.7647        7.1651       7.5374  
    coh13:k=1.64647,b=0        2.6047         2.8741      3.1754       3.4973       3.8339        4.1825        5.6826        6.0793        6.4826        6.8882        7.2862       7.6571  
    coh14:k=1.74671,b=0        2.7478         3.0159      3.3159       3.6358       3.9699        4.3164        5.8059        6.2009        6.6019        7.0058         7.402       7.7703  
    coh15:k=1.84694,b=0        2.8857          3.152      3.4497       3.7671       4.0994        4.4437        5.9239         6.317        6.7161        7.1171        7.5105        7.877  
    coh16:k=1.94718,b=0        3.0171         3.2813      3.5771        3.893       4.2229        4.5645        6.0366        6.4268        6.8229        7.2214        7.6132       7.9781  
    coh17:k=2.04742,b=0        3.1429         3.4058      3.6997        4.013       4.3412        4.6812        6.1432        6.5305        6.9249        7.3216        7.7118       8.0748  
    coh18:k=2.14765,b=0        3.2638          3.525      3.8175       4.1293       4.4548        4.7922        6.2452        6.6307        7.0228        7.4176         7.805       8.1654  
    coh19:k=2.24789,b=0        3.3808         3.6404      3.9304       4.2401       4.5641        4.8995         6.343        6.7268        7.1166        7.5084        7.8939       8.2529  
    coh20:k=2.34812,b=0         3.493         3.7513      4.0401       4.3477       4.6689        5.0022        6.4379        6.8185        7.2058         7.596        7.9796       8.3372  
    coh21:k=2.44836,b=0        3.6025         3.8585      4.1447       4.4508       4.7704        5.1013        6.5278        6.9068         7.292        7.6806        8.0621       8.4171  
    coh22:k=2.54859,b=0         3.707         3.9618      4.2466       4.5505       4.8685        5.1977         6.615        6.9922        7.3756        7.7612        8.1406       8.4943  
    coh23:k=2.64883,b=0        3.8084         4.0619      4.3453       4.6473       4.9625        5.2897        6.6998        7.0742        7.4551        7.8392        8.2168       8.5692  
    coh24:k=2.74906,b=0        3.9077         4.1589      4.4404       4.7409       5.0547        5.3795        6.7809        7.1536        7.5323        7.9148        8.2906       8.6403  
    coh25:k=2.8493,b=0         4.0038         4.2539      4.5333       4.8311       5.1433        5.4666        6.8597        7.2304        7.6075        7.9871        8.3613       8.7099  
    coh26:k=2.94953,b=0         4.096         4.3448      4.6229       4.9193       5.2293        5.5511        6.9363        7.3044          7.68        8.0581        8.4299       8.7772  
    coh27:k=3.04977,b=0        4.1872         4.4334      4.7102       5.0052       5.3132        5.6322        7.0108        7.3774        7.7501        8.1265        8.4966       8.8419  
    coh28:k=3.15001,b=0        4.2758         4.5205      4.7949       5.0886       5.3952        5.7127        7.0823        7.4474        7.8185        8.1931        8.5617       8.9051  
    coh29:k=3.25024,b=0        4.3621         4.6053      4.8783       5.1692       5.4743        5.7903        7.1528        7.5155        7.8851        8.2572        8.6241       8.9663  
    coh30:k=3.35048,b=0        4.4457         4.6873       4.959       5.2486       5.5513        5.8659        7.2211        7.5815        7.9495        8.3202         8.685        9.026  
    coh31:k=3.45071,b=0        4.5287         4.7671      5.0375       5.3258       5.6268         5.939        7.2876        7.6466        8.0119        8.3812        8.7445       9.0836  
    coh32:k=3.55095,b=0        4.6098         4.8464      5.1141       5.4011       5.7008        6.0112        7.3518        7.7095        8.0733        8.4407        8.8027         9.14  
    coh33:k=3.65118,b=0        4.6886         4.9236      5.1894       5.4744       5.7728        6.0818        7.4154        7.7709        8.1333        8.4984        8.8589       9.1951  
    coh34:k=3.75142,b=0        4.7655          4.999      5.2633       5.5463       5.8428        6.1504        7.4774        7.8307        8.1918        8.5555        8.9138       9.2488  
    coh35:k=3.85165,b=0        4.8409         5.0725      5.3351       5.6169       5.9112        6.2175        7.5378        7.8896        8.2484        8.6108        8.9673        9.301  
    coh36:k=3.95189,b=0        4.9158         5.1444      5.4051       5.6856       5.9785        6.2825        7.5967        7.9472        8.3038        8.6649        9.0202       9.3518  
    coh37:k=4.05212,b=0        4.9892         5.2163      5.4738       5.7529       6.0445        6.3466        7.6538        8.0029        8.3583        8.7173        9.0715       9.4018  
    coh38:k=4.15236,b=0        5.0606         5.2862      5.5417       5.8187       6.1091        6.4099        7.7102        8.0576        8.4117        8.7687        9.1216       9.4509  
    coh39:k=4.2526,b=0         5.1305         5.3546      5.6086       5.8829       6.1721        6.4717        7.7658         8.111        8.4639        8.8197        9.1706       9.4989  
    coh40:k=4.35283,b=0        5.1989         5.4217       5.674       5.9468       6.2339        6.5322        7.8202        8.1638        8.5148        8.8694        9.2185       9.5456  
    coh41:k=4.45307,b=0        5.2671         5.4872       5.738       6.0092       6.2945        6.5914        7.8736        8.2159        8.5648        8.9182        9.2661       9.5913  
    coh42:k=4.5533,b=0         5.3343         5.5521      5.8007       6.0703       6.3542        6.6491        7.9254        8.2665        8.6139        8.9656        9.3124        9.636  
    coh43:k=4.65354,b=0        5.4003         5.6166      5.8624       6.1302       6.4129         6.706        7.9762        8.3161        8.6622        9.0121        9.3577       9.6803  
    coh44:k=4.75377,b=0        5.4648         5.6798      5.9236        6.189       6.4703        6.7622        8.0262        8.3646        8.7096        9.0577        9.4022       9.7238  
    coh45:k=4.85401,b=0         5.528         5.7417       5.984       6.2468       6.5266        6.8173        8.0755         8.412        8.7558        9.1028        9.4455       9.7662  
    coh46:k=4.95424,b=0        5.5901         5.8024      6.0433       6.3041        6.582        6.8715        8.1241        8.4586        8.8012        9.1471         9.488       9.8078  
    coh47:k=5.05448,b=0        5.6514         5.8621      6.1015       6.3608       6.6365        6.9249        8.1719        8.5052        8.8458        9.1907        9.5305       9.8487  
    coh48:k=5.15471,b=0        5.7126         5.9206      6.1586       6.4164       6.6899         6.977        8.2186        8.5508        8.8895        9.2333        9.5721       9.8888  
    coh49:k=5.25495,b=0        5.7728          5.979      6.2148        6.471        6.743        7.0282        8.2646        8.5957        8.9332        9.2752        9.6131       9.9286  
    coh50:k=5.35519,b=0        5.8321         6.0369      6.2702       6.5249       6.7952        7.0786        8.3098        8.6397        8.9762        9.3164        9.6532       9.9679  
    coh519:k=52.3656,b=0       15.087         15.132      15.185       15.243       15.306        15.375        15.716        15.821        15.935        16.058        16.187       16.314  
    coh520:k=52.4658,b=0       15.097         15.142      15.194       15.252       15.315        15.384        15.724        15.829        15.943        16.066        16.195       16.321  
    coh521:k=52.5661,b=0       15.106         15.151      15.203       15.261       15.324        15.393        15.733        15.838        15.951        16.074        16.202       16.329  
    coh522:k=52.6663,b=0       15.115          15.16      15.212        15.27       15.333        15.401        15.741        15.846         15.96        16.082         16.21       16.336  
    coh523:k=52.7666,b=0       15.124         15.169      15.221       15.279       15.342         15.41        15.749        15.854        15.968         16.09        16.218       16.344  
    coh524:k=52.8668,b=0       15.133         15.178       15.23       15.288       15.351        15.419        15.758        15.862        15.976        16.098        16.225       16.352  
    coh525:k=52.967,b=0        15.143         15.187      15.239       15.297        15.36        15.428        15.766         15.87        15.984        16.105        16.233       16.359  
    coh526:k=53.0673,b=0       15.152         15.197      15.248       15.306       15.368        15.436        15.774        15.878        15.992        16.113        16.241       16.366  
    coh527:k=53.1675,b=0       15.161         15.206      15.257       15.315       15.377        15.445        15.783        15.887        15.999        16.121        16.248       16.374  
    coh528:k=53.2677,b=0        15.17         15.215      15.266       15.324       15.386        15.454        15.791        15.895        16.007        16.129        16.256       16.381  
    coh529:k=53.368,b=0        15.179         15.224      15.275       15.332       15.395        15.463        15.799        15.903        16.015        16.137        16.263       16.389  
    coh530:k=53.4682,b=0       15.188         15.233      15.284       15.341       15.404        15.471        15.807        15.911        16.023        16.144        16.271       16.396  
    coh531:k=53.5684,b=0       15.198         15.242      15.293        15.35       15.412         15.48        15.816        15.919        16.031        16.152        16.279       16.404  
    coh532:k=53.6687,b=0       15.207         15.251      15.302       15.359       15.421        15.489        15.824        15.927        16.039         16.16        16.286       16.411  
    coh533:k=53.7689,b=0       15.216          15.26      15.311       15.368        15.43        15.497        15.832        15.935        16.047        16.168        16.294       16.418  
    coh534:k=53.8691,b=0       15.225         15.269       15.32       15.377       15.439        15.506         15.84        15.943        16.055        16.175        16.301       16.426  
    coh535:k=53.9694,b=0       15.234         15.278      15.329       15.386       15.447        15.515        15.848        15.951        16.063        16.183        16.309       16.433  
    coh536:k=54.0696,b=0       15.243         15.287      15.338       15.394       15.456        15.523        15.856        15.959        16.071        16.191        16.316        16.44  
    coh537:k=54.1698,b=0       15.252         15.296      15.347       15.403       15.465        15.532        15.865        15.967        16.078        16.198        16.324       16.448  
    coh538:k=54.2701,b=0       15.261         15.305      15.355       15.412       15.473         15.54        15.873        15.975        16.086        16.206        16.331       16.455  
    coh539:k=54.3703,b=0        15.27         15.314      15.364       15.421       15.482        15.549        15.881        15.983        16.094        16.214        16.339       16.462  
    coh540:k=54.4706,b=0       15.279         15.323      15.373       15.429       15.491        15.557        15.889        15.991        16.102        16.221        16.346        16.47  
    coh541:k=54.5708,b=0       15.289         15.332      15.382       15.438       15.499        15.566        15.897        15.999         16.11        16.229        16.354       16.477  
    coh542:k=54.671,b=0        15.298         15.341      15.391       15.447       15.508        15.574        15.905        16.007        16.117        16.236        16.361       16.484  
    coh543:k=54.7713,b=0       15.307         15.349      15.399       15.455       15.517        15.583        15.913        16.015        16.125        16.244        16.369       16.492  
    coh544:k=54.8715,b=0       15.316         15.358      15.408       15.464       15.525        15.591        15.921        16.023        16.133        16.252        16.376       16.499  
    coh545:k=54.9717,b=0       15.325         15.367      15.417       15.473       15.534          15.6        15.929         16.03        16.141        16.259        16.383       16.506  
    coh546:k=55.072,b=0        15.334         15.376      15.426       15.481       15.542        15.608        15.937        16.038        16.148        16.267        16.391       16.513  
    coh547:k=55.1722,b=0       15.343         15.385      15.434        15.49       15.551        15.617        15.945        16.046        16.156        16.274        16.398       16.521  
    coh548:k=55.2724,b=0       15.352         15.394      15.443       15.499       15.559        15.625        15.953        16.054        16.164        16.282        16.406       16.528  
    coh549:k=55.3727,b=0       15.361         15.403      15.452       15.507       15.568        15.634        15.961        16.062        16.171        16.289        16.413       16.535  
    coh550:k=55.4729,b=0        15.37         15.412      15.461       15.516       15.576        15.642        15.969         16.07        16.179        16.297         16.42       16.542  
    coh551:k=55.5731,b=0       15.379         15.421       15.47       15.525       15.585         15.65        15.977        16.077        16.187        16.304        16.428        16.55  
    coh552:k=55.6734,b=0       15.388          15.43      15.479       15.533       15.593        15.659        15.985        16.085        16.194        16.312        16.435       16.557  
    coh553:k=55.7736,b=0       15.397         15.439      15.488       15.542       15.602        15.667        15.993        16.093        16.202        16.319        16.442       16.564  
    coh554:k=55.8739,b=0       15.406         15.448      15.497       15.551        15.61        15.675        16.001        16.101         16.21        16.327         16.45       16.571  
    coh555:k=55.9741,b=0       15.415         15.457      15.505        15.56       15.619        15.684        16.008        16.108        16.217        16.334        16.457       16.578  
    coh556:k=56.0743,b=0       15.424         15.466      15.514       15.569       15.627        15.692        16.016        16.116        16.225        16.342        16.464       16.586  
    coh557:k=56.1746,b=0       15.433         15.475      15.523       15.577       15.636        15.701        16.024        16.124        16.232        16.349        16.472       16.593  
    coh558:k=56.2748,b=0       15.442         15.484      15.532       15.586       15.645        15.709        16.032        16.132         16.24        16.357        16.479         16.6  
    coh559:k=56.375,b=0        15.451         15.493      15.541       15.595       15.653        15.717         16.04        16.139        16.248        16.364        16.486       16.607  
    coh560:k=56.4753,b=0        15.46         15.502       15.55       15.604       15.662        15.726        16.048        16.147        16.255        16.372        16.494       16.614  
    coh561:k=56.5755,b=0       15.469         15.511      15.559       15.612       15.671        15.735        16.056        16.155        16.263        16.379        16.501       16.622  
    coh562:k=56.6757,b=0       15.478         15.519      15.567       15.621       15.679        15.743        16.064        16.163         16.27        16.386        16.508       16.629  
    coh563:k=56.776,b=0        15.487         15.528      15.576        15.63       15.688        15.752        16.072         16.17        16.278        16.394        16.516       16.636  
    coh564:k=56.8762,b=0       15.496         15.537      15.585       15.639       15.697         15.76        16.079        16.178        16.286        16.401        16.523       16.643  
    coh565:k=56.9764,b=0       15.505         15.546      15.594       15.648       15.705        15.769        16.087        16.186        16.293        16.409         16.53        16.65  
    coh566:k=57.0767,b=0       15.514         15.555      15.603       15.656       15.714        15.778        16.095        16.194        16.301        16.416        16.537       16.657  
    coh567:k=57.1769,b=0       15.523         15.564      15.612       15.665       15.723        15.786        16.103        16.201        16.308        16.424        16.545       16.665  
    coh568:k=57.2771,b=0       15.532         15.573       15.62       15.674       15.732        15.795        16.111        16.209        16.316        16.431        16.552       16.672  

tb_pol_a
                            z1_0_34741    z2_0_40076    z3_0_4623     z4_0_5333     z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567 
                            __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________    __________

    coh1:k=0.443648,b=0     9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05    9.9839e-05
    coh2:k=0.543883,b=0      0.0001224    0.00013347    0.00013347    0.00013347    0.00013347    0.00014455    0.00014455    0.00014455    0.00014455    0.00014455    0.00014455    0.00014455
    coh3:k=0.644119,b=0     0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743    0.00019743
    coh4:k=0.744354,b=0     0.00024331    0.00024331    0.00024331    0.00024331    0.00024331    0.00024331    0.00024331    0.00022815    0.00022815    0.00022815    0.00022815    0.00022815
    coh5:k=0.84459,b=0      0.00031048    0.00031048    0.00031048    0.00031048    0.00031048    0.00031048    0.00029328    0.00029328    0.00029328    0.00029328    0.00029328    0.00029328
    coh6:k=0.944825,b=0     0.00038582    0.00038582    0.00038582    0.00038582    0.00038582    0.00036657    0.00034733    0.00034733    0.00034733    0.00032809    0.00032809    0.00032809
    coh7:k=1.04506,b=0      0.00044803    0.00042675    0.00042675    0.00042675    0.00042675    0.00040546    0.00040546    0.00040546    0.00040546    0.00040546    0.00040546    0.00040546
    coh8:k=1.1453,b=0       0.00051433    0.00051433    0.00051433      0.000491      0.000491      0.000491      0.000491    0.00046768    0.00046768    0.00046768    0.00044435    0.00044435
    coh9:k=1.24553,b=0      0.00058471    0.00058471    0.00058471    0.00058471    0.00055935    0.00055935    0.00053398    0.00050861    0.00050861    0.00050861    0.00050861    0.00050861
    coh10:k=1.34577,b=0     0.00065918    0.00065918    0.00063177    0.00063177    0.00063177    0.00060436    0.00060436    0.00060436    0.00060436    0.00057695    0.00057695    0.00057695
    coh11:k=1.446,b=0       0.00070828    0.00070828    0.00070828    0.00070828    0.00070828    0.00070828    0.00067882    0.00064937    0.00064937    0.00061992    0.00061992    0.00061992
    coh12:k=1.54624,b=0     0.00078887    0.00078887    0.00078887    0.00078887    0.00078887    0.00075737    0.00072588    0.00072588    0.00069439    0.00069439    0.00069439    0.00069439
    coh13:k=1.64647,b=0     0.00087354    0.00087354    0.00087354       0.00084       0.00084       0.00084    0.00080647    0.00080647    0.00077294    0.00077294     0.0007394     0.0007394
    coh14:k=1.74671,b=0     0.00096229    0.00092672    0.00092672    0.00092672    0.00092672    0.00089114    0.00085557    0.00085557    0.00081999    0.00081999    0.00081999    0.00081999
    coh15:k=1.84694,b=0      0.0010175     0.0010175     0.0010175     0.0010175     0.0009799     0.0009799    0.00094228    0.00090466    0.00090466    0.00090466    0.00090466    0.00086705
    coh16:k=1.94718,b=0      0.0011124     0.0011124     0.0010727     0.0010727     0.0010727     0.0010727    0.00099342    0.00099342    0.00099342    0.00095376    0.00095376     0.0009141
    coh17:k=2.04742,b=0      0.0011697     0.0011697     0.0011697     0.0011697      0.001128      0.001128     0.0010863     0.0010446     0.0010446     0.0010029     0.0010029     0.0010029
    coh18:k=2.14765,b=0      0.0012707     0.0012269     0.0012269     0.0012269     0.0012269     0.0011832     0.0011394     0.0011394     0.0010957     0.0010957     0.0010957     0.0010957
    coh19:k=2.24789,b=0        0.00133       0.00133       0.00133     0.0012842     0.0012842     0.0012842     0.0011926     0.0011926     0.0011926     0.0011926     0.0011468     0.0011468
    coh20:k=2.34812,b=0      0.0013893     0.0013893     0.0013893     0.0013893     0.0013893     0.0013414     0.0012936     0.0012936     0.0012458     0.0012458      0.001198      0.001198
    coh21:k=2.44836,b=0      0.0014984     0.0014984     0.0014984     0.0014486     0.0014486     0.0014486     0.0013488     0.0013488      0.001299      0.001299      0.001299      0.001299
    coh22:k=2.54859,b=0      0.0015598     0.0015598     0.0015598     0.0015079     0.0015079     0.0015079      0.001456     0.0014041     0.0014041     0.0014041     0.0013522     0.0013522
    coh23:k=2.64883,b=0      0.0016751     0.0016211     0.0016211     0.0016211     0.0016211     0.0015672     0.0015132     0.0015132     0.0014593     0.0014593     0.0014053     0.0014053
    coh24:k=2.74906,b=0      0.0017385     0.0017385     0.0016825     0.0016825     0.0016825     0.0016825     0.0015705     0.0015705     0.0015705     0.0015145     0.0015145     0.0015145
    coh25:k=2.8493,b=0       0.0018019     0.0018019     0.0018019     0.0018019     0.0017438     0.0017438     0.0016858     0.0016278     0.0016278     0.0016278     0.0015697     0.0015697
    coh26:k=2.94953,b=0       0.025719     0.0018652     0.0018652     0.0018652     0.0018052     0.0018052     0.0017451     0.0017451      0.001685      0.001685      0.001625      0.001625
    coh27:k=3.04977,b=0        0.14879     0.0019908     0.0019286     0.0019286     0.0019286     0.0018665     0.0018044     0.0018044     0.0018044     0.0017423     0.0017423     0.0016802
    coh28:k=3.15001,b=0         0.2142     0.0020562      0.001992      0.001992      0.001992      0.001992     0.0018637     0.0018637     0.0018637     0.0017996     0.0017996     0.0017996
    coh29:k=3.25024,b=0        0.27699     0.0021216     0.0021216     0.0021216     0.0020554     0.0020554     0.0019892      0.001923      0.001923      0.001923     0.0018568     0.0018568
    coh30:k=3.35048,b=0        0.34368      0.002187      0.002187      0.002187     0.0021188     0.0021188     0.0020506     0.0020506     0.0019823     0.0019823     0.0019141     0.0019141
    coh31:k=3.45071,b=0        0.44583      0.069794     0.0022525     0.0022525     0.0022525     0.0021822     0.0021119     0.0021119     0.0020416     0.0020416     0.0020416     0.0019713
    coh32:k=3.55095,b=0        0.52423       0.19029     0.0023179     0.0023179     0.0023179     0.0023179     0.0021733     0.0021733     0.0021733     0.0021009     0.0021009     0.0021009
    coh33:k=3.65118,b=0        0.60694       0.25654     0.0024577     0.0023833     0.0023833     0.0023833      0.002309     0.0022346     0.0022346     0.0022346     0.0021602     0.0021602
    coh34:k=3.75142,b=0         0.6818       0.33246     0.0025252     0.0025252     0.0024488     0.0024488     0.0023724     0.0022959     0.0022959     0.0022959     0.0022195     0.0022195
    coh35:k=3.85165,b=0        0.80054       0.41223     0.0025926     0.0025926     0.0025926     0.0025142     0.0024357     0.0024357     0.0023573     0.0023573     0.0023573     0.0022788
    coh36:k=3.95189,b=0        0.86008       0.54524      0.063035     0.0026601     0.0026601     0.0025796     0.0024991     0.0024991     0.0024186     0.0024186     0.0024186     0.0023381
    coh37:k=4.05212,b=0        0.92387       0.63504       0.13912     0.0027276     0.0027276     0.0027276     0.0025625     0.0025625     0.0025625       0.00248       0.00248       0.00248
    coh38:k=4.15236,b=0         1.0287       0.69174       0.28119      0.002795      0.002795      0.002795     0.0027105     0.0026259     0.0026259     0.0026259     0.0025413     0.0025413
    coh39:k=4.2526,b=0          1.1106       0.75021       0.35622     0.0028625     0.0028625     0.0028625     0.0027759     0.0026893     0.0026893     0.0026893     0.0026027     0.0026027
    coh40:k=4.35283,b=0         1.1791       0.81026       0.44137     0.0030186       0.00293       0.00293     0.0028413     0.0028413     0.0027527     0.0027527     0.0027527      0.002664
    coh41:k=4.45307,b=0         1.3454       0.87262       0.49524     0.0030882     0.0030882     0.0029975     0.0029068     0.0029068     0.0028161     0.0028161     0.0028161     0.0027254
    coh42:k=4.5533,b=0          1.3935        1.0921        0.5512      0.070231     0.0031577     0.0030649     0.0029722     0.0029722     0.0029722     0.0028795     0.0028795     0.0028795
    coh43:k=4.65354,b=0         1.4348        1.1642       0.62271       0.14864     0.0032272     0.0032272     0.0030376     0.0030376     0.0030376     0.0029428     0.0029428     0.0029428
    coh44:k=4.75377,b=0          1.515        1.2386       0.82386       0.19827     0.0032967     0.0032967     0.0031999      0.003103      0.003103     0.0030062     0.0030062     0.0030062
    coh45:k=4.85401,b=0         1.5976        1.2738       0.89188       0.25031     0.0033662     0.0033662     0.0032673     0.0031685     0.0031685     0.0031685     0.0030696     0.0030696
    coh46:k=4.95424,b=0          1.682        1.3218       0.96166       0.45744     0.0034357     0.0034357     0.0033348     0.0033348     0.0032339     0.0032339      0.003133      0.003133
    coh47:k=5.05448,b=0         1.8206        1.4006        1.0332       0.51876     0.0035052     0.0035052     0.0034023     0.0034023     0.0032993     0.0032993     0.0032993     0.0031964
    coh48:k=5.15471,b=0         1.9136        1.4823        1.1076       0.58295     0.0036797     0.0035747     0.0034698     0.0034698     0.0033648     0.0033648     0.0033648     0.0032598
    coh49:k=5.25495,b=0         2.0087        1.6944        1.1838       0.64893      0.037704     0.0036443     0.0035372     0.0035372     0.0035372     0.0034302     0.0034302     0.0034302
    coh50:k=5.35519,b=0         2.0861        1.7657        1.2496       0.71666       0.10587     0.0037138     0.0036047     0.0036047     0.0036047     0.0034956     0.0034956     0.0034956
    coh519:k=52.3656,b=0         45.02         45.02        44.063        44.063        43.106        42.149        37.365        36.408        33.537        31.624        28.753        24.926
    coh520:k=52.4658,b=0        45.106        45.106        44.147        44.147        43.189         42.23        37.436        36.478        33.602        31.684        28.808        25.705
    coh521:k=52.5661,b=0        45.192        45.192        44.232        44.232        43.271        42.311        38.143        36.547        33.666        31.745        28.863        25.982
    coh522:k=52.6663,b=0        45.278        45.278        44.316        44.316        43.354        42.391        38.542        36.617         33.73        31.805        28.918        26.031
    coh523:k=52.7666,b=0        45.364        45.364          44.4          44.4        43.436        42.472        38.615        36.687        34.234        31.866        28.973        26.081
    coh524:k=52.8668,b=0        45.451        45.451        44.485        44.485        43.519        42.553        38.688        36.756        34.824        31.926        29.028         26.13
    coh525:k=52.967,b=0         45.537        45.537        44.569        44.569        43.601        42.633        38.762        36.826         34.89        31.987        29.083         26.18
    coh526:k=53.0673,b=0        45.623        45.623        44.653        44.653        43.684        42.714        38.835        36.896        34.956        32.047        29.138        26.229
    coh527:k=53.1675,b=0        45.709        45.709        44.738        44.738        43.766        42.795        38.909        36.965        35.022        32.108        29.193        26.279
    coh528:k=53.2677,b=0        45.795        45.795        44.822        44.822        43.849        42.875        38.982        37.035        35.088        32.168        29.248        26.328
    coh529:k=53.368,b=0         45.882        45.882        44.906        44.906        43.931        42.956        39.055        37.105        35.155        32.229        29.303        26.378
    coh530:k=53.4682,b=0        45.968        45.968        44.991        44.991        44.014        43.037        39.129        37.175        35.221        32.289        29.358        26.427
    coh531:k=53.5684,b=0        47.099        46.054        45.075        45.075        44.096        43.117        39.202        37.244        35.287         32.35        29.413        26.477
    coh532:k=53.6687,b=0        47.188         46.14        45.159        45.159        44.179        43.198        39.275        37.314        35.353        32.411        29.469        26.526
    coh533:k=53.7689,b=0        47.276        46.226        45.244        45.244        44.261        43.279        39.349        37.384        35.419        32.471        29.524        26.576
    coh534:k=53.8691,b=0        47.364        46.312        45.328        45.328        44.344        43.359        39.422        37.453        35.485        32.532        29.579        26.626
    coh535:k=53.9694,b=0        47.452        46.399        45.412        45.412        44.426         43.44        39.495        37.523        35.551        32.592        29.634        26.675
    coh536:k=54.0696,b=0         47.54        46.485        45.497        45.497        44.509        43.521        39.569        37.593        35.617        32.653        29.689        26.725
    coh537:k=54.1698,b=0        47.628        46.571        45.581        45.581        44.591        43.601        39.642        37.662        35.683        32.713        29.744        26.774
    coh538:k=54.2701,b=0        47.716        46.657        45.665        45.665        44.674        43.682        39.715        37.732        35.749        32.774        29.799        26.824
    coh539:k=54.3703,b=0        47.804        47.804         45.75         45.75        44.756        44.573        39.789        37.802        35.815        32.834        29.854        26.873
    coh540:k=54.4706,b=0        47.893        47.893        45.834        45.834        44.839        44.839        39.862        37.871        35.881        32.895        29.909        26.923
    coh541:k=54.5708,b=0        47.981        47.981        45.918        45.918        44.921        44.921        39.935        37.941        35.947        32.955        30.573        26.972
    coh542:k=54.671,b=0         48.069        48.069        46.003        46.003        45.004        45.004        40.009        38.011        36.013        33.016        31.018        27.022
    coh543:k=54.7713,b=0        48.157        48.157        46.087        46.087        45.086        45.086        40.082        38.081        36.079        33.482        31.075        27.071
    coh544:k=54.8715,b=0        48.245        48.245        46.171        46.171        45.169        45.169        40.156         38.15        36.145         34.14        31.132        27.121
    coh545:k=54.9717,b=0        48.333        48.333        46.256        46.256        45.251        45.251        40.229         38.22        36.211        34.202        31.188        27.372
    coh546:k=55.072,b=0         48.421        48.421        47.392         46.34        45.334        45.334        40.302         38.29        36.277        34.264        31.245        28.226
    coh547:k=55.1722,b=0        48.509        48.509        47.478        46.425        45.416        45.416        40.376        38.359        36.343        34.327        31.302        28.278
    coh548:k=55.2724,b=0        48.598        48.598        47.565        46.509        45.499        45.499        40.449        38.429        36.409        34.389        31.359        28.329
    coh549:k=55.3727,b=0        48.686        48.686        47.651        46.593        45.581        45.581        40.522        38.499        36.475        34.451        31.416        28.381
    coh550:k=55.4729,b=0        48.774        48.774        47.737        47.737        45.664        45.664        40.596        38.568        36.541        34.514        31.473        28.432
    coh551:k=55.5731,b=0        48.862        48.862        47.823        47.823        45.746        45.746        40.669        38.638        36.607        34.576         31.53        28.483
    coh552:k=55.6734,b=0         48.95         48.95         47.91         47.91        45.829        45.829        40.742        38.708        36.673        34.639        31.587        28.535
    coh553:k=55.7736,b=0        49.038        49.038        47.996        47.996        45.911        45.911        40.816        38.777        36.739        34.701        31.643        28.586
    coh554:k=55.8739,b=0        49.126        49.126        48.082        48.082        45.994        45.994        40.889        38.847        36.805        34.763          31.7        28.637
    coh555:k=55.9741,b=0        49.215        49.215        48.169        48.169        47.122        46.076        40.962        38.917        36.871        34.826        31.757        28.689
    coh556:k=56.0743,b=0        49.303        49.303        48.255        48.255        47.207        46.159        41.036        38.987        36.937        34.888        31.814         28.74
    coh557:k=56.1746,b=0        49.391        49.391        48.341        48.341        47.291        46.241        41.109        39.056        37.003         34.95        31.871        28.792
    coh558:k=56.2748,b=0        49.479        49.479        48.427        48.427        47.376        46.324        41.182        39.126        37.069        35.013        31.928        28.843
    coh559:k=56.375,b=0         49.567        49.567        48.514        48.514         47.46         47.46        41.256        39.196        37.135        35.075        31.985        28.894
    coh560:k=56.4753,b=0        49.655        49.655          48.6          48.6        47.544        47.544        41.329        39.265        37.201        35.137        32.042        28.946
    coh561:k=56.5755,b=0        49.743        49.743        48.686        48.686        47.629        47.629        41.403        39.335        37.267          35.2        32.098        28.997
    coh562:k=56.6757,b=0        49.831        49.831        48.772        48.772        47.713        47.713        41.476        39.405        37.333        35.262        32.155        29.048
    coh563:k=56.776,b=0          49.92         49.92        48.859        48.859        47.798        47.798        41.549        39.474        37.399        35.325        32.212          29.1
    coh564:k=56.8762,b=0        50.008        50.008        48.945        48.945        47.882        47.882        41.623        39.544        37.465        35.387        32.269        29.151
    coh565:k=56.9764,b=0        50.096        50.096        49.031        49.031        47.966        47.966        41.696        39.614        37.531        35.449        32.326        29.203
    coh566:k=57.0767,b=0        50.184        50.184        49.117        49.117        48.051        48.051        41.769        39.683        37.598        35.512        32.383        29.254
    coh567:k=57.1769,b=0        50.272        50.272        49.204        49.204        48.135        48.135        41.843        39.753        37.664        35.574         32.44        29.305
    coh568:k=57.2771,b=0         50.36         50.36         49.29         49.29        48.219        48.219        41.916        39.823         37.73        35.636        32.496        29.357

tb_pol_k
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0      0.099739      0.099739     0.099739     0.099739      0.099739      0.099739      0.099739      0.099739      0.099739      0.099739      0.099739     0.099739 
    coh2:k=0.543883,b=0       0.12227       0.13334      0.13334      0.13334       0.13334       0.14441       0.14441       0.14441       0.14441       0.14441       0.14441      0.14441 
    coh3:k=0.644119,b=0       0.19723       0.19723      0.19723      0.19723       0.19723       0.19723       0.19723       0.19723       0.19723       0.19723       0.19723      0.19723 
    coh4:k=0.744354,b=0       0.24307       0.24307      0.24307      0.24307       0.24307       0.24307       0.24307       0.22792       0.22792       0.22792       0.22792      0.22792 
    coh5:k=0.84459,b=0        0.31017       0.31017      0.31017      0.31017       0.31017       0.31017       0.29299       0.29299       0.29299       0.29299       0.29299      0.29299 
    coh6:k=0.944825,b=0       0.38543       0.38543      0.38543      0.38543       0.38543       0.36621       0.34698       0.34698       0.34698       0.32776       0.32776      0.32776 
    coh7:k=1.04506,b=0        0.44758       0.42632      0.42632      0.42632       0.42632       0.40506       0.40506       0.40506       0.40506       0.40506       0.40506      0.40506 
    coh8:k=1.1453,b=0         0.51382       0.51382      0.51382      0.49051       0.49051       0.49051       0.49051       0.46721       0.46721       0.46721       0.44391      0.44391 
    coh9:k=1.24553,b=0        0.58413       0.58413      0.58413      0.58413       0.55879       0.55879       0.53344        0.5081        0.5081        0.5081        0.5081       0.5081 
    coh10:k=1.34577,b=0       0.65852       0.65852      0.63114      0.63114       0.63114       0.60375       0.60375       0.60375       0.60375       0.57637       0.57637      0.57637 
    coh11:k=1.446,b=0         0.70757       0.70757      0.70757      0.70757       0.70757       0.70757       0.67815       0.64872       0.64872        0.6193        0.6193       0.6193 
    coh12:k=1.54624,b=0       0.78808       0.78808      0.78808      0.78808       0.78808       0.75662       0.72515       0.72515       0.69369       0.69369       0.69369      0.69369 
    coh13:k=1.64647,b=0       0.87266       0.87266      0.87266      0.83916       0.83916       0.83916       0.80566       0.80566       0.77216       0.77216       0.73866      0.73866 
    coh14:k=1.74671,b=0       0.96133       0.92579      0.92579      0.92579       0.92579       0.89025       0.85471       0.85471       0.81917       0.81917       0.81917      0.81917 
    coh15:k=1.84694,b=0        1.0165        1.0165       1.0165       1.0165       0.97892       0.97892       0.94134       0.90376       0.90376       0.90376       0.90376      0.86618 
    coh16:k=1.94718,b=0        1.1113        1.1113       1.0717       1.0717        1.0717        1.0717       0.99243       0.99243       0.99243       0.95281       0.95281      0.91319 
    coh17:k=2.04742,b=0        1.1685        1.1685       1.1685       1.1685        1.1268        1.1268        1.0852        1.0435        1.0435        1.0019        1.0019       1.0019 
    coh18:k=2.14765,b=0        1.2694        1.2257       1.2257       1.2257        1.2257         1.182        1.1383        1.1383        1.0946        1.0946        1.0946       1.0946 
    coh19:k=2.24789,b=0        1.3286        1.3286       1.3286       1.2829        1.2829        1.2829        1.1914        1.1914        1.1914        1.1914        1.1457       1.1457 
    coh20:k=2.34812,b=0        1.3879        1.3879       1.3879       1.3879        1.3879        1.3401        1.2923        1.2923        1.2446        1.2446        1.1968       1.1968 
    coh21:k=2.44836,b=0        1.4969        1.4969       1.4969       1.4471        1.4471        1.4471        1.3475        1.3475        1.2977        1.2977        1.2977       1.2977 
    coh22:k=2.54859,b=0        1.5582        1.5582       1.5582       1.5064        1.5064        1.5064        1.4545        1.4027        1.4027        1.4027        1.3508       1.3508 
    coh23:k=2.64883,b=0        1.6734        1.6195       1.6195       1.6195        1.6195        1.5656        1.5117        1.5117        1.4578        1.4578        1.4039       1.4039 
    coh24:k=2.74906,b=0        1.7367        1.7367       1.6808       1.6808        1.6808        1.6808        1.5689        1.5689        1.5689         1.513         1.513        1.513 
    coh25:k=2.8493,b=0         1.8001        1.8001       1.8001       1.8001        1.7421        1.7421        1.6841        1.6261        1.6261        1.6261        1.5682       1.5682 
    coh26:k=2.94953,b=0        1.8395        1.8634       1.8634       1.8634        1.8034        1.8034        1.7434        1.7434        1.6833        1.6833        1.6233       1.6233 
    coh27:k=3.04977,b=0         1.842        1.9888       1.9267       1.9267        1.9267        1.8647        1.8026        1.8026        1.8026        1.7405        1.7405       1.6785 
    coh28:k=3.15001,b=0         1.842        2.0541         1.99         1.99          1.99          1.99        1.8618        1.8618        1.8618        1.7978        1.7978       1.7978 
    coh29:k=3.25024,b=0        1.8446        2.1195       2.1195       2.1195        2.0534        2.0534        1.9872        1.9211        1.9211        1.9211         1.855        1.855 
    coh30:k=3.35048,b=0        1.8434        2.1849       2.1849       2.1849        2.1167        2.1167        2.0485        2.0485        1.9803        1.9803        1.9122       1.9122 
    coh31:k=3.45071,b=0        1.8769        2.1827       2.2502       2.2502        2.2502          2.18        2.1098        2.1098        2.0396        2.0396        2.0396       1.9694 
    coh32:k=3.55095,b=0         1.866        2.1999       2.3156       2.3156        2.3156        2.3156        2.1711        2.1711        2.1711        2.0988        2.0988       2.0988 
    coh33:k=3.65118,b=0        1.8508        2.2012       2.4552       2.3809        2.3809        2.3809        2.3067        2.2324        2.2324        2.2324        2.1581       2.1581 
    coh34:k=3.75142,b=0        1.8434        2.1927       2.5226       2.5226        2.4463        2.4463          2.37        2.2936        2.2936        2.2936        2.2173       2.2173 
    coh35:k=3.85165,b=0        1.8705        2.1804         2.59         2.59          2.59        2.5117        2.4333        2.4333        2.3549        2.3549        2.3549       2.2766 
    coh36:k=3.95189,b=0        1.8805        2.1954       2.5971       2.6574        2.6574         2.577        2.4966        2.4966        2.4162        2.4162        2.4162       2.3358 
    coh37:k=4.05212,b=0        1.8862        2.1751       2.5885       2.7248        2.7248        2.7248          2.56          2.56          2.56        2.4775        2.4775       2.4775 
    coh38:k=4.15236,b=0        1.8509        2.1879       2.5984       2.7923        2.7923        2.7923        2.7078        2.6233        2.6233        2.6233        2.5388       2.5388 
    coh39:k=4.2526,b=0         1.8385        2.1989       2.5929       2.8597        2.8597        2.8597        2.7731        2.6866        2.6866        2.6866        2.6001       2.6001 
    coh40:k=4.35283,b=0        1.8395        2.2084       2.5773       3.0156        2.9271        2.9271        2.8385        2.8385        2.7499        2.7499        2.7499       2.6614 
    coh41:k=4.45307,b=0        1.8334        2.2155       2.5929       3.0851        3.0851        2.9945        2.9039        2.9039        2.8132        2.8132        2.8132       2.7226 
    coh42:k=4.5533,b=0         1.8569        2.1584       2.6065       3.0874        3.1545        3.0619        2.9692        2.9692        2.9692        2.8766        2.8766       2.8766 
    coh43:k=4.65354,b=0        1.8872        2.1578       2.6045       3.0785         3.224         3.224        3.0346        3.0346        3.0346        2.9399        2.9399       2.9399 
    coh44:k=4.75377,b=0        1.8785         2.155       2.5697       3.0984        3.2934        3.2934        3.1967        3.0999        3.0999        3.0032        3.0032       3.0032 
    coh45:k=4.85401,b=0        1.8674        2.1913       2.5732       3.1159        3.3628        3.3628        3.2641        3.1653        3.1653        3.1653        3.0665       3.0665 
    coh46:k=4.95424,b=0        1.8546        2.2148        2.575       3.0792        3.4323        3.4323        3.3315        3.3315        3.2307        3.2307        3.1299       3.1299 
    coh47:k=5.05448,b=0        1.8905        2.2076        2.575       3.0894        3.5017        3.5017        3.3989        3.3989         3.296         3.296         3.296       3.1932 
    coh48:k=5.15471,b=0        1.8711        2.1974       2.5722       3.0968         3.676        3.5712        3.4663        3.4663        3.3614        3.3614        3.3614       3.2565 
    coh49:k=5.25495,b=0        1.8496        2.1639       2.5675       3.1024        3.7136        3.6406        3.5337        3.5337        3.5337        3.4268        3.4268       3.4268 
    coh50:k=5.35519,b=0        1.8458        2.1662       2.5732       3.1062         3.717        3.7101        3.6011        3.6011        3.6011        3.4921        3.4921       3.4921 
    coh519:k=52.3656,b=0       1.9607        1.9607       2.9176       2.9176        3.8745        4.8313        9.6157        10.573        13.443        15.357        18.227       22.055 
    coh520:k=52.4658,b=0       1.9645        1.9645       2.9232       2.9232        3.8819        4.8406        9.6341        10.593        13.469        15.386        18.262       21.365 
    coh521:k=52.5661,b=0       1.9682        1.9682       2.9288       2.9288        3.8893        4.8498        9.0177        10.613        13.495        15.416        18.297       21.179 
    coh522:k=52.6663,b=0        1.972         1.972       2.9343       2.9343        3.8967        4.8591        8.7085        10.633         13.52        15.445        18.332       21.219 
    coh523:k=52.7666,b=0       1.9757        1.9757       2.9399       2.9399        3.9041        4.8683        8.7251        10.653        13.107        15.474        18.367        21.26 
    coh524:k=52.8668,b=0       1.9795        1.9795       2.9455       2.9455        3.9115        4.8776        8.7417        10.674        12.606        15.504        18.402         21.3 
    coh525:k=52.967,b=0        1.9832        1.9832       2.9511       2.9511         3.919        4.8868        8.7582        10.694         12.63        15.533        18.437        21.34 
    coh526:k=53.0673,b=0        1.987         1.987       2.9567       2.9567        3.9264        4.8961        8.7748        10.714        12.654        15.563        18.472       21.381 
    coh527:k=53.1675,b=0       1.9907        1.9907       2.9623       2.9623        3.9338        4.9053        8.7914        10.734        12.677        15.592        18.507       21.421 
    coh528:k=53.2677,b=0       1.9945        1.9945       2.9678       2.9678        3.9412        4.9146         8.808        10.755        12.701        15.621        18.541       21.462 
    coh529:k=53.368,b=0        1.9982        1.9982       2.9734       2.9734        3.9486        4.9238        8.8245        10.775        12.725        15.651        18.576       21.502 
    coh530:k=53.4682,b=0        2.002         2.002        2.979        2.979         3.956         4.933        8.8411        10.795        12.749         15.68        18.611       21.542 
    coh531:k=53.5684,b=0       2.0513        2.0058       2.9846       2.9846        3.9634        4.9423        8.8577        10.815        12.773         15.71        18.646       21.583 
    coh532:k=53.6687,b=0       2.0551        2.0095       2.9902       2.9902        3.9709        4.9515        8.8743        10.836        12.797        15.739        18.681       21.623 
    coh533:k=53.7689,b=0        2.059        2.0133       2.9958       2.9958        3.9783        4.9608        8.8908        10.856        12.821        15.768        18.716       21.663 
    coh534:k=53.8691,b=0       2.0628         2.017       3.0014       3.0014        3.9857          4.97        8.9074        10.876        12.845        15.798        18.751       21.704 
    coh535:k=53.9694,b=0       2.0666        2.0208       3.0069       3.0069        3.9931        4.9793         8.924        10.896        12.869        15.827        18.786       21.744 
    coh536:k=54.0696,b=0       2.0705        2.0245       3.0125       3.0125        4.0005        4.9885        8.9406        10.917        12.893        15.857        18.821       21.785 
    coh537:k=54.1698,b=0       2.0743        2.0283       3.0181       3.0181        4.0079        4.9978        8.9571        10.937        12.916        15.886        18.855       21.825 
    coh538:k=54.2701,b=0       2.0782         2.032       3.0237       3.0237        4.0154         5.007        8.9737        10.957         12.94        15.915         18.89       21.865 
    coh539:k=54.3703,b=0        2.082         2.082       3.0293       3.0293        4.0228        4.2063        8.9903        10.977        12.964        15.945        18.925       21.906 
    coh540:k=54.4706,b=0       2.0858        2.0858       3.0349       3.0349        4.0302        4.0302        9.0069        10.998        12.988        15.974         18.96       21.946 
    coh541:k=54.5708,b=0       2.0897        2.0897       3.0404       3.0404        4.0376        4.0376        9.0234        11.018        13.012        16.004        18.386       21.987 
    coh542:k=54.671,b=0        2.0935        2.0935        3.046        3.046         4.045         4.045          9.04        11.038        13.036        16.033        18.031       22.027 
    coh543:k=54.7713,b=0       2.0973        2.0973       3.0516       3.0516        4.0524        4.0524        9.0566        11.058         13.06        15.657        18.064       22.067 
    coh544:k=54.8715,b=0       2.1012        2.1012       3.0572       3.0572        4.0599        4.0599        9.0731        11.078        13.084        15.089        18.097       22.108 
    coh545:k=54.9717,b=0        2.105         2.105       3.0628       3.0628        4.0673        4.0673        9.0897        11.099        13.108        15.117         18.13       21.947 
    coh546:k=55.072,b=0        2.1089        2.1089        3.138       3.0684        4.0747        4.0747        9.1063        11.119        13.132        15.144        18.163       21.182 
    coh547:k=55.1722,b=0       2.1127        2.1127       3.1437        3.074        4.0821        4.0821        9.1229        11.139        13.155        15.172        18.196       21.221 
    coh548:k=55.2724,b=0       2.1165        2.1165       3.1495       3.0795        4.0895        4.0895        9.1394        11.159        13.179        15.199        18.229       21.259 
    coh549:k=55.3727,b=0       2.1204        2.1204       3.1552       3.0851        4.0969        4.0969         9.156         11.18        13.203        15.227        18.262       21.298 
    coh550:k=55.4729,b=0       2.1242        2.1242       3.1609       3.1609        4.1044        4.1044        9.1726          11.2        13.227        15.254        18.295       21.336 
    coh551:k=55.5731,b=0       2.1281        2.1281       3.1666       3.1666        4.1118        4.1118        9.1892         11.22        13.251        15.282        18.328       21.375 
    coh552:k=55.6734,b=0       2.1319        2.1319       3.1723       3.1723        4.1192        4.1192        9.2057         11.24        13.275         15.31        18.362       21.413 
    coh553:k=55.7736,b=0       2.1357        2.1357        3.178        3.178        4.1266        4.1266        9.2223        11.261        13.299        15.337        18.395       21.452 
    coh554:k=55.8739,b=0       2.1396        2.1396       3.1837       3.1837         4.134         4.134        9.2389        11.281        13.323        15.365        18.428       21.491 
    coh555:k=55.9741,b=0       2.1434        2.1434       3.1894       3.1894        4.2355        4.1414        9.2555        11.301        13.347        15.392        18.461       21.529 
    coh556:k=56.0743,b=0       2.1472        2.1472       3.1951       3.1951         4.243        4.1489         9.272        11.321        13.371         15.42        18.494       21.568 
    coh557:k=56.1746,b=0       2.1511        2.1511       3.2009       3.2009        4.2506        4.1563        9.2886        11.342        13.394        15.447        18.527       21.606 
    coh558:k=56.2748,b=0       2.1549        2.1549       3.2066       3.2066        4.2582        4.1637        9.3052        11.362        13.418        15.475         18.56       21.645 
    coh559:k=56.375,b=0        2.1588        2.1588       3.2123       3.2123        4.2658        4.2658        9.3218        11.382        13.442        15.503        18.593       21.683 
    coh560:k=56.4753,b=0       2.1626        2.1626        3.218        3.218        4.2734        4.2734        9.3383        11.402        13.466         15.53        18.626       21.722 
    coh561:k=56.5755,b=0       2.1664        2.1664       3.2237       3.2237         4.281         4.281        9.3549        11.423         13.49        15.558        18.659        21.76 
    coh562:k=56.6757,b=0       2.1703        2.1703       3.2294       3.2294        4.2886        4.2886        9.3715        11.443        13.514        15.585        18.692       21.799 
    coh563:k=56.776,b=0        2.1741        2.1741       3.2351       3.2351        4.2961        4.2961        9.3881        11.463        13.538        15.613        18.725       21.838 
    coh564:k=56.8762,b=0        2.178         2.178       3.2408       3.2408        4.3037        4.3037        9.4046        11.483        13.562         15.64        18.758       21.876 
    coh565:k=56.9764,b=0       2.1818        2.1818       3.2465       3.2465        4.3113        4.3113        9.4212        11.503        13.586        15.668        18.791       21.915 
    coh566:k=57.0767,b=0       2.1856        2.1856       3.2523       3.2523        4.3189        4.3189        9.4378        11.524         13.61        15.695        18.824       21.953 
    coh567:k=57.1769,b=0       2.1895        2.1895        3.258        3.258        4.3265        4.3265        9.4544        11.544        13.633        15.723        18.857       21.992 
    coh568:k=57.2771,b=0       2.1933        2.1933       3.2637       3.2637        4.3341        4.3341        9.4709        11.564        13.657        15.751         18.89        22.03 

tb_pol_w
                            z1_0_34741    z2_0_40076    z3_0_4623    z4_0_5333    z5_0_61519    z6_0_70966    z10_1_2567    z11_1_4496    z12_1_6723    z13_1_9291    z14_2_2253    z15_2_567
                            __________    __________    _________    _________    __________    __________    __________    __________    __________    __________    __________    _________

    coh1:k=0.443648,b=0      0.099839      0.099839     0.099839     0.099839      0.099839      0.099839      0.099839      0.099839      0.099839      0.099839      0.099839     0.099839 
    coh2:k=0.543883,b=0        0.1224       0.13347      0.13347      0.13347       0.13347       0.14455       0.14455       0.14455       0.14455       0.14455       0.14455      0.14455 
    coh3:k=0.644119,b=0       0.19743       0.19743      0.19743      0.19743       0.19743       0.19743       0.19743       0.19743       0.19743       0.19743       0.19743      0.19743 
    coh4:k=0.744354,b=0       0.24331       0.24331      0.24331      0.24331       0.24331       0.24331       0.24331       0.22815       0.22815       0.22815       0.22815      0.22815 
    coh5:k=0.84459,b=0        0.31048       0.31048      0.31048      0.31048       0.31048       0.31048       0.29328       0.29328       0.29328       0.29328       0.29328      0.29328 
    coh6:k=0.944825,b=0       0.38582       0.38582      0.38582      0.38582       0.38582       0.36657       0.34733       0.34733       0.34733       0.32809       0.32809      0.32809 
    coh7:k=1.04506,b=0        0.44803       0.42675      0.42675      0.42675       0.42675       0.40546       0.40546       0.40546       0.40546       0.40546       0.40546      0.40546 
    coh8:k=1.1453,b=0         0.51433       0.51433      0.51433        0.491         0.491         0.491         0.491       0.46768       0.46768       0.46768       0.44435      0.44435 
    coh9:k=1.24553,b=0        0.58471       0.58471      0.58471      0.58471       0.55935       0.55935       0.53398       0.50861       0.50861       0.50861       0.50861      0.50861 
    coh10:k=1.34577,b=0       0.65918       0.65918      0.63177      0.63177       0.63177       0.60436       0.60436       0.60436       0.60436       0.57695       0.57695      0.57695 
    coh11:k=1.446,b=0         0.70828       0.70828      0.70828      0.70828       0.70828       0.70828       0.67882       0.64937       0.64937       0.61992       0.61992      0.61992 
    coh12:k=1.54624,b=0       0.78887       0.78887      0.78887      0.78887       0.78887       0.75737       0.72588       0.72588       0.69439       0.69439       0.69439      0.69439 
    coh13:k=1.64647,b=0       0.87354       0.87354      0.87354         0.84          0.84          0.84       0.80647       0.80647       0.77294       0.77294        0.7394       0.7394 
    coh14:k=1.74671,b=0       0.96229       0.92672      0.92672      0.92672       0.92672       0.89114       0.85557       0.85557       0.81999       0.81999       0.81999      0.81999 
    coh15:k=1.84694,b=0        1.0175        1.0175       1.0175       1.0175        0.9799        0.9799       0.94228       0.90466       0.90466       0.90466       0.90466      0.86705 
    coh16:k=1.94718,b=0        1.1124        1.1124       1.0727       1.0727        1.0727        1.0727       0.99342       0.99342       0.99342       0.95376       0.95376       0.9141 
    coh17:k=2.04742,b=0        1.1697        1.1697       1.1697       1.1697         1.128         1.128        1.0863        1.0446        1.0446        1.0029        1.0029       1.0029 
    coh18:k=2.14765,b=0        1.2707        1.2269       1.2269       1.2269        1.2269        1.1832        1.1394        1.1394        1.0957        1.0957        1.0957       1.0957 
    coh19:k=2.24789,b=0          1.33          1.33         1.33       1.2842        1.2842        1.2842        1.1926        1.1926        1.1926        1.1926        1.1468       1.1468 
    coh20:k=2.34812,b=0        1.3893        1.3893       1.3893       1.3893        1.3893        1.3414        1.2936        1.2936        1.2458        1.2458         1.198        1.198 
    coh21:k=2.44836,b=0        1.4984        1.4984       1.4984       1.4486        1.4486        1.4486        1.3488        1.3488         1.299         1.299         1.299        1.299 
    coh22:k=2.54859,b=0        1.5598        1.5598       1.5598       1.5079        1.5079        1.5079         1.456        1.4041        1.4041        1.4041        1.3522       1.3522 
    coh23:k=2.64883,b=0        1.6751        1.6211       1.6211       1.6211        1.6211        1.5672        1.5132        1.5132        1.4593        1.4593        1.4053       1.4053 
    coh24:k=2.74906,b=0        1.7385        1.7385       1.6825       1.6825        1.6825        1.6825        1.5705        1.5705        1.5705        1.5145        1.5145       1.5145 
    coh25:k=2.8493,b=0         1.8019        1.8019       1.8019       1.8019        1.7438        1.7438        1.6858        1.6278        1.6278        1.6278        1.5697       1.5697 
    coh26:k=2.94953,b=0        1.8652        1.8652       1.8652       1.8652        1.8052        1.8052        1.7451        1.7451         1.685         1.685         1.625        1.625 
    coh27:k=3.04977,b=0        1.9908        1.9908       1.9286       1.9286        1.9286        1.8665        1.8044        1.8044        1.8044        1.7423        1.7423       1.6802 
    coh28:k=3.15001,b=0        2.0562        2.0562        1.992        1.992         1.992         1.992        1.8637        1.8637        1.8637        1.7996        1.7996       1.7996 
    coh29:k=3.25024,b=0        2.1216        2.1216       2.1216       2.1216        2.0554        2.0554        1.9892         1.923         1.923         1.923        1.8568       1.8568 
    coh30:k=3.35048,b=0         2.187         2.187        2.187        2.187        2.1188        2.1188        2.0506        2.0506        1.9823        1.9823        1.9141       1.9141 
    coh31:k=3.45071,b=0        2.3228        2.2525       2.2525       2.2525        2.2525        2.1822        2.1119        2.1119        2.0416        2.0416        2.0416       1.9713 
    coh32:k=3.55095,b=0        2.3902        2.3902       2.3179       2.3179        2.3179        2.3179        2.1733        2.1733        2.1733        2.1009        2.1009       2.1009 
    coh33:k=3.65118,b=0        2.4577        2.4577       2.4577       2.3833        2.3833        2.3833         2.309        2.2346        2.2346        2.2346        2.1602       2.1602 
    coh34:k=3.75142,b=0        2.5252        2.5252       2.5252       2.5252        2.4488        2.4488        2.3724        2.2959        2.2959        2.2959        2.2195       2.2195 
    coh35:k=3.85165,b=0        2.6711        2.5926       2.5926       2.5926        2.5926        2.5142        2.4357        2.4357        2.3573        2.3573        2.3573       2.2788 
    coh36:k=3.95189,b=0        2.7406        2.7406       2.6601       2.6601        2.6601        2.5796        2.4991        2.4991        2.4186        2.4186        2.4186       2.3381 
    coh37:k=4.05212,b=0        2.8101        2.8101       2.7276       2.7276        2.7276        2.7276        2.5625        2.5625        2.5625          2.48          2.48         2.48 
    coh38:k=4.15236,b=0        2.8796        2.8796       2.8796        2.795         2.795         2.795        2.7105        2.6259        2.6259        2.6259        2.5413       2.5413 
    coh39:k=4.2526,b=0         2.9491        2.9491       2.9491       2.8625        2.8625        2.8625        2.7759        2.6893        2.6893        2.6893        2.6027       2.6027 
    coh40:k=4.35283,b=0        3.0186        3.0186       3.0186       3.0186          2.93          2.93        2.8413        2.8413        2.7527        2.7527        2.7527        2.664 
    coh41:k=4.45307,b=0        3.1789        3.0882       3.0882       3.0882        3.0882        2.9975        2.9068        2.9068        2.8161        2.8161        2.8161       2.7254 
    coh42:k=4.5533,b=0         3.2504        3.2504       3.1577       3.1577        3.1577        3.0649        2.9722        2.9722        2.9722        2.8795        2.8795       2.8795 
    coh43:k=4.65354,b=0         3.322         3.322       3.2272       3.2272        3.2272        3.2272        3.0376        3.0376        3.0376        2.9428        2.9428       2.9428 
    coh44:k=4.75377,b=0        3.3935        3.3935       3.3935       3.2967        3.2967        3.2967        3.1999         3.103         3.103        3.0062        3.0062       3.0062 
    coh45:k=4.85401,b=0        3.4651        3.4651       3.4651       3.3662        3.3662        3.3662        3.2673        3.1685        3.1685        3.1685        3.0696       3.0696 
    coh46:k=4.95424,b=0        3.5366        3.5366       3.5366       3.5366        3.4357        3.4357        3.3348        3.3348        3.2339        3.2339         3.133        3.133 
    coh47:k=5.05448,b=0        3.7111        3.6082       3.6082       3.6082        3.5052        3.5052        3.4023        3.4023        3.2993        3.2993        3.2993       3.1964 
    coh48:k=5.15471,b=0        3.7847        3.6797       3.6797       3.6797        3.6797        3.5747        3.4698        3.4698        3.3648        3.3648        3.3648       3.2598 
    coh49:k=5.25495,b=0        3.8583        3.8583       3.7513       3.7513        3.7513        3.6443        3.5372        3.5372        3.5372        3.4302        3.4302       3.4302 
    coh50:k=5.35519,b=0        3.9319        3.9319       3.8228       3.8228        3.8228        3.7138        3.6047        3.6047        3.6047        3.4956        3.4956       3.4956 
    coh519:k=52.3656,b=0       46.981        46.981       46.981       46.981        46.981        46.981        46.981        46.981        46.981        46.981        46.981       46.981 
    coh520:k=52.4658,b=0        47.07         47.07        47.07        47.07         47.07         47.07         47.07         47.07         47.07         47.07         47.07        47.07 
    coh521:k=52.5661,b=0        47.16         47.16        47.16        47.16         47.16         47.16         47.16         47.16         47.16         47.16         47.16        47.16 
    coh522:k=52.6663,b=0        47.25         47.25        47.25        47.25         47.25         47.25         47.25         47.25         47.25         47.25         47.25        47.25 
    coh523:k=52.7666,b=0        47.34         47.34        47.34        47.34         47.34         47.34         47.34         47.34         47.34         47.34         47.34        47.34 
    coh524:k=52.8668,b=0        47.43         47.43        47.43        47.43         47.43         47.43         47.43         47.43         47.43         47.43         47.43        47.43 
    coh525:k=52.967,b=0         47.52         47.52        47.52        47.52         47.52         47.52         47.52         47.52         47.52         47.52         47.52        47.52 
    coh526:k=53.0673,b=0        47.61         47.61        47.61        47.61         47.61         47.61         47.61         47.61         47.61         47.61         47.61        47.61 
    coh527:k=53.1675,b=0         47.7          47.7         47.7         47.7          47.7          47.7          47.7          47.7          47.7          47.7          47.7         47.7 
    coh528:k=53.2677,b=0        47.79         47.79        47.79        47.79         47.79         47.79         47.79         47.79         47.79         47.79         47.79        47.79 
    coh529:k=53.368,b=0         47.88         47.88        47.88        47.88         47.88         47.88         47.88         47.88         47.88         47.88         47.88        47.88 
    coh530:k=53.4682,b=0        47.97         47.97        47.97        47.97         47.97         47.97         47.97         47.97         47.97         47.97         47.97        47.97 
    coh531:k=53.5684,b=0       49.151         48.06        48.06        48.06         48.06         48.06         48.06         48.06         48.06         48.06         48.06        48.06 
    coh532:k=53.6687,b=0       49.243         48.15        48.15        48.15         48.15         48.15         48.15         48.15         48.15         48.15         48.15        48.15 
    coh533:k=53.7689,b=0       49.335        48.239       48.239       48.239        48.239        48.239        48.239        48.239        48.239        48.239        48.239       48.239 
    coh534:k=53.8691,b=0       49.427        48.329       48.329       48.329        48.329        48.329        48.329        48.329        48.329        48.329        48.329       48.329 
    coh535:k=53.9694,b=0       49.519        48.419       48.419       48.419        48.419        48.419        48.419        48.419        48.419        48.419        48.419       48.419 
    coh536:k=54.0696,b=0       49.611        48.509       48.509       48.509        48.509        48.509        48.509        48.509        48.509        48.509        48.509       48.509 
    coh537:k=54.1698,b=0       49.702        48.599       48.599       48.599        48.599        48.599        48.599        48.599        48.599        48.599        48.599       48.599 
    coh538:k=54.2701,b=0       49.794        48.689       48.689       48.689        48.689        48.689        48.689        48.689        48.689        48.689        48.689       48.689 
    coh539:k=54.3703,b=0       49.886        49.886       48.779       48.779        48.779        48.779        48.779        48.779        48.779        48.779        48.779       48.779 
    coh540:k=54.4706,b=0       49.978        49.978       48.869       48.869        48.869        48.869        48.869        48.869        48.869        48.869        48.869       48.869 
    coh541:k=54.5708,b=0        50.07         50.07       48.959       48.959        48.959        48.959        48.959        48.959        48.959        48.959        48.959       48.959 
    coh542:k=54.671,b=0        50.162        50.162       49.049       49.049        49.049        49.049        49.049        49.049        49.049        49.049        49.049       49.049 
    coh543:k=54.7713,b=0       50.254        50.254       49.139       49.139        49.139        49.139        49.139        49.139        49.139        49.139        49.139       49.139 
    coh544:k=54.8715,b=0       50.346        50.346       49.229       49.229        49.229        49.229        49.229        49.229        49.229        49.229        49.229       49.229 
    coh545:k=54.9717,b=0       50.438        50.438       49.319       49.319        49.319        49.319        49.319        49.319        49.319        49.319        49.319       49.319 
    coh546:k=55.072,b=0         50.53         50.53        50.53       49.409        49.409        49.409        49.409        49.409        49.409        49.409        49.409       49.409 
    coh547:k=55.1722,b=0       50.622        50.622       50.622       49.498        49.498        49.498        49.498        49.498        49.498        49.498        49.498       49.498 
    coh548:k=55.2724,b=0       50.714        50.714       50.714       49.588        49.588        49.588        49.588        49.588        49.588        49.588        49.588       49.588 
    coh549:k=55.3727,b=0       50.806        50.806       50.806       49.678        49.678        49.678        49.678        49.678        49.678        49.678        49.678       49.678 
    coh550:k=55.4729,b=0       50.898        50.898       50.898       50.898        49.768        49.768        49.768        49.768        49.768        49.768        49.768       49.768 
    coh551:k=55.5731,b=0        50.99         50.99        50.99        50.99        49.858        49.858        49.858        49.858        49.858        49.858        49.858       49.858 
    coh552:k=55.6734,b=0       51.082        51.082       51.082       51.082        49.948        49.948        49.948        49.948        49.948        49.948        49.948       49.948 
    coh553:k=55.7736,b=0       51.174        51.174       51.174       51.174        50.038        50.038        50.038        50.038        50.038        50.038        50.038       50.038 
    coh554:k=55.8739,b=0       51.266        51.266       51.266       51.266        50.128        50.128        50.128        50.128        50.128        50.128        50.128       50.128 
    coh555:k=55.9741,b=0       51.358        51.358       51.358       51.358        51.358        50.218        50.218        50.218        50.218        50.218        50.218       50.218 
    coh556:k=56.0743,b=0        51.45         51.45        51.45        51.45         51.45        50.308        50.308        50.308        50.308        50.308        50.308       50.308 
    coh557:k=56.1746,b=0       51.542        51.542       51.542       51.542        51.542        50.398        50.398        50.398        50.398        50.398        50.398       50.398 
    coh558:k=56.2748,b=0       51.634        51.634       51.634       51.634        51.634        50.488        50.488        50.488        50.488        50.488        50.488       50.488 
    coh559:k=56.375,b=0        51.726        51.726       51.726       51.726        51.726        51.726        50.578        50.578        50.578        50.578        50.578       50.578 
    coh560:k=56.4753,b=0       51.818        51.818       51.818       51.818        51.818        51.818        50.668        50.668        50.668        50.668        50.668       50.668 
    coh561:k=56.5755,b=0        51.91         51.91        51.91        51.91         51.91         51.91        50.757        50.757        50.757        50.757        50.757       50.757 
    coh562:k=56.6757,b=0       52.002        52.002       52.002       52.002        52.002        52.002        50.847        50.847        50.847        50.847        50.847       50.847 
    coh563:k=56.776,b=0        52.094        52.094       52.094       52.094        52.094        52.094        50.937        50.937        50.937        50.937        50.937       50.937 
    coh564:k=56.8762,b=0       52.186        52.186       52.186       52.186        52.186        52.186        51.027        51.027        51.027        51.027        51.027       51.027 
    coh565:k=56.9764,b=0       52.278        52.278       52.278       52.278        52.278        52.278        51.117        51.117        51.117        51.117        51.117       51.117 
    coh566:k=57.0767,b=0        52.37         52.37        52.37        52.37         52.37         52.37        51.207        51.207        51.207        51.207        51.207       51.207 
    coh567:k=57.1769,b=0       52.462        52.462       52.462       52.462        52.462        52.462        51.297        51.297        51.297        51.297        51.297       51.297 
    coh568:k=57.2771,b=0       52.554        52.554       52.554       52.554        52.554        52.554        51.387        51.387        51.387        51.387        51.387       51.387 

</pre><img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_02.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_03.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_04.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_08.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_09.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_10.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_11.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_12.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_13.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_14.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_15.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_vf_vec_16.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 11
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function result_map = ff_ipwkz_vf_vec(varargin)
%% FF_IPWKZ_VF_VEC solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the two step solution
% with interpolation and with percentage asset grids version of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vec.html
% ff_iwkz_vf_vec>. See that file for more descriptions. 
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables. 
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ff_ipwkz_evf.m ff_ipwkz_evf>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_set_default_param.m ffs_ipwkz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_get_funcgrid.m ffs_ipwkz_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%


%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
bl_input_override = true;
[param_map, support_map] = ffs_ipwkz_set_default_param(it_param_set);

% parameters can be set inside ffs_ipwkz_set_default_param or updated here
% param_map('it_w_perc_n') = 50;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');        
% param_map('it_z_n') = 15;
% param_map('fl_coh_interp_grid_gap') = 0.025;
% param_map('it_c_interp_grid_gap') = 0.001;
% param_map('fl_w_interp_grid_gap') = 0.25;

% get armt and func map
[armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_ipwkz_vf_vec';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2

% armt_map
params_group = values(armt_map, {'ar_w_perc', 'ar_w_level', 'ar_z'});
[ar_w_perc, ar_w_level, ar_z] = params_group{:};
params_group = values(armt_map, {'ar_interp_c_grid', 'ar_interp_coh_grid', ...
    'mt_interp_coh_grid_mesh_z', 'mt_z_mesh_coh_interp_grid',...
    'mt_w_by_interp_coh_interp_grid'});
[ar_interp_c_grid, ar_interp_coh_grid, ...
    mt_interp_coh_grid_mesh_z, mt_z_mesh_coh_interp_grid, ...
    mt_w_by_interp_coh_interp_grid] = params_group{:};
params_group = values(armt_map, {'mt_coh_wkb', 'mt_z_mesh_coh_wkb'});
[mt_coh_wkb, mt_z_mesh_coh_wkb] = params_group{:};

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};

% param_map
params_group = values(param_map, {'fl_r_save', 'fl_r_borr', 'fl_w',...
    'it_z_n', 'fl_crra', 'fl_beta', 'fl_c_min'});
[fl_r_save, fl_r_borr, fl_wage, it_z_n, fl_crra, fl_beta, fl_c_min] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display, it_display_every, bl_post] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),length(ar_z));
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),length(ar_z));

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Pre-calculate u(c)
% Interpolation, see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why interpolate over u(c)

% Evaluate
if (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_neg_c = f_util_log(fl_c_min);
else
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_neg_c = f_util_crra(fl_c_min);
end
ar_interp_u_of_c_grid(ar_interp_c_grid <= fl_c_min) = fl_u_neg_c;

% Get Interpolant
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, 'spline');

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;
    
    
    %% Interpolate (1) reacahble v(coh(k(w,z),b(w,z),z),z) given v(coh, z)
    % v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see
    % ffs_ipwkz_get_funcgrid.m. Generate interpolant based on that, Then
    % interpolate for the coh reachable levels given the k(w,z) percentage
    % choice grids in the second stage of the problem

    % Generate Interpolant for v(coh,z)
    f_grid_interpolant_value = griddedInterpolant(...
        mt_z_mesh_coh_interp_grid', mt_interp_coh_grid_mesh_z', mt_val_cur', 'linear');
    
    % Interpoalte for v(coh(k(w,z),b(w,z),z),z)
    mt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb);
    
    %% Solve Second Stage Problem k*(w,z)
    % This is the key difference between this function and
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
    % ffs_akz_set_functions> which solves the two stages jointly    
    % Interpolation first, because solution coh grid is not the same as all
    % points reachable by k and b choices given w. 
            
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = ...
        ff_ipwkz_evf(mt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);       
    
    %% Solve First Stage Problem w*(z) given k*(w,z)
       
    % loop 1: over exogenous states
    for it_z_i = 1:length(ar_z)

        % State Array fixed        
        ar_coh_z = mt_interp_coh_grid_mesh_z(:,it_z_i);

        % Get 2nd Stage Arrays
        ar_ev_condi_z_max_z = mt_ev_condi_z_max(:, it_z_i);        
        ar_w_level_kstar_z = mt_ev_condi_z_max_kp(:, it_z_i);

        % Interpolate (2) k*(ar_w_perc) from k*(ar_w_level,z)
        % There are two w=k'+b' arrays. ar_w_level is the level even grid based
        % on which we solve the 2nd stage problem in ff_ipwkz_evf.m. Here for
        % each coh level, we have a different vector of w levels, but the same
        % vector of percentage ws. So we need to interpolate to get the optimal
        % k* and b* choices at each percentage level of w. 
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, ar_w_level_kstar_z', 'linear');
        
        % Interpolant for (3) EV(k*(ar_w_perc),Z)
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, ar_ev_condi_z_max_z', 'linear');
        
        % Interpolat (2) and (3) 
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_by_interp_coh_interp_grid);
        mt_w_astar_interp_z = mt_w_by_interp_coh_interp_grid - mt_w_kstar_interp_z;
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_by_interp_coh_interp_grid);
        
        % Consumption
        % Note that compared to
        % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
        % ffs_akz_set_functions> the mt_c here is much smaller the same
        % number of columns (states) as in the ffs_akz_set_functions file,
        % but the number of rows equal to ar_w length.
        mt_c = f_cons(ar_coh_z', mt_w_astar_interp_z, mt_w_kstar_interp_z);
        
        % Interpolate for (4) EVAL current utility: N by N, f_util defined earlier
        mt_utility = f_grid_interpolant_spln(mt_c);
                
        % EVAL add on future utility, N by N + N by N
        % previously mt_ev_condi_z_max_interp_z was N by 1, not N by N
        mt_utility = mt_utility + fl_beta*mt_ev_condi_z_max_interp_z;

        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        [ar_opti_val1_z, ar_opti_idx_z] = max(mt_utility);
        mt_val(:,it_z_i) = ar_opti_val1_z;
        
        % Generate Linear Opti Index
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        % Store Optimal
        mt_pol_a(:,it_z_i) = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        mt_pol_k(:,it_z_i) = mt_w_kstar_interp_z(ar_opti_linear_idx_z);        
        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        end

    end
    
    %% Check Tolerance and Continuation
    
    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));    
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);
    
    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;
    
    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
                                      mean(mt_pol_a_cur,1); ...
                                      mean(mt_pol_k_cur,1); ...
                                      mt_val_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_a_cur(length(ar_interp_coh_grid),:); ...
                                      mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(it_ameshk_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice')
        disp('mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice')                
        disp(tb_valpol_iter);
    end
    
    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;        
    end
    
end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_a') = mt_pol_a;
result_map('mt_pol_k') = mt_pol_k;

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
    
    % graphing based on coh_wkb, but that does not match optimal choice
    % matrixes for graphs. 
    armt_map('mt_coh_wkb') = mt_interp_coh_grid_mesh_z;
    armt_map('it_ameshk_n') = length(ar_interp_coh_grid);
    armt_map('ar_a_meshk') = mt_interp_coh_grid_mesh_z(:,1);
    armt_map('ar_k_mesha') = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);
    
    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>