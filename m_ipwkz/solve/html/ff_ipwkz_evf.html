
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>2nd Stage Optimization for Risky + Safe Asset (Saving Only) Interpolated-Percentage</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-08-04"><meta name="DC.source" content="ff_ipwkz_evf.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>2nd Stage Optimization for Risky + Safe Asset (Saving Only) Interpolated-Percentage</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKZ_EVF solves the k' vs b' problem given aggregate savings</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters</a></li><li><a href="#5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></a></li><li><a href="#6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</a></li><li><a href="#7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</a></li><li><a href="#8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</a></li><li><a href="#9">Graph</a></li><li><a href="#11">Graph 1, V and EV</a></li><li><a href="#12">Graph 2, max(EV)</a></li><li><a href="#13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</a></li><li><a href="#14">Graph 4, Optimal K' and B' Levels</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkz_evf(varargin)
</pre><h2 id="2">FF_IPWKZ_EVF solves the k' vs b' problem given aggregate savings</h2><p>This function follows the structure set up here: <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html">ff_wkz_evf</a> but now we solve the second stage with percentage choice grid</p><p>We solve along a vector of w_n vector, that is an interpolation vector, not a vector of actual w choices picked in the first stage. k' choices are in terms of percentages. Compared to ff_wkz_evf where we only had an upper triangle of choices, now we have a full matrix of percentage choices.</p><p>@param mt_val matrix state_n I^2 by shock_n. This is the value matrix each row is a feasible reachable state given the choice vectors/matrix and each column is a shock state.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@return mt_ev_condi_z_max matrix choice_w_n by shock_n max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the optimal k' choice (w=k'+b') what is the expected utility? This is the value result from the 2nd stage problem. Note the result integrates over z'.</p><p>@return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k' choices, which index maximized conditional on z and w integrating over z'/</p><p>@return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k' choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</p><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_set_default_param.m">ffs_ipwkz_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_get_funcgrid.m">ffs_ipwkz_get_funcgrid</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))
    <span class="comment">% override when called from outside</span>
    [mt_val, param_map, support_map, armt_map] = varargin{:};
<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% Not default parameters, but parameters that generate defaults</span>
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkz_set_default_param(it_param_set);

    support_map(<span class="string">'bl_graph_evf'</span>) = true;
    support_map(<span class="string">'bl_display_evf'</span>) = true;

    param_map(<span class="string">'it_ak_perc_n'</span>) = 250;
    param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = (param_map(<span class="string">'fl_w_max'</span>)-param_map(<span class="string">'fl_b_bd'</span>))/param_map(<span class="string">'it_ak_perc_n'</span>);

    [armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generating Defaults</span>
    params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_z'</span>});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {<span class="string">'f_util_standin'</span>});
    [f_util_standin] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameters</h2><pre class="codeinput">params_group = values(armt_map, {<span class="string">'mt_z_trans'</span>, <span class="string">'ar_z'</span>,<span class="keyword">...</span>
    <span class="string">'ar_w_level'</span>, <span class="string">'ar_k_mesha'</span>, <span class="string">'ar_a_meshk'</span>, <span class="string">'mt_k'</span>});
[mt_z_trans, ar_z, ar_w_level, <span class="keyword">...</span>
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_nan_replace'</span>, <span class="string">'fl_b_bd'</span>});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph_onebyones'</span>,<span class="string">'bl_display_evf'</span>, <span class="string">'bl_graph_evf'</span>});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_img_save'</span>, <span class="string">'st_img_path'</span>, <span class="string">'st_img_prefix'</span>, <span class="string">'st_img_name_main'</span>, <span class="string">'st_img_suffix'</span>});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkz_evf'</span>;
st_img_name_main = [st_func_name st_img_name_main];
</pre><h2 id="5">Integrate <b>E(V(coh(k',b'), z')|z, w)</b></h2><p>Each column for a different state z, each value <b>E(V(coh,z')|z)</b> integrated already Here, each column is a current z, more to right higher EV dim(mt_ev_condi_z): <b>Q by M</b> Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be what we do in the <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_set_functions.html">ffs_ipwkz_set_functions</a> code where we loop over current z, and for each current z, grab out a particular row from the mt_z_trans that corresponds to a current shock's transition into all future states.</p><p>here, each column of mt_val corresponds to a state z, think of that as future state z. The input mt_val is <b>V(coh, z)</b>, we need to integrate to get <b>E(V(coh,z')|z)</b>.</p><pre class="codeinput">mt_ev_condi_z = mt_val*mt_z_trans';
<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z: Q by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z: Q by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
       62500          15

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    
       -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272          -0.81272           -0.81272           -0.81272           -0.81272           -0.81272           -0.81272    

    mt_ev_condi_z1    mt_ev_condi_z2    mt_ev_condi_z3    mt_ev_condi_z4    mt_ev_condi_z5    mt_ev_condi_z6    mt_ev_condi_z7    mt_ev_condi_z8    mt_ev_condi_z9    mt_ev_condi_z10    mt_ev_condi_z11    mt_ev_condi_z12    mt_ev_condi_z13    mt_ev_condi_z14    mt_ev_condi_z15
    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________

        3.8834            3.8874             3.892            3.8973            3.9033            3.9099            3.9172            3.9254            3.9345            3.9446             3.9557             3.9681             3.9816             3.9961             4.0106     
         3.883             3.887            3.8917             3.897            3.9029            3.9095            3.9169            3.9251            3.9342            3.9443             3.9555             3.9679             3.9814             3.9959             4.0104     
        3.8826            3.8866            3.8913            3.8966            3.9026            3.9092            3.9166            3.9248            3.9339             3.944             3.9552             3.9676             3.9812             3.9957             4.0103     
        3.8822            3.8863             3.891            3.8963            3.9023            3.9089            3.9163            3.9245            3.9336            3.9438              3.955             3.9674              3.981             3.9955             4.0101     
        3.8819            3.8859            3.8906            3.8959            3.9019            3.9086             3.916            3.9242            3.9334            3.9435             3.9548             3.9672             3.9808             3.9954               4.01     
        3.8815            3.8855            3.8902            3.8956            3.9016            3.9082            3.9157            3.9239            3.9331            3.9432             3.9545              3.967             3.9806             3.9952             4.0098     
        3.8811            3.8851            3.8899            3.8952            3.9012            3.9079            3.9153            3.9236            3.9328             3.943             3.9543             3.9668             3.9804              3.995             4.0097     
        3.8807            3.8848            3.8895            3.8949            3.9009            3.9076             3.915            3.9233            3.9325            3.9427              3.954             3.9665             3.9802             3.9949             4.0095     
        3.8804            3.8844            3.8892            3.8945            3.9005            3.9072            3.9147             3.923            3.9322            3.9424             3.9538             3.9663               3.98             3.9947             4.0094     
          3.88             3.884            3.8888            3.8942            3.9002            3.9069            3.9144            3.9227            3.9319            3.9422             3.9535             3.9661             3.9798             3.9945             4.0092     
        3.8796            3.8837            3.8884            3.8938            3.8999            3.9066            3.9141            3.9224            3.9316            3.9419             3.9533             3.9659             3.9796             3.9943             4.0091     
        3.8792            3.8833            3.8881            3.8935            3.8995            3.9063            3.9138            3.9221            3.9314            3.9416              3.953             3.9656             3.9794             3.9941             4.0089     
        3.8788            3.8829            3.8877            3.8931            3.8992            3.9059            3.9134            3.9218            3.9311            3.9414             3.9528             3.9654             3.9792              3.994             4.0088     
        3.8785            3.8825            3.8873            3.8928            3.8988            3.9056            3.9131            3.9215            3.9308            3.9411             3.9525             3.9652              3.979             3.9938             4.0086     
        3.8781            3.8822             3.887            3.8924            3.8985            3.9053            3.9128            3.9212            3.9305            3.9408             3.9523              3.965             3.9788             3.9936             4.0085     
        3.8777            3.8818            3.8866            3.8921            3.8981            3.9049            3.9125            3.9209            3.9302            3.9406              3.952             3.9647             3.9786             3.9934             4.0083     
        3.8773            3.8814            3.8862            3.8917            3.8978            3.9046            3.9122            3.9206            3.9299            3.9403             3.9518             3.9645             3.9784             3.9933             4.0081     
        3.8769             3.881            3.8859            3.8913            3.8975            3.9043            3.9119            3.9203            3.9296              3.94             3.9515             3.9643             3.9782             3.9931              4.008     
        3.8765            3.8807            3.8855             3.891            3.8971            3.9039            3.9115              3.92            3.9294            3.9398             3.9513              3.964              3.978             3.9929             4.0078     
        3.8762            3.8803            3.8851            3.8906            3.8968            3.9036            3.9112            3.9197            3.9291            3.9395              3.951             3.9638             3.9778             3.9927             4.0077     

</pre><h2 id="6">Reshape <b>E(V(coh,z'|z,w))</b> to allow for maxing</h2><p>dim(mt_ev_condi_z): <b>IxJ by M</b></p><pre class="codeinput">[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);
</pre><h2 id="7">Maximize <b>max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))</b> optimal value and index</h2><p>Maximization, find optimal k'/b' combination given z and w=k'+b'</p><pre class="codeinput">[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_full: J by IxM'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_full));
<span class="comment">%     disp(head(array2table(mt_ev_condi_z_full), 20));</span>
<span class="comment">%     disp(tail(array2table(mt_ev_condi_z_full), 20));</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));


    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_full: J by IxM
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
         250        3750

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   250    15

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

         -0.81272              -0.81272              -0.81272              -0.81272              -0.81272              -0.81272              -0.81272              -0.81272              -0.81272              -0.81272               -0.81272               -0.81272               -0.81272               -0.81272               -0.81272      
         -0.13586              -0.10537               -0.0705             -0.032211             0.0091691              0.053609               0.10116               0.15188               0.20581               0.26296                0.32333                0.38682                0.45299                0.52035                0.58524      
           0.1196               0.14992               0.18459               0.22267               0.26384               0.30806               0.35539               0.40588               0.45957               0.51649                0.57663                0.63989                0.70583                0.77298                0.83767      
          0.30837               0.33746               0.37075               0.40738               0.44702               0.48968                0.5354               0.58425                0.6363               0.69156                0.75004                0.81165                0.87598                0.94157                 1.0048      
          0.46102               0.48875               0.52054               0.55555               0.59351               0.63443               0.67836               0.72539               0.77558               0.82897                0.88558                0.94532                 1.0078                 1.0716                 1.1333      
          0.59015               0.61659               0.64694               0.68041               0.71677               0.75601               0.79822               0.84349               0.89188               0.94345                0.99822                 1.0561                 1.1168                 1.1789                  1.239      
          0.70247               0.72773               0.75677               0.78883                0.8237                0.8614               0.90201               0.94564               0.99235                1.0422                 1.0953                 1.1515                 1.2104                 1.2709                 1.3294      
          0.80209               0.82629               0.85413               0.88491               0.91843               0.95471               0.99386                 1.036                1.0811                1.1294                 1.1809                 1.2355                 1.2928                 1.3517                 1.4088      
          0.89172               0.91496               0.94171               0.97133                1.0036                1.0386                1.0764                1.1171                1.1609                1.2077                 1.2577                 1.3108                 1.3667                 1.4241                 1.4798      
          0.97327               0.99563                1.0214                  1.05                1.0811                1.1149                1.1515                 1.191                1.2334                1.2789                 1.3275                 1.3792                 1.4337                 1.4898                 1.5442      
           1.0482                1.0697                1.0946                1.1222                1.1523                 1.185                1.2205                1.2588                   1.3                1.3442                 1.3916                  1.442                 1.4952                   1.55                 1.6033      
           1.1179                1.1382                1.1622                1.1889                1.2181                1.2499                1.2843                1.3215                1.3616                1.4047                 1.4508                    1.5                  1.552                 1.6057                 1.6579      
           1.1831                1.2021                1.2252                1.2511                1.2794                1.3103                1.3437                1.3799                 1.419                 1.461                  1.506                 1.5541                  1.605                 1.6575                 1.7086      
           1.2443                1.2622                1.2841                1.3093                1.3368                1.3668                1.3993                1.4346                1.4727                1.5137                 1.5577                 1.6047                 1.6546                  1.706                 1.7562      
           1.3019                1.3188                1.3396                1.3639                1.3907                1.4199                1.4516                 1.486                1.5232                1.5633                 1.6063                 1.6524                 1.7012                 1.7516                 1.8009      
           1.3564                1.3724                1.3922                1.4155                1.4416                1.4701                 1.501                1.5346                1.5709                1.6101                 1.6522                 1.6974                 1.7452                 1.7948                 1.8431      
           1.4081                1.4233                1.4421                1.4643                1.4898                1.5176                1.5478                1.5806                1.6161                1.6545                 1.6958                   1.74                  1.787                 1.8356                 1.8832      
           1.4572                1.4717                1.4896                1.5109                1.5355                1.5627                1.5922                1.6243                1.6591                1.6967                 1.7372                 1.7806                 1.8267                 1.8745                 1.9213      
            1.504                1.5179                 1.535                1.5553                1.5791                1.6057                1.6346                 1.666                1.7001                1.7369                 1.7766                 1.8192                 1.8646                 1.9116                 1.9576      
           1.5488                 1.562                1.5784                1.5979                1.6208                1.6467                 1.675                1.7058                1.7392                1.7753                 1.8143                 1.8562                 1.9008                  1.947                 1.9923      

    mt_ev_condi_z_max1    mt_ev_condi_z_max2    mt_ev_condi_z_max3    mt_ev_condi_z_max4    mt_ev_condi_z_max5    mt_ev_condi_z_max6    mt_ev_condi_z_max7    mt_ev_condi_z_max8    mt_ev_condi_z_max9    mt_ev_condi_z_max10    mt_ev_condi_z_max11    mt_ev_condi_z_max12    mt_ev_condi_z_max13    mt_ev_condi_z_max14    mt_ev_condi_z_max15
    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    __________________    ___________________    ___________________    ___________________    ___________________    ___________________    ___________________

           3.874                3.8753                 3.877                 3.879                3.8814                3.8842                3.8876                3.8916                3.8964                3.9021                 3.9089                 3.9169                 3.9263                  3.937                 3.9485       
          3.8783                3.8796                3.8812                3.8832                3.8856                3.8884                3.8918                3.8958                3.9006                3.9063                  3.913                  3.921                 3.9304                  3.941                 3.9524       
          3.8825                3.8838                3.8855                3.8874                3.8898                3.8926                 3.896                   3.9                3.9048                3.9104                 3.9171                 3.9251                 3.9344                  3.945                 3.9564       
          3.8868                3.8881                3.8897                3.8917                 3.894                3.8968                3.9002                3.9042                3.9089                3.9145                 3.9212                 3.9291                 3.9384                  3.949                 3.9603       
           3.891                3.8923                3.8939                3.8959                3.8982                 3.901                3.9043                3.9083                 3.913                3.9186                 3.9253                 3.9332                 3.9424                  3.953                 3.9642       
          3.8952                3.8965                3.8981                   3.9                3.9024                3.9051                3.9085                3.9124                3.9171                3.9227                 3.9293                 3.9372                 3.9464                 3.9569                 3.9681       
          3.8994                3.9006                3.9022                3.9042                3.9065                3.9093                3.9126                3.9165                3.9212                3.9268                 3.9334                 3.9412                 3.9504                 3.9608                  3.972       
          3.9035                3.9048                3.9064                3.9083                3.9106                3.9134                3.9167                3.9206                3.9253                3.9308                 3.9374                 3.9452                 3.9543                 3.9648                 3.9759       
          3.9077                3.9089                3.9105                3.9124                3.9148                3.9175                3.9208                3.9247                3.9293                3.9349                 3.9414                 3.9492                 3.9583                 3.9686                 3.9797       
          3.9118                 3.913                3.9146                3.9166                3.9188                3.9216                3.9249                3.9287                3.9334                3.9389                 3.9454                 3.9531                 3.9622                 3.9725                 3.9836       
          3.9159                3.9172                3.9187                3.9206                3.9229                3.9257                3.9289                3.9328                3.9374                3.9429                 3.9494                 3.9571                 3.9661                 3.9764                 3.9874       
            3.92                3.9212                3.9228                3.9247                 3.927                3.9297                 3.933                3.9368                3.9414                3.9469                 3.9533                  3.961                   3.97                 3.9803                 3.9912       
          3.9241                3.9253                3.9269                3.9288                 3.931                3.9337                 3.937                3.9408                3.9454                3.9508                 3.9573                 3.9649                 3.9739                 3.9841                  3.995       
          3.9281                3.9294                3.9309                3.9328                3.9351                3.9378                 3.941                3.9448                3.9494                3.9548                 3.9612                 3.9688                 3.9777                 3.9879                 3.9988       
          3.9322                3.9334                 3.935                3.9368                3.9391                3.9418                 3.945                3.9488                3.9533                3.9587                 3.9651                 3.9727                 3.9816                 3.9917                 4.0025       
          3.9362                3.9374                 3.939                3.9408                3.9431                3.9458                3.9489                3.9527                3.9573                3.9626                  3.969                 3.9766                 3.9854                 3.9955                 4.0063       
          3.9402                3.9414                 3.943                3.9448                3.9471                3.9497                3.9529                3.9567                3.9612                3.9665                 3.9729                 3.9804                 3.9892                 3.9993                   4.01       
          3.9442                3.9454                 3.947                3.9488                 3.951                3.9537                3.9569                3.9606                3.9651                3.9704                 3.9768                 3.9843                  3.993                 4.0031                 4.0138       
          3.9482                3.9494                3.9509                3.9528                 3.955                3.9576                3.9608                3.9645                 3.969                3.9743                 3.9806                 3.9881                 3.9968                 4.0068                 4.0175       
          3.9521                3.9533                3.9549                3.9567                3.9589                3.9616                3.9647                3.9684                3.9729                3.9782                 3.9844                 3.9919                 4.0006                 4.0106                 4.0212       

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   250    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

               1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1                          1          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             250                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             233                       250                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             212                       249                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             195                       229                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             180                       211                       250                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             167                       196                       233                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             156                       184                       218                       250                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             146                       172                       205                       244                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             138                       162                       193                       230                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             130                       153                       182                       217                       250                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          
             123                       145                       173                       206                       245                       250                       250                       250                       250                        250                        250                        250                        250                        250                        250          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

              11                        13                        15                        18                        21                        25                        30                        36                        42                        51                         60                         72                         86                         101                        118          
              11                        13                        15                        18                        21                        25                        30                        36                        42                        50                         60                         72                         85                         101                        118          
              11                        13                        15                        18                        21                        25                        30                        35                        42                        50                         60                         71                         85                         100                        117          
              11                        13                        15                        18                        21                        25                        30                        35                        42                        50                         60                         71                         84                         100                        117          
              11                        13                        15                        18                        21                        25                        29                        35                        42                        50                         59                         71                         84                         100                        116          
              11                        13                        15                        18                        21                        25                        29                        35                        42                        50                         59                         70                         84                          99                        116          
              11                        12                        15                        17                        21                        25                        29                        35                        41                        49                         59                         70                         83                          99                        115          
              11                        12                        15                        17                        21                        24                        29                        35                        41                        49                         59                         70                         83                          98                        115          
              11                        12                        15                        17                        21                        24                        29                        34                        41                        49                         58                         69                         83                          98                        114          
              11                        12                        15                        17                        20                        24                        29                        34                        41                        49                         58                         69                         82                          97                        114          
              11                        12                        14                        17                        20                        24                        29                        34                        41                        49                         58                         69                         82                          97                        113          
              10                        12                        14                        17                        20                        24                        29                        34                        41                        48                         58                         69                         82                          97                        113          
              10                        12                        14                        17                        20                        24                        29                        34                        40                        48                         57                         68                         81                          96                        112          
              10                        12                        14                        17                        20                        24                        28                        34                        40                        48                         57                         68                         81                          96                        112          
              10                        12                        14                        17                        20                        24                        28                        34                        40                        48                         57                         68                         81                          96                        112          
              10                        12                        14                        17                        20                        24                        28                        34                        40                        48                         57                         68                         80                          95                        111          
              10                        12                        14                        17                        20                        24                        28                        33                        40                        47                         56                         67                         80                          95                        111          
              10                        12                        14                        17                        20                        24                        28                        33                        40                        47                         56                         67                         80                          94                        110          
              10                        12                        14                        17                        20                        23                        28                        33                        39                        47                         56                         67                         79                          94                        110          
              10                        12                        14                        17                        20                        23                        28                        33                        39                        47                         56                         66                         79                          94                        109          

</pre><h2 id="8">Reindex K' and B' Choices for each State at the Optimal <b>w'=k'+b'</b> choice</h2><p>The K' and B' Optimal Choices Associated with EV opti dim(mt_ev_condi_z_max_kp): <b>I by M</b></p><pre class="codeinput">ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_idx: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
<span class="keyword">end</span>

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

<span class="keyword">if</span>(bl_display_evf)
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_kp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_ev_condi_z_max_bp: I by M'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_idx: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   250    15

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

                1                         1                         1                         1                         1                         1                         1                         1                         1                         1                          1                          1                          1                          1                          1          
              500                       500                       500                       500                       500                       500                       500                       500                       500                       500                        500                        500                        500                        500                        500          
              750                       750                       750                       750                       750                       750                       750                       750                       750                       750                        750                        750                        750                        750                        750          
             1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                      1000                       1000                       1000                       1000                       1000                       1000          
             1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                      1250                       1250                       1250                       1250                       1250                       1250          
             1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                      1500                       1500                       1500                       1500                       1500                       1500          
             1750                      1750                      1750                      1750                      1750                      1750                      1750                      1750                      1750                      1750                       1750                       1750                       1750                       1750                       1750          
             2000                      2000                      2000                      2000                      2000                      2000                      2000                      2000                      2000                      2000                       2000                       2000                       2000                       2000                       2000          
             2250                      2250                      2250                      2250                      2250                      2250                      2250                      2250                      2250                      2250                       2250                       2250                       2250                       2250                       2250          
             2500                      2500                      2500                      2500                      2500                      2500                      2500                      2500                      2500                      2500                       2500                       2500                       2500                       2500                       2500          
             2733                      2750                      2750                      2750                      2750                      2750                      2750                      2750                      2750                      2750                       2750                       2750                       2750                       2750                       2750          
             2962                      2999                      3000                      3000                      3000                      3000                      3000                      3000                      3000                      3000                       3000                       3000                       3000                       3000                       3000          
             3195                      3229                      3250                      3250                      3250                      3250                      3250                      3250                      3250                      3250                       3250                       3250                       3250                       3250                       3250          
             3430                      3461                      3500                      3500                      3500                      3500                      3500                      3500                      3500                      3500                       3500                       3500                       3500                       3500                       3500          
             3667                      3696                      3733                      3750                      3750                      3750                      3750                      3750                      3750                      3750                       3750                       3750                       3750                       3750                       3750          
             3906                      3934                      3968                      4000                      4000                      4000                      4000                      4000                      4000                      4000                       4000                       4000                       4000                       4000                       4000          
             4146                      4172                      4205                      4244                      4250                      4250                      4250                      4250                      4250                      4250                       4250                       4250                       4250                       4250                       4250          
             4388                      4412                      4443                      4480                      4500                      4500                      4500                      4500                      4500                      4500                       4500                       4500                       4500                       4500                       4500          
             4630                      4653                      4682                      4717                      4750                      4750                      4750                      4750                      4750                      4750                       4750                       4750                       4750                       4750                       4750          
             4873                      4895                      4923                      4956                      4995                      5000                      5000                      5000                      5000                      5000                       5000                       5000                       5000                       5000                       5000          

    mt_ev_condi_z_max_idx1    mt_ev_condi_z_max_idx2    mt_ev_condi_z_max_idx3    mt_ev_condi_z_max_idx4    mt_ev_condi_z_max_idx5    mt_ev_condi_z_max_idx6    mt_ev_condi_z_max_idx7    mt_ev_condi_z_max_idx8    mt_ev_condi_z_max_idx9    mt_ev_condi_z_max_idx10    mt_ev_condi_z_max_idx11    mt_ev_condi_z_max_idx12    mt_ev_condi_z_max_idx13    mt_ev_condi_z_max_idx14    mt_ev_condi_z_max_idx15
    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________    _______________________    _______________________    _______________________    _______________________    _______________________    _______________________

            57511                     57513                     57515                     57518                     57521                     57525                     57530                     57536                     57542                      57551                      57560                      57572                      57586                      57601                      57618         
            57761                     57763                     57765                     57768                     57771                     57775                     57780                     57786                     57792                      57800                      57810                      57822                      57835                      57851                      57868         
            58011                     58013                     58015                     58018                     58021                     58025                     58030                     58035                     58042                      58050                      58060                      58071                      58085                      58100                      58117         
            58261                     58263                     58265                     58268                     58271                     58275                     58280                     58285                     58292                      58300                      58310                      58321                      58334                      58350                      58367         
            58511                     58513                     58515                     58518                     58521                     58525                     58529                     58535                     58542                      58550                      58559                      58571                      58584                      58600                      58616         
            58761                     58763                     58765                     58768                     58771                     58775                     58779                     58785                     58792                      58800                      58809                      58820                      58834                      58849                      58866         
            59011                     59012                     59015                     59017                     59021                     59025                     59029                     59035                     59041                      59049                      59059                      59070                      59083                      59099                      59115         
            59261                     59262                     59265                     59267                     59271                     59274                     59279                     59285                     59291                      59299                      59309                      59320                      59333                      59348                      59365         
            59511                     59512                     59515                     59517                     59521                     59524                     59529                     59534                     59541                      59549                      59558                      59569                      59583                      59598                      59614         
            59761                     59762                     59765                     59767                     59770                     59774                     59779                     59784                     59791                      59799                      59808                      59819                      59832                      59847                      59864         
            60011                     60012                     60014                     60017                     60020                     60024                     60029                     60034                     60041                      60049                      60058                      60069                      60082                      60097                      60113         
            60260                     60262                     60264                     60267                     60270                     60274                     60279                     60284                     60291                      60298                      60308                      60319                      60332                      60347                      60363         
            60510                     60512                     60514                     60517                     60520                     60524                     60529                     60534                     60540                      60548                      60557                      60568                      60581                      60596                      60612         
            60760                     60762                     60764                     60767                     60770                     60774                     60778                     60784                     60790                      60798                      60807                      60818                      60831                      60846                      60862         
            61010                     61012                     61014                     61017                     61020                     61024                     61028                     61034                     61040                      61048                      61057                      61068                      61081                      61096                      61112         
            61260                     61262                     61264                     61267                     61270                     61274                     61278                     61284                     61290                      61298                      61307                      61318                      61330                      61345                      61361         
            61510                     61512                     61514                     61517                     61520                     61524                     61528                     61533                     61540                      61547                      61556                      61567                      61580                      61595                      61611         
            61760                     61762                     61764                     61767                     61770                     61774                     61778                     61783                     61790                      61797                      61806                      61817                      61830                      61844                      61860         
            62010                     62012                     62014                     62017                     62020                     62023                     62028                     62033                     62039                      62047                      62056                      62067                      62079                      62094                      62110         
            62260                     62262                     62264                     62267                     62270                     62273                     62278                     62283                     62289                      62297                      62306                      62316                      62329                      62344                      62359         

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_kp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   250    15

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

                 0                        0                        0                        0                        0                        0                        0                        0                        0                        0                         0                         0                         0                         0                         0        
            0.2006                   0.2006                   0.2006                   0.2006                   0.2006                   0.2006                   0.2006                   0.2006                   0.2006                   0.2006                    0.2006                    0.2006                    0.2006                    0.2006                    0.2006        
            0.4012                   0.4012                   0.4012                   0.4012                   0.4012                   0.4012                   0.4012                   0.4012                   0.4012                   0.4012                    0.4012                    0.4012                    0.4012                    0.4012                    0.4012        
           0.60181                  0.60181                  0.60181                  0.60181                  0.60181                  0.60181                  0.60181                  0.60181                  0.60181                  0.60181                   0.60181                   0.60181                   0.60181                   0.60181                   0.60181        
           0.80241                  0.80241                  0.80241                  0.80241                  0.80241                  0.80241                  0.80241                  0.80241                  0.80241                  0.80241                   0.80241                   0.80241                   0.80241                   0.80241                   0.80241        
             1.003                    1.003                    1.003                    1.003                    1.003                    1.003                    1.003                    1.003                    1.003                    1.003                     1.003                     1.003                     1.003                     1.003                     1.003        
            1.2036                   1.2036                   1.2036                   1.2036                   1.2036                   1.2036                   1.2036                   1.2036                   1.2036                   1.2036                    1.2036                    1.2036                    1.2036                    1.2036                    1.2036        
            1.4042                   1.4042                   1.4042                   1.4042                   1.4042                   1.4042                   1.4042                   1.4042                   1.4042                   1.4042                    1.4042                    1.4042                    1.4042                    1.4042                    1.4042        
            1.6048                   1.6048                   1.6048                   1.6048                   1.6048                   1.6048                   1.6048                   1.6048                   1.6048                   1.6048                    1.6048                    1.6048                    1.6048                    1.6048                    1.6048        
            1.8054                   1.8054                   1.8054                   1.8054                   1.8054                   1.8054                   1.8054                   1.8054                   1.8054                   1.8054                    1.8054                    1.8054                    1.8054                    1.8054                    1.8054        
            1.8692                    2.006                    2.006                    2.006                    2.006                    2.006                    2.006                    2.006                    2.006                    2.006                     2.006                     2.006                     2.006                     2.006                     2.006        
            1.8702                   2.1978                   2.2066                   2.2066                   2.2066                   2.2066                   2.2066                   2.2066                   2.2066                   2.2066                    2.2066                    2.2066                    2.2066                    2.2066                    2.2066        
             1.876                   2.2044                   2.4072                   2.4072                   2.4072                   2.4072                   2.4072                   2.4072                   2.4072                   2.4072                    2.4072                    2.4072                    2.4072                    2.4072                    2.4072        
            1.8754                   2.1998                   2.6078                   2.6078                   2.6078                   2.6078                   2.6078                   2.6078                   2.6078                   2.6078                    2.6078                    2.6078                    2.6078                    2.6078                    2.6078        
            1.8732                      2.2                   2.6169                   2.8084                   2.8084                   2.8084                   2.8084                   2.8084                   2.8084                   2.8084                    2.8084                    2.8084                    2.8084                    2.8084                    2.8084        
            1.8742                   2.2123                   2.6227                    3.009                    3.009                    3.009                    3.009                    3.009                    3.009                    3.009                     3.009                     3.009                     3.009                     3.009                     3.009        
            1.8704                   2.2052                   2.6302                   3.1324                   3.2096                   3.2096                   3.2096                   3.2096                   3.2096                   3.2096                    3.2096                    3.2096                    3.2096                    3.2096                    3.2096        
            1.8779                   2.2062                   2.6304                   3.1366                   3.4102                   3.4102                   3.4102                   3.4102                   3.4102                   3.4102                    3.4102                    3.4102                    3.4102                    3.4102                    3.4102        
            1.8724                   2.2056                   2.6257                   3.1328                   3.6108                   3.6108                   3.6108                   3.6108                   3.6108                   3.6108                    3.6108                    3.6108                    3.6108                    3.6108                    3.6108        
            1.8694                   2.2058                    2.634                   3.1386                    3.735                   3.8114                   3.8114                   3.8114                   3.8114                   3.8114                    3.8114                    3.8114                    3.8114                    3.8114                    3.8114        

    mt_ev_condi_z_max_kp1    mt_ev_condi_z_max_kp2    mt_ev_condi_z_max_kp3    mt_ev_condi_z_max_kp4    mt_ev_condi_z_max_kp5    mt_ev_condi_z_max_kp6    mt_ev_condi_z_max_kp7    mt_ev_condi_z_max_kp8    mt_ev_condi_z_max_kp9    mt_ev_condi_z_max_kp10    mt_ev_condi_z_max_kp11    mt_ev_condi_z_max_kp12    mt_ev_condi_z_max_kp13    mt_ev_condi_z_max_kp14    mt_ev_condi_z_max_kp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           1.8973                   2.2675                   2.6377                   3.1931                   3.7484                   4.4888                   5.4144                    6.525                   7.6357                    9.3017                    10.968                    13.189                    15.781                    18.557                    21.704        
           1.9055                   2.2774                   2.6492                   3.2069                   3.7647                   4.5083                   5.4379                   6.5534                   7.6689                    9.1562                    11.015                    13.246                    15.663                    18.638                    21.798        
           1.9138                   2.2872                   2.6607                   3.2208                    3.781                   4.5279                   5.4615                   6.3951                   7.7021                    9.1958                    11.063                    13.117                    15.731                    18.532                    21.706        
            1.922                   2.2971                   2.6721                   3.2347                   3.7973                   4.5474                    5.485                   6.4226                   7.7353                    9.2355                    11.111                    13.173                    15.611                    18.612                      21.8        
           1.9303                   2.3069                   2.6836                   3.2486                   3.8136                   4.5669                   5.3202                   6.4502                   7.7685                    9.2751                     10.97                     13.23                    15.678                    18.692                    21.705        
           1.9385                   2.3168                   2.6951                   3.2625                   3.8299                   4.5864                   5.3429                   6.4777                   7.8017                    9.3148                    11.017                    13.097                    15.745                    18.582                    21.798        
           1.9468                   2.1367                   2.7065                   3.0864                   3.8462                   4.6059                   5.3657                   6.5053                   7.6449                    9.1645                    11.064                    13.153                    15.622                    18.661                      21.7        
            1.955                   2.1458                    2.718                   3.0995                   3.8625                   4.4347                   5.3884                   6.5329                   7.6773                    9.2033                    11.111                    13.209                    15.689                     18.55                    21.792        
           1.9633                   2.1548                   2.7295                   3.1126                   3.8788                   4.4534                   5.4111                   6.3689                   7.7097                    9.2421                    10.966                    13.073                    15.755                    18.628                    21.693        
           1.9715                   2.1639                   2.7409                   3.1256                   3.7027                   4.4721                   5.4339                   6.3957                   7.7421                     9.281                    11.012                    13.128                    15.629                    18.514                    21.784        
           1.9798                   2.1729                   2.5592                   3.1387                   3.7182                   4.4908                   5.4566                   6.4224                   7.7745                    9.3198                    11.058                    13.183                    15.694                    18.591                    21.682        
           1.7941                    2.182                   2.5699                   3.1518                   3.7337                   4.5095                   5.4794                   6.4492                   7.8069                    9.1647                    11.104                    13.238                    15.759                    18.669                    21.772        
           1.8015                    2.191                   2.5806                   3.1649                   3.7492                   4.5283                   5.5021                   6.4759                   7.6445                    9.2027                    10.956                    13.098                     15.63                    18.552                    21.668        
           1.8089                   2.2001                   2.5912                    3.178                   3.7647                    4.547                   5.3293                   6.5027                   7.6761                    9.2407                    11.001                    13.152                    15.695                    18.628                    21.757        
           1.8164                   2.2091                   2.6019                    3.191                   3.7802                   4.5657                   5.3512                   6.5295                   7.7077                    9.2787                    11.046                    13.206                    15.759                    18.705                    21.847        
           1.8238                   2.2182                   2.6126                   3.2041                   3.7957                   4.5844                   5.3731                   6.5562                   7.7393                    9.3168                    11.091                     13.26                    15.627                    18.584                    21.739        
           1.8313                   2.2273                   2.6232                   3.2172                   3.8112                   4.6031                   5.3951                    6.385                   7.7709                    9.1568                    10.939                    13.117                     15.69                     18.66                    21.828        
           1.8387                   2.2363                   2.6339                   3.2303                   3.8266                   4.6218                    5.417                   6.4109                   7.8025                     9.194                    10.983                     13.17                    15.754                    18.537                    21.718        
           1.8462                   2.2454                   2.6446                   3.2433                   3.8421                   4.4409                   5.4389                   6.4369                   7.6345                    9.2313                    11.028                    13.223                    15.618                    18.612                    21.806        
           1.8536                   2.2544                   2.6552                   3.2564                   3.8576                   4.4588                   5.4608                   6.4629                   7.6653                    9.2685                    11.072                    13.076                    15.681                    18.687                    21.693        

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_ev_condi_z_max_bp: I by M
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
   250    15

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

                  0                        0                        0                        0                        0                        0                        0                        0                        0                         0                         0                         0                         0                         0                         0      
          0.0002008                0.0002008                0.0002008                0.0002008                0.0002008                0.0002008                0.0002008                0.0002008                0.0002008                 0.0002008                 0.0002008                 0.0002008                 0.0002008                 0.0002008                 0.0002008      
         0.00040161               0.00040161               0.00040161               0.00040161               0.00040161               0.00040161               0.00040161               0.00040161               0.00040161                0.00040161                0.00040161                0.00040161                0.00040161                0.00040161                0.00040161      
         0.00060241               0.00060241               0.00060241               0.00060241               0.00060241               0.00060241               0.00060241               0.00060241               0.00060241                0.00060241                0.00060241                0.00060241                0.00060241                0.00060241                0.00060241      
         0.00080321               0.00080321               0.00080321               0.00080321               0.00080321               0.00080321               0.00080321               0.00080321               0.00080321                0.00080321                0.00080321                0.00080321                0.00080321                0.00080321                0.00080321      
           0.001004                 0.001004                 0.001004                 0.001004                 0.001004                 0.001004                 0.001004                 0.001004                 0.001004                  0.001004                  0.001004                  0.001004                  0.001004                  0.001004                  0.001004      
          0.0012048                0.0012048                0.0012048                0.0012048                0.0012048                0.0012048                0.0012048                0.0012048                0.0012048                 0.0012048                 0.0012048                 0.0012048                 0.0012048                 0.0012048                 0.0012048      
          0.0014056                0.0014056                0.0014056                0.0014056                0.0014056                0.0014056                0.0014056                0.0014056                0.0014056                 0.0014056                 0.0014056                 0.0014056                 0.0014056                 0.0014056                 0.0014056      
          0.0016064                0.0016064                0.0016064                0.0016064                0.0016064                0.0016064                0.0016064                0.0016064                0.0016064                 0.0016064                 0.0016064                 0.0016064                 0.0016064                 0.0016064                 0.0016064      
          0.0018072                0.0018072                0.0018072                0.0018072                0.0018072                0.0018072                0.0018072                0.0018072                0.0018072                 0.0018072                 0.0018072                 0.0018072                 0.0018072                 0.0018072                 0.0018072      
            0.13883                 0.002008                 0.002008                 0.002008                 0.002008                 0.002008                 0.002008                 0.002008                 0.002008                  0.002008                  0.002008                  0.002008                  0.002008                  0.002008                  0.002008      
            0.33863                 0.011062                0.0022088                0.0022088                0.0022088                0.0022088                0.0022088                0.0022088                0.0022088                 0.0022088                 0.0022088                 0.0022088                 0.0022088                 0.0022088                 0.0022088      
            0.53359                  0.20523                0.0024096                0.0024096                0.0024096                0.0024096                0.0024096                0.0024096                0.0024096                 0.0024096                 0.0024096                 0.0024096                 0.0024096                 0.0024096                 0.0024096      
              0.735                  0.41066                0.0026104                0.0026104                0.0026104                0.0026104                0.0026104                0.0026104                0.0026104                 0.0026104                 0.0026104                 0.0026104                 0.0026104                 0.0026104                 0.0026104      
            0.93802                  0.61126                  0.19436                0.0028112                0.0028112                0.0028112                0.0028112                0.0028112                0.0028112                 0.0028112                 0.0028112                 0.0028112                 0.0028112                 0.0028112                 0.0028112      
             1.1378                  0.79979                  0.38933                 0.003012                 0.003012                 0.003012                 0.003012                 0.003012                 0.003012                  0.003012                  0.003012                  0.003012                  0.003012                  0.003012                  0.003012      
             1.3424                   1.0076                  0.58269                 0.080476                0.0032129                0.0032129                0.0032129                0.0032129                0.0032129                 0.0032129                 0.0032129                 0.0032129                 0.0032129                 0.0032129                 0.0032129      
             1.5358                   1.2074                  0.78329                  0.27705                0.0034137                0.0034137                0.0034137                0.0034137                0.0034137                 0.0034137                 0.0034137                 0.0034137                 0.0034137                 0.0034137                 0.0034137      
              1.742                   1.4088                  0.98872                  0.48168                0.0036145                0.0036145                0.0036145                0.0036145                0.0036145                 0.0036145                 0.0036145                 0.0036145                 0.0036145                 0.0036145                 0.0036145      
             1.9459                   1.6094                   1.1813                  0.67665                 0.080274                0.0038153                0.0038153                0.0038153                0.0038153                 0.0038153                 0.0038153                 0.0038153                 0.0038153                 0.0038153                 0.0038153      

    mt_ev_condi_z_max_bp1    mt_ev_condi_z_max_bp2    mt_ev_condi_z_max_bp3    mt_ev_condi_z_max_bp4    mt_ev_condi_z_max_bp5    mt_ev_condi_z_max_bp6    mt_ev_condi_z_max_bp7    mt_ev_condi_z_max_bp8    mt_ev_condi_z_max_bp9    mt_ev_condi_z_max_bp10    mt_ev_condi_z_max_bp11    mt_ev_condi_z_max_bp12    mt_ev_condi_z_max_bp13    mt_ev_condi_z_max_bp14    mt_ev_condi_z_max_bp15
    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    _____________________    ______________________    ______________________    ______________________    ______________________    ______________________    ______________________

           44.287                   43.917                   43.547                   42.992                   42.436                   41.696                    40.77                    39.66                   38.549                    36.883                    35.217                    32.996                    30.404                    27.628                    24.481        
            44.48                   44.108                   43.736                   43.179                   42.621                   41.877                   40.948                   39.832                   38.717                    37.229                     35.37                    33.139                    30.722                    27.748                    24.587        
           44.673                   44.299                   43.926                   43.366                   42.805                   42.058                   41.125                   40.191                   38.884                    37.391                    35.523                    33.469                    30.855                    28.055                     24.88        
           44.865                    44.49                   44.115                   43.552                    42.99                    42.24                   41.302                   40.365                   39.052                    37.552                    35.676                    33.614                    31.176                    28.175                    24.988        
           45.058                   44.681                   44.304                   43.739                   43.174                   42.421                   41.668                   40.538                   39.219                    37.713                    36.018                    33.758                     31.31                    28.296                    25.283        
            45.25                   44.872                   44.494                   43.926                   43.359                   42.602                   41.846                   40.711                   39.387                    37.874                    36.172                    34.091                    31.443                    28.606                    25.391        
           45.443                   45.253                   44.683                   44.303                   43.543                   42.784                   42.024                   40.884                   39.745                    38.225                    36.326                    34.236                    31.767                    28.728                    25.689        
           45.635                   45.445                   44.872                   44.491                   43.728                   43.156                   42.202                   41.057                   39.913                    38.387                     36.48                    34.381                    31.902                    29.041                    25.798        
           45.828                   45.636                   45.062                   44.679                   43.912                   43.338                    42.38                   41.422                   40.081                    38.549                    36.825                    34.718                    32.036                    29.163                    26.098        
            46.02                   45.828                   45.251                   44.866                   44.289                    43.52                   42.558                   41.596                    40.25                    38.711                     36.98                    34.864                    32.363                    29.478                    26.208        
           46.213                    46.02                   45.634                   45.054                   44.475                   43.702                   42.736                    41.77                   40.418                    38.873                    37.135                     35.01                    32.499                    29.601                    26.511        
             46.6                   46.212                   45.824                   45.242                    44.66                   43.884                   42.914                   41.944                   40.587                    39.229                    37.289                    35.156                    32.634                    29.725                    26.621        
           46.793                   46.403                   46.014                   45.429                   44.845                   44.066                   43.092                   42.118                    40.95                    39.392                    37.639                    35.496                    32.964                    30.043                    26.927        
           46.986                   46.595                   46.204                   45.617                   45.031                   44.248                   43.466                   42.292                   41.119                    39.554                    37.794                    35.643                    33.101                    30.167                    27.038        
            47.18                   46.787                   46.394                   45.805                   45.216                    44.43                   43.645                   42.467                   41.288                    39.717                     37.95                     35.79                    33.237                    30.291                    27.149        
           47.373                   46.979                   46.584                   45.993                   45.401                   44.612                   43.824                   42.641                   41.457                     39.88                    38.105                    35.936                     33.57                    30.612                    27.458        
           47.566                    47.17                   46.774                    46.18                   45.586                   44.794                   44.003                   43.013                   41.627                    40.241                    38.459                    36.281                    33.707                    30.737                     27.57        
            47.76                   47.362                   46.964                   46.368                   45.772                   44.977                   44.181                   43.187                   41.796                    40.404                    38.615                    36.429                    33.844                    31.061                     27.88        
           47.953                   47.554                   47.155                   46.556                   45.957                   45.358                    44.36                   43.362                   42.165                    40.568                    38.772                    36.576                    34.181                    31.187                    27.993        
           48.146                   47.746                   47.345                   46.744                   46.142                   45.541                   44.539                   43.537                   42.335                    40.732                    38.928                    36.924                    34.319                    31.313                    28.307        

</pre><h2 id="9">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_evf)
</pre><h2 id="11">Graph 1, V and EV</h2><pre class="codeinput">    <span class="keyword">if</span> (~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
        hold <span class="string">on</span>;
    <span class="keyword">end</span>


    <span class="keyword">for</span> subplot_j=1:1:2

        <span class="keyword">if</span> (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (subplot_j==1)
            chart = plot(mt_val);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        <span class="keyword">end</span>

        clr = jet(numel(chart));
        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>

        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        <span class="keyword">if</span> (subplot_j==1)
            title(<span class="string">'V(coh,zp); w(k+b),k,z'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (subplot_j==2)
            title(<span class="string">'E_z(V(coh,zp|z))'</span>);
        <span class="keyword">end</span>

        ylabel(<span class="string">'Next Period Value'</span>);
        xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span><span class="keyword">...</span>
            <span class="string">'Each Segment is a w=k+b; within segment increasing k'</span><span class="keyword">...</span>
            <span class="string">'EV and V identical if shock is fully persistent'</span>});
        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
    <span class="keyword">end</span>

    <span class="comment">% Share y axis</span>
    <span class="keyword">if</span> (~bl_graph_onebyones)
        linkaxes(hAxis,<span class="string">'y'</span>);
    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_vev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkz_evf_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_evf_02.png" alt=""> <h2 id="12">Graph 2, max(EV)</h2><pre class="codeinput">    <span class="keyword">if</span>(~bl_graph_onebyones)
        figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="keyword">end</span>

    <span class="keyword">for</span> sub_j=1:1:1

        <span class="keyword">if</span>(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = <span class="string">'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span>(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        <span class="keyword">else</span>
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>
        hold <span class="string">on</span>;

        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        <span class="keyword">for</span> i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, <span class="keyword">...</span>
                <span class="string">'MarkerEdgeColor'</span>, clr(i_ctr,:), <span class="keyword">...</span>
                <span class="string">'MarkerFaceColor'</span>, clr(i_ctr,:));
        <span class="keyword">end</span>

        grid <span class="string">on</span>;
        grid <span class="string">minor</span>;
        title([<span class="string">'2nd Stage Exp Value at Optimal K given W=K''+B'''</span>])
        ylabel(st_y_label)
        xlabel({<span class="string">'Aggregate Savings'</span>})

        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));
        legendCell{length(legendCell) + 1} = <span class="string">'max-agg-save'</span>;
        legend(legendCell([ar_it_z_graph length(legendCell)]), <span class="string">'Location'</span>,<span class="string">'southeast'</span>);

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxev'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Ignoring extra legend entries. 
</pre><img vspace="5" hspace="5" src="ff_ipwkz_evf_03.png" alt=""> <h2 id="13">Graph 3, at max(EV) optimal choice category, color regions, borrow save</h2><pre class="codeinput">    <span class="comment">% Borrow Vs Save</span>
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) &gt; 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));

    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    <span class="comment">% States: ar_w, ar_z</span>
    <span class="comment">% Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp</span>
    hold <span class="string">on</span>;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_borr_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'blue'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_br], {'Borrow'}, 'Location','northeast');</span>
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'black'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_khalf], {'Save &gt;0.5 K'}, 'Location','northeast');</span>
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        ar_z_mw(~mt_it_borr_idx &amp; ~mt_it_riskyhalf_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'red'</span>, <span class="string">'filled'</span>);
    <span class="comment">%     legend([chart_sv], {'Save &lt;0.5 K'}, 'Location','northeast');</span>
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),<span class="keyword">...</span>
        it_sca_size, <span class="string">'yellow'</span>, <span class="string">'filled'</span>);
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], <span class="keyword">...</span>
        {<span class="string">'Borrow'</span>,<span class="string">'Save &gt;0.5 K'</span>,<span class="string">'Save &lt;0.5 K'</span>, <span class="string">'k=0 or k=nan'</span>}, <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
    title(<span class="string">'Borrow and Save Regions'</span>)
    ylabel(<span class="string">'Shocks'</span>)
    xlabel({<span class="string">'Total Savings w=k+b'</span>})
    grid <span class="string">on</span>;

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_maxbrsv'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkz_evf_04.png" alt=""> <h2 id="14">Graph 4, Optimal K' and B' Levels</h2><pre class="codeinput">    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    <span class="keyword">for</span> sub_j=1:1:4

        <span class="keyword">if</span> (bl_graph_onebyones)
            figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_bp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            <span class="keyword">end</span>

            mt_y = mt_ev_condi_z_max_kp;
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==3)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                figure(<span class="string">'PaperPosition'</span>, [0 0 14 4]);
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp &lt; 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            <span class="keyword">if</span>(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            <span class="keyword">end</span>
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        <span class="keyword">end</span>

        hold <span class="string">on</span>;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));

        <span class="keyword">if</span> (length(ar_w_level) &lt;= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, <span class="string">'filled'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
        <span class="keyword">end</span>

        <span class="keyword">for</span> m = 1:numel(chart)
            set(chart(m),<span class="string">'Color'</span>,clr(m,:))
        <span class="keyword">end</span>
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', <span class="string">'shock=%3.2f'</span>));

        xline0 = xline(0);
        xline0.HandleVisibility = <span class="string">'off'</span>;
        yline0 = yline(0);
        yline0.HandleVisibility = <span class="string">'off'</span>;
        grid <span class="string">on</span>;
        <span class="keyword">if</span> (sub_j&lt;=2)
            hline = refline([1 0]);
            hline.Color = <span class="string">'k'</span>;
            hline.LineStyle = <span class="string">':'</span>;
            hline.HandleVisibility = <span class="string">'off'</span>;
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==1)
            title(<span class="string">'B Choices of W'</span>);
            ylabel(<span class="string">'B Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==2)
            title(<span class="string">'K Choices of W'</span>);
            ylabel(<span class="string">'K Choices'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>

        <span class="keyword">if</span> (sub_j==3)
            title(<span class="string">'B Fraction of Borrow Max and Save'</span>);
            ylabel(<span class="string">'B/bar(B) if br or B/W if sv'</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northwest'</span>);
        <span class="keyword">end</span>
        <span class="keyword">if</span> (sub_j==4)
            title(<span class="string">'K Fraction Choices of Total K Possible'</span>);
            ylabel(<span class="string">'K/(W-bar(b)) '</span>);
            xlabel({<span class="string">'Total Savings w=k+b'</span>});
            <span class="comment">%             set(gca, 'YScale', 'log');</span>
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), <span class="string">'Location'</span>,<span class="string">'northeast'</span>);
        <span class="keyword">end</span>

    <span class="keyword">end</span>

    <span class="comment">% save file</span>
    <span class="keyword">if</span> (bl_img_save)
        mkdir(support_map(<span class="string">'st_img_path'</span>));
        st_file_name = [st_img_prefix st_img_name_main <span class="string">'_wkbopti'</span> st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    <span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_ipwkz_evf_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_evf_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_evf_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkz_evf_08.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans =

  Columns 1 through 7

   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127
   -0.1359   -0.1054   -0.0705   -0.0322    0.0092    0.0536    0.1012
    0.1196    0.1499    0.1846    0.2227    0.2638    0.3081    0.3554
    0.3084    0.3375    0.3708    0.4074    0.4470    0.4897    0.5354
    0.4610    0.4888    0.5205    0.5556    0.5935    0.6344    0.6784
    0.5901    0.6166    0.6469    0.6804    0.7168    0.7560    0.7982
    0.7025    0.7277    0.7568    0.7888    0.8237    0.8614    0.9020
    0.8021    0.8263    0.8541    0.8849    0.9184    0.9547    0.9939
    0.8917    0.9150    0.9417    0.9713    1.0036    1.0386    1.0764
    0.9733    0.9956    1.0214    1.0500    1.0811    1.1149    1.1515
    1.0482    1.0697    1.0946    1.1222    1.1523    1.1850    1.2205
    1.1179    1.1382    1.1622    1.1889    1.2181    1.2499    1.2843
    1.1831    1.2021    1.2252    1.2511    1.2794    1.3103    1.3437
    1.2443    1.2622    1.2841    1.3093    1.3368    1.3668    1.3993
    1.3019    1.3188    1.3396    1.3639    1.3907    1.4199    1.4516
    1.3564    1.3724    1.3922    1.4155    1.4416    1.4701    1.5010
    1.4081    1.4233    1.4421    1.4643    1.4898    1.5176    1.5478
    1.4572    1.4717    1.4896    1.5109    1.5355    1.5627    1.5922
    1.5040    1.5179    1.5350    1.5553    1.5791    1.6057    1.6346
    1.5488    1.5620    1.5784    1.5979    1.6208    1.6467    1.6750
    1.5916    1.6043    1.6200    1.6387    1.6607    1.6860    1.7137
    1.6327    1.6449    1.6600    1.6780    1.6991    1.7237    1.7508
    1.6721    1.6839    1.6984    1.7157    1.7361    1.7598    1.7865
    1.7100    1.7214    1.7354    1.7521    1.7717    1.7947    1.8208
    1.7466    1.7575    1.7710    1.7872    1.8061    1.8283    1.8539
    1.7819    1.7924    1.8055    1.8210    1.8394    1.8609    1.8859
    1.8159    1.8261    1.8387    1.8538    1.8716    1.8924    1.9167
    1.8489    1.8587    1.8710    1.8856    1.9028    1.9230    1.9466
    1.8808    1.8903    1.9022    1.9163    1.9331    1.9527    1.9756
    1.9117    1.9209    1.9324    1.9462    1.9624    1.9815    2.0038
    1.9416    1.9506    1.9618    1.9752    1.9910    2.0095    2.0312
    1.9707    1.9795    1.9903    2.0033    2.0187    2.0367    2.0578
    1.9990    2.0075    2.0181    2.0307    2.0457    2.0632    2.0838
    2.0265    2.0348    2.0451    2.0574    2.0719    2.0891    2.1091
    2.0533    2.0614    2.0714    2.0834    2.0975    2.1142    2.1338
    2.0794    2.0872    2.0970    2.1087    2.1225    2.1388    2.1579
    2.1048    2.1124    2.1219    2.1334    2.1469    2.1628    2.1814
    2.1295    2.1370    2.1463    2.1574    2.1706    2.1862    2.2044
    2.1537    2.1610    2.1701    2.1810    2.1939    2.2090    2.2269
    2.1773    2.1845    2.1933    2.2040    2.2165    2.2314    2.2488
    2.2004    2.2074    2.2160    2.2264    2.2387    2.2533    2.2703
    2.2229    2.2298    2.2382    2.2484    2.2604    2.2747    2.2914
    2.2450    2.2516    2.2599    2.2699    2.2817    2.2956    2.3120
    2.2666    2.2731    2.2812    2.2909    2.3025    2.3161    2.3322
    2.2877    2.2941    2.3020    2.3116    2.3229    2.3362    2.3520
    2.3083    2.3146    2.3224    2.3318    2.3429    2.3560    2.3714
    2.3286    2.3347    2.3424    2.3515    2.3624    2.3753    2.3904
    2.3485    2.3545    2.3620    2.3710    2.3816    2.3943    2.4091
    2.3679    2.3738    2.3812    2.3900    2.4005    2.4129    2.4274
    2.3870    2.3928    2.4000    2.4087    2.4190    2.4311    2.4455
    2.4058    2.4114    2.4185    2.4270    2.4371    2.4491    2.4632
    2.4242    2.4297    2.4367    2.4450    2.4550    2.4667    2.4805
    2.4422    2.4477    2.4545    2.4627    2.4725    2.4840    2.4976
    2.4600    2.4654    2.4721    2.4801    2.4897    2.5010    2.5144
    2.4774    2.4827    2.4893    2.4972    2.5066    2.5178    2.5309
    2.4945    2.4997    2.5062    2.5140    2.5233    2.5343    2.5472
    2.5114    2.5165    2.5229    2.5305    2.5397    2.5505    2.5632
    2.5279    2.5330    2.5392    2.5468    2.5558    2.5664    2.5789
    2.5442    2.5492    2.5554    2.5628    2.5716    2.5821    2.5944
    2.5603    2.5652    2.5712    2.5785    2.5872    2.5975    2.6097
    2.5761    2.5809    2.5868    2.5940    2.6026    2.6127    2.6247
    2.5916    2.5963    2.6022    2.6093    2.6177    2.6277    2.6395
    2.6069    2.6115    2.6173    2.6243    2.6326    2.6425    2.6541
    2.6220    2.6265    2.6323    2.6391    2.6473    2.6570    2.6685
    2.6368    2.6413    2.6470    2.6537    2.6618    2.6714    2.6827
    2.6514    2.6559    2.6614    2.6681    2.6761    2.6855    2.6967
    2.6659    2.6702    2.6757    2.6823    2.6902    2.6994    2.7104
    2.6801    2.6844    2.6898    2.6963    2.7040    2.7132    2.7240
    2.6941    2.6983    2.7037    2.7101    2.7177    2.7268    2.7375
    2.7079    2.7121    2.7174    2.7237    2.7312    2.7401    2.7507
    2.7215    2.7257    2.7309    2.7371    2.7445    2.7533    2.7638
    2.7350    2.7391    2.7442    2.7503    2.7577    2.7664    2.7767
    2.7482    2.7523    2.7573    2.7634    2.7706    2.7792    2.7894
    2.7613    2.7653    2.7703    2.7763    2.7835    2.7919    2.8020
    2.7743    2.7782    2.7831    2.7890    2.7961    2.8045    2.8144
    2.7870    2.7909    2.7958    2.8016    2.8086    2.8169    2.8266
    2.7996    2.8035    2.8083    2.8140    2.8209    2.8291    2.8388
    2.8121    2.8159    2.8206    2.8263    2.8331    2.8412    2.8507
    2.8244    2.8281    2.8328    2.8384    2.8451    2.8531    2.8626
    2.8365    2.8402    2.8448    2.8504    2.8570    2.8649    2.8742
    2.8485    2.8522    2.8567    2.8622    2.8688    2.8766    2.8858
    2.8603    2.8640    2.8685    2.8739    2.8804    2.8881    2.8972
    2.8721    2.8756    2.8801    2.8855    2.8919    2.8995    2.9085
    2.8836    2.8872    2.8916    2.8969    2.9032    2.9108    2.9197
    2.8951    2.8986    2.9029    2.9082    2.9145    2.9219    2.9307
    2.9064    2.9099    2.9142    2.9194    2.9256    2.9329    2.9417
    2.9176    2.9210    2.9253    2.9304    2.9366    2.9438    2.9525
    2.9287    2.9320    2.9363    2.9413    2.9474    2.9546    2.9632
    2.9396    2.9429    2.9471    2.9522    2.9582    2.9653    2.9737
    2.9504    2.9537    2.9579    2.9628    2.9688    2.9758    2.9842
    2.9611    2.9644    2.9685    2.9734    2.9793    2.9863    2.9946
    2.9717    2.9750    2.9790    2.9839    2.9897    2.9966    3.0048
    2.9822    2.9854    2.9894    2.9943    3.0000    3.0068    3.0150
    2.9926    2.9958    2.9997    3.0045    3.0102    3.0170    3.0250
    3.0029    3.0060    3.0099    3.0147    3.0203    3.0270    3.0349
    3.0130    3.0161    3.0200    3.0247    3.0303    3.0369    3.0448
    3.0231    3.0262    3.0300    3.0347    3.0402    3.0468    3.0545
    3.0331    3.0361    3.0399    3.0445    3.0500    3.0565    3.0642
    3.0429    3.0459    3.0497    3.0543    3.0597    3.0661    3.0738
    3.0527    3.0557    3.0594    3.0639    3.0693    3.0757    3.0832
    3.0624    3.0653    3.0690    3.0735    3.0788    3.0851    3.0926
    3.0720    3.0749    3.0785    3.0830    3.0882    3.0945    3.1019
    3.0814    3.0844    3.0880    3.0924    3.0976    3.1038    3.1111
    3.0908    3.0937    3.0973    3.1017    3.1068    3.1130    3.1203
    3.1002    3.1030    3.1066    3.1109    3.1160    3.1221    3.1293
    3.1094    3.1122    3.1157    3.1200    3.1251    3.1311    3.1383
    3.1185    3.1213    3.1248    3.1290    3.1341    3.1401    3.1472
    3.1276    3.1304    3.1338    3.1380    3.1430    3.1489    3.1560
    3.1366    3.1393    3.1428    3.1469    3.1518    3.1577    3.1647
    3.1455    3.1482    3.1516    3.1557    3.1606    3.1664    3.1734
    3.1543    3.1570    3.1604    3.1644    3.1693    3.1751    3.1819
    3.1630    3.1657    3.1691    3.1731    3.1779    3.1836    3.1904
    3.1717    3.1744    3.1777    3.1817    3.1865    3.1921    3.1989
    3.1803    3.1829    3.1862    3.1902    3.1949    3.2006    3.2072
    3.1888    3.1914    3.1947    3.1986    3.2033    3.2089    3.2155
    3.1973    3.1999    3.2031    3.2070    3.2116    3.2172    3.2238
    3.2056    3.2082    3.2114    3.2153    3.2199    3.2254    3.2319
    3.2140    3.2165    3.2197    3.2235    3.2281    3.2335    3.2400
    3.2222    3.2247    3.2279    3.2317    3.2362    3.2416    3.2481
    3.2304    3.2329    3.2360    3.2398    3.2443    3.2496    3.2560
    3.2385    3.2410    3.2441    3.2478    3.2523    3.2576    3.2639
    3.2465    3.2490    3.2521    3.2558    3.2602    3.2655    3.2718
    3.2545    3.2569    3.2600    3.2637    3.2681    3.2733    3.2795
    3.2624    3.2648    3.2679    3.2715    3.2759    3.2811    3.2873
    3.2703    3.2727    3.2757    3.2793    3.2836    3.2888    3.2949
    3.2780    3.2804    3.2834    3.2870    3.2913    3.2964    3.3025
    3.2858    3.2881    3.2911    3.2947    3.2989    3.3040    3.3101
    3.2934    3.2958    3.2987    3.3023    3.3065    3.3116    3.3176
    3.3011    3.3034    3.3063    3.3098    3.3140    3.3190    3.3250
    3.3086    3.3109    3.3138    3.3173    3.3215    3.3265    3.3324
    3.3161    3.3184    3.3213    3.3247    3.3289    3.3338    3.3397
    3.3236    3.3258    3.3287    3.3321    3.3362    3.3411    3.3470
    3.3309    3.3332    3.3360    3.3395    3.3435    3.3484    3.3542
    3.3383    3.3405    3.3433    3.3467    3.3508    3.3556    3.3613
    3.3456    3.3478    3.3506    3.3539    3.3580    3.3628    3.3685
    3.3528    3.3550    3.3578    3.3611    3.3651    3.3699    3.3755
    3.3600    3.3622    3.3649    3.3682    3.3722    3.3769    3.3825
    3.3671    3.3693    3.3720    3.3753    3.3792    3.3839    3.3895
    3.3742    3.3763    3.3790    3.3823    3.3862    3.3909    3.3964
    3.3812    3.3833    3.3860    3.3893    3.3932    3.3978    3.4033
    3.3882    3.3903    3.3930    3.3962    3.4001    3.4046    3.4101
    3.3951    3.3972    3.3999    3.4031    3.4069    3.4115    3.4169
    3.4020    3.4041    3.4067    3.4099    3.4137    3.4182    3.4236
    3.4088    3.4109    3.4135    3.4167    3.4205    3.4250    3.4303
    3.4156    3.4177    3.4203    3.4234    3.4272    3.4316    3.4369
    3.4223    3.4244    3.4270    3.4301    3.4338    3.4383    3.4435
    3.4290    3.4311    3.4336    3.4367    3.4404    3.4449    3.4501
    3.4357    3.4377    3.4403    3.4433    3.4470    3.4514    3.4566
    3.4423    3.4443    3.4468    3.4499    3.4535    3.4579    3.4631
    3.4488    3.4508    3.4534    3.4564    3.4600    3.4644    3.4695
    3.4554    3.4574    3.4599    3.4629    3.4665    3.4708    3.4759
    3.4618    3.4638    3.4663    3.4693    3.4729    3.4772    3.4822
    3.4683    3.4702    3.4727    3.4757    3.4793    3.4835    3.4886
    3.4747    3.4766    3.4791    3.4820    3.4856    3.4898    3.4948
    3.4810    3.4830    3.4854    3.4883    3.4919    3.4961    3.5010
    3.4873    3.4893    3.4917    3.4946    3.4981    3.5023    3.5072
    3.4936    3.4955    3.4979    3.5008    3.5043    3.5085    3.5134
    3.4998    3.5018    3.5041    3.5070    3.5105    3.5146    3.5195
    3.5060    3.5079    3.5103    3.5132    3.5166    3.5207    3.5256
    3.5122    3.5141    3.5165    3.5193    3.5227    3.5268    3.5316
    3.5183    3.5202    3.5225    3.5254    3.5288    3.5328    3.5376
    3.5244    3.5263    3.5286    3.5314    3.5348    3.5388    3.5436
    3.5305    3.5323    3.5346    3.5374    3.5408    3.5448    3.5495
    3.5365    3.5383    3.5406    3.5434    3.5467    3.5507    3.5554
    3.5424    3.5443    3.5466    3.5493    3.5526    3.5566    3.5613
    3.5484    3.5502    3.5525    3.5552    3.5585    3.5624    3.5671
    3.5543    3.5561    3.5584    3.5611    3.5644    3.5683    3.5729
    3.5602    3.5620    3.5642    3.5669    3.5702    3.5741    3.5787
    3.5660    3.5678    3.5700    3.5727    3.5760    3.5798    3.5844
    3.5718    3.5736    3.5758    3.5785    3.5817    3.5855    3.5901
    3.5776    3.5793    3.5815    3.5842    3.5874    3.5912    3.5958
    3.5833    3.5851    3.5873    3.5899    3.5931    3.5969    3.6014
    3.5890    3.5907    3.5929    3.5956    3.5987    3.6025    3.6070
    3.5947    3.5964    3.5986    3.6012    3.6044    3.6081    3.6126
    3.6003    3.6020    3.6042    3.6068    3.6099    3.6137    3.6181
    3.6059    3.6076    3.6098    3.6124    3.6155    3.6192    3.6236
    3.6115    3.6132    3.6153    3.6179    3.6210    3.6247    3.6291
    3.6170    3.6187    3.6209    3.6234    3.6265    3.6302    3.6345
    3.6225    3.6242    3.6264    3.6289    3.6320    3.6356    3.6400
    3.6280    3.6297    3.6318    3.6344    3.6374    3.6410    3.6453
    3.6335    3.6352    3.6372    3.6398    3.6428    3.6464    3.6507
    3.6389    3.6406    3.6426    3.6452    3.6482    3.6518    3.6560
    3.6443    3.6460    3.6480    3.6505    3.6535    3.6571    3.6613
    3.6497    3.6513    3.6534    3.6559    3.6588    3.6624    3.6666
    3.6550    3.6566    3.6587    3.6612    3.6641    3.6677    3.6719
    3.6603    3.6619    3.6640    3.6664    3.6694    3.6729    3.6771
    3.6656    3.6672    3.6692    3.6717    3.6746    3.6781    3.6823
    3.6708    3.6725    3.6745    3.6769    3.6798    3.6833    3.6874
    3.6761    3.6777    3.6797    3.6821    3.6850    3.6885    3.6926
    3.6813    3.6829    3.6849    3.6873    3.6902    3.6936    3.6977
    3.6864    3.6880    3.6900    3.6924    3.6953    3.6987    3.7028
    3.6916    3.6932    3.6951    3.6975    3.7004    3.7038    3.7078
    3.6967    3.6983    3.7002    3.7026    3.7055    3.7088    3.7129
    3.7018    3.7034    3.7053    3.7077    3.7105    3.7139    3.7179
    3.7069    3.7084    3.7104    3.7127    3.7155    3.7189    3.7229
    3.7119    3.7135    3.7154    3.7177    3.7205    3.7239    3.7278
    3.7169    3.7185    3.7204    3.7227    3.7255    3.7288    3.7328
    3.7219    3.7234    3.7254    3.7277    3.7304    3.7338    3.7377
    3.7269    3.7284    3.7303    3.7326    3.7354    3.7387    3.7426
    3.7318    3.7333    3.7352    3.7375    3.7403    3.7435    3.7474
    3.7367    3.7382    3.7401    3.7424    3.7451    3.7484    3.7523
    3.7416    3.7431    3.7450    3.7473    3.7500    3.7532    3.7571
    3.7465    3.7480    3.7499    3.7521    3.7548    3.7581    3.7619
    3.7513    3.7528    3.7547    3.7569    3.7596    3.7628    3.7667
    3.7562    3.7576    3.7595    3.7617    3.7644    3.7676    3.7714
    3.7610    3.7624    3.7643    3.7665    3.7692    3.7724    3.7761
    3.7657    3.7672    3.7690    3.7713    3.7739    3.7771    3.7809
    3.7705    3.7720    3.7738    3.7760    3.7786    3.7818    3.7855
    3.7752    3.7767    3.7785    3.7807    3.7833    3.7865    3.7902
    3.7799    3.7814    3.7832    3.7854    3.7880    3.7911    3.7948
    3.7846    3.7861    3.7879    3.7900    3.7926    3.7958    3.7995
    3.7893    3.7907    3.7925    3.7947    3.7973    3.8004    3.8040
    3.7939    3.7954    3.7971    3.7993    3.8019    3.8050    3.8086
    3.7986    3.8000    3.8017    3.8039    3.8065    3.8095    3.8132
    3.8032    3.8046    3.8063    3.8085    3.8110    3.8141    3.8177
    3.8077    3.8091    3.8109    3.8130    3.8156    3.8186    3.8222
    3.8123    3.8137    3.8154    3.8176    3.8201    3.8231    3.8267
    3.8168    3.8182    3.8200    3.8221    3.8246    3.8276    3.8312
    3.8213    3.8227    3.8245    3.8266    3.8291    3.8321    3.8356
    3.8258    3.8272    3.8290    3.8310    3.8335    3.8365    3.8401
    3.8303    3.8317    3.8334    3.8355    3.8380    3.8410    3.8445
    3.8348    3.8361    3.8379    3.8399    3.8424    3.8454    3.8489
    3.8392    3.8406    3.8423    3.8443    3.8468    3.8498    3.8533
    3.8436    3.8450    3.8467    3.8487    3.8512    3.8541    3.8576
    3.8480    3.8494    3.8511    3.8531    3.8556    3.8585    3.8620
    3.8524    3.8538    3.8554    3.8575    3.8599    3.8628    3.8663
    3.8568    3.8581    3.8598    3.8618    3.8642    3.8671    3.8706
    3.8611    3.8624    3.8641    3.8661    3.8685    3.8714    3.8749
    3.8654    3.8668    3.8684    3.8704    3.8728    3.8757    3.8791
    3.8697    3.8711    3.8727    3.8747    3.8771    3.8800    3.8834
    3.8740    3.8753    3.8770    3.8790    3.8814    3.8842    3.8876
    3.8783    3.8796    3.8812    3.8832    3.8856    3.8884    3.8918
    3.8825    3.8838    3.8855    3.8874    3.8898    3.8926    3.8960
    3.8868    3.8881    3.8897    3.8917    3.8940    3.8968    3.9002
    3.8910    3.8923    3.8939    3.8959    3.8982    3.9010    3.9043
    3.8952    3.8965    3.8981    3.9000    3.9024    3.9051    3.9085
    3.8994    3.9006    3.9022    3.9042    3.9065    3.9093    3.9126
    3.9035    3.9048    3.9064    3.9083    3.9106    3.9134    3.9167
    3.9077    3.9089    3.9105    3.9124    3.9148    3.9175    3.9208
    3.9118    3.9130    3.9146    3.9166    3.9188    3.9216    3.9249
    3.9159    3.9172    3.9187    3.9206    3.9229    3.9257    3.9289
    3.9200    3.9212    3.9228    3.9247    3.9270    3.9297    3.9330
    3.9241    3.9253    3.9269    3.9288    3.9310    3.9337    3.9370
    3.9281    3.9294    3.9309    3.9328    3.9351    3.9378    3.9410
    3.9322    3.9334    3.9350    3.9368    3.9391    3.9418    3.9450
    3.9362    3.9374    3.9390    3.9408    3.9431    3.9458    3.9489
    3.9402    3.9414    3.9430    3.9448    3.9471    3.9497    3.9529
    3.9442    3.9454    3.9470    3.9488    3.9510    3.9537    3.9569
    3.9482    3.9494    3.9509    3.9528    3.9550    3.9576    3.9608
    3.9521    3.9533    3.9549    3.9567    3.9589    3.9616    3.9647

  Columns 8 through 14

   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127   -0.8127
    0.1519    0.2058    0.2630    0.3233    0.3868    0.4530    0.5203
    0.4059    0.4596    0.5165    0.5766    0.6399    0.7058    0.7730
    0.5843    0.6363    0.6916    0.7500    0.8117    0.8760    0.9416
    0.7254    0.7756    0.8290    0.8856    0.9453    1.0078    1.0716
    0.8435    0.8919    0.9434    0.9982    1.0561    1.1168    1.1789
    0.9456    0.9923    1.0422    1.0953    1.1515    1.2104    1.2709
    1.0360    1.0811    1.1294    1.1809    1.2355    1.2928    1.3517
    1.1171    1.1609    1.2077    1.2577    1.3108    1.3667    1.4241
    1.1910    1.2334    1.2789    1.3275    1.3792    1.4337    1.4898
    1.2588    1.3000    1.3442    1.3916    1.4420    1.4952    1.5500
    1.3215    1.3616    1.4047    1.4508    1.5000    1.5520    1.6057
    1.3799    1.4190    1.4610    1.5060    1.5541    1.6050    1.6575
    1.4346    1.4727    1.5137    1.5577    1.6047    1.6546    1.7060
    1.4860    1.5232    1.5633    1.6063    1.6524    1.7012    1.7516
    1.5346    1.5709    1.6101    1.6522    1.6974    1.7452    1.7948
    1.5806    1.6161    1.6545    1.6958    1.7400    1.7870    1.8356
    1.6243    1.6591    1.6967    1.7372    1.7806    1.8267    1.8745
    1.6660    1.7001    1.7369    1.7766    1.8192    1.8646    1.9116
    1.7058    1.7392    1.7753    1.8143    1.8562    1.9008    1.9470
    1.7439    1.7767    1.8122    1.8505    1.8916    1.9355    1.9810
    1.7805    1.8126    1.8475    1.8851    1.9256    1.9687    2.0136
    1.8156    1.8472    1.8814    1.9185    1.9583    2.0008    2.0449
    1.8494    1.8805    1.9141    1.9505    1.9898    2.0316    2.0751
    1.8820    1.9125    1.9457    1.9815    2.0201    2.0614    2.1043
    1.9135    1.9435    1.9761    2.0114    2.0495    2.0901    2.1325
    1.9439    1.9734    2.0055    2.0403    2.0778    2.1179    2.1597
    1.9733    2.0024    2.0341    2.0683    2.1053    2.1449    2.1861
    2.0018    2.0305    2.0617    2.0955    2.1320    2.1710    2.2117
    2.0295    2.0577    2.0885    2.1218    2.1578    2.1964    2.2366
    2.0563    2.0842    2.1145    2.1474    2.1829    2.2210    2.2607
    2.0824    2.1099    2.1398    2.1722    2.2073    2.2449    2.2842
    2.1078    2.1349    2.1644    2.1964    2.2311    2.2682    2.3070
    2.1325    2.1592    2.1883    2.2200    2.2542    2.2909    2.3293
    2.1567    2.1829    2.2117    2.2429    2.2768    2.3131    2.3510
    2.1802    2.2060    2.2344    2.2653    2.2988    2.3346    2.3722
    2.2032    2.2286    2.2566    2.2872    2.3202    2.3557    2.3928
    2.2257    2.2506    2.2783    2.3085    2.3412    2.3763    2.4130
    2.2477    2.2721    2.2995    2.3293    2.3617    2.3964    2.4328
    2.2693    2.2931    2.3202    2.3497    2.3817    2.4160    2.4521
    2.2903    2.3137    2.3404    2.3696    2.4013    2.4353    2.4709
    2.3110    2.3339    2.3602    2.3891    2.4204    2.4541    2.4894
    2.3312    2.3536    2.3796    2.4082    2.4392    2.4725    2.5075
    2.3510    2.3730    2.3986    2.4269    2.4576    2.4906    2.5252
    2.3704    2.3920    2.4172    2.4452    2.4756    2.5083    2.5426
    2.3895    2.4107    2.4354    2.4631    2.4932    2.5257    2.5597
    2.4082    2.4290    2.4533    2.4807    2.5106    2.5427    2.5764
    2.4266    2.4470    2.4709    2.4980    2.5276    2.5594    2.5928
    2.4446    2.4647    2.4881    2.5150    2.5443    2.5758    2.6089
    2.4623    2.4820    2.5051    2.5316    2.5607    2.5919    2.6248
    2.4797    2.4991    2.5218    2.5480    2.5768    2.6078    2.6403
    2.4968    2.5159    2.5382    2.5641    2.5926    2.6233    2.6556
    2.5136    2.5324    2.5543    2.5799    2.6081    2.6386    2.6707
    2.5302    2.5486    2.5702    2.5954    2.6234    2.6537    2.6854
    2.5464    2.5646    2.5859    2.6107    2.6385    2.6685    2.7000
    2.5624    2.5803    2.6013    2.6257    2.6533    2.6830    2.7143
    2.5782    2.5958    2.6164    2.6405    2.6678    2.6973    2.7284
    2.5937    2.6110    2.6314    2.6551    2.6822    2.7114    2.7423
    2.6090    2.6261    2.6461    2.6695    2.6963    2.7253    2.7559
    2.6240    2.6409    2.6606    2.6836    2.7102    2.7390    2.7694
    2.6388    2.6554    2.6749    2.6976    2.7239    2.7525    2.7826
    2.6534    2.6698    2.6890    2.7114    2.7374    2.7658    2.7957
    2.6678    2.6840    2.7029    2.7250    2.7507    2.7789    2.8086
    2.6820    2.6979    2.7166    2.7384    2.7638    2.7918    2.8213
    2.6960    2.7117    2.7301    2.7516    2.7767    2.8045    2.8338
    2.7098    2.7253    2.7434    2.7647    2.7895    2.8171    2.8462
    2.7234    2.7387    2.7566    2.7776    2.8020    2.8295    2.8584
    2.7368    2.7519    2.7696    2.7903    2.8145    2.8417    2.8704
    2.7501    2.7650    2.7824    2.8029    2.8267    2.8537    2.8823
    2.7632    2.7778    2.7951    2.8153    2.8389    2.8656    2.8940
    2.7761    2.7906    2.8076    2.8276    2.8508    2.8774    2.9055
    2.7888    2.8031    2.8200    2.8397    2.8627    2.8890    2.9170
    2.8014    2.8155    2.8322    2.8516    2.8744    2.9005    2.9283
    2.8138    2.8278    2.8442    2.8635    2.8859    2.9118    2.9394
    2.8261    2.8399    2.8561    2.8752    2.8974    2.9230    2.9504
    2.8382    2.8518    2.8679    2.8867    2.9087    2.9340    2.9613
    2.8502    2.8637    2.8795    2.8981    2.9198    2.9449    2.9720
    2.8620    2.8753    2.8910    2.9094    2.9309    2.9557    2.9827
    2.8737    2.8869    2.9024    2.9206    2.9418    2.9664    2.9932
    2.8853    2.8983    2.9136    2.9316    2.9526    2.9769    3.0036
    2.8967    2.9096    2.9247    2.9425    2.9633    2.9874    3.0138
    2.9080    2.9207    2.9357    2.9533    2.9739    2.9977    3.0240
    2.9192    2.9318    2.9466    2.9640    2.9844    3.0079    3.0340
    2.9302    2.9427    2.9574    2.9746    2.9948    3.0181    3.0440
    2.9412    2.9535    2.9680    2.9851    3.0050    3.0281    3.0538
    2.9520    2.9642    2.9785    2.9954    3.0152    3.0380    3.0635
    2.9627    2.9747    2.9890    3.0057    3.0252    3.0478    3.0732
    2.9733    2.9852    2.9993    3.0158    3.0352    3.0576    3.0827
    2.9837    2.9955    3.0095    3.0258    3.0450    3.0672    3.0921
    2.9941    3.0058    3.0196    3.0358    3.0548    3.0767    3.1015
    3.0044    3.0159    3.0296    3.0456    3.0644    3.0862    3.1107
    3.0145    3.0260    3.0395    3.0554    3.0740    3.0956    3.1199
    3.0246    3.0359    3.0493    3.0650    3.0835    3.1048    3.1289
    3.0345    3.0457    3.0590    3.0746    3.0929    3.1140    3.1379
    3.0444    3.0555    3.0686    3.0841    3.1022    3.1231    3.1468
    3.0541    3.0651    3.0781    3.0934    3.1114    3.1322    3.1556
    3.0638    3.0747    3.0876    3.1027    3.1205    3.1411    3.1644
    3.0733    3.0842    3.0969    3.1119    3.1296    3.1500    3.1730
    3.0828    3.0935    3.1062    3.1211    3.1385    3.1588    3.1816
    3.0922    3.1028    3.1154    3.1301    3.1474    3.1675    3.1901
    3.1015    3.1120    3.1245    3.1391    3.1562    3.1761    3.1986
    3.1107    3.1212    3.1335    3.1480    3.1650    3.1847    3.2069
    3.1199    3.1302    3.1424    3.1568    3.1736    3.1932    3.2153
    3.1289    3.1392    3.1512    3.1655    3.1822    3.2016    3.2235
    3.1379    3.1480    3.1600    3.1741    3.1907    3.2099    3.2317
    3.1468    3.1568    3.1687    3.1827    3.1991    3.2182    3.2398
    3.1556    3.1656    3.1773    3.1912    3.2075    3.2264    3.2478
    3.1643    3.1742    3.1859    3.1996    3.2158    3.2346    3.2558
    3.1730    3.1828    3.1944    3.2080    3.2240    3.2426    3.2637
    3.1816    3.1913    3.2028    3.2163    3.2322    3.2507    3.2715
    3.1901    3.1997    3.2111    3.2245    3.2403    3.2586    3.2793
    3.1985    3.2081    3.2194    3.2327    3.2483    3.2665    3.2870
    3.2069    3.2164    3.2276    3.2408    3.2563    3.2743    3.2947
    3.2152    3.2246    3.2357    3.2488    3.2642    3.2821    3.3023
    3.2234    3.2327    3.2438    3.2567    3.2720    3.2898    3.3099
    3.2316    3.2408    3.2518    3.2646    3.2798    3.2974    3.3174
    3.2397    3.2488    3.2597    3.2725    3.2875    3.3050    3.3248
    3.2477    3.2568    3.2676    3.2803    3.2952    3.3125    3.3322
    3.2557    3.2647    3.2754    3.2880    3.3028    3.3200    3.3395
    3.2636    3.2725    3.2831    3.2956    3.3103    3.3274    3.3468
    3.2714    3.2803    3.2908    3.3032    3.3178    3.3348    3.3540
    3.2792    3.2880    3.2985    3.3108    3.3253    3.3421    3.3612
    3.2869    3.2957    3.3060    3.3183    3.3326    3.3494    3.3683
    3.2946    3.3033    3.3135    3.3257    3.3400    3.3566    3.3754
    3.3022    3.3108    3.3210    3.3331    3.3472    3.3637    3.3824
    3.3097    3.3183    3.3284    3.3404    3.3544    3.3708    3.3894
    3.3172    3.3257    3.3358    3.3476    3.3616    3.3779    3.3963
    3.3247    3.3331    3.3431    3.3549    3.3687    3.3849    3.4032
    3.3320    3.3404    3.3503    3.3620    3.3758    3.3918    3.4100
    3.3394    3.3477    3.3575    3.3691    3.3828    3.3987    3.4168
    3.3466    3.3549    3.3647    3.3762    3.3898    3.4056    3.4235
    3.3539    3.3621    3.3717    3.3832    3.3967    3.4124    3.4302
    3.3610    3.3692    3.3788    3.3902    3.4036    3.4192    3.4368
    3.3681    3.3762    3.3858    3.3971    3.4104    3.4259    3.4434
    3.3752    3.3832    3.3927    3.4039    3.4172    3.4326    3.4500
    3.3822    3.3902    3.3996    3.4108    3.4239    3.4392    3.4565
    3.3892    3.3971    3.4065    3.4175    3.4306    3.4458    3.4630
    3.3961    3.4040    3.4133    3.4243    3.4372    3.4523    3.4694
    3.4030    3.4108    3.4200    3.4310    3.4438    3.4588    3.4758
    3.4098    3.4176    3.4267    3.4376    3.4504    3.4653    3.4822
    3.4166    3.4243    3.4334    3.4442    3.4569    3.4717    3.4885
    3.4233    3.4310    3.4400    3.4507    3.4634    3.4781    3.4947
    3.4300    3.4376    3.4466    3.4572    3.4698    3.4844    3.5010
    3.4367    3.4442    3.4531    3.4637    3.4762    3.4907    3.5072
    3.4433    3.4508    3.4596    3.4701    3.4825    3.4970    3.5133
    3.4498    3.4573    3.4661    3.4765    3.4888    3.5032    3.5194
    3.4563    3.4637    3.4725    3.4829    3.4951    3.5093    3.5255
    3.4628    3.4702    3.4789    3.4892    3.5013    3.5155    3.5316
    3.4692    3.4765    3.4852    3.4954    3.5075    3.5216    3.5376
    3.4756    3.4829    3.4915    3.5017    3.5137    3.5277    3.5435
    3.4820    3.4892    3.4977    3.5079    3.5198    3.5337    3.5495
    3.4883    3.4955    3.5039    3.5140    3.5259    3.5397    3.5554
    3.4946    3.5017    3.5101    3.5201    3.5319    3.5456    3.5612
    3.5008    3.5079    3.5163    3.5262    3.5379    3.5516    3.5671
    3.5070    3.5140    3.5224    3.5322    3.5439    3.5575    3.5729
    3.5131    3.5201    3.5284    3.5382    3.5498    3.5633    3.5786
    3.5192    3.5262    3.5344    3.5442    3.5557    3.5691    3.5844
    3.5253    3.5322    3.5404    3.5501    3.5616    3.5749    3.5901
    3.5314    3.5382    3.5464    3.5560    3.5674    3.5807    3.5957
    3.5374    3.5442    3.5523    3.5619    3.5732    3.5864    3.6014
    3.5433    3.5501    3.5582    3.5677    3.5789    3.5921    3.6070
    3.5493    3.5560    3.5640    3.5735    3.5847    3.5977    3.6125
    3.5552    3.5619    3.5698    3.5793    3.5904    3.6033    3.6181
    3.5610    3.5677    3.5756    3.5850    3.5960    3.6089    3.6236
    3.5669    3.5735    3.5814    3.5907    3.6017    3.6145    3.6291
    3.5727    3.5793    3.5871    3.5963    3.6073    3.6200    3.6345
    3.5784    3.5850    3.5928    3.6020    3.6128    3.6255    3.6399
    3.5842    3.5907    3.5984    3.6076    3.6184    3.6310    3.6453
    3.5899    3.5963    3.6040    3.6131    3.6239    3.6364    3.6507
    3.5955    3.6020    3.6096    3.6187    3.6294    3.6418    3.6560
    3.6012    3.6076    3.6152    3.6242    3.6348    3.6472    3.6613
    3.6068    3.6131    3.6207    3.6296    3.6402    3.6526    3.6666
    3.6123    3.6187    3.6262    3.6351    3.6456    3.6579    3.6719
    3.6179    3.6242    3.6317    3.6405    3.6510    3.6632    3.6771
    3.6234    3.6296    3.6371    3.6459    3.6563    3.6685    3.6823
    3.6289    3.6351    3.6425    3.6513    3.6616    3.6737    3.6874
    3.6343    3.6405    3.6479    3.6566    3.6669    3.6789    3.6926
    3.6397    3.6459    3.6532    3.6619    3.6721    3.6841    3.6977
    3.6451    3.6513    3.6585    3.6672    3.6773    3.6893    3.7028
    3.6505    3.6566    3.6638    3.6724    3.6825    3.6944    3.7079
    3.6558    3.6619    3.6691    3.6776    3.6877    3.6995    3.7129
    3.6611    3.6672    3.6743    3.6828    3.6928    3.7046    3.7179
    3.6664    3.6724    3.6795    3.6880    3.6980    3.7096    3.7229
    3.6716    3.6776    3.6847    3.6931    3.7030    3.7147    3.7279
    3.6769    3.6828    3.6899    3.6982    3.7081    3.7197    3.7328
    3.6821    3.6880    3.6950    3.7033    3.7131    3.7246    3.7377
    3.6872    3.6931    3.7001    3.7084    3.7181    3.7296    3.7426
    3.6924    3.6982    3.7052    3.7134    3.7231    3.7345    3.7475
    3.6975    3.7033    3.7102    3.7184    3.7281    3.7394    3.7523
    3.7026    3.7084    3.7152    3.7234    3.7330    3.7443    3.7571
    3.7076    3.7134    3.7202    3.7284    3.7379    3.7492    3.7619
    3.7127    3.7184    3.7252    3.7333    3.7428    3.7540    3.7667
    3.7177    3.7234    3.7302    3.7382    3.7477    3.7588    3.7714
    3.7227    3.7284    3.7351    3.7431    3.7525    3.7636    3.7762
    3.7276    3.7333    3.7400    3.7480    3.7574    3.7684    3.7809
    3.7326    3.7382    3.7449    3.7528    3.7621    3.7731    3.7856
    3.7375    3.7431    3.7497    3.7576    3.7669    3.7778    3.7902
    3.7424    3.7479    3.7546    3.7624    3.7717    3.7825    3.7949
    3.7472    3.7528    3.7594    3.7672    3.7764    3.7872    3.7995
    3.7521    3.7576    3.7642    3.7719    3.7811    3.7918    3.8041
    3.7569    3.7624    3.7689    3.7766    3.7858    3.7965    3.8087
    3.7617    3.7672    3.7737    3.7813    3.7904    3.8011    3.8132
    3.7665    3.7719    3.7784    3.7860    3.7951    3.8057    3.8177
    3.7712    3.7766    3.7831    3.7907    3.7997    3.8102    3.8223
    3.7760    3.7813    3.7877    3.7953    3.8043    3.8148    3.8268
    3.7807    3.7860    3.7924    3.7999    3.8089    3.8193    3.8312
    3.7853    3.7907    3.7970    3.8045    3.8134    3.8238    3.8357
    3.7900    3.7953    3.8016    3.8091    3.8180    3.8283    3.8401
    3.7946    3.7999    3.8062    3.8137    3.8225    3.8328    3.8445
    3.7993    3.8045    3.8108    3.8182    3.8270    3.8372    3.8489
    3.8039    3.8091    3.8153    3.8227    3.8314    3.8417    3.8533
    3.8084    3.8136    3.8198    3.8272    3.8359    3.8461    3.8577
    3.8130    3.8182    3.8243    3.8317    3.8403    3.8505    3.8620
    3.8175    3.8227    3.8288    3.8361    3.8447    3.8548    3.8663
    3.8220    3.8272    3.8333    3.8405    3.8491    3.8592    3.8706
    3.8265    3.8317    3.8377    3.8450    3.8535    3.8635    3.8749
    3.8310    3.8361    3.8422    3.8494    3.8579    3.8678    3.8792
    3.8355    3.8405    3.8466    3.8537    3.8622    3.8721    3.8834
    3.8399    3.8450    3.8510    3.8581    3.8665    3.8764    3.8876
    3.8443    3.8493    3.8553    3.8624    3.8708    3.8806    3.8919
    3.8487    3.8537    3.8597    3.8667    3.8751    3.8849    3.8960
    3.8531    3.8581    3.8640    3.8710    3.8794    3.8891    3.9002
    3.8574    3.8624    3.8683    3.8753    3.8836    3.8933    3.9044
    3.8618    3.8667    3.8726    3.8796    3.8878    3.8975    3.9085
    3.8661    3.8710    3.8769    3.8838    3.8920    3.9017    3.9126
    3.8704    3.8753    3.8811    3.8880    3.8962    3.9058    3.9167
    3.8747    3.8796    3.8854    3.8923    3.9004    3.9100    3.9208
    3.8789    3.8838    3.8896    3.8964    3.9046    3.9141    3.9249
    3.8832    3.8880    3.8938    3.9006    3.9087    3.9182    3.9290
    3.8874    3.8922    3.8980    3.9048    3.9128    3.9223    3.9330
    3.8916    3.8964    3.9021    3.9089    3.9169    3.9263    3.9370
    3.8958    3.9006    3.9063    3.9130    3.9210    3.9304    3.9410
    3.9000    3.9048    3.9104    3.9171    3.9251    3.9344    3.9450
    3.9042    3.9089    3.9145    3.9212    3.9291    3.9384    3.9490
    3.9083    3.9130    3.9186    3.9253    3.9332    3.9424    3.9530
    3.9124    3.9171    3.9227    3.9293    3.9372    3.9464    3.9569
    3.9165    3.9212    3.9268    3.9334    3.9412    3.9504    3.9608
    3.9206    3.9253    3.9308    3.9374    3.9452    3.9543    3.9648
    3.9247    3.9293    3.9349    3.9414    3.9492    3.9583    3.9686
    3.9287    3.9334    3.9389    3.9454    3.9531    3.9622    3.9725
    3.9328    3.9374    3.9429    3.9494    3.9571    3.9661    3.9764
    3.9368    3.9414    3.9469    3.9533    3.9610    3.9700    3.9803
    3.9408    3.9454    3.9508    3.9573    3.9649    3.9739    3.9841
    3.9448    3.9494    3.9548    3.9612    3.9688    3.9777    3.9879
    3.9488    3.9533    3.9587    3.9651    3.9727    3.9816    3.9917
    3.9527    3.9573    3.9626    3.9690    3.9766    3.9854    3.9955
    3.9567    3.9612    3.9665    3.9729    3.9804    3.9892    3.9993
    3.9606    3.9651    3.9704    3.9768    3.9843    3.9930    4.0031
    3.9645    3.9690    3.9743    3.9806    3.9881    3.9968    4.0068
    3.9684    3.9729    3.9782    3.9844    3.9919    4.0006    4.0106

  Column 15

   -0.8127
    0.5852
    0.8377
    1.0048
    1.1333
    1.2390
    1.3294
    1.4088
    1.4798
    1.5442
    1.6033
    1.6579
    1.7086
    1.7562
    1.8009
    1.8431
    1.8832
    1.9213
    1.9576
    1.9923
    2.0256
    2.0575
    2.0883
    2.1179
    2.1464
    2.1740
    2.2008
    2.2267
    2.2518
    2.2761
    2.2998
    2.3228
    2.3453
    2.3671
    2.3884
    2.4092
    2.4295
    2.4493
    2.4686
    2.4876
    2.5061
    2.5243
    2.5420
    2.5595
    2.5765
    2.5933
    2.6097
    2.6259
    2.6417
    2.6573
    2.6726
    2.6876
    2.7024
    2.7169
    2.7312
    2.7453
    2.7592
    2.7728
    2.7862
    2.7995
    2.8125
    2.8254
    2.8381
    2.8506
    2.8629
    2.8750
    2.8870
    2.8989
    2.9106
    2.9221
    2.9335
    2.9448
    2.9559
    2.9668
    2.9777
    2.9884
    2.9990
    3.0095
    3.0198
    3.0301
    3.0402
    3.0502
    3.0601
    3.0699
    3.0796
    3.0892
    3.0987
    3.1081
    3.1174
    3.1266
    3.1357
    3.1447
    3.1536
    3.1625
    3.1712
    3.1799
    3.1885
    3.1971
    3.2055
    3.2139
    3.2222
    3.2304
    3.2385
    3.2466
    3.2546
    3.2625
    3.2704
    3.2782
    3.2859
    3.2936
    3.3012
    3.3088
    3.3163
    3.3237
    3.3311
    3.3385
    3.3458
    3.3530
    3.3602
    3.3673
    3.3744
    3.3814
    3.3884
    3.3953
    3.4022
    3.4090
    3.4158
    3.4226
    3.4293
    3.4359
    3.4425
    3.4491
    3.4556
    3.4621
    3.4685
    3.4749
    3.4813
    3.4876
    3.4939
    3.5001
    3.5063
    3.5125
    3.5186
    3.5247
    3.5307
    3.5367
    3.5427
    3.5487
    3.5546
    3.5604
    3.5663
    3.5721
    3.5778
    3.5836
    3.5893
    3.5949
    3.6006
    3.6062
    3.6118
    3.6173
    3.6228
    3.6283
    3.6338
    3.6392
    3.6446
    3.6500
    3.6553
    3.6606
    3.6659
    3.6711
    3.6764
    3.6816
    3.6867
    3.6919
    3.6970
    3.7021
    3.7072
    3.7122
    3.7172
    3.7222
    3.7272
    3.7321
    3.7370
    3.7419
    3.7468
    3.7516
    3.7565
    3.7613
    3.7660
    3.7708
    3.7755
    3.7802
    3.7849
    3.7896
    3.7942
    3.7988
    3.8034
    3.8080
    3.8126
    3.8171
    3.8216
    3.8261
    3.8306
    3.8351
    3.8395
    3.8439
    3.8483
    3.8527
    3.8571
    3.8614
    3.8657
    3.8700
    3.8743
    3.8786
    3.8828
    3.8871
    3.8913
    3.8955
    3.8996
    3.9038
    3.9079
    3.9121
    3.9162
    3.9203
    3.9243
    3.9284
    3.9325
    3.9365
    3.9405
    3.9445
    3.9485
    3.9524
    3.9564
    3.9603
    3.9642
    3.9681
    3.9720
    3.9759
    3.9797
    3.9836
    3.9874
    3.9912
    3.9950
    3.9988
    4.0025
    4.0063
    4.0100
    4.0138
    4.0175
    4.0212

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 2nd Stage Optimization for Risky + Safe Asset (Saving Only) Interpolated-Percentage
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [mt_ev_condi_z_max, mt_ev_condi_z_max_idx, mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp] = ff_ipwkz_evf(varargin)
%% FF_IPWKZ_EVF solves the k' vs b' problem given aggregate savings
% This function follows the structure set up here:
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_wkz_evf.html
% ff_wkz_evf> but now we solve the second stage with percentage choice grid
%
% We solve along a vector of w_n vector, that is an interpolation vector,
% not a vector of actual w choices picked in the first stage. k' choices
% are in terms of percentages. Compared to ff_wkz_evf where we only had an
% upper triangle of choices, now we have a full matrix of percentage
% choices.
%
% @param mt_val matrix state_n I^2 by shock_n. This is the value
% matrix each row is a feasible reachable state given the choice
% vectors/matrix and each column is a shock state.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @return mt_ev_condi_z_max matrix choice_w_n by shock_n
% max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)) conditional on z and w, at the
% optimal k' choice (w=k'+b') what is the expected utility? This is the
% value result from the 2nd stage problem. Note the result integrates over
% z'.
%
% @return mt_ev_condi_z_max_idx matrix choice_w_n by shock_n this is the
% argmax from max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w)). Given the vector of k'
% choices, which index maximized conditional on z and w integrating over
% z'/
%
% @return mt_ev_condi_z_max_kp matrix choice_w_level_n by shock_n the k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @return mt_ev_condi_z_max_bp matrix choice_w_n by shock_n the b'=w-k'
% choice at max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_set_default_param.m ffs_ipwkz_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkz/paramfunc/ffs_ipwkz_get_funcgrid.m ffs_ipwkz_get_funcgrid>
%

%% Default

if (~isempty(varargin))
    % override when called from outside
    [mt_val, param_map, support_map, armt_map] = varargin{:};
else
    clear all;
    close all;
    
    % Not default parameters, but parameters that generate defaults
    it_param_set = 4;
    bl_input_override = true;
    [param_map, support_map] = ffs_ipwkz_set_default_param(it_param_set);
    
    support_map('bl_graph_evf') = true;
    support_map('bl_display_evf') = true;
    
    param_map('it_ak_perc_n') = 250;
    param_map('fl_w_interp_grid_gap') = (param_map('fl_w_max')-param_map('fl_b_bd'))/param_map('it_ak_perc_n');
    
    [armt_map, func_map] = ffs_ipwkz_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generating Defaults
    params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha', 'ar_z'});
    [ar_a_meshk, ar_k_mesha, ar_z] = params_group{:};
    params_group = values(func_map, {'f_util_standin'});
    [f_util_standin] = params_group{:};
    mt_val = f_util_standin(ar_z, ar_a_meshk, ar_k_mesha);
end

%% Parse Parameters
params_group = values(armt_map, {'mt_z_trans', 'ar_z',...
    'ar_w_level', 'ar_k_mesha', 'ar_a_meshk', 'mt_k'});
[mt_z_trans, ar_z, ar_w_level, ...
    ar_k_mesha, ar_a_meshk, mt_k] = params_group{:};
params_group = values(param_map, {'it_z_n', 'fl_nan_replace', 'fl_b_bd'});
[it_z_n, fl_nan_replace, fl_b_bd] = params_group{:};
params_group = values(support_map, {'bl_graph_onebyones','bl_display_evf', 'bl_graph_evf'});
[bl_graph_onebyones, bl_display_evf, bl_graph_evf] = params_group{:};
params_group = values(support_map, {'bl_img_save', 'st_img_path', 'st_img_prefix', 'st_img_name_main', 'st_img_suffix'});
[bl_img_save, st_img_path, st_img_prefix, st_img_name_main, st_img_suffix] = params_group{:};

% append function name
st_func_name = 'ff_ipwkz_evf';
st_img_name_main = [st_func_name st_img_name_main];

%% Integrate *E(V(coh(k',b'), z')|z, w)*
% Each column for a different state z, each value *E(V(coh,z')|z)* integrated already
% Here, each column is a current z, more to right higher EV
% dim(mt_ev_condi_z): *Q by M*
% Note that: mt_ev_condi_z = mt_val*mt_z_trans' is a mistake, that would be
% what we do in the
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_set_functions.html
% ffs_ipwkz_set_functions> code where we loop over current z, and for each
% current z, grab out a particular row from the mt_z_trans that corresponds
% to a current shock's transition into all future states.
%
% here, each column of mt_val corresponds to a state z, think of that as
% future state z. The input mt_val is *V(coh, z)*, we need to integrate to
% get *E(V(coh,z')|z)*.
%

mt_ev_condi_z = mt_val*mt_z_trans';
if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z: Q by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z));
    disp(head(array2table(mt_ev_condi_z), 20));
    disp(tail(array2table(mt_ev_condi_z), 20));    
end

%% Reshape *E(V(coh,z'|z,w))* to allow for maxing
% dim(mt_ev_condi_z): *IxJ by M*

[it_mt_bp_rown, it_mt_bp_coln] = size(mt_k);
mt_ev_condi_z_full = reshape(mt_ev_condi_z, [it_mt_bp_rown, it_mt_bp_coln*it_z_n]);

%% Maximize *max_{k'}(E(V(coh(k',b'=w-k'),z'|z,w))* optimal value and index
% Maximization, find optimal k'/b' combination given z and w=k'+b'

[ar_ev_condi_z_max, ar_ev_condi_z_max_idx] = max(mt_ev_condi_z_full);
mt_ev_condi_z_max = reshape(ar_ev_condi_z_max, [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_idx = reshape(ar_ev_condi_z_max_idx, [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_full: J by IxM');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_full));
%     disp(head(array2table(mt_ev_condi_z_full), 20));
%     disp(tail(array2table(mt_ev_condi_z_full), 20));
        
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max));
    disp(head(array2table(mt_ev_condi_z_max), 20));
    disp(tail(array2table(mt_ev_condi_z_max), 20));
    

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));
end

%% Reindex K' and B' Choices for each State at the Optimal *w'=k'+b'* choice
% The K' and B' Optimal Choices Associated with EV opti
% dim(mt_ev_condi_z_max_kp): *I by M*
ar_add_grid = linspace(0, it_mt_bp_rown*(it_mt_bp_coln-1), it_mt_bp_coln);
mt_ev_condi_z_max_idx = mt_ev_condi_z_max_idx + ar_add_grid';

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_idx: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_idx));
    disp(head(array2table(mt_ev_condi_z_max_idx), 20));
    disp(tail(array2table(mt_ev_condi_z_max_idx), 20));    
end

mt_ev_condi_z_max_kp = reshape(ar_k_mesha(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);
mt_ev_condi_z_max_bp = reshape(ar_a_meshk(mt_ev_condi_z_max_idx), [it_mt_bp_coln, it_z_n]);

if(bl_display_evf)
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_kp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_kp));
    disp(head(array2table(mt_ev_condi_z_max_kp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_kp), 20));        
    
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_ev_condi_z_max_bp: I by M');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_ev_condi_z_max_bp));
    disp(head(array2table(mt_ev_condi_z_max_bp), 20));
    disp(tail(array2table(mt_ev_condi_z_max_bp), 20));    
end

%% Graph

if (bl_graph_evf)
    
    %% Graph 1, V and EV
    if (~bl_graph_onebyones)
        figure('PaperPosition', [0 0 14 4]);
        hold on;
    end
    
    
    for subplot_j=1:1:2
        
        if (~bl_graph_onebyones)
            hAxis(subplot_j) = subplot(1,2,subplot_j);
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (subplot_j==1)
            chart = plot(mt_val);
        end
        if (subplot_j==2)
            chart = plot(mt_ev_condi_z);
        end
        
        clr = jet(numel(chart));
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legend(chart(legend2plot), legendCell(legend2plot), 'Location','southeast');
        
        if (subplot_j==1)
            title('V(coh,zp); w(k+b),k,z');
        end
        if (subplot_j==2)
            title('E_z(V(coh,zp|z))');
        end
        
        ylabel('Next Period Value');
        xlabel({'Index of Cash-on-Hand Discrete Point'...
            'Each Segment is a w=k+b; within segment increasing k'...
            'EV and V identical if shock is fully persistent'});
        grid on;
        grid minor;
    end
    
    % Share y axis
    if (~bl_graph_onebyones)
        linkaxes(hAxis,'y');
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_vev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 2, max(EV)
    
    if(~bl_graph_onebyones)
        figure('PaperPosition', [0 0 7 4]);
    end
    
    for sub_j=1:1:1
        
        if(sub_j==1)
            mt_outcome = mt_ev_condi_z_max;
            st_y_label = 'max_{k''}(E(V(coh(k'',b''=w-k''),z''|z,w))';
        end
        
        if(~bl_graph_onebyones)
            subplot(1,1,sub_j)
        else
            figure('PaperPosition', [0 0 7 4]);
        end
        hold on;
        
        ar_it_z_graph = ([1 round((it_z_n)/4) round(2*((it_z_n)/4)) round(3*((it_z_n)/4)) (it_z_n)]);
        clr = jet(length(ar_it_z_graph));
        i_ctr = 0;
        for i = ar_it_z_graph
            i_ctr = i_ctr + 1;
            ar_x = ar_w_level;
            ar_y = mt_outcome(:, i);
            scatter(ar_x, ar_y, 5, ...
                'MarkerEdgeColor', clr(i_ctr,:), ...
                'MarkerFaceColor', clr(i_ctr,:));
        end
        
        grid on;
        grid minor;
        title(['2nd Stage Exp Value at Optimal K given W=K''+B'''])
        ylabel(st_y_label)
        xlabel({'Aggregate Savings'})
        
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        legendCell{length(legendCell) + 1} = 'max-agg-save';
        legend(legendCell([ar_it_z_graph length(legendCell)]), 'Location','southeast');
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxev' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 3, at max(EV) optimal choice category, color regions, borrow save
    
    % Borrow Vs Save
    [ar_z_mw, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
    mt_it_riskyhalf_idx = ((mt_ev_condi_z_max_kp./mt_ev_condi_z_max_bp) > 0.5);
    mt_it_kzero_idx = (mt_ev_condi_z_max_kp == 0);
    mt_it_isnan_idx = (isnan(mt_ev_condi_z_max_kp));
    
    figure('PaperPosition', [0 0 7 4]);
    % States: ar_w, ar_z
    % Choices: mt_ev_condi_z_max_kp, mt_ev_condi_z_max_bp
    hold on;
    it_sca_size = 10;
    chart_br = scatter(ar_w_mz(mt_it_borr_idx),...
        ar_z_mw(mt_it_borr_idx),...
        it_sca_size, 'blue', 'filled');
    %     legend([chart_br], {'Borrow'}, 'Location','northeast');
    chart_khalf = scatter(ar_w_mz(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & mt_it_riskyhalf_idx),...
        it_sca_size, 'black', 'filled');
    %     legend([chart_khalf], {'Save >0.5 K'}, 'Location','northeast');
    chart_sv = scatter(ar_w_mz(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        ar_z_mw(~mt_it_borr_idx & ~mt_it_riskyhalf_idx),...
        it_sca_size, 'red', 'filled');
    %     legend([chart_sv], {'Save <0.5 K'}, 'Location','northeast');
    chart_invalid = scatter(ar_w_mz(mt_it_kzero_idx | mt_it_isnan_idx),...
        ar_z_mw(mt_it_kzero_idx | mt_it_isnan_idx),...
        it_sca_size, 'yellow', 'filled');
    legend([chart_br, chart_khalf, chart_sv, chart_invalid], ...
        {'Borrow','Save >0.5 K','Save <0.5 K', 'k=0 or k=nan'}, 'Location','northeast');
    title('Borrow and Save Regions')
    ylabel('Shocks')
    xlabel({'Total Savings w=k+b'})
    grid on;
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_maxbrsv' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
    %% Graph 4, Optimal K' and B' Levels
    
    [~, ar_w_mz] = meshgrid(ar_z, ar_w_level);
    for sub_j=1:1:4
        
        if (bl_graph_onebyones)
            figure('PaperPosition', [0 0 7 4]);
        end
        
        if (sub_j==1)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j);
            end
            mt_y = mt_ev_condi_z_max_bp;
        end
        if (sub_j==2)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j);
            end
            
            mt_y = mt_ev_condi_z_max_kp;
        end
        if (sub_j==3)
            if(~bl_graph_onebyones)
                figure('PaperPosition', [0 0 14 4]);
                subplot(1,2,sub_j-2);
            end
            mt_y = zeros(size(mt_ev_condi_z_max_bp));
            mt_it_borr_idx = (mt_ev_condi_z_max_bp < 0);
            mt_y(mt_it_borr_idx) = -mt_ev_condi_z_max_bp(mt_it_borr_idx)/fl_b_bd;
            mt_y(~mt_it_borr_idx) = mt_ev_condi_z_max_bp(~mt_it_borr_idx)./ar_w_mz(~mt_it_borr_idx);
        end
        if (sub_j==4)
            if(~bl_graph_onebyones)
                subplot(1,2,sub_j-2);
            end
            mt_y = mt_ev_condi_z_max_kp./(ar_w_level'-fl_b_bd);
        end
        
        hold on;
        chart = plot(ar_w_level, mt_y);
        clr = jet(numel(chart));
        
        if (length(ar_w_level) <= 100)
            scatter(ar_w_mz(:), mt_y(:), 3, 'filled', 'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
        end
        
        for m = 1:numel(chart)
            set(chart(m),'Color',clr(m,:))
        end
        legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/3)  numel(chart)]);
        legendCell = cellstr(num2str(ar_z', 'shock=%3.2f'));
        
        xline0 = xline(0);
        xline0.HandleVisibility = 'off';
        yline0 = yline(0);
        yline0.HandleVisibility = 'off';
        grid on;
        if (sub_j<=2)
            hline = refline([1 0]);
            hline.Color = 'k';
            hline.LineStyle = ':';
            hline.HandleVisibility = 'off';
        end
        
        if (sub_j==1)
            title('B Choices of W');
            ylabel('B Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==2)
            title('K Choices of W');
            ylabel('K Choices');
            xlabel({'Total Savings w=k+b'});
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        
        if (sub_j==3)
            title('B Fraction of Borrow Max and Save');
            ylabel('B/bar(B) if br or B/W if sv');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([-1.1 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northwest');
        end
        if (sub_j==4)
            title('K Fraction Choices of Total K Possible');
            ylabel('K/(W-bar(b)) ');
            xlabel({'Total Savings w=k+b'});
            %             set(gca, 'YScale', 'log');
            ylim([0 1.1]);
            legend(chart(legend2plot), legendCell(legend2plot), 'Location','northeast');
        end
        
    end
    
    % save file
    if (bl_img_save)
        mkdir(support_map('st_img_path'));
        st_file_name = [st_img_prefix st_img_name_main '_wkbopti' st_img_suffix];
        saveas(gcf, strcat(st_img_path, st_file_name));
    end
    
end

end

##### SOURCE END #####
--></body></html>