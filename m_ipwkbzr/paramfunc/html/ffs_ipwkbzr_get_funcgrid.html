
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Generate States/Choices/Shocks Grids, get Functions (Interpolated + Percentage + Risky + Safe Asset + Save + Borrow + R Shock)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-07-14"><meta name="DC.source" content="ffs_ipwkbzr_get_funcgrid.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Generate States/Choices/Shocks Grids, get Functions (Interpolated + Percentage + Risky + Safe Asset + Save + Borrow + R Shock)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FFS_IPWKBZR_GET_FUNCGRID get funcs, params, states choices shocks grids</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1a</a></li><li><a href="#5">Parse Parameters 1b</a></li><li><a href="#6">Parse Parameters 2</a></li><li><a href="#7">Parse Parameters 3</a></li><li><a href="#8">G: Generate Asset and Choice Grid for 2nd stage Problem</a></li><li><a href="#9">F1: Get Shock: Income Shock (ar1)</a></li><li><a href="#10">F2: Get Shock: Interest Rate Shock (iid)</a></li><li><a href="#11">F3: Get Shock: Mesh Shocks Together</a></li><li><a href="#12">Get Equations</a></li><li><a href="#13">Generate Cash-on-Hand/State Matrix</a></li><li><a href="#14">Check if COH is within Borrowing Bounds</a></li><li><a href="#15">Update Valid 2nd stage choice matrix</a></li><li><a href="#16">Generate 2nd Stage Cash-on-Hand Points for Interpolation</a></li><li><a href="#17">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#18">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</a></li><li><a href="#19">Generate Interpolation Consumption Grid</a></li><li><a href="#20">Initialize armt_map to store, state, choice, shock matrixes</a></li><li><a href="#21">Store armt_map (1): base arrays</a></li><li><a href="#22">Store armt_map (2): 1st stage level coh on hand related arrays</a></li><li><a href="#23">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</a></li><li><a href="#24">Store armt_map (4): 2nd stage additional arrays</a></li><li><a href="#25">Store armt_map (5): Shock Grids Arrays and Mesh</a></li><li><a href="#26">Store Function Map</a></li><li><a href="#27">Graph</a></li><li><a href="#29">Generate Limited Legends</a></li><li><a href="#30">Graph 1: a and k choice grid graphs</a></li><li><a href="#31">Graph 2: coh by shock</a></li><li><a href="#32">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</a></li><li><a href="#34">Graph Details, Generally do Not Run</a></li><li><a href="#36">Graph 1: 2nd stage coh reached by k' b' choices by index</a></li><li><a href="#37">Graph 2: 2nd stage coh reached by k' b' choices  by coh</a></li><li><a href="#39">Display</a></li><li><a href="#40">Display</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(varargin)
</pre><h2 id="2">FFS_IPWKBZR_GET_FUNCGRID get funcs, params, states choices shocks grids</h2><p>centralized gateway for retrieving parameters, and solution grids and functions. Similar to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a> function. This code deals with problems with savings and borrowing.</p><p>This file is a continuation of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_get_funcgrid.html">ffs_ipwkz_get_funcgrid</a>. A significant change here is the inclusion of borrowing shocks, which changes significantly the implementation of the two-stage solution structure. Specifically, for the coh matrix here, there is another dimension which is the borrowing interest rate shock states, which expands the number of cash-on-hand points given the same productivity shock z. So compared to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_get_funcgrid.html">ffs_ipwkz_get_funcgrid</a>, the same number of columns for the <i>mt_coh_wkb_full</i> matirx, but more rows.</p><p>Note that for borrowing, we can not start at the min(coh(k,w-k,z)) reacheable given the w and k choice grids. That would be: min(coh(k,w-k,z)) &lt; min(w). At min(coh), there is a single point, and also for all values between min(coh) and min(w), all percentage w_perc choices are below min(w), requiring extrapolation. It is in some sense safer to extrapolate by starting solution at min(coh) = min(w). Now, for the lowest levels of coh(k, w-k, z), which are &lt; min(w), we now require extrapolation. But this extrapolation is straight forward, when coh &lt; min(w), households have to default, the utility from default is the same regardless of the level of coh at the time of default. So nearest extrapolation is fully correct.</p><p>Note that the first stage w grid is based on cash-on-hand level reached by the coh(k,w-k,z) possible choice and shock combinations. This coh(k,w-k,z) &gt; max(w), which also means that at max(coh) grid, the w_perc choices at higher points require extrapolation. Extrapolation is based on nearest extrapolation.</p><p>Note that even when w = 0, as long as interest rate is low, only the lowest level of borrowing is invalid.</p><p>All discussion of of the word <i>wage</i> refers to productivity shock.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param bl_input_override boolean if true varargin contained param_map and support_map fully overrides local default. Local default is not invoked. This could be important for speed if this function is getting invoked within certain loops. Default is 0.</p><p>@return armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm. Contains these:</p><p><b>armt_map</b> base arrays:</p><div><ol><li>ar_interp_c_grid: 1 by I^c</li><li>ar_interp_coh_grid: 1 by I^{coh}</li><li>ar_w_level: 1 by I^{W=k+b}</li><li>ar_w_perc: 1 by P^{W=k+b}</li><li>ar_ak_perc: 1 by P^{k and b}</li></ol></div><p><b>armt_map</b> 1st stage level coh on hand related arrays:</p><div><ol><li>mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w</li><li>mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w</li><li>mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}</li><li>mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}</li></ol></div><p><b>armt_map</b> 2nd stage reachable coh(k(w), a(w,k), z', r)</p><div><ol><li>mt_coh_wkb: (I^k x I^w x M^r) by (M^z)</li><li>mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)</li></ol></div><p><b>armt_map</b> 2nd stage additional arrays</p><div><ol><li>mt_k: (I^w) by (P^{k and b})</li><li>ar_a_meshk: 1 by (I^w x P^{k and b})</li><li>ar_k_mesha: 1 by (I^w x P^{k and b})</li><li>ar_aplusk_mesh: 1 by (I^w x P^{k and b})</li><li>it_ameshk_n: scalar</li></ol></div><p><b>armt_map</b> Shock Grids Arrays and Mesh</p><div><ol><li>ar_z_r_borr: 1 by (M^r)</li><li>ar_z_r_borr_prob: 1 by (M^r)</li><li>ar_z_wage: 1 by (M^z)</li><li>ar_z_wage_prob: 1 by (M^z)</li><li>ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)</li><li>ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)</li><li>ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)</li><li>ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)</li></ol></div><p>@return func_map container container with function handles for consumption cash-on-hand etc.</p><p>@example</p><pre>  it_param_set = 2;
  bl_input_override = true;
  [param_map, support_map] = ffs_ipwkbzr_set_default_param(it_param_set);
  [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map, bl_input_override);</pre><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_set_functions.m">ffs_ipwkbzr_set_functions</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/ffto_gen_tauchen_jhl.m">ffto_gen_tauchen_jhl</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/fft_gen_grid_loglin.m">fft_gen_grid_loglin</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))

    <span class="comment">% override when called from outside</span>
    [param_map, support_map] = varargin{:};

<span class="keyword">else</span>

    close <span class="string">all</span>;
    <span class="comment">% default internal run</span>
    [param_map, support_map] = ffs_ipwkbzr_set_default_param();

    support_map(<span class="string">'bl_graph_funcgrids'</span>) = true;
    support_map(<span class="string">'bl_graph_funcgrids_detail'</span>) = true;
    bl_display_funcgrids = true;
    support_map(<span class="string">'bl_display_funcgrids'</span>) = bl_display_funcgrids;

    st_param_which = <span class="string">'medium'</span>;

    <span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>]))

        param_map(<span class="string">'it_ak_perc_n'</span>) = 250;

    <span class="keyword">elseif</span> (ismember(st_param_which, [<span class="string">'medium'</span>]))

        <span class="comment">% to be able to visually see choice grid points</span>
        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 25;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 45;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 2;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 2;

<span class="comment">%         param_map('fl_z_r_borr_min') = 0.025;</span>
<span class="comment">%         param_map('fl_z_r_borr_max') = 0.95;</span>
<span class="comment">%         param_map('fl_z_r_borr_n') = 3;</span>

        param_map(<span class="string">'fl_z_r_borr_min'</span>) = 0.025;
        param_map(<span class="string">'fl_z_r_borr_max'</span>) = 0.95;
        param_map(<span class="string">'fl_z_r_borr_n'</span>) = 3;

    <span class="keyword">elseif</span> (strcmp(st_param_which, <span class="string">'small'</span>))

        param_map(<span class="string">'fl_z_r_borr_n'</span>) = 2;
        param_map(<span class="string">'it_z_wage_n'</span>) = 3;

        param_map(<span class="string">'fl_b_bd'</span>) = -20; <span class="comment">% borrow bound, = 0 if save only</span>
        param_map(<span class="string">'fl_default_aprime'</span>) = 0;
        param_map(<span class="string">'bl_default'</span>) = 0; <span class="comment">% if borrowing is default allowed</span>

        param_map(<span class="string">'fl_w_min'</span>) = param_map(<span class="string">'fl_b_bd'</span>);
        param_map(<span class="string">'it_w_perc_n'</span>) = 5;
        param_map(<span class="string">'it_ak_perc_n'</span>) = 6;

        param_map(<span class="string">'fl_w_interp_grid_gap'</span>) = 3;
        param_map(<span class="string">'fl_coh_interp_grid_gap'</span>) = 3;

        param_map(<span class="string">'fl_z_r_borr_min'</span>) = 0.025;
        param_map(<span class="string">'fl_z_r_borr_max'</span>) = 0.95;
        param_map(<span class="string">'fl_z_r_borr_n'</span>) = 3;

    <span class="keyword">end</span>

    param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);

    default_maps = {param_map, support_map};

    <span class="comment">% numvarargs is the number of varagin inputted</span>
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];

    <span class="comment">% Display Parameters</span>
    <span class="keyword">if</span> (bl_display_funcgrids)
        fft_container_map_display(param_map);
        fft_container_map_display(support_map);
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display Parameters Specific to IPWKBZR
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 13
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = fl_z_r_borr_max ; val = 0.095
pos = 2 ; key = fl_z_r_borr_min ; val = 0.025
pos = 3 ; key = fl_z_r_borr_n ; val = 5
pos = 4 ; key = fl_z_r_borr_poiss_mean ; val = 20
pos = 5 ; key = fl_z_wage_mu ; val = 0
pos = 6 ; key = fl_z_wage_rho ; val = 0.8
pos = 7 ; key = fl_z_wage_sig ; val = 0.2
pos = 8 ; key = it_z_n ; val = 75
pos = 9 ; key = it_z_wage_n ; val = 15
pos = 10 ; key = st_model ; val = ipwkbzr
pos = 11 ; key = st_v_coh_z_interp_method ; val = method_cell
pos = 12 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 13 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i    idx    value
                              _    ___    _____

    fl_z_r_borr_max           1     1     0.095
    fl_z_r_borr_min           2     2     0.025
    fl_z_r_borr_n             3     3         5
    fl_z_r_borr_poiss_mean    4     4        20
    fl_z_wage_mu              5     5         0
    fl_z_wage_rho             6     6       0.8
    fl_z_wage_sig             7     7       0.2
    it_z_n                    8     8        75
    it_z_wage_n               9     9        15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                i    idx
                                _    ___

    st_model                    1    10 
    st_v_coh_z_interp_method    2    11 
    st_z_r_borr_drv_ele_type    3    12 
    st_z_r_borr_drv_prb_type    4    13 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 4
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/img/
pos = 2 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/mat/
pos = 3 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr/
pos = 4 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/profile/
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                           i    idx
                           _    ___

    st_img_path            1     1 
    st_mat_path            2     2 
    st_matimg_path_root    3     3 
    st_profile_path        4     4 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Display All Parameters with IPWKBZR overriding IPWKBZR
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 41
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_default ; val = true
pos = 2 ; key = fl_Amean ; val = 1
pos = 3 ; key = fl_alpha ; val = 0.36
pos = 4 ; key = fl_b_bd ; val = -20
pos = 5 ; key = fl_beta ; val = 0.94
pos = 6 ; key = fl_c_min ; val = 0.02
pos = 7 ; key = fl_coh_interp_grid_gap ; val = 0.1
pos = 8 ; key = fl_crra ; val = 1.5
pos = 9 ; key = fl_default_wprime ; val = 0
pos = 10 ; key = fl_delta ; val = 0.08
pos = 11 ; key = fl_k_max ; val = 70
pos = 12 ; key = fl_k_min ; val = 0
pos = 13 ; key = fl_nan_replace ; val = -9999
pos = 14 ; key = fl_r_save ; val = 0.025
pos = 15 ; key = fl_tol_dist ; val = 1e-05
pos = 16 ; key = fl_tol_pol ; val = 1e-05
pos = 17 ; key = fl_tol_val ; val = 1e-05
pos = 18 ; key = fl_w ; val = 0.44365
pos = 19 ; key = fl_w_interp_grid_gap ; val = 0.1
pos = 20 ; key = fl_w_max ; val = 50
pos = 21 ; key = fl_w_min ; val = -20
pos = 22 ; key = fl_z_r_borr_max ; val = 0.095
pos = 23 ; key = fl_z_r_borr_min ; val = 0.025
pos = 24 ; key = fl_z_r_borr_n ; val = 5
pos = 25 ; key = fl_z_r_borr_poiss_mean ; val = 20
pos = 26 ; key = fl_z_wage_mu ; val = 0
pos = 27 ; key = fl_z_wage_rho ; val = 0.8
pos = 28 ; key = fl_z_wage_sig ; val = 0.2
pos = 29 ; key = it_ak_perc_n ; val = 50
pos = 30 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 31 ; key = it_maxiter_dist ; val = 1000
pos = 32 ; key = it_maxiter_val ; val = 250
pos = 33 ; key = it_tol_pol_nochange ; val = 25
pos = 34 ; key = it_w_perc_n ; val = 50
pos = 35 ; key = it_z_n ; val = 75
pos = 36 ; key = it_z_wage_n ; val = 15
pos = 37 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 38 ; key = st_model ; val = ipwkbzr
pos = 39 ; key = st_v_coh_z_interp_method ; val = method_cell
pos = 40 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 41 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx     value 
                              __    ___    _______

    bl_default                 1     1           1
    fl_Amean                   2     2           1
    fl_alpha                   3     3        0.36
    fl_b_bd                    4     4         -20
    fl_beta                    5     5        0.94
    fl_c_min                   6     6        0.02
    fl_coh_interp_grid_gap     7     7         0.1
    fl_crra                    8     8         1.5
    fl_default_wprime          9     9           0
    fl_delta                  10    10        0.08
    fl_k_max                  11    11          70
    fl_k_min                  12    12           0
    fl_nan_replace            13    13       -9999
    fl_r_save                 14    14       0.025
    fl_tol_dist               15    15       1e-05
    fl_tol_pol                16    16       1e-05
    fl_tol_val                17    17       1e-05
    fl_w                      18    18     0.44365
    fl_w_interp_grid_gap      19    19         0.1
    fl_w_max                  20    20          50
    fl_w_min                  21    21         -20
    fl_z_r_borr_max           22    22       0.095
    fl_z_r_borr_min           23    23       0.025
    fl_z_r_borr_n             24    24           5
    fl_z_r_borr_poiss_mean    25    25          20
    fl_z_wage_mu              26    26           0
    fl_z_wage_rho             27    27         0.8
    fl_z_wage_sig             28    28         0.2
    it_ak_perc_n              29    29          50
    it_c_interp_grid_gap      30    30      0.0001
    it_maxiter_dist           31    31        1000
    it_maxiter_val            32    32         250
    it_tol_pol_nochange       33    33          25
    it_w_perc_n               34    34          50
    it_z_n                    35    35          75
    it_z_wage_n               36    36          15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    37 
    st_model                         2    38 
    st_v_coh_z_interp_method         3    39 
    st_z_r_borr_drv_ele_type         4    40 
    st_z_r_borr_drv_prb_type         5    41 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 42
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = true
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = false
pos = 9 ; key = bl_graph ; val = true
pos = 10 ; key = bl_graph_coh_t_coh ; val = true
pos = 11 ; key = bl_graph_evf ; val = false
pos = 12 ; key = bl_graph_funcgrids ; val = false
pos = 13 ; key = bl_graph_funcgrids_detail ; val = false
pos = 14 ; key = bl_graph_onebyones ; val = true
pos = 15 ; key = bl_graph_pol_lvl ; val = true
pos = 16 ; key = bl_graph_pol_pct ; val = true
pos = 17 ; key = bl_graph_val ; val = true
pos = 18 ; key = bl_img_save ; val = false
pos = 19 ; key = bl_mat ; val = false
pos = 20 ; key = bl_post ; val = true
pos = 21 ; key = bl_profile ; val = false
pos = 22 ; key = bl_profile_dist ; val = false
pos = 23 ; key = bl_time ; val = false
pos = 24 ; key = it_display_every ; val = 5
pos = 25 ; key = it_display_final_colmax ; val = 12
pos = 26 ; key = it_display_final_rowmax ; val = 100
pos = 27 ; key = it_display_summmat_colmax ; val = 5
pos = 28 ; key = it_display_summmat_rowmax ; val = 5
pos = 29 ; key = st_img_name_main ; val = _default
pos = 30 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/img/
pos = 31 ; key = st_img_prefix ; val = 
pos = 32 ; key = st_img_suffix ; val = _p4.png
pos = 33 ; key = st_mat_name_main ; val = _default
pos = 34 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/mat/
pos = 35 ; key = st_mat_prefix ; val = 
pos = 36 ; key = st_mat_suffix ; val = _p4
pos = 37 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr/
pos = 38 ; key = st_profile_name_main ; val = _default
pos = 39 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/profile/
pos = 40 ; key = st_profile_prefix ; val = 
pos = 41 ; key = st_profile_suffix ; val = _p4
pos = 42 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_evf                   4     4        0 
    bl_display_final                 5     5        1 
    bl_display_final_dist            6     6        0 
    bl_display_final_dist_detail     7     7        0 
    bl_display_funcgrids             8     8        0 
    bl_graph                         9     9        1 
    bl_graph_coh_t_coh              10    10        1 
    bl_graph_evf                    11    11        0 
    bl_graph_funcgrids              12    12        0 
    bl_graph_funcgrids_detail       13    13        0 
    bl_graph_onebyones              14    14        1 
    bl_graph_pol_lvl                15    15        1 
    bl_graph_pol_pct                16    16        1 
    bl_graph_val                    17    17        1 
    bl_img_save                     18    18        0 
    bl_mat                          19    19        0 
    bl_post                         20    20        1 
    bl_profile                      21    21        0 
    bl_profile_dist                 22    22        0 
    bl_time                         23    23        0 
    it_display_every                24    24        5 
    it_display_final_colmax         25    25       12 
    it_display_final_rowmax         26    26      100 
    it_display_summmat_colmax       27    27        5 
    it_display_summmat_rowmax       28    28        5 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    29 
    st_img_path              2    30 
    st_img_prefix            3    31 
    st_img_suffix            4    32 
    st_mat_name_main         5    33 
    st_mat_path              6    34 
    st_mat_prefix            7    35 
    st_mat_suffix            8    36 
    st_matimg_path_root      9    37 
    st_profile_name_main    10    38 
    st_profile_path         11    39 
    st_profile_prefix       12    40 
    st_profile_suffix       13    41 
    st_title_prefix         14    42 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 42
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_default ; val = 0
pos = 2 ; key = fl_Amean ; val = 1
pos = 3 ; key = fl_alpha ; val = 0.36
pos = 4 ; key = fl_b_bd ; val = -20
pos = 5 ; key = fl_beta ; val = 0.94
pos = 6 ; key = fl_c_min ; val = 0.02
pos = 7 ; key = fl_coh_interp_grid_gap ; val = 2
pos = 8 ; key = fl_crra ; val = 1.5
pos = 9 ; key = fl_default_aprime ; val = 0
pos = 10 ; key = fl_default_wprime ; val = 0
pos = 11 ; key = fl_delta ; val = 0.08
pos = 12 ; key = fl_k_max ; val = 70
pos = 13 ; key = fl_k_min ; val = 0
pos = 14 ; key = fl_nan_replace ; val = -9999
pos = 15 ; key = fl_r_save ; val = 0.025
pos = 16 ; key = fl_tol_dist ; val = 1e-05
pos = 17 ; key = fl_tol_pol ; val = 1e-05
pos = 18 ; key = fl_tol_val ; val = 1e-05
pos = 19 ; key = fl_w ; val = 0.44365
pos = 20 ; key = fl_w_interp_grid_gap ; val = 2
pos = 21 ; key = fl_w_max ; val = 50
pos = 22 ; key = fl_w_min ; val = -20
pos = 23 ; key = fl_z_r_borr_max ; val = 0.95
pos = 24 ; key = fl_z_r_borr_min ; val = 0.025
pos = 25 ; key = fl_z_r_borr_n ; val = 3
pos = 26 ; key = fl_z_r_borr_poiss_mean ; val = 20
pos = 27 ; key = fl_z_wage_mu ; val = 0
pos = 28 ; key = fl_z_wage_rho ; val = 0.8
pos = 29 ; key = fl_z_wage_sig ; val = 0.2
pos = 30 ; key = it_ak_perc_n ; val = 45
pos = 31 ; key = it_c_interp_grid_gap ; val = 0.0001
pos = 32 ; key = it_maxiter_dist ; val = 1000
pos = 33 ; key = it_maxiter_val ; val = 250
pos = 34 ; key = it_tol_pol_nochange ; val = 25
pos = 35 ; key = it_w_perc_n ; val = 25
pos = 36 ; key = it_z_n ; val = 45
pos = 37 ; key = it_z_wage_n ; val = 15
pos = 38 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 39 ; key = st_model ; val = ipwkbzr
pos = 40 ; key = st_v_coh_z_interp_method ; val = method_cell
pos = 41 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 42 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx     value 
                              __    ___    _______

    bl_default                 1     1           0
    fl_Amean                   2     2           1
    fl_alpha                   3     3        0.36
    fl_b_bd                    4     4         -20
    fl_beta                    5     5        0.94
    fl_c_min                   6     6        0.02
    fl_coh_interp_grid_gap     7     7           2
    fl_crra                    8     8         1.5
    fl_default_aprime          9     9           0
    fl_default_wprime         10    10           0
    fl_delta                  11    11        0.08
    fl_k_max                  12    12          70
    fl_k_min                  13    13           0
    fl_nan_replace            14    14       -9999
    fl_r_save                 15    15       0.025
    fl_tol_dist               16    16       1e-05
    fl_tol_pol                17    17       1e-05
    fl_tol_val                18    18       1e-05
    fl_w                      19    19     0.44365
    fl_w_interp_grid_gap      20    20           2
    fl_w_max                  21    21          50
    fl_w_min                  22    22         -20
    fl_z_r_borr_max           23    23        0.95
    fl_z_r_borr_min           24    24       0.025
    fl_z_r_borr_n             25    25           3
    fl_z_r_borr_poiss_mean    26    26          20
    fl_z_wage_mu              27    27           0
    fl_z_wage_rho             28    28         0.8
    fl_z_wage_sig             29    29         0.2
    it_ak_perc_n              30    30          45
    it_c_interp_grid_gap      31    31      0.0001
    it_maxiter_dist           32    32        1000
    it_maxiter_val            33    33         250
    it_tol_pol_nochange       34    34          25
    it_w_perc_n               35    35          25
    it_z_n                    36    36          45
    it_z_wage_n               37    37          15

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                     i    idx
                                     _    ___

    st_analytical_stationary_type    1    38 
    st_model                         2    39 
    st_v_coh_z_interp_method         3    40 
    st_z_r_borr_drv_ele_type         4    41 
    st_z_r_borr_drv_prb_type         5    42 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 42
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = bl_display ; val = false
pos = 2 ; key = bl_display_defparam ; val = true
pos = 3 ; key = bl_display_dist ; val = false
pos = 4 ; key = bl_display_evf ; val = false
pos = 5 ; key = bl_display_final ; val = true
pos = 6 ; key = bl_display_final_dist ; val = false
pos = 7 ; key = bl_display_final_dist_detail ; val = false
pos = 8 ; key = bl_display_funcgrids ; val = true
pos = 9 ; key = bl_graph ; val = true
pos = 10 ; key = bl_graph_coh_t_coh ; val = true
pos = 11 ; key = bl_graph_evf ; val = false
pos = 12 ; key = bl_graph_funcgrids ; val = true
pos = 13 ; key = bl_graph_funcgrids_detail ; val = true
pos = 14 ; key = bl_graph_onebyones ; val = true
pos = 15 ; key = bl_graph_pol_lvl ; val = true
pos = 16 ; key = bl_graph_pol_pct ; val = true
pos = 17 ; key = bl_graph_val ; val = true
pos = 18 ; key = bl_img_save ; val = false
pos = 19 ; key = bl_mat ; val = false
pos = 20 ; key = bl_post ; val = true
pos = 21 ; key = bl_profile ; val = false
pos = 22 ; key = bl_profile_dist ; val = false
pos = 23 ; key = bl_time ; val = false
pos = 24 ; key = it_display_every ; val = 5
pos = 25 ; key = it_display_final_colmax ; val = 12
pos = 26 ; key = it_display_final_rowmax ; val = 100
pos = 27 ; key = it_display_summmat_colmax ; val = 5
pos = 28 ; key = it_display_summmat_rowmax ; val = 5
pos = 29 ; key = st_img_name_main ; val = _default
pos = 30 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/img/
pos = 31 ; key = st_img_prefix ; val = 
pos = 32 ; key = st_img_suffix ; val = _p4.png
pos = 33 ; key = st_mat_name_main ; val = _default
pos = 34 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/mat/
pos = 35 ; key = st_mat_prefix ; val = 
pos = 36 ; key = st_mat_suffix ; val = _p4
pos = 37 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr/
pos = 38 ; key = st_profile_name_main ; val = _default
pos = 39 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/profile/
pos = 40 ; key = st_profile_prefix ; val = 
pos = 41 ; key = st_profile_suffix ; val = _p4
pos = 42 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_evf                   4     4        0 
    bl_display_final                 5     5        1 
    bl_display_final_dist            6     6        0 
    bl_display_final_dist_detail     7     7        0 
    bl_display_funcgrids             8     8        1 
    bl_graph                         9     9        1 
    bl_graph_coh_t_coh              10    10        1 
    bl_graph_evf                    11    11        0 
    bl_graph_funcgrids              12    12        1 
    bl_graph_funcgrids_detail       13    13        1 
    bl_graph_onebyones              14    14        1 
    bl_graph_pol_lvl                15    15        1 
    bl_graph_pol_pct                16    16        1 
    bl_graph_val                    17    17        1 
    bl_img_save                     18    18        0 
    bl_mat                          19    19        0 
    bl_post                         20    20        1 
    bl_profile                      21    21        0 
    bl_profile_dist                 22    22        0 
    bl_time                         23    23        0 
    it_display_every                24    24        5 
    it_display_final_colmax         25    25       12 
    it_display_final_rowmax         26    26      100 
    it_display_summmat_colmax       27    27        5 
    it_display_summmat_rowmax       28    28        5 

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Strings in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                            i     idx
                            __    ___

    st_img_name_main         1    29 
    st_img_path              2    30 
    st_img_prefix            3    31 
    st_img_suffix            4    32 
    st_mat_name_main         5    33 
    st_mat_path              6    34 
    st_mat_prefix            7    35 
    st_mat_suffix            8    36 
    st_matimg_path_root      9    37 
    st_profile_name_main    10    38 
    st_profile_path         11    39 
    st_profile_prefix       12    40 
    st_profile_suffix       13    41 
    st_title_prefix         14    42 

</pre><h2 id="4">Parse Parameters 1a</h2><pre class="codeinput">params_group = values(param_map, {<span class="string">'fl_b_bd'</span>, <span class="string">'fl_w_min'</span>, <span class="string">'fl_w_max'</span>});
[fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_c_min'</span>});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_Amean'</span>, <span class="string">'fl_alpha'</span>, <span class="string">'fl_delta'</span>});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {<span class="string">'fl_r_save'</span>, <span class="string">'fl_w'</span>});
[fl_r_save, fl_w] = params_group{:};
</pre><h2 id="5">Parse Parameters 1b</h2><pre class="codeinput">params_group = values(param_map, {<span class="keyword">...</span>
    <span class="string">'it_w_perc_n'</span>, <span class="string">'it_ak_perc_n'</span>,<span class="keyword">...</span>
    <span class="string">'it_c_interp_grid_gap'</span>, <span class="string">'fl_w_interp_grid_gap'</span>, <span class="string">'fl_coh_interp_grid_gap'</span>});
[it_w_perc_n, it_ak_perc_n,<span class="keyword">...</span>
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {<span class="string">'st_v_coh_z_interp_method'</span>});
[st_v_coh_z_interp_method] = params_group{:};
</pre><h2 id="6">Parse Parameters 2</h2><pre class="codeinput"><span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_wage_n'</span>, <span class="string">'fl_z_wage_mu'</span>, <span class="string">'fl_z_wage_rho'</span>, <span class="string">'fl_z_wage_sig'</span>});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

<span class="comment">% param_map shock borrowing interest</span>
params_group = values(param_map, {<span class="string">'st_z_r_borr_drv_ele_type'</span>, <span class="string">'st_z_r_borr_drv_prb_type'</span>, <span class="string">'fl_z_r_borr_poiss_mean'</span>, <span class="keyword">...</span>
    <span class="string">'fl_z_r_borr_max'</span>, <span class="string">'fl_z_r_borr_min'</span>, <span class="string">'fl_z_r_borr_n'</span>});
[st_z_r_borr_drv_ele_type, st_z_r_borr_drv_prb_type, fl_z_r_borr_poiss_mean, <span class="keyword">...</span>
    fl_z_r_borr_max, fl_z_r_borr_min, fl_z_r_borr_n] = params_group{:};

<span class="comment">% param_map shock income</span>
params_group = values(param_map, {<span class="string">'it_z_n'</span>});
[it_z_n] = params_group{:};
</pre><h2 id="7">Parse Parameters 3</h2><pre class="codeinput">params_group = values(support_map, {<span class="string">'bl_graph_funcgrids'</span>, <span class="string">'bl_graph_funcgrids_detail'</span>, <span class="string">'bl_display_funcgrids'</span>});
[bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="8">G: Generate Asset and Choice Grid for 2nd stage Problem</h2><p>This generate triangular choice structure. Household choose total aggregate savings, and within that how much to put into risky capital and how much to put into safe assets, in percentages. See <a href="https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_set_default_param.html">ffs_ipwkbzr_set_default_param</a> for details.</p><pre class="codeinput"><span class="comment">% percentage grid for 1st stage choice problem, level grid for 2nd stage</span>
<span class="comment">% solving optimal k given w and z.</span>
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = ((fl_w_max-fl_w_min)/(fl_w_interp_grid_gap));
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

<span class="comment">% max k given w, need to consider the possibility of borrowing.</span>
ar_k_max = ar_w_level_full - fl_b_bd;

<span class="comment">% k percentage choice grid</span>
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

<span class="comment">% 2nd stage percentage choice matrixes</span>
<span class="comment">% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n</span>
<span class="comment">% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'</span>
<span class="comment">% conditional on w, each column is a different w, each row for each col a</span>
<span class="comment">% different k' value.</span>
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

<span class="comment">% can not have choice that are beyond feasible bound given the percentage</span>
<span class="comment">% structure here.</span>
mt_bl_constrained = (mt_a &lt; fl_b_bd);
<span class="keyword">if</span> (sum(mt_bl_constrained) &gt; 0 )
    error(<span class="string">'at %s second stage choice points, percentage choice exceed bounds, can not happen'</span>,<span class="keyword">...</span>
        num2str(sum(mt_bl_constrained)));
<span class="keyword">end</span>

ar_a_meshk_full = mt_a(:);
ar_k_mesha_full = mt_k(:);

ar_a_meshk = ar_a_meshk_full;
ar_k_mesha = ar_k_mesha_full;
</pre><h2 id="9">F1: Get Shock: Income Shock (ar1)</h2><pre class="codeinput">[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);
</pre><h2 id="10">F2: Get Shock: Interest Rate Shock (iid)</h2><pre class="codeinput"><span class="comment">% get borrowing grid and probabilities</span>
param_dsv_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
param_dsv_map(<span class="string">'st_drv_ele_type'</span>) = st_z_r_borr_drv_ele_type;
param_dsv_map(<span class="string">'st_drv_prb_type'</span>) = st_z_r_borr_drv_prb_type;
param_dsv_map(<span class="string">'fl_poiss_mean'</span>) = fl_z_r_borr_poiss_mean;
param_dsv_map(<span class="string">'fl_max'</span>) = fl_z_r_borr_max;
param_dsv_map(<span class="string">'fl_min'</span>) = fl_z_r_borr_min;
param_dsv_map(<span class="string">'fl_n'</span>) = fl_z_r_borr_n;
[ar_z_r_borr, ar_z_r_borr_prob] = fft_gen_discrete_var(param_dsv_map, true);

<span class="comment">% iid transition matrix</span>
mt_z_r_borr_prob_trans = repmat(ar_z_r_borr_prob, [length(ar_z_r_borr_prob), 1]);
</pre><h2 id="11">F3: Get Shock: Mesh Shocks Together</h2><p>R is outter, W is Inner</p><pre class="codeinput"><span class="comment">% Kronecker product to get full transition matrix for the two shocks</span>
mt_z_trans = kron(mt_z_r_borr_prob_trans, mt_z_wage_trans);

<span class="comment">% mesh the shock vectors</span>
[mt_z_wage_mesh_r_borr_w1r2, mt_z_r_borr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_borr);
ar_z_wage_mesh_r_borr_w1r2 = mt_z_wage_mesh_r_borr_w1r2(:)';
ar_z_r_borr_mesh_wage_w1r2 = mt_z_r_borr_mesh_wage_w1r2(:)';

<span class="comment">% mesh the shock vectors</span>
[mt_z_r_borr_mesh_wage_r1w2, mt_z_wage_mesh_r_borr_r1w2] = ndgrid(ar_z_r_borr, ar_z_wage);
ar_z_wage_mesh_r_borr_r1w2 = mt_z_wage_mesh_r_borr_r1w2(:)';
ar_z_r_borr_mesh_wage_r1w2 = mt_z_r_borr_mesh_wage_r1w2(:)';

<span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_r_borr_mesh_wage_w1r2;<span class="keyword">...</span>
                                 ar_z_wage_mesh_r_borr_w1r2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2'</span>);
    disp(<span class="string">'Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2'</span>);
    disp(<span class="string">'show which shock is inner and which is outter'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);

    tb_two_shocks = array2table([ar_z_wage_mesh_r_borr_r1w2;<span class="keyword">...</span>
                                 ar_z_r_borr_mesh_wage_r1w2]');
    cl_col_names = [<span class="string">"Borrow R Shock (Meshed)"</span>, <span class="string">"Wage R Shock (Meshed)"</span>];
    cl_row_names = strcat(<span class="string">'zi='</span>, string((1:length(ar_z_r_borr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_borr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_borr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr', <span class="string">'r%3.2f'</span>)]);
    tb_z_r_borr_prob_trans = array2table(round(mt_z_r_borr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_r_borr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_borr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_borr_prob_trans));
    disp(tb_z_r_borr_prob_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', <span class="string">'w%3.2f'</span>)]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'zi='</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Full Transition Matrix: mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', <span class="string">'r%3.2f;'</span>), <span class="keyword">...</span>
                                   num2str(ar_z_wage_mesh_r_borr_w1r2', <span class="string">'w%3.2f'</span>)]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat(<span class="string">'i'</span>, num2str(ar_it_cols'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat(<span class="string">'i'</span>, num2str(ar_it_rows'), <span class="string">':'</span>, cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2
Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_1             0.025                0.34741      
    zi_2             0.025                0.40076      
    zi_3             0.025                 0.4623      
    zi_4             0.025                 0.5333      
    zi_5             0.025                0.61519      
    zi_6             0.025                0.70966      
    zi_7             0.025                0.81864      
    zi_8             0.025                0.94436      
    zi_9             0.025                 1.0894      
    zi_10            0.025                 1.2567      
    zi_11            0.025                 1.4496      
    zi_12            0.025                 1.6723      
    zi_13            0.025                 1.9291      
    zi_14            0.025                 2.2253      
    zi_15            0.025                  2.567      
    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_16           0.4875                0.34741      
    zi_17           0.4875                0.40076      
    zi_18           0.4875                 0.4623      
    zi_19           0.4875                 0.5333      
    zi_20           0.4875                0.61519      
    zi_21           0.4875                0.70966      
    zi_22           0.4875                0.81864      
    zi_23           0.4875                0.94436      
    zi_24           0.4875                 1.0894      
    zi_25           0.4875                 1.2567      
    zi_26           0.4875                 1.4496      
    zi_27           0.4875                 1.6723      
    zi_28           0.4875                 1.9291      
    zi_29           0.4875                 2.2253      
    zi_30           0.4875                  2.567      
    zi_31             0.95                0.34741      
    zi_32             0.95                0.40076      
    zi_33             0.95                 0.4623      
    zi_34             0.95                 0.5333      
    zi_35             0.95                0.61519      
    zi_36             0.95                0.70966      
    zi_37             0.95                0.81864      
    zi_38             0.95                0.94436      
    zi_39             0.95                 1.0894      
    zi_40             0.95                 1.2567      
    zi_41             0.95                 1.4496      
    zi_42             0.95                 1.6723      
    zi_43             0.95                 1.9291      
    zi_44             0.95                 2.2253      
    zi_45             0.95                  2.567      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2
Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2
show which shock is inner and which is outter
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45     2

            BorrowRShock_Meshed_    WageRShock_Meshed_
            ____________________    __________________

    zi_1          0.34741                  0.025      
    zi_2          0.34741                 0.4875      
    zi_3          0.34741                   0.95      
    zi_4          0.40076                  0.025      
    zi_5          0.40076                 0.4875      
    zi_6          0.40076                   0.95      

             BorrowRShock_Meshed_    WageRShock_Meshed_
             ____________________    __________________

    zi_40           2.2253                  0.025      
    zi_41           2.2253                 0.4875      
    zi_42           2.2253                   0.95      
    zi_43            2.567                  0.025      
    zi_44            2.567                 0.4875      
    zi_45            2.567                   0.95      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     3     3

                  zi_1_r0_03    zi_2_r0_49    zi_3_r0_95
                  __________    __________    __________

    zi_1_r0_03     0.004525      0.090498      0.90498  
    zi_2_r0_49     0.004525      0.090498      0.90498  
    zi_3_r0_95     0.004525      0.090498      0.90498  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    15    15

                   zi_1_w0_35    zi_2_w0_40    zi_3_w0_46    zi_4_w0_53    zi_5_w0_62    zi_6_w0_71    zi_7_w0_82    zi_8_w0_94    zi_9_w1_09    zi_10_w1_26    zi_11_w1_45    zi_12_w1_67    zi_13_w1_93    zi_14_w2_23    zi_15_w2_57
                   __________    __________    __________    __________    __________    __________    __________    __________    __________    ___________    ___________    ___________    ___________    ___________    ___________

    zi_1_w0_35       0.26016       0.26831       0.25551       0.14921      0.053403      0.011702      0.001568      0.000128         6e-06             0              0              0              0              0              0  
    zi_2_w0_40       0.11232       0.19622        0.2763       0.23861       0.12635      0.040998      0.008143      0.000989       7.3e-05         3e-06              0              0              0              0              0  
    zi_3_w0_46      0.037073       0.10492        0.2185       0.27902        0.2185       0.10492      0.030863      0.005556      0.000611       4.1e-05          2e-06              0              0              0              0  
    zi_4_w0_53      0.009208      0.040998       0.12635       0.23861        0.2763       0.19622      0.085427      0.022782      0.003717       0.00037        2.3e-05          1e-06              0              0              0  
    zi_5_w0_62      0.001703      0.011702      0.053403       0.14921       0.25551       0.26831       0.17279      0.068209      0.016489      0.002438        0.00022        1.2e-05              0              0              0  
    zi_6_w0_71      0.000233      0.002438      0.016489      0.068209       0.17279       0.26831       0.25551       0.14921      0.053403      0.011702       0.001568       0.000128          6e-06              0              0  
    zi_7_w0_82       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622        0.2763       0.23861       0.12635      0.040998       0.008143       0.000989        7.3e-05          3e-06              0  
    zi_8_w0_94         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492        0.2185       0.27902        0.2185       0.10492       0.030863       0.005556       0.000611        4.1e-05          2e-06  
    zi_9_w1_09             0         3e-06       7.3e-05      0.000989      0.008143      0.040998       0.12635       0.23861        0.2763       0.19622       0.085427       0.022782       0.003717        0.00037        2.3e-05  
    zi_10_w1_26            0             0         6e-06      0.000128      0.001568      0.011702      0.053403       0.14921       0.25551       0.26831        0.17279       0.068209       0.016489       0.002438       0.000233  
    zi_11_w1_45            0             0             0       1.2e-05       0.00022      0.002438      0.016489      0.068209       0.17279       0.26831        0.25551        0.14921       0.053403       0.011702       0.001703  
    zi_12_w1_67            0             0             0         1e-06       2.3e-05       0.00037      0.003717      0.022782      0.085427       0.19622         0.2763        0.23861        0.12635       0.040998       0.009208  
    zi_13_w1_93            0             0             0             0         2e-06       4.1e-05      0.000611      0.005556      0.030863       0.10492         0.2185        0.27902         0.2185        0.10492       0.037073  
    zi_14_w2_23            0             0             0             0             0         3e-06       7.3e-05      0.000989      0.008143      0.040998        0.12635        0.23861         0.2763        0.19622        0.11232  
    zi_15_w2_57            0             0             0             0             0             0         6e-06      0.000128      0.001568      0.011702       0.053403        0.14921        0.25551        0.26831        0.26016  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Full Transition Matrix: mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

                       i1_r0_03_w0_35    i2_r0_03_w0_40    i3_r0_03_w0_46    i4_r0_03_w0_53    i5_r0_03_w0_62    i6_r0_03_w0_71    i7_r0_03_w0_82    i8_r0_03_w0_94    i9_r0_03_w1_09    i10_r0_03_w1_26    i11_r0_03_w1_45    i12_r0_03_w1_67    i13_r0_03_w1_93    i14_r0_03_w2_23    i15_r0_03_w2_57    i16_r0_49_w0_35    i17_r0_49_w0_40    i18_r0_49_w0_46    i19_r0_49_w0_53    i20_r0_49_w0_62    i21_r0_49_w0_71    i22_r0_49_w0_82    i23_r0_49_w0_94    i24_r0_49_w1_09    i25_r0_49_w1_26    i26_r0_49_w1_45    i27_r0_49_w1_67    i28_r0_49_w1_93    i29_r0_49_w2_23    i30_r0_49_w2_57    i31_r0_95_w0_35    i32_r0_95_w0_40    i33_r0_95_w0_46    i34_r0_95_w0_53    i35_r0_95_w0_62    i36_r0_95_w0_71    i37_r0_95_w0_82    i38_r0_95_w0_94    i39_r0_95_w1_09    i40_r0_95_w1_26    i41_r0_95_w1_45    i42_r0_95_w1_67    i43_r0_95_w1_93    i44_r0_95_w2_23    i45_r0_95_w2_57
                       ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    ______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________

    i1_r0_03_w0_35        0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i2_r0_03_w0_40        0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i3_r0_03_w0_46        0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i4_r0_03_w0_53         4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i5_r0_03_w0_62           8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i6_r0_03_w0_71           1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i7_r0_03_w0_82               0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i8_r0_03_w0_94               0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i9_r0_03_w1_09               0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i10_r0_03_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i11_r0_03_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i12_r0_03_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i13_r0_03_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i14_r0_03_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i15_r0_03_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    
    i16_r0_49_w0_35       0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i17_r0_49_w0_40       0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i18_r0_49_w0_46       0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i19_r0_49_w0_53        4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i20_r0_49_w0_62          8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i21_r0_49_w0_71          1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i22_r0_49_w0_82              0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i23_r0_49_w0_94              0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i24_r0_49_w1_09              0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i25_r0_49_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i26_r0_49_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i27_r0_49_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i28_r0_49_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i29_r0_49_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i30_r0_49_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    
    i31_r0_95_w0_35       0.001177          0.001214          0.001156          0.000675          0.000242           5.3e-05             7e-06             1e-06                 0                 0                  0                  0                  0                  0                  0           0.023544           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0                  0                  0                  0                  0            0.23544            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0                  0                  0                  0                  0    
    i32_r0_95_w0_40       0.000508          0.000888           0.00125           0.00108          0.000572          0.000186           3.7e-05             4e-06                 0                 0                  0                  0                  0                  0                  0           0.010165           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0                  0                  0                  0                  0            0.10165            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0                  0                  0                  0                  0    
    i33_r0_95_w0_46       0.000168          0.000475          0.000989          0.001263          0.000989          0.000475           0.00014           2.5e-05             3e-06                 0                  0                  0                  0                  0                  0           0.003355           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0                  0                  0                  0                  0            0.03355           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06                  0                  0                  0                  0    
    i34_r0_95_w0_53        4.2e-05          0.000186          0.000572           0.00108           0.00125          0.000888          0.000387          0.000103           1.7e-05             2e-06                  0                  0                  0                  0                  0           0.000833            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0                  0                  0                  0           0.008333           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335              2e-05              1e-06                  0                  0                  0    
    i35_r0_95_w0_62          8e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214          0.000782          0.000309           7.5e-05           1.1e-05              1e-06                  0                  0                  0                  0           0.000154           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221              2e-05              1e-06                  0                  0                  0           0.001541            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000199            1.1e-05                  0                  0                  0    
    i36_r0_95_w0_71          1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214          0.001156          0.000675          0.000242           5.3e-05              7e-06              1e-06                  0                  0                  0            2.1e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000142            1.2e-05              1e-06                  0                  0           0.000211           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001419           0.000116              6e-06                  0                  0    
    i37_r0_95_w0_82              0             2e-06           1.7e-05          0.000103          0.000387          0.000888           0.00125           0.00108          0.000572          0.000186            3.7e-05              4e-06                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000737            8.9e-05              7e-06                  0                  0            2.1e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.007369           0.000895            6.6e-05              3e-06                  0    
    i38_r0_95_w0_94              0                 0             3e-06           2.5e-05           0.00014          0.000475          0.000989          0.001263          0.000989          0.000475            0.00014            2.5e-05              3e-06                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.002793           0.000503            5.5e-05              4e-06                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.02793           0.005028           0.000553            3.7e-05              2e-06    
    i39_r0_95_w1_09              0                 0                 0             4e-06           3.7e-05          0.000186          0.000572           0.00108           0.00125          0.000888           0.000387           0.000103            1.7e-05              2e-06                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.007731           0.002062           0.000336            3.4e-05              2e-06                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.07731           0.020617           0.003364           0.000335            2.1e-05    
    i40_r0_95_w1_26              0                 0                 0             1e-06             7e-06           5.3e-05          0.000242          0.000675          0.001156          0.001214           0.000782           0.000309            7.5e-05            1.1e-05              1e-06                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.015637           0.006173           0.001492           0.000221            2.1e-05                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.15637           0.061727           0.014922           0.002206           0.000211    
    i41_r0_95_w1_45              0                 0                 0                 0             1e-06           1.1e-05           7.5e-05          0.000309          0.000782          0.001214           0.001156           0.000675           0.000242            5.3e-05              8e-06                  0                  0                  0              1e-06              2e-05           0.000221           0.001492           0.006173           0.015637           0.024282           0.023123           0.013503           0.004833           0.001059           0.000154                  0                  0                  0            1.1e-05           0.000199           0.002206           0.014922           0.061727            0.15637            0.24282            0.23123            0.13503           0.048328            0.01059           0.001541    
    i42_r0_95_w1_67              0                 0                 0                 0                 0             2e-06           1.7e-05          0.000103          0.000387          0.000888            0.00125            0.00108           0.000572           0.000186            4.2e-05                  0                  0                  0                  0              2e-06            3.4e-05           0.000336           0.002062           0.007731           0.017757           0.025005           0.021593           0.011434            0.00371           0.000833                  0                  0                  0              1e-06              2e-05           0.000335           0.003364           0.020617            0.07731            0.17757            0.25005            0.21593            0.11434           0.037102           0.008333    
    i43_r0_95_w1_93              0                 0                 0                 0                 0                 0             3e-06           2.5e-05           0.00014          0.000475           0.000989           0.001263           0.000989           0.000475           0.000168                  0                  0                  0                  0                  0              4e-06            5.5e-05           0.000503           0.002793           0.009495           0.019774            0.02525           0.019774           0.009495           0.003355                  0                  0                  0                  0              2e-06            3.7e-05           0.000553           0.005028            0.02793           0.094946            0.19774             0.2525            0.19774           0.094946            0.03355    
    i44_r0_95_w2_23              0                 0                 0                 0                 0                 0                 0             4e-06           3.7e-05          0.000186           0.000572            0.00108            0.00125           0.000888           0.000508                  0                  0                  0                  0                  0                  0              7e-06            8.9e-05           0.000737            0.00371           0.011434           0.021593           0.025005           0.017757           0.010165                  0                  0                  0                  0                  0              3e-06            6.6e-05           0.000895           0.007369           0.037102            0.11434            0.21593            0.25005            0.17757            0.10165    
    i45_r0_95_w2_57              0                 0                 0                 0                 0                 0                 0             1e-06             7e-06           5.3e-05           0.000242           0.000675           0.001156           0.001214           0.001177                  0                  0                  0                  0                  0                  0              1e-06            1.2e-05           0.000142           0.001059           0.004833           0.013503           0.023123           0.024282           0.023544                  0                  0                  0                  0                  0                  0              6e-06           0.000116           0.001419            0.01059           0.048328            0.13503            0.23123            0.24282            0.23544    

</pre><h2 id="12">Get Equations</h2><pre class="codeinput">[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_cons] = <span class="keyword">...</span>
    ffs_ipwkbzr_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_r_save, fl_w);
</pre><h2 id="13">Generate Cash-on-Hand/State Matrix</h2><p>The endogenous state variable is cash-on-hand, it has it_z_n*it_a_n number of points, covering all reachable points when ar_a is the choice vector and ar_z is the shock vector. requires inputs from get Asset and choice grids, get shock grids, and get equations above.</p><div><ol><li>mt_coh_wkb_full: this is the (I^k x I^w) by (M^r x M^z) matrix, where rows = it_w_interp_n*it_ak_perc_n, and cols = fl_z_r_borr_n*it_z_wage_n.</li><li>mt_coh_wkb_full: this is the (I^k x I^w x M^r) by (M^z) matrix, where rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n, and cols = it_z_wage_n.</li></ol></div><pre class="codeinput">mt_coh_wkb_full = f_coh(ar_z_r_borr_mesh_wage_r1w2, ar_z_wage_mesh_r_borr_r1w2, <span class="keyword">...</span>
                        ar_a_meshk_full, ar_k_mesha_full);

it_coh_wkb_reshape_rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n;
it_coh_wkb_reshape_cols = it_z_wage_n;
mt_coh_wkb_full = reshape(mt_coh_wkb_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

<span class="comment">% Generate Aggregate Variables</span>
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

<span class="keyword">if</span> (bl_display_funcgrids || bl_graph_funcgrids)

    <span class="comment">% Genereate Table</span>
    tab_ak_choices = array2table([ar_aplusk_mesh, ar_k_mesha_full, ar_a_meshk_full]);
    cl_col_names = {<span class="string">'ar_aplusk_mesh'</span>, <span class="string">'ar_k_mesha_full'</span>, <span class="string">'ar_a_meshk_full'</span>};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    <span class="comment">% Label Table Variables</span>
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_aplusk_mesh'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_a_meshk_full'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_a_meshk_full*:'</span>;
    tab_ak_choices.Properties.VariableDescriptions{<span class="string">'ar_k_mesha_full'</span>} = <span class="keyword">...</span>
        <span class="string">'*ar_k_mesha_full*:'</span>;

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    <span class="keyword">for</span> it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    <span class="keyword">end</span>

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'tab_ak_choices'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    <span class="comment">% Generate Shock Full Mat to See coh_wkb_full zr and zw</span>
    mt_z_r_borr_mwge_makfull = zeros([length(ar_a_meshk_full), it_z_n]) + ar_z_r_borr_mesh_wage_r1w2;
    mt_z_wage_mesh_r_makfull = zeros([length(ar_a_meshk_full), it_z_n]) + ar_z_wage_mesh_r_borr_r1w2;
    <span class="comment">% use the same reshape command as above</span>
    mt_z_r_borr_mwge_makfull = reshape(mt_z_r_borr_mwge_makfull, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_z_wage_mesh_r_makfull = reshape(mt_z_wage_mesh_r_makfull, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

    <span class="comment">% Generate W and K Choices Full Mat to see which w and k</span>
    mt_aplusk_mesh = zeros([length(ar_a_meshk_full), it_z_n]) + ar_aplusk_mesh;
    mt_a_meshk_full = zeros([length(ar_a_meshk_full), it_z_n]) + ar_a_meshk_full;
    mt_k_mesha_full = zeros([length(ar_a_meshk_full), it_z_n]) + ar_k_mesha_full;
    <span class="comment">% use the same reshape command as above</span>
    mt_aplusk_mesh = reshape(mt_aplusk_mesh, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_a_meshk_full = reshape(mt_a_meshk_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_k_mesha_full = reshape(mt_k_mesha_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_coh_wkb_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Shock Borrow R: mt_z_r_borr_mwge_makfull'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_r_borr_mwge_makfull));
    disp(head(array2table(mt_z_r_borr_mwge_makfull), it_rows_toshow));
    disp(tail(array2table(mt_z_r_borr_mwge_makfull), it_rows_toshow));
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Shock Productivity: mt_z_wage_mesh_r_makfull'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_wage_mesh_r_makfull));
    disp(head(array2table(mt_z_wage_mesh_r_makfull), it_rows_toshow));
    disp(tail(array2table(mt_z_wage_mesh_r_makfull), it_rows_toshow));
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'W = Aprime + Kprime; mt_aplusk_mesh'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_aplusk_mesh));
    disp(head(array2table(mt_aplusk_mesh), it_rows_toshow));
    disp(tail(array2table(mt_aplusk_mesh), it_rows_toshow));
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Kprime: mt_k_mesha_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_k_mesha_full));
    disp(head(array2table(mt_k_mesha_full), it_rows_toshow));
    disp(tail(array2table(mt_k_mesha_full), it_rows_toshow));
    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'Aprime: mt_a_meshk_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_a_meshk_full));
    disp(head(array2table(mt_a_meshk_full), it_rows_toshow));
    disp(tail(array2table(mt_a_meshk_full), it_rows_toshow));

<span class="keyword">end</span>
</pre><pre class="codeoutput">*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;
*ar_k_mesha_full*:
*ar_a_meshk_full*:
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
tab_ak_choices
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        1575           3

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3
    ar_aplusk_mesh     ar_k_mesha_full    ar_a_meshk_full
    _______________    _______________    _______________

           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
           -20                    0               -20    
       -17.879            0.0021212           -17.881    
       -17.879             0.050234           -17.929    
       -17.879             0.098347           -17.977    
       -17.879              0.14646           -18.025    
       -17.879              0.19457           -18.073    
       -17.879              0.24269           -18.121    
       -17.879               0.2908            -18.17    
       -17.879              0.33891           -18.218    
       -17.879              0.38702           -18.266    
       -17.879              0.43514           -18.314    
       -17.879              0.48325           -18.362    
       -17.879              0.53136            -18.41    
       -17.879              0.57948           -18.458    
       -17.879              0.62759           -18.506    
       -17.879               0.6757           -18.554    
       -17.879              0.72382           -18.603    
       -17.879              0.77193           -18.651    
       -17.879              0.82004           -18.699    
       -17.879              0.86815           -18.747    
       -17.879              0.91627           -18.795    
       -17.879              0.96438           -18.843    
       -17.879               1.0125           -18.891    
       -17.879               1.0606           -18.939    
       -17.879               1.1087           -18.988    
       -17.879               1.1568           -19.036    

    tab_ak_choices1    tab_ak_choices2    tab_ak_choices3
    ar_aplusk_mesh     ar_k_mesha_full    ar_a_meshk_full
    _______________    _______________    _______________

        47.879              30.86              17.019    
        47.879               32.4              15.479    
        47.879             33.939              13.939    
        47.879             35.479                12.4    
        47.879             37.019               10.86    
        47.879             38.558              9.3206    
        47.879             40.098              7.7809    
        47.879             41.637              6.2413    
        47.879             43.177              4.7017    
        47.879             44.717              3.1621    
        47.879             46.256              1.6225    
        47.879             47.796            0.082865    
        47.879             49.336             -1.4567    
        47.879             50.875             -2.9964    
        47.879             52.415              -4.536    
        47.879             53.954             -6.0756    
        47.879             55.494             -7.6152    
        47.879             57.034             -9.1548    
        47.879             58.573             -10.694    
        47.879             60.113             -12.234    
        47.879             61.652             -13.774    
        47.879             63.192             -15.313    
        47.879             64.732             -16.853    
        47.879             66.271             -18.393    
        47.879             67.811             -19.932    
            50               0.07               49.93    
            50             1.6577              48.342    
            50             3.2455              46.755    
            50             4.8332              45.167    
            50             6.4209              43.579    
            50             8.0086              41.991    
            50             9.5964              40.404    
            50             11.184              38.816    
            50             12.772              37.228    
            50              14.36               35.64    
            50             15.947              34.053    
            50             17.535              32.465    
            50             19.123              30.877    
            50              20.71               29.29    
            50             22.298              27.702    
            50             23.886              26.114    
            50             25.474              24.526    
            50             27.061              22.939    
            50             28.649              21.351    
            50             30.237              19.763    
            50             31.825              18.175    
            50             33.412              16.588    
            50                 35                  15    
            50             36.588              13.412    
            50             38.175              11.825    
            50             39.763              10.237    
            50             41.351              8.6491    
            50             42.939              7.0614    
            50             44.526              5.4736    
            50             46.114              3.8859    
            50             47.702              2.2982    
            50              49.29             0.71045    
            50             50.877            -0.87727    
            50             52.465              -2.465    
            50             54.053             -4.0527    
            50              55.64             -5.6405    
            50             57.228             -7.2282    
            50             58.816             -8.8159    
            50             60.404             -10.404    
            50             61.991             -11.991    
            50             63.579             -13.579    
            50             65.167             -15.167    
            50             66.755             -16.755    
            50             68.342             -18.342    
            50              69.93              -19.93    

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_coh_wkb_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056             -20.056              -20.056              -20.056              -20.056              -20.056              -20.056              -20.056     
        -17.844             -17.839             -17.832             -17.824             -17.815             -17.805             -17.793             -17.779             -17.764              -17.745              -17.724                -17.7              -17.672               -17.64              -17.602     
        -17.769             -17.751              -17.73             -17.706             -17.678             -17.646             -17.608             -17.566             -17.516              -17.459              -17.394              -17.318               -17.23              -17.129              -17.013     
        -17.742             -17.719             -17.692             -17.661             -17.626             -17.585             -17.537             -17.483              -17.42              -17.347              -17.263              -17.167              -17.055              -16.927              -16.779     
        -17.724             -17.697             -17.666              -17.63             -17.589             -17.542             -17.488             -17.425             -17.352              -17.268              -17.172               -17.06              -16.931              -16.783              -16.612     
         -17.71              -17.68             -17.646             -17.607             -17.561             -17.509             -17.448             -17.379             -17.298              -17.205              -17.098              -16.975              -16.832              -16.668              -16.479     
        -17.699             -17.667              -17.63             -17.587             -17.538             -17.481             -17.416              -17.34             -17.253              -17.153              -17.037              -16.903              -16.749              -16.571              -16.366     
         -17.69             -17.656             -17.616             -17.571             -17.518             -17.458             -17.388             -17.307             -17.214              -17.107              -16.983              -16.841              -16.676              -16.486              -16.267     
        -17.682             -17.646             -17.605             -17.556             -17.501             -17.437             -17.363             -17.278              -17.18              -17.066              -16.936              -16.785              -16.611               -16.41              -16.179     
        -17.676             -17.638             -17.594             -17.544             -17.486             -17.419             -17.341             -17.252             -17.149               -17.03              -16.893              -16.735              -16.552              -16.342              -16.099     
         -17.67             -17.631             -17.585             -17.533             -17.472             -17.402             -17.321             -17.228              -17.12              -16.996              -16.853              -16.688              -16.498              -16.279              -16.025     
        -17.665             -17.624             -17.577             -17.522             -17.459             -17.387             -17.303             -17.206             -17.094              -16.966              -16.817              -16.646              -16.448               -16.22              -15.957     
        -17.661             -17.619              -17.57             -17.513             -17.448             -17.373             -17.286             -17.186              -17.07              -16.937              -16.783              -16.606              -16.402              -16.166              -15.893     
        -17.658             -17.614             -17.563             -17.505             -17.437              -17.36              -17.27             -17.167             -17.048               -16.91              -16.752              -16.569              -16.358              -16.115              -15.834     
        -17.654             -17.609             -17.557             -17.497             -17.428             -17.348             -17.256             -17.149             -17.027              -16.885              -16.722              -16.534              -16.317              -16.066              -15.777     
        -17.651             -17.605             -17.552              -17.49             -17.419             -17.337             -17.242             -17.133             -17.007              -16.862              -16.694              -16.501              -16.278              -16.021              -15.724     
        -17.649             -17.601             -17.547             -17.483              -17.41             -17.326             -17.229             -17.117             -16.988              -16.839              -16.668               -16.47              -16.241              -15.977              -15.673     
        -17.647             -17.598             -17.542             -17.477             -17.403             -17.317             -17.217             -17.103             -16.971              -16.818              -16.643               -16.44              -16.206              -15.936              -15.625     
        -17.645             -17.595             -17.538             -17.472             -17.395             -17.307             -17.206             -17.089             -16.954              -16.798              -16.618              -16.411              -16.172              -15.896              -15.578     
        -17.643             -17.592             -17.534             -17.466             -17.389             -17.299             -17.195             -17.076             -16.938              -16.779              -16.596              -16.384               -16.14              -15.858              -15.534     
        -17.642              -17.59              -17.53             -17.462             -17.382             -17.291             -17.185             -17.063             -16.923              -16.761              -16.574              -16.358              -16.109              -15.822              -15.491     
         -17.64             -17.588             -17.527             -17.457             -17.376             -17.283             -17.175             -17.051             -16.908              -16.743              -16.553              -16.333              -16.079              -15.787               -15.45     
        -17.639             -17.586             -17.524             -17.453              -17.37             -17.276             -17.166              -17.04             -16.894              -16.726              -16.532              -16.309              -16.051              -15.753               -15.41     
        -17.639             -17.584             -17.521             -17.449             -17.365             -17.269             -17.157             -17.029             -16.881               -16.71              -16.513              -16.285              -16.023              -15.721              -15.371     
        -17.638             -17.583             -17.519             -17.445              -17.36             -17.262             -17.149             -17.018             -16.868              -16.694              -16.494              -16.263              -15.996              -15.689              -15.334     
        -17.637             -17.581             -17.516             -17.442             -17.355             -17.256             -17.141             -17.008             -16.856              -16.679              -16.476              -16.241              -15.971              -15.658              -15.298     

    mt_coh_wkb_full1    mt_coh_wkb_full2    mt_coh_wkb_full3    mt_coh_wkb_full4    mt_coh_wkb_full5    mt_coh_wkb_full6    mt_coh_wkb_full7    mt_coh_wkb_full8    mt_coh_wkb_full9    mt_coh_wkb_full10    mt_coh_wkb_full11    mt_coh_wkb_full12    mt_coh_wkb_full13    mt_coh_wkb_full14    mt_coh_wkb_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

         47.473              47.657              47.868              48.112              48.394              48.718              49.093              49.525              50.023              50.598               51.262               52.027               52.909               53.928               55.102      
         47.333              47.519              47.734              47.983              48.269                48.6              48.981              49.421              49.928              50.513               51.188               51.967               52.865               53.901               55.096      
         47.191              47.381                47.6              47.853              48.144               48.48              48.867              49.315               49.83              50.425               51.112               51.904               52.817               53.871               55.086      
          47.05              47.242              47.465              47.721              48.017              48.359              48.753              49.207              49.731              50.336               51.033               51.838               52.766               53.836               55.071      
         46.907              47.103              47.329              47.589               47.89              48.237              48.637              49.098               49.63              50.244               50.952               51.769               52.712               53.799               55.053      
         46.765              46.963              47.192              47.457              47.762              48.114              48.519              48.988              49.528              50.151               50.869               51.698               52.654               53.758                55.03      
         46.621              46.823              47.055              47.323              47.633              47.989              48.401              48.876              49.423              50.055               50.784               51.625               52.595               53.714               55.004      
         46.477              46.682              46.917              47.189              47.503              47.864              48.282              48.763              49.318              49.958               50.697                51.55               52.533               53.667               54.975      
         46.333               46.54              46.779              47.054              47.372              47.738              48.161              48.649              49.211               49.86               50.609               51.472               52.468               53.617               54.943      
         46.189              46.398               46.64              46.919              47.241              47.612               48.04              48.534              49.103               49.76               50.518               51.393               52.401               53.565               54.907      
         46.044              46.256              46.501              46.783              47.109              47.484              47.918              48.417              48.994              49.659               50.426               51.312               52.333               53.511               54.869      
         45.899              46.113              46.361              46.646              46.976              47.356              47.794                48.3              48.884              49.557               50.333               51.229               52.262               53.454               54.829      
         44.405              44.623              44.873              45.162              45.495               45.88              46.323              46.835              47.425              48.106               48.891               49.797               50.842               52.047               53.438      
         42.835              43.055              43.308                43.6              43.937              44.326              44.774              45.292              45.888              46.577               47.371               48.287               49.343               50.562               51.969      
         41.265              41.487              41.743              42.038              42.379              42.772              43.225              43.748              44.351              45.047               45.849               46.775               47.843               49.075               50.497      
         39.694              39.919              40.177              40.476               40.82              41.217              41.675              42.203              42.813              43.516               44.327               45.262               46.342               47.587               49.023      
         38.123               38.35              38.611              38.913               39.26              39.661              40.124              40.658              41.273              41.984               42.803               43.748               44.838               46.096               47.547      
         36.552              36.781              37.045              37.349                37.7              38.105              38.573              39.112              39.733              40.451               41.278               42.233               43.334               44.604               46.069      
         34.981              35.212              35.478              35.785               36.14              36.549              37.021              37.565              38.193              38.917               39.752               40.716               41.827                43.11               44.589      
         33.409              33.642              33.911              34.221              34.579              34.992              35.468              36.017              36.651              37.382               38.225               39.198                40.32               41.614               43.108      
         31.837              32.072              32.344              32.657              33.018              33.434              33.915              34.469              35.109              35.846               36.697               37.679               38.811               40.118               41.624      
         30.265              30.502              30.776              31.092              31.456              31.877              32.361              32.921              33.566               34.31               35.169               36.159               37.301               38.619                40.14      
         28.693              28.932              29.208              29.527              29.894              30.318              30.807              31.371              32.022              32.773               33.639               34.638                35.79                37.12               38.653      
          27.12              27.362               27.64              27.961              28.332               28.76              29.253              29.822              30.478              31.235               32.108               33.116               34.278               35.619               37.165      
         25.547              25.791              26.072              26.396              26.769                27.2              27.698              28.271              28.933              29.696               30.577               31.593               32.765               34.116               35.676      
          51.82               51.84              51.864              51.891              51.922              51.959              52.001              52.049              52.105              52.169               52.243               52.328               52.427               52.541               52.672      
         51.936                  52              52.074              52.159              52.258              52.371              52.502              52.652              52.826              53.027               53.259               53.526               53.834               54.189               54.599      
         51.884              51.965              52.059              52.168              52.293              52.437              52.604              52.796              53.017              53.273               53.568               53.908                 54.3               54.753               55.275      
         51.799              51.893              52.001              52.127              52.271              52.438               52.63              52.851              53.107              53.402               53.742               54.135               54.588                55.11               55.713      
         51.698              51.802              51.922              52.061              52.221              52.406              52.618              52.864              53.147              53.474               53.851               54.286               54.787               55.366               56.033      
         51.587                51.7               51.83              51.981              52.154              52.354              52.584               52.85              53.157               53.51               53.919               54.389               54.932               55.559               56.282      
          51.47              51.591               51.73               51.89              52.075              52.288              52.534              52.818              53.145              53.523               53.958               54.461                55.04               55.709                56.48      
         51.348              51.475              51.622              51.791              51.987              52.212              52.472              52.772              53.118              53.517               53.977               54.508                55.12               55.827               56.642      
         51.222              51.355              51.509              51.687              51.892              52.128              52.401              52.715              53.078              53.497               53.979               54.536               55.179                55.92               56.775      
         51.092              51.232              51.392              51.578              51.791              52.038              52.322               52.65              53.029              53.465               53.969                54.55                55.22               55.993               56.885      
         50.961              51.105              51.272              51.464              51.686              51.942              52.238              52.578              52.971              53.425               53.948               54.551               55.247                56.05               56.976      
         50.827              50.976              51.149              51.348              51.578              51.842              52.148              52.501              52.907              53.376               53.918               54.542               55.262               56.093               57.051      
         50.691              50.845              51.023              51.229              51.466              51.739              52.054              52.418              52.837              53.321                53.88               54.524               55.267               56.124               57.112      
         50.553              50.712              50.895              51.107              51.351              51.632              51.956              52.331              52.762              53.261               53.835               54.498               55.263               56.145               57.162      
         50.415              50.578              50.766              50.983              51.233              51.522              51.855               52.24              52.683              53.195               53.785               54.465               55.251               56.156               57.201      
         50.274              50.442              50.635              50.857              51.114               51.41              51.751              52.145                52.6              53.124               53.729               54.427               55.232                56.16               57.231      
         50.133              50.304              50.502               50.73              50.992              51.295              51.645              52.048              52.513               53.05               53.669               54.383               55.207               56.157               57.253      
         49.991              50.166              50.368                50.6              50.869              51.179              51.536              51.948              52.423              52.972               53.605               54.334               55.176               56.147               57.268      
         49.848              50.027              50.232               50.47              50.744               51.06              51.425              51.846              52.331              52.891               53.536               54.281               55.141               56.132               57.275      
         49.704              49.886              50.096              50.338              50.618               50.94              51.312              51.741              52.236              52.806               53.465               54.224                 55.1               56.111               57.277      
         49.559              49.745              49.959              50.205               50.49              50.818              51.197              51.634              52.138              52.719                53.39               54.164               55.056               56.086               57.273      
         49.414              49.603               49.82              50.071              50.361              50.695              51.081              51.525              52.038               52.63               53.312                 54.1               55.008               56.056               57.264      
         49.268               49.46              49.681              49.937              50.231              50.571              50.963              51.415              51.936              52.538               53.232               54.033               54.956               56.022               57.251      
         49.121              49.316              49.541              49.801                50.1              50.445              50.843              51.303              51.833              52.444               53.149               53.963               54.901               55.984               57.233      
         48.974              49.172              49.401              49.664              49.968              50.318              50.723              51.189              51.727              52.348               53.064                53.89               54.843               55.942                57.21      
         48.827              49.028              49.259              49.527              49.835              50.191              50.601              51.074               51.62               52.25               52.977               53.815               54.782               55.898               57.184      
         48.679              48.882              49.117              49.388              49.701              50.062              50.478              50.958              51.512              52.151               52.888               53.738               54.719                55.85               57.155      
          48.53              48.736              48.975              49.249              49.567              49.932              50.354              50.841              51.402               52.05               52.797               53.658               54.653               55.799               57.122      
         48.381               48.59              48.832               49.11              49.431              49.802              50.229              50.722              51.291              51.947               52.704               53.577               54.584               55.746               57.086      
         48.231              48.443              48.688               48.97              49.295               49.67              50.103              50.602              51.178              51.843               52.609               53.493               54.513                55.69               57.047      
         48.082              48.296              48.544              48.829              49.158              49.538              49.976              50.482              51.065              51.737               52.513               53.408               54.441               55.632               57.006      
         47.932              48.149              48.399              48.688              49.021              49.405              49.849               50.36               50.95               51.63               52.416               53.321               54.366               55.571               56.961      
          46.97              47.189              47.442              47.734              48.071               48.46              48.909              49.426              50.023              50.711               51.505               52.421               53.478               54.697               56.103      
          45.35              45.572              45.828              46.124              46.464              46.857              47.311              47.834              48.437              49.133               49.936               50.862               51.931               53.163               54.585      
          43.73              43.955              44.214              44.512              44.857              45.254              45.712              46.241              46.851              47.554               48.366               49.302               50.382               51.628               53.065      
          42.11              42.337              42.599                42.9              43.248               43.65              44.113              44.647              45.263              45.974               46.794                47.74               48.832                50.09               51.543      
          40.49              40.719              40.983              41.288               41.64              42.045              42.513              43.053              43.675              44.393               45.222               46.177                47.28               48.551               50.018      
         38.869              39.101              39.367              39.675               40.03               40.44              40.912              41.457              42.086              42.811               43.648               44.613               45.726               47.011               48.492      
         37.249              37.482              37.751              38.062              38.421              38.834              39.311              39.861              40.496              41.228               42.073               43.047               44.172               45.468               46.964      
         35.627              35.863              36.135              36.449              36.811              37.228              37.709              38.265              38.906              39.645               40.497               41.481               42.615               43.924               45.434      
         34.006              34.244              34.518              34.835                35.2              35.621              36.107              36.668              37.314               38.06                38.92               39.913               41.058               42.379               43.902      
         32.385              32.625              32.901              33.221              33.589              34.014              34.504               35.07              35.722              36.475               37.343               38.344               39.499               40.832               42.369      
         30.763              31.005              31.284              31.606              31.978              32.407              32.901              33.471              34.129              34.889               35.764               36.774                37.94               39.284               40.834      
         29.141              29.385              29.667              29.991              30.366              30.799              31.297              31.873              32.536              33.302               34.185               35.203               36.379               37.734               39.298      
         27.519              27.765              28.049              28.376              28.754               29.19              29.693              30.273              30.942              31.714               32.604               33.632               34.816               36.183                37.76      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Shock Borrow R: mt_z_r_borr_mwge_makfull
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_z_r_borr_mwge_makfull1    mt_z_r_borr_mwge_makfull2    mt_z_r_borr_mwge_makfull3    mt_z_r_borr_mwge_makfull4    mt_z_r_borr_mwge_makfull5    mt_z_r_borr_mwge_makfull6    mt_z_r_borr_mwge_makfull7    mt_z_r_borr_mwge_makfull8    mt_z_r_borr_mwge_makfull9    mt_z_r_borr_mwge_makfull10    mt_z_r_borr_mwge_makfull11    mt_z_r_borr_mwge_makfull12    mt_z_r_borr_mwge_makfull13    mt_z_r_borr_mwge_makfull14    mt_z_r_borr_mwge_makfull15
    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________

              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           
              0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                        0.025                         0.025                         0.025                         0.025                         0.025                         0.025           

    mt_z_r_borr_mwge_makfull1    mt_z_r_borr_mwge_makfull2    mt_z_r_borr_mwge_makfull3    mt_z_r_borr_mwge_makfull4    mt_z_r_borr_mwge_makfull5    mt_z_r_borr_mwge_makfull6    mt_z_r_borr_mwge_makfull7    mt_z_r_borr_mwge_makfull8    mt_z_r_borr_mwge_makfull9    mt_z_r_borr_mwge_makfull10    mt_z_r_borr_mwge_makfull11    mt_z_r_borr_mwge_makfull12    mt_z_r_borr_mwge_makfull13    mt_z_r_borr_mwge_makfull14    mt_z_r_borr_mwge_makfull15
    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________

              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           
              0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                         0.95                          0.95                          0.95                          0.95                          0.95                          0.95                          0.95           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Shock Productivity: mt_z_wage_mesh_r_makfull
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_z_wage_mesh_r_makfull1    mt_z_wage_mesh_r_makfull2    mt_z_wage_mesh_r_makfull3    mt_z_wage_mesh_r_makfull4    mt_z_wage_mesh_r_makfull5    mt_z_wage_mesh_r_makfull6    mt_z_wage_mesh_r_makfull7    mt_z_wage_mesh_r_makfull8    mt_z_wage_mesh_r_makfull9    mt_z_wage_mesh_r_makfull10    mt_z_wage_mesh_r_makfull11    mt_z_wage_mesh_r_makfull12    mt_z_wage_mesh_r_makfull13    mt_z_wage_mesh_r_makfull14    mt_z_wage_mesh_r_makfull15
    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________

             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           

    mt_z_wage_mesh_r_makfull1    mt_z_wage_mesh_r_makfull2    mt_z_wage_mesh_r_makfull3    mt_z_wage_mesh_r_makfull4    mt_z_wage_mesh_r_makfull5    mt_z_wage_mesh_r_makfull6    mt_z_wage_mesh_r_makfull7    mt_z_wage_mesh_r_makfull8    mt_z_wage_mesh_r_makfull9    mt_z_wage_mesh_r_makfull10    mt_z_wage_mesh_r_makfull11    mt_z_wage_mesh_r_makfull12    mt_z_wage_mesh_r_makfull13    mt_z_wage_mesh_r_makfull14    mt_z_wage_mesh_r_makfull15
    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    _________________________    __________________________    __________________________    __________________________    __________________________    __________________________    __________________________

             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           
             0.34741                      0.40076                      0.4623                       0.5333                       0.61519                      0.70966                      0.81864                      0.94436                      1.0894                        1.2567                        1.4496                        1.6723                        1.9291                        2.2253                        2.567           

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
W = Aprime + Kprime; mt_aplusk_mesh
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_aplusk_mesh1    mt_aplusk_mesh2    mt_aplusk_mesh3    mt_aplusk_mesh4    mt_aplusk_mesh5    mt_aplusk_mesh6    mt_aplusk_mesh7    mt_aplusk_mesh8    mt_aplusk_mesh9    mt_aplusk_mesh10    mt_aplusk_mesh11    mt_aplusk_mesh12    mt_aplusk_mesh13    mt_aplusk_mesh14    mt_aplusk_mesh15
    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    ________________    ________________    ________________    ________________    ________________    ________________

            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
            -20                -20                -20                -20                -20                -20                -20                -20                -20                -20                 -20                 -20                 -20                 -20                 -20     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     
        -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879            -17.879             -17.879             -17.879             -17.879             -17.879             -17.879     

    mt_aplusk_mesh1    mt_aplusk_mesh2    mt_aplusk_mesh3    mt_aplusk_mesh4    mt_aplusk_mesh5    mt_aplusk_mesh6    mt_aplusk_mesh7    mt_aplusk_mesh8    mt_aplusk_mesh9    mt_aplusk_mesh10    mt_aplusk_mesh11    mt_aplusk_mesh12    mt_aplusk_mesh13    mt_aplusk_mesh14    mt_aplusk_mesh15
    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    _______________    ________________    ________________    ________________    ________________    ________________    ________________

        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
        47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879             47.879              47.879              47.879              47.879              47.879              47.879              47.879     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     
            50                 50                 50                 50                 50                 50                 50                 50                 50                  50                  50                  50                  50                  50                  50     

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Kprime: mt_k_mesha_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_k_mesha_full1    mt_k_mesha_full2    mt_k_mesha_full3    mt_k_mesha_full4    mt_k_mesha_full5    mt_k_mesha_full6    mt_k_mesha_full7    mt_k_mesha_full8    mt_k_mesha_full9    mt_k_mesha_full10    mt_k_mesha_full11    mt_k_mesha_full12    mt_k_mesha_full13    mt_k_mesha_full14    mt_k_mesha_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
               0                   0                   0                   0                   0                   0                   0                   0                   0                    0                    0                    0                    0                    0                    0    
       0.0021212           0.0021212           0.0021212           0.0021212           0.0021212           0.0021212           0.0021212           0.0021212           0.0021212            0.0021212            0.0021212            0.0021212            0.0021212            0.0021212            0.0021212    
        0.050234            0.050234            0.050234            0.050234            0.050234            0.050234            0.050234            0.050234            0.050234             0.050234             0.050234             0.050234             0.050234             0.050234             0.050234    
        0.098347            0.098347            0.098347            0.098347            0.098347            0.098347            0.098347            0.098347            0.098347             0.098347             0.098347             0.098347             0.098347             0.098347             0.098347    
         0.14646             0.14646             0.14646             0.14646             0.14646             0.14646             0.14646             0.14646             0.14646              0.14646              0.14646              0.14646              0.14646              0.14646              0.14646    
         0.19457             0.19457             0.19457             0.19457             0.19457             0.19457             0.19457             0.19457             0.19457              0.19457              0.19457              0.19457              0.19457              0.19457              0.19457    
         0.24269             0.24269             0.24269             0.24269             0.24269             0.24269             0.24269             0.24269             0.24269              0.24269              0.24269              0.24269              0.24269              0.24269              0.24269    
          0.2908              0.2908              0.2908              0.2908              0.2908              0.2908              0.2908              0.2908              0.2908               0.2908               0.2908               0.2908               0.2908               0.2908               0.2908    
         0.33891             0.33891             0.33891             0.33891             0.33891             0.33891             0.33891             0.33891             0.33891              0.33891              0.33891              0.33891              0.33891              0.33891              0.33891    
         0.38702             0.38702             0.38702             0.38702             0.38702             0.38702             0.38702             0.38702             0.38702              0.38702              0.38702              0.38702              0.38702              0.38702              0.38702    
         0.43514             0.43514             0.43514             0.43514             0.43514             0.43514             0.43514             0.43514             0.43514              0.43514              0.43514              0.43514              0.43514              0.43514              0.43514    
         0.48325             0.48325             0.48325             0.48325             0.48325             0.48325             0.48325             0.48325             0.48325              0.48325              0.48325              0.48325              0.48325              0.48325              0.48325    
         0.53136             0.53136             0.53136             0.53136             0.53136             0.53136             0.53136             0.53136             0.53136              0.53136              0.53136              0.53136              0.53136              0.53136              0.53136    
         0.57948             0.57948             0.57948             0.57948             0.57948             0.57948             0.57948             0.57948             0.57948              0.57948              0.57948              0.57948              0.57948              0.57948              0.57948    
         0.62759             0.62759             0.62759             0.62759             0.62759             0.62759             0.62759             0.62759             0.62759              0.62759              0.62759              0.62759              0.62759              0.62759              0.62759    
          0.6757              0.6757              0.6757              0.6757              0.6757              0.6757              0.6757              0.6757              0.6757               0.6757               0.6757               0.6757               0.6757               0.6757               0.6757    
         0.72382             0.72382             0.72382             0.72382             0.72382             0.72382             0.72382             0.72382             0.72382              0.72382              0.72382              0.72382              0.72382              0.72382              0.72382    
         0.77193             0.77193             0.77193             0.77193             0.77193             0.77193             0.77193             0.77193             0.77193              0.77193              0.77193              0.77193              0.77193              0.77193              0.77193    
         0.82004             0.82004             0.82004             0.82004             0.82004             0.82004             0.82004             0.82004             0.82004              0.82004              0.82004              0.82004              0.82004              0.82004              0.82004    
         0.86815             0.86815             0.86815             0.86815             0.86815             0.86815             0.86815             0.86815             0.86815              0.86815              0.86815              0.86815              0.86815              0.86815              0.86815    
         0.91627             0.91627             0.91627             0.91627             0.91627             0.91627             0.91627             0.91627             0.91627              0.91627              0.91627              0.91627              0.91627              0.91627              0.91627    
         0.96438             0.96438             0.96438             0.96438             0.96438             0.96438             0.96438             0.96438             0.96438              0.96438              0.96438              0.96438              0.96438              0.96438              0.96438    
          1.0125              1.0125              1.0125              1.0125              1.0125              1.0125              1.0125              1.0125              1.0125               1.0125               1.0125               1.0125               1.0125               1.0125               1.0125    
          1.0606              1.0606              1.0606              1.0606              1.0606              1.0606              1.0606              1.0606              1.0606               1.0606               1.0606               1.0606               1.0606               1.0606               1.0606    
          1.1087              1.1087              1.1087              1.1087              1.1087              1.1087              1.1087              1.1087              1.1087               1.1087               1.1087               1.1087               1.1087               1.1087               1.1087    
          1.1568              1.1568              1.1568              1.1568              1.1568              1.1568              1.1568              1.1568              1.1568               1.1568               1.1568               1.1568               1.1568               1.1568               1.1568    

    mt_k_mesha_full1    mt_k_mesha_full2    mt_k_mesha_full3    mt_k_mesha_full4    mt_k_mesha_full5    mt_k_mesha_full6    mt_k_mesha_full7    mt_k_mesha_full8    mt_k_mesha_full9    mt_k_mesha_full10    mt_k_mesha_full11    mt_k_mesha_full12    mt_k_mesha_full13    mt_k_mesha_full14    mt_k_mesha_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

          30.86               30.86               30.86               30.86               30.86               30.86               30.86               30.86               30.86               30.86                30.86                30.86                30.86                30.86                30.86      
           32.4                32.4                32.4                32.4                32.4                32.4                32.4                32.4                32.4                32.4                 32.4                 32.4                 32.4                 32.4                 32.4      
         33.939              33.939              33.939              33.939              33.939              33.939              33.939              33.939              33.939              33.939               33.939               33.939               33.939               33.939               33.939      
         35.479              35.479              35.479              35.479              35.479              35.479              35.479              35.479              35.479              35.479               35.479               35.479               35.479               35.479               35.479      
         37.019              37.019              37.019              37.019              37.019              37.019              37.019              37.019              37.019              37.019               37.019               37.019               37.019               37.019               37.019      
         38.558              38.558              38.558              38.558              38.558              38.558              38.558              38.558              38.558              38.558               38.558               38.558               38.558               38.558               38.558      
         40.098              40.098              40.098              40.098              40.098              40.098              40.098              40.098              40.098              40.098               40.098               40.098               40.098               40.098               40.098      
         41.637              41.637              41.637              41.637              41.637              41.637              41.637              41.637              41.637              41.637               41.637               41.637               41.637               41.637               41.637      
         43.177              43.177              43.177              43.177              43.177              43.177              43.177              43.177              43.177              43.177               43.177               43.177               43.177               43.177               43.177      
         44.717              44.717              44.717              44.717              44.717              44.717              44.717              44.717              44.717              44.717               44.717               44.717               44.717               44.717               44.717      
         46.256              46.256              46.256              46.256              46.256              46.256              46.256              46.256              46.256              46.256               46.256               46.256               46.256               46.256               46.256      
         47.796              47.796              47.796              47.796              47.796              47.796              47.796              47.796              47.796              47.796               47.796               47.796               47.796               47.796               47.796      
         49.336              49.336              49.336              49.336              49.336              49.336              49.336              49.336              49.336              49.336               49.336               49.336               49.336               49.336               49.336      
         50.875              50.875              50.875              50.875              50.875              50.875              50.875              50.875              50.875              50.875               50.875               50.875               50.875               50.875               50.875      
         52.415              52.415              52.415              52.415              52.415              52.415              52.415              52.415              52.415              52.415               52.415               52.415               52.415               52.415               52.415      
         53.954              53.954              53.954              53.954              53.954              53.954              53.954              53.954              53.954              53.954               53.954               53.954               53.954               53.954               53.954      
         55.494              55.494              55.494              55.494              55.494              55.494              55.494              55.494              55.494              55.494               55.494               55.494               55.494               55.494               55.494      
         57.034              57.034              57.034              57.034              57.034              57.034              57.034              57.034              57.034              57.034               57.034               57.034               57.034               57.034               57.034      
         58.573              58.573              58.573              58.573              58.573              58.573              58.573              58.573              58.573              58.573               58.573               58.573               58.573               58.573               58.573      
         60.113              60.113              60.113              60.113              60.113              60.113              60.113              60.113              60.113              60.113               60.113               60.113               60.113               60.113               60.113      
         61.652              61.652              61.652              61.652              61.652              61.652              61.652              61.652              61.652              61.652               61.652               61.652               61.652               61.652               61.652      
         63.192              63.192              63.192              63.192              63.192              63.192              63.192              63.192              63.192              63.192               63.192               63.192               63.192               63.192               63.192      
         64.732              64.732              64.732              64.732              64.732              64.732              64.732              64.732              64.732              64.732               64.732               64.732               64.732               64.732               64.732      
         66.271              66.271              66.271              66.271              66.271              66.271              66.271              66.271              66.271              66.271               66.271               66.271               66.271               66.271               66.271      
         67.811              67.811              67.811              67.811              67.811              67.811              67.811              67.811              67.811              67.811               67.811               67.811               67.811               67.811               67.811      
           0.07                0.07                0.07                0.07                0.07                0.07                0.07                0.07                0.07                0.07                 0.07                 0.07                 0.07                 0.07                 0.07      
         1.6577              1.6577              1.6577              1.6577              1.6577              1.6577              1.6577              1.6577              1.6577              1.6577               1.6577               1.6577               1.6577               1.6577               1.6577      
         3.2455              3.2455              3.2455              3.2455              3.2455              3.2455              3.2455              3.2455              3.2455              3.2455               3.2455               3.2455               3.2455               3.2455               3.2455      
         4.8332              4.8332              4.8332              4.8332              4.8332              4.8332              4.8332              4.8332              4.8332              4.8332               4.8332               4.8332               4.8332               4.8332               4.8332      
         6.4209              6.4209              6.4209              6.4209              6.4209              6.4209              6.4209              6.4209              6.4209              6.4209               6.4209               6.4209               6.4209               6.4209               6.4209      
         8.0086              8.0086              8.0086              8.0086              8.0086              8.0086              8.0086              8.0086              8.0086              8.0086               8.0086               8.0086               8.0086               8.0086               8.0086      
         9.5964              9.5964              9.5964              9.5964              9.5964              9.5964              9.5964              9.5964              9.5964              9.5964               9.5964               9.5964               9.5964               9.5964               9.5964      
         11.184              11.184              11.184              11.184              11.184              11.184              11.184              11.184              11.184              11.184               11.184               11.184               11.184               11.184               11.184      
         12.772              12.772              12.772              12.772              12.772              12.772              12.772              12.772              12.772              12.772               12.772               12.772               12.772               12.772               12.772      
          14.36               14.36               14.36               14.36               14.36               14.36               14.36               14.36               14.36               14.36                14.36                14.36                14.36                14.36                14.36      
         15.947              15.947              15.947              15.947              15.947              15.947              15.947              15.947              15.947              15.947               15.947               15.947               15.947               15.947               15.947      
         17.535              17.535              17.535              17.535              17.535              17.535              17.535              17.535              17.535              17.535               17.535               17.535               17.535               17.535               17.535      
         19.123              19.123              19.123              19.123              19.123              19.123              19.123              19.123              19.123              19.123               19.123               19.123               19.123               19.123               19.123      
          20.71               20.71               20.71               20.71               20.71               20.71               20.71               20.71               20.71               20.71                20.71                20.71                20.71                20.71                20.71      
         22.298              22.298              22.298              22.298              22.298              22.298              22.298              22.298              22.298              22.298               22.298               22.298               22.298               22.298               22.298      
         23.886              23.886              23.886              23.886              23.886              23.886              23.886              23.886              23.886              23.886               23.886               23.886               23.886               23.886               23.886      
         25.474              25.474              25.474              25.474              25.474              25.474              25.474              25.474              25.474              25.474               25.474               25.474               25.474               25.474               25.474      
         27.061              27.061              27.061              27.061              27.061              27.061              27.061              27.061              27.061              27.061               27.061               27.061               27.061               27.061               27.061      
         28.649              28.649              28.649              28.649              28.649              28.649              28.649              28.649              28.649              28.649               28.649               28.649               28.649               28.649               28.649      
         30.237              30.237              30.237              30.237              30.237              30.237              30.237              30.237              30.237              30.237               30.237               30.237               30.237               30.237               30.237      
         31.825              31.825              31.825              31.825              31.825              31.825              31.825              31.825              31.825              31.825               31.825               31.825               31.825               31.825               31.825      
         33.412              33.412              33.412              33.412              33.412              33.412              33.412              33.412              33.412              33.412               33.412               33.412               33.412               33.412               33.412      
             35                  35                  35                  35                  35                  35                  35                  35                  35                  35                   35                   35                   35                   35                   35      
         36.588              36.588              36.588              36.588              36.588              36.588              36.588              36.588              36.588              36.588               36.588               36.588               36.588               36.588               36.588      
         38.175              38.175              38.175              38.175              38.175              38.175              38.175              38.175              38.175              38.175               38.175               38.175               38.175               38.175               38.175      
         39.763              39.763              39.763              39.763              39.763              39.763              39.763              39.763              39.763              39.763               39.763               39.763               39.763               39.763               39.763      
         41.351              41.351              41.351              41.351              41.351              41.351              41.351              41.351              41.351              41.351               41.351               41.351               41.351               41.351               41.351      
         42.939              42.939              42.939              42.939              42.939              42.939              42.939              42.939              42.939              42.939               42.939               42.939               42.939               42.939               42.939      
         44.526              44.526              44.526              44.526              44.526              44.526              44.526              44.526              44.526              44.526               44.526               44.526               44.526               44.526               44.526      
         46.114              46.114              46.114              46.114              46.114              46.114              46.114              46.114              46.114              46.114               46.114               46.114               46.114               46.114               46.114      
         47.702              47.702              47.702              47.702              47.702              47.702              47.702              47.702              47.702              47.702               47.702               47.702               47.702               47.702               47.702      
          49.29               49.29               49.29               49.29               49.29               49.29               49.29               49.29               49.29               49.29                49.29                49.29                49.29                49.29                49.29      
         50.877              50.877              50.877              50.877              50.877              50.877              50.877              50.877              50.877              50.877               50.877               50.877               50.877               50.877               50.877      
         52.465              52.465              52.465              52.465              52.465              52.465              52.465              52.465              52.465              52.465               52.465               52.465               52.465               52.465               52.465      
         54.053              54.053              54.053              54.053              54.053              54.053              54.053              54.053              54.053              54.053               54.053               54.053               54.053               54.053               54.053      
          55.64               55.64               55.64               55.64               55.64               55.64               55.64               55.64               55.64               55.64                55.64                55.64                55.64                55.64                55.64      
         57.228              57.228              57.228              57.228              57.228              57.228              57.228              57.228              57.228              57.228               57.228               57.228               57.228               57.228               57.228      
         58.816              58.816              58.816              58.816              58.816              58.816              58.816              58.816              58.816              58.816               58.816               58.816               58.816               58.816               58.816      
         60.404              60.404              60.404              60.404              60.404              60.404              60.404              60.404              60.404              60.404               60.404               60.404               60.404               60.404               60.404      
         61.991              61.991              61.991              61.991              61.991              61.991              61.991              61.991              61.991              61.991               61.991               61.991               61.991               61.991               61.991      
         63.579              63.579              63.579              63.579              63.579              63.579              63.579              63.579              63.579              63.579               63.579               63.579               63.579               63.579               63.579      
         65.167              65.167              65.167              65.167              65.167              65.167              65.167              65.167              65.167              65.167               65.167               65.167               65.167               65.167               65.167      
         66.755              66.755              66.755              66.755              66.755              66.755              66.755              66.755              66.755              66.755               66.755               66.755               66.755               66.755               66.755      
         68.342              68.342              68.342              68.342              68.342              68.342              68.342              68.342              68.342              68.342               68.342               68.342               68.342               68.342               68.342      
          69.93               69.93               69.93               69.93               69.93               69.93               69.93               69.93               69.93               69.93                69.93                69.93                69.93                69.93                69.93      

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Aprime: mt_a_meshk_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        4725          15

    mt_a_meshk_full1    mt_a_meshk_full2    mt_a_meshk_full3    mt_a_meshk_full4    mt_a_meshk_full5    mt_a_meshk_full6    mt_a_meshk_full7    mt_a_meshk_full8    mt_a_meshk_full9    mt_a_meshk_full10    mt_a_meshk_full11    mt_a_meshk_full12    mt_a_meshk_full13    mt_a_meshk_full14    mt_a_meshk_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
            -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                 -20                  -20                  -20                  -20                  -20                  -20                  -20     
        -17.881             -17.881             -17.881             -17.881             -17.881             -17.881             -17.881             -17.881             -17.881              -17.881              -17.881              -17.881              -17.881              -17.881              -17.881     
        -17.929             -17.929             -17.929             -17.929             -17.929             -17.929             -17.929             -17.929             -17.929              -17.929              -17.929              -17.929              -17.929              -17.929              -17.929     
        -17.977             -17.977             -17.977             -17.977             -17.977             -17.977             -17.977             -17.977             -17.977              -17.977              -17.977              -17.977              -17.977              -17.977              -17.977     
        -18.025             -18.025             -18.025             -18.025             -18.025             -18.025             -18.025             -18.025             -18.025              -18.025              -18.025              -18.025              -18.025              -18.025              -18.025     
        -18.073             -18.073             -18.073             -18.073             -18.073             -18.073             -18.073             -18.073             -18.073              -18.073              -18.073              -18.073              -18.073              -18.073              -18.073     
        -18.121             -18.121             -18.121             -18.121             -18.121             -18.121             -18.121             -18.121             -18.121              -18.121              -18.121              -18.121              -18.121              -18.121              -18.121     
         -18.17              -18.17              -18.17              -18.17              -18.17              -18.17              -18.17              -18.17              -18.17               -18.17               -18.17               -18.17               -18.17               -18.17               -18.17     
        -18.218             -18.218             -18.218             -18.218             -18.218             -18.218             -18.218             -18.218             -18.218              -18.218              -18.218              -18.218              -18.218              -18.218              -18.218     
        -18.266             -18.266             -18.266             -18.266             -18.266             -18.266             -18.266             -18.266             -18.266              -18.266              -18.266              -18.266              -18.266              -18.266              -18.266     
        -18.314             -18.314             -18.314             -18.314             -18.314             -18.314             -18.314             -18.314             -18.314              -18.314              -18.314              -18.314              -18.314              -18.314              -18.314     
        -18.362             -18.362             -18.362             -18.362             -18.362             -18.362             -18.362             -18.362             -18.362              -18.362              -18.362              -18.362              -18.362              -18.362              -18.362     
         -18.41              -18.41              -18.41              -18.41              -18.41              -18.41              -18.41              -18.41              -18.41               -18.41               -18.41               -18.41               -18.41               -18.41               -18.41     
        -18.458             -18.458             -18.458             -18.458             -18.458             -18.458             -18.458             -18.458             -18.458              -18.458              -18.458              -18.458              -18.458              -18.458              -18.458     
        -18.506             -18.506             -18.506             -18.506             -18.506             -18.506             -18.506             -18.506             -18.506              -18.506              -18.506              -18.506              -18.506              -18.506              -18.506     
        -18.554             -18.554             -18.554             -18.554             -18.554             -18.554             -18.554             -18.554             -18.554              -18.554              -18.554              -18.554              -18.554              -18.554              -18.554     
        -18.603             -18.603             -18.603             -18.603             -18.603             -18.603             -18.603             -18.603             -18.603              -18.603              -18.603              -18.603              -18.603              -18.603              -18.603     
        -18.651             -18.651             -18.651             -18.651             -18.651             -18.651             -18.651             -18.651             -18.651              -18.651              -18.651              -18.651              -18.651              -18.651              -18.651     
        -18.699             -18.699             -18.699             -18.699             -18.699             -18.699             -18.699             -18.699             -18.699              -18.699              -18.699              -18.699              -18.699              -18.699              -18.699     
        -18.747             -18.747             -18.747             -18.747             -18.747             -18.747             -18.747             -18.747             -18.747              -18.747              -18.747              -18.747              -18.747              -18.747              -18.747     
        -18.795             -18.795             -18.795             -18.795             -18.795             -18.795             -18.795             -18.795             -18.795              -18.795              -18.795              -18.795              -18.795              -18.795              -18.795     
        -18.843             -18.843             -18.843             -18.843             -18.843             -18.843             -18.843             -18.843             -18.843              -18.843              -18.843              -18.843              -18.843              -18.843              -18.843     
        -18.891             -18.891             -18.891             -18.891             -18.891             -18.891             -18.891             -18.891             -18.891              -18.891              -18.891              -18.891              -18.891              -18.891              -18.891     
        -18.939             -18.939             -18.939             -18.939             -18.939             -18.939             -18.939             -18.939             -18.939              -18.939              -18.939              -18.939              -18.939              -18.939              -18.939     
        -18.988             -18.988             -18.988             -18.988             -18.988             -18.988             -18.988             -18.988             -18.988              -18.988              -18.988              -18.988              -18.988              -18.988              -18.988     
        -19.036             -19.036             -19.036             -19.036             -19.036             -19.036             -19.036             -19.036             -19.036              -19.036              -19.036              -19.036              -19.036              -19.036              -19.036     

    mt_a_meshk_full1    mt_a_meshk_full2    mt_a_meshk_full3    mt_a_meshk_full4    mt_a_meshk_full5    mt_a_meshk_full6    mt_a_meshk_full7    mt_a_meshk_full8    mt_a_meshk_full9    mt_a_meshk_full10    mt_a_meshk_full11    mt_a_meshk_full12    mt_a_meshk_full13    mt_a_meshk_full14    mt_a_meshk_full15
    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    ________________    _________________    _________________    _________________    _________________    _________________    _________________

          17.019              17.019              17.019              17.019              17.019              17.019              17.019              17.019              17.019              17.019               17.019               17.019               17.019               17.019               17.019     
          15.479              15.479              15.479              15.479              15.479              15.479              15.479              15.479              15.479              15.479               15.479               15.479               15.479               15.479               15.479     
          13.939              13.939              13.939              13.939              13.939              13.939              13.939              13.939              13.939              13.939               13.939               13.939               13.939               13.939               13.939     
            12.4                12.4                12.4                12.4                12.4                12.4                12.4                12.4                12.4                12.4                 12.4                 12.4                 12.4                 12.4                 12.4     
           10.86               10.86               10.86               10.86               10.86               10.86               10.86               10.86               10.86               10.86                10.86                10.86                10.86                10.86                10.86     
          9.3206              9.3206              9.3206              9.3206              9.3206              9.3206              9.3206              9.3206              9.3206              9.3206               9.3206               9.3206               9.3206               9.3206               9.3206     
          7.7809              7.7809              7.7809              7.7809              7.7809              7.7809              7.7809              7.7809              7.7809              7.7809               7.7809               7.7809               7.7809               7.7809               7.7809     
          6.2413              6.2413              6.2413              6.2413              6.2413              6.2413              6.2413              6.2413              6.2413              6.2413               6.2413               6.2413               6.2413               6.2413               6.2413     
          4.7017              4.7017              4.7017              4.7017              4.7017              4.7017              4.7017              4.7017              4.7017              4.7017               4.7017               4.7017               4.7017               4.7017               4.7017     
          3.1621              3.1621              3.1621              3.1621              3.1621              3.1621              3.1621              3.1621              3.1621              3.1621               3.1621               3.1621               3.1621               3.1621               3.1621     
          1.6225              1.6225              1.6225              1.6225              1.6225              1.6225              1.6225              1.6225              1.6225              1.6225               1.6225               1.6225               1.6225               1.6225               1.6225     
        0.082865            0.082865            0.082865            0.082865            0.082865            0.082865            0.082865            0.082865            0.082865            0.082865             0.082865             0.082865             0.082865             0.082865             0.082865     
         -1.4567             -1.4567             -1.4567             -1.4567             -1.4567             -1.4567             -1.4567             -1.4567             -1.4567             -1.4567              -1.4567              -1.4567              -1.4567              -1.4567              -1.4567     
         -2.9964             -2.9964             -2.9964             -2.9964             -2.9964             -2.9964             -2.9964             -2.9964             -2.9964             -2.9964              -2.9964              -2.9964              -2.9964              -2.9964              -2.9964     
          -4.536              -4.536              -4.536              -4.536              -4.536              -4.536              -4.536              -4.536              -4.536              -4.536               -4.536               -4.536               -4.536               -4.536               -4.536     
         -6.0756             -6.0756             -6.0756             -6.0756             -6.0756             -6.0756             -6.0756             -6.0756             -6.0756             -6.0756              -6.0756              -6.0756              -6.0756              -6.0756              -6.0756     
         -7.6152             -7.6152             -7.6152             -7.6152             -7.6152             -7.6152             -7.6152             -7.6152             -7.6152             -7.6152              -7.6152              -7.6152              -7.6152              -7.6152              -7.6152     
         -9.1548             -9.1548             -9.1548             -9.1548             -9.1548             -9.1548             -9.1548             -9.1548             -9.1548             -9.1548              -9.1548              -9.1548              -9.1548              -9.1548              -9.1548     
         -10.694             -10.694             -10.694             -10.694             -10.694             -10.694             -10.694             -10.694             -10.694             -10.694              -10.694              -10.694              -10.694              -10.694              -10.694     
         -12.234             -12.234             -12.234             -12.234             -12.234             -12.234             -12.234             -12.234             -12.234             -12.234              -12.234              -12.234              -12.234              -12.234              -12.234     
         -13.774             -13.774             -13.774             -13.774             -13.774             -13.774             -13.774             -13.774             -13.774             -13.774              -13.774              -13.774              -13.774              -13.774              -13.774     
         -15.313             -15.313             -15.313             -15.313             -15.313             -15.313             -15.313             -15.313             -15.313             -15.313              -15.313              -15.313              -15.313              -15.313              -15.313     
         -16.853             -16.853             -16.853             -16.853             -16.853             -16.853             -16.853             -16.853             -16.853             -16.853              -16.853              -16.853              -16.853              -16.853              -16.853     
         -18.393             -18.393             -18.393             -18.393             -18.393             -18.393             -18.393             -18.393             -18.393             -18.393              -18.393              -18.393              -18.393              -18.393              -18.393     
         -19.932             -19.932             -19.932             -19.932             -19.932             -19.932             -19.932             -19.932             -19.932             -19.932              -19.932              -19.932              -19.932              -19.932              -19.932     
           49.93               49.93               49.93               49.93               49.93               49.93               49.93               49.93               49.93               49.93                49.93                49.93                49.93                49.93                49.93     
          48.342              48.342              48.342              48.342              48.342              48.342              48.342              48.342              48.342              48.342               48.342               48.342               48.342               48.342               48.342     
          46.755              46.755              46.755              46.755              46.755              46.755              46.755              46.755              46.755              46.755               46.755               46.755               46.755               46.755               46.755     
          45.167              45.167              45.167              45.167              45.167              45.167              45.167              45.167              45.167              45.167               45.167               45.167               45.167               45.167               45.167     
          43.579              43.579              43.579              43.579              43.579              43.579              43.579              43.579              43.579              43.579               43.579               43.579               43.579               43.579               43.579     
          41.991              41.991              41.991              41.991              41.991              41.991              41.991              41.991              41.991              41.991               41.991               41.991               41.991               41.991               41.991     
          40.404              40.404              40.404              40.404              40.404              40.404              40.404              40.404              40.404              40.404               40.404               40.404               40.404               40.404               40.404     
          38.816              38.816              38.816              38.816              38.816              38.816              38.816              38.816              38.816              38.816               38.816               38.816               38.816               38.816               38.816     
          37.228              37.228              37.228              37.228              37.228              37.228              37.228              37.228              37.228              37.228               37.228               37.228               37.228               37.228               37.228     
           35.64               35.64               35.64               35.64               35.64               35.64               35.64               35.64               35.64               35.64                35.64                35.64                35.64                35.64                35.64     
          34.053              34.053              34.053              34.053              34.053              34.053              34.053              34.053              34.053              34.053               34.053               34.053               34.053               34.053               34.053     
          32.465              32.465              32.465              32.465              32.465              32.465              32.465              32.465              32.465              32.465               32.465               32.465               32.465               32.465               32.465     
          30.877              30.877              30.877              30.877              30.877              30.877              30.877              30.877              30.877              30.877               30.877               30.877               30.877               30.877               30.877     
           29.29               29.29               29.29               29.29               29.29               29.29               29.29               29.29               29.29               29.29                29.29                29.29                29.29                29.29                29.29     
          27.702              27.702              27.702              27.702              27.702              27.702              27.702              27.702              27.702              27.702               27.702               27.702               27.702               27.702               27.702     
          26.114              26.114              26.114              26.114              26.114              26.114              26.114              26.114              26.114              26.114               26.114               26.114               26.114               26.114               26.114     
          24.526              24.526              24.526              24.526              24.526              24.526              24.526              24.526              24.526              24.526               24.526               24.526               24.526               24.526               24.526     
          22.939              22.939              22.939              22.939              22.939              22.939              22.939              22.939              22.939              22.939               22.939               22.939               22.939               22.939               22.939     
          21.351              21.351              21.351              21.351              21.351              21.351              21.351              21.351              21.351              21.351               21.351               21.351               21.351               21.351               21.351     
          19.763              19.763              19.763              19.763              19.763              19.763              19.763              19.763              19.763              19.763               19.763               19.763               19.763               19.763               19.763     
          18.175              18.175              18.175              18.175              18.175              18.175              18.175              18.175              18.175              18.175               18.175               18.175               18.175               18.175               18.175     
          16.588              16.588              16.588              16.588              16.588              16.588              16.588              16.588              16.588              16.588               16.588               16.588               16.588               16.588               16.588     
              15                  15                  15                  15                  15                  15                  15                  15                  15                  15                   15                   15                   15                   15                   15     
          13.412              13.412              13.412              13.412              13.412              13.412              13.412              13.412              13.412              13.412               13.412               13.412               13.412               13.412               13.412     
          11.825              11.825              11.825              11.825              11.825              11.825              11.825              11.825              11.825              11.825               11.825               11.825               11.825               11.825               11.825     
          10.237              10.237              10.237              10.237              10.237              10.237              10.237              10.237              10.237              10.237               10.237               10.237               10.237               10.237               10.237     
          8.6491              8.6491              8.6491              8.6491              8.6491              8.6491              8.6491              8.6491              8.6491              8.6491               8.6491               8.6491               8.6491               8.6491               8.6491     
          7.0614              7.0614              7.0614              7.0614              7.0614              7.0614              7.0614              7.0614              7.0614              7.0614               7.0614               7.0614               7.0614               7.0614               7.0614     
          5.4736              5.4736              5.4736              5.4736              5.4736              5.4736              5.4736              5.4736              5.4736              5.4736               5.4736               5.4736               5.4736               5.4736               5.4736     
          3.8859              3.8859              3.8859              3.8859              3.8859              3.8859              3.8859              3.8859              3.8859              3.8859               3.8859               3.8859               3.8859               3.8859               3.8859     
          2.2982              2.2982              2.2982              2.2982              2.2982              2.2982              2.2982              2.2982              2.2982              2.2982               2.2982               2.2982               2.2982               2.2982               2.2982     
         0.71045             0.71045             0.71045             0.71045             0.71045             0.71045             0.71045             0.71045             0.71045             0.71045              0.71045              0.71045              0.71045              0.71045              0.71045     
        -0.87727            -0.87727            -0.87727            -0.87727            -0.87727            -0.87727            -0.87727            -0.87727            -0.87727            -0.87727             -0.87727             -0.87727             -0.87727             -0.87727             -0.87727     
          -2.465              -2.465              -2.465              -2.465              -2.465              -2.465              -2.465              -2.465              -2.465              -2.465               -2.465               -2.465               -2.465               -2.465               -2.465     
         -4.0527             -4.0527             -4.0527             -4.0527             -4.0527             -4.0527             -4.0527             -4.0527             -4.0527             -4.0527              -4.0527              -4.0527              -4.0527              -4.0527              -4.0527     
         -5.6405             -5.6405             -5.6405             -5.6405             -5.6405             -5.6405             -5.6405             -5.6405             -5.6405             -5.6405              -5.6405              -5.6405              -5.6405              -5.6405              -5.6405     
         -7.2282             -7.2282             -7.2282             -7.2282             -7.2282             -7.2282             -7.2282             -7.2282             -7.2282             -7.2282              -7.2282              -7.2282              -7.2282              -7.2282              -7.2282     
         -8.8159             -8.8159             -8.8159             -8.8159             -8.8159             -8.8159             -8.8159             -8.8159             -8.8159             -8.8159              -8.8159              -8.8159              -8.8159              -8.8159              -8.8159     
         -10.404             -10.404             -10.404             -10.404             -10.404             -10.404             -10.404             -10.404             -10.404             -10.404              -10.404              -10.404              -10.404              -10.404              -10.404     
         -11.991             -11.991             -11.991             -11.991             -11.991             -11.991             -11.991             -11.991             -11.991             -11.991              -11.991              -11.991              -11.991              -11.991              -11.991     
         -13.579             -13.579             -13.579             -13.579             -13.579             -13.579             -13.579             -13.579             -13.579             -13.579              -13.579              -13.579              -13.579              -13.579              -13.579     
         -15.167             -15.167             -15.167             -15.167             -15.167             -15.167             -15.167             -15.167             -15.167             -15.167              -15.167              -15.167              -15.167              -15.167              -15.167     
         -16.755             -16.755             -16.755             -16.755             -16.755             -16.755             -16.755             -16.755             -16.755             -16.755              -16.755              -16.755              -16.755              -16.755              -16.755     
         -18.342             -18.342             -18.342             -18.342             -18.342             -18.342             -18.342             -18.342             -18.342             -18.342              -18.342              -18.342              -18.342              -18.342              -18.342     
          -19.93              -19.93              -19.93              -19.93              -19.93              -19.93              -19.93              -19.93              -19.93              -19.93               -19.93               -19.93               -19.93               -19.93               -19.93     

</pre><h2 id="14">Check if COH is within Borrowing Bounds</h2><p>some coh levels are below borrowing bound, can not borrow enough to pay debt</p><pre class="codeinput">mt_bl_coh_wkb_invalid = (mt_coh_wkb_full &lt; fl_b_bd);

<span class="comment">% (k,a) invalid if coh(k,a,z) &lt; bd for any z</span>
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, it_w_interp_n*fl_z_r_borr_n]);

<span class="comment">% find the first w_level choice where some k(w) percent choices are valid?</span>
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

<span class="comment">% w choices can not be lower than fl_w_level_min_valid. If w choices are</span>
<span class="comment">% lower, given the current borrowing interest rate as well as the minimum</span>
<span class="comment">% income level in the future, and the maximum borrowing level available</span>
<span class="comment">% next period, and given the shock distribution, there exists some state in</span>
<span class="comment">% the future when the household when making this choice will be unable to</span>
<span class="comment">% borrow sufficiently to maintain positive consumption.</span>
ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_borr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));
</pre><h2 id="15">Update Valid 2nd stage choice matrix</h2><p>ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n); ar_k_max = ar_w_level - fl_b_bd; mt_k = (ar_k_max'*ar_ak_perc)'; mt_a = (ar_w_level - mt_k); ar_a_meshk = mt_a(:); ar_k_mesha = mt_k(:);</p><h2 id="16">Generate 2nd Stage Cash-on-Hand Points for Interpolation</h2><pre class="codeinput"><span class="comment">% it_ak_perc_n = length(ar_ak_perc);</span>
<span class="comment">% it_w_interp_n = length(ar_w_level);</span>
it_wak_n = it_w_interp_n*it_ak_perc_n;

<span class="comment">% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);</span>
mt_coh_wkb = mt_coh_wkb_full;


mt_coh_wkb_mesh_z_r_borr = repmat(mt_coh_wkb_full, [1, fl_z_r_borr_n]);
mt_z_r_borr_mesh_coh_wkb = repmat(ar_z_r_borr, [size(mt_coh_wkb,1),1]);

mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);
mt_z_mesh_coh_wkb = repmat((1:it_z_n), [size(mt_coh_wkb,1), 1]);
mt_z_mesh_coh_wkb_seg = repmat((1:it_z_n), [it_wak_n, 1]);

<span class="keyword">if</span> (ismember(st_v_coh_z_interp_method, [<span class="string">"method_cell"</span>]))

    cl_mt_coh_wkb_mesh_z_r_borr = cell([fl_z_r_borr_n, 1]);
    <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
        it_mt_val_row_start = it_wak_n*(it_z_r_borr_ctr-1) + 1;
        it_mt_val_row_end = it_mt_val_row_start + it_wak_n - 1;
        cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr} = <span class="keyword">...</span>
            mt_coh_wkb_mesh_z_r_borr(it_mt_val_row_start:it_mt_val_row_end, :);
    <span class="keyword">end</span>

<span class="keyword">elseif</span> (ismember(st_v_coh_z_interp_method, [<span class="string">"method_idx_a"</span>, <span class="string">"method_idx_b"</span>]))

    <span class="comment">% This is borrowing with default or not condition</span>
    fl_min_mt_coh = fl_b_bd;

    cl_mt_coh_wkb_mesh_z_r_borr = cell([fl_z_r_borr_n, 1]);
    <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
        it_mt_val_row_start = it_wak_n*(it_z_r_borr_ctr-1) + 1;
        it_mt_val_row_end = it_mt_val_row_start + it_wak_n - 1;

        mt_coh_wkb_mesh_z_r_borr_seg = <span class="keyword">...</span>
            1 + ((mt_coh_wkb_mesh_z_r_borr(it_mt_val_row_start:it_mt_val_row_end, :) - fl_min_mt_coh)/fl_coh_interp_grid_gap);

        cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr} = mt_coh_wkb_mesh_z_r_borr_seg;

    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><h2 id="17">Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid</h2><p>For the iwkz problems, we solve the problem along a grid of cash-on-hand values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially, we have to coh matrxies</p><pre class="codeinput">fl_min_mt_coh = fl_b_bd;

fl_max_mt_coh = max(max(mt_coh_wkb));

<span class="comment">% This is savings only condition</span>
<span class="comment">% fl_min_mt_coh = min(min(mt_coh_wkb));</span>

<span class="comment">% This could be condition if no defaults are allowed</span>
<span class="comment">% fl_min_mt_coh = fl_w_level_min_valid;</span>


it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);
it_coh_interp_n = length(ar_interp_coh_grid);

[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);
<span class="comment">% This is meshed index, 1:it_z_n index for, common value each column</span>
mt_z_mesh_interp_coh_grid = repmat((1:it_z_n), [it_coh_interp_n, 1]);
</pre><h2 id="18">Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid</h2><p>previously, our ar_w was the first stage choice grid, the grid was the same for all coh levels. Now, for each coh level, there is a different ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is ( 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This could be a large matrix if the choice grid is large. This is the matrix of aggregate savings choices</p><pre class="codeinput"><span class="keyword">if</span> (fl_min_mt_coh &lt; 0)
    <span class="comment">% borrowing bound is below zero</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
<span class="keyword">else</span>
    <span class="comment">% savings only</span>
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
<span class="keyword">end</span>
</pre><h2 id="19">Generate Interpolation Consumption Grid</h2><p>We also interpolate over consumption to speed the program up. We only solve for u(c) at this grid for the iwkz problmes, and then interpolate other c values.</p><pre class="codeinput">fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);
</pre><h2 id="20">Initialize armt_map to store, state, choice, shock matrixes</h2><pre class="codeinput">armt_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
armtdesc_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
</pre><h2 id="21">Store armt_map (1): base arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>ar_interp_c_grid: 1 by I^c</li><li>ar_interp_coh_grid: 1 by I^{coh}</li><li>ar_w_level: 1 by I^{W=k+b}</li><li>ar_w_perc: 1 by P^{W=k+b}</li><li>ar_ak_perc: 1 by P^{k and b}</li></ol></div><p>more descriptions:</p><div><ol><li>ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation</li><li>ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)</li><li>ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level of w over which we solve the optimal percentage k' choices. Need to generate interpolant based on this so that we know optimal k* given ar_w_perc(coh) in the 1st stage</li><li>ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set. 1st stage, percentage w choice given coh, at each coh level the number of choice points is the same for this problem with percentage grid points.</li><li>ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_interp_c_grid'</span>) = ar_interp_c_grid;
armt_map(<span class="string">'ar_interp_coh_grid'</span>) = ar_interp_coh_grid;
armt_map(<span class="string">'ar_w_level'</span>) = ar_w_level;
armt_map(<span class="string">'ar_w_perc'</span>) = ar_w_perc;
armt_map(<span class="string">'ar_ak_perc'</span>) = ar_ak_perc;
</pre><h2 id="22">Store armt_map (2): 1st stage level coh on hand related arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. Dimensions are:</p><div><ol><li>mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w</li><li>mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w</li><li>mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}</li><li>mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}</li></ol></div><p>more descriptions:</p><div><ol><li><b>mt_w_perc_mesh_interp_coh_grid</b> 1st stage, generate w(coh, percent), meaning the level of w given coh and the percentage grid of ar_w_perc. Mesh this with the coh grid, Rows here correspond to percentage of w choices, columns correspond to cash-on-hand. The columns of cash-on-hand is determined by ar_interp_coh_grid, because we solve the 1st stage problem at that coh grid.</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_interp_coh_grid_mesh_z_wage'</span>) = mt_interp_coh_grid_mesh_z_wage;
armt_map(<span class="string">'mt_z_wage_mesh_interp_coh_grid'</span>) = mt_z_wage_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>) = mt_interp_coh_grid_mesh_w_perc;
armt_map(<span class="string">'mt_w_perc_mesh_interp_coh_grid'</span>) = mt_w_perc_mesh_interp_coh_grid;

armt_map(<span class="string">'mt_interp_coh_grid_mesh_z'</span>) = mt_interp_coh_grid_mesh_z;
armt_map(<span class="string">'mt_z_mesh_interp_coh_grid'</span>) = mt_z_mesh_interp_coh_grid;
</pre><h2 id="23">Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_coh_wkb: (I^k x I^w x M^r) by (M^z)</li><li>mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_coh_wkb_full;
armt_map(<span class="string">'mt_coh_wkb_mesh_z_r_borr'</span>) = mt_coh_wkb_mesh_z_r_borr;

armt_map(<span class="string">'mt_z_mesh_coh_wkb'</span>) = mt_z_mesh_coh_wkb;
armt_map(<span class="string">'mt_z_wage_mesh_coh_wkb'</span>) = mt_z_wage_mesh_coh_wkb;

armt_map(<span class="string">'cl_mt_coh_wkb_mesh_z_r_borr'</span>) = cl_mt_coh_wkb_mesh_z_r_borr;
armt_map(<span class="string">'mt_z_mesh_coh_wkb_seg'</span>) = mt_z_mesh_coh_wkb_seg;

<span class="comment">% armt_map('mt_z_r_borr_mesh_coh_wkb') = mt_z_r_borr_mesh_coh_wkb;</span>
</pre><h2 id="24">Store armt_map (4): 2nd stage additional arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_k: (I^w) by (P^{k and b})</li><li>ar_a_meshk: 1 by (I^w x P^{k and b})</li><li>ar_k_mesha: 1 by (I^w x P^{k and b})</li><li>ar_aplusk_mesh: 1 by (I^w x P^{k and b})</li><li>it_ameshk_n: scalar</li></ol></div><pre class="codeinput">armt_map(<span class="string">'mt_k'</span>) = mt_k;
armt_map(<span class="string">'ar_a_meshk'</span>) = ar_a_meshk;
armt_map(<span class="string">'ar_k_mesha'</span>) = ar_k_mesha;
armt_map(<span class="string">'ar_aplusk_mesh'</span>) = ar_aplusk_mesh;
armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_a_meshk);
</pre><h2 id="25">Store armt_map (5): Shock Grids Arrays and Mesh</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>ar_z_r_borr: 1 by (M^r)</li><li>ar_z_r_borr_prob: 1 by (M^r)</li><li>ar_z_wage: 1 by (M^z)</li><li>ar_z_wage_prob: 1 by (M^z)</li><li>ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)</li><li>ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)</li><li>ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)</li><li>ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)</li></ol></div><pre class="codeinput">armt_map(<span class="string">'ar_z_r_borr'</span>) = ar_z_r_borr;
armt_map(<span class="string">'ar_z_r_borr_prob'</span>) = ar_z_r_borr_prob;

armt_map(<span class="string">'ar_z_wage'</span>) = ar_z_wage;
armt_map(<span class="string">'ar_z_wage_prob'</span>) = ar_z_wage_prob;

armt_map(<span class="string">'ar_z_r_borr_mesh_wage_w1r2'</span>) = ar_z_r_borr_mesh_wage_w1r2;
armt_map(<span class="string">'ar_z_wage_mesh_r_borr_w1r2'</span>) = ar_z_wage_mesh_r_borr_w1r2;
armt_map(<span class="string">'ar_z_r_borr_mesh_wage_r1w2'</span>) = ar_z_r_borr_mesh_wage_r1w2;
armt_map(<span class="string">'ar_z_wage_mesh_r_borr_r1w2'</span>) = ar_z_wage_mesh_r_borr_r1w2;

armt_map(<span class="string">'mt_z_trans'</span>) = mt_z_trans;
</pre><h2 id="26">Store Function Map</h2><pre class="codeinput">func_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
func_map(<span class="string">'f_util_log'</span>) = f_util_log;
func_map(<span class="string">'f_util_crra'</span>) = f_util_crra;
func_map(<span class="string">'f_util_standin'</span>) = f_util_standin;
func_map(<span class="string">'f_util_standin_coh'</span>) = f_util_standin_coh;
func_map(<span class="string">'f_prod'</span>) = f_prod;
func_map(<span class="string">'f_inc'</span>) = f_inc;
func_map(<span class="string">'f_coh'</span>) = f_coh;
func_map(<span class="string">'f_cons'</span>) = f_cons;
</pre><h2 id="27">Graph</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids)
</pre><h2 id="29">Generate Limited Legends</h2><p>8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates</p><pre class="codeinput">    ar_it_z_r_borr = ([1 round((fl_z_r_borr_n)/2) (fl_z_r_borr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    <span class="comment">% combine by index</span>
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_borr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    <span class="comment">% legends index final</span>
    cl_st_legendCell = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', <span class="string">'zr=%3.2f;'</span>), <span class="keyword">...</span>
                                num2str(ar_z_wage_mesh_r_borr_w1r2', <span class="string">'zw=%3.2f'</span>)]);

    <span class="comment">% legends index final full mat wage only</span>
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', <span class="string">'zw=%3.2f'</span>)]);
</pre><h2 id="30">Graph 1: a and k choice grid graphs</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid, half of the grid points have NA. for the grid here, the grid points get denser as we get closer to low w = k'+b' levels. This is what is different visually about percentage points based choice grid for the 2nd stage problem.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(mt_a, mt_k, <span class="string">'blue'</span>);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
<span class="comment">%     if (length(ar_w_level_full) &lt;= 100)</span>
        scatter(ar_a_meshk, ar_k_mesha, 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
<span class="comment">%     end</span>
    <span class="keyword">if</span> (length(ar_w_level_full) &lt;= 100)
        gf_invalid_scatter = scatter(mt_a_meshk_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                                     mt_k_mesha_full(ar_bl_wkb_invalid),<span class="keyword">...</span>
                20, <span class="string">'O'</span>, <span class="string">'MarkerEdgeColor'</span>, <span class="string">'black'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'black'</span>);
    <span class="keyword">end</span>

    xline(0);
    yline(0);

    title(<span class="string">'Risky K Percentage Grids Given w=k+a (2nd Stage)'</span>)
    ylabel(<span class="string">'Capital Choice (mt\_k)'</span>)
    xlabel({<span class="string">'Borrowing (&lt;0) or Saving (&gt;0) (mt\_a)'</span><span class="keyword">...</span>
        <span class="string">'Each Diagonal Line a Different w=k+a level'</span><span class="keyword">...</span>
        <span class="string">'Percentage for Risky K along Each Diagonal'</span>})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', <span class="string">'k+a=%3.2f'</span>));

    <span class="keyword">if</span> (length(ar_w_level_full) &lt;= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = <span class="string">'Invalid: COH(a,b,z)&lt;bar(b) some z'</span>;
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">else</span>
        legend(chart([legend2plot]), legendCell([legend2plot]), <span class="string">'Location'</span>, <span class="string">'northeast'</span>);
    <span class="keyword">end</span>

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_get_funcgrid_01.png" alt=""> <h2 id="31">Graph 2: coh by shock</h2><p>compare the figure here to the same figure in <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html">ffs_akz_get_funcgrid</a>. there the grid points are on an even grid. Visually, one could see that the blue/red line segments here are always the same length, but in the ffs_akz_get_funcgrid figure, they are increasingly longer as we move towards the right. They are even because the number of percentage points available is constant regardless of w = k' + b' levels. But previously, the number of grid points available is increasing as w increases since choice grid is based on levels.</p><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>

    <span class="comment">% zero lines</span>
    xline(0);
    yline(0);

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'blue'</span>;
    yline_borrbound.LineWidth = 2.5;

    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (mt\_coh\_wkb\_full)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'</span><span class="keyword">...</span>
            <span class="string">'Super-Segment: borrow r; Sub-Segment: w=k+b; within seg increasing k'</span><span class="keyword">...</span>
            <span class="string">'For each w and z, coh maximizing k is different'</span>});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = <span class="string">'borrow-constraint'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="keyword">...</span>
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), <span class="string">'Location'</span>, <span class="string">'southeast'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_get_funcgrid_02.png" alt=""> <h2 id="32">Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    hold <span class="string">on</span>;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    <span class="keyword">for</span> m = 1:numel(chart)
        set(chart(m),<span class="string">'Color'</span>,clr(m,:))
    <span class="keyword">end</span>
    <span class="keyword">if</span> (length(ar_interp_coh_grid) &lt;= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, <span class="string">'filled'</span>, <span class="keyword">...</span>
            <span class="string">'MarkerEdgeColor'</span>, <span class="string">'b'</span>, <span class="string">'MarkerFaceColor'</span>, <span class="string">'b'</span>);
    <span class="keyword">end</span>

    <span class="comment">% invalid points separating lines</span>
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = <span class="string">'on'</span>;
    yline_borrbound.LineStyle = <span class="string">'--'</span>;
    yline_borrbound.Color = <span class="string">'red'</span>;
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = <span class="string">'off'</span>;
    yline0 = yline(0);
    yline0.HandleVisibility = <span class="string">'off'</span>;

    title({<span class="string">'Aggregate Savings Percentage Grids (1st Stage)'</span> <span class="keyword">...</span>
           <span class="string">'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'</span>});
    ylabel(<span class="string">'1st Stage Aggregate Savings Choices'</span>);
    xlabel({<span class="string">'Cash-on-Hand Levels (Interpolation Points)'</span><span class="keyword">...</span>
            <span class="string">'w(coh)&gt;min-agg-save, coh(k(w),w-k)&gt;=bar(b)'</span>});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', <span class="string">'ar w perc=%3.2f'</span>));
    legendCell{length(legendCell) + 1} = <span class="string">'min-agg-save'</span>;
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), <span class="string">'Location'</span>, <span class="string">'northwest'</span>);

    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_get_funcgrid_03.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="34">Graph Details, Generally do Not Run</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph_funcgrids_detail)
</pre><h2 id="36">Graph 1: 2nd stage coh reached by k' b' choices by index</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Index of Cash-on-Hand Discrete Point'</span> <span class="string">'x = 1:length(ar\_coh\_kpzgrid\_unique)'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_get_funcgrid_04.png" alt=""> <h2 id="37">Graph 2: 2nd stage coh reached by k' b' choices  by coh</h2><pre class="codeinput">    figure(<span class="string">'PaperPosition'</span>, [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, <span class="string">'.'</span>);
    xline(0);
    yline(0);
    title(<span class="string">'Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z'</span>);
    ylabel(<span class="string">'Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)'</span>);
    xlabel({<span class="string">'Cash-on-Hand'</span> <span class="string">'x = ar\_coh\_kpzgrid\_unique'</span>});
    grid <span class="string">on</span>;
</pre><img vspace="5" hspace="5" src="ffs_ipwkbzr_get_funcgrid_05.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="39">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_z_wage'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'ar_w_level_full'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp(<span class="string">'----------------------------------------'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(<span class="string">'mt_z_trans'</span>);
    disp(<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>);
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_z_wage
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    15

  Columns 1 through 7

    0.3474    0.4008    0.4623    0.5333    0.6152    0.7097    0.8186

  Columns 8 through 14

    0.9444    1.0894    1.2567    1.4496    1.6723    1.9291    2.2253

  Column 15

    2.5670

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ar_w_level_full
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
     1    35

  Columns 1 through 7

  -20.0000  -17.8788  -15.7576  -13.6364  -11.5152   -9.3939   -7.2727

  Columns 8 through 14

   -5.1515   -3.0303   -0.9091         0    1.2121    3.3333    5.4545

  Columns 15 through 21

    7.5758    9.6970   11.8182   13.9394   16.0606   18.1818   20.3030

  Columns 22 through 28

   22.4242   24.5455   26.6667   28.7879   30.9091   33.0303   35.1515

  Columns 29 through 35

   37.2727   39.3939   41.5152   43.6364   45.7576   47.8788   50.0000

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
mt_z_trans
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
    45    45

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

     0.0011772      0.0012141      0.0011562     0.00067516     0.00024164      5.295e-05     7.0941e-06     5.8021e-07     2.8919e-08      8.7697e-10      1.6154e-11      1.8049e-13      1.2217e-15      5.0236e-18               0        0.023544        0.024282        0.023123        0.013503       0.0048328       0.001059       0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2308e-10      3.6099e-12      2.4435e-14      1.0047e-16               0         0.23544         0.24282         0.23123         0.13503       0.048328         0.01059       0.0014188       0.00011604      5.7838e-06      1.7539e-07      3.2308e-09      3.6099e-11      2.4435e-13      1.0047e-15               0 
    0.00050823     0.00088787      0.0012502      0.0010797     0.00057172     0.00018551     3.6846e-05     4.4731e-06     3.3139e-07      1.4957e-08      4.1057e-10       6.844e-12      6.9181e-14      4.2349e-16      1.5071e-18        0.010165        0.017757        0.025005        0.021593        0.011434      0.0037102       0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.2114e-09      1.3688e-10      1.3836e-12      8.4698e-15      3.0142e-17         0.10165         0.17757         0.25005         0.21593        0.11434        0.037102       0.0073691       0.00089462      6.6277e-05      2.9913e-06      8.2114e-08      1.3688e-09      1.3836e-11      8.4698e-14      3.0142e-16 
    0.00016775     0.00047473     0.00098871      0.0012625     0.00098871     0.00047473     0.00013965     2.5139e-05     2.7653e-06      1.8556e-07       7.583e-09      1.8842e-10      2.8421e-12       2.599e-14      1.4418e-16        0.003355       0.0094946        0.019774         0.02525        0.019774      0.0094946         0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5166e-07      3.7683e-09      5.6843e-11      5.1981e-13      2.8836e-15         0.03355        0.094946         0.19774          0.2525        0.19774        0.094946         0.02793        0.0050279      0.00055305      3.7111e-05      1.5166e-06      3.7683e-08      5.6843e-10      5.1981e-12      2.8836e-14 
    4.1666e-05     0.00018551     0.00057172      0.0010797      0.0012502     0.00088787     0.00038655     0.00010308     1.6818e-05       1.676e-06      1.0186e-07      3.7688e-09      8.4759e-11      1.1569e-12      9.6177e-15      0.00083331       0.0037102        0.011434        0.021593        0.025005       0.017757         0.007731       0.0020617      0.00033636       3.352e-05      2.0372e-06      7.5377e-08      1.6952e-09      2.3137e-11      1.9235e-13       0.0083331        0.037102         0.11434         0.21593        0.25005         0.17757         0.07731         0.020617       0.0033636       0.0003352      2.0372e-05      7.5377e-07      1.6952e-08      2.3137e-10      1.9235e-12 
    7.7042e-06      5.295e-05     0.00024164     0.00067516      0.0011562      0.0012141     0.00078186     0.00030864      7.461e-05      1.1031e-05      9.9593e-07      5.4816e-08      1.8362e-09      3.7375e-11      4.6502e-13      0.00015408        0.001059       0.0048328        0.013503        0.023123       0.024282         0.015637       0.0061727       0.0014922      0.00022062      1.9919e-05      1.0963e-06      3.6724e-08      7.4749e-10      9.3005e-12       0.0015408         0.01059        0.048328         0.13503        0.23123         0.24282         0.15637         0.061727        0.014922       0.0022062      0.00019919      1.0963e-05      3.6724e-07      7.4749e-09      9.3005e-11 
    1.0526e-06     1.1031e-05      7.461e-05     0.00030864     0.00078186      0.0012141      0.0011562     0.00067516     0.00024164       5.295e-05      7.0941e-06      5.8021e-07      2.8919e-08      8.7697e-10      1.6336e-11      2.1052e-05      0.00022062       0.0014922       0.0061727        0.015637       0.024282         0.023123        0.013503       0.0048328        0.001059      0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2672e-10      0.00021052       0.0022062        0.014922        0.061727        0.15637         0.24282         0.23123          0.13503        0.048328         0.01059       0.0014188      0.00011604      5.7838e-06      1.7539e-07      3.2672e-09 
    1.0571e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655     0.00088787      0.0012502      0.0010797     0.00057172      0.00018551      3.6846e-05      4.4731e-06      3.3139e-07      1.4957e-08      4.1748e-10      2.1143e-06       3.352e-05      0.00033636       0.0020617        0.007731       0.017757         0.025005        0.021593        0.011434       0.0037102      0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.3496e-09      2.1143e-05       0.0003352       0.0033636        0.020617        0.07731         0.17757         0.25005          0.21593         0.11434        0.037102       0.0073691      0.00089462      6.6277e-05      2.9913e-06      8.3496e-08 
    7.7743e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965     0.00047473     0.00098871      0.0012625     0.00098871      0.00047473      0.00013965      2.5139e-05      2.7653e-06      1.8556e-07      7.7743e-09      1.5549e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793      0.0094946         0.019774         0.02525        0.019774       0.0094946        0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5549e-07      1.5549e-06      3.7111e-05      0.00055305       0.0050279        0.02793        0.094946         0.19774           0.2525         0.19774        0.094946         0.02793       0.0050279      0.00055305      3.7111e-05      1.5549e-06 
    4.1748e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05     0.00018551     0.00057172      0.0010797      0.0012502      0.00088787      0.00038655      0.00010308      1.6818e-05       1.676e-06      1.0571e-07      8.3496e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691      0.0037102         0.011434        0.021593        0.025005        0.017757        0.007731       0.0020617      0.00033636       3.352e-05      2.1143e-06      8.3496e-08      2.9913e-06      6.6277e-05      0.00089462      0.0073691        0.037102         0.11434          0.21593         0.25005         0.17757         0.07731        0.020617       0.0033636       0.0003352      2.1143e-05 
    1.6336e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06      5.295e-05     0.00024164     0.00067516      0.0011562       0.0012141      0.00078186      0.00030864       7.461e-05      1.1031e-05      1.0526e-06      3.2672e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188       0.001059        0.0048328        0.013503        0.023123        0.024282        0.015637       0.0061727       0.0014922      0.00022062      2.1052e-05      3.2672e-09      1.7539e-07      5.7838e-06      0.00011604      0.0014188         0.01059        0.048328          0.13503         0.23123         0.24282         0.15637        0.061727        0.014922       0.0022062      0.00021052 

    mt_z_trans1    mt_z_trans2    mt_z_trans3    mt_z_trans4    mt_z_trans5    mt_z_trans6    mt_z_trans7    mt_z_trans8    mt_z_trans9    mt_z_trans10    mt_z_trans11    mt_z_trans12    mt_z_trans13    mt_z_trans14    mt_z_trans15    mt_z_trans16    mt_z_trans17    mt_z_trans18    mt_z_trans19    mt_z_trans20    mt_z_trans21    mt_z_trans22    mt_z_trans23    mt_z_trans24    mt_z_trans25    mt_z_trans26    mt_z_trans27    mt_z_trans28    mt_z_trans29    mt_z_trans30    mt_z_trans31    mt_z_trans32    mt_z_trans33    mt_z_trans34    mt_z_trans35    mt_z_trans36    mt_z_trans37    mt_z_trans38    mt_z_trans39    mt_z_trans40    mt_z_trans41    mt_z_trans42    mt_z_trans43    mt_z_trans44    mt_z_trans45
    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ___________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________    ____________

    1.0526e-06     1.1031e-05      7.461e-05     0.00030864     0.00078186      0.0012141      0.0011562     0.00067516     0.00024164       5.295e-05      7.0941e-06      5.8021e-07      2.8919e-08      8.7697e-10      1.6336e-11      2.1052e-05      0.00022062       0.0014922       0.0061727        0.015637        0.024282        0.023123        0.013503       0.0048328       0.001059       0.00014188      1.1604e-05      5.7838e-07      1.7539e-08      3.2672e-10      0.00021052       0.0022062        0.014922        0.061727         0.15637         0.24282         0.23123         0.13503       0.048328         0.01059       0.0014188       0.00011604      5.7838e-06      1.7539e-07      3.2672e-09 
    1.0571e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655     0.00088787      0.0012502      0.0010797     0.00057172      0.00018551      3.6846e-05      4.4731e-06      3.3139e-07      1.4957e-08      4.1748e-10      2.1143e-06       3.352e-05      0.00033636       0.0020617        0.007731        0.017757        0.025005        0.021593        0.011434      0.0037102       0.00073691      8.9462e-05      6.6277e-06      2.9913e-07      8.3496e-09      2.1143e-05       0.0003352       0.0033636        0.020617         0.07731         0.17757         0.25005         0.21593        0.11434        0.037102       0.0073691       0.00089462      6.6277e-05      2.9913e-06      8.3496e-08 
    7.7743e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965     0.00047473     0.00098871      0.0012625     0.00098871      0.00047473      0.00013965      2.5139e-05      2.7653e-06      1.8556e-07      7.7743e-09      1.5549e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793       0.0094946        0.019774         0.02525        0.019774      0.0094946         0.002793      0.00050279      5.5305e-05      3.7111e-06      1.5549e-07      1.5549e-06      3.7111e-05      0.00055305       0.0050279         0.02793        0.094946         0.19774          0.2525        0.19774        0.094946         0.02793        0.0050279      0.00055305      3.7111e-05      1.5549e-06 
    4.1748e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05     0.00018551     0.00057172      0.0010797      0.0012502      0.00088787      0.00038655      0.00010308      1.6818e-05       1.676e-06      1.0571e-07      8.3496e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691       0.0037102        0.011434        0.021593        0.025005       0.017757         0.007731       0.0020617      0.00033636       3.352e-05      2.1143e-06      8.3496e-08      2.9913e-06      6.6277e-05      0.00089462       0.0073691        0.037102         0.11434         0.21593        0.25005         0.17757         0.07731         0.020617       0.0033636       0.0003352      2.1143e-05 
    1.6336e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06      5.295e-05     0.00024164     0.00067516      0.0011562       0.0012141      0.00078186      0.00030864       7.461e-05      1.1031e-05      1.0526e-06      3.2672e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188        0.001059       0.0048328        0.013503        0.023123       0.024282         0.015637       0.0061727       0.0014922      0.00022062      2.1052e-05      3.2672e-09      1.7539e-07      5.7838e-06      0.00011604       0.0014188         0.01059        0.048328         0.13503        0.23123         0.24282         0.15637         0.061727        0.014922       0.0022062      0.00021052 
    4.6502e-13     3.7375e-11     1.8362e-09     5.4816e-08     9.9593e-07     1.1031e-05      7.461e-05     0.00030864     0.00078186       0.0012141       0.0011562      0.00067516      0.00024164       5.295e-05      7.7042e-06      9.3005e-12      7.4749e-10      3.6724e-08      1.0963e-06      1.9919e-05      0.00022062       0.0014922       0.0061727        0.015637       0.024282         0.023123        0.013503       0.0048328        0.001059      0.00015408      9.3005e-11      7.4749e-09      3.6724e-07      1.0963e-05      0.00019919       0.0022062        0.014922        0.061727        0.15637         0.24282         0.23123          0.13503        0.048328         0.01059       0.0015408 
    9.6179e-15     1.1569e-12     8.4759e-11     3.7688e-09     1.0186e-07      1.676e-06     1.6818e-05     0.00010308     0.00038655      0.00088787       0.0012502       0.0010797      0.00057172      0.00018551      4.1666e-05      1.9236e-13      2.3137e-11      1.6952e-09      7.5377e-08      2.0372e-06       3.352e-05      0.00033636       0.0020617        0.007731       0.017757         0.025005        0.021593        0.011434       0.0037102      0.00083331      1.9236e-12      2.3137e-10      1.6952e-08      7.5377e-07      2.0372e-05       0.0003352       0.0033636        0.020617        0.07731         0.17757         0.25005          0.21593         0.11434        0.037102       0.0083331 
    1.4438e-16      2.599e-14     2.8421e-12     1.8842e-10      7.583e-09     1.8556e-07     2.7653e-06     2.5139e-05     0.00013965      0.00047473      0.00098871       0.0012625      0.00098871      0.00047473      0.00016775      2.8877e-15       5.198e-13      5.6843e-11      3.7683e-09      1.5166e-07      3.7111e-06      5.5305e-05      0.00050279        0.002793      0.0094946         0.019774         0.02525        0.019774       0.0094946        0.003355      2.8877e-14       5.198e-12      5.6843e-10      3.7683e-08      1.5166e-06      3.7111e-05      0.00055305       0.0050279        0.02793        0.094946         0.19774           0.2525         0.19774        0.094946         0.03355 
     1.572e-18     4.2351e-16     6.9181e-14      6.844e-12     4.1057e-10     1.4957e-08     3.3139e-07     4.4731e-06     3.6846e-05      0.00018551      0.00057172       0.0010797       0.0012502      0.00088787      0.00050823      3.1439e-17      8.4703e-15      1.3836e-12      1.3688e-10      8.2114e-09      2.9913e-07      6.6277e-06      8.9462e-05      0.00073691      0.0037102         0.011434        0.021593        0.025005        0.017757        0.010165      3.1439e-16      8.4703e-14      1.3836e-11      1.3688e-09      8.2114e-08      2.9913e-06      6.6277e-05      0.00089462      0.0073691        0.037102         0.11434          0.21593         0.25005         0.17757         0.10165 
    1.2404e-20      5.003e-18     1.2216e-15     1.8049e-13     1.6154e-11     8.7697e-10     2.8919e-08     5.8021e-07     7.0941e-06       5.295e-05      0.00024164      0.00067516       0.0011562       0.0012141       0.0011772      2.4807e-19      1.0006e-16      2.4433e-14      3.6099e-12      3.2308e-10      1.7539e-08      5.7838e-07      1.1604e-05      0.00014188       0.001059        0.0048328        0.013503        0.023123        0.024282        0.023544      2.4807e-18      1.0006e-15      2.4433e-13      3.6099e-11      3.2308e-09      1.7539e-07      5.7838e-06      0.00011604      0.0014188         0.01059        0.048328          0.13503         0.23123         0.24282         0.23544 

</pre><h2 id="40">Display</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
<span class="keyword">end</span>
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 31
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = ar_a_meshk ;rown= 1575 ,coln= 1
ar_a_meshk :mu= -2.7143 ,sd= 15.737 ,min= -20 ,max= 49.93
                     zi_1_c1
                     _______

    zi_1_R1              -20
    zi_2_R2              -20
    zi_788_R788      -3.0303
    zi_1574_r1574    -18.342
    zi_1575_r1575     -19.93

pos = 2 ; key = ar_ak_perc ;rown= 1 ,coln= 45
ar_ak_perc :mu= 0.5 ,sd= 0.2979 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_23_c23    zi_44_c44    zi_45_c45
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.023682       0.5        0.97632       0.999  

pos = 3 ; key = ar_aplusk_mesh ;rown= 1575 ,coln= 1
ar_aplusk_mesh :mu= 14.5714 ,sd= 20.6694 ,min= -20 ,max= 50
                     zi_1_c1
                     _______

    zi_1_R1             -20 
    zi_2_R2             -20 
    zi_788_R788      13.939 
    zi_1574_r1574        50 
    zi_1575_r1575        50 

pos = 4 ; key = ar_interp_c_grid ;rown= 1 ,coln= 772571
ar_interp_c_grid :mu= 38.6486 ,sd= 22.3023 ,min= 0.02 ,max= 77.2772
               zi_1_C1    zi_2_C2    zi_386286_c386286    zi_772570_c772570    zi_772571_c772571
               _______    _______    _________________    _________________    _________________

    zi_1_r1     0.02      0.0201          38.649               77.277               77.277      

pos = 5 ; key = ar_interp_coh_grid ;rown= 1 ,coln= 38
ar_interp_coh_grid :mu= 18.1481 ,sd= 23.1179 ,min= -20 ,max= 57.2772
               zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.853     16.492       55.131       57.277  

pos = 6 ; key = ar_k_mesha ;rown= 1575 ,coln= 1
ar_k_mesha :mu= 17.2857 ,sd= 15.737 ,min= 0 ,max= 69.93
                     zi_1_c1
                     _______

    zi_1_R1               0 
    zi_2_R2               0 
    zi_788_R788       16.97 
    zi_1574_r1574    68.342 
    zi_1575_r1575     69.93 

pos = 7 ; key = ar_w_level ;rown= 1 ,coln= 35
ar_w_level :mu= 14.5714 ,sd= 20.9645 ,min= -20 ,max= 50
               zi_1_C1    zi_2_C2    zi_18_c18    zi_34_c34    zi_35_c35
               _______    _______    _________    _________    _________

    zi_1_r1      -20      -17.879     13.939       47.879         50    

pos = 8 ; key = ar_w_perc ;rown= 1 ,coln= 25
ar_w_perc :mu= 0.5 ,sd= 0.30605 ,min= 0.001 ,max= 0.999
               zi_1_C1    zi_2_C2     zi_13_c13    zi_24_c24    zi_25_c25
               _______    ________    _________    _________    _________

    zi_1_r1     0.001     0.042583       0.5        0.95742       0.999  

pos = 9 ; key = ar_z_r_borr ;rown= 1 ,coln= 3
ar_z_r_borr :mu= 0.4875 ,sd= 0.4625 ,min= 0.025 ,max= 0.95
               zi_1_c1    zi_2_c2    zi_3_c3
               _______    _______    _______

    zi_1_r1     0.025     0.4875      0.95  

pos = 10 ; key = ar_z_r_borr_mesh_wage_r1w2 ;rown= 1 ,coln= 45
ar_z_r_borr_mesh_wage_r1w2 :mu= 0.4875 ,sd= 0.3819 ,min= 0.025 ,max= 0.95
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1     0.025     0.4875      0.4875       0.4875        0.95   

pos = 11 ; key = ar_z_r_borr_mesh_wage_w1r2 ;rown= 1 ,coln= 45
ar_z_r_borr_mesh_wage_w1r2 :mu= 0.4875 ,sd= 0.3819 ,min= 0.025 ,max= 0.95
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1     0.025      0.025      0.4875        0.95         0.95   

pos = 12 ; key = ar_z_r_borr_prob ;rown= 1 ,coln= 3
ar_z_r_borr_prob :mu= 0.33333 ,sd= 0.49692 ,min= 0.0045249 ,max= 0.90498
                zi_1_c1     zi_2_c2     zi_3_c3
               _________    ________    _______

    zi_1_r1    0.0045249    0.090498    0.90498

pos = 13 ; key = ar_z_wage ;rown= 1 ,coln= 15
ar_z_wage :mu= 1.1347 ,sd= 0.69878 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
               _______    _______    _______    _________    _________

    zi_1_r1    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 14 ; key = ar_z_wage_mesh_r_borr_r1w2 ;rown= 1 ,coln= 45
ar_z_wage_mesh_r_borr_r1w2 :mu= 1.1347 ,sd= 0.68271 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.34741     0.94436       2.567        2.567  

pos = 15 ; key = ar_z_wage_mesh_r_borr_w1r2 ;rown= 1 ,coln= 45
ar_z_wage_mesh_r_borr_w1r2 :mu= 1.1347 ,sd= 0.68271 ,min= 0.34741 ,max= 2.567
               zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
               _______    _______    _________    _________    _________

    zi_1_r1    0.34741    0.40076     0.94436      2.2253        2.567  

pos = 16 ; key = ar_z_wage_prob ;rown= 1 ,coln= 15
ar_z_wage_prob :mu= 0.066667 ,sd= 0.060897 ,min= 0.0027089 ,max= 0.16757
                zi_1_C1      zi_2_C2     zi_8_C8    zi_14_c14    zi_15_c15
               _________    _________    _______    _________    _________

    zi_1_r1    0.0027089    0.0069499    0.16757    0.0069499    0.0027089

pos = 17 ; key = cl_mt_coh_wkb_mesh_z_r_borr ;rown= 1575 ,coln= 45
cl_mt_coh_wkb_mesh_z_r_borr :mu= 16.3337 ,sd= 20.9821 ,min= -20.0564 ,max= 57.2772
                     zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                     _______    _______    _________    _________    _________

    zi_1_R1          -20.056    -20.056     -20.056      -20.056      -20.056 
    zi_2_R2          -20.056    -20.056     -20.056      -20.056      -20.056 
    zi_788_R788       13.912      14.06      15.567       19.117       20.064 
    zi_1574_r1574     46.107     46.352      48.839       54.701       56.264 
    zi_1575_r1575     45.954       46.2      48.708       54.619       56.195 

pos = 18 ; key = it_ameshk_n ; val = 1575
pos = 19 ; key = mt_coh_wkb ;rown= 4725 ,coln= 15
mt_coh_wkb :mu= 12.5868 ,sd= 23.7372 ,min= -38.5564 ,max= 57.2772
                     zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                     _______    _______    _______    _________    _________

    zi_1_R1          -20.056    -20.056    -20.056     -20.056      -20.056 
    zi_2_R2          -20.056    -20.056    -20.056     -20.056      -20.056 
    zi_2363_r2363     12.511     12.659     14.165      17.715       18.662 
    zi_4724_r4724     29.141     29.385     31.873      37.734       39.298 
    zi_4725_r4725     27.519     27.765     30.273      36.183        37.76 

pos = 20 ; key = mt_coh_wkb_mesh_z_r_borr ;rown= 4725 ,coln= 45
mt_coh_wkb_mesh_z_r_borr :mu= 12.5868 ,sd= 23.7371 ,min= -38.5564 ,max= 57.2772
                     zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                     _______    _______    _________    _________    _________

    zi_1_R1          -20.056    -20.056     -20.056      -20.056      -20.056 
    zi_2_R2          -20.056    -20.056     -20.056      -20.056      -20.056 
    zi_2363_r2363     12.511     12.659      14.165       17.715       18.662 
    zi_4724_r4724     29.141     29.385      31.873       37.734       39.298 
    zi_4725_r4725     27.519     27.765      30.273       36.183        37.76 

pos = 21 ; key = mt_interp_coh_grid_mesh_w_perc ;rown= 25 ,coln= 38
mt_interp_coh_grid_mesh_w_perc :mu= 18.1481 ,sd= 22.8237 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
                 _______    _______    _________    _________    _________

    zi_1_R1        -20      -17.853     16.492       55.131       57.277  
    zi_2_R2        -20      -17.853     16.492       55.131       57.277  
    zi_13_r13      -20      -17.853     16.492       55.131       57.277  
    zi_24_r24      -20      -17.853     16.492       55.131       57.277  
    zi_25_r25      -20      -17.853     16.492       55.131       57.277  

pos = 22 ; key = mt_interp_coh_grid_mesh_z ;rown= 38 ,coln= 45
mt_interp_coh_grid_mesh_z :mu= 18.1481 ,sd= 22.8183 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                 _______    _______    _________    _________    _________

    zi_1_R1          -20        -20         -20          -20          -20 
    zi_2_R2      -17.853    -17.853     -17.853      -17.853      -17.853 
    zi_19_r19     16.492     16.492      16.492       16.492       16.492 
    zi_37_r37     55.131     55.131      55.131       55.131       55.131 
    zi_38_r38     57.277     57.277      57.277       57.277       57.277 

pos = 23 ; key = mt_interp_coh_grid_mesh_z_wage ;rown= 38 ,coln= 15
mt_interp_coh_grid_mesh_z_wage :mu= 18.1481 ,sd= 22.8317 ,min= -20 ,max= 57.2772
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1          -20        -20        -20         -20          -20 
    zi_2_R2      -17.853    -17.853    -17.853     -17.853      -17.853 
    zi_19_r19     16.492     16.492     16.492      16.492       16.492 
    zi_37_r37     55.131     55.131     55.131      55.131       55.131 
    zi_38_r38     57.277     57.277     57.277      57.277       57.277 

pos = 24 ; key = mt_k ;rown= 45 ,coln= 35
mt_k :mu= 17.2857 ,sd= 15.737 ,min= 0 ,max= 69.93
                 zi_1_C1     zi_2_C2     zi_18_c18    zi_34_c34    zi_35_c35
                 _______    _________    _________    _________    _________

    zi_1_R1         0       0.0021212    0.033939     0.067879        0.07  
    zi_2_R2         0        0.050234     0.80375       1.6075      1.6577  
    zi_23_r23       0          1.0606       16.97       33.939          35  
    zi_44_r44       0           2.071      33.136       66.271      68.342  
    zi_45_r45       0          2.1191      33.905       67.811       69.93  

pos = 25 ; key = mt_w_perc_mesh_interp_coh_grid ;rown= 25 ,coln= 38
mt_w_perc_mesh_interp_coh_grid :mu= -0.92596 ,sd= 17.5517 ,min= -20 ,max= 57.1999
                 zi_1_C1    zi_2_C2    zi_19_c19    zi_37_c37    zi_38_c38
                 _______    _______    _________    _________    _________

    zi_1_R1        -20      -19.998     -19.964      -19.925      -19.923 
    zi_2_R2        -20      -19.909     -18.446      -16.801      -16.709 
    zi_13_r13      -20      -18.927      -1.754       17.565       18.639 
    zi_24_r24      -20      -17.945      14.938       51.931       53.986 
    zi_25_r25      -20      -17.856      16.455       55.055         57.2 

pos = 26 ; key = mt_z_mesh_coh_wkb ;rown= 4725 ,coln= 45
mt_z_mesh_coh_wkb :mu= 23 ,sd= 12.9872 ,min= 1 ,max= 45
                     zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                     _______    _______    _________    _________    _________

    zi_1_R1             1          2          23           44           45    
    zi_2_R2             1          2          23           44           45    
    zi_2363_r2363       1          2          23           44           45    
    zi_4724_r4724       1          2          23           44           45    
    zi_4725_r4725       1          2          23           44           45    

pos = 27 ; key = mt_z_mesh_coh_wkb_seg ;rown= 1575 ,coln= 45
mt_z_mesh_coh_wkb_seg :mu= 23 ,sd= 12.9873 ,min= 1 ,max= 45
                     zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                     _______    _______    _________    _________    _________

    zi_1_R1             1          2          23           44           45    
    zi_2_R2             1          2          23           44           45    
    zi_788_R788         1          2          23           44           45    
    zi_1574_r1574       1          2          23           44           45    
    zi_1575_r1575       1          2          23           44           45    

pos = 28 ; key = mt_z_mesh_interp_coh_grid ;rown= 38 ,coln= 45
mt_z_mesh_interp_coh_grid :mu= 23 ,sd= 12.991 ,min= 1 ,max= 45
                 zi_1_C1    zi_2_C2    zi_23_c23    zi_44_c44    zi_45_c45
                 _______    _______    _________    _________    _________

    zi_1_R1         1          2          23           44           45    
    zi_2_R2         1          2          23           44           45    
    zi_19_r19       1          2          23           44           45    
    zi_37_r37       1          2          23           44           45    
    zi_38_r38       1          2          23           44           45    

pos = 29 ; key = mt_z_trans ;rown= 45 ,coln= 45
mt_z_trans :mu= 0.022222 ,sd= 0.056818 ,min= 0 ,max= 0.2525
                  zi_1_C1       zi_2_C2      zi_23_c23     zi_44_c44     zi_45_c45 
                 __________    __________    __________    __________    __________

    zi_1_R1       0.0011772     0.0012141    1.1604e-05    1.0047e-15             0
    zi_2_R2      0.00050823    0.00088787    8.9462e-05    8.4698e-14    3.0142e-16
    zi_23_r23    7.7743e-09    1.8556e-07       0.02525    3.7111e-05    1.5549e-06
    zi_44_r44     1.572e-18    4.2351e-16    8.9462e-05       0.17757       0.10165
    zi_45_r45    1.2404e-20     5.003e-18    1.1604e-05       0.24282       0.23544

pos = 30 ; key = mt_z_wage_mesh_coh_wkb ;rown= 4725 ,coln= 15
mt_z_wage_mesh_coh_wkb :mu= 1.1347 ,sd= 0.67509 ,min= 0.34741 ,max= 2.567
                     zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                     _______    _______    _______    _________    _________

    zi_1_R1          0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2          0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2363_r2363    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_4724_r4724    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_4725_r4725    0.34741    0.40076    0.94436     2.2253        2.567  

pos = 31 ; key = mt_z_wage_mesh_interp_coh_grid ;rown= 38 ,coln= 15
mt_z_wage_mesh_interp_coh_grid :mu= 1.1347 ,sd= 0.67568 ,min= 0.34741 ,max= 2.567
                 zi_1_C1    zi_2_C2    zi_8_C8    zi_14_c14    zi_15_c15
                 _______    _______    _______    _________    _________

    zi_1_R1      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_2_R2      0.34741    0.40076    0.94436     2.2253        2.567  
    zi_19_r19    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_37_r37    0.34741    0.40076    0.94436     2.2253        2.567  
    zi_38_r38    0.34741    0.40076    0.94436     2.2253        2.567  

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                      i     idx    rowN       colN         mean        std          min         max  
                                      __    ___    ____    __________    ________    ________    _________    _______

    ar_a_meshk                         1     1     1575             1     -2.7143      15.737          -20      49.93
    ar_ak_perc                         2     2        1            45         0.5      0.2979        0.001      0.999
    ar_aplusk_mesh                     3     3     1575             1      14.571      20.669          -20         50
    ar_interp_c_grid                   4     4        1    7.7257e+05      38.649      22.302         0.02     77.277
    ar_interp_coh_grid                 5     5        1            38      18.148      23.118          -20     57.277
    ar_k_mesha                         6     6     1575             1      17.286      15.737            0      69.93
    ar_w_level                         7     7        1            35      14.571      20.964          -20         50
    ar_w_perc                          8     8        1            25         0.5     0.30605        0.001      0.999
    ar_z_r_borr                        9     9        1             3      0.4875      0.4625        0.025       0.95
    ar_z_r_borr_mesh_wage_r1w2        10    10        1            45      0.4875      0.3819        0.025       0.95
    ar_z_r_borr_mesh_wage_w1r2        11    11        1            45      0.4875      0.3819        0.025       0.95
    ar_z_r_borr_prob                  12    12        1             3     0.33333     0.49692    0.0045249    0.90498
    ar_z_wage                         13    13        1            15      1.1347     0.69878      0.34741      2.567
    ar_z_wage_mesh_r_borr_r1w2        14    14        1            45      1.1347     0.68271      0.34741      2.567
    ar_z_wage_mesh_r_borr_w1r2        15    15        1            45      1.1347     0.68271      0.34741      2.567
    ar_z_wage_prob                    16    16        1            15    0.066667    0.060897    0.0027089    0.16757
    cl_mt_coh_wkb_mesh_z_r_borr       17    17     1575            45      16.334      20.982      -20.056     57.277
    mt_coh_wkb                        18    19     4725            15      12.587      23.737      -38.556     57.277
    mt_coh_wkb_mesh_z_r_borr          19    20     4725            45      12.587      23.737      -38.556     57.277
    mt_interp_coh_grid_mesh_w_perc    20    21       25            38      18.148      22.824          -20     57.277
    mt_interp_coh_grid_mesh_z         21    22       38            45      18.148      22.818          -20     57.277
    mt_interp_coh_grid_mesh_z_wage    22    23       38            15      18.148      22.832          -20     57.277
    mt_k                              23    24       45            35      17.286      15.737            0      69.93
    mt_w_perc_mesh_interp_coh_grid    24    25       25            38    -0.92596      17.552          -20       57.2
    mt_z_mesh_coh_wkb                 25    26     4725            45          23      12.987            1         45
    mt_z_mesh_coh_wkb_seg             26    27     1575            45          23      12.987            1         45
    mt_z_mesh_interp_coh_grid         27    28       38            45          23      12.991            1         45
    mt_z_trans                        28    29       45            45    0.022222    0.056818            0     0.2525
    mt_z_wage_mesh_coh_wkb            29    30     4725            15      1.1347     0.67509      0.34741      2.567
    mt_z_wage_mesh_interp_coh_grid    30    31       38            15      1.1347     0.67568      0.34741      2.567

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    value
                   _    ___    _____

    it_ameshk_n    1    18     1575 

----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(fl_r_borr,z,b,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0))
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(fl_r_borr,z,b,k)(f_prod(z,k)-(fl_delta)*k+fl_w+b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(fl_r_borr,z,b,k)f_util_log((f_coh(fl_r_borr,z,b,k)-fl_b_bd).*((f_coh(fl_r_borr,z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(fl_r_borr,z,b,k)-fl_b_bd)&lt;=fl_c_min))
pos = 8 ; key = f_util_standin_coh ; val = @(coh,fl_r_borr)f_util_log((coh-fl_b_bd).*((coh&gt;0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+((coh-fl_b_bd)./(1)).*((coh&lt;=0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+(fl_c_min./(1+fl_r_borr)).*((((coh-fl_b_bd)./(1))&lt;=fl_c_min)))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i    idx    xFunction
                          _    ___    _________

    f_coh                 1     1         1    
    f_cons                2     2         2    
    f_inc                 3     3         3    
    f_prod                4     4         4    
    f_util_crra           5     5         5    
    f_util_log            6     6         6    
    f_util_standin        7     7         7    
    f_util_standin_coh    8     8         8    

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 31
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Generate States/Choices/Shocks Grids, get Functions (Interpolated + Percentage + Risky + Safe Asset + Save + Borrow + R Shock)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(varargin)
%% FFS_IPWKBZR_GET_FUNCGRID get funcs, params, states choices shocks grids
% centralized gateway for retrieving parameters, and solution grids and
% functions. Similar to
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
% ffs_akz_get_funcgrid> function. This code deals with problems with
% savings and borrowing.
%
% This file is a continuation of
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_get_funcgrid.html
% ffs_ipwkz_get_funcgrid>. A significant change here is the inclusion of
% borrowing shocks, which changes significantly the implementation of the
% two-stage solution structure. Specifically, for the coh matrix here,
% there is another dimension which is the borrowing interest rate shock
% states, which expands the number of cash-on-hand points given the same
% productivity shock z. So compared to <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkz/paramfunc/html/ffs_ipwkz_get_funcgrid.html
% ffs_ipwkz_get_funcgrid>, the same number of columns for the
% _mt_coh_wkb_full_ matirx, but more rows.
%
% Note that for borrowing, we can not start at the min(coh(k,w-k,z))
% reacheable given the w and k choice grids. That would be:
% min(coh(k,w-k,z)) < min(w). At min(coh), there is a single point, and
% also for all values between min(coh) and min(w), all percentage w_perc
% choices are below min(w), requiring extrapolation. It is in some sense
% safer to extrapolate by starting solution at min(coh) = min(w). Now, for
% the lowest levels of coh(k, w-k, z), which are < min(w), we now require
% extrapolation. But this extrapolation is straight forward, when coh <
% min(w), households have to default, the utility from default is the same
% regardless of the level of coh at the time of default. So nearest
% extrapolation is fully correct.
%
% Note that the first stage w grid is based on cash-on-hand level reached
% by the coh(k,w-k,z) possible choice and shock combinations. This
% coh(k,w-k,z) > max(w), which also means that at max(coh) grid, the w_perc
% choices at higher points require extrapolation. Extrapolation is based on
% nearest extrapolation.
%
% Note that even when w = 0, as long as interest rate is low, only the
% lowest level of borrowing is invalid.
%
% All discussion of of the word _wage_ refers to productivity shock.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param bl_input_override boolean if true varargin contained param_map and
% support_map fully overrides local default. Local default is not invoked.
% This could be important for speed if this function is getting invoked
% within certain loops. Default is 0.
%
% @return armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm. Contains these:
%
% *armt_map* base arrays:
%
% # ar_interp_c_grid: 1 by I^c
% # ar_interp_coh_grid: 1 by I^{coh}
% # ar_w_level: 1 by I^{W=k+b}
% # ar_w_perc: 1 by P^{W=k+b}
% # ar_ak_perc: 1 by P^{k and b}
%
% *armt_map* 1st stage level coh on hand related arrays:
%
% # mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w
% # mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w
% # mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}
% # mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}
%
% *armt_map* 2nd stage reachable coh(k(w), a(w,k), z', r)
%
% # mt_coh_wkb: (I^k x I^w x M^r) by (M^z)
% # mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)
%
% *armt_map* 2nd stage additional arrays
%
% # mt_k: (I^w) by (P^{k and b})
% # ar_a_meshk: 1 by (I^w x P^{k and b})
% # ar_k_mesha: 1 by (I^w x P^{k and b})
% # ar_aplusk_mesh: 1 by (I^w x P^{k and b})
% # it_ameshk_n: scalar
%
% *armt_map* Shock Grids Arrays and Mesh
%
% # ar_z_r_borr: 1 by (M^r)
% # ar_z_r_borr_prob: 1 by (M^r)
% # ar_z_wage: 1 by (M^z)
% # ar_z_wage_prob: 1 by (M^z)
% # ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)
% # ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)
% # ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)
% # ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)
%
% @return func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @example
%
%    it_param_set = 2;
%    bl_input_override = true;
%    [param_map, support_map] = ffs_ipwkbzr_set_default_param(it_param_set);
%    [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map, bl_input_override);
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_set_functions.m ffs_ipwkbzr_set_functions>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/ffto_gen_tauchen_jhl.m ffto_gen_tauchen_jhl>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/tools/fft_gen_grid_loglin.m fft_gen_grid_loglin>
%

%% Default
if (~isempty(varargin))
    
    % override when called from outside
    [param_map, support_map] = varargin{:};    
    
else
    
    close all;
    % default internal run
    [param_map, support_map] = ffs_ipwkbzr_set_default_param();

    support_map('bl_graph_funcgrids') = true;
    support_map('bl_graph_funcgrids_detail') = true;
    bl_display_funcgrids = true;
    support_map('bl_display_funcgrids') = bl_display_funcgrids;

    st_param_which = 'medium';

    if (ismember(st_param_which, ['default']))

        param_map('it_ak_perc_n') = 250;

    elseif (ismember(st_param_which, ['medium']))

        % to be able to visually see choice grid points
        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 25;
        param_map('it_ak_perc_n') = 45;

        param_map('fl_w_interp_grid_gap') = 2;
        param_map('fl_coh_interp_grid_gap') = 2;

%         param_map('fl_z_r_borr_min') = 0.025;
%         param_map('fl_z_r_borr_max') = 0.95;
%         param_map('fl_z_r_borr_n') = 3;

        param_map('fl_z_r_borr_min') = 0.025;
        param_map('fl_z_r_borr_max') = 0.95;
        param_map('fl_z_r_borr_n') = 3;

    elseif (strcmp(st_param_which, 'small'))

        param_map('fl_z_r_borr_n') = 2;
        param_map('it_z_wage_n') = 3;

        param_map('fl_b_bd') = -20; % borrow bound, = 0 if save only
        param_map('fl_default_aprime') = 0;
        param_map('bl_default') = 0; % if borrowing is default allowed

        param_map('fl_w_min') = param_map('fl_b_bd');
        param_map('it_w_perc_n') = 5;
        param_map('it_ak_perc_n') = 6;

        param_map('fl_w_interp_grid_gap') = 3;
        param_map('fl_coh_interp_grid_gap') = 3;

        param_map('fl_z_r_borr_min') = 0.025;
        param_map('fl_z_r_borr_max') = 0.95;
        param_map('fl_z_r_borr_n') = 3;

    end

    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');

    default_maps = {param_map, support_map};

    % numvarargs is the number of varagin inputted
    [default_maps{1:length(varargin)}] = varargin{:};
    param_map = [param_map; default_maps{1}];
    support_map = [support_map; default_maps{2}];

    % Display Parameters
    if (bl_display_funcgrids)
        fft_container_map_display(param_map);
        fft_container_map_display(support_map);
    end

end

%% Parse Parameters 1a

params_group = values(param_map, {'fl_b_bd', 'fl_w_min', 'fl_w_max'});
[fl_b_bd, fl_w_min, fl_w_max] = params_group{:};

params_group = values(param_map, {'fl_crra', 'fl_c_min'});
[fl_crra, fl_c_min] = params_group{:};

params_group = values(param_map, {'fl_Amean', 'fl_alpha', 'fl_delta'});
[fl_Amean, fl_alpha, fl_delta] = params_group{:};

params_group = values(param_map, {'fl_r_save', 'fl_w'});
[fl_r_save, fl_w] = params_group{:};

%% Parse Parameters 1b

params_group = values(param_map, {...
    'it_w_perc_n', 'it_ak_perc_n',...
    'it_c_interp_grid_gap', 'fl_w_interp_grid_gap', 'fl_coh_interp_grid_gap'});
[it_w_perc_n, it_ak_perc_n,...
    it_c_interp_grid_gap, fl_w_interp_grid_gap, fl_coh_interp_grid_gap] = params_group{:};

params_group = values(param_map, {'st_v_coh_z_interp_method'});
[st_v_coh_z_interp_method] = params_group{:};

%% Parse Parameters 2

% param_map shock income
params_group = values(param_map, {'it_z_wage_n', 'fl_z_wage_mu', 'fl_z_wage_rho', 'fl_z_wage_sig'});
[it_z_wage_n, fl_z_wage_mu, fl_z_wage_rho, fl_z_wage_sig] = params_group{:};

% param_map shock borrowing interest
params_group = values(param_map, {'st_z_r_borr_drv_ele_type', 'st_z_r_borr_drv_prb_type', 'fl_z_r_borr_poiss_mean', ...
    'fl_z_r_borr_max', 'fl_z_r_borr_min', 'fl_z_r_borr_n'});
[st_z_r_borr_drv_ele_type, st_z_r_borr_drv_prb_type, fl_z_r_borr_poiss_mean, ...
    fl_z_r_borr_max, fl_z_r_borr_min, fl_z_r_borr_n] = params_group{:};

% param_map shock income
params_group = values(param_map, {'it_z_n'});
[it_z_n] = params_group{:};

%% Parse Parameters 3

params_group = values(support_map, {'bl_graph_funcgrids', 'bl_graph_funcgrids_detail', 'bl_display_funcgrids'});
[bl_graph_funcgrids, bl_graph_funcgrids_detail, bl_display_funcgrids] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% G: Generate Asset and Choice Grid for 2nd stage Problem
% This generate triangular choice structure. Household choose total
% aggregate savings, and within that how much to put into risky capital and
% how much to put into safe assets, in percentages. See
% <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_set_default_param.html
% ffs_ipwkbzr_set_default_param> for details.

% percentage grid for 1st stage choice problem, level grid for 2nd stage
% solving optimal k given w and z.
ar_w_perc = linspace(0.001, 0.999, it_w_perc_n);
it_w_interp_n = ((fl_w_max-fl_w_min)/(fl_w_interp_grid_gap));
ar_w_level_full = fft_array_add_zero(linspace(fl_w_min, fl_w_max, it_w_interp_n), true);
ar_w_level = ar_w_level_full;
it_w_interp_n = length(ar_w_level_full);

% max k given w, need to consider the possibility of borrowing.
ar_k_max = ar_w_level_full - fl_b_bd;

% k percentage choice grid
ar_ak_perc = linspace(0.001, 0.999, it_ak_perc_n);

% 2nd stage percentage choice matrixes
% (ar_k_max') is it_w_interp_n by 1, and (ar_ak_perc) is 1 by it_ak_perc_n
% mt_k is a it_w_interp_n by it_ak_perc_n matrix of choice points of k'
% conditional on w, each column is a different w, each row for each col a
% different k' value.
mt_k = (ar_k_max'*ar_ak_perc)';
mt_a = (ar_w_level_full - mt_k);

% can not have choice that are beyond feasible bound given the percentage
% structure here.
mt_bl_constrained = (mt_a < fl_b_bd);
if (sum(mt_bl_constrained) > 0 )
    error('at %s second stage choice points, percentage choice exceed bounds, can not happen',...
        num2str(sum(mt_bl_constrained)));
end

ar_a_meshk_full = mt_a(:);
ar_k_mesha_full = mt_k(:);

ar_a_meshk = ar_a_meshk_full;
ar_k_mesha = ar_k_mesha_full;

%% F1: Get Shock: Income Shock (ar1)

[~, mt_z_wage_trans, ar_z_wage_prob, ar_z_wage] = ffto_gen_tauchen_jhl(fl_z_wage_mu,fl_z_wage_rho,fl_z_wage_sig,it_z_wage_n);

%% F2: Get Shock: Interest Rate Shock (iid)

% get borrowing grid and probabilities
param_dsv_map = containers.Map('KeyType','char', 'ValueType','any');
param_dsv_map('st_drv_ele_type') = st_z_r_borr_drv_ele_type;
param_dsv_map('st_drv_prb_type') = st_z_r_borr_drv_prb_type;
param_dsv_map('fl_poiss_mean') = fl_z_r_borr_poiss_mean;
param_dsv_map('fl_max') = fl_z_r_borr_max;
param_dsv_map('fl_min') = fl_z_r_borr_min;
param_dsv_map('fl_n') = fl_z_r_borr_n;
[ar_z_r_borr, ar_z_r_borr_prob] = fft_gen_discrete_var(param_dsv_map, true);

% iid transition matrix
mt_z_r_borr_prob_trans = repmat(ar_z_r_borr_prob, [length(ar_z_r_borr_prob), 1]);

%% F3: Get Shock: Mesh Shocks Together
% R is outter, W is Inner

% Kronecker product to get full transition matrix for the two shocks
mt_z_trans = kron(mt_z_r_borr_prob_trans, mt_z_wage_trans);

% mesh the shock vectors
[mt_z_wage_mesh_r_borr_w1r2, mt_z_r_borr_mesh_wage_w1r2] = ndgrid(ar_z_wage, ar_z_r_borr);
ar_z_wage_mesh_r_borr_w1r2 = mt_z_wage_mesh_r_borr_w1r2(:)';
ar_z_r_borr_mesh_wage_w1r2 = mt_z_r_borr_mesh_wage_w1r2(:)';

% mesh the shock vectors
[mt_z_r_borr_mesh_wage_r1w2, mt_z_wage_mesh_r_borr_r1w2] = ndgrid(ar_z_r_borr, ar_z_wage);
ar_z_wage_mesh_r_borr_r1w2 = mt_z_wage_mesh_r_borr_r1w2(:)';
ar_z_r_borr_mesh_wage_r1w2 = mt_z_r_borr_mesh_wage_r1w2(:)';

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_r_borr_mesh_wage_w1r2');
    disp('Prod/Wage Shock: ar_z_wage_mesh_r_borr_w1r2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_r_borr_mesh_wage_w1r2;...
                                 ar_z_wage_mesh_r_borr_w1r2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:it_z_n)));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = it_z_wage_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow R Shock: ar_z_wage_mesh_r_borr_r1w2');
    disp('Prod/Wage Shock: ar_z_r_borr_mesh_wage_r1w2');
    disp('show which shock is inner and which is outter');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');

    tb_two_shocks = array2table([ar_z_wage_mesh_r_borr_r1w2;...
                                 ar_z_r_borr_mesh_wage_r1w2]');
    cl_col_names = ["Borrow R Shock (Meshed)", "Wage R Shock (Meshed)"];
    cl_row_names = strcat('zi=', string((1:length(ar_z_r_borr_mesh_wage_r1w2))));
    tb_two_shocks.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_two_shocks.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    it_row_display = fl_z_r_borr_n*2;

    disp(size(tb_two_shocks));
    disp(head(tb_two_shocks, it_row_display));
    disp(tail(tb_two_shocks, it_row_display));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Borrow Rate Transition Matrix: mt_z_r_borr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_r_borr_prob_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr', 'r%3.2f')]);
    tb_z_r_borr_prob_trans = array2table(round(mt_z_r_borr_prob_trans(ar_it_rows, ar_it_cols), 6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_r_borr_prob_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_r_borr_prob_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_r_borr_prob_trans));
    disp(tb_z_r_borr_prob_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Wage Prod Shock Transition Matrix: mt_z_r_borr_prob_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = 15;
    it_row_n_keep = 15;
    [it_row_n, it_col_n] = size(mt_z_wage_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_wage', 'w%3.2f')]);
    tb_z_wage_trans = array2table(round(mt_z_wage_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('zi=', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('zi=', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_z_wage_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_z_wage_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_z_wage_trans));
    disp(tb_z_wage_trans);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Full Transition Matrix: mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_col_n_keep = it_z_wage_n*3;
    it_row_n_keep = it_z_wage_n*3;
    [it_row_n, it_col_n] = size(mt_z_trans);
    [ar_it_cols, ar_it_rows] = fft_row_col_subset(it_col_n, it_col_n_keep, it_row_n, it_row_n_keep);
    cl_st_full_rowscols = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', 'r%3.2f;'), ...
                                   num2str(ar_z_wage_mesh_r_borr_w1r2', 'w%3.2f')]);
    tb_mt_z_trans = array2table(round(mt_z_trans(ar_it_rows, ar_it_cols),6));
    cl_col_names = strcat('i', num2str(ar_it_cols'), ':', cl_st_full_rowscols(ar_it_cols));
    cl_row_names = strcat('i', num2str(ar_it_rows'), ':', cl_st_full_rowscols(ar_it_rows));
    tb_mt_z_trans.Properties.VariableNames = matlab.lang.makeValidName(cl_col_names);
    tb_mt_z_trans.Properties.RowNames = matlab.lang.makeValidName(cl_row_names);

    disp(size(tb_mt_z_trans));
    disp(tb_mt_z_trans);

end

%% Get Equations

[f_util_log, f_util_crra, f_util_standin, f_util_standin_coh, f_prod, f_inc, f_coh, f_cons] = ...
    ffs_ipwkbzr_set_functions(fl_crra, fl_c_min, fl_b_bd, fl_Amean, fl_alpha, fl_delta, fl_r_save, fl_w);

%% Generate Cash-on-Hand/State Matrix
% The endogenous state variable is cash-on-hand, it has it_z_n*it_a_n
% number of points, covering all reachable points when ar_a is the choice
% vector and ar_z is the shock vector. requires inputs from get Asset and
% choice grids, get shock grids, and get equations above.
%
% # mt_coh_wkb_full: this is the (I^k x I^w) by (M^r x M^z) matrix, where
% rows = it_w_interp_n*it_ak_perc_n, and cols = fl_z_r_borr_n*it_z_wage_n.
% # mt_coh_wkb_full: this is the (I^k x I^w x M^r) by (M^z) matrix, where
% rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n, and cols = it_z_wage_n.
%

mt_coh_wkb_full = f_coh(ar_z_r_borr_mesh_wage_r1w2, ar_z_wage_mesh_r_borr_r1w2, ...
                        ar_a_meshk_full, ar_k_mesha_full);

it_coh_wkb_reshape_rows = it_w_interp_n*it_ak_perc_n*fl_z_r_borr_n;
it_coh_wkb_reshape_cols = it_z_wage_n;
mt_coh_wkb_full = reshape(mt_coh_wkb_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

% Generate Aggregate Variables
ar_aplusk_mesh = ar_a_meshk_full + ar_k_mesha_full;

if (bl_display_funcgrids || bl_graph_funcgrids)

    % Genereate Table
    tab_ak_choices = array2table([ar_aplusk_mesh, ar_k_mesha_full, ar_a_meshk_full]);
    cl_col_names = {'ar_aplusk_mesh', 'ar_k_mesha_full', 'ar_a_meshk_full'};
    tab_ak_choices.Properties.VariableNames = cl_col_names;

    % Label Table Variables
    tab_ak_choices.Properties.VariableDescriptions{'ar_aplusk_mesh'} = ...
        '*ar_aplusk_mesha*: ar_aplusk_mesha = ar_a_meshk_full + ar_k_mesha_full;';
    tab_ak_choices.Properties.VariableDescriptions{'ar_a_meshk_full'} = ...
        '*ar_a_meshk_full*:';
    tab_ak_choices.Properties.VariableDescriptions{'ar_k_mesha_full'} = ...
        '*ar_k_mesha_full*:';

    cl_var_desc = tab_ak_choices.Properties.VariableDescriptions;
    for it_var_name = 1:length(cl_var_desc)
        disp(cl_var_desc{it_var_name});
    end

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('tab_ak_choices');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    it_rows_toshow = length(ar_w_level)*2;
    disp(size(tab_ak_choices));
    disp(head(array2table(tab_ak_choices), it_rows_toshow));
    disp(tail(array2table(tab_ak_choices), it_rows_toshow));

    % Generate Shock Full Mat to See coh_wkb_full zr and zw
    mt_z_r_borr_mwge_makfull = zeros([length(ar_a_meshk_full), it_z_n]) + ar_z_r_borr_mesh_wage_r1w2;
    mt_z_wage_mesh_r_makfull = zeros([length(ar_a_meshk_full), it_z_n]) + ar_z_wage_mesh_r_borr_r1w2;
    % use the same reshape command as above
    mt_z_r_borr_mwge_makfull = reshape(mt_z_r_borr_mwge_makfull, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_z_wage_mesh_r_makfull = reshape(mt_z_wage_mesh_r_makfull, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

    % Generate W and K Choices Full Mat to see which w and k
    mt_aplusk_mesh = zeros([length(ar_a_meshk_full), it_z_n]) + ar_aplusk_mesh;
    mt_a_meshk_full = zeros([length(ar_a_meshk_full), it_z_n]) + ar_a_meshk_full;
    mt_k_mesha_full = zeros([length(ar_a_meshk_full), it_z_n]) + ar_k_mesha_full;
    % use the same reshape command as above
    mt_aplusk_mesh = reshape(mt_aplusk_mesh, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_a_meshk_full = reshape(mt_a_meshk_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);
    mt_k_mesha_full = reshape(mt_k_mesha_full, [it_coh_wkb_reshape_rows, it_coh_wkb_reshape_cols]);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_coh_wkb_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_coh_wkb_full));
    disp(head(array2table(mt_coh_wkb_full), it_rows_toshow));
    disp(tail(array2table(mt_coh_wkb_full), it_rows_toshow));

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Shock Borrow R: mt_z_r_borr_mwge_makfull');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_r_borr_mwge_makfull));
    disp(head(array2table(mt_z_r_borr_mwge_makfull), it_rows_toshow));
    disp(tail(array2table(mt_z_r_borr_mwge_makfull), it_rows_toshow));
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Shock Productivity: mt_z_wage_mesh_r_makfull');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_wage_mesh_r_makfull));
    disp(head(array2table(mt_z_wage_mesh_r_makfull), it_rows_toshow));
    disp(tail(array2table(mt_z_wage_mesh_r_makfull), it_rows_toshow));
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('W = Aprime + Kprime; mt_aplusk_mesh');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_aplusk_mesh));
    disp(head(array2table(mt_aplusk_mesh), it_rows_toshow));
    disp(tail(array2table(mt_aplusk_mesh), it_rows_toshow));
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Kprime: mt_k_mesha_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_k_mesha_full));
    disp(head(array2table(mt_k_mesha_full), it_rows_toshow));
    disp(tail(array2table(mt_k_mesha_full), it_rows_toshow));
    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('Aprime: mt_a_meshk_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_a_meshk_full));
    disp(head(array2table(mt_a_meshk_full), it_rows_toshow));
    disp(tail(array2table(mt_a_meshk_full), it_rows_toshow));

end

%% Check if COH is within Borrowing Bounds
% some coh levels are below borrowing bound, can not borrow enough to pay
% debt

mt_bl_coh_wkb_invalid = (mt_coh_wkb_full < fl_b_bd);

% (k,a) invalid if coh(k,a,z) < bd for any z
ar_bl_wkb_invalid = max(mt_bl_coh_wkb_invalid,[], 2);
mt_bl_wkb_invalid = reshape(ar_bl_wkb_invalid, [it_ak_perc_n, it_w_interp_n*fl_z_r_borr_n]);

% find the first w_level choice where some k(w) percent choices are valid?
ar_bl_w_level_invalid =  min(mt_bl_wkb_invalid, [], 1);

% w choices can not be lower than fl_w_level_min_valid. If w choices are
% lower, given the current borrowing interest rate as well as the minimum
% income level in the future, and the maximum borrowing level available
% next period, and given the shock distribution, there exists some state in
% the future when the household when making this choice will be unable to
% borrow sufficiently to maintain positive consumption.
ar_w_level_full_dup = repmat(ar_w_level_full, [1,fl_z_r_borr_n]);
fl_w_level_min_valid = min(ar_w_level_full_dup(~ar_bl_w_level_invalid));

%% Update Valid 2nd stage choice matrix
% ar_w_level = linspace(fl_w_level_min_valid, fl_w_max, it_w_interp_n);
% ar_k_max = ar_w_level - fl_b_bd;
% mt_k = (ar_k_max'*ar_ak_perc)';
% mt_a = (ar_w_level - mt_k);
% ar_a_meshk = mt_a(:);
% ar_k_mesha = mt_k(:);

%% Generate 2nd Stage Cash-on-Hand Points for Interpolation

% it_ak_perc_n = length(ar_ak_perc);
% it_w_interp_n = length(ar_w_level);
it_wak_n = it_w_interp_n*it_ak_perc_n;

% mt_coh_wkb = mt_coh_wkb_full(~ar_bl_wkb_invalid, :);
mt_coh_wkb = mt_coh_wkb_full;


mt_coh_wkb_mesh_z_r_borr = repmat(mt_coh_wkb_full, [1, fl_z_r_borr_n]);
mt_z_r_borr_mesh_coh_wkb = repmat(ar_z_r_borr, [size(mt_coh_wkb,1),1]);

mt_z_wage_mesh_coh_wkb = repmat(ar_z_wage, [size(mt_coh_wkb,1),1]);
mt_z_mesh_coh_wkb = repmat((1:it_z_n), [size(mt_coh_wkb,1), 1]);
mt_z_mesh_coh_wkb_seg = repmat((1:it_z_n), [it_wak_n, 1]);

if (ismember(st_v_coh_z_interp_method, ["method_cell"]))
    
    cl_mt_coh_wkb_mesh_z_r_borr = cell([fl_z_r_borr_n, 1]);
    for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
        it_mt_val_row_start = it_wak_n*(it_z_r_borr_ctr-1) + 1;
        it_mt_val_row_end = it_mt_val_row_start + it_wak_n - 1;
        cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr} = ...
            mt_coh_wkb_mesh_z_r_borr(it_mt_val_row_start:it_mt_val_row_end, :);
    end
    
elseif (ismember(st_v_coh_z_interp_method, ["method_idx_a", "method_idx_b"]))

    % This is borrowing with default or not condition
    fl_min_mt_coh = fl_b_bd;

    cl_mt_coh_wkb_mesh_z_r_borr = cell([fl_z_r_borr_n, 1]);
    for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
        it_mt_val_row_start = it_wak_n*(it_z_r_borr_ctr-1) + 1;
        it_mt_val_row_end = it_mt_val_row_start + it_wak_n - 1;

        mt_coh_wkb_mesh_z_r_borr_seg = ...
            1 + ((mt_coh_wkb_mesh_z_r_borr(it_mt_val_row_start:it_mt_val_row_end, :) - fl_min_mt_coh)/fl_coh_interp_grid_gap);

        cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr} = mt_coh_wkb_mesh_z_r_borr_seg;

    end
    
end

%% Generate 1st Stage States: Interpolation Cash-on-hand Interpolation Grid
% For the iwkz problems, we solve the problem along a grid of cash-on-hand
% values, the interpolate to find v(k',b',z) at (k',b') choices. Crucially,
% we have to coh matrxies
fl_min_mt_coh = fl_b_bd;

fl_max_mt_coh = max(max(mt_coh_wkb));

% This is savings only condition
% fl_min_mt_coh = min(min(mt_coh_wkb));

% This could be condition if no defaults are allowed
% fl_min_mt_coh = fl_w_level_min_valid;


it_coh_interp_n = (fl_max_mt_coh-fl_min_mt_coh)/(fl_coh_interp_grid_gap);
ar_interp_coh_grid = fft_array_add_zero(linspace(fl_min_mt_coh, fl_max_mt_coh, it_coh_interp_n), true);
mt_interp_coh_grid_mesh_w_perc = repmat(ar_interp_coh_grid, [it_w_perc_n, 1]);
it_coh_interp_n = length(ar_interp_coh_grid);

[mt_interp_coh_grid_mesh_z_wage, mt_z_wage_mesh_interp_coh_grid] = ndgrid(ar_interp_coh_grid, ar_z_wage);

mt_interp_coh_grid_mesh_z = repmat(ar_interp_coh_grid', [1, it_z_n]);
% This is meshed index, 1:it_z_n index for, common value each column
mt_z_mesh_interp_coh_grid = repmat((1:it_z_n), [it_coh_interp_n, 1]);

%% Generate 1st Stage Choices: Interpolation Cash-on-hand Interpolation Grid
% previously, our ar_w was the first stage choice grid, the grid was the
% same for all coh levels. Now, for each coh level, there is a different
% ar_w. ar_interp_coh_grid is (1 by ar_interp_coh_grid) and ar_w_perc is (
% 1 by it_w_perc_n). Conditional on z, each choice matrix is (it_w_perc_n
% by ar_interp_coh_grid). Here we are pre-computing the choice matrix. This
% could be a large matrix if the choice grid is large. This is the matrix
% of aggregate savings choices
%

if (fl_min_mt_coh < 0)
    % borrowing bound is below zero
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid-fl_min_mt_coh)'*ar_w_perc)' + fl_min_mt_coh;
else
    % savings only
    mt_w_perc_mesh_interp_coh_grid = ((ar_interp_coh_grid)'*ar_w_perc)';
end


%% Generate Interpolation Consumption Grid
% We also interpolate over consumption to speed the program up. We only
% solve for u(c) at this grid for the iwkz problmes, and then interpolate
% other c values.

fl_c_max = max(max(mt_coh_wkb_full)) - fl_b_bd;
it_interp_c_grid_n = (fl_c_max-fl_c_min)/(it_c_interp_grid_gap);
ar_interp_c_grid = linspace(fl_c_min, fl_c_max, it_interp_c_grid_n);

%% Initialize armt_map to store, state, choice, shock matrixes

armt_map = containers.Map('KeyType','char', 'ValueType','any');
armtdesc_map = containers.Map('KeyType','char', 'ValueType','any');

%% Store armt_map (1): base arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # ar_interp_c_grid: 1 by I^c
% # ar_interp_coh_grid: 1 by I^{coh}
% # ar_w_level: 1 by I^{W=k+b}
% # ar_w_perc: 1 by P^{W=k+b}
% # ar_ak_perc: 1 by P^{k and b}
%
% more descriptions:
%
% # ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation
% # ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)
% # ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid. 2nd stage, level
% of w over which we solve the optimal percentage k' choices. Need to
% generate interpolant based on this so that we know optimal k* given
% ar_w_perc(coh) in the 1st stage
% # ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set.
% 1st stage, percentage w choice given coh, at each coh level the number of
% choice points is the same for this problem with
% percentage grid points.
% # ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set
%

armt_map('ar_interp_c_grid') = ar_interp_c_grid;
armt_map('ar_interp_coh_grid') = ar_interp_coh_grid;
armt_map('ar_w_level') = ar_w_level;
armt_map('ar_w_perc') = ar_w_perc;
armt_map('ar_ak_perc') = ar_ak_perc;

%% Store armt_map (2): 1st stage level coh on hand related arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. Dimensions are:
%
% # mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w
% # mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w
% # mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}
% # mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}
%
% more descriptions:
%
% # *mt_w_perc_mesh_interp_coh_grid* 1st stage, generate w(coh, percent),
% meaning the level of w given coh and the percentage grid of ar_w_perc.
% Mesh this with the coh grid, Rows here correspond to percentage of w
% choices, columns correspond to cash-on-hand. The columns of cash-on-hand
% is determined by ar_interp_coh_grid, because we solve the 1st stage
% problem at that coh grid.
%

armt_map('mt_interp_coh_grid_mesh_z_wage') = mt_interp_coh_grid_mesh_z_wage;
armt_map('mt_z_wage_mesh_interp_coh_grid') = mt_z_wage_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_w_perc') = mt_interp_coh_grid_mesh_w_perc;
armt_map('mt_w_perc_mesh_interp_coh_grid') = mt_w_perc_mesh_interp_coh_grid;

armt_map('mt_interp_coh_grid_mesh_z') = mt_interp_coh_grid_mesh_z;
armt_map('mt_z_mesh_interp_coh_grid') = mt_z_mesh_interp_coh_grid;

%% Store armt_map (3): 2nd stage reachable coh(k(w), a(w,k), z', r)
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_coh_wkb: (I^k x I^w x M^r) by (M^z)
% # mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)
%

armt_map('mt_coh_wkb') = mt_coh_wkb_full;
armt_map('mt_coh_wkb_mesh_z_r_borr') = mt_coh_wkb_mesh_z_r_borr;

armt_map('mt_z_mesh_coh_wkb') = mt_z_mesh_coh_wkb;
armt_map('mt_z_wage_mesh_coh_wkb') = mt_z_wage_mesh_coh_wkb;

armt_map('cl_mt_coh_wkb_mesh_z_r_borr') = cl_mt_coh_wkb_mesh_z_r_borr;
armt_map('mt_z_mesh_coh_wkb_seg') = mt_z_mesh_coh_wkb_seg;

% armt_map('mt_z_r_borr_mesh_coh_wkb') = mt_z_r_borr_mesh_coh_wkb;

%% Store armt_map (4): 2nd stage additional arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_k: (I^w) by (P^{k and b})
% # ar_a_meshk: 1 by (I^w x P^{k and b})
% # ar_k_mesha: 1 by (I^w x P^{k and b})
% # ar_aplusk_mesh: 1 by (I^w x P^{k and b})
% # it_ameshk_n: scalar
%

armt_map('mt_k') = mt_k;
armt_map('ar_a_meshk') = ar_a_meshk;
armt_map('ar_k_mesha') = ar_k_mesha;
armt_map('ar_aplusk_mesh') = ar_aplusk_mesh;
armt_map('it_ameshk_n') = length(ar_a_meshk);

%% Store armt_map (5): Shock Grids Arrays and Mesh
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # ar_z_r_borr: 1 by (M^r)
% # ar_z_r_borr_prob: 1 by (M^r)
% # ar_z_wage: 1 by (M^z)
% # ar_z_wage_prob: 1 by (M^z)
% # ar_z_r_borr_mesh_wage_w1r2: 1 by (M^z x M^r)
% # ar_z_wage_mesh_r_borr_w1r2: 1 by (M^z x M^r)
% # ar_z_r_borr_mesh_wage_r1w2: 1 by (M^r x M^z)
% # ar_z_wage_mesh_r_borr_r1w2: 1 by (M^r x M^z)
%

armt_map('ar_z_r_borr') = ar_z_r_borr;
armt_map('ar_z_r_borr_prob') = ar_z_r_borr_prob;

armt_map('ar_z_wage') = ar_z_wage;
armt_map('ar_z_wage_prob') = ar_z_wage_prob;

armt_map('ar_z_r_borr_mesh_wage_w1r2') = ar_z_r_borr_mesh_wage_w1r2;
armt_map('ar_z_wage_mesh_r_borr_w1r2') = ar_z_wage_mesh_r_borr_w1r2;
armt_map('ar_z_r_borr_mesh_wage_r1w2') = ar_z_r_borr_mesh_wage_r1w2;
armt_map('ar_z_wage_mesh_r_borr_r1w2') = ar_z_wage_mesh_r_borr_r1w2;

armt_map('mt_z_trans') = mt_z_trans;

%% Store Function Map
func_map = containers.Map('KeyType','char', 'ValueType','any');
func_map('f_util_log') = f_util_log;
func_map('f_util_crra') = f_util_crra;
func_map('f_util_standin') = f_util_standin;
func_map('f_util_standin_coh') = f_util_standin_coh;
func_map('f_prod') = f_prod;
func_map('f_inc') = f_inc;
func_map('f_coh') = f_coh;
func_map('f_cons') = f_cons;

%% Graph

if (bl_graph_funcgrids)

    %% Generate Limited Legends
    % 8 graph points, 2 levels of borrow rates, and 4 levels of rbr rates
    ar_it_z_r_borr = ([1 round((fl_z_r_borr_n)/2) (fl_z_r_borr_n)]);
    ar_it_z_wage = ([1 round((it_z_wage_n)/2) (it_z_wage_n)]);

    % combine by index
    mt_it_z_graph = ar_it_z_wage' + it_z_wage_n*(ar_it_z_r_borr-1);
    ar_it_z_graph = mt_it_z_graph(:)';
    ar_it_z_graph_zwage = ([1 round((it_z_wage_n)/4) 2*round((it_z_wage_n)/4) 3*round((it_z_wage_n)/4) (it_z_wage_n)]);

    % legends index final
    cl_st_legendCell = cellstr([num2str(ar_z_r_borr_mesh_wage_w1r2', 'zr=%3.2f;'), ...
                                num2str(ar_z_wage_mesh_r_borr_w1r2', 'zw=%3.2f')]);

    % legends index final full mat wage only
    cl_st_legendCell_zwage = cellstr([num2str(ar_z_wage', 'zw=%3.2f')]);


    %% Graph 1: a and k choice grid graphs
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid,
    % half of the grid points have NA. for the grid here, the grid points
    % get denser as we get closer to low w = k'+b' levels. This is what is
    % different visually about percentage points based choice grid for the
    % 2nd stage problem.

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(mt_a, mt_k, 'blue');
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
%     if (length(ar_w_level_full) <= 100)
        scatter(ar_a_meshk, ar_k_mesha, 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
%     end
    if (length(ar_w_level_full) <= 100)
        gf_invalid_scatter = scatter(mt_a_meshk_full(ar_bl_wkb_invalid),...
                                     mt_k_mesha_full(ar_bl_wkb_invalid),...
                20, 'O', 'MarkerEdgeColor', 'black', 'MarkerFaceColor', 'black');
    end

    xline(0);
    yline(0);

    title('Risky K Percentage Grids Given w=k+a (2nd Stage)')
    ylabel('Capital Choice (mt\_k)')
    xlabel({'Borrowing (<0) or Saving (>0) (mt\_a)'...
        'Each Diagonal Line a Different w=k+a level'...
        'Percentage for Risky K along Each Diagonal'})

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_level', 'k+a=%3.2f'));

    if (length(ar_w_level_full) <= 100)
        chart(length(chart)+1) = gf_invalid_scatter;
        legendCell{length(legendCell) + 1} = 'Invalid: COH(a,b,z)<bar(b) some z';
        legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northeast');
    else
        legend(chart([legend2plot]), legendCell([legend2plot]), 'Location', 'northeast');
    end

    grid on;

    %% Graph 2: coh by shock
    % compare the figure here to the same figure in
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_get_funcgrid.html
    % ffs_akz_get_funcgrid>. there the grid points are on an even grid.
    % Visually, one could see that the blue/red line segments here are
    % always the same length, but in the ffs_akz_get_funcgrid figure, they
    % are increasingly longer as we move towards the right. They are even
    % because the number of percentage points available is constant
    % regardless of w = k' + b' levels. But previously, the number of grid
    % points available is increasing as w increases since choice grid is
    % based on levels.
    %

    figure('PaperPosition', [0 0 7 4]);
    chart = plot(0:1:(size(mt_coh_wkb_full,1)-1), mt_coh_wkb_full);
    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end

    % zero lines
    xline(0);
    yline(0);

    % invalid points separating lines
    yline_borrbound = yline(fl_b_bd);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'blue';
    yline_borrbound.LineWidth = 2.5;

    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (mt\_coh\_wkb\_full)');
    xlabel({'Index of Cash-on-Hand Discrete Point (0:1:(size(mt\_coh\_wkb\_full,1)-1))'...
            'Super-Segment: borrow r; Sub-Segment: w=k+b; within seg increasing k'...
            'For each w and z, coh maximizing k is different'});

    cl_st_legendCell_here = cl_st_legendCell_zwage;

    cl_st_legendCell_here{length(cl_st_legendCell_here) + 1} = 'borrow-constraint';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), ...
                  cl_st_legendCell_here([ar_it_z_graph_zwage length(cl_st_legendCell_here)]), 'Location', 'southeast');

    grid on;

    %% Graph 3: 1st State Aggregate Savings Choices by COH interpolation grids

    figure('PaperPosition', [0 0 7 4]);
    hold on;

    chart = plot(ar_interp_coh_grid, mt_w_perc_mesh_interp_coh_grid');

    clr = jet(numel(chart));
    for m = 1:numel(chart)
        set(chart(m),'Color',clr(m,:))
    end
    if (length(ar_interp_coh_grid) <= 100)
        [~, mt_interp_coh_grid_mesh_w_perc] = ndgrid(ar_w_perc, ar_interp_coh_grid);
        scatter(mt_interp_coh_grid_mesh_w_perc(:), mt_w_perc_mesh_interp_coh_grid(:), 3, 'filled', ...
            'MarkerEdgeColor', 'b', 'MarkerFaceColor', 'b');
    end

    % invalid points separating lines
    yline_borrbound = yline(fl_w_level_min_valid);
    yline_borrbound.HandleVisibility = 'on';
    yline_borrbound.LineStyle = 'REPLACE_WITH_DASH_DASH';
    yline_borrbound.Color = 'red';
    yline_borrbound.LineWidth = 2.5;

    xline0 = xline(0);
    xline0.HandleVisibility = 'off';
    yline0 = yline(0);
    yline0.HandleVisibility = 'off';

    title({'Aggregate Savings Percentage Grids (1st Stage)' ...
           'y=mt\_w\_by\_interp\_coh\_interp\_grid, and, y=ar\_interp\_coh\_grid'});
    ylabel('1st Stage Aggregate Savings Choices');
    xlabel({'Cash-on-Hand Levels (Interpolation Points)'...
            'w(coh)>min-agg-save, coh(k(w),w-k)>=bar(b)'});

    legend2plot = fliplr([1 round(numel(chart)/3) round((2*numel(chart))/4)  numel(chart)]);
    legendCell = cellstr(num2str(ar_w_perc', 'ar w perc=%3.2f'));
    legendCell{length(legendCell) + 1} = 'min-agg-save';
    chart(length(chart)+1) = yline_borrbound;
    legend(chart([legend2plot length(legendCell)]), legendCell([legend2plot length(legendCell)]), 'Location', 'northwest');

    grid on;

end


%% Graph Details, Generally do Not Run
if (bl_graph_funcgrids_detail)

    %% Graph 1: 2nd stage coh reached by k' b' choices by index

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(1:length(ar_coh_kpzgrid_unique), ar_coh_kpzgrid_unique);
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z');
    ylabel('Cash-on-Hand (y=ar\_coh\_kpzgrid\_unique)');
    xlabel({'Index of Cash-on-Hand Discrete Point' 'x = 1:length(ar\_coh\_kpzgrid\_unique)'});
    grid on;

    %% Graph 2: 2nd stage coh reached by k' b' choices  by coh

    figure('PaperPosition', [0 0 7 4]);
    ar_coh_kpzgrid_unique = unique(sort(mt_coh_wkb_full(:)));
    scatter(ar_coh_kpzgrid_unique, ar_coh_kpzgrid_unique, '.');
    xline(0);
    yline(0);
    title('Cash-on-Hand given w(k+b),k,z; See Clearly Sparsity Density of Grid across Z');
    ylabel('Cash-on-Hand (y = ar\_coh\_kpzgrid\_unique)');
    xlabel({'Cash-on-Hand' 'x = ar\_coh\_kpzgrid\_unique'});
    grid on;
end

%% Display

if (bl_display_funcgrids)

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_z_wage');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_z_wage));
    disp(ar_z_wage);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('ar_w_level_full');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(ar_w_level_full));
    disp(ar_w_level_full);

    disp('REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp('mt_z_trans');
    disp('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx');
    disp(size(mt_z_trans));
    disp(head(array2table(mt_z_trans), 10));
    disp(tail(array2table(mt_z_trans), 10));

end


%% Display

if (bl_display_funcgrids)
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
end

end

##### SOURCE END #####
--></body></html>