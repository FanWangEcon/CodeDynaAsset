
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Risky + Safe Asset (Save + Borr + R Shock) Interpolated-Percentage (Optimized-Vectorized)</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-08-06"><meta name="DC.source" content="ff_ipwkbzr_vf_vecsv.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Risky + Safe Asset (Save + Borr + R Shock) Interpolated-Percentage (Optimized-Vectorized)</h1><!--introduction--><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">FF_IPWKBZR_VF_VECSV solve infinite horizon exo shock + endo asset problem</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameters 1</a></li><li><a href="#5">Parse Parameters 2, Asset Arrays</a></li><li><a href="#6">Parse Parameters 2, interp_coh related matrixes</a></li><li><a href="#7">Parse Parameters 3, reachable cash-on-hand</a></li><li><a href="#8">Parse Parameters 4, other asset arrays</a></li><li><a href="#9">Parse Parameters 5, Others</a></li><li><a href="#10">Initialize Output Matrixes</a></li><li><a href="#11">Initialize Convergence Conditions</a></li><li><a href="#12">Pre-calculate u(c)</a></li><li><a href="#13">Iterate Value Function</a></li><li><a href="#15">Interpolate V(coh, Z) 1: Splinterp2</a></li><li><a href="#16">Interpolate V(coh, Z) 2: griddedInterpolant(V)</a></li><li><a href="#17">Interpolate V(coh, Z) 3: Store in Cell</a></li><li><a href="#18">Interpolate V(coh, Z) 4: Single Call Full Matrix</a></li><li><a href="#19">Interpolate V(coh, Z) 5: Matrix Store</a></li><li><a href="#20">Solve Second Stage Problem k*(w,z)</a></li><li><a href="#21">Solve First Stage Problem w*(z) given k*(w,z)</a></li><li><a href="#23">A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)</a></li><li><a href="#24">B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp</a></li><li><a href="#25">C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))</a></li><li><a href="#26">D. Compute FULL U(coh_level, w_perc, z) over all w_perc</a></li><li><a href="#27">E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)</a></li><li><a href="#28">F. Store Results</a></li><li><a href="#30">Check Tolerance and Continuation</a></li><li><a href="#32">Process Optimal Choices</a></li><li><a href="#33">Display Various Containers</a></li><li><a href="#35">Display 1 support_map</a></li><li><a href="#36">Display 2 armt_map</a></li><li><a href="#37">Display 3 param_map</a></li><li><a href="#38">Display 4 func_map</a></li><li><a href="#39">Display 5 result_map</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> result_map = ff_ipwkbzr_vf_vecsv(varargin)
</pre><h2 id="2">FF_IPWKBZR_VF_VECSV solve infinite horizon exo shock + endo asset problem</h2><p>This program solves the infinite horizon dynamic savings and risky capital asset problem with some ar1 shock. This is the two step solution with interpolation and with percentage asset grids version of <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html">ff_iwkz_vf_vecsv</a>. See that file for more descriptions.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@return result_map container contains policy function matrix, value function matrix, iteration results, and policy function, value function and iteration results tables.</p><p>keys included in result_map:</p><div><ul><li>mt_val matrix states_n by shock_n matrix of converged value function grid</li><li>mt_pol_a matrix states_n by shock_n matrix of converged policy function grid</li><li>ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function difference between iteration</li><li>ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy function difference between iterations</li><li>mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the proportion of grid points at which policy function changed between current and last iteration for each element of shock</li></ul></div><p>@example</p><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ff_ipwkbzr_evf.m">ff_ipwkbzr_evf</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_set_default_param.m">ffs_ipwkbzr_set_default_param</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_get_funcgrid.m">ffs_ipwkbzr_get_funcgrid</a></li><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m">ff_akz_vf_post</a></li></ul></div><h2 id="3">Default</h2><div><ul><li>it_param_set = 1: quick test</li><li>it_param_set = 2: benchmark run</li><li>it_param_set = 3: benchmark profile</li><li>it_param_set = 4: press publish button</li></ul></div><pre class="codeinput">it_param_set = 4;
[param_map, support_map] = ffs_ipwkbzr_set_default_param(it_param_set);

<span class="comment">% parameters can be set inside ffs_ipwkbzr_set_default_param or updated here</span>
<span class="comment">% param_map('it_w_perc_n') = 50;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.025;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 0.001;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.25;</span>
<span class="comment">% param_map('it_w_perc_n') = 100;</span>
<span class="comment">% param_map('it_ak_perc_n') = param_map('it_w_perc_n');</span>
<span class="comment">% param_map('fl_z_r_borr_n') = 5;</span>
<span class="comment">% param_map('it_z_wage_n') = 15;</span>
<span class="comment">% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');</span>
<span class="comment">% param_map('fl_coh_interp_grid_gap') = 0.1;</span>
<span class="comment">% param_map('it_c_interp_grid_gap') = 10^-4;</span>
<span class="comment">% param_map('fl_w_interp_grid_gap') = 0.1;</span>

st_param_which = <span class="string">'default'</span>;

<span class="keyword">if</span> (ismember(st_param_which, [<span class="string">'default'</span>]))

    <span class="comment">% default</span>

<span class="keyword">elseif</span> (ismember(st_param_which, [<span class="string">'small'</span>]))

    param_map(<span class="string">'it_w_perc_n'</span>) = 20;
    param_map(<span class="string">'it_ak_perc_n'</span>) = param_map(<span class="string">'it_w_perc_n'</span>);
    param_map(<span class="string">'it_z_wage_n'</span>) = 4;
    param_map(<span class="string">'fl_z_r_borr_n'</span>) = 4;
    param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);

<span class="keyword">elseif</span> ismember(st_param_which, [<span class="string">'ff_ipwkbz_vf_vecsv'</span>])

    <span class="comment">% ff_ipwkbzr_evf default</span>
    param_map(<span class="string">'fl_z_r_borr_min'</span>) = 0.095;
    param_map(<span class="string">'fl_z_r_borr_max'</span>) = 0.095;
    param_map(<span class="string">'fl_z_r_borr_n'</span>) = 1;

    param_map(<span class="string">'fl_r_save'</span>) = 0.025;

    param_map(<span class="string">'it_z_n'</span>) = param_map(<span class="string">'it_z_wage_n'</span>) * param_map(<span class="string">'fl_z_r_borr_n'</span>);

<span class="keyword">end</span>

<span class="comment">% get armt and func map</span>
[armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map); <span class="comment">% 1 for override</span>
default_params = {param_map support_map armt_map func_map};
</pre><h2 id="4">Parse Parameters 1</h2><pre class="codeinput"><span class="comment">% if varargin only has param_map and support_map,</span>
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
<span class="keyword">if</span> params_len &gt;= 1 &amp;&amp; params_len &lt;= 2
    <span class="comment">% If override param_map, re-generate armt and func if they are not</span>
    <span class="comment">% provided</span>
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map);
<span class="keyword">else</span>
    <span class="comment">% Override all</span>
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
<span class="keyword">end</span>

<span class="comment">% append function name</span>
st_func_name = <span class="string">'ff_ipwkbzr_vf_vecsv'</span>;
support_map(<span class="string">'st_profile_name_main'</span>) = [st_func_name support_map(<span class="string">'st_profile_name_main'</span>)];
support_map(<span class="string">'st_mat_name_main'</span>) = [st_func_name support_map(<span class="string">'st_mat_name_main'</span>)];
support_map(<span class="string">'st_img_name_main'</span>) = [st_func_name support_map(<span class="string">'st_img_name_main'</span>)];
</pre><h2 id="5">Parse Parameters 2, Asset Arrays</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid</p><div><ol><li>ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation</li><li>ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)</li><li>ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set</li><li>ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid</li><li>ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set</li></ol></div><pre class="codeinput">params_group = values(armt_map, {<span class="keyword">...</span>
    <span class="string">'ar_interp_c_grid'</span>, <span class="string">'ar_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'ar_w_perc'</span>, <span class="string">'ar_w_level'</span>, <span class="string">'ar_ak_perc'</span>});
[ar_interp_c_grid, ar_interp_coh_grid, <span class="keyword">...</span>
    ar_w_perc, ar_w_level, ar_ak_perc] = params_group{:};
</pre><h2 id="6">Parse Parameters 2, interp_coh related matrixes</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w</li><li>mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w</li><li>mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}</li><li>mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}</li></ol></div><pre class="codeinput">params_group = values(armt_map, {<span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z_wage'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_w_perc'</span>, <span class="keyword">...</span>
    <span class="string">'mt_z_wage_mesh_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'mt_w_perc_mesh_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'mt_interp_coh_grid_mesh_z'</span>, <span class="string">'mt_z_mesh_interp_coh_grid'</span>, <span class="keyword">...</span>
    <span class="string">'cl_mt_coh_wkb_mesh_z_r_borr'</span>, <span class="string">'mt_z_mesh_coh_wkb_seg'</span>});
[mt_interp_coh_grid_mesh_z_wage, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_w_perc, <span class="keyword">...</span>
    mt_z_wage_mesh_interp_coh_grid, <span class="keyword">...</span>
    mt_w_perc_mesh_interp_coh_grid, <span class="keyword">...</span>
    mt_interp_coh_grid_mesh_z, mt_z_mesh_interp_coh_grid, <span class="keyword">...</span>
    cl_mt_coh_wkb_mesh_z_r_borr, mt_z_mesh_coh_wkb_seg] = params_group{:};
</pre><h2 id="7">Parse Parameters 3, reachable cash-on-hand</h2><p>Dimensions of Various Grids: I for level grid, M for shock grid, P for percent grid. These are grids for 1st stage solution</p><div><ol><li>mt_coh_wkb: (I^k x I^w x M^r) by (M^z)</li><li>mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)</li></ol></div><pre class="codeinput">params_group = values(armt_map, {<span class="keyword">...</span>
    <span class="string">'mt_coh_wkb'</span>, <span class="string">'mt_coh_wkb_mesh_z_r_borr'</span>, <span class="string">'mt_z_mesh_coh_wkb'</span>, <span class="string">'mt_z_wage_mesh_coh_wkb'</span>});
[mt_coh_wkb, mt_coh_wkb_mesh_z_r_borr, mt_z_mesh_coh_wkb, mt_z_wage_mesh_coh_wkb] = params_group{:};
</pre><h2 id="8">Parse Parameters 4, other asset arrays</h2><pre class="codeinput">params_group = values(armt_map, {<span class="string">'ar_a_meshk'</span>, <span class="string">'ar_k_mesha'</span>});
[ar_a_meshk, ar_k_mesha] = params_group{:};
</pre><h2 id="9">Parse Parameters 5, Others</h2><pre class="codeinput"><span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_cons] = params_group{:};

<span class="comment">% param_map</span>
params_group = values(param_map, {<span class="string">'fl_crra'</span>, <span class="string">'fl_beta'</span>, <span class="keyword">...</span>
    <span class="string">'fl_nan_replace'</span>, <span class="string">'fl_c_min'</span>, <span class="string">'bl_default'</span>, <span class="string">'fl_default_wprime'</span>});
[fl_crra, fl_beta, fl_nan_replace, fl_c_min, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'fl_tol_val'</span>, <span class="string">'fl_tol_pol'</span>, <span class="string">'it_tol_pol_nochange'</span>});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'fl_z_r_borr_n'</span>, <span class="string">'it_z_wage_n'</span>});
[it_z_n, fl_z_r_borr_n, it_z_wage_n] = params_group{:};
params_group = values(param_map, {<span class="string">'st_v_coh_z_interp_method'</span>});
[st_v_coh_z_interp_method] = params_group{:};

<span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_profile'</span>, <span class="string">'st_profile_path'</span>, <span class="keyword">...</span>
    <span class="string">'st_profile_prefix'</span>, <span class="string">'st_profile_name_main'</span>, <span class="string">'st_profile_suffix'</span>,<span class="keyword">...</span>
    <span class="string">'bl_time'</span>, <span class="string">'bl_display_defparam'</span>, <span class="string">'bl_graph_evf'</span>, <span class="string">'bl_display'</span>, <span class="string">'it_display_every'</span>, <span class="string">'bl_post'</span>});
[bl_profile, st_profile_path, <span class="keyword">...</span>
    st_profile_prefix, st_profile_name_main, st_profile_suffix, <span class="keyword">...</span>
    bl_time, bl_display_defparam, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {<span class="string">'it_display_summmat_rowmax'</span>, <span class="string">'it_display_summmat_colmax'</span>});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};
</pre><h2 id="10">Initialize Output Matrixes</h2><pre class="codeinput">mt_val_cur = zeros(length(ar_interp_coh_grid),it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),it_z_n);
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),it_z_n);

<span class="comment">% We did not need these in ff_oz_vf or ff_oz_vf_vec</span>
<span class="comment">% see</span>
<span class="comment">% &lt;https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html</span>
<span class="comment">% fs_u_c_partrepeat_main&gt; for why store using cells.</span>
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
<span class="keyword">for</span> it_z_i = 1:it_z_n
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
<span class="keyword">end</span>

clmt_val_wkb_interpolated = cell([fl_z_r_borr_n, 1]);
</pre><h2 id="11">Initialize Convergence Conditions</h2><pre class="codeinput">bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);
</pre><h2 id="12">Pre-calculate u(c)</h2><p>Interpolation, see <a href="https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html">fs_u_c_partrepeat_main</a> for why interpolate over u(c)</p><pre class="codeinput"><span class="comment">% Evaluate</span>
<span class="keyword">if</span> (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
<span class="keyword">else</span>
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
<span class="keyword">end</span>
ar_interp_u_of_c_grid(ar_interp_c_grid &lt;= fl_c_min) = fl_u_cmin;

<span class="comment">% Get Interpolant</span>
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, <span class="string">'spline'</span>, <span class="string">'nearest'</span>);
</pre><h2 id="13">Iterate Value Function</h2><p>Loop solution with 4 nested loops</p><div><ol><li>loop 1: over exogenous states</li><li>loop 2: over endogenous states</li><li>loop 3: over choices</li><li>loop 4: add future utility, integration--loop over future shocks</li></ol></div><pre class="codeinput"><span class="comment">% Start Profile</span>
<span class="keyword">if</span> (bl_profile)
    close <span class="string">all</span>;
    profile <span class="string">off</span>;
    profile <span class="string">on</span>;
<span class="keyword">end</span>

<span class="comment">% Start Timer</span>
<span class="keyword">if</span> (bl_time)
    tic;
<span class="keyword">end</span>

<span class="comment">% Value Function Iteration</span>
<span class="keyword">while</span> bl_vfi_continue
</pre><pre class="codeinput">    it_iter = it_iter + 1;
</pre><h2 id="15">Interpolate V(coh, Z) 1: Splinterp2</h2><p>Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)</p><pre class="codeinput">    <span class="keyword">if</span> (strcmp(st_v_coh_z_interp_method, <span class="string">'method_idx_a'</span>))
        <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = <span class="keyword">...</span>
                splinterp2(mt_val_cur,mt_z_mesh_coh_wkb_seg,cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="16">Interpolate V(coh, Z) 2: griddedInterpolant(V)</h2><p>Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)</p><pre class="codeinput">    <span class="keyword">if</span> (strcmp(st_v_coh_z_interp_method, <span class="string">'method_idx_b'</span>))
        <span class="comment">% Generate Interpolant for v(coh,z)</span>
        <span class="comment">% mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)</span>
        f_grid_interpolant_value = griddedInterpolant(mt_val_cur', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);
        <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = <span class="keyword">...</span>
                f_grid_interpolant_value(mt_z_mesh_coh_wkb_seg,<span class="keyword">...</span>
                                         cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="17">Interpolate V(coh, Z) 3: Store in Cell</h2><p>Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)</p><pre class="codeinput">    <span class="keyword">if</span> (strcmp(st_v_coh_z_interp_method, <span class="string">'method_cell'</span>))
        f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
            mt_z_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z', <span class="keyword">...</span>
            mt_val_cur', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

        <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n

            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = <span class="keyword">...</span>
                f_grid_interpolant_value(mt_z_mesh_coh_wkb_seg,<span class="keyword">...</span>
                                         cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="18">Interpolate V(coh, Z) 4: Single Call Full Matrix</h2><p>Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)</p><pre class="codeinput">    <span class="keyword">if</span> (strcmp(st_v_coh_z_interp_method, <span class="string">'method_matrix'</span>))
        <span class="comment">% Generate Interpolant for v(coh,z)</span>
        <span class="comment">% mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)</span>
        f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
            mt_z_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z', <span class="keyword">...</span>
            mt_val_cur', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

        <span class="comment">% Interpolate V(coh(k',b',z',r),z',r') for a specific r'</span>
        <span class="comment">% mt_z_wage_mesh_coh_wkb and mt_coh_wkb are: (I^k x I^w x M^r) by (M^z)</span>
        clmt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb_mesh_z_r_borr);
    <span class="keyword">end</span>
</pre><h2 id="19">Interpolate V(coh, Z) 5: Matrix Store</h2><p>Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)</p><pre class="codeinput">    <span class="keyword">if</span> (strcmp(st_v_coh_z_interp_method, <span class="string">'method_mat_seg'</span>))

        <span class="comment">% 1. Number of W/B/K Choice Combinations</span>
        it_ak_perc_n = length(ar_ak_perc);
        it_w_interp_n = length(ar_w_level);
        it_wak_n = it_w_interp_n*it_ak_perc_n;

        <span class="comment">% 2. Initialize V(coh(k'(w),b'(w),zr,zw'),zw',zr'))</span>
        <span class="comment">% mt_val_wkb_interpolated is: (I^k x I^w x M^r) by (M^z x M^r)</span>
        <span class="comment">% reachable cash-on-hand (as rows) and shocks next period given choices</span>
        <span class="comment">% and shocks next period.</span>
        clmt_val_wkb_interpolated = zeros([it_wak_n*fl_z_r_borr_n, it_z_n]);

        <span class="comment">% 3. Loop over possible shocks over interest rate</span>
        <span class="keyword">for</span> it_z_r_borr_ctr = 1:1:fl_z_r_borr_n

            <span class="comment">% 4. Interpolate V(coh(k',b',z',r),z',r') for a specific r'</span>
            <span class="comment">% v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see</span>
            <span class="comment">% ffs_ipwkbzr_get_funcgrid.m. Generate interpolant based on that, Then</span>
            <span class="comment">% interpolate for the coh reachable levels given the k(w,z) percentage</span>
            <span class="comment">% choice grids in the second stage of the problem.</span>
            <span class="comment">%</span>
            <span class="comment">% Note mt_val_cur/mt_val dimension is based on interpolant</span>
            <span class="comment">% cash-on-hand for rows, and meshed shocks for columns. The meshed</span>
            <span class="comment">% shock structure, see</span>
            <span class="comment">% &lt;https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html</span>
            <span class="comment">% ffs_ipwkbzr_get_funcgrid&gt; for details on how the shock grids are</span>
            <span class="comment">% formed.</span>

            <span class="comment">% Get current z_r_borr from mt_val</span>
            it_mt_val_col_start = it_z_wage_n*(it_z_r_borr_ctr-1) + 1;
            it_mt_val_col_end   = it_mt_val_col_start + it_z_wage_n - 1;
            mt_val_cur_rcolseg =  mt_val_cur(:, it_mt_val_col_start:it_mt_val_col_end);

            <span class="comment">% Generate Interpolant for v(coh,z)</span>
            <span class="comment">% mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)</span>
            f_grid_interpolant_value = griddedInterpolant(<span class="keyword">...</span>
                mt_z_wage_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z_wage', <span class="keyword">...</span>
                mt_val_cur_rcolseg', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

            <span class="comment">% Interpolate V(coh(k',b',z',r),z',r') for a specific r'</span>
            <span class="comment">% mt_z_wage_mesh_coh_wkb and mt_coh_wkb are: (I^k x I^w x M^r) by (M^z)</span>
            mt_val_wkb_interpolated_seg = f_grid_interpolant_value(mt_z_wage_mesh_coh_wkb, mt_coh_wkb);
            clmt_val_wkb_interpolated(:, it_mt_val_col_start:it_mt_val_col_end) = mt_val_wkb_interpolated_seg;

        <span class="keyword">end</span>
    <span class="keyword">end</span>
</pre><h2 id="20">Solve Second Stage Problem k*(w,z)</h2><p>This is the key difference between this function and <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> which solves the two stages jointly Interpolation first, because solution coh grid is not the same as all points reachable by k and b choices given w.</p><pre class="codeinput">    support_map(<span class="string">'bl_graph_evf'</span>) = false;
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        support_map(<span class="string">'bl_graph_evf'</span>) = bl_graph_evf;
    <span class="keyword">end</span>
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = <span class="keyword">...</span>
        ff_ipwkbzr_evf(clmt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);
</pre><h2 id="21">Solve First Stage Problem w*(z) given k*(w,z)</h2><pre class="codeinput">    <span class="comment">% loop 1: over exogenous states</span>
    <span class="keyword">for</span> it_z_i = 1:it_z_n
</pre><h2 id="23">A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)</h2><p>Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z) There are two w=k'+b' arrays. ar_w_level is the level even grid based on which we solve the 2nd stage problem in ff_ipwkbzr_evf.m. Here for each coh level, we have a different vector of w levels, but the same vector of percentage ws. So we need to interpolate to get the optimal k* and b* choices at each percentage level of w.</p><pre class="codeinput">        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);

        <span class="comment">% Interpolate (2), shift from w_level to w_perc</span>
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_perc_mesh_interp_coh_grid);
        mt_w_astar_interp_z = mt_w_perc_mesh_interp_coh_grid - mt_w_kstar_interp_z;

        <span class="comment">% changes in w_perc kstar choices</span>
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);
</pre><h2 id="24">B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp</h2><p>Note that compared to <a href="https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html">ffs_akz_set_functions</a> the mt_c here is much smaller the same number of columns (states) as in the ffs_akz_set_functions file, but the number of rows equal to ar_w length.</p><pre class="codeinput">        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), <span class="keyword">...</span>
            mt_w_astar_interp_z(mt_w_kstar_diff_idx), <span class="keyword">...</span>
            mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c &lt;= fl_c_min);
        <span class="comment">% EVAL current utility: N by N, f_util defined earlier</span>
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        <span class="comment">% Update Storage</span>
        <span class="keyword">if</span> (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        <span class="keyword">else</span>
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        <span class="keyword">end</span>
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;
</pre><h2 id="25">C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))</h2><p>Generate Interpolant for (3) EV(k*(ar_w_perc),Z)</p><pre class="codeinput">        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', <span class="string">'linear'</span>, <span class="string">'nearest'</span>);
        <span class="comment">% Interpolate (3), EVAL add on future utility, N by N + N by N</span>
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_perc_mesh_interp_coh_grid);
</pre><h2 id="26">D. Compute FULL U(coh_level, w_perc, z) over all w_perc</h2><pre class="codeinput">        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        <span class="comment">% Index update</span>
        <span class="comment">% using the method below is much faster than index replace</span>
        <span class="comment">% see &lt;https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript&gt;</span>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        <span class="comment">% Default or Not Utility Handling</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if default: only today u(cmin), transition out next period, debt wiped out</span>
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed: v = u(cmin)</span>
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        <span class="keyword">end</span>

        <span class="comment">% percentage algorithm does not have invalid (check to make sure</span>
        <span class="comment">% min percent is not 0 in ffs_ipwkbzr_get_funcgrid.m)</span>
        <span class="comment">% mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);</span>
</pre><h2 id="27">E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)</h2><p>Optimization: remember matlab is column major, rows must be choices, columns must be states <a href="https://en.wikipedia.org/wiki/Row-_and_column-major_order">COLUMN-MAJOR</a></p><pre class="codeinput">        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        <span class="comment">% Generate Linear Opti Index</span>
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        <span class="comment">% Handle Default is optimal or not</span>
        <span class="keyword">if</span> (bl_default)
            <span class="comment">% if defaulting is optimal choice, at these states, not required</span>
            <span class="comment">% to default, non-default possible, but default could be optimal</span>
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = fl_default_opti_kprime;
        <span class="keyword">else</span>
            <span class="comment">% if default is not allowed, then next period same state as now</span>
            <span class="comment">% this is absorbing state, this is the limiting case, single</span>
            <span class="comment">% state space point, lowest a and lowest shock has this.</span>
            ar_opti_aprime_z(ar_opti_c_z &lt;= fl_c_min) = min(ar_a_meshk);
            ar_opti_kprime_z(ar_opti_c_z &lt;= fl_c_min) = min(ar_k_mesha);
        <span class="keyword">end</span>
</pre><h2 id="28">F. Store Results</h2><pre class="codeinput">        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        <span class="keyword">end</span>
</pre><pre class="codeinput">    <span class="keyword">end</span>
</pre><h2 id="30">Check Tolerance and Continuation</h2><pre class="codeinput">    <span class="comment">% Difference across iterations</span>
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    <span class="comment">% Update</span>
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    <span class="comment">% Print Iteration Results</span>
    <span class="keyword">if</span> (bl_display &amp;&amp; (rem(it_iter, it_display_every)==0))
        fprintf(<span class="string">'VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n'</span>, <span class="keyword">...</span>
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);<span class="keyword">...</span>
            mean(mt_pol_a_cur,1); <span class="keyword">...</span>
            mean(mt_pol_k_cur,1); <span class="keyword">...</span>
            mt_val_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
            mt_pol_a_cur(length(ar_interp_coh_grid),:); <span class="keyword">...</span>
            mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat(<span class="string">'z'</span>, string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {<span class="string">'mval'</span>, <span class="string">'map'</span>, <span class="string">'mak'</span>, <span class="string">'Hval'</span>, <span class="string">'Hap'</span>, <span class="string">'Hak'</span>};
        disp(<span class="string">'mval = mean(mt_val_cur,1), average value over a'</span>)
        disp(<span class="string">'map  = mean(mt_pol_a_cur,1), average choice over a'</span>)
        disp(<span class="string">'mkp  = mean(mt_pol_k_cur,1), average choice over k'</span>)
        disp(<span class="string">'Hval = mt_val_cur(it_ameshk_n,:), highest a state val'</span>)
        disp(<span class="string">'Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice'</span>)
        disp(<span class="string">'mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice'</span>)
        disp(tb_valpol_iter);
    <span class="keyword">end</span>

    <span class="comment">% Continuation Conditions:</span>
    <span class="comment">% 1. if value function convergence criteria reached</span>
    <span class="comment">% 2. if policy function variation over iterations is less than</span>
    <span class="comment">% threshold</span>
    <span class="keyword">if</span> (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    <span class="keyword">elseif</span> ((it_iter == it_maxiter_val) || <span class="keyword">...</span>
            (ar_val_diff_norm(it_iter) &lt; fl_tol_val) || <span class="keyword">...</span>
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) &lt; fl_tol_pol))
        <span class="comment">% Fix to max, run again to save results if needed</span>
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    <span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>

<span class="comment">% End Timer</span>
<span class="keyword">if</span> (bl_time)
    toc;
<span class="keyword">end</span>

<span class="comment">% End Profile</span>
<span class="keyword">if</span> (bl_profile)
    profile <span class="string">off</span>
    profile <span class="string">viewer</span>
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile(<span class="string">'info'</span>), strcat(st_profile_path, st_file_name));
<span class="keyword">end</span>
</pre><h2 id="32">Process Optimal Choices</h2><pre class="codeinput">result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
result_map(<span class="string">'mt_val'</span>) = mt_val;
result_map(<span class="string">'mt_pol_idx'</span>) = mt_pol_idx;

result_map(<span class="string">'cl_mt_coh'</span>) = {mt_interp_coh_grid_mesh_z, zeros(1)};
result_map(<span class="string">'cl_mt_pol_a'</span>) = {mt_pol_a, zeros(1)};
result_map(<span class="string">'cl_mt_pol_k'</span>) = {mt_pol_k, zeros(1)};
mt_pol_c = f_cons(mt_interp_coh_grid_mesh_z, mt_pol_a, mt_pol_k);
mt_pol_c(mt_pol_c &lt;= fl_c_min) = fl_c_min;
result_map(<span class="string">'cl_mt_pol_c'</span>) = {mt_pol_c, zeros(1)};
result_map(<span class="string">'cl_mt_val'</span>) = {mt_val, zeros(1)};
result_map(<span class="string">'ar_st_pol_names'</span>) = [<span class="string">"cl_mt_val"</span>, <span class="string">"cl_mt_coh"</span>, <span class="string">"cl_mt_pol_a"</span>, <span class="string">"cl_mt_pol_k"</span>, <span class="string">"cl_mt_pol_c"</span>];

<span class="keyword">if</span> (bl_post)
    bl_input_override = true;
    result_map(<span class="string">'ar_val_diff_norm'</span>) = ar_val_diff_norm(1:it_iter_last);
    result_map(<span class="string">'ar_pol_diff_norm'</span>) = ar_pol_diff_norm(1:it_iter_last);
    result_map(<span class="string">'mt_pol_perc_change'</span>) = mt_pol_perc_change(1:it_iter_last, :);

    armt_map(<span class="string">'mt_coh_wkb_ori'</span>) = mt_coh_wkb;
    armt_map(<span class="string">'ar_a_meshk_ori'</span>) = ar_a_meshk;
    armt_map(<span class="string">'ar_k_mesha_ori'</span>) = ar_k_mesha;

    <span class="comment">% graphing based on coh_wkb, but that does not match optimal choice</span>
    <span class="comment">% matrixes for graphs.</span>
    armt_map(<span class="string">'mt_coh_wkb'</span>) = mt_interp_coh_grid_mesh_z;
    armt_map(<span class="string">'it_ameshk_n'</span>) = length(ar_interp_coh_grid);
    armt_map(<span class="string">'ar_a_meshk'</span>) = mt_interp_coh_grid_mesh_z(:,1);
    armt_map(<span class="string">'ar_k_mesha'</span>) = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur): value function difference across iterations
polgap = norm(mt_pol_a - mt_pol_a_cur): policy function difference across iterations
z1 = z1 perc change: (sum((mt_pol_a ~= mt_pol_a_cur))+sum((mt_pol_k ~= mt_pol_k_cur)))/(2*it_ameshk_n):percentage of state space points conditional on shock where the policy function is changing across iterations
                  valgap      polgap        z1           z2           z3           z4            z5           z6            z7            z8            z9           z10          z11          z12          z13          z14          z15          z16          z17           z18          z19           z20           z21           z22          z23          z24          z25          z26          z27          z28          z29           z30          z31           z32          z33          z34          z35          z36          z37          z38          z39          z40           z41           z42           z43          z44          z45          z46          z47          z48          z49          z50          z51           z52          z53          z54          z55   
                __________    _______    _________    _________    _________    _________    __________    _________    __________    __________    __________    _________    _________    _________    _________    _________    _________    _________    __________    _________    __________    __________    __________    _________    _________    _________    _________    _________    _________    _________    __________    _________    __________    _________    _________    _________    _________    _________    _________    _________    _________    __________    __________    __________    _________    _________    _________    _________    _________    _________    _________    _________    __________    _________    _________    _________    _________

    iter=1          344.08     4118.6            1            1            1            1             1            1             1             1             1            1            1            1            1            1            1            1             1            1             1             1             1            1            1            1            1            1            1            1             1            1             1            1            1            1            1            1            1            1            1             1             1             1            1            1            1            1            1            1            1            1             1            1            1            1            1
    iter=2          287.85     4777.2      0.97474      0.96762       0.9579      0.94624       0.93005      0.90997       0.88407       0.85039       0.80699      0.75389       0.6943      0.98446      0.97863      0.97021      0.96049      0.94948       0.93005      0.90997       0.88277       0.84909       0.80699      0.75648      0.99288      0.98769      0.98187      0.97215      0.96179      0.94689       0.93199      0.90674       0.87889      0.84456      0.80311            1      0.99611      0.98964      0.98251      0.97345      0.95984        0.9456       0.92876       0.90155      0.87176      0.83808            1            1            1      0.99158      0.98316       0.9728       0.96049      0.94365      0.92228      0.89313      0.86334
    iter=3          246.29     1652.3       0.9443      0.91321      0.92746      0.94948       0.92487      0.93588       0.91321       0.88472       0.85233      0.80699      0.75907      0.95402      0.92552       0.9307      0.96438      0.93718       0.95272      0.93718       0.91386       0.88536       0.85039      0.81282      0.93523      0.93329       0.9456      0.95207      0.93653      0.94624       0.94754      0.93135       0.90933      0.88148      0.84715      0.95596      0.91451      0.95337      0.96373      0.94365      0.96114       0.93588       0.94365       0.92876       0.9035       0.8737      0.95142      0.92552      0.94495      0.97345      0.94041      0.96762       0.95142       0.9456      0.93782       0.9171      0.89054
    iter=4          204.18      809.6      0.97863      0.97021      0.96308      0.96373       0.94171      0.94301       0.92487       0.90609       0.87306      0.83549      0.79016      0.98316      0.98057      0.96956      0.96179      0.94171       0.95725      0.94106       0.92228       0.89702       0.87047       0.8342      0.97927      0.97992      0.98122      0.96567      0.94689      0.96114       0.95272      0.93912       0.91969      0.89961      0.86334      0.97345      0.97798      0.97733      0.97992      0.95013      0.96114       0.95466       0.95013        0.9307      0.91321      0.88666       0.9715      0.97085      0.97539      0.97733      0.97733      0.96373       0.95402      0.96632      0.93977      0.92617      0.91192
    iter=5          172.52     500.65       0.9715       0.9728      0.96632      0.96308       0.95142      0.93977       0.92811       0.91062       0.88666       0.8478      0.80764      0.96632      0.96891      0.97085      0.96697      0.96567       0.95402      0.93977       0.92746       0.91451       0.88666      0.84715      0.96244      0.96503      0.96762      0.96956      0.96632      0.96373       0.95142      0.93847       0.92422      0.90091        0.875      0.95855      0.96114      0.96373      0.96762      0.96891      0.96244       0.95725       0.94754       0.93459       0.9171      0.89573      0.95466      0.95725      0.95984      0.96244      0.96697      0.96697       0.96308      0.95661      0.94365       0.9294      0.90997
    iter=6          148.24     351.57       0.9579      0.95984      0.95984       0.9579       0.95013      0.95337       0.92746       0.90738       0.88472      0.85168      0.81671      0.95466      0.95466      0.95725      0.95855       0.9592       0.95078      0.93912       0.92487       0.90674       0.88342      0.85039      0.94948      0.94948      0.95337       0.9579       0.9592      0.95725       0.94948      0.94041       0.92422      0.90415      0.87759       0.9443       0.9456      0.94948      0.95337      0.95855      0.95984       0.94754       0.96244       0.93394      0.92098      0.89637      0.94041      0.94171       0.9456      0.94948      0.95466       0.9592       0.95661      0.94883      0.94236      0.92876      0.91127
    iter=7          128.41     264.61      0.94041       0.9443      0.95078      0.95596       0.94689      0.93977       0.92681       0.90868       0.88148      0.84845      0.80829      0.94301      0.94819      0.95078      0.95207      0.95272       0.94754      0.93718       0.92228       0.90738       0.88018      0.84521      0.93523      0.94041      0.95596      0.95078      0.95272      0.95142       0.94624      0.93588       0.92293      0.89443      0.87047      0.93264      0.93653      0.94689      0.95078      0.95013      0.95078       0.95337       0.94041       0.93005      0.90997      0.88407      0.92876      0.93394       0.9443       0.9456      0.94689      0.94819       0.95207      0.94624      0.94495      0.92228      0.89313
    iter=8           112.2     188.11      0.86205      0.88018       0.6535      0.46826       0.54987      0.84909       0.73964       0.90738       0.88148      0.58096      0.68264      0.86269      0.87824      0.65285      0.45725      0.55117       0.85622       0.8601       0.92358       0.90415       0.66192      0.71503       0.8601      0.88083      0.64184       0.4456      0.53238      0.85039       0.90803      0.91321       0.91839      0.68523      0.65674      0.85233      0.87953      0.65415      0.44948      0.52137      0.84326       0.92034       0.80181       0.93199      0.71762      0.65933      0.84326      0.86917      0.64896      0.43199      0.50907      0.83031       0.90091      0.88148      0.92876      0.71891      0.67358
    iter=9          98.474     168.54      0.29663      0.28886      0.52137      0.72539       0.80959      0.76878       0.85816        0.9035       0.23899      0.53627       0.7908      0.28562      0.26749      0.51166      0.71373      0.80894       0.81023      0.78821       0.92422       0.38277       0.45402      0.82319      0.29534      0.25518      0.49482      0.71308      0.79404      0.82772       0.78303      0.90026        0.4294      0.40091      0.85233      0.29793      0.26295      0.47927       0.6943      0.79534      0.84521       0.80052        0.8601       0.43782      0.33679      0.81541      0.30181      0.26166      0.47021      0.67422      0.79663      0.83938       0.82578      0.81088      0.44106      0.47345      0.79793
    iter=10         86.685     166.83      0.70984      0.74806      0.77137      0.76295       0.31865      0.30764       0.32189      0.093912       0.75842      0.75842      0.36334      0.69948      0.74288      0.78368      0.77461       0.3193       0.26554      0.30376       0.21244       0.60557       0.85233      0.43459      0.68394      0.72798      0.77591      0.79145      0.33744      0.24611       0.28562      0.31218        0.5706      0.90091      0.50453      0.67358      0.72668      0.76554      0.78692       0.3465      0.24417       0.26684       0.31995        0.6263      0.89961       0.5149      0.66321      0.71373      0.75518      0.78627      0.34845      0.24223       0.24288      0.29793      0.67293      0.71956      0.55505
    iter=11         76.617     121.43      0.17034      0.15026      0.18264      0.21503        0.6522      0.70078       0.69106       0.55959       0.19236       0.1522      0.56606      0.17358      0.15997      0.16969      0.19883      0.66256       0.72085      0.71049       0.46826       0.34262      0.060881      0.49352      0.17098      0.16192      0.15738      0.17876       0.6522      0.73899       0.72474      0.40155       0.34132     0.049223       0.4715      0.17228      0.15155      0.15674      0.16839      0.63795      0.75972       0.73769       0.40479       0.32578     0.099093      0.44689      0.17098      0.16062      0.16386      0.14961      0.62306      0.74158       0.75453      0.42228      0.29339      0.33679      0.37824
    iter=12         67.798      92.62      0.33225      0.26878      0.20855      0.18264       0.17034      0.20725        0.1956       0.39313       0.74158      0.39961      0.13342      0.33614      0.26619      0.22345      0.17811      0.17681       0.18977      0.22992       0.43912       0.61788       0.56412      0.11852      0.32772       0.2785      0.22345      0.18588       0.1807       0.1671       0.23446      0.47668       0.62565      0.59456      0.10298      0.30959      0.26295       0.2215      0.18718      0.17681      0.15479       0.21503       0.50389       0.66127      0.54663      0.19236      0.29793      0.26684      0.21114      0.18523      0.17293       0.1535       0.19754      0.52915      0.68718      0.32772      0.27396
    iter=13         60.178     134.35      0.48381      0.58225      0.65803      0.68782       0.24611      0.15803       0.16321          0.25      0.062176       0.5013      0.43653      0.47345      0.56541      0.66451      0.69171      0.26166       0.17163      0.13342       0.26101      0.082254       0.36982      0.51231      0.46114      0.56606      0.64313      0.69624       0.2636      0.18459       0.14443       0.2215       0.14637       0.3478      0.57578      0.45337      0.54663      0.62694      0.70142      0.25324      0.19106       0.14637       0.18588       0.21503      0.36464      0.54793      0.45855      0.54922      0.62241       0.6943      0.26749       0.1943       0.15415      0.16062      0.26036      0.40544      0.46826
    iter=14         53.548     101.26     0.099093      0.10427      0.13277      0.15285       0.61269      0.66904       0.36982      0.095855       0.24547     0.051166      0.37889      0.10751      0.11075      0.11723      0.13212      0.62111       0.69301       0.3763       0.11658       0.25972      0.049223      0.33938      0.09456      0.10104      0.11205      0.13342      0.60751      0.69754       0.38212       0.1101       0.24158     0.034974      0.28109     0.091969     0.086788     0.098446      0.11075      0.60816      0.70596       0.38472       0.13212       0.15933      0.13018      0.22474     0.085492     0.088083     0.093912      0.10751      0.60104       0.6956       0.40285      0.14896        0.125      0.27137      0.24158
    iter=15         47.694     76.414       0.1114      0.11528      0.12824      0.11658       0.14378      0.15285       0.42552       0.46567       0.20142     0.045984     0.065415      0.11205       0.1114       0.1263      0.13731      0.13472       0.17163      0.43847        0.4851       0.21373       0.18782     0.068653      0.10622      0.10622      0.11658      0.11075        0.125       0.1658       0.45466      0.50324        0.2364      0.27655     0.033031     0.099741      0.10751      0.10363      0.10751       0.1237      0.14702       0.47215       0.51554       0.22021      0.22798     0.023964      0.10104     0.099741      0.10751     0.098446      0.11723      0.12306       0.48705      0.52332      0.22927     0.098446     0.062824
    iter=16         42.516     64.915      0.13407      0.13083      0.12694      0.13536       0.12953      0.12889       0.13342       0.23899        0.3057      0.39508     0.053109      0.13472      0.11593      0.11982      0.13018       0.1237       0.11334      0.16451       0.27915       0.31865       0.28562      0.04728      0.12565      0.11917      0.11075      0.12565      0.11982     0.098446       0.15803       0.2921       0.33225      0.24028      0.11917      0.13083      0.12047     0.099741       0.1237      0.11917      0.10557       0.14054       0.31153       0.35298      0.24741      0.25259      0.11399       0.1114     0.095855       0.1114      0.10751     0.092617       0.11075       0.3193      0.36852      0.26425      0.28044
    iter=17         37.942     61.427      0.20596      0.17228      0.15997      0.13472       0.11334      0.10687       0.13083       0.11528       0.22474      0.22927      0.23575      0.19106       0.1658      0.13601      0.12889      0.12047       0.10816      0.11075       0.14832       0.22863       0.23964      0.33225      0.16969      0.15609      0.14508        0.125      0.11723     0.089378       0.10751      0.15738       0.26813      0.24482      0.34521      0.17876      0.15803      0.13601      0.11788      0.10881     0.097798      0.097798       0.13601       0.28692      0.25777      0.23769      0.16451       0.1386      0.12435      0.12047      0.10687     0.095207      0.088083      0.12111       0.3044      0.26295      0.24741
    iter=18         33.927     89.005      0.46762      0.54534      0.26813      0.14184         0.125      0.11205      0.084845       0.14702      0.029145      0.20531      0.26036      0.44819      0.53562      0.25648       0.1399      0.12565      0.092617     0.085492       0.11334       0.09456       0.24223      0.22604      0.43782      0.52461      0.26295      0.13083      0.11723      0.09456      0.093264     0.095855       0.14119      0.23769      0.16775      0.43523      0.51425      0.24741      0.12241      0.10751     0.098446      0.086788      0.095207       0.15544      0.25518       0.1956       0.4456      0.51813      0.23316      0.10881     0.098446     0.095207      0.074482     0.082254       0.1386      0.27267      0.18977
    iter=19         30.405     87.771     0.052461      0.05829      0.44106      0.59197       0.19495      0.10492      0.071891      0.078368      0.090674      0.10816      0.15155     0.045984     0.060881      0.41839      0.59003      0.18523       0.11334     0.090674      0.079663        0.1522      0.040803      0.14313     0.042746     0.046632      0.41516      0.57513      0.19689      0.10039      0.088083     0.080959        0.1237      0.06671      0.15803     0.045337     0.045337      0.40026      0.57383       0.1794      0.10751      0.073187      0.071891       0.09456     0.099741      0.15479     0.040155     0.045337      0.40544      0.56865      0.17746      0.09715      0.082902     0.079016     0.074482      0.15803       0.1671
    iter=20         27.279     70.362     0.054404      0.05829     0.071244     0.082902       0.54145      0.27202      0.080311      0.062824       0.11399     0.022668      0.13407     0.051813     0.051813     0.064767     0.073187      0.53756        0.2772     0.085492      0.058938      0.070596      0.032383      0.21049     0.042746     0.051166     0.055699     0.064767      0.52202      0.27332      0.064767      0.06671       0.06671     0.084197      0.18653     0.042746     0.044041     0.042746     0.046632      0.51684      0.25389      0.089378       0.04987      0.068005      0.15544      0.18459     0.046632     0.041451     0.051813     0.042746      0.51813      0.25324      0.075777     0.045984      0.05829      0.10687      0.19301
    iter=21         24.491     61.913     0.050518     0.047927     0.050518     0.060881      0.084197       0.4307       0.24806      0.053109      0.047927      0.01943      0.13277     0.046632     0.044041     0.047927     0.060881     0.079016       0.42422       0.2228      0.065415      0.055052      0.080311     0.028497     0.040155     0.036269     0.047927     0.052461     0.073187      0.41062       0.23705     0.062824      0.058938      0.13666     0.023964     0.031088     0.040155     0.032383     0.053109     0.050518      0.41645       0.23122      0.065415       0.05829     0.078368     0.035622     0.049223     0.036269     0.034974     0.033679     0.042746      0.42228       0.23381     0.055052     0.048575     0.060233     0.055052
    iter=22         22.009     54.913     0.049223     0.042746      0.04728     0.051813      0.069301      0.11723       0.21632       0.19883      0.049223     0.038212     0.012953     0.054404     0.047927     0.045337     0.040155     0.056347      0.096503      0.23769       0.18523      0.049223      0.088731     0.022668     0.040155     0.044041     0.037565     0.036917     0.035622      0.10492       0.24417      0.19689      0.054404     0.056995     0.025259      0.03886     0.037565     0.034974     0.036269     0.047927     0.083549       0.23057       0.18653      0.049223     0.046632     0.042746     0.050518     0.029793     0.023316     0.029793     0.035622      0.07772       0.22409      0.18653     0.055699     0.054404      0.13342
    iter=23         19.802     55.224     0.033679     0.046632     0.042746     0.036917      0.051166     0.070596       0.28886       0.17098        0.1386      0.10168     0.014896     0.034974     0.038212     0.032383     0.033031     0.048575       0.07513      0.29728       0.17034       0.15609      0.049223     0.028497     0.034974     0.033679     0.032383     0.041451      0.03886     0.045337       0.30376      0.16839       0.14378     0.049223     0.022668     0.020725     0.033679     0.025907     0.028497     0.027202     0.053109       0.29469       0.16062       0.13342     0.056347      0.12565     0.031088     0.032383     0.031088     0.033679     0.031088     0.032383       0.30181      0.18523      0.14184      0.03044     0.068653
    iter=24         17.843     36.639     0.042098     0.041451     0.040155     0.045337      0.045984     0.055699      0.073187         0.125         0.125      0.08614     0.021373     0.025907     0.037565      0.01943     0.037565     0.040155      0.040155     0.062824       0.13472       0.12824      0.091969     0.021373     0.032383     0.027202     0.025907     0.034974     0.023316     0.036917      0.047927      0.11464       0.11658      0.10751     0.091969     0.036269     0.029793     0.023316     0.037565     0.043394     0.038212      0.055699       0.14313       0.13666     0.099741     0.051813     0.033679     0.036269     0.025907     0.031088     0.034974     0.028497      0.036269      0.14508      0.12694     0.099093     0.044041
    iter=25         16.101     50.031     0.028497     0.035622     0.037565     0.042746      0.042746     0.049223      0.052461       0.13536      0.090026      0.11658     0.022021     0.023964     0.033679     0.032383      0.02785     0.022668      0.025907     0.039508       0.10751       0.10881       0.10298     0.016839     0.024611     0.025907     0.029145     0.020725     0.032383     0.028497      0.055052      0.13277       0.10363     0.096503     0.059585      0.01943     0.023316     0.029793     0.022668     0.024611     0.022021      0.028497       0.12953      0.099093      0.11334      0.04728     0.018135     0.027202     0.024611     0.023316     0.016839     0.015544      0.029793      0.11982     0.093912      0.10298     0.047927
    iter=26         14.547     46.991     0.023316     0.025907     0.023316     0.027202      0.021373     0.029145      0.055699       0.11852      0.090674      0.08614     0.076425     0.023316     0.033679     0.020725     0.021373     0.022021       0.01943     0.040803        0.1114      0.091321      0.082902      0.14961      0.01943     0.023316     0.020725     0.027202     0.024611     0.027202      0.027202      0.13925      0.090674      0.09715     0.096503     0.018135     0.025907     0.020725     0.014249      0.01943     0.018135       0.02785       0.12111      0.084845     0.085492      0.10363     0.016839     0.022021     0.020725     0.018135      0.01943     0.022021      0.022021      0.11788     0.080311     0.090674      0.10104
    iter=27         13.154     39.594     0.023316     0.025907     0.016192     0.028497      0.035622     0.026554      0.033679      0.096503      0.076425     0.070596     0.087435     0.023316      0.01943     0.015544     0.020725     0.022021      0.032383     0.026554       0.11852      0.093264      0.091969     0.076425     0.018135     0.014249     0.014249     0.016839     0.012953    0.0090674      0.035622       0.1114      0.081606     0.070596      0.10427     0.027202      0.01943     0.014249     0.015544     0.028497     0.018135       0.01101       0.10946      0.079663     0.073834     0.080311     0.020725     0.011658     0.015544     0.016839     0.023316     0.013601      0.023316     0.098446     0.088731     0.070596     0.079016
    iter=28         11.895     39.726     0.018135     0.024611     0.020725     0.014896      0.017487     0.027202      0.044689      0.018135      0.067358     0.049223     0.074482     0.015544     0.022021     0.024611      0.01943     0.024611      0.016839     0.023964      0.047927      0.062176       0.05829     0.079016     0.016839     0.021373     0.023316     0.016839     0.022668      0.01943      0.023316     0.021373      0.056995      0.07513     0.067358     0.015544     0.011658     0.020725      0.01943      0.01943     0.024611      0.018135      0.010363      0.062176     0.072539     0.081606     0.016839     0.012953     0.015544     0.012953     0.014249     0.016839      0.017487     0.020078     0.090026     0.071244     0.067358
    iter=29         10.753       41.5     0.015544     0.020725     0.020725     0.018135      0.018782     0.011658      0.024611      0.052461      0.058938     0.058938     0.060233     0.016839     0.010363     0.010363     0.014249     0.007772      0.016839     0.018782      0.036917      0.055699      0.064119     0.058938     0.014249     0.016839     0.011658     0.011658     0.010363     0.015544      0.020725     0.025907      0.060881     0.065415     0.058938     0.023316     0.010363    0.0090674     0.010363     0.010363     0.011658      0.015544      0.021373      0.058938     0.054404     0.067358      0.01943     0.012953     0.015544     0.015544     0.012953     0.012953       0.01101      0.01101     0.062824     0.051813     0.062176
    iter=30         9.7123      31.86     0.025907     0.016839     0.016192     0.014249      0.014249     0.020078      0.015544      0.035622       0.04987      0.04728     0.036917     0.023316     0.018135     0.012306     0.014249     0.007772     0.0090674     0.023316       0.01943      0.048575      0.056995     0.044689     0.015544     0.014249     0.015544     0.011658     0.012953     0.012953      0.012953     0.018135      0.042746     0.053109     0.047927     0.014249     0.014249    0.0090674     0.012953    0.0090674     0.005829       0.01101      0.017487      0.071244      0.04987     0.042098     0.015544     0.012953    0.0064767    0.0051813     0.007772     0.010363      0.015544     0.018135     0.058938     0.043394      0.05829
    iter=31         8.7634     37.186     0.015544    0.0090674    0.0090674     0.011658      0.007772     0.014249      0.016839       0.03044      0.048575     0.032383     0.053109     0.014249     0.007772    0.0064767     0.012953     0.016839      0.007772     0.021373      0.016839      0.063472      0.035622     0.034326     0.015544     0.011658    0.0090674     0.011658    0.0090674    0.0090674      0.007772     0.013601      0.053109     0.031736     0.050518     0.012953     0.007772     0.010363     0.007772     0.010363     0.007772      0.012306      0.013601      0.061528      0.03044     0.039508     0.012953     0.010363    0.0090674     0.011658    0.0064767     0.007772      0.013601     0.018782     0.050518     0.042746      0.03886
    iter=32         7.8977     22.935     0.018135     0.007772     0.014249     0.007772     0.0084197     0.014249     0.0084197      0.020725      0.059585     0.034326     0.038212     0.016839    0.0090674     0.011658     0.011658     0.010363     0.0090674    0.0064767      0.012306       0.06671      0.036269     0.036269     0.022021    0.0090674     0.010363     0.012953     0.011658     0.012306      0.013601      0.01101      0.075777     0.050518     0.032383     0.015544    0.0064767    0.0051813     0.012953    0.0084197    0.0090674      0.009715      0.010363      0.071891     0.064119     0.040155     0.016839     0.010363     0.003886     0.010363    0.0064767    0.0051813     0.0064767    0.0045337     0.064767     0.042098     0.035622
    iter=33         7.1083     22.076      0.01943     0.018135     0.007772     0.011658     0.0012953     0.009715      0.007772      0.014249      0.062176      0.02785     0.036269     0.011658     0.011658     0.003886    0.0051813    0.0064767     0.0071244    0.0064767      0.013601      0.039508      0.034326     0.029145     0.010363     0.011658     0.003886     0.003886     0.011658    0.0084197      0.005829     0.014896      0.048575     0.037565     0.036269     0.011658     0.012953    0.0025907    0.0051813    0.0064767     0.009715     0.0084197      0.013601      0.031088     0.031736     0.031736     0.010363     0.010363    0.0025907     0.007772     0.003886     0.003886     0.0025907     0.005829     0.031088     0.033679     0.033031
    iter=34         6.3891     13.135    0.0064767     0.003886     0.010363    0.0025907      0.007772     0.012953      0.003886      0.007772      0.016839     0.025907     0.031088    0.0064767     0.010363     0.003886    0.0051813    0.0025907      0.014896     0.003886     0.0051813     0.0032383      0.023964     0.027202     0.010363     0.007772     0.007772    0.0012953    0.0025907     0.005829      0.003886    0.0090674      0.018782     0.031088     0.033679    0.0090674     0.003886    0.0051813     0.007772     0.005829    0.0090674     0.0012953     0.0051813      0.014249     0.022021     0.026554    0.0090674     0.003886     0.003886     0.003886    0.0051813    0.0071244     0.0012953     0.007772     0.007772     0.026554     0.031088
    iter=35         5.7344     40.213     0.007772    0.0051813    0.0064767     0.007772     0.0064767     0.007772     0.0064767     0.0071244      0.007772      0.02785     0.020078    0.0090674     0.003886    0.0064767     0.010363    0.0064767     0.0064767     0.007772     0.0045337     0.0084197      0.021373     0.026554     0.007772     0.003886     0.007772    0.0051813    0.0090674     0.003886      0.007772    0.0051813      0.013601     0.023964     0.017487     0.007772    0.0064767    0.0064767    0.0051813    0.0090674    0.0032383     0.0064767      0.001943      0.005829     0.040803     0.022668    0.0090674     0.003886     0.007772    0.0051813    0.0051813     0.001943      0.011658     0.009715    0.0051813     0.021373     0.022668
    iter=36         5.1398     21.972      0.03886    0.0064767    0.0025907     0.007772     0.0012953     0.009715     0.0051813      0.007772      0.012306     0.027202     0.024611      0.03886    0.0064767     0.007772    0.0051813    0.0051813      0.001943     0.014896      0.014249     0.0032383      0.026554     0.031088     0.040155     0.007772    0.0064767     0.010363    0.0051813    0.0051813     0.0084197     0.005829     0.0084197     0.018135      0.02785      0.03886    0.0064767    0.0025907    0.0051813    0.0012953    0.0012953      0.007772      0.003886     0.0090674     0.021373     0.023964      0.03886    0.0064767     0.003886    0.0064767    0.0064767    0.0045337      0.010363    0.0045337     0.009715     0.020725     0.029793
    iter=37         4.6012     34.764     0.054404    0.0064767     0.003886     0.011658      0.003886     0.005829      0.012306       0.01101      0.014249     0.024611     0.022668     0.055699     0.007772    0.0025907    0.0064767     0.003886     0.0071244     0.011658      0.005829      0.029145      0.022668     0.015544     0.054404     0.007772    0.0025907     0.003886    0.0051813     0.003886     0.0064767     0.005829      0.013601     0.025907     0.020078     0.053109     0.003886     0.003886    0.0051813    0.0064767     0.007772     0.0071244      0.003886      0.009715     0.026554     0.025259     0.053109     0.003886    0.0064767    0.0064767    0.0064767            0      0.011658    0.0084197     0.017487     0.024611     0.023316
    iter=38          4.114     35.579     0.041451     0.041451     0.003886    0.0051813     0.0032383    0.0025907      0.001943     0.0064767      0.010363      0.01943     0.014896     0.041451     0.036269    0.0025907    0.0025907     0.003886     0.0025907    0.0051813     0.0045337      0.016192      0.018782     0.021373     0.041451     0.037565    0.0025907    0.0090674    0.0051813    0.0051813      0.003886    0.0084197      0.018782     0.025907     0.014896     0.042746     0.036269    0.0064767    0.0012953    0.0012953    0.0025907     0.0051813     0.0051813      0.015544     0.024611     0.016839     0.041451     0.036269    0.0025907    0.0012953    0.0051813    0.0025907             0     0.012306     0.009715     0.022668     0.015544
    iter=39         3.6737      30.19     0.055699      0.03886     0.003886     0.003886      0.007772    0.0012953     0.0032383     0.0045337      0.007772     0.016192     0.014249     0.055699     0.041451    0.0025907    0.0025907     0.015544     0.0025907    0.0025907      0.005829      0.009715      0.028497     0.013601      0.05829     0.037565    0.0051813    0.0064767     0.003886    0.0071244     0.0025907    0.0032383     0.0045337     0.029793     0.017487     0.055699      0.03886    0.0012953    0.0064767    0.0025907     0.003886      0.012953     0.0012953      0.007772     0.031088     0.012953     0.056995     0.037565    0.0025907    0.0025907    0.0025907    0.0012953     0.0025907     0.001943    0.0051813      0.02785      0.01101
    iter=40          3.277     32.935     0.064767     0.040155     0.027202    0.0064767     0.0025907    0.0012953     0.0012953      0.012306     0.0025907     0.015544     0.012953     0.067358     0.037565     0.023316    0.0051813    0.0064767      0.003886     0.010363     0.0045337      0.010363      0.016839     0.017487     0.064767     0.037565     0.025907     0.003886    0.0025907     0.001943     0.0064767    0.0090674      0.005829     0.034326     0.013601     0.064767     0.037565     0.023316    0.0012953    0.0025907    0.0090674     0.0064767      0.005829     0.0051813     0.035622     0.015544     0.064767     0.037565     0.023316    0.0025907    0.0064767     0.007772      0.003886    0.0051813    0.0090674      0.03044     0.013601
    iter=41         2.9195     29.172     0.064767     0.034974     0.027202    0.0064767     0.0025907    0.0064767     0.0084197       0.01101      0.007772     0.012306    0.0084197     0.064767     0.036269     0.028497     0.003886    0.0025907      0.001943    0.0045337     0.0090674      0.007772      0.016192    0.0064767     0.064767     0.034974     0.027202            0    0.0025907    0.0012953      0.015544    0.0012953      0.014249     0.033031    0.0084197     0.063472     0.034974     0.027202    0.0025907    0.0025907    0.0012953     0.0012953      0.003886     0.0051813     0.016839    0.0084197     0.063472     0.034974     0.028497     0.003886    0.0025907            0    0.00064767    0.0045337    0.0045337     0.016839     0.012306
    iter=42         2.5978     34.787     0.063472     0.033679     0.033679     0.007772     0.0064767    0.0025907             0      0.001943    0.00064767     0.014249     0.014249     0.062176     0.033679     0.028497    0.0012953            0             0     0.001943     0.0084197      0.007772       0.03886    0.0090674     0.062176     0.033679     0.029793    0.0012953            0     0.007772     0.0084197     0.005829     0.0071244     0.016839     0.014896     0.060881     0.033679     0.029793    0.0012953            0    0.0012953     0.0025907     0.0012953     0.0025907     0.018782     0.014896     0.060881     0.036269     0.032383    0.0012953            0    0.0064767     0.0012953    0.0064767    0.0025907      0.01943     0.016192
    iter=43         2.3092     25.426     0.098446     0.032383     0.024611     0.003886     0.0090674    0.0025907     0.0071244     0.0012953    0.00064767     0.018135     0.012306     0.098446     0.032383     0.024611    0.0051813    0.0051813     0.0025907    0.0025907     0.0084197     0.0045337      0.023964     0.022668     0.098446     0.032383     0.024611    0.0051813    0.0064767    0.0012953     0.0025907     0.003886      0.001943      0.01101     0.018782     0.098446     0.032383     0.024611    0.0064767    0.0064767    0.0090674      0.007772     0.0045337      0.001943     0.020078     0.018135     0.098446     0.032383     0.027202     0.003886    0.0051813     0.003886     0.0025907    0.0051813    0.0012953     0.012306     0.018782
    iter=44         2.0501     21.266     0.018135     0.024611     0.023316     0.022021     0.0025907    0.0012953      0.010363     0.0084197      0.003886     0.007772    0.0071244     0.018135     0.025907     0.024611     0.023316     0.007772     0.0025907    0.0025907     0.0051813     0.0032383      0.013601     0.009715      0.01943     0.024611     0.024611     0.027202    0.0025907     0.001943      0.001943    0.0032383     0.0071244     0.003886    0.0064767      0.01943     0.024611     0.023316     0.022021            0    0.0012953     0.0084197      0.003886     0.0032383    0.0045337    0.0084197     0.018135     0.024611     0.023316     0.022021            0    0.0012953    0.00064767     0.007772     0.003886     0.003886      0.01101
    iter=45         1.8185     23.957            0     0.024611     0.015544     0.020725             0    0.0012953     0.0012953     0.0025907      0.005829    0.0084197     0.010363            0     0.024611     0.015544     0.018135    0.0012953             0    0.0025907    0.00064767     0.0025907      0.010363     0.005829            0     0.027202     0.015544     0.018135            0    0.0025907     0.0025907    0.0025907     0.0051813    0.0012953     0.005829            0     0.024611     0.015544      0.01943    0.0012953    0.0012953     0.0012953     0.0051813     0.0032383    0.0032383     0.018135    0.0012953     0.024611     0.015544     0.018135    0.0012953            0             0     0.003886     0.007772     0.017487     0.007772
    iter=46         1.6118     20.869            0     0.016839     0.014249     0.020725     0.0064767    0.0071244     0.0012953    0.00064767     0.0032383    0.0064767     0.003886            0     0.016839     0.016839     0.020725     0.003886      0.003886    0.0025907      0.011658      0.003886     0.0084197    0.0064767            0      0.01943     0.012953     0.018135    0.0012953    0.0025907    0.00064767     0.003886     0.0045337            0    0.0090674            0     0.016839     0.012953     0.018135    0.0012953     0.003886    0.00064767     0.0012953     0.0045337    0.0045337     0.010363            0     0.018135     0.012953     0.018135    0.0012953    0.0025907      0.001943    0.0012953     0.007772    0.0064767     0.010363
    iter=47         1.4285     27.504    0.0012953      0.01943     0.015544     0.014249    0.00064767    0.0051813     0.0012953      0.003886    0.00064767     0.001943     0.005829            0     0.018135     0.018135     0.014249    0.0012953    0.00064767            0     0.0045337      0.007772     0.0051813     0.014896            0     0.016839     0.014249     0.016839    0.0025907    0.0025907     0.0012953            0     0.0025907    0.0025907     0.016192    0.0012953     0.018135     0.014249     0.014249            0    0.0064767             0     0.0025907    0.00064767    0.0032383    0.0090674            0     0.016839     0.014249     0.014249            0     0.003886             0    0.0025907     0.001943    0.0051813     0.010363
    iter=48         1.2656     11.125            0     0.014249     0.010363     0.012953             0            0     0.0012953     0.0025907    0.00064767     0.005829    0.0051813            0     0.011658     0.010363     0.012953     0.003886    0.00064767    0.0045337     0.0045337     0.0064767             0    0.0064767            0     0.011658     0.010363     0.012953            0            0     0.0045337    0.0025907     0.0051813     0.001943    0.0025907            0     0.011658     0.010363     0.012953    0.0012953    0.0064767             0     0.0012953    0.00064767     0.003886    0.0051813            0     0.011658     0.010363     0.012953    0.0012953    0.0025907      0.001943            0            0    0.0032383    0.0084197
    iter=49         1.1218     9.7154    0.0012953     0.010363     0.011658     0.010363      0.010363    0.0032383             0             0    0.00064767    0.0064767    0.0051813            0     0.010363     0.014249     0.010363    0.0090674      0.001943            0             0    0.00064767             0     0.012953    0.0012953     0.010363     0.014249     0.011658    0.0090674    0.0012953      0.003886            0    0.00064767    0.0045337     0.001943            0     0.010363     0.011658     0.010363     0.011658    0.0025907     0.0012953    0.00064767     0.0012953    0.0025907    0.0012953            0     0.010363     0.011658     0.010363    0.0090674            0             0            0    0.0012953     0.009715     0.003886
    iter=50        0.99522     10.759            0    0.0090674    0.0064767     0.007772      0.014249            0     0.0012953     0.0051813             0    0.0051813     0.005829            0     0.010363    0.0064767     0.007772     0.014249     0.0012953    0.0025907     0.0032383      0.003886    0.00064767    0.0032383    0.0012953    0.0090674    0.0064767     0.007772     0.014249     0.003886     0.0012953    0.0025907             0            0    0.0025907            0    0.0090674    0.0064767     0.007772     0.014249            0     0.0025907     0.0025907             0    0.0025907    0.0064767            0    0.0090674    0.0064767     0.007772     0.014249     0.003886     0.0012953    0.0025907    0.0012953    0.0025907    0.0090674
    iter=102       0.01737      1.282            0            0            0            0     0.0012953            0             0             0             0            0            0            0            0            0            0    0.0012953             0            0             0             0             0            0            0            0            0            0    0.0012953            0             0            0             0            0            0            0            0            0            0    0.0012953            0             0             0             0            0            0            0            0            0            0    0.0012953            0             0            0            0            0            0
    iter=103      0.016384          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=104      0.015452          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=105      0.014573          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=106      0.013743          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=107      0.012959          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=108      0.012218          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=109      0.011519    0.83135            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0    0.0012953            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=110      0.010859    0.14129            0            0            0            0             0            0    0.00064767             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=111      0.010236          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=112     0.0096474          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=113     0.0090922          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=114     0.0085681          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=115     0.0080736          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=116      0.007607          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=117     0.0071668          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=118     0.0067515          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=119     0.0063597          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=120     0.0059902          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=121     0.0056418          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=122     0.0053132          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=123     0.0050035          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=124     0.0047114          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=125     0.0044361    0.43188            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0     0.003886            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=126     0.0041766          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=127     0.0039321          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=128     0.0037016          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=129     0.0034845          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=130     0.0032799          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=131     0.0030871          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=132     0.0029055          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=133     0.0027345          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=134     0.0025734          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=135     0.0024217          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=136     0.0022788          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=137     0.0021443          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=138     0.0020176          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=139     0.0018983          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=140      0.001786          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=141     0.0016803          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=142     0.0015808          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=143     0.0014871          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=144      0.001399          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=145      0.001316          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=146     0.0012379          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=147     0.0011644          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=148     0.0010952          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=149     0.0010301          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=150     0.0009689          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0
    iter=151    0.00091128          0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0             0             0            0            0            0            0            0            0            0             0            0             0            0            0            0            0            0            0            0            0             0             0             0            0            0            0            0            0            0            0            0             0            0            0            0            0

tb_val: V(a,z) value at each state space point
                            zi1_zr_0_025_zw_0_34664    zi2_zr_0_025_zw_0_42338    zi3_zr_0_025_zw_0_51712    zi4_zr_0_025_zw_0_63162    zi5_zr_0_025_zw_0_77146    zi6_zr_0_025_zw_0_94226    zi50_zr_0_095_zw_0_94226    zi51_zr_0_095_zw_1_1509    zi52_zr_0_095_zw_1_4057    zi53_zr_0_095_zw_1_7169    zi54_zr_0_095_zw_2_097    zi55_zr_0_095_zw_2_5613
                            _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    ______________________    _______________________

    coh1:k=-20,b=0                  -9.6806                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh2:k=-19.8997,b=0             -9.6806                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh3:k=-19.7993,b=0             -9.6806                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh4:k=-19.699,b=0              -9.6806                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh5:k=-19.5987,b=0             -9.6806                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh6:k=-19.4983,b=0             -9.6087                    -9.3191                    -8.8814                    -8.3789                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh7:k=-19.398,b=0              -9.3627                    -9.0742                    -8.7345                    -8.3566                    -7.8148                     -7.193                    -7.4002                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh8:k=-19.2977,b=0             -9.1715                     -8.883                    -8.5433                    -8.1654                    -7.7534                     -7.193                    -7.3095                     -6.7641                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh9:k=-19.1973,b=0             -9.0174                    -8.7289                    -8.3892                    -8.0113                    -7.5993                    -7.1553                    -7.1553                     -6.6821                    -6.0855                    -5.3745                   -4.6481                    -3.9553        
    coh10:k=-19.097,b=0             -8.8897                    -8.6012                    -8.2615                    -7.8836                    -7.4716                    -7.0277                    -7.0277                     -6.5545                    -6.0557                    -5.3745                   -4.6481                    -3.9553        
    coh11:k=-18.9967,b=0            -8.7817                    -8.4932                    -8.1535                    -7.7756                    -7.3636                    -6.9197                    -6.9197                     -6.4465                    -5.9477                    -5.3745                   -4.6481                    -3.9553        
    coh12:k=-18.8963,b=0            -8.6888                    -8.4003                    -8.0606                    -7.6827                    -7.2707                    -6.8268                    -6.8268                     -6.3535                    -5.8548                    -5.3363                   -4.6481                    -3.9553        
    coh13:k=-18.796,b=0             -8.6077                    -8.3193                    -7.9721                     -7.587                    -7.1734                    -6.7373                    -6.7457                     -6.2725                    -5.7737                    -5.2552                   -4.6481                    -3.9553        
    coh14:k=-18.6956,b=0            -8.4799                    -8.1725                    -7.8181                    -7.4362                    -7.0319                    -6.6039                    -6.6742                      -6.201                    -5.7022                    -5.1837                   -4.6481                    -3.9553        
    coh15:k=-18.5953,b=0            -8.3302                    -8.0305                    -7.6853                    -7.3074                    -6.9042                    -6.4802                    -6.6105                     -6.1373                    -5.6385                      -5.12                   -4.5951                    -3.9553        
    coh16:k=-18.495,b=0             -8.2019                    -7.9033                    -7.5606                    -7.1883                    -6.7917                    -6.3704                    -6.5533                     -6.0801                    -5.5813                    -5.0628                   -4.5379                    -3.9553        
    coh17:k=-18.3946,b=0            -8.0809                     -7.788                    -7.4499                      -7.08                    -6.6861                    -6.2697                    -6.5015                     -6.0283                    -5.5295                     -5.011                   -4.4861                    -3.9553        
    coh18:k=-18.2943,b=0            -7.9721                    -7.6811                    -7.3452                    -6.9811                    -6.5912                    -6.1779                    -6.4544                     -5.9812                    -5.4824                    -4.9639                    -4.439                    -3.9453        
    coh19:k=-18.194,b=0             -7.8716                    -7.5842                    -7.2519                    -6.8885                    -6.5015                    -6.0932                    -6.4112                      -5.938                    -5.4393                    -4.9207                   -4.3958                    -3.9022        
    coh20:k=-18.0936,b=0            -7.7779                     -7.493                     -7.164                    -6.8053                    -6.4207                    -6.0128                    -6.3715                     -5.8983                    -5.3996                    -4.8811                   -4.3561                    -3.8625        
    coh21:k=-17.9933,b=0             -7.692                    -7.4098                    -7.0823                     -6.726                    -6.3448                    -5.9409                    -6.3349                     -5.8616                    -5.3629                    -4.8444                   -4.3195                    -3.8258        
    coh22:k=-17.893,b=0             -7.6111                    -7.3302                    -7.0065                    -6.6531                    -6.2735                    -5.8726                    -6.3008                     -5.8276                    -5.3289                    -4.8103                   -4.2854                    -3.7918        
    coh23:k=-17.7926,b=0            -7.5371                    -7.2583                    -6.9351                    -6.5833                    -6.2078                    -5.8081                    -6.2692                     -5.7959                    -5.2972                    -4.7787                   -4.2537                    -3.7601        
    coh24:k=-17.6923,b=0            -7.4668                    -7.1892                    -6.8693                    -6.5197                    -6.1448                    -5.7481                    -6.2396                     -5.7664                    -5.2676                    -4.7491                   -4.2242                    -3.7305        
    coh25:k=-17.592,b=0             -7.4009                    -7.1252                    -6.8069                    -6.4588                    -6.0868                    -5.6918                    -6.2119                     -5.7386                    -5.2399                    -4.7214                   -4.1964                    -3.7028        
    coh26:k=-17.4916,b=0            -7.3386                    -7.0645                    -6.7478                    -6.4016                    -6.0316                    -5.6382                    -6.1858                     -5.7126                    -5.2138                    -4.6953                   -4.1704                    -3.6768        
    coh27:k=-17.3913,b=0              -7.28                    -7.0069                    -6.6917                    -6.3478                    -5.9788                    -5.5871                    -6.1613                     -5.6881                    -5.1893                    -4.6708                   -4.1459                    -3.6522        
    coh28:k=-17.291,b=0              -7.224                    -6.9531                    -6.6392                     -6.296                    -5.9291                    -5.5395                    -6.1381                     -5.6649                    -5.1662                    -4.6477                   -4.1227                    -3.6291        
    coh29:k=-17.1906,b=0            -7.1717                    -6.9009                    -6.5884                     -6.248                    -5.8824                    -5.4936                    -6.1162                      -5.643                    -5.1443                    -4.6258                   -4.1008                    -3.6072        
    coh30:k=-17.0903,b=0             -7.121                    -6.8527                    -6.5414                    -6.2015                    -5.8371                    -5.4502                    -6.0955                     -5.6223                    -5.1235                     -4.605                   -4.0801                    -3.5864        
    coh31:k=-16.99,b=0              -7.0739                    -6.8059                    -6.4957                    -6.1575                    -5.7943                    -5.4088                    -6.0459                     -5.5786                     -5.095                    -4.5853                   -4.0604                    -3.5667        
    coh32:k=-16.8896,b=0            -7.0281                    -6.7616                    -6.4525                    -6.1154                    -5.7533                    -5.3687                    -5.9757                     -5.5139                    -5.0352                    -4.5433                   -4.0416                     -3.548        
    coh33:k=-16.7893,b=0             -6.985                    -6.7193                    -6.4111                    -6.0749                    -5.7137                    -5.3303                    -5.9091                     -5.4528                    -4.9774                    -4.4912                   -4.0033                    -3.5301        
    coh34:k=-16.6889,b=0            -6.9433                    -6.6785                    -6.3713                    -6.0361                    -5.6763                    -5.2934                    -5.8463                     -5.3943                    -4.9245                    -4.4414                   -3.9571                    -3.5047        
    coh35:k=-16.5886,b=0            -6.9036                    -6.6395                    -6.3335                     -5.999                      -5.64                    -5.2576                    -5.7875                     -5.3395                    -4.8731                    -4.3943                   -3.9135                    -3.4629        
    coh36:k=-16.4883,b=0            -6.8655                     -6.602                    -6.2966                    -5.9628                    -5.6047                    -5.2227                    -5.7309                     -5.2876                    -4.8254                     -4.349                    -3.871                    -3.4237        
    coh37:k=-16.3879,b=0            -6.8287                    -6.5659                    -6.2618                    -5.9285                    -5.5706                    -5.1834                    -5.6788                      -5.238                     -4.779                     -4.306                   -3.8299                     -3.361        
    coh38:k=-16.2876,b=0            -6.7936                    -6.5314                    -6.2278                    -5.8951                    -5.5374                    -5.1248                    -5.6284                     -5.1913                    -4.7355                    -4.2643                   -3.7891                    -3.2971        
    coh39:k=-16.1873,b=0            -6.7595                    -6.4977                    -6.1945                    -5.8626                    -5.4902                    -5.0667                    -5.5811                     -5.1461                    -4.6932                    -4.2247                   -3.7465                     -3.229        
    coh40:k=-16.0869,b=0             -6.727                    -6.4655                    -6.1626                    -5.8305                    -5.4297                      -5.01                    -5.5358                     -5.1038                    -4.6526                    -4.1861                   -3.6999                    -3.1586        
    coh41:k=-15.9866,b=0            -6.6951                     -6.434                    -6.1314                    -5.7681                    -5.3706                    -4.9544                    -5.4916                     -5.0626                    -4.6134                    -4.1468                   -3.6457                    -3.0843        
    coh42:k=-15.8863,b=0            -6.6645                    -6.4039                    -6.0785                    -5.7065                    -5.3131                    -4.9006                    -5.4502                     -5.0234                    -4.5756                    -4.1085                   -3.5869                     -3.011        
    coh43:k=-15.7859,b=0            -6.6344                    -6.3518                    -6.0143                    -5.6468                    -5.2577                     -4.849                      -5.41                     -4.9855                    -4.5393                    -4.0671                    -3.524                    -2.9388        
    coh44:k=-15.6856,b=0            -6.5704                    -6.2855                    -5.9522                    -5.5889                    -5.2039                    -4.7988                    -5.3717                     -4.9485                    -4.5035                    -4.0167                   -3.4624                    -2.8663        
    coh45:k=-15.5853,b=0            -6.5028                    -6.2219                    -5.8931                    -5.5335                    -5.1522                      -4.75                    -5.3346                     -4.9124                    -4.4662                    -3.9635                   -3.4022                    -2.7948        
    coh46:k=-15.4849,b=0            -6.4375                    -6.1603                    -5.8357                      -5.48                    -5.1022                    -4.7027                    -5.2989                     -4.8774                    -4.4237                    -3.9097                   -3.3411                    -2.7241        
    coh47:k=-15.3846,b=0            -6.3747                     -6.101                    -5.7801                    -5.4281                    -5.0536                    -4.6563                    -5.2644                     -4.8433                    -4.3737                    -3.8547                   -3.2809                    -2.6504        
    coh48:k=-15.2843,b=0             -6.315                    -6.0445                     -5.727                    -5.3783                    -5.0067                    -4.6115                    -5.2306                     -4.8048                    -4.3216                    -3.8011                   -3.2191                    -2.5774        
    coh49:k=-15.1839,b=0            -6.2572                    -5.9897                    -5.6754                    -5.3299                    -4.9611                    -4.5677                    -5.1969                     -4.7561                    -4.2697                    -3.7468                   -3.1559                    -2.5052        
    coh50:k=-15.0836,b=0            -6.2011                    -5.9366                    -5.6253                    -5.2829                    -4.9166                    -4.5247                    -5.1622                     -4.7022                    -4.2166                    -3.6914                   -3.0932                    -2.4337        
    coh723:k=52.3415,b=0              15.04                     15.104                     15.181                     15.269                     15.368                     15.481                     15.481                      15.611                     15.757                      15.92                    16.099                      16.28        
    coh724:k=52.4418,b=0             15.049                     15.114                     15.191                     15.278                     15.377                     15.489                     15.489                      15.619                     15.765                     15.928                    16.106                     16.288        
    coh725:k=52.5421,b=0             15.059                     15.123                       15.2                     15.287                     15.386                     15.498                     15.498                      15.627                     15.773                     15.936                    16.114                     16.295        
    coh726:k=52.6425,b=0             15.068                     15.132                     15.209                     15.296                     15.394                     15.506                     15.506                      15.636                     15.781                     15.943                    16.121                     16.302        
    coh727:k=52.7428,b=0             15.077                     15.142                     15.218                     15.305                     15.403                     15.515                     15.515                      15.644                     15.789                     15.951                    16.129                      16.31        
    coh728:k=52.8431,b=0             15.087                     15.151                     15.227                     15.314                     15.412                     15.523                     15.523                      15.652                     15.797                     15.959                    16.137                     16.317        
    coh729:k=52.9435,b=0             15.096                      15.16                     15.236                     15.323                     15.421                     15.532                     15.532                      15.661                     15.805                     15.967                    16.144                     16.324        
    coh730:k=53.0438,b=0             15.105                     15.169                     15.245                     15.332                     15.429                      15.54                      15.54                      15.669                     15.813                     15.975                    16.152                     16.331        
    coh731:k=53.1441,b=0             15.115                     15.179                     15.254                     15.341                     15.438                     15.549                     15.549                      15.677                     15.821                     15.983                    16.159                     16.339        
    coh732:k=53.2445,b=0             15.124                     15.188                     15.264                      15.35                     15.447                     15.557                     15.557                      15.685                     15.829                      15.99                    16.167                     16.346        
    coh733:k=53.3448,b=0             15.133                     15.197                     15.273                     15.358                     15.456                     15.566                     15.566                      15.694                     15.837                     15.998                    16.174                     16.353        
    coh734:k=53.4451,b=0             15.143                     15.206                     15.282                     15.367                     15.464                     15.574                     15.574                      15.702                     15.845                     16.006                    16.182                      16.36        
    coh735:k=53.5455,b=0             15.152                     15.215                     15.291                     15.376                     15.473                     15.583                     15.583                       15.71                     15.853                     16.014                    16.189                     16.367        
    coh736:k=53.6458,b=0             15.161                     15.224                       15.3                     15.385                     15.482                     15.591                     15.591                      15.718                     15.861                     16.021                    16.197                     16.375        
    coh737:k=53.7462,b=0              15.17                     15.233                     15.309                     15.394                      15.49                     15.599                     15.599                      15.726                     15.869                     16.029                    16.204                     16.382        
    coh738:k=53.8465,b=0              15.18                     15.243                     15.318                     15.403                     15.499                     15.608                     15.608                      15.735                     15.877                     16.037                    16.211                     16.389        
    coh739:k=53.9468,b=0             15.189                     15.252                     15.327                     15.411                     15.507                     15.616                     15.616                      15.743                     15.885                     16.044                    16.219                     16.396        
    coh740:k=54.0472,b=0             15.198                     15.261                     15.335                      15.42                     15.516                     15.625                     15.625                      15.751                     15.893                     16.052                    16.226                     16.403        
    coh741:k=54.1475,b=0             15.207                      15.27                     15.344                     15.429                     15.525                     15.633                     15.633                      15.759                     15.901                      16.06                    16.234                      16.41        
    coh742:k=54.2478,b=0             15.216                     15.279                     15.353                     15.438                     15.533                     15.641                     15.641                      15.767                     15.909                     16.067                    16.241                     16.417        
    coh743:k=54.3482,b=0             15.226                     15.288                     15.362                     15.446                     15.542                      15.65                      15.65                      15.775                     15.917                     16.075                    16.248                     16.424        
    coh744:k=54.4485,b=0             15.235                     15.297                     15.371                     15.455                      15.55                     15.658                     15.658                      15.783                     15.924                     16.083                    16.256                     16.431        
    coh745:k=54.5488,b=0             15.244                     15.306                      15.38                     15.464                     15.559                     15.666                     15.666                      15.791                     15.932                      16.09                    16.263                     16.437        
    coh746:k=54.6492,b=0             15.246                     15.308                     15.382                     15.466                     15.564                     15.674                     15.674                      15.799                      15.94                     16.098                     16.27                     16.444        
    coh747:k=54.7495,b=0             15.249                     15.312                     15.388                     15.475                     15.572                     15.682                     15.682                      15.807                     15.948                     16.105                    16.277                     16.451        
    coh748:k=54.8498,b=0             15.258                     15.321                     15.397                     15.483                      15.58                     15.691                     15.691                      15.815                     15.956                     16.113                    16.285                     16.458        
    coh749:k=54.9502,b=0             15.267                      15.33                     15.406                     15.492                     15.589                     15.699                     15.699                      15.823                     15.964                      16.12                    16.292                     16.465        
    coh750:k=55.0505,b=0             15.276                     15.339                     15.415                       15.5                     15.597                     15.707                     15.707                      15.831                     15.971                     16.128                    16.299                     16.472        
    coh751:k=55.1508,b=0             15.285                     15.348                     15.423                     15.509                     15.606                     15.715                     15.715                      15.839                     15.979                     16.136                    16.307                     16.479        
    coh752:k=55.2512,b=0             15.294                     15.357                     15.432                     15.517                     15.614                     15.723                     15.723                      15.847                     15.987                     16.143                    16.314                     16.486        
    coh753:k=55.3515,b=0             15.302                     15.366                     15.441                     15.526                     15.622                     15.732                     15.732                      15.855                     15.995                     16.151                    16.321                     16.491        
    coh754:k=55.4518,b=0             15.311                     15.374                     15.449                     15.535                     15.631                      15.74                      15.74                      15.863                     16.002                     16.158                    16.328                     16.497        
    coh755:k=55.5522,b=0              15.32                     15.383                     15.458                     15.543                     15.639                     15.748                     15.748                      15.871                      16.01                     16.166                    16.335                     16.502        
    coh756:k=55.6525,b=0             15.329                     15.392                     15.467                     15.552                     15.647                     15.756                     15.756                      15.879                     16.018                     16.173                    16.341                     16.509        
    coh757:k=55.7529,b=0             15.338                     15.401                     15.475                      15.56                     15.656                     15.764                     15.764                      15.887                     16.026                      16.18                    16.348                     16.516        
    coh758:k=55.8532,b=0             15.347                     15.409                     15.484                     15.569                     15.664                     15.772                     15.772                      15.895                     16.033                     16.188                    16.356                     16.523        
    coh759:k=55.9535,b=0             15.356                     15.418                     15.493                     15.577                     15.672                      15.78                      15.78                      15.903                     16.041                     16.195                    16.363                      16.53        
    coh760:k=56.0539,b=0             15.365                     15.427                     15.501                     15.585                     15.681                     15.788                     15.788                      15.911                     16.049                     16.203                     16.37                     16.536        
    coh761:k=56.1542,b=0             15.374                     15.436                      15.51                     15.594                     15.689                     15.797                     15.797                      15.919                     16.056                      16.21                    16.377                     16.543        
    coh762:k=56.2545,b=0              15.38                     15.442                     15.516                       15.6                     15.695                     15.802                     15.802                      15.924                     16.062                     16.215                    16.382                     16.547        
    coh763:k=56.3549,b=0              15.38                     15.442                     15.516                       15.6                     15.695                     15.803                     15.803                      15.925                     16.062                     16.216                    16.382                     16.548        
    coh764:k=56.4552,b=0             15.381                     15.443                     15.517                     15.601                     15.696                     15.803                     15.803                      15.925                     16.063                     16.216                    16.383                     16.548        
    coh765:k=56.5555,b=0             15.381                     15.443                     15.517                     15.601                     15.696                     15.804                     15.804                      15.926                     16.063                     16.217                    16.383                     16.552        
    coh766:k=56.6559,b=0             15.382                     15.444                     15.518                     15.602                     15.697                     15.804                     15.804                      15.926                     16.064                     16.217                    16.386                     16.559        
    coh767:k=56.7562,b=0             15.382                     15.444                     15.518                     15.602                     15.697                     15.805                     15.805                      15.927                     16.065                     16.221                    16.393                     16.566        
    coh768:k=56.8565,b=0             15.383                     15.445                     15.519                     15.603                     15.699                     15.808                     15.808                      15.933                     16.072                     16.229                      16.4                     16.572        
    coh769:k=56.9569,b=0             15.386                      15.45                     15.525                      15.61                     15.707                     15.816                     15.816                       15.94                      16.08                     16.236                    16.407                     16.579        
    coh770:k=57.0572,b=0             15.395                     15.458                     15.533                     15.619                     15.715                     15.824                     15.824                      15.948                     16.087                     16.243                    16.414                     16.584        
    coh771:k=57.1575,b=0             15.404                     15.467                     15.542                     15.627                     15.723                     15.832                     15.832                      15.956                     16.095                     16.251                     16.42                     16.589        
    coh772:k=57.2579,b=0             15.412                     15.475                      15.55                     15.635                     15.731                      15.84                      15.84                      15.963                     16.102                     16.258                    16.427                     16.595        

tb_pol_a: optimal safe savings choice for each state space point
                            zi1_zr_0_025_zw_0_34664    zi2_zr_0_025_zw_0_42338    zi3_zr_0_025_zw_0_51712    zi4_zr_0_025_zw_0_63162    zi5_zr_0_025_zw_0_77146    zi6_zr_0_025_zw_0_94226    zi50_zr_0_095_zw_0_94226    zi51_zr_0_095_zw_1_1509    zi52_zr_0_095_zw_1_4057    zi53_zr_0_095_zw_1_7169    zi54_zr_0_095_zw_2_097    zi55_zr_0_095_zw_2_5613
                            _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    ______________________    _______________________

    coh1:k=-20,b=0                  -2.0408                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh2:k=-19.8997,b=0             -2.0408                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh3:k=-19.7993,b=0             -2.0408                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh4:k=-19.699,b=0              -2.0408                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh5:k=-19.5987,b=0             -2.0408                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh6:k=-19.4983,b=0                 -20                     -2.449                    -2.8571                    -3.6735                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh7:k=-19.398,b=0                  -20                        -20                        -20                        -20                    -4.898                     -6.1224                    -2.8571                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh8:k=-19.2977,b=0                 -20                        -20                        -20                        -20                       -20                     -6.1224                        -20                     -3.6735                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh9:k=-19.1973,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                    -4.4898                    -5.7143                   -7.3469                    -9.3878        
    coh10:k=-19.097,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                    -5.7143                   -7.3469                    -9.3878        
    coh11:k=-18.9967,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                    -5.7143                   -7.3469                    -9.3878        
    coh12:k=-18.8963,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                   -7.3469                    -9.3878        
    coh13:k=-18.796,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                   -7.3469                    -9.3878        
    coh14:k=-18.6956,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                   -7.3469                    -9.3878        
    coh15:k=-18.5953,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                    -9.3878        
    coh16:k=-18.495,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                    -9.3878        
    coh17:k=-18.3946,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                    -9.3878        
    coh18:k=-18.2943,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh19:k=-18.194,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh20:k=-18.0936,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh21:k=-17.9933,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh22:k=-17.893,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh23:k=-17.7926,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh24:k=-17.6923,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh25:k=-17.592,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh26:k=-17.4916,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh27:k=-17.3913,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh28:k=-17.291,b=0                 -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh29:k=-17.1906,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh30:k=-17.0903,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh31:k=-16.99,b=0                  -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh32:k=-16.8896,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh33:k=-16.7893,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh34:k=-16.6889,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh35:k=-16.5886,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh36:k=-16.4883,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh37:k=-16.3879,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh38:k=-16.2876,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh39:k=-16.1873,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh40:k=-16.0869,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh41:k=-15.9866,b=0                -20                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh42:k=-15.8863,b=0             -19.94                        -20                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh43:k=-15.7859,b=0              -19.9                    -19.334                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh44:k=-15.6856,b=0            -18.848                    -19.276                        -20                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh45:k=-15.5853,b=0            -18.778                    -19.215                    -19.921                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh46:k=-15.4849,b=0            -18.706                    -19.153                    -19.856                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh47:k=-15.3846,b=0            -18.632                    -19.089                     -19.81                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh48:k=-15.2843,b=0            -18.555                    -19.023                    -19.762                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh49:k=-15.1839,b=0            -18.477                    -18.955                    -19.689                        -20                       -20                         -20                        -20                         -20                        -20                        -20                       -20                        -20        
    coh50:k=-15.0836,b=0            -18.399                    -18.885                    -19.593                        -20                       -20                         -20                    -19.578                         -20                        -20                        -20                       -20                        -20        
    coh723:k=52.3415,b=0             46.526                      45.14                      45.14                     43.754                    42.369                      39.657                     39.657                      38.301                     35.589                     32.878                     28.81                     24.743        
    coh724:k=52.4418,b=0             46.619                     45.231                     45.231                     43.843                    42.455                       39.74                      39.74                      38.382                     35.666                     32.951                    28.878                     24.805        
    coh725:k=52.5421,b=0             46.711                     45.321                     45.321                     43.931                    42.542                      39.822                     39.822                      38.463                     35.744                     33.024                    28.946                     24.867        
    coh726:k=52.6425,b=0             46.803                     45.412                     45.412                      44.02                    42.628                      39.905                     39.905                      38.544                     35.821                     33.098                    29.013                     24.929        
    coh727:k=52.7428,b=0             46.896                     45.502                     45.502                     44.108                    42.715                      39.988                     39.988                      38.624                     35.898                     33.171                    29.081                     24.991        
    coh728:k=52.8431,b=0             46.988                     45.592                     45.592                     44.197                    42.801                      40.071                     40.071                      38.705                     35.975                     33.244                    29.149                     25.053        
    coh729:k=52.9435,b=0              47.08                     45.683                     45.683                     44.285                    42.888                      40.153                     40.153                      38.786                     36.052                     33.318                    29.216                     25.115        
    coh730:k=53.0438,b=0             47.172                     45.773                     45.773                     44.373                    42.974                      40.236                     40.236                      38.867                     36.129                     33.391                    29.284                     25.177        
    coh731:k=53.1441,b=0             47.265                     45.863                     45.863                     44.462                    43.061                      40.319                     40.319                      38.948                     36.206                     33.464                    29.352                     25.239        
    coh732:k=53.2445,b=0             47.357                     45.954                     45.954                      44.55                    43.147                      40.402                     40.402                      39.029                     36.283                     33.538                    29.419                     25.301        
    coh733:k=53.3448,b=0             47.449                     46.044                     46.044                     44.639                    43.234                      40.484                     40.484                       39.11                      36.36                     33.611                    30.382                     25.363        
    coh734:k=53.4451,b=0             47.541                     46.134                     46.134                     44.727                     43.32                      40.567                     40.567                       39.19                     36.437                     33.684                    30.931                     25.425        
    coh735:k=53.5455,b=0             47.634                     46.225                     46.225                     44.816                    43.407                       40.65                      40.65                      39.271                     36.515                     33.758                    31.001                     25.487        
    coh736:k=53.6458,b=0             47.726                     46.315                     46.315                     44.904                    43.493                      40.732                     40.732                      39.352                     36.592                     33.831                    31.071                     25.549        
    coh737:k=53.7462,b=0             47.818                     46.405                     46.405                     44.992                     43.58                      42.167                     42.167                      39.433                     36.669                     33.904                     31.14                     25.611        
    coh738:k=53.8465,b=0              47.91                     46.496                     46.496                     45.081                    43.666                      42.251                     42.251                      39.514                     36.746                     33.978                     31.21                     25.673        
    coh739:k=53.9468,b=0             48.003                     46.586                     46.586                     45.169                    43.753                      42.336                     42.336                      39.595                     36.823                     34.051                    31.279                     25.736        
    coh740:k=54.0472,b=0             48.095                     46.676                     46.676                     45.258                    43.839                       42.42                      42.42                      39.676                       36.9                     34.124                    31.349                     25.912        
    coh741:k=54.1475,b=0             48.187                     46.767                     46.767                     45.346                    43.926                      42.505                     42.505                      39.757                     36.977                     34.198                    31.418                     27.249        
    coh742:k=54.2478,b=0              48.28                     46.857                     46.857                     45.435                    44.012                       42.59                      42.59                      39.837                     37.054                     34.271                    31.488                     27.313        
    coh743:k=54.3482,b=0             48.372                     46.947                     46.947                     45.523                    44.099                      42.674                     42.674                      39.918                     37.131                     34.344                    31.558                     27.377        
    coh744:k=54.4485,b=0             48.464                     47.038                     47.038                     45.611                    44.185                      44.053                     44.053                      39.999                     37.208                     34.418                    31.627                     27.441        
    coh745:k=54.5488,b=0             48.556                     47.128                     47.128                       45.7                    44.272                      44.272                     44.272                       40.08                     37.286                     34.491                    31.697                     27.505        
    coh746:k=54.6492,b=0              48.65                     47.222                     47.222                     44.358                    42.959                       41.56                      41.56                      40.161                     37.363                     34.564                    31.766                     27.569        
    coh747:k=54.7495,b=0             47.247                     45.846                     45.846                     44.445                    43.044                      41.643                     41.643                      40.242                      37.44                     34.638                    31.836                     27.633        
    coh748:k=54.8498,b=0             47.337                     45.934                     45.934                     44.531                    43.128                      41.725                     41.725                      40.323                     38.124                     34.711                    31.905                     27.697        
    coh749:k=54.9502,b=0             47.427                     46.022                     46.022                     44.618                    43.213                      41.808                     41.808                      40.403                     38.999                     34.784                    31.975                     27.761        
    coh750:k=55.0505,b=0             47.517                     46.111                     46.111                     44.704                    43.297                      41.891                     41.891                      40.484                     39.078                     34.858                    32.045                     27.825        
    coh751:k=55.1508,b=0             47.608                     46.199                     46.199                     44.791                    43.382                      41.974                     41.974                      40.565                     39.157                     34.931                    32.114                     27.889        
    coh752:k=55.2512,b=0             47.698                     46.287                     46.287                     44.877                    43.467                      42.056                     42.056                      40.646                     39.236                     35.005                    32.184                     28.105        
    coh753:k=55.3515,b=0             47.788                     46.376                     46.376                     44.964                    43.551                      42.139                     42.139                      40.727                     39.315                     35.078                    32.253                     29.466        
    coh754:k=55.4518,b=0             47.878                     46.464                     46.464                      45.05                    43.636                      42.222                     42.222                      40.808                     39.394                     35.151                    32.323                     30.832        
    coh755:k=55.5522,b=0             47.969                     46.553                     46.553                     45.137                    43.721                      42.305                     42.305                      40.889                     39.473                     36.448                    33.616                     28.529        
    coh756:k=55.6525,b=0             48.059                     46.641                     46.641                     45.223                    43.805                      42.387                     42.387                      40.969                     39.552                     36.716                    32.769                     28.208        
    coh757:k=55.7529,b=0             48.149                     46.729                     46.729                      45.31                     43.89                       42.47                      42.47                       41.05                     39.631                     36.791                    32.532                     28.272        
    coh758:k=55.8532,b=0             48.239                     46.818                     46.818                     45.396                    43.974                      42.553                     42.553                      41.131                      39.71                     36.866                    32.601                     28.336        
    coh759:k=55.9535,b=0              48.33                     46.906                     46.906                     45.483                    44.059                      42.636                     42.636                      41.212                     39.788                     36.941                    32.671                       28.4        
    coh760:k=56.0539,b=0              48.42                     46.995                     46.995                     45.569                    44.144                      43.372                     43.372                      41.293                     39.867                     37.017                     32.74                     28.464        
    coh761:k=56.1542,b=0              48.51                     47.083                     47.083                     45.656                    44.228                      44.228                     44.228                      41.374                     39.946                     37.092                     32.81                     28.528        
    coh762:k=56.2545,b=0             48.601                     47.173                     47.173                     45.744                    44.315                      44.315                     44.315                      41.458                      40.03                     37.173                    32.887                     28.601        
    coh763:k=56.3549,b=0             48.693                     47.265                     47.265                     45.836                    44.408                      44.408                     44.408                       41.55                     40.122                     37.265                    32.979                     28.693        
    coh764:k=56.4552,b=0             48.785                     47.357                     47.357                     45.928                      44.5                        44.5                       44.5                      41.643                     40.214                     37.357                    33.071                     28.785        
    coh765:k=56.5555,b=0             48.878                     47.449                     47.449                      46.02                    44.592                      44.592                     44.592                      41.735                     40.306                     37.449                    33.163                       27.7        
    coh766:k=56.6559,b=0              48.97                     47.541                     47.541                     46.113                    44.684                      44.684                     44.684                      41.827                     40.398                     37.541                    31.977                     27.762        
    coh767:k=56.7562,b=0             49.062                     47.633                     47.633                     46.205                    44.776                      44.776                     44.776                      41.919                     39.078                     34.858                    32.045                     27.825        
    coh768:k=56.8565,b=0             49.154                     47.725                     47.725                     46.297                     43.38                      41.972                     41.972                      40.563                     39.155                      34.93                    32.113                     27.887        
    coh769:k=56.9569,b=0             47.694                     46.284                     46.284                     44.873                    43.463                      42.053                     42.053                      40.642                     39.232                     35.001                    32.181                     28.044        
    coh770:k=57.0572,b=0             47.782                      46.37                      46.37                     44.958                    43.546                      42.134                     42.134                      40.721                     39.309                     35.073                    32.249                     29.375        
    coh771:k=57.1575,b=0              47.87                     46.456                     46.456                     45.042                    43.628                      42.214                     42.214                      40.801                     39.387                     35.145                    32.317                      30.71        
    coh772:k=57.2579,b=0             47.959                     46.543                     46.543                     45.127                    43.711                      42.295                     42.295                       40.88                     39.464                     36.296                    33.464                      28.81        

tb_pol_k: optimal risky investment choice for each state space point
                            zi1_zr_0_025_zw_0_34664    zi2_zr_0_025_zw_0_42338    zi3_zr_0_025_zw_0_51712    zi4_zr_0_025_zw_0_63162    zi5_zr_0_025_zw_0_77146    zi6_zr_0_025_zw_0_94226    zi50_zr_0_095_zw_0_94226    zi51_zr_0_095_zw_1_1509    zi52_zr_0_095_zw_1_4057    zi53_zr_0_095_zw_1_7169    zi54_zr_0_095_zw_2_097    zi55_zr_0_095_zw_2_5613
                            _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    ______________________    _______________________

    coh1:k=-20,b=0                   2.0408                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh2:k=-19.8997,b=0              2.0408                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh3:k=-19.7993,b=0              2.0408                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh4:k=-19.699,b=0               2.0408                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh5:k=-19.5987,b=0              2.0408                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh6:k=-19.4983,b=0                   0                      2.449                     2.8571                     3.6735                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh7:k=-19.398,b=0                    0                          0                          0                          0                      4.898                     6.1224                     2.8571                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh8:k=-19.2977,b=0                   0                          0                          0                          0                          0                     6.1224                          0                     3.6735                     4.4898                     5.7143                     7.3469                    9.3878         
    coh9:k=-19.1973,b=0                   0                          0                          0                          0                          0                          0                          0                          0                     4.4898                     5.7143                     7.3469                    9.3878         
    coh10:k=-19.097,b=0                   0                          0                          0                          0                          0                          0                          0                          0                          0                     5.7143                     7.3469                    9.3878         
    coh11:k=-18.9967,b=0                  0                          0                          0                          0                          0                          0                          0                          0                          0                     5.7143                     7.3469                    9.3878         
    coh12:k=-18.8963,b=0                  0                          0                          0                          0                          0                          0                          0                          0                          0                          0                     7.3469                    9.3878         
    coh13:k=-18.796,b=0                   0                          0                    0.49144                    0.46686                    0.41772                    0.41772                          0                          0                          0                          0                     7.3469                    9.3878         
    coh14:k=-18.6956,b=0            0.55901                    0.50577                    0.50577                    0.50577                    0.50577                    0.45253                          0                          0                          0                          0                     7.3469                    9.3878         
    coh15:k=-18.5953,b=0            0.60201                    0.60201                    0.57334                    0.51601                    0.51601                    0.48734                          0                          0                          0                          0                          0                    9.3878         
    coh16:k=-18.495,b=0             0.64501                     0.6143                     0.6143                    0.58358                    0.55287                    0.52215                          0                          0                          0                          0                          0                    9.3878         
    coh17:k=-18.3946,b=0            0.68801                    0.68801                    0.65525                    0.62249                    0.58972                    0.58972                          0                          0                          0                          0                          0                    9.3878         
    coh18:k=-18.2943,b=0            0.73101                     0.6962                     0.6962                     0.6962                    0.62658                    0.62658                          0                          0                          0                          0                          0                         0         
    coh19:k=-18.194,b=0             0.77401                    0.77401                    0.73715                     0.7003                     0.7003                    0.66344                          0                          0                          0                          0                          0                         0         
    coh20:k=-18.0936,b=0            0.81701                    0.81701                    0.77811                    0.77811                     0.7003                     0.7003                          0                          0                          0                          0                          0                         0         
    coh21:k=-17.9933,b=0            0.90097                    0.86001                    0.81906                    0.81906                    0.77811                    0.73715                          0                          0                          0                          0                          0                         0         
    coh22:k=-17.893,b=0             0.90301                    0.90301                    0.90301                    0.86001                    0.81701                    0.77401                          0                          0                          0                          0                          0                         0         
    coh23:k=-17.7926,b=0            0.99106                    0.94601                    0.90097                    0.90097                    0.85592                    0.81087                          0                          0                          0                          0                          0                         0         
    coh24:k=-17.6923,b=0            0.98902                    0.98902                    0.98902                    0.94192                    0.89482                    0.89482                          0                          0                          0                          0                          0                         0         
    coh25:k=-17.592,b=0              1.0812                      1.032                      1.032                    0.98287                    0.93373                    0.93373                          0                          0                          0                          0                          0                         0         
    coh26:k=-17.4916,b=0             1.1262                      1.075                      1.075                     1.0238                    0.97263                    0.97263                          0                          0                          0                          0                          0                         0         
    coh27:k=-17.3913,b=0             1.1713                      1.118                      1.118                     1.0648                     1.0115                     1.0115                          0                          0                          0                          0                          0                         0         
    coh28:k=-17.291,b=0              1.2163                      1.161                      1.161                     1.1057                     1.1057                     1.0504                          0                          0                          0                          0                          0                         0         
    coh29:k=-17.1906,b=0             1.2614                      1.204                      1.204                     1.1467                     1.1467                     1.0894                          0                          0                          0                          0                          0                         0         
    coh30:k=-17.0903,b=0             1.3064                     1.3064                      1.247                     1.1876                     1.1876                     1.1283                          0                          0                          0                          0                          0                         0         
    coh31:k=-16.99,b=0               1.3514                       1.29                       1.29                     1.2286                     1.2286                     1.1672                     1.7815                       1.72                     1.5972                          0                          0                         0         
    coh32:k=-16.8896,b=0             1.3965                     1.3965                      1.333                      1.333                     1.2695                     1.2061                     1.8408                     1.7139                     1.6504                     1.5869                          0                         0         
    coh33:k=-16.7893,b=0             1.4415                     1.4415                      1.376                     1.3105                     1.3105                     1.3105                     1.9002                     1.7692                     1.7036                     1.6381                     1.5726                         0         
    coh34:k=-16.6889,b=0             1.4866                     1.4866                      1.419                      1.419                     1.3514                     1.3514                      1.892                     1.8245                     1.7569                     1.6893                     1.6217                    1.5542         
    coh35:k=-16.5886,b=0             1.5316                     1.5316                      1.462                      1.462                     1.3924                     1.3924                     1.9494                     1.8797                     1.8101                     1.7405                     1.6709                    1.6013         
    coh36:k=-16.4883,b=0             1.5767                     1.5767                      1.505                      1.505                      1.505                      1.505                     2.0067                      1.935                     1.8634                     1.7917                       1.72                    1.6484         
    coh37:k=-16.3879,b=0             1.6217                     1.6217                      1.548                      1.548                      1.548                     2.1377                      2.064                     1.9903                     1.9166                     1.8429                     1.7692                    2.2115         
    coh38:k=-16.2876,b=0             1.6668                     1.6668                      1.591                      1.591                      1.591                     2.2729                     2.1214                     2.0456                     1.9698                     1.8941                     1.8941                    2.4244         
    coh39:k=-16.1873,b=0             1.7118                     1.7118                     1.7118                     1.7118                     2.4121                     2.3343                     2.1009                     2.1009                     2.0231                     1.9453                     2.1787                    2.4899         
    coh40:k=-16.0869,b=0             1.7569                     1.7569                     1.7569                     1.7569                     2.4756                     2.4756                     2.1562                     2.1562                     2.0763                     2.0763                      2.236                    2.6353         
    coh41:k=-15.9866,b=0             1.8019                     1.8019                     1.8019                      2.621                      2.621                     2.5391                     2.2115                     2.2115                     2.1296                     2.1296                     2.5391                    2.7848         
    coh42:k=-15.8863,b=0             1.8707                      1.847                     2.7705                     2.6865                     2.6865                     2.6026                     2.2667                     2.1828                     2.1828                     2.1828                     2.7705                    2.8544         
    coh43:k=-15.7859,b=0             1.8784                      2.258                      2.838                      2.752                      2.752                      2.666                      2.322                      2.322                      2.236                      2.494                      2.838                      3.01         
    coh44:k=-15.6856,b=0             1.8417                     2.2694                     2.9056                     2.8176                     2.8176                     2.7295                     2.3773                     2.3773                     2.3773                     2.8176                     2.9056                    3.0817         
    coh45:k=-15.5853,b=0             1.8409                     2.2785                     2.8937                     2.8831                     2.8831                      2.793                     2.4326                     2.4326                     2.5227                     2.8831                     2.9732                    3.1534         
    coh46:k=-15.4849,b=0             1.8385                      2.286                     2.8963                     2.9486                     2.9486                     2.8565                     2.4879                     2.4879                     2.8565                     3.0408                     3.1329                    3.2251         
    coh47:k=-15.3846,b=0             1.8342                     2.2917                     2.9184                     3.0141                     3.0141                       2.92                     2.5432                     2.5432                     3.1083                     3.1083                     3.2025                    3.3909         
    coh48:k=-15.2843,b=0             1.8274                     2.2948                     2.9377                     3.0797                     3.0797                     2.9834                     2.6947                     3.0797                     3.1759                     3.1759                     3.3684                    3.4646         
    coh49:k=-15.1839,b=0              1.819                     2.2964                     2.9325                     3.1452                     3.1452                     3.0469                      2.752                     3.2435                     3.2435                     3.3418                     3.4401                    3.5383         
    coh50:k=-15.0836,b=0             1.8101                     2.2963                     2.9045                     3.2107                     3.2107                     3.1104                      2.989                     3.4114                     3.4114                     3.4114                     3.5117                    3.7124         
    coh723:k=52.3415,b=0              1.386                     2.7719                     2.7719                     4.1579                     5.5439                     6.7792                     6.7792                      8.135                     10.847                     13.558                     17.626                    21.693         
    coh724:k=52.4418,b=0             1.3879                     2.7758                     2.7758                     4.1637                     5.5516                     6.7886                     6.7886                     8.1463                     10.862                     13.577                      17.65                    21.723         
    coh725:k=52.5421,b=0             1.3898                     2.7796                     2.7796                     4.1694                     5.5592                      6.798                      6.798                     8.1576                     10.877                     13.596                     17.675                    21.754         
    coh726:k=52.6425,b=0             1.3917                     2.7835                     2.7835                     4.1752                     5.5669                     6.8074                     6.8074                     8.1689                     10.892                     13.615                     17.699                    21.784         
    coh727:k=52.7428,b=0             1.3937                     2.7873                     2.7873                      4.181                     5.5746                     6.8168                     6.8168                     8.1802                     10.907                     13.634                     17.724                    21.814         
    coh728:k=52.8431,b=0             1.3956                     2.7912                     2.7912                     4.1867                     5.5823                     6.8262                     6.8262                     8.1914                     10.922                     13.652                     17.748                    21.844         
    coh729:k=52.9435,b=0             1.3975                      2.795                      2.795                     4.1925                       5.59                     6.8356                     6.8356                     8.2027                     10.937                     13.671                     17.773                    21.874         
    coh730:k=53.0438,b=0             1.3994                     2.7988                     2.7988                     4.1983                     5.5977                      6.845                      6.845                      8.214                     10.952                      13.69                     17.797                    21.904         
    coh731:k=53.1441,b=0             1.4013                     2.8027                     2.8027                      4.204                     5.6054                     6.8544                     6.8544                     8.2253                     10.967                     13.709                     17.821                    21.934         
    coh732:k=53.2445,b=0             1.4033                     2.8065                     2.8065                     4.2098                     5.6131                     6.8638                     6.8638                     8.2366                     10.982                     13.728                     17.846                    21.964         
    coh733:k=53.3448,b=0             1.4052                     2.8104                     2.8104                     4.2156                     5.6208                     6.8732                     6.8732                     8.2479                     10.997                     13.746                     16.976                    21.994         
    coh734:k=53.4451,b=0             1.4071                     2.8142                     2.8142                     4.2213                     5.6284                     6.8826                     6.8826                     8.2591                     11.012                     13.765                     16.518                    22.024         
    coh735:k=53.5455,b=0              1.409                     2.8181                     2.8181                     4.2271                     5.6361                      6.892                      6.892                     8.2704                     11.027                     13.784                     16.541                    22.054         
    coh736:k=53.6458,b=0              1.411                     2.8219                     2.8219                     4.2329                     5.6438                     6.9014                     6.9014                     8.2817                     11.042                     13.803                     16.563                    22.085         
    coh737:k=53.7462,b=0             1.4129                     2.8258                     2.8258                     4.2386                     5.6515                     7.0644                     7.0644                      8.293                     11.057                     13.822                     16.586                    22.115         
    coh738:k=53.8465,b=0             1.4148                     2.8296                     2.8296                     4.2444                     5.6592                      7.074                      7.074                     8.3043                     11.072                      13.84                     16.609                    22.145         
    coh739:k=53.9468,b=0             1.4167                     2.8334                     2.8334                     4.2502                     5.6669                     7.0836                     7.0836                     8.3156                     11.087                     13.859                     16.631                    22.175         
    coh740:k=54.0472,b=0             1.4186                     2.8373                     2.8373                     4.2559                     5.6746                     7.0932                     7.0932                     8.3268                     11.102                     13.878                     16.654                    22.091         
    coh741:k=54.1475,b=0             1.4206                     2.8411                     2.8411                     4.2617                     5.6823                     7.1028                     7.1028                     8.3381                     11.117                     13.897                     16.676                    20.845         
    coh742:k=54.2478,b=0             1.4225                      2.845                      2.845                     4.2675                       5.69                     7.1125                     7.1125                     8.3494                     11.133                     13.916                     16.699                    20.874         
    coh743:k=54.3482,b=0             1.4244                     2.8488                     2.8488                     4.2732                     5.6977                     7.1221                     7.1221                     8.3607                     11.148                     13.934                     16.721                    20.902         
    coh744:k=54.4485,b=0             1.4263                     2.8527                     2.8527                      4.279                     5.7053                     5.8373                     5.8373                      8.372                     11.163                     13.953                     16.744                     20.93         
    coh745:k=54.5488,b=0             1.4283                     2.8565                     2.8565                     4.2848                      5.713                      5.713                      5.713                     8.3833                     11.178                     13.972                     16.767                    20.958         
    coh746:k=54.6492,b=0             1.4286                     2.8571                     2.8571                     4.1973                     5.5964                     6.9954                     6.9954                     8.3945                     11.193                     13.991                     16.789                    20.986         
    coh747:k=54.7495,b=0              1.401                     2.8019                     2.8019                     4.2029                     5.6039                     7.0048                     7.0048                     8.4058                     11.208                      14.01                     16.812                    21.015         
    coh748:k=54.8498,b=0             1.4028                     2.8057                     2.8057                     4.2085                     5.6114                     7.0142                     7.0142                     8.4171                     10.616                     14.028                     16.834                    21.043         
    coh749:k=54.9502,b=0             1.4047                     2.8095                     2.8095                     4.2142                     5.6189                     7.0237                     7.0237                     8.4284                     9.8331                     14.047                     16.857                    21.071         
    coh750:k=55.0505,b=0             1.4066                     2.8132                     2.8132                     4.2198                     5.6264                     7.0331                     7.0331                     8.4397                     9.8463                     14.066                     16.879                    21.099         
    coh751:k=55.1508,b=0             1.4085                      2.817                      2.817                     4.2255                      5.634                     7.0425                     7.0425                     8.4509                     9.8594                     14.085                     16.902                    21.127         
    coh752:k=55.2512,b=0             1.4104                     2.8207                     2.8207                     4.2311                     5.6415                     7.0519                     7.0519                     8.4622                     9.8726                     14.104                     16.924                    21.003         
    coh753:k=55.3515,b=0             1.4123                     2.8245                     2.8245                     4.2368                      5.649                     7.0613                     7.0613                     8.4735                     9.8858                     14.123                     16.947                    19.734         
    coh754:k=55.4518,b=0             1.4141                     2.8283                     2.8283                     4.2424                     5.6565                     7.0707                     7.0707                     8.4848                     9.8989                     14.141                      16.97                    18.461         
    coh755:k=55.5522,b=0              1.416                      2.832                      2.832                      4.248                     5.6641                     7.0801                     7.0801                     8.4961                     9.9121                     12.936                     15.768                    20.856         
    coh756:k=55.6525,b=0             1.4179                     2.8358                     2.8358                     4.2537                     5.6716                     7.0895                     7.0895                     8.5074                     9.9253                     12.761                     16.707                    21.268         
    coh757:k=55.7529,b=0             1.4198                     2.8395                     2.8395                     4.2593                     5.6791                     7.0989                     7.0989                     8.5186                     9.9384                     12.778                     17.037                    21.297         
    coh758:k=55.8532,b=0             1.4217                     2.8433                     2.8433                      4.265                     5.6866                     7.1083                     7.1083                     8.5299                     9.9516                     12.795                      17.06                    21.325         
    coh759:k=55.9535,b=0             1.4235                     2.8471                     2.8471                     4.2706                     5.6941                     7.1177                     7.1177                     8.5412                     9.9647                     12.812                     17.082                    21.353         
    coh760:k=56.0539,b=0             1.4254                     2.8508                     2.8508                     4.2762                     5.7017                     6.4735                     6.4735                     8.5525                     9.9779                     12.829                     17.105                    21.381         
    coh761:k=56.1542,b=0             1.4273                     2.8546                     2.8546                     4.2819                     5.7092                     5.7092                     5.7092                     8.5638                     9.9911                     12.846                     17.128                    21.409         
    coh762:k=56.2545,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                         10                     12.857                     17.143                    21.429         
    coh763:k=56.3549,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                         10                     12.857                     17.143                    21.429         
    coh764:k=56.4552,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                         10                     12.857                     17.143                    21.429         
    coh765:k=56.5555,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                         10                     12.857                     17.143                    21.044         
    coh766:k=56.6559,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                         10                     12.857                     16.857                    21.072         
    coh767:k=56.7562,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.7143                     5.7143                     5.7143                     8.5714                     9.8463                     14.066                     16.879                    21.099         
    coh768:k=56.8565,b=0             1.4286                     2.8571                     2.8571                     4.2857                     5.6338                     7.0422                     7.0422                     8.4507                     9.8591                     14.084                     16.901                    21.127         
    coh769:k=56.9569,b=0             1.4103                     2.8206                     2.8206                     4.2309                     5.6412                     7.0514                     7.0514                     8.4617                      9.872                     14.103                     16.923                     21.06         
    coh770:k=57.0572,b=0             1.4121                     2.8243                     2.8243                     4.2364                     5.6485                     7.0606                     7.0606                     8.4728                     9.8849                     14.121                     16.946                    19.819         
    coh771:k=57.1575,b=0              1.414                     2.8279                     2.8279                     4.2419                     5.6559                     7.0698                     7.0698                     8.4838                     9.8978                      14.14                     16.968                    18.574         
    coh772:k=57.2579,b=0             1.4158                     2.8316                     2.8316                     4.2474                     5.6632                      7.079                      7.079                     8.4948                     9.9106                     13.079                      15.91                    20.564         

tb_pol_w: risky + safe investment choices (first stage choice, choose within risky vs safe)
                            zi1_zr_0_025_zw_0_34664    zi2_zr_0_025_zw_0_42338    zi3_zr_0_025_zw_0_51712    zi4_zr_0_025_zw_0_63162    zi5_zr_0_025_zw_0_77146    zi6_zr_0_025_zw_0_94226    zi50_zr_0_095_zw_0_94226    zi51_zr_0_095_zw_1_1509    zi52_zr_0_095_zw_1_4057    zi53_zr_0_095_zw_1_7169    zi54_zr_0_095_zw_2_097    zi55_zr_0_095_zw_2_5613
                            _______________________    _______________________    _______________________    _______________________    _______________________    _______________________    ________________________    _______________________    _______________________    _______________________    ______________________    _______________________

    coh1:k=-20,b=0                        0                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh2:k=-19.8997,b=0                   0                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh3:k=-19.7993,b=0                   0                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh4:k=-19.699,b=0                    0                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh5:k=-19.5987,b=0                   0                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh6:k=-19.4983,b=0                 -20                          0                          0                          0                          0                          0                          0                           0                          0                          0                         0                          0        
    coh7:k=-19.398,b=0                  -20                        -20                        -20                        -20                          0                          0                          0                           0                          0                          0                         0                          0        
    coh8:k=-19.2977,b=0                 -20                        -20                        -20                        -20                        -20                          0                        -20                           0                          0                          0                         0                          0        
    coh9:k=-19.1973,b=0                 -20                        -20                        -20                        -20                        -20                        -20                        -20                         -20                          0                          0                         0                          0        
    coh10:k=-19.097,b=0                 -20                        -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                          0                         0                          0        
    coh11:k=-18.9967,b=0                -20                        -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                          0                         0                          0        
    coh12:k=-18.8963,b=0                -20                        -20                        -20                        -20                        -20                        -20                        -20                         -20                        -20                        -20                         0                          0        
    coh13:k=-18.796,b=0                 -20                        -20                    -19.509                    -19.533                    -19.582                    -19.582                        -20                         -20                        -20                        -20                         0                          0        
    coh14:k=-18.6956,b=0            -19.441                    -19.494                    -19.494                    -19.494                    -19.494                    -19.547                        -20                         -20                        -20                        -20                         0                          0        
    coh15:k=-18.5953,b=0            -19.398                    -19.398                    -19.427                    -19.484                    -19.484                    -19.513                        -20                         -20                        -20                        -20                       -20                          0        
    coh16:k=-18.495,b=0             -19.355                    -19.386                    -19.386                    -19.416                    -19.447                    -19.478                        -20                         -20                        -20                        -20                       -20                          0        
    coh17:k=-18.3946,b=0            -19.312                    -19.312                    -19.345                    -19.378                     -19.41                     -19.41                        -20                         -20                        -20                        -20                       -20                          0        
    coh18:k=-18.2943,b=0            -19.269                    -19.304                    -19.304                    -19.304                    -19.373                    -19.373                        -20                         -20                        -20                        -20                       -20                        -20        
    coh19:k=-18.194,b=0             -19.226                    -19.226                    -19.263                      -19.3                      -19.3                    -19.337                        -20                         -20                        -20                        -20                       -20                        -20        
    coh20:k=-18.0936,b=0            -19.183                    -19.183                    -19.222                    -19.222                      -19.3                      -19.3                        -20                         -20                        -20                        -20                       -20                        -20        
    coh21:k=-17.9933,b=0            -19.099                     -19.14                    -19.181                    -19.181                    -19.222                    -19.263                        -20                         -20                        -20                        -20                       -20                        -20        
    coh22:k=-17.893,b=0             -19.097                    -19.097                    -19.097                     -19.14                    -19.183                    -19.226                        -20                         -20                        -20                        -20                       -20                        -20        
    coh23:k=-17.7926,b=0            -19.009                    -19.054                    -19.099                    -19.099                    -19.144                    -19.189                        -20                         -20                        -20                        -20                       -20                        -20        
    coh24:k=-17.6923,b=0            -19.011                    -19.011                    -19.011                    -19.058                    -19.105                    -19.105                        -20                         -20                        -20                        -20                       -20                        -20        
    coh25:k=-17.592,b=0             -18.919                    -18.968                    -18.968                    -19.017                    -19.066                    -19.066                        -20                         -20                        -20                        -20                       -20                        -20        
    coh26:k=-17.4916,b=0            -18.874                    -18.925                    -18.925                    -18.976                    -19.027                    -19.027                        -20                         -20                        -20                        -20                       -20                        -20        
    coh27:k=-17.3913,b=0            -18.829                    -18.882                    -18.882                    -18.935                    -18.988                    -18.988                        -20                         -20                        -20                        -20                       -20                        -20        
    coh28:k=-17.291,b=0             -18.784                    -18.839                    -18.839                    -18.894                    -18.894                     -18.95                        -20                         -20                        -20                        -20                       -20                        -20        
    coh29:k=-17.1906,b=0            -18.739                    -18.796                    -18.796                    -18.853                    -18.853                    -18.911                        -20                         -20                        -20                        -20                       -20                        -20        
    coh30:k=-17.0903,b=0            -18.694                    -18.694                    -18.753                    -18.812                    -18.812                    -18.872                        -20                         -20                        -20                        -20                       -20                        -20        
    coh31:k=-16.99,b=0              -18.649                     -18.71                     -18.71                    -18.771                    -18.771                    -18.833                    -18.219                      -18.28                    -18.403                        -20                       -20                        -20        
    coh32:k=-16.8896,b=0            -18.604                    -18.604                    -18.667                    -18.667                     -18.73                    -18.794                    -18.159                     -18.286                     -18.35                    -18.413                       -20                        -20        
    coh33:k=-16.7893,b=0            -18.558                    -18.558                    -18.624                     -18.69                     -18.69                     -18.69                      -18.1                     -18.231                    -18.296                    -18.362                   -18.427                        -20        
    coh34:k=-16.6889,b=0            -18.513                    -18.513                    -18.581                    -18.581                    -18.649                    -18.649                    -18.108                     -18.176                    -18.243                    -18.311                   -18.378                    -18.446        
    coh35:k=-16.5886,b=0            -18.468                    -18.468                    -18.538                    -18.538                    -18.608                    -18.608                    -18.051                      -18.12                     -18.19                    -18.259                   -18.329                    -18.399        
    coh36:k=-16.4883,b=0            -18.423                    -18.423                    -18.495                    -18.495                    -18.495                    -18.495                    -17.993                     -18.065                    -18.137                    -18.208                    -18.28                    -18.352        
    coh37:k=-16.3879,b=0            -18.378                    -18.378                    -18.452                    -18.452                    -18.452                    -17.862                    -17.936                      -18.01                    -18.083                    -18.157                   -18.231                    -17.789        
    coh38:k=-16.2876,b=0            -18.333                    -18.333                    -18.409                    -18.409                    -18.409                    -17.727                    -17.879                     -17.954                     -18.03                    -18.106                   -18.106                    -17.576        
    coh39:k=-16.1873,b=0            -18.288                    -18.288                    -18.288                    -18.288                    -17.588                    -17.666                    -17.899                     -17.899                    -17.977                    -18.055                   -17.821                     -17.51        
    coh40:k=-16.0869,b=0            -18.243                    -18.243                    -18.243                    -18.243                    -17.524                    -17.524                    -17.844                     -17.844                    -17.924                    -17.924                   -17.764                    -17.365        
    coh41:k=-15.9866,b=0            -18.198                    -18.198                    -18.198                    -17.379                    -17.379                    -17.461                    -17.789                     -17.789                     -17.87                     -17.87                   -17.461                    -17.215        
    coh42:k=-15.8863,b=0            -18.069                    -18.153                     -17.23                    -17.313                    -17.313                    -17.397                    -17.733                     -17.817                    -17.817                    -17.817                    -17.23                    -17.146        
    coh43:k=-15.7859,b=0            -18.022                    -17.076                    -17.162                    -17.248                    -17.248                    -17.334                    -17.678                     -17.678                    -17.764                    -17.506                   -17.162                     -16.99        
    coh44:k=-15.6856,b=0            -17.006                    -17.006                    -17.094                    -17.182                    -17.182                     -17.27                    -17.623                     -17.623                    -17.623                    -17.182                   -17.094                    -16.918        
    coh45:k=-15.5853,b=0            -16.937                    -16.937                    -17.027                    -17.117                    -17.117                    -17.207                    -17.567                     -17.567                    -17.477                    -17.117                   -17.027                    -16.847        
    coh46:k=-15.4849,b=0            -16.867                    -16.867                    -16.959                    -17.051                    -17.051                    -17.144                    -17.512                     -17.512                    -17.144                    -16.959                   -16.867                    -16.775        
    coh47:k=-15.3846,b=0            -16.797                    -16.797                    -16.892                    -16.986                    -16.986                     -17.08                    -17.457                     -17.457                    -16.892                    -16.892                   -16.797                    -16.609        
    coh48:k=-15.2843,b=0            -16.728                    -16.728                    -16.824                     -16.92                     -16.92                    -17.017                    -17.305                      -16.92                    -16.824                    -16.824                   -16.632                    -16.535        
    coh49:k=-15.1839,b=0            -16.658                    -16.658                    -16.757                    -16.855                    -16.855                    -16.953                    -17.248                     -16.757                    -16.757                    -16.658                    -16.56                    -16.462        
    coh50:k=-15.0836,b=0            -16.589                    -16.589                    -16.689                    -16.789                    -16.789                     -16.89                    -16.589                     -16.589                    -16.589                    -16.589                   -16.488                    -16.288        
    coh723:k=52.3415,b=0             47.912                     47.912                     47.912                     47.912                     47.912                     46.436                     46.436                      46.436                     46.436                     46.436                    46.436                     46.436        
    coh724:k=52.4418,b=0             48.007                     48.007                     48.007                     48.007                     48.007                     46.528                     46.528                      46.528                     46.528                     46.528                    46.528                     46.528        
    coh725:k=52.5421,b=0             48.101                     48.101                     48.101                     48.101                     48.101                      46.62                      46.62                       46.62                      46.62                      46.62                     46.62                      46.62        
    coh726:k=52.6425,b=0             48.195                     48.195                     48.195                     48.195                     48.195                     46.712                     46.712                      46.712                     46.712                     46.712                    46.712                     46.712        
    coh727:k=52.7428,b=0             48.289                     48.289                     48.289                     48.289                     48.289                     46.805                     46.805                      46.805                     46.805                     46.805                    46.805                     46.805        
    coh728:k=52.8431,b=0             48.383                     48.383                     48.383                     48.383                     48.383                     46.897                     46.897                      46.897                     46.897                     46.897                    46.897                     46.897        
    coh729:k=52.9435,b=0             48.478                     48.478                     48.478                     48.478                     48.478                     46.989                     46.989                      46.989                     46.989                     46.989                    46.989                     46.989        
    coh730:k=53.0438,b=0             48.572                     48.572                     48.572                     48.572                     48.572                     47.081                     47.081                      47.081                     47.081                     47.081                    47.081                     47.081        
    coh731:k=53.1441,b=0             48.666                     48.666                     48.666                     48.666                     48.666                     47.173                     47.173                      47.173                     47.173                     47.173                    47.173                     47.173        
    coh732:k=53.2445,b=0              48.76                      48.76                      48.76                      48.76                      48.76                     47.265                     47.265                      47.265                     47.265                     47.265                    47.265                     47.265        
    coh733:k=53.3448,b=0             48.854                     48.854                     48.854                     48.854                     48.854                     47.357                     47.357                      47.357                     47.357                     47.357                    47.357                     47.357        
    coh734:k=53.4451,b=0             48.949                     48.949                     48.949                     48.949                     48.949                      47.45                      47.45                       47.45                      47.45                      47.45                     47.45                      47.45        
    coh735:k=53.5455,b=0             49.043                     49.043                     49.043                     49.043                     49.043                     47.542                     47.542                      47.542                     47.542                     47.542                    47.542                     47.542        
    coh736:k=53.6458,b=0             49.137                     49.137                     49.137                     49.137                     49.137                     47.634                     47.634                      47.634                     47.634                     47.634                    47.634                     47.634        
    coh737:k=53.7462,b=0             49.231                     49.231                     49.231                     49.231                     49.231                     49.231                     49.231                      47.726                     47.726                     47.726                    47.726                     47.726        
    coh738:k=53.8465,b=0             49.325                     49.325                     49.325                     49.325                     49.325                     49.325                     49.325                      47.818                     47.818                     47.818                    47.818                     47.818        
    coh739:k=53.9468,b=0             49.419                     49.419                     49.419                     49.419                     49.419                     49.419                     49.419                       47.91                      47.91                      47.91                     47.91                      47.91        
    coh740:k=54.0472,b=0             49.514                     49.514                     49.514                     49.514                     49.514                     49.514                     49.514                      48.002                     48.002                     48.002                    48.002                     48.002        
    coh741:k=54.1475,b=0             49.608                     49.608                     49.608                     49.608                     49.608                     49.608                     49.608                      48.095                     48.095                     48.095                    48.095                     48.095        
    coh742:k=54.2478,b=0             49.702                     49.702                     49.702                     49.702                     49.702                     49.702                     49.702                      48.187                     48.187                     48.187                    48.187                     48.187        
    coh743:k=54.3482,b=0             49.796                     49.796                     49.796                     49.796                     49.796                     49.796                     49.796                      48.279                     48.279                     48.279                    48.279                     48.279        
    coh744:k=54.4485,b=0              49.89                      49.89                      49.89                      49.89                      49.89                      49.89                      49.89                      48.371                     48.371                     48.371                    48.371                     48.371        
    coh745:k=54.5488,b=0             49.985                     49.985                     49.985                     49.985                     49.985                     49.985                     49.985                      48.463                     48.463                     48.463                    48.463                     48.463        
    coh746:k=54.6492,b=0             50.079                     50.079                     50.079                     48.555                     48.555                     48.555                     48.555                      48.555                     48.555                     48.555                    48.555                     48.555        
    coh747:k=54.7495,b=0             48.648                     48.648                     48.648                     48.648                     48.648                     48.648                     48.648                      48.648                     48.648                     48.648                    48.648                     48.648        
    coh748:k=54.8498,b=0              48.74                      48.74                      48.74                      48.74                      48.74                      48.74                      48.74                       48.74                      48.74                      48.74                     48.74                      48.74        
    coh749:k=54.9502,b=0             48.832                     48.832                     48.832                     48.832                     48.832                     48.832                     48.832                      48.832                     48.832                     48.832                    48.832                     48.832        
    coh750:k=55.0505,b=0             48.924                     48.924                     48.924                     48.924                     48.924                     48.924                     48.924                      48.924                     48.924                     48.924                    48.924                     48.924        
    coh751:k=55.1508,b=0             49.016                     49.016                     49.016                     49.016                     49.016                     49.016                     49.016                      49.016                     49.016                     49.016                    49.016                     49.016        
    coh752:k=55.2512,b=0             49.108                     49.108                     49.108                     49.108                     49.108                     49.108                     49.108                      49.108                     49.108                     49.108                    49.108                     49.108        
    coh753:k=55.3515,b=0               49.2                       49.2                       49.2                       49.2                       49.2                       49.2                       49.2                        49.2                       49.2                       49.2                      49.2                       49.2        
    coh754:k=55.4518,b=0             49.293                     49.293                     49.293                     49.293                     49.293                     49.293                     49.293                      49.293                     49.293                     49.293                    49.293                     49.293        
    coh755:k=55.5522,b=0             49.385                     49.385                     49.385                     49.385                     49.385                     49.385                     49.385                      49.385                     49.385                     49.385                    49.385                     49.385        
    coh756:k=55.6525,b=0             49.477                     49.477                     49.477                     49.477                     49.477                     49.477                     49.477                      49.477                     49.477                     49.477                    49.477                     49.477        
    coh757:k=55.7529,b=0             49.569                     49.569                     49.569                     49.569                     49.569                     49.569                     49.569                      49.569                     49.569                     49.569                    49.569                     49.569        
    coh758:k=55.8532,b=0             49.661                     49.661                     49.661                     49.661                     49.661                     49.661                     49.661                      49.661                     49.661                     49.661                    49.661                     49.661        
    coh759:k=55.9535,b=0             49.753                     49.753                     49.753                     49.753                     49.753                     49.753                     49.753                      49.753                     49.753                     49.753                    49.753                     49.753        
    coh760:k=56.0539,b=0             49.845                     49.845                     49.845                     49.845                     49.845                     49.845                     49.845                      49.845                     49.845                     49.845                    49.845                     49.845        
    coh761:k=56.1542,b=0             49.938                     49.938                     49.938                     49.938                     49.938                     49.938                     49.938                      49.938                     49.938                     49.938                    49.938                     49.938        
    coh762:k=56.2545,b=0              50.03                      50.03                      50.03                      50.03                      50.03                      50.03                      50.03                       50.03                      50.03                      50.03                     50.03                      50.03        
    coh763:k=56.3549,b=0             50.122                     50.122                     50.122                     50.122                     50.122                     50.122                     50.122                      50.122                     50.122                     50.122                    50.122                     50.122        
    coh764:k=56.4552,b=0             50.214                     50.214                     50.214                     50.214                     50.214                     50.214                     50.214                      50.214                     50.214                     50.214                    50.214                     50.214        
    coh765:k=56.5555,b=0             50.306                     50.306                     50.306                     50.306                     50.306                     50.306                     50.306                      50.306                     50.306                     50.306                    50.306                     48.744        
    coh766:k=56.6559,b=0             50.398                     50.398                     50.398                     50.398                     50.398                     50.398                     50.398                      50.398                     50.398                     50.398                    48.834                     48.834        
    coh767:k=56.7562,b=0              50.49                      50.49                      50.49                      50.49                      50.49                      50.49                      50.49                       50.49                     48.924                     48.924                    48.924                     48.924        
    coh768:k=56.8565,b=0             50.583                     50.583                     50.583                     50.583                     49.014                     49.014                     49.014                      49.014                     49.014                     49.014                    49.014                     49.014        
    coh769:k=56.9569,b=0             49.104                     49.104                     49.104                     49.104                     49.104                     49.104                     49.104                      49.104                     49.104                     49.104                    49.104                     49.104        
    coh770:k=57.0572,b=0             49.194                     49.194                     49.194                     49.194                     49.194                     49.194                     49.194                      49.194                     49.194                     49.194                    49.194                     49.194        
    coh771:k=57.1575,b=0             49.284                     49.284                     49.284                     49.284                     49.284                     49.284                     49.284                      49.284                     49.284                     49.284                    49.284                     49.284        
    coh772:k=57.2579,b=0             49.374                     49.374                     49.374                     49.374                     49.374                     49.374                     49.374                      49.374                     49.374                     49.374                    49.374                     49.374        

</pre><img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_01.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_02.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_03.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_04.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_05.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_06.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_07.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_08.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_09.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_10.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_11.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_12.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_13.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_14.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_15.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_16.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_17.png" alt=""> <img vspace="5" hspace="5" src="ff_ipwkbzr_vf_vecsv_18.png" alt=""> <h2 id="33">Display Various Containers</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_defparam)
</pre><h2 id="35">Display 1 support_map</h2><pre class="codeinput">    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: SUPPORT_MAP
----------------------------------------
  Map with properties:

        Count: 43
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 29 ; key = st_img_name_main ; val = ff_ipwkbzr_vf_vecsv_default
pos = 30 ; key = st_img_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/img/
pos = 31 ; key = st_img_prefix ; val = 
pos = 32 ; key = st_img_suffix ; val = _p4.png
pos = 33 ; key = st_mat_name_main ; val = ff_ipwkbzr_vf_vecsv_default
pos = 34 ; key = st_mat_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/mat/
pos = 35 ; key = st_mat_prefix ; val = 
pos = 36 ; key = st_mat_suffix ; val = _p4
pos = 37 ; key = st_mat_test_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//test/ff_ipwkbzr_ds_vecsv/mat/
pos = 38 ; key = st_matimg_path_root ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr/
pos = 39 ; key = st_profile_name_main ; val = ff_ipwkbzr_vf_vecsv_default
pos = 40 ; key = st_profile_path ; val = C:/Users/fan/CodeDynaAsset//m_ipwkbzr//solve/profile/
pos = 41 ; key = st_profile_prefix ; val = 
pos = 42 ; key = st_profile_suffix ; val = _p4
pos = 43 ; key = st_title_prefix ; val = 
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                    i     idx    value
                                    __    ___    _____

    bl_display                       1     1        0 
    bl_display_defparam              2     2        1 
    bl_display_dist                  3     3        0 
    bl_display_evf                   4     4        0 
    bl_display_final                 5     5        1 
    bl_display_final_dist            6     6        0 
    bl_display_final_dist_detail     7     7        0 
    bl_display_funcgrids             8     8        0 
    bl_graph                         9     9        1 
    bl_graph_coh_t_coh              10    10        1 
    bl_graph_evf                    11    11        0 
    bl_graph_funcgrids              12    12        0 
    bl_graph_funcgrids_detail       13    13        0 
    bl_graph_onebyones              14    14        1 
    bl_graph_pol_lvl                15    15        1 
    bl_graph_pol_pct                16    16        1 
    bl_graph_val                    17    17        1 
    bl_img_save                     18    18        0 
    bl_mat                          19    19        0 
    bl_post                         20    20        1 
    bl_profile                      21    21        0 
    bl_profile_dist                 22    22        0 
    bl_time                         23    23        0 
    it_display_every                24    24        5 
    it_display_final_colmax         25    25       12 
    it_display_final_rowmax         26    26      100 
    it_display_summmat_colmax       27    27        7 
    it_display_summmat_rowmax       28    28        7 

</pre><h2 id="36">Display 2 armt_map</h2><pre class="codeinput">    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: ARMT_MAP
----------------------------------------
  Map with properties:

        Count: 34
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                                      i     idx      rowN         colN         mean        std          min          max  
                                      __    ___    ________    __________    ________    ________    __________    _______

    ar_a_meshk                         1     1          772             1      18.605      22.341           -20     57.258
    ar_a_meshk_ori                     2     2        35000             1     -2.5107      15.618           -20         50
    ar_ak_perc                         3     3            1            50         0.5      0.2975             0          1
    ar_aplusk_mesh                     4     4        35000             1      14.979       20.23           -20         50
    ar_interp_c_grid                   5     5            1    7.7238e+05      38.639      22.297          0.02     77.258
    ar_interp_coh_grid                 6     6            1           772      18.605      22.341           -20     57.258
    ar_k_mesha                         7     7          772             1           0           0             0          0
    ar_k_mesha_ori                     8     8        35000             1      17.489      15.618             0         70
    ar_w_level                         9     9            1           700      14.979      20.244           -20         50
    ar_w_perc                         10    10            1            50         0.5      0.2975             0          1
    ar_z_r_borr                       11    11            1             5        0.06     0.02767         0.025      0.095
    ar_z_r_borr_mesh_wage_r1w2        12    12            1            55        0.06    0.024977         0.025      0.095
    ar_z_r_borr_mesh_wage_w1r2        13    13            1            55        0.06    0.024977         0.025      0.095
    ar_z_r_borr_prob                  14    14            1             5         0.2     0.34803    0.00012164    0.81093
    ar_z_wage                         15    15            1            11      1.1422     0.72828       0.34664     2.5613
    ar_z_wage_mesh_r_borr_r1w2        16    16            1            55      1.1422     0.70079       0.34664     2.5613
    ar_z_wage_mesh_r_borr_w1r2        17    17            1            55      1.1422     0.70079       0.34664     2.5613
    ar_z_wage_prob                    18    18            1            11    0.090909    0.084822     0.0039324    0.23011
    cl_mt_coh_wkb_mesh_z_r_borr       19    19        35000            55      16.785      20.517       -20.056     57.258
    mt_coh_wkb                        20    21          772            55      18.605      22.327           -20     57.258
    mt_coh_wkb_mesh_z_r_borr          21    22     1.75e+05            55      16.507      20.684       -21.456     57.258
    mt_coh_wkb_ori                    22    23     1.75e+05            11      16.507      20.684       -21.456     57.258
    mt_interp_coh_grid_mesh_w_perc    23    24           50           772      18.605      22.327           -20     57.258
    mt_interp_coh_grid_mesh_z         24    25          772            55      18.605      22.327           -20     57.258
    mt_interp_coh_grid_mesh_z_wage    25    26          772            11      18.605      22.328           -20     57.258
    mt_k                              26    27           50           700      17.489      15.618             0         70
    mt_w_perc_mesh_interp_coh_grid    27    28           50           772     -0.6976      17.237           -20     57.258
    mt_z_mesh_coh_wkb                 28    29     1.75e+05            55          28      15.875             1         55
    mt_z_mesh_coh_wkb_seg             29    30        35000            55          28      15.875             1         55
    mt_z_mesh_interp_coh_grid         30    31          772            55          28      15.875             1         55
    mt_z_trans                        31    32           55            55    0.018182    0.055867             0    0.31053
    mt_z_wage_mesh_coh_wkb            32    33     1.75e+05            11      1.1422     0.69439       0.34664     2.5613
    mt_z_wage_mesh_interp_coh_grid    33    34          772            11      1.1422     0.69443       0.34664     2.5613

----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                   i    idx    value
                   _    ___    _____

    it_ameshk_n    1    20      772 

</pre><h2 id="37">Display 3 param_map</h2><pre class="codeinput">    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: PARAM_MAP
----------------------------------------
  Map with properties:

        Count: 41
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 37 ; key = st_analytical_stationary_type ; val = eigenvector
pos = 38 ; key = st_model ; val = ipwkbzr
pos = 39 ; key = st_v_coh_z_interp_method ; val = method_cell
pos = 40 ; key = st_z_r_borr_drv_ele_type ; val = unif
pos = 41 ; key = st_z_r_borr_drv_prb_type ; val = poiss
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                              i     idx     value 
                              __    ___    _______

    bl_default                 1     1           1
    fl_Amean                   2     2           1
    fl_alpha                   3     3        0.36
    fl_b_bd                    4     4         -20
    fl_beta                    5     5        0.94
    fl_c_min                   6     6        0.02
    fl_coh_interp_grid_gap     7     7         0.1
    fl_crra                    8     8         1.5
    fl_default_wprime          9     9           0
    fl_delta                  10    10        0.08
    fl_k_max                  11    11          70
    fl_k_min                  12    12           0
    fl_nan_replace            13    13       -9999
    fl_r_save                 14    14       0.025
    fl_tol_dist               15    15       1e-05
    fl_tol_pol                16    16       1e-05
    fl_tol_val                17    17       1e-05
    fl_w                      18    18     0.44365
    fl_w_interp_grid_gap      19    19         0.1
    fl_w_max                  20    20          50
    fl_w_min                  21    21         -20
    fl_z_r_borr_max           22    22       0.095
    fl_z_r_borr_min           23    23       0.025
    fl_z_r_borr_n             24    24           5
    fl_z_r_borr_poiss_mean    25    25          20
    fl_z_wage_mu              26    26           0
    fl_z_wage_rho             27    27         0.8
    fl_z_wage_sig             28    28         0.2
    it_ak_perc_n              29    29          50
    it_c_interp_grid_gap      30    30      0.0001
    it_maxiter_dist           31    31        1000
    it_maxiter_val            32    32         250
    it_tol_pol_nochange       33    33          25
    it_w_perc_n               34    34          50
    it_z_n                    35    35          55
    it_z_wage_n               36    36          11

</pre><h2 id="38">Display 4 func_map</h2><pre class="codeinput">    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: FUNC_MAP
----------------------------------------
  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 1 ; key = f_coh ; val = @(fl_r_borr,z,b,k)(f_prod(z,k)+k*(1-fl_delta)+fl_w+b.*(1+fl_r_save).*(b&gt;0)+b.*(1+fl_r_borr).*(b&lt;=0))
pos = 2 ; key = f_cons ; val = @(coh,bprime,kprime)(coh-kprime-bprime)
pos = 3 ; key = f_inc ; val = @(fl_r_borr,z,b,k)(f_prod(z,k)-(fl_delta)*k+fl_w+b.*(fl_r_save).*(b&gt;0)+b.*(fl_r_borr).*(b&lt;=0))
pos = 4 ; key = f_prod ; val = @(z,k)((fl_Amean.*(z)).*(k.^(fl_alpha)))
pos = 5 ; key = f_util_crra ; val = @(c)(((c).^(1-fl_crra)-1)./(1-fl_crra))
pos = 6 ; key = f_util_log ; val = @(c)log(c)
pos = 7 ; key = f_util_standin ; val = @(fl_r_borr,z,b,k)f_util_log((f_coh(fl_r_borr,z,b,k)-fl_b_bd).*((f_coh(fl_r_borr,z,b,k)-fl_b_bd)&gt;fl_c_min)+fl_c_min.*((f_coh(fl_r_borr,z,b,k)-fl_b_bd)&lt;=fl_c_min))
pos = 8 ; key = f_util_standin_coh ; val = @(coh,fl_r_borr)f_util_log((coh-fl_b_bd).*((coh&gt;0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+((coh-fl_b_bd)./(1)).*((coh&lt;=0)&amp;(((coh-fl_b_bd)./(1))&gt;fl_c_min))+(fl_c_min./(1+fl_r_borr)).*((((coh-fl_b_bd)./(1))&lt;=fl_c_min)))
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Scalars in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i    idx    xFunction
                          _    ___    _________

    f_coh                 1     1         1    
    f_cons                2     2         2    
    f_inc                 3     3         3    
    f_prod                4     4         4    
    f_util_crra           5     5         5    
    f_util_log            6     6         6    
    f_util_standin        7     7         7    
    f_util_standin_coh    8     8         8    

</pre><h2 id="39">Display 5 result_map</h2><pre class="codeinput">    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);
</pre><pre class="codeoutput">----------------------------------------
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Begin: Show all key and value pairs from container
CONTAINER NAME: RESULT_MAP
----------------------------------------
  Map with properties:

        Count: 15
      KeyType: char
    ValueType: any

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
----------------------------------------
----------------------------------------
pos = 2 ; key = ar_st_pol_names ; val = cl_mt_val cl_mt_coh cl_mt_pol_a cl_mt_pol_k cl_mt_pol_c
----------------------------------------
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Matrix in Container and Sizes and Basic Statistics
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
                          i     idx    rowN    colN      mean        std         min         max  
                          __    ___    ____    ____    ________    _______    __________    ______

    ar_pol_diff_norm       1     1     151       1       99.709     531.21             0    4777.2
    ar_val_diff_norm       2     3     151       1       16.897     50.793    0.00091128    344.08
    cl_mt_coh              3     4     772      55       18.605     22.327           -20    57.258
    cl_mt_cons             4     5     772      55       2.8757     2.9357           -20    7.8835
    cl_mt_pol_a            5     6     772      55       8.7882     19.576           -20    49.154
    cl_mt_pol_c            6     7     772      55       3.1163     1.5811          0.02    7.8835
    cl_mt_pol_k            7     8     772      55       6.9409     5.4654             0    22.186
    cl_mt_val              8     9     772      55       8.6496     6.9578        -9.749    16.595
    mt_pol_idx             9    10     772      55        19319      11146             1     38595
    mt_pol_perc_change    10    11     151      55     0.077753    0.22502             0         1
    mt_val                11    12     772      55       8.6496     6.9578        -9.749    16.595
    tb_pol_a              12    13     100      12       11.498     29.555           -20    49.154
    tb_val                13    14     100      12       4.9279     10.874       -9.6806    16.595
    tb_valpol_alliter     14    15     100      57       3.1666     88.068             0    4777.2

</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 15
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Risky + Safe Asset (Save + Borr + R Shock) Interpolated-Percentage (Optimized-Vectorized)
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository>
% Table of Content.*

%%
function result_map = ff_ipwkbzr_vf_vecsv(varargin)
%% FF_IPWKBZR_VF_VECSV solve infinite horizon exo shock + endo asset problem
% This program solves the infinite horizon dynamic savings and risky
% capital asset problem with some ar1 shock. This is the two step solution
% with interpolation and with percentage asset grids version of
% <https://fanwangecon.github.io/CodeDynaAsset/m_akz/solve/html/ff_iwkz_vf_vecsv.html
% ff_iwkz_vf_vecsv>. See that file for more descriptions.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @return result_map container contains policy function matrix, value
% function matrix, iteration results, and policy function, value function
% and iteration results tables.
%
% keys included in result_map:
%
% * mt_val matrix states_n by shock_n matrix of converged value function grid
% * mt_pol_a matrix states_n by shock_n matrix of converged policy function grid
% * ar_val_diff_norm array if bl_post = true it_iter_last by 1 val function
% difference between iteration
% * ar_pol_diff_norm array if bl_post = true it_iter_last by 1 policy
% function difference between iterations
% * mt_pol_perc_change matrix if bl_post = true it_iter_last by shock_n the
% proportion of grid points at which policy function changed between
% current and last iteration for each element of shock
%
% @example
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ff_ipwkbzr_evf.m ff_ipwkbzr_evf>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_set_default_param.m ffs_ipwkbzr_set_default_param>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_ipwkbzr/paramfunc/ffs_ipwkbzr_get_funcgrid.m ffs_ipwkbzr_get_funcgrid>
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_akz/solvepost/ff_akz_vf_post.m ff_akz_vf_post>
%

%% Default
% * it_param_set = 1: quick test
% * it_param_set = 2: benchmark run
% * it_param_set = 3: benchmark profile
% * it_param_set = 4: press publish button

it_param_set = 4;
[param_map, support_map] = ffs_ipwkbzr_set_default_param(it_param_set);

% parameters can be set inside ffs_ipwkbzr_set_default_param or updated here
% param_map('it_w_perc_n') = 50;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('fl_coh_interp_grid_gap') = 0.025;
% param_map('it_c_interp_grid_gap') = 0.001;
% param_map('fl_w_interp_grid_gap') = 0.25;
% param_map('it_w_perc_n') = 100;
% param_map('it_ak_perc_n') = param_map('it_w_perc_n');
% param_map('fl_z_r_borr_n') = 5;
% param_map('it_z_wage_n') = 15;
% param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');
% param_map('fl_coh_interp_grid_gap') = 0.1;
% param_map('it_c_interp_grid_gap') = 10^-4;
% param_map('fl_w_interp_grid_gap') = 0.1;

st_param_which = 'default';

if (ismember(st_param_which, ['default']))

    % default

elseif (ismember(st_param_which, ['small']))

    param_map('it_w_perc_n') = 20;
    param_map('it_ak_perc_n') = param_map('it_w_perc_n');
    param_map('it_z_wage_n') = 4;
    param_map('fl_z_r_borr_n') = 4;
    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');

elseif ismember(st_param_which, ['ff_ipwkbz_vf_vecsv'])

    % ff_ipwkbzr_evf default
    param_map('fl_z_r_borr_min') = 0.095;
    param_map('fl_z_r_borr_max') = 0.095;
    param_map('fl_z_r_borr_n') = 1;

    param_map('fl_r_save') = 0.025;

    param_map('it_z_n') = param_map('it_z_wage_n') * param_map('fl_z_r_borr_n');

end

% get armt and func map
[armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map); % 1 for override
default_params = {param_map support_map armt_map func_map};

%% Parse Parameters 1

% if varargin only has param_map and support_map,
params_len = length(varargin);
[default_params{1:params_len}] = varargin{:};
param_map = [param_map; default_params{1}];
support_map = [support_map; default_params{2}];
if params_len >= 1 && params_len <= 2
    % If override param_map, re-generate armt and func if they are not
    % provided
    bl_input_override = true;
    [armt_map, func_map] = ffs_ipwkbzr_get_funcgrid(param_map, support_map);
else
    % Override all
    armt_map = [armt_map; default_params{3}];
    func_map = [func_map; default_params{4}];
end

% append function name
st_func_name = 'ff_ipwkbzr_vf_vecsv';
support_map('st_profile_name_main') = [st_func_name support_map('st_profile_name_main')];
support_map('st_mat_name_main') = [st_func_name support_map('st_mat_name_main')];
support_map('st_img_name_main') = [st_func_name support_map('st_img_name_main')];

%% Parse Parameters 2, Asset Arrays
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid
%
% # ar_interp_c_grid: 1 by I^c, 1st stage consumption interpolation
% # ar_interp_coh_grid: 1 by I^{coh}, 1st stage value function V(coh,z)
% # ar_w_perc: 1 by P^{W=k+b}, 1st stage w \in {w_perc(coh)} choice set
% # ar_w_level: 1 by I^{W=k+b}, 2nd stage k*(w,z) w grid
% # ar_ak_perc: 1 by P^{k and b}, 2nd stage k \in {ask_perc(w,z)} set
%

params_group = values(armt_map, {...
    'ar_interp_c_grid', 'ar_interp_coh_grid', ...
    'ar_w_perc', 'ar_w_level', 'ar_ak_perc'});
[ar_interp_c_grid, ar_interp_coh_grid, ...
    ar_w_perc, ar_w_level, ar_ak_perc] = params_group{:};

%% Parse Parameters 2, interp_coh related matrixes
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_interp_coh_grid_mesh_z_wage: I^{coh} by M^w
% # mt_z_wage_mesh_interp_coh_grid: I^{coh} by M^w
% # mt_interp_coh_grid_mesh_w_perc: I^{coh} by P^{LAM=k+b}
% # mt_w_perc_mesh_interp_coh_grid: I^{coh} by P^{LAM=k+b}
%

params_group = values(armt_map, {...
    'mt_interp_coh_grid_mesh_z_wage', ...
    'mt_interp_coh_grid_mesh_w_perc', ...
    'mt_z_wage_mesh_interp_coh_grid', ...
    'mt_w_perc_mesh_interp_coh_grid', ...
    'mt_interp_coh_grid_mesh_z', 'mt_z_mesh_interp_coh_grid', ...
    'cl_mt_coh_wkb_mesh_z_r_borr', 'mt_z_mesh_coh_wkb_seg'});
[mt_interp_coh_grid_mesh_z_wage, ...
    mt_interp_coh_grid_mesh_w_perc, ...
    mt_z_wage_mesh_interp_coh_grid, ...
    mt_w_perc_mesh_interp_coh_grid, ...
    mt_interp_coh_grid_mesh_z, mt_z_mesh_interp_coh_grid, ...
    cl_mt_coh_wkb_mesh_z_r_borr, mt_z_mesh_coh_wkb_seg] = params_group{:};

%% Parse Parameters 3, reachable cash-on-hand
% Dimensions of Various Grids: I for level grid, M for shock grid, P for
% percent grid. These are grids for 1st stage solution
%
% # mt_coh_wkb: (I^k x I^w x M^r) by (M^z)
% # mt_z_wage_mesh_coh_wkb: (I^k x I^w x M^r) by (M^z)
%

params_group = values(armt_map, {...
    'mt_coh_wkb', 'mt_coh_wkb_mesh_z_r_borr', 'mt_z_mesh_coh_wkb', 'mt_z_wage_mesh_coh_wkb'});
[mt_coh_wkb, mt_coh_wkb_mesh_z_r_borr, mt_z_mesh_coh_wkb, mt_z_wage_mesh_coh_wkb] = params_group{:};

%% Parse Parameters 4, other asset arrays

params_group = values(armt_map, {'ar_a_meshk', 'ar_k_mesha'});
[ar_a_meshk, ar_k_mesha] = params_group{:};

%% Parse Parameters 5, Others

% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_cons'});
[f_util_log, f_util_crra, f_cons] = params_group{:};

% param_map
params_group = values(param_map, {'fl_crra', 'fl_beta', ...
    'fl_nan_replace', 'fl_c_min', 'bl_default', 'fl_default_wprime'});
[fl_crra, fl_beta, fl_nan_replace, fl_c_min, bl_default, fl_default_wprime] = params_group{:};
params_group = values(param_map, {'it_maxiter_val', 'fl_tol_val', 'fl_tol_pol', 'it_tol_pol_nochange'});
[it_maxiter_val, fl_tol_val, fl_tol_pol, it_tol_pol_nochange] = params_group{:};
params_group = values(param_map, {'it_z_n', 'fl_z_r_borr_n', 'it_z_wage_n'});
[it_z_n, fl_z_r_borr_n, it_z_wage_n] = params_group{:};
params_group = values(param_map, {'st_v_coh_z_interp_method'});
[st_v_coh_z_interp_method] = params_group{:};

% support_map
params_group = values(support_map, {'bl_profile', 'st_profile_path', ...
    'st_profile_prefix', 'st_profile_name_main', 'st_profile_suffix',...
    'bl_time', 'bl_display_defparam', 'bl_graph_evf', 'bl_display', 'it_display_every', 'bl_post'});
[bl_profile, st_profile_path, ...
    st_profile_prefix, st_profile_name_main, st_profile_suffix, ...
    bl_time, bl_display_defparam, bl_graph_evf, bl_display, it_display_every, bl_post] = params_group{:};
params_group = values(support_map, {'it_display_summmat_rowmax', 'it_display_summmat_colmax'});
[it_display_summmat_rowmax, it_display_summmat_colmax] = params_group{:};

%% Initialize Output Matrixes

mt_val_cur = zeros(length(ar_interp_coh_grid),it_z_n);
mt_val = mt_val_cur - 1;
mt_pol_a = zeros(length(ar_interp_coh_grid),it_z_n);
mt_pol_a_cur = mt_pol_a - 1;
mt_pol_k = zeros(length(ar_interp_coh_grid),it_z_n);
mt_pol_k_cur = mt_pol_k - 1;
mt_pol_idx = zeros(length(ar_interp_coh_grid),it_z_n);

% We did not need these in ff_oz_vf or ff_oz_vf_vec
% see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why store using cells.
cl_u_c_store = cell([it_z_n, 1]);
cl_c_valid_idx = cell([it_z_n, 1]);
cl_w_kstar_interp_z = cell([it_z_n, 1]);
for it_z_i = 1:it_z_n
    cl_w_kstar_interp_z{it_z_i} = zeros([length(ar_w_perc), length(ar_interp_coh_grid)]) - 1;
end

clmt_val_wkb_interpolated = cell([fl_z_r_borr_n, 1]);

%% Initialize Convergence Conditions

bl_vfi_continue = true;
it_iter = 0;
ar_val_diff_norm = zeros([it_maxiter_val, 1]);
ar_pol_diff_norm = zeros([it_maxiter_val, 1]);
mt_pol_perc_change = zeros([it_maxiter_val, it_z_n]);

%% Pre-calculate u(c)
% Interpolation, see
% <https://fanwangecon.github.io/M4Econ/support/speed/partupdate/fs_u_c_partrepeat_main.html
% fs_u_c_partrepeat_main> for why interpolate over u(c)

% Evaluate
if (fl_crra == 1)
    ar_interp_u_of_c_grid = f_util_log(ar_interp_c_grid);
    fl_u_cmin = f_util_log(fl_c_min);
else
    ar_interp_u_of_c_grid = f_util_crra(ar_interp_c_grid);
    fl_u_cmin = f_util_crra(fl_c_min);
end
ar_interp_u_of_c_grid(ar_interp_c_grid <= fl_c_min) = fl_u_cmin;

% Get Interpolant
f_grid_interpolant_spln = griddedInterpolant(ar_interp_c_grid, ar_interp_u_of_c_grid, 'spline', 'nearest');

%% Iterate Value Function
% Loop solution with 4 nested loops
%
% # loop 1: over exogenous states
% # loop 2: over endogenous states
% # loop 3: over choices
% # loop 4: add future utility, integrationREPLACE_WITH_DASH_DASHloop over future shocks
%

% Start Profile
if (bl_profile)
    close all;
    profile off;
    profile on;
end

% Start Timer
if (bl_time)
    tic;
end

% Value Function Iteration
while bl_vfi_continue
    it_iter = it_iter + 1;

    %% Interpolate V(coh, Z) 1: Splinterp2
    % Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)

    if (strcmp(st_v_coh_z_interp_method, 'method_idx_a'))
        for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = ...
                splinterp2(mt_val_cur,mt_z_mesh_coh_wkb_seg,cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        end
    end

    %% Interpolate V(coh, Z) 2: griddedInterpolant(V)
    % Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)

    if (strcmp(st_v_coh_z_interp_method, 'method_idx_b'))
        % Generate Interpolant for v(coh,z)
        % mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)
        f_grid_interpolant_value = griddedInterpolant(mt_val_cur', 'linear', 'nearest');
        for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n
            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = ...
                f_grid_interpolant_value(mt_z_mesh_coh_wkb_seg,...
                                         cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        end
    end

    %% Interpolate V(coh, Z) 3: Store in Cell
    % Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)

    if (strcmp(st_v_coh_z_interp_method, 'method_cell'))
        f_grid_interpolant_value = griddedInterpolant(...
            mt_z_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z', ...
            mt_val_cur', 'linear', 'nearest');

        for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n

            clmt_val_wkb_interpolated{it_z_r_borr_ctr} = ...
                f_grid_interpolant_value(mt_z_mesh_coh_wkb_seg,...
                                         cl_mt_coh_wkb_mesh_z_r_borr{it_z_r_borr_ctr});
        end
    end


    %% Interpolate V(coh, Z) 4: Single Call Full Matrix
    % Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)

    if (strcmp(st_v_coh_z_interp_method, 'method_matrix'))
        % Generate Interpolant for v(coh,z)
        % mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)
        f_grid_interpolant_value = griddedInterpolant(...
            mt_z_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z', ...
            mt_val_cur', 'linear', 'nearest');

        % Interpolate V(coh(k',b',z',r),z',r') for a specific r'
        % mt_z_wage_mesh_coh_wkb and mt_coh_wkb are: (I^k x I^w x M^r) by (M^z)
        clmt_val_wkb_interpolated = f_grid_interpolant_value(mt_z_mesh_coh_wkb, mt_coh_wkb_mesh_z_r_borr);
    end

    %% Interpolate V(coh, Z) 5: Matrix Store
    % Interpolate reacahble V(coh(k'(w),b'(w),zr,zw'),zw',zr')) given v(coh, z)

    if (strcmp(st_v_coh_z_interp_method, 'method_mat_seg'))

        % 1. Number of W/B/K Choice Combinations
        it_ak_perc_n = length(ar_ak_perc);
        it_w_interp_n = length(ar_w_level);
        it_wak_n = it_w_interp_n*it_ak_perc_n;

        % 2. Initialize V(coh(k'(w),b'(w),zr,zw'),zw',zr'))
        % mt_val_wkb_interpolated is: (I^k x I^w x M^r) by (M^z x M^r)
        % reachable cash-on-hand (as rows) and shocks next period given choices
        % and shocks next period.
        clmt_val_wkb_interpolated = zeros([it_wak_n*fl_z_r_borr_n, it_z_n]);

        % 3. Loop over possible shocks over interest rate
        for it_z_r_borr_ctr = 1:1:fl_z_r_borr_n

            % 4. Interpolate V(coh(k',b',z',r),z',r') for a specific r'
            % v(coh,z) solved on ar_interp_coh_grid, ar_z grids, see
            % ffs_ipwkbzr_get_funcgrid.m. Generate interpolant based on that, Then
            % interpolate for the coh reachable levels given the k(w,z) percentage
            % choice grids in the second stage of the problem.
            %
            % Note mt_val_cur/mt_val dimension is based on interpolant
            % cash-on-hand for rows, and meshed shocks for columns. The meshed
            % shock structure, see
            % <https://fanwangecon.github.io/CodeDynaAsset/m_ipwkbzr/paramfunc/html/ffs_ipwkbzr_get_funcgrid.html
            % ffs_ipwkbzr_get_funcgrid> for details on how the shock grids are
            % formed.

            % Get current z_r_borr from mt_val
            it_mt_val_col_start = it_z_wage_n*(it_z_r_borr_ctr-1) + 1;
            it_mt_val_col_end   = it_mt_val_col_start + it_z_wage_n - 1;
            mt_val_cur_rcolseg =  mt_val_cur(:, it_mt_val_col_start:it_mt_val_col_end);

            % Generate Interpolant for v(coh,z)
            % mt_z_wage_mesh_interp_coh_grid is: (I^{coh_interp}) by (M^z)
            f_grid_interpolant_value = griddedInterpolant(...
                mt_z_wage_mesh_interp_coh_grid', mt_interp_coh_grid_mesh_z_wage', ...
                mt_val_cur_rcolseg', 'linear', 'nearest');

            % Interpolate V(coh(k',b',z',r),z',r') for a specific r'
            % mt_z_wage_mesh_coh_wkb and mt_coh_wkb are: (I^k x I^w x M^r) by (M^z)
            mt_val_wkb_interpolated_seg = f_grid_interpolant_value(mt_z_wage_mesh_coh_wkb, mt_coh_wkb);
            clmt_val_wkb_interpolated(:, it_mt_val_col_start:it_mt_val_col_end) = mt_val_wkb_interpolated_seg;

        end
    end

    %% Solve Second Stage Problem k*(w,z)
    % This is the key difference between this function and
    % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
    % ffs_akz_set_functions> which solves the two stages jointly
    % Interpolation first, because solution coh grid is not the same as all
    % points reachable by k and b choices given w.
    support_map('bl_graph_evf') = false;
    if (it_iter == (it_maxiter_val + 1))
        support_map('bl_graph_evf') = bl_graph_evf;
    end
    bl_input_override = true;
    [mt_ev_condi_z_max, ~, mt_ev_condi_z_max_kp, ~] = ...
        ff_ipwkbzr_evf(clmt_val_wkb_interpolated, param_map, support_map, armt_map, bl_input_override);

    %% Solve First Stage Problem w*(z) given k*(w,z)

    % loop 1: over exogenous states
    for it_z_i = 1:it_z_n

        %% A. Interpolate FULL to get k*(w_perc, z), b*(k,w) based on k*(w_level, z)
        % Generate interpolant for (2) k*(ar_w_perc) from k*(ar_w_level,z)
        % There are two w=k'+b' arrays. ar_w_level is the level even grid based
        % on which we solve the 2nd stage problem in ff_ipwkbzr_evf.m. Here for
        % each coh level, we have a different vector of w levels, but the same
        % vector of percentage ws. So we need to interpolate to get the optimal
        % k* and b* choices at each percentage level of w.
        f_interpolante_w_level_kstar_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max_kp(:, it_z_i)', 'linear', 'nearest');

        % Interpolate (2), shift from w_level to w_perc
        mt_w_kstar_interp_z = f_interpolante_w_level_kstar_z(mt_w_perc_mesh_interp_coh_grid);
        mt_w_astar_interp_z = mt_w_perc_mesh_interp_coh_grid - mt_w_kstar_interp_z;

        % changes in w_perc kstar choices
        mt_w_kstar_diff_idx = (cl_w_kstar_interp_z{it_z_i} ~= mt_w_kstar_interp_z);

        %% B. Calculate UPDATE u(c): u(c(coh_level, w_perc)) given k*_interp, b*_interp
        % Note that compared to
        % <https://fanwangecon.github.io/CodeDynaAsset/m_akz/paramfunc/html/ffs_akz_set_functions.html
        % ffs_akz_set_functions> the mt_c here is much smaller the same
        % number of columns (states) as in the ffs_akz_set_functions file,
        % but the number of rows equal to ar_w length.
        ar_c = f_cons(mt_interp_coh_grid_mesh_w_perc(mt_w_kstar_diff_idx), ...
            mt_w_astar_interp_z(mt_w_kstar_diff_idx), ...
            mt_w_kstar_interp_z(mt_w_kstar_diff_idx));

        ar_it_c_valid_idx = (ar_c <= fl_c_min);
        % EVAL current utility: N by N, f_util defined earlier
        ar_utility_update = f_grid_interpolant_spln(ar_c);

        % Update Storage
        if (it_iter == 1)
            cl_u_c_store{it_z_i} = reshape(ar_utility_update, [length(ar_w_perc), length(ar_interp_coh_grid)]);
            cl_c_valid_idx{it_z_i} = reshape(ar_it_c_valid_idx, [length(ar_w_perc), length(ar_interp_coh_grid)]);
        else
            cl_u_c_store{it_z_i}(mt_w_kstar_diff_idx) = ar_utility_update;
            cl_c_valid_idx{it_z_i}(mt_w_kstar_diff_idx) = ar_it_c_valid_idx;
        end
        cl_w_kstar_interp_z{it_z_i} = mt_w_kstar_interp_z;

        %% C. Interpolate FULL EV(k*(coh_level, w_perc, z), w - b*|z) based on EV(k*(w_level, z))
        % Generate Interpolant for (3) EV(k*(ar_w_perc),Z)
        f_interpolante_ev_condi_z_max_z = griddedInterpolant(ar_w_level, mt_ev_condi_z_max(:, it_z_i)', 'linear', 'nearest');
        % Interpolate (3), EVAL add on future utility, N by N + N by N
        mt_ev_condi_z_max_interp_z = f_interpolante_ev_condi_z_max_z(mt_w_perc_mesh_interp_coh_grid);

        %% D. Compute FULL U(coh_level, w_perc, z) over all w_perc
        mt_utility = cl_u_c_store{it_z_i} + fl_beta*mt_ev_condi_z_max_interp_z;

        % Index update
        % using the method below is much faster than index replace
        % see <https://fanwangecon.github.io/M4Econ/support/speed/index/fs_subscript.html fs_subscript>
        mt_it_c_valid_idx = cl_c_valid_idx{it_z_i};
        % Default or Not Utility Handling
        if (bl_default)
            % if default: only today u(cmin), transition out next period, debt wiped out
            fl_v_default = fl_u_cmin + fl_beta*f_interpolante_ev_condi_z_max_z(fl_default_wprime);
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_v_default*(mt_it_c_valid_idx);
        else
            % if default is not allowed: v = u(cmin)
            mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_nan_replace*(mt_it_c_valid_idx);
        end

        % percentage algorithm does not have invalid (check to make sure
        % min percent is not 0 in ffs_ipwkbzr_get_funcgrid.m)
        % mt_utility = mt_utility.*(~mt_it_c_valid_idx) + fl_u_neg_c*(mt_it_c_valid_idx);

        %% E. Optimize Over Choices: max_{w_perc} U(coh_level, w_perc, z)
        % Optimization: remember matlab is column major, rows must be
        % choices, columns must be states
        % <https://en.wikipedia.org/wiki/Row-_and_column-major_order COLUMN-MAJOR>
        [ar_opti_val_z, ar_opti_idx_z] = max(mt_utility);

        % Generate Linear Opti Index
        [it_choies_n, it_states_n] = size(mt_utility);
        ar_add_grid = linspace(0, it_choies_n*(it_states_n-1), it_states_n);
        ar_opti_linear_idx_z = ar_opti_idx_z + ar_add_grid;

        ar_opti_aprime_z = mt_w_astar_interp_z(ar_opti_linear_idx_z);
        ar_opti_kprime_z = mt_w_kstar_interp_z(ar_opti_linear_idx_z);
        ar_opti_c_z = f_cons(ar_interp_coh_grid, ar_opti_aprime_z, ar_opti_kprime_z);

        % Handle Default is optimal or not
        if (bl_default)
            % if defaulting is optimal choice, at these states, not required
            % to default, non-default possible, but default could be optimal
            fl_default_opti_kprime = f_interpolante_w_level_kstar_z(fl_default_wprime);
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = fl_default_wprime - fl_default_opti_kprime;
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = fl_default_opti_kprime;
        else
            % if default is not allowed, then next period same state as now
            % this is absorbing state, this is the limiting case, single
            % state space point, lowest a and lowest shock has this.
            ar_opti_aprime_z(ar_opti_c_z <= fl_c_min) = min(ar_a_meshk);
            ar_opti_kprime_z(ar_opti_c_z <= fl_c_min) = min(ar_k_mesha);
        end

        %% F. Store Results
        mt_val(:,it_z_i) = ar_opti_val_z;
        mt_pol_a(:,it_z_i) = ar_opti_aprime_z;
        mt_pol_k(:,it_z_i) = ar_opti_kprime_z;
        if (it_iter == (it_maxiter_val + 1))
            mt_pol_idx(:,it_z_i) = ar_opti_linear_idx_z;
        end

    end

    %% Check Tolerance and Continuation

    % Difference across iterations
    ar_val_diff_norm(it_iter) = norm(mt_val - mt_val_cur);
    ar_pol_diff_norm(it_iter) = norm(mt_pol_a - mt_pol_a_cur) + norm(mt_pol_k - mt_pol_k_cur);
    ar_pol_a_perc_change = sum((mt_pol_a ~= mt_pol_a_cur))/(length(ar_interp_coh_grid));
    ar_pol_k_perc_change = sum((mt_pol_k ~= mt_pol_k_cur))/(length(ar_interp_coh_grid));
    mt_pol_perc_change(it_iter, :) = mean([ar_pol_a_perc_change;ar_pol_k_perc_change]);

    % Update
    mt_val_cur = mt_val;
    mt_pol_a_cur = mt_pol_a;
    mt_pol_k_cur = mt_pol_k;

    % Print Iteration Results
    if (bl_display && (rem(it_iter, it_display_every)==0))
        fprintf('VAL it_iter:%d, fl_diff:%d, fl_diff_pol:%d\n', ...
            it_iter, ar_val_diff_norm(it_iter), ar_pol_diff_norm(it_iter));
        tb_valpol_iter = array2table([mean(mt_val_cur,1);...
            mean(mt_pol_a_cur,1); ...
            mean(mt_pol_k_cur,1); ...
            mt_val_cur(length(ar_interp_coh_grid),:); ...
            mt_pol_a_cur(length(ar_interp_coh_grid),:); ...
            mt_pol_k_cur(length(ar_interp_coh_grid),:)]);
        tb_valpol_iter.Properties.VariableNames = strcat('z', string((1:size(mt_val_cur,2))));
        tb_valpol_iter.Properties.RowNames = {'mval', 'map', 'mak', 'Hval', 'Hap', 'Hak'};
        disp('mval = mean(mt_val_cur,1), average value over a')
        disp('map  = mean(mt_pol_a_cur,1), average choice over a')
        disp('mkp  = mean(mt_pol_k_cur,1), average choice over k')
        disp('Hval = mt_val_cur(it_ameshk_n,:), highest a state val')
        disp('Hap = mt_pol_a_cur(it_ameshk_n,:), highest a state choice')
        disp('mak = mt_pol_k_cur(it_ameshk_n,:), highest k state choice')
        disp(tb_valpol_iter);
    end

    % Continuation Conditions:
    % 1. if value function convergence criteria reached
    % 2. if policy function variation over iterations is less than
    % threshold
    if (it_iter == (it_maxiter_val + 1))
        bl_vfi_continue = false;
    elseif ((it_iter == it_maxiter_val) || ...
            (ar_val_diff_norm(it_iter) < fl_tol_val) || ...
            (sum(ar_pol_diff_norm(max(1, it_iter-it_tol_pol_nochange):it_iter)) < fl_tol_pol))
        % Fix to max, run again to save results if needed
        it_iter_last = it_iter;
        it_iter = it_maxiter_val;
    end

end

% End Timer
if (bl_time)
    toc;
end

% End Profile
if (bl_profile)
    profile off
    profile viewer
    st_file_name = [st_profile_prefix st_profile_name_main st_profile_suffix];
    profsave(profile('info'), strcat(st_profile_path, st_file_name));
end

%% Process Optimal Choices

result_map = containers.Map('KeyType','char', 'ValueType','any');
result_map('mt_val') = mt_val;
result_map('mt_pol_idx') = mt_pol_idx;

result_map('cl_mt_coh') = {mt_interp_coh_grid_mesh_z, zeros(1)};
result_map('cl_mt_pol_a') = {mt_pol_a, zeros(1)};
result_map('cl_mt_pol_k') = {mt_pol_k, zeros(1)};
mt_pol_c = f_cons(mt_interp_coh_grid_mesh_z, mt_pol_a, mt_pol_k);
mt_pol_c(mt_pol_c <= fl_c_min) = fl_c_min;
result_map('cl_mt_pol_c') = {mt_pol_c, zeros(1)};
result_map('cl_mt_val') = {mt_val, zeros(1)};
result_map('ar_st_pol_names') = ["cl_mt_val", "cl_mt_coh", "cl_mt_pol_a", "cl_mt_pol_k", "cl_mt_pol_c"];

if (bl_post)
    bl_input_override = true;
    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);

    armt_map('mt_coh_wkb_ori') = mt_coh_wkb;
    armt_map('ar_a_meshk_ori') = ar_a_meshk;
    armt_map('ar_k_mesha_ori') = ar_k_mesha;

    % graphing based on coh_wkb, but that does not match optimal choice
    % matrixes for graphs.
    armt_map('mt_coh_wkb') = mt_interp_coh_grid_mesh_z;
    armt_map('it_ameshk_n') = length(ar_interp_coh_grid);
    armt_map('ar_a_meshk') = mt_interp_coh_grid_mesh_z(:,1);
    armt_map('ar_k_mesha') = zeros(size(mt_interp_coh_grid_mesh_z(:,1)) + 0);

    result_map = ff_akz_vf_post(param_map, support_map, armt_map, func_map, result_map, bl_input_override);
end

%% Display Various Containers

if (bl_display_defparam)

    %% Display 1 support_map
    fft_container_map_display(support_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 2 armt_map
    fft_container_map_display(armt_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 3 param_map
    fft_container_map_display(param_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 4 func_map
    fft_container_map_display(func_map, it_display_summmat_rowmax, it_display_summmat_colmax);

    %% Display 5 result_map
    fft_container_map_display(result_map, it_display_summmat_rowmax, it_display_summmat_colmax);

end

end

##### SOURCE END #####
--></body></html>