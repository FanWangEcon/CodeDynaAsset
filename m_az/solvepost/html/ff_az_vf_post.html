
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_az_vf_post</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-05-28"><meta name="DC.source" content="ff_az_vf_post.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#2">FF_AZ_VF_POST post ff_az_vf graphs, tables, mats.</a></li><li><a href="#3">Default</a></li><li><a href="#4">Parse Parameter</a></li><li><a href="#5">Generate Consumption and Income Matrix</a></li><li><a href="#6">Save Mat</a></li><li><a href="#7">Display Val Pol Iter Table</a></li><li><a href="#8">Generate and Save Graphs</a></li></ul></div><p><b>back to <a href="https://fanwangecon.github.io">Fan</a>'s <a href="https://fanwangecon.github.io/CodeDynaAsset/">Dynamic Assets Repository</a> Table of Content.</b></p><pre class="codeinput"><span class="keyword">function</span> [result_map] = ff_az_vf_post(varargin)
</pre><h2 id="2">FF_AZ_VF_POST post ff_az_vf graphs, tables, mats.</h2><p>Given the solution form ff_az_vf, graphs, tables, mats. Graphing code is separately in ff_az_vf_post_graph.m. Run this function directly with randomly generates matrixes for graph/table testings.</p><p>@param param_map container parameter container</p><p>@param support_map container support container</p><p>@param armt_map container container with states, choices and shocks grids that are inputs for grid based solution algorithm</p><p>@param func_map container container with function handles for consumption cash-on-hand etc.</p><p>@param result_map container contains policy function matrix, value function matrix, iteration results</p><p>@return result_map container add coh consumption and other matrixes to result_map also add table versions of val pol and iter matries</p><p>@example</p><pre>  bl_input_override = true;
  result_map = containers.Map('KeyType','char', 'ValueType','any');
  result_map('mt_val') = mt_val;
  result_map('mt_pol_a') = mt_pol_a;
  result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
  result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
  result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
  result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);</pre><p>@include</p><div><ul><li><a href="https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_az/solvepost/ff_az_vf_post_graph.m">ff_az_vf_post_graph</a></li></ul></div><h2 id="3">Default</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 6)
    bl_input_override = varargin{6};
<span class="keyword">end</span>

<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% if invoked from outside overrid fully</span>
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};

    params_group = values(result_map, {<span class="string">'mt_val'</span>, <span class="string">'mt_pol_a'</span>});
    [mt_val, mt_pol_a] = params_group{:};
    params_group = values(result_map, {<span class="string">'ar_val_diff_norm'</span>, <span class="string">'ar_pol_diff_norm'</span>, <span class="string">'mt_pol_perc_change'</span>});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};

    <span class="comment">% Get Parameters</span>
    params_group = values(param_map, {<span class="string">'it_z_n'</span>, <span class="string">'it_a_n'</span>});
    [it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'ar_z'</span>});
    [ar_a, ar_z] = params_group{:};

<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% internal invoke for testing</span>
    it_param_set = 4;
    bl_input_override = true;

    <span class="comment">% Get Parameters</span>
    [param_map, support_map] = ffs_az_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_az_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generate Default val and policy matrixes</span>
    params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'it_z_n'</span>, <span class="string">'it_a_n'</span>});
    [it_maxiter_val, it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'ar_z'</span>});
    [ar_a, ar_z] = params_group{:};
    f_util_standin = func_map(<span class="string">'f_util_standin'</span>);

    <span class="comment">% Set Defaults</span>
    mt_val = f_util_standin(ar_z, ar_a');
    mt_pol_a = zeros(size(mt_val)) + ar_a'*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);

    <span class="comment">% Set Results Map</span>
    result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
    result_map(<span class="string">'mt_val'</span>) = mt_val;
    result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
<span class="keyword">end</span>
</pre><h2 id="4">Parse Parameter</h2><pre class="codeinput"><span class="comment">% support_map</span>
params_group = values(support_map, {<span class="string">'bl_display_final'</span>, <span class="string">'it_display_final_rowmax'</span>, <span class="string">'it_display_final_colmax'</span>});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph'</span>, <span class="string">'bl_graph_onebyones'</span>});
[bl_graph] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_mat'</span>, <span class="string">'st_mat_path'</span>, <span class="string">'st_mat_prefix'</span>, <span class="string">'st_mat_name_main'</span>, <span class="string">'st_mat_suffix'</span>});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_inc'</span>, <span class="string">'f_cons'</span>, <span class="string">'f_coh'</span>});
[f_inc, f_cons, f_coh] = params_group{:};
</pre><h2 id="5">Generate Consumption and Income Matrix</h2><pre class="codeinput">mt_cons = f_cons(ar_z, ar_a', mt_pol_a);
mt_incm = f_inc(ar_z, ar_a');
mt_coh = f_coh(ar_z, ar_a');
result_map(<span class="string">'mt_cons'</span>) = mt_cons;
result_map(<span class="string">'mt_incm'</span>) = mt_incm;
result_map(<span class="string">'mt_coh'</span>) = mt_coh;
</pre><h2 id="6">Save Mat</h2><pre class="codeinput"><span class="keyword">if</span> (bl_mat)
    mkdir(support_map(<span class="string">'st_mat_path'</span>));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
</pre><h2 id="7">Display Val Pol Iter Table</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_final)

    <span class="comment">% Display Value Function Iteration Step by Step REsults</span>
    it_iter_max = length(ar_val_diff_norm);
    <span class="keyword">if</span> (it_iter_max &gt;= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];
    <span class="keyword">else</span>
        ar_it_rows_iter = 1:1:it_iter_max;
    <span class="keyword">end</span>
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     ar_pol_diff_norm(ar_it_rows_iter)';<span class="keyword">...</span>
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');

    cl_col_names = [<span class="string">'valgap'</span>, <span class="string">'polgap'</span>, strcat(<span class="string">'z'</span>, string((1:it_z_n)))];
    cl_row_names = strcat(<span class="string">'iter='</span>, string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'valgap'</span>} = <span class="string">'norm(mt_val - mt_val_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'polgap'</span>} = <span class="string">'norm(mt_pol_a - mt_pol_a_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'z1'</span>} = <span class="string">'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)'</span>;

    disp(<span class="string">'valgap = norm(mt_val - mt_val_cur)'</span>);
    disp(<span class="string">'polgap = norm(mt_pol_a - mt_pol_a_cur)'</span>);
    disp(<span class="string">'z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)'</span>);
    disp(tb_valpol_alliter);

    <span class="comment">% Display Values by States</span>
    <span class="comment">% at most display 11 columns of shocks</span>
    <span class="comment">% at most display 50 rows for states</span>
    <span class="comment">% display first and last</span>
    <span class="keyword">if</span> (it_a_n &gt;= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_a_n)-round(it_display_final_rowmax/2)+1):1:(it_a_n)];
    <span class="keyword">else</span>
        ar_it_rows = 1:1:it_a_n;
    <span class="keyword">end</span>
    <span class="keyword">if</span> (it_z_n &gt;= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    <span class="keyword">else</span>
        ar_it_cols = 1:1:it_z_n;
    <span class="keyword">end</span>
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);

    <span class="comment">% Display Optimal Values</span>
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat(<span class="string">'a'</span>, string(ar_it_rows), <span class="string">'='</span>, string(ar_a(ar_it_rows)));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_val'</span>);
    disp(tb_val);

    <span class="comment">% Display Optimal Choices</span>
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat(<span class="string">'a'</span>, string(ar_it_rows), <span class="string">'='</span>, string(ar_a(ar_it_rows)));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z'</span>, string(ar_it_cols), <span class="string">'='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_pol_a'</span>);
    disp(tb_pol_a);

    <span class="comment">% Save to result map</span>
    result_map(<span class="string">'tb_valpol_alliter'</span>) = tb_valpol_alliter;
    result_map(<span class="string">'tb_val'</span>) = tb_val;
    result_map(<span class="string">'tb_pol_a'</span>) = tb_pol_a;
<span class="keyword">end</span>
</pre><pre class="codeoutput">valgap = norm(mt_val - mt_val_cur)
polgap = norm(mt_pol_a - mt_pol_a_cur)
z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
                 valgap       polgap        z1           z2          z3           z4          z5          z6           z7           z8         z9         z10          z11    
               __________    ________    _________    ________    _________    ________    ________    _________    _________    ________    _______    ________    __________

    iter=1        0.14481    0.087146      0.13942     0.43343         0.39     0.73157     0.28145      0.81716      0.58178      0.2699    0.27321     0.29557       0.73774
    iter=2        0.40102     0.56742      0.74641     0.12968      0.98253     0.97356     0.67873     0.076544      0.69232     0.83079    0.47354      0.6181      0.055588
    iter=3        0.53205     0.26614       0.6206     0.57025      0.97958     0.79141     0.62686      0.86531      0.14356     0.99726    0.96054     0.18248       0.51449
    iter=4        0.10095    0.032025      0.90776     0.12784      0.30746     0.46016     0.70895      0.18137        0.348     0.39538    0.10176     0.21215       0.11878
    iter=5        0.58078     0.64009      0.71788     0.21793      0.93188     0.76492     0.61537      0.83467      0.62339     0.89964    0.54064     0.80635       0.64265
    iter=6        0.10449      0.6009      0.11755     0.46776      0.79949      0.9721     0.44957      0.84104      0.85898     0.53084    0.30753     0.10872       0.16266
    iter=7        0.59587     0.19107      0.87068     0.48974      0.93741     0.25603     0.72749      0.50862      0.47157    0.082251    0.15165     0.67731      0.061672
    iter=8        0.47811     0.68791     0.065958     0.19345      0.61928     0.91574     0.98481      0.52002      0.69072     0.41855    0.42262     0.19488        0.5585
    iter=9        0.81629     0.31048    0.0013468     0.12013      0.36781     0.33459     0.53448       0.3669     0.093759    0.018904    0.32421     0.37179       0.14438
    iter=10        0.5737      0.4265      0.30667     0.67558       0.4093     0.18145     0.77988       0.9236     0.057598     0.90152    0.55641     0.53972       0.36828
    iter=11       0.21062     0.38152      0.39632     0.99016      0.71957     0.43434     0.99153      0.70023       0.8252     0.37496    0.18444     0.25114       0.20119
    iter=12       0.43105     0.62468      0.28592     0.65719      0.63328     0.76057     0.63659      0.99073      0.09079    0.011844     0.2149     0.71915    0.00018024
    iter=13       0.43279     0.78455      0.64905     0.22641      0.57363     0.91636     0.27327      0.96897      0.20638     0.50115    0.56526     0.32116          0.81
    iter=14       0.87123     0.59463      0.26023     0.82799      0.81443     0.50179     0.60308     0.092728      0.79324     0.44338    0.90865    0.037639       0.90307
    iter=15         0.747     0.65158      0.98604     0.37267      0.14637     0.37472     0.63604       0.3706      0.68173     0.85244     0.6999     0.81186       0.44065
    iter=16       0.39664     0.58943      0.67291     0.69747      0.26638     0.77158     0.91109      0.53016      0.46999     0.50086    0.88546     0.04531       0.36583
    iter=17       0.16646     0.15915      0.66725     0.64495      0.37448     0.18976     0.61564     0.080593      0.89777      0.1122    0.74319     0.29752       0.36481
    iter=18       0.54183    0.042133      0.78936    0.025331      0.10306     0.47699     0.94366      0.70431      0.40853      0.7914    0.44468     0.30392       0.28787
    iter=19      0.020255     0.13702     0.069405     0.29773      0.73937     0.58116     0.25573      0.34697      0.65855     0.93483     0.1186     0.53639       0.83509
    iter=20       0.12034     0.28267      0.24325     0.90562      0.32602     0.85736     0.19821      0.11229      0.95842     0.85589    0.93927      0.1202       0.97588
    iter=21       0.63411     0.75692      0.50987     0.65823      0.59541     0.67146     0.44387       0.9419      0.30182     0.15501    0.59645     0.79527       0.21429
    iter=22       0.48479     0.41502      0.86573     0.30199      0.89189     0.19345     0.87717      0.20735      0.72486    0.081301    0.33101     0.50255       0.66601
    iter=23       0.99483     0.14565      0.99739     0.58084       0.2879     0.93351     0.34839    0.0098048       0.7519     0.62826      0.293     0.22799       0.44075
    iter=24       0.65897     0.73402      0.60983     0.37065      0.74153     0.59893     0.10752      0.86856      0.18563    0.096957    0.50408     0.83128       0.41279
    iter=25       0.97233      0.6695      0.02318     0.16907      0.47657      0.6539     0.76474      0.67863      0.56838    0.033433    0.84478     0.11344       0.84655
    iter=26        0.8807     0.63547      0.90563     0.04142      0.41475     0.37543     0.89628       0.1717     0.061113     0.32361    0.94566     0.99932       0.50236
    iter=27       0.70458     0.54285      0.78738     0.98237      0.82769     0.32807     0.18864      0.17666      0.68328     0.64505    0.84831      0.7583       0.22902
    iter=28      0.083358     0.25207      0.50855     0.58489      0.52445    0.032114     0.67352      0.89586      0.66873     0.58428    0.54402     0.51846       0.71204
    iter=29       0.44178      0.0739      0.75462     0.61813      0.47624     0.43845     0.51589     0.080977       0.1342     0.67218    0.52084     0.47662       0.43218
    iter=30    0.00052199     0.38718      0.61101     0.28002      0.86079     0.82111     0.86196     0.071843       0.8931     0.79269    0.52622     0.27251       0.41595
    iter=31       0.67862     0.95467      0.42215     0.90224      0.13066      0.6523     0.29815     0.023435      0.16966     0.38019    0.62508     0.96316       0.93127
    iter=32       0.77484    0.024173      0.24658     0.43998      0.12457     0.99447      0.3033      0.57251      0.54411    0.079293    0.27881     0.31945       0.14712
    iter=33       0.91188     0.59134      0.20631     0.24269      0.13217     0.59987      0.2211      0.32539     0.034614     0.43419    0.52189     0.45295      0.019838
    iter=34       0.35425     0.88438      0.32351    0.043488      0.65271     0.51867     0.13983      0.52491      0.81456     0.78547    0.33024     0.53322       0.42402
    iter=35       0.54383      0.5819      0.35683      0.1219      0.97823    0.072206     0.95901      0.40191       0.5951     0.30488    0.27509     0.78338        0.9468
    iter=36       0.65316     0.71632        0.408     0.49738      0.58863     0.66295     0.68068      0.62923       0.4058     0.73403    0.37291     0.41234       0.73077
    iter=37       0.17754     0.71658       0.5144     0.70091      0.41723     0.41011     0.80479      0.63162      0.64404      0.1002    0.98632      0.9098       0.31191
    iter=38       0.98479     0.37915      0.90879     0.32308    0.0089615     0.25984     0.53621      0.34268      0.36634     0.17277    0.75335     0.12065       0.15508
    iter=39     0.0027325     0.15427      0.11694    0.012864      0.89584     0.76363     0.82146      0.95666      0.99997     0.92512    0.44599     0.87247       0.98911
    iter=40       0.19577      0.1575      0.18004     0.65078      0.97529     0.88071     0.26243      0.33334      0.70605     0.78842    0.84578     0.65139        0.8529
    iter=41       0.46825     0.46256      0.46911     0.18991      0.99142     0.54836     0.69571      0.67104       0.1968     0.77883    0.50142      0.4315        0.6736
    iter=42       0.55689    0.035016      0.31214     0.52025      0.92228     0.45146     0.85103     0.026174      0.82957     0.87731    0.55187     0.13716       0.26952
    iter=43        0.2541     0.72649      0.93196      0.9264      0.18216     0.93526    0.087153      0.86177      0.30249     0.90972    0.74276    0.018417       0.90255
    iter=44       0.99496     0.75187      0.87776     0.46753      0.56208    0.083413     0.96579      0.33517      0.52302     0.93039    0.27242     0.36574       0.26571
    iter=45       0.44664     0.45059      0.98941     0.86789      0.49994     0.36804     0.70092      0.92007      0.62486     0.40401    0.38635    0.017309       0.85365
    iter=46      0.055288     0.28686      0.19438     0.42194      0.86441    0.033132    0.075536      0.24608    0.0047512     0.28915    0.75361     0.47144       0.41913
    iter=47       0.69643     0.14233      0.81941     0.88762       0.3686    0.046005     0.94284     0.077658      0.77537     0.76871    0.49347     0.13166      0.085687
    iter=48       0.23766      0.4937      0.61421     0.37149      0.90352     0.64059     0.96246      0.28344       0.2124     0.94388    0.66518     0.84485       0.93546
    iter=49       0.29969     0.36511      0.23523     0.13245       0.6153     0.51019     0.38875      0.30294      0.20398      0.2794    0.90187     0.95741       0.82357
    iter=50       0.25605     0.78088      0.79211     0.42937       0.7721      0.5618     0.57694      0.62216       0.7948     0.37113    0.33429     0.19613       0.93245

tb_val
                   z1_0_34664    z2_0_42338    z3_0_51712    z4_0_63162    z5_0_77146    z6_0_94226    z7_1_1509    z8_1_4057    z9_1_7169    z10_2_097    z11_2_5613
                   __________    __________    __________    __________    __________    __________    _________    _________    _________    _________    __________

    a1=0            -0.81261      -0.61261      -0.41261      -0.21261     -0.012614      0.18739       0.38739      0.58739      0.78739      0.98739       1.1874  
    a2=0.10101      -0.60288      -0.43778      -0.26729     -0.092112      0.087095      0.26974       0.45531      0.64333      0.83342       1.0252       1.2185  
    a3=0.20202       -0.4296      -0.28901      -0.14043      0.015419       0.17776      0.34583       0.51891      0.69632      0.87743       1.0617       1.2486  
    a4=0.30303      -0.28196      -0.15954     -0.027861        0.1125       0.26088      0.41654       0.57871      0.74663      0.91959       1.0969       1.2779  
    a5=0.40404      -0.15334      -0.04492      0.073305       0.20099       0.33762      0.48257       0.63513      0.79454      0.96003       1.1309       1.3063  
    a6=0.50505     -0.039392        0.0579       0.16517       0.28228       0.40889      0.54451       0.68854      0.84025      0.99891       1.1637        1.334  
    a7=0.60606      0.062889       0.15113        0.2493       0.35745       0.47541      0.60284       0.73924      0.88397       1.0363       1.1956       1.3609  
    a8=0.70707       0.15567        0.2364        0.3269       0.42737       0.53779      0.65796       0.78749      0.92586       1.0724       1.2264       1.3871  
    a9=0.80808       0.24057       0.31497       0.39891       0.49271        0.5965      0.71019       0.83352      0.96606       1.1072       1.2563       1.4126  
    a10=0.90909      0.31883       0.38781       0.46608       0.55405       0.65195      0.75983       0.87753       1.0047       1.1409       1.2854       1.4375  
    a11=1.0101        0.3914       0.45571       0.52902       0.61184       0.70449      0.80712       0.91968       1.0419       1.1734       1.3136       1.4618  
    a12=1.1111       0.45906       0.51928       0.58823       0.66647       0.75441      0.85228       0.96012       1.0778       1.2049       1.3411       1.4855  
    a13=1.2121       0.52243       0.57906       0.64414       0.71827       0.80195      0.89548       0.99899       1.1124       1.2355       1.3678       1.5087  
    a14=1.3131       0.58202       0.63546       0.69708       0.76753       0.84734       0.9369        1.0364       1.1459       1.2651       1.3938       1.5314  
    a15=1.4141       0.63826       0.68885       0.74736       0.81446       0.89075      0.97667        1.0725       1.1783       1.2939       1.4192       1.5535  
    a16=1.5152       0.69151       0.73954       0.79523        0.8593       0.93236       1.0149        1.1073       1.2096       1.3219       1.4439       1.5752  
    a17=1.6162       0.74206       0.78777       0.84091       0.90221        0.9723       1.0518        1.1409       1.2401       1.3492       1.4681       1.5964  
    a18=1.7172       0.79018       0.83379        0.8846       0.94335        1.0107       1.0873        1.1735       1.2696       1.3757       1.4916       1.6171  
    a19=1.8182       0.83609       0.87779       0.92646       0.98287        1.0477       1.1216         1.205       1.2983       1.4015       1.5147       1.6375  
    a20=1.9192       0.87999       0.91993       0.96664        1.0209        1.0834       1.1548        1.2356       1.3261       1.4267       1.5372       1.6574  
    a21=2.0202       0.92204       0.96036        1.0053        1.0575        1.1178       1.1869        1.2652       1.3533       1.4512       1.5592       1.6769  
    a22=2.1212       0.96239       0.99922        1.0425        1.0928        1.1511        1.218         1.294       1.3797       1.4752       1.5807       1.6961  
    a23=2.2222        1.0012        1.0366        1.0783         1.127        1.1833       1.2481         1.322       1.4054       1.4986       1.6018       1.7149  
    a24=2.3232        1.0385        1.0727        1.1129          1.16        1.2146       1.2774        1.3492       1.4305       1.5215       1.6225       1.7334  
    a25=2.4242        1.0745        1.1075        1.1464        1.1919        1.2448       1.3059        1.3757       1.4549       1.5438       1.6427       1.7515  
    a26=2.5253        1.1092        1.1411        1.1787        1.2228        1.2742       1.3335        1.4016       1.4788       1.5657       1.6625       1.7693  
    a27=2.6263        1.1428        1.1737        1.2101        1.2529        1.3027       1.3605        1.4267       1.5021       1.5871        1.682       1.7868  
    a28=2.7273        1.1753        1.2052        1.2405         1.282        1.3305       1.3867        1.4513       1.5249       1.6081        1.701        1.804  
    a29=2.8283        1.2068        1.2357          1.27        1.3103        1.3575       1.4122        1.4752       1.5472       1.6286       1.7198       1.8209  
    a30=2.9293        1.2373        1.2654        1.2987        1.3379        1.3838       1.4371        1.4987        1.569       1.6487       1.7381       1.8375  
    a31=3.0303        1.2669        1.2942        1.3265        1.3647        1.4094       1.4614        1.5215       1.5903       1.6684       1.7562       1.8539  
    a32=3.1313        1.2956        1.3222        1.3536        1.3908        1.4344       1.4852        1.5439       1.6112       1.6877       1.7739         1.87  
    a33=3.2323        1.3236        1.3494          1.38        1.4162        1.4588       1.5083        1.5657       1.6317       1.7067       1.7913       1.8858  
    a34=3.3333        1.3508        1.3759        1.4057        1.4411        1.4825        1.531        1.5871       1.6517       1.7253       1.8084       1.9014  
    a35=3.4343        1.3772        1.4017        1.4308        1.4653        1.5058       1.5531        1.6081       1.6714       1.7436       1.8253       1.9167  
    a36=3.5354         1.403        1.4269        1.4553        1.4889        1.5285       1.5748        1.6286       1.6907       1.7615       1.8418       1.9318  
    a37=3.6364        1.4281        1.4514        1.4791         1.512        1.5507        1.596        1.6487       1.7096       1.7792       1.8581       1.9467  
    a38=3.7374        1.4527        1.4754        1.5025        1.5346        1.5724       1.6168        1.6684       1.7281       1.7965       1.8741       1.9614  
    a39=3.8384        1.4766        1.4988        1.5252        1.5566        1.5937       1.6371        1.6878       1.7463       1.8135       1.8899       1.9759  
    a40=3.9394           1.5        1.5217        1.5475        1.5782        1.6145       1.6571        1.7067       1.7642       1.8303       1.9054       1.9901  
    a41=4.0404        1.5228         1.544        1.5693        1.5994        1.6349       1.6766        1.7254       1.7818       1.8467       1.9207       2.0042  
    a42=4.1414        1.5451        1.5659        1.5906        1.6201        1.6549       1.6958        1.7436       1.7991       1.8629       1.9357        2.018  
    a43=4.2424         1.567        1.5873        1.6115        1.6403        1.6745       1.7146        1.7616       1.8161       1.8789       1.9506       2.0317  
    a44=4.3434        1.5884        1.6082         1.632        1.6602        1.6937       1.7331        1.7792       1.8328       1.8946       1.9652       2.0452  
    a45=4.4444        1.6093        1.6287         1.652        1.6797        1.7125       1.7512        1.7965       1.8492         1.91       1.9796       2.0585  
    a46=4.5455        1.6298        1.6489        1.6717        1.6988         1.731        1.769        1.8136       1.8654       1.9252       1.9938       2.0716  
    a47=4.6465        1.6499        1.6686        1.6909        1.7176        1.7492       1.7865        1.8303       1.8813       1.9402       2.0078       2.0846  
    a48=4.7475        1.6696        1.6879        1.7098         1.736        1.7671       1.8037        1.8468       1.8969        1.955       2.0216       2.0974  
    a49=4.8485        1.6889        1.7069        1.7284        1.7541        1.7846       1.8206         1.863       1.9123       1.9695       2.0352         2.11  
    a50=4.9495        1.7078        1.7255        1.7466        1.7718        1.8018       1.8373        1.8789       1.9275       1.9839       2.0487       2.1225  
    a51=5.0505        1.7264        1.7437        1.7645        1.7893        1.8188       1.8536        1.8946       1.9425        1.998       2.0619       2.1348  
    a52=5.1515        1.7447        1.7617        1.7821        1.8064        1.8354       1.8697        1.9101       1.9572        2.012        2.075        2.147  
    a53=5.2525        1.7626        1.7793        1.7994        1.8233        1.8518       1.8855        1.9253       1.9717       2.0257       2.0879        2.159  
    a54=5.3535        1.7802        1.7966        1.8163        1.8399        1.8679       1.9011        1.9403        1.986       2.0393       2.1007       2.1709  
    a55=5.4545        1.7975        1.8137         1.833        1.8562        1.8838       1.9165         1.955       2.0002       2.0527       2.1133       2.1826  
    a56=5.5556        1.8145        1.8304        1.8495        1.8723        1.8994       1.9316        1.9696       2.0141       2.0659       2.1257       2.1942  
    a57=5.6566        1.8312        1.8469        1.8656         1.888        1.9148       1.9465        1.9839       2.0278       2.0789        2.138       2.2057  
    a58=5.7576        1.8477        1.8631        1.8815        1.9036        1.9299       1.9612         1.998       2.0413       2.0918       2.1501        2.217  
    a59=5.8586        1.8639         1.879        1.8972        1.9189        1.9448       1.9756         2.012       2.0547       2.1045       2.1621       2.2282  
    a60=5.9596        1.8798        1.8947        1.9126         1.934        1.9595       1.9899        2.0257       2.0679        2.117       2.1739       2.2393  
    a61=6.0606        1.8955        1.9101        1.9278        1.9488         1.974       2.0039        2.0393       2.0809       2.1294       2.1856       2.2503  
    a62=6.1616        1.9109        1.9254        1.9427        1.9635        1.9883       2.0178        2.0527       2.0937       2.1416       2.1972       2.2612  
    a63=6.2626        1.9261        1.9403        1.9574        1.9779        2.0024       2.0315        2.0659       2.1064       2.1537       2.2086       2.2719  
    a64=6.3636        1.9411        1.9551        1.9719        1.9921        2.0163        2.045        2.0789       2.1189       2.1657         2.22       2.2825  
    a65=6.4646        1.9559        1.9697        1.9863        2.0062          2.03       2.0583        2.0918       2.1313       2.1775       2.2311        2.293  
    a66=6.5657        1.9704         1.984        2.0004          2.02        2.0435       2.0714        2.1045       2.1435       2.1891       2.2422       2.3034  
    a67=6.6667        1.9847        1.9981        2.0143        2.0336        2.0568       2.0844         2.117       2.1555       2.2007       2.2531       2.3137  
    a68=6.7677        1.9989        2.0121         2.028        2.0471        2.0699       2.0972        2.1294       2.1675       2.2121        2.264       2.3239  
    a69=6.8687        2.0128        2.0258        2.0415        2.0604        2.0829       2.1098        2.1417       2.1793       2.2233       2.2747        2.334  
    a70=6.9697        2.0265        2.0394        2.0549        2.0735        2.0957       2.1223        2.1537       2.1909       2.2345       2.2853        2.344  
    a71=7.0707        2.0401        2.0528        2.0681        2.0864        2.1084       2.1346        2.1657       2.2024       2.2455       2.2957       2.3538  
    a72=7.1717        2.0534         2.066        2.0811        2.0992        2.1209       2.1468        2.1775       2.2138       2.2564       2.3061       2.3636  
    a73=7.2727        2.0666         2.079        2.0939        2.1118        2.1332       2.1588        2.1892        2.225       2.2672       2.3164       2.3733  
    a74=7.3737        2.0797        2.0919        2.1066        2.1242        2.1454       2.1707        2.2007       2.2362       2.2779       2.3265       2.3829  
    a75=7.4747        2.0925        2.1046        2.1191        2.1365        2.1575       2.1824        2.2121       2.2472       2.2884       2.3366       2.3924  
    a76=7.5758        2.1052        2.1171        2.1314        2.1487        2.1694        2.194        2.2234       2.2581       2.2989       2.3465       2.4019  
    a77=7.6768        2.1177        2.1295        2.1437        2.1607        2.1811       2.2055        2.2345       2.2688       2.3092       2.3564       2.4112  
    a78=7.7778        2.1301        2.1417        2.1557        2.1726        2.1927       2.2168        2.2455       2.2795       2.3194       2.3662       2.4204  
    a79=7.8788        2.1424        2.1538        2.1676        2.1843        2.2042       2.2281        2.2564         2.29       2.3296       2.3758       2.4296  
    a80=7.9798        2.1544        2.1658        2.1794        2.1959        2.2156       2.2392        2.2672       2.3004       2.3396       2.3854       2.4387  
    a81=8.0808        2.1664        2.1776        2.1911        2.2073        2.2268       2.2501        2.2779       2.3108       2.3495       2.3949       2.4477  
    a82=8.1818        2.1782        2.1892        2.2026        2.2186        2.2379        2.261        2.2884        2.321       2.3593       2.4043       2.4566  
    a83=8.2828        2.1898        2.2008         2.214        2.2298        2.2489       2.2717        2.2989       2.3311       2.3691       2.4136       2.4654  
    a84=8.3838        2.2013        2.2122        2.2252        2.2409        2.2598       2.2823        2.3092       2.3411       2.3787       2.4228       2.4742  
    a85=8.4848        2.2127        2.2234        2.2363        2.2519        2.2705       2.2928        2.3195        2.351       2.3883        2.432       2.4829  
    a86=8.5859         2.224        2.2346        2.2473        2.2627        2.2812       2.3032        2.3296       2.3608       2.3977        2.441       2.4915  
    a87=8.6869        2.2351        2.2456        2.2582        2.2734        2.2917       2.3135        2.3396       2.3706       2.4071         2.45          2.5  
    a88=8.7879        2.2461        2.2565         2.269         2.284        2.3021       2.3237        2.3495       2.3802       2.4164       2.4589       2.5085  
    a89=8.8889         2.257        2.2673        2.2796        2.2945        2.3124       2.3338        2.3594       2.3897       2.4256       2.4677       2.5169  
    a90=8.9899        2.2678        2.2779        2.2902        2.3049        2.3226       2.3438        2.3691       2.3992       2.4347       2.4764       2.5252  
    a91=9.0909        2.2785        2.2885        2.3006        2.3152        2.3327       2.3537        2.3787       2.4085       2.4437       2.4851       2.5334  
    a92=9.1919         2.289        2.2989        2.3109        2.3253        2.3427       2.3635        2.3883       2.4178       2.4527       2.4937       2.5416  
    a93=9.2929        2.2995        2.3093        2.3211        2.3354        2.3526       2.3732        2.3977        2.427       2.4615       2.5022       2.5497  
    a94=9.3939        2.3098        2.3195        2.3312        2.3454        2.3624       2.3828        2.4071       2.4361       2.4703       2.5107       2.5578  
    a95=9.4949          2.32        2.3296        2.3413        2.3553        2.3721       2.3923        2.4164       2.4451       2.4791        2.519       2.5658  
    a96=9.596         2.3302        2.3397        2.3512         2.365        2.3817       2.4017        2.4256        2.454       2.4877       2.5273       2.5737  
    a97=9.697         2.3402        2.3496         2.361        2.3747        2.3912        2.411        2.4347       2.4629       2.4963       2.5356       2.5816  
    a98=9.798         2.3501        2.3594        2.3707        2.3843        2.4007       2.4203        2.4437       2.4717       2.5048       2.5437       2.5894  
    a99=9.899         2.3599        2.3692        2.3803        2.3938          2.41       2.4294        2.4527       2.4804       2.5132       2.5518       2.5971  
    a100=10           2.3697        2.3788        2.3899        2.4032        2.4193       2.4385        2.4616        2.489       2.5215       2.5599       2.6048  

tb_pol_a
                   z1_0_34664    z2_0_42338    z3_0_51712    z4_0_63162    z5_0_77146    z6_0_94226    z7_1_1509    z8_1_4057    z9_1_7169    z10_2_097    z11_2_5613
                   __________    __________    __________    __________    __________    __________    _________    _________    _________    _________    __________

    a1=0                   0             0             0             0             0             0            0            0            0            0             0 
    a2=0.10101      0.041519       0.04288      0.044543      0.046574      0.049055      0.052085     0.055786     0.060307     0.065828     0.072571      0.080808 
    a3=0.20202      0.083038      0.085761      0.089086      0.093149       0.09811       0.10417      0.11157      0.12061      0.13166      0.14514       0.16162 
    a4=0.30303       0.12456       0.12864       0.13363       0.13972       0.14717       0.15626      0.16736      0.18092      0.19748      0.21771       0.24242 
    a5=0.40404       0.16608       0.17152       0.17817        0.1863       0.19622       0.20834      0.22314      0.24123      0.26331      0.29029       0.32323 
    a6=0.50505       0.20759        0.2144       0.22272       0.23287       0.24528       0.26043      0.27893      0.30153      0.32914      0.36286       0.40404 
    a7=0.60606       0.24911       0.25728       0.26726       0.27945       0.29433       0.31251      0.33472      0.36184      0.39497      0.43543       0.48485 
    a8=0.70707       0.29063       0.30016        0.3118       0.32602       0.34339        0.3646       0.3905      0.42215      0.46079        0.508       0.56566 
    a9=0.80808       0.33215       0.34304       0.35635       0.37259       0.39244       0.41668      0.44629      0.48245      0.52662      0.58057       0.64646 
    a10=0.90909      0.37367       0.38592       0.40089       0.41917        0.4415       0.46877      0.50208      0.54276      0.59245      0.65314       0.72727 
    a11=1.0101       0.41519        0.4288       0.44543       0.46574       0.49055       0.52085      0.55786      0.60307      0.65828      0.72571       0.80808 
    a12=1.1111       0.45671       0.47168       0.48998       0.51232       0.53961       0.57294      0.61365      0.66337      0.72411      0.79829       0.88889 
    a13=1.2121       0.49823       0.51456       0.53452       0.55889       0.58866       0.62502      0.66943      0.72368      0.78993      0.87086        0.9697 
    a14=1.3131       0.53974       0.55744       0.57906       0.60547       0.63772       0.67711      0.72522      0.78399      0.85576      0.94343        1.0505 
    a15=1.4141       0.58126       0.60032        0.6236       0.65204       0.68677       0.72919      0.78101      0.84429      0.92159        1.016        1.1313 
    a16=1.5152       0.62278        0.6432       0.66815       0.69862       0.73583       0.78128      0.83679       0.9046      0.98742       1.0886        1.2121 
    a17=1.6162        0.6643       0.68608       0.71269       0.74519       0.78488       0.83336      0.89258      0.96491       1.0532       1.1611        1.2929 
    a18=1.7172       0.70582       0.72896       0.75723       0.79176       0.83394       0.88545      0.94837       1.0252       1.1191       1.2337        1.3737 
    a19=1.8182       0.74734       0.77184       0.80178       0.83834       0.88299       0.93754       1.0042       1.0855       1.1849       1.3063        1.4545 
    a20=1.9192       0.78886       0.81472       0.84632       0.88491       0.93205       0.98962       1.0599       1.1458       1.2507       1.3789        1.5354 
    a21=2.0202       0.83038       0.85761       0.89086       0.93149        0.9811        1.0417       1.1157       1.2061       1.3166       1.4514        1.6162 
    a22=2.1212       0.87189       0.90049       0.93541       0.97806        1.0302        1.0938       1.1715       1.2664       1.3824        1.524         1.697 
    a23=2.2222       0.91341       0.94337       0.97995        1.0246        1.0792        1.1459       1.2273       1.3267       1.4482       1.5966        1.7778 
    a24=2.3232       0.95493       0.98625        1.0245        1.0712        1.1283         1.198       1.2831       1.3871        1.514       1.6691        1.8586 
    a25=2.4242       0.99645        1.0291         1.069        1.1178        1.1773          1.25       1.3389       1.4474       1.5799       1.7417        1.9394 
    a26=2.5253         1.038         1.072        1.1136        1.1644        1.2264        1.3021       1.3947       1.5077       1.6457       1.8143        2.0202 
    a27=2.6263        1.0795        1.1149        1.1581        1.2109        1.2754        1.3542       1.4504        1.568       1.7115       1.8869         2.101 
    a28=2.7273         1.121        1.1578        1.2027        1.2575        1.3245        1.4063       1.5062       1.6283       1.7774       1.9594        2.1818 
    a29=2.8283        1.1625        1.2006        1.2472        1.3041        1.3735        1.4584        1.562       1.6886       1.8432        2.032        2.2626 
    a30=2.9293         1.204        1.2435        1.2918        1.3507        1.4226        1.5105       1.6178       1.7489        1.909       2.1046        2.3434 
    a31=3.0303        1.2456        1.2864        1.3363        1.3972        1.4717        1.5626       1.6736       1.8092       1.9748       2.1771        2.4242 
    a32=3.1313        1.2871        1.3293        1.3808        1.4438        1.5207        1.6146       1.7294       1.8695       2.0407       2.2497        2.5051 
    a33=3.2323        1.3286        1.3722        1.4254        1.4904        1.5698        1.6667       1.7852       1.9298       2.1065       2.3223        2.5859 
    a34=3.3333        1.3701         1.415        1.4699         1.537        1.6188        1.7188       1.8409       1.9901       2.1723       2.3949        2.6667 
    a35=3.4343        1.4116        1.4579        1.5145        1.5835        1.6679        1.7709       1.8967       2.0504       2.2381       2.4674        2.7475 
    a36=3.5354        1.4532        1.5008         1.559        1.6301        1.7169         1.823       1.9525       2.1107        2.304         2.54        2.8283 
    a37=3.6364        1.4947        1.5437        1.6036        1.6767         1.766        1.8751       2.0083        2.171       2.3698       2.6126        2.9091 
    a38=3.7374        1.5362        1.5866        1.6481        1.7233         1.815        1.9272       2.0641       2.2313       2.4356       2.6851        2.9899 
    a39=3.8384        1.5777        1.6294        1.6926        1.7698        1.8641        1.9792       2.1199       2.2917       2.5015       2.7577        3.0707 
    a40=3.9394        1.6192        1.6723        1.7372        1.8164        1.9132        2.0313       2.1757        2.352       2.5673       2.8303        3.1515 
    a41=4.0404        1.6608        1.7152        1.7817         1.863        1.9622        2.0834       2.2314       2.4123       2.6331       2.9029        3.2323 
    a42=4.1414        1.7023        1.7581        1.8263        1.9095        2.0113        2.1355       2.2872       2.4726       2.6989       2.9754        3.3131 
    a43=4.2424        1.7438         1.801        1.8708        1.9561        2.0603        2.1876        2.343       2.5329       2.7648        3.048        3.3939 
    a44=4.3434        1.7853        1.8439        1.9154        2.0027        2.1094        2.2397       2.3988       2.5932       2.8306       3.1206        3.4747 
    a45=4.4444        1.8268        1.8867        1.9599        2.0493        2.1584        2.2918       2.4546       2.6535       2.8964       3.1931        3.5556 
    a46=4.5455        1.8683        1.9296        2.0044        2.0958        2.2075        2.3438       2.5104       2.7138       2.9623       3.2657        3.6364 
    a47=4.6465        1.9099        1.9725         2.049        2.1424        2.2565        2.3959       2.5662       2.7741       3.0281       3.3383        3.7172 
    a48=4.7475        1.9514        2.0154        2.0935         2.189        2.3056         2.448        2.622       2.8344       3.0939       3.4109         3.798 
    a49=4.8485        1.9929        2.0583        2.1381        2.2356        2.3546        2.5001       2.6777       2.8947       3.1597       3.4834        3.8788 
    a50=4.9495        2.0344        2.1011        2.1826        2.2821        2.4037        2.5522       2.7335        2.955       3.2256        3.556        3.9596 
    a51=5.0505        2.0759         2.144        2.2272        2.3287        2.4528        2.6043       2.7893       3.0153       3.2914       3.6286        4.0404 
    a52=5.1515        2.1175        2.1869        2.2717        2.3753        2.5018        2.6563       2.8451       3.0756       3.3572       3.7011        4.1212 
    a53=5.2525         2.159        2.2298        2.3162        2.4219        2.5509        2.7084       2.9009       3.1359        3.423       3.7737         4.202 
    a54=5.3535        2.2005        2.2727        2.3608        2.4684        2.5999        2.7605       2.9567       3.1963       3.4889       3.8463        4.2828 
    a55=5.4545         2.242        2.3155        2.4053         2.515         2.649        2.8126       3.0125       3.2566       3.5547       3.9189        4.3636 
    a56=5.5556        2.2835        2.3584        2.4499        2.5616         2.698        2.8647       3.0682       3.3169       3.6205       3.9914        4.4444 
    a57=5.6566        2.3251        2.4013        2.4944        2.6082        2.7471        2.9168        3.124       3.3772       3.6864        4.064        4.5253 
    a58=5.7576        2.3666        2.4442         2.539        2.6547        2.7961        2.9689       3.1798       3.4375       3.7522       4.1366        4.6061 
    a59=5.8586        2.4081        2.4871        2.5835        2.7013        2.8452        3.0209       3.2356       3.4978        3.818       4.2091        4.6869 
    a60=5.9596        2.4496        2.5299         2.628        2.7479        2.8943         3.073       3.2914       3.5581       3.8838       4.2817        4.7677 
    a61=6.0606        2.4911        2.5728        2.6726        2.7945        2.9433        3.1251       3.3472       3.6184       3.9497       4.3543        4.8485 
    a62=6.1616        2.5326        2.6157        2.7171         2.841        2.9924        3.1772        3.403       3.6787       4.0155       4.4269        4.9293 
    a63=6.2626        2.5742        2.6586        2.7617        2.8876        3.0414        3.2293       3.4587        3.739       4.0813       4.4994        5.0101 
    a64=6.3636        2.6157        2.7015        2.8062        2.9342        3.0905        3.2814       3.5145       3.7993       4.1472        4.572        5.0909 
    a65=6.4646        2.6572        2.7443        2.8508        2.9808        3.1395        3.3335       3.5703       3.8596        4.213       4.6446        5.1717 
    a66=6.5657        2.6987        2.7872        2.8953        3.0273        3.1886        3.3855       3.6261       3.9199       4.2788       4.7171        5.2525 
    a67=6.6667        2.7402        2.8301        2.9399        3.0739        3.2376        3.4376       3.6819       3.9802       4.3446       4.7897        5.3333 
    a68=6.7677        2.7818         2.873        2.9844        3.1205        3.2867        3.4897       3.7377       4.0405       4.4105       4.8623        5.4141 
    a69=6.8687        2.8233        2.9159        3.0289        3.1671        3.3358        3.5418       3.7935       4.1009       4.4763       4.9349        5.4949 
    a70=6.9697        2.8648        2.9587        3.0735        3.2136        3.3848        3.5939       3.8493       4.1612       4.5421       5.0074        5.5758 
    a71=7.0707        2.9063        3.0016         3.118        3.2602        3.4339         3.646        3.905       4.2215       4.6079         5.08        5.6566 
    a72=7.1717        2.9478        3.0445        3.1626        3.3068        3.4829        3.6981       3.9608       4.2818       4.6738       5.1526        5.7374 
    a73=7.2727        2.9894        3.0874        3.2071        3.3534         3.532        3.7501       4.0166       4.3421       4.7396       5.2251        5.8182 
    a74=7.3737        3.0309        3.1303        3.2517        3.3999         3.581        3.8022       4.0724       4.4024       4.8054       5.2977         5.899 
    a75=7.4747        3.0724        3.1731        3.2962        3.4465        3.6301        3.8543       4.1282       4.4627       4.8713       5.3703        5.9798 
    a76=7.5758        3.1139         3.216        3.3407        3.4931        3.6791        3.9064        4.184        4.523       4.9371       5.4429        6.0606 
    a77=7.6768        3.1554        3.2589        3.3853        3.5397        3.7282        3.9585       4.2398       4.5833       5.0029       5.5154        6.1414 
    a78=7.7778        3.1969        3.3018        3.4298        3.5862        3.7772        4.0106       4.2955       4.6436       5.0687        5.588        6.2222 
    a79=7.8788        3.2385        3.3447        3.4744        3.6328        3.8263        4.0627       4.3513       4.7039       5.1346       5.6606         6.303 
    a80=7.9798          3.28        3.3875        3.5189        3.6794        3.8754        4.1147       4.4071       4.7642       5.2004       5.7331        6.3838 
    a81=8.0808        3.3215        3.4304        3.5635        3.7259        3.9244        4.1668       4.4629       4.8245       5.2662       5.8057        6.4646 
    a82=8.1818         3.363        3.4733         3.608        3.7725        3.9735        4.2189       4.5187       4.8848       5.3321       5.8783        6.5455 
    a83=8.2828        3.4045        3.5162        3.6525        3.8191        4.0225         4.271       4.5745       4.9451       5.3979       5.9509        6.6263 
    a84=8.3838        3.4461        3.5591        3.6971        3.8657        4.0716        4.3231       4.6303       5.0054       5.4637       6.0234        6.7071 
    a85=8.4848        3.4876        3.6019        3.7416        3.9122        4.1206        4.3752        4.686       5.0658       5.5295        6.096        6.7879 
    a86=8.5859        3.5291        3.6448        3.7862        3.9588        4.1697        4.4272       4.7418       5.1261       5.5954       6.1686        6.8687 
    a87=8.6869        3.5706        3.6877        3.8307        4.0054        4.2187        4.4793       4.7976       5.1864       5.6612       6.2411        6.9495 
    a88=8.7879        3.6121        3.7306        3.8753         4.052        4.2678        4.5314       4.8534       5.2467        5.727       6.3137        7.0303 
    a89=8.8889        3.6537        3.7735        3.9198        4.0985        4.3169        4.5835       4.9092        5.307       5.7928       6.3863        7.1111 
    a90=8.9899        3.6952        3.8163        3.9643        4.1451        4.3659        4.6356        4.965       5.3673       5.8587       6.4589        7.1919 
    a91=9.0909        3.7367        3.8592        4.0089        4.1917         4.415        4.6877       5.0208       5.4276       5.9245       6.5314        7.2727 
    a92=9.1919        3.7782        3.9021        4.0534        4.2383         4.464        4.7398       5.0765       5.4879       5.9903        6.604        7.3535 
    a93=9.2929        3.8197         3.945         4.098        4.2848        4.5131        4.7918       5.1323       5.5482       6.0562       6.6766        7.4343 
    a94=9.3939        3.8612        3.9879        4.1425        4.3314        4.5621        4.8439       5.1881       5.6085        6.122       6.7491        7.5152 
    a95=9.4949        3.9028        4.0307        4.1871         4.378        4.6112         4.896       5.2439       5.6688       6.1878       6.8217         7.596 
    a96=9.596         3.9443        4.0736        4.2316        4.4246        4.6602        4.9481       5.2997       5.7291       6.2536       6.8943        7.6768 
    a97=9.697         3.9858        4.1165        4.2761        4.4711        4.7093        5.0002       5.3555       5.7894       6.3195       6.9669        7.7576 
    a98=9.798         4.0273        4.1594        4.3207        4.5177        4.7584        5.0523       5.4113       5.8497       6.3853       7.0394        7.8384 
    a99=9.899         4.0688        4.2023        4.3652        4.5643        4.8074        5.1044       5.4671         5.91       6.4511        7.112        7.9192 
    a100=10           4.1104        4.2451        4.4098        4.6109        4.8565        5.1564       5.5228       5.9704        6.517       7.1846             8 

</pre><h2 id="8">Generate and Save Graphs</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph)
    bl_input_override = true;
    ff_az_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_az_vf_post_01.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_02.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_03.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_04.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_05.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_06.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_07.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans = 

  Map with properties:

        Count: 8
      KeyType: char
    ValueType: any

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% 
% *back to <https://fanwangecon.github.io Fan>'s
% <https://fanwangecon.github.io/CodeDynaAsset/ Dynamic Assets Repository> 
% Table of Content.*

function [result_map] = ff_az_vf_post(varargin)
%% FF_AZ_VF_POST post ff_az_vf graphs, tables, mats.
% Given the solution form ff_az_vf, graphs, tables, mats. Graphing code is
% separately in ff_az_vf_post_graph.m. Run this function directly with
% randomly generates matrixes for graph/table testings.
%
% @param param_map container parameter container
%
% @param support_map container support container
%
% @param armt_map container container with states, choices and shocks
% grids that are inputs for grid based solution algorithm
%
% @param func_map container container with function handles for
% consumption cash-on-hand etc.
%
% @param result_map container contains policy function matrix, value
% function matrix, iteration results
%
% @return result_map container add coh consumption and other matrixes to
% result_map also add table versions of val pol and iter matries 
%
% @example
%
%    bl_input_override = true;
%    result_map = containers.Map('KeyType','char', 'ValueType','any');
%    result_map('mt_val') = mt_val;
%    result_map('mt_pol_a') = mt_pol_a;
%    result_map('ar_val_diff_norm') = ar_val_diff_norm(1:it_iter_last);
%    result_map('ar_pol_diff_norm') = ar_pol_diff_norm(1:it_iter_last);
%    result_map('mt_pol_perc_change') = mt_pol_perc_change(1:it_iter_last, :);
%    result_map = ff_az_vf_post(param_map, support_map, armt_map, func_map, result_map,    bl_input_override);
%
% @include
%
% * <https://github.com/FanWangEcon/CodeDynaAsset/blob/master/m_az/solvepost/ff_az_vf_post_graph.m ff_az_vf_post_graph>
%

%% Default

params_len = length(varargin);
bl_input_override = 0;
if (params_len == 6)
    bl_input_override = varargin{6};
end

if (bl_input_override)
    % if invoked from outside overrid fully
    [param_map, support_map, armt_map, func_map, result_map, ~] = varargin{:};
    
    params_group = values(result_map, {'mt_val', 'mt_pol_a'});
    [mt_val, mt_pol_a] = params_group{:};
    params_group = values(result_map, {'ar_val_diff_norm', 'ar_pol_diff_norm', 'mt_pol_perc_change'});
    [ar_val_diff_norm, ar_pol_diff_norm, mt_pol_perc_change] = params_group{:};
    
    % Get Parameters
    params_group = values(param_map, {'it_z_n', 'it_a_n'});
    [it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {'ar_a', 'ar_z'});
    [ar_a, ar_z] = params_group{:};
    
else
    clear all;
    close all;
    
    % internal invoke for testing
    it_param_set = 4;
    bl_input_override = true;
    
    % Get Parameters
    [param_map, support_map] = ffs_az_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_az_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generate Default val and policy matrixes
    params_group = values(param_map, {'it_maxiter_val', 'it_z_n', 'it_a_n'});
    [it_maxiter_val, it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {'ar_a', 'ar_z'});
    [ar_a, ar_z] = params_group{:};
    f_util_standin = func_map('f_util_standin');
    
    % Set Defaults
    mt_val = f_util_standin(ar_z, ar_a');
    mt_pol_a = zeros(size(mt_val)) + ar_a'*(cumsum(sort(ar_z))/sum(ar_z)*0.4 + 0.4);
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    mt_pol_perc_change = rand([it_iter_max, it_z_n]);
    
    % Set Results Map
    result_map = containers.Map('KeyType','char', 'ValueType','any');
    result_map('mt_val') = mt_val;
    result_map('mt_pol_a') = mt_pol_a;
end

%% Parse Parameter

% support_map
params_group = values(support_map, {'bl_display_final', 'it_display_final_rowmax', 'it_display_final_colmax'});
[bl_display_final, it_display_final_rowmax, it_display_final_colmax] = params_group{:};
params_group = values(support_map, {'bl_graph', 'bl_graph_onebyones'});
[bl_graph] = params_group{:};
params_group = values(support_map, {'bl_mat', 'st_mat_path', 'st_mat_prefix', 'st_mat_name_main', 'st_mat_suffix'});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};

% func_map
params_group = values(func_map, {'f_inc', 'f_cons', 'f_coh'});
[f_inc, f_cons, f_coh] = params_group{:};

%% Generate Consumption and Income Matrix

mt_cons = f_cons(ar_z, ar_a', mt_pol_a);
mt_incm = f_inc(ar_z, ar_a');
mt_coh = f_coh(ar_z, ar_a');
result_map('mt_cons') = mt_cons;
result_map('mt_incm') = mt_incm;
result_map('mt_coh') = mt_coh;

%% Save Mat

if (bl_mat)
    mkdir(support_map('st_mat_path'));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
end

%% Display Val Pol Iter Table

if (bl_display_final)
    
    % Display Value Function Iteration Step by Step REsults
    it_iter_max = length(ar_val_diff_norm);
    if (it_iter_max >= it_display_final_rowmax)
        ar_it_rows_iter = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows_iter = [ar_it_rows_iter ((it_iter_max)-round(it_display_final_rowmax/2)+1):1:(it_iter_max)];        
    else
        ar_it_rows_iter = 1:1:it_iter_max;
    end
    tb_valpol_alliter = array2table([ar_val_diff_norm(ar_it_rows_iter)';...
                                     ar_pol_diff_norm(ar_it_rows_iter)';...
                                     mt_pol_perc_change(ar_it_rows_iter, :)']');
                                 
    cl_col_names = ['valgap', 'polgap', strcat('z', string((1:it_z_n)))];
    cl_row_names = strcat('iter=', string(ar_it_rows_iter));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{'valgap'} = 'norm(mt_val - mt_val_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'polgap'} = 'norm(mt_pol_a - mt_pol_a_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'z1'} = 'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)';
    
    disp('valgap = norm(mt_val - mt_val_cur)');
    disp('polgap = norm(mt_pol_a - mt_pol_a_cur)');
    disp('z1 = z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)');   
    disp(tb_valpol_alliter);
    
    % Display Values by States
    % at most display 11 columns of shocks
    % at most display 50 rows for states
    % display first and last
    if (it_a_n >= it_display_final_rowmax)
        ar_it_rows = (1:1:round(it_display_final_rowmax/2));
        ar_it_rows = [ar_it_rows ((it_a_n)-round(it_display_final_rowmax/2)+1):1:(it_a_n)];
    else
        ar_it_rows = 1:1:it_a_n;
    end
    if (it_z_n >= it_display_final_colmax)
        ar_it_cols = (1:1:round(it_display_final_colmax/2));
        ar_it_cols = [ar_it_cols ((it_z_n)-round(it_display_final_colmax/2)+1):1:(it_z_n)];
    else
        ar_it_cols = 1:1:it_z_n;
    end
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);
    
    % Display Optimal Values
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat('a', string(ar_it_rows), '=', string(ar_a(ar_it_rows)));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_val');
    disp(tb_val);
    
    % Display Optimal Choices
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat('a', string(ar_it_rows), '=', string(ar_a(ar_it_rows)));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat('z', string(ar_it_cols), '=', string(ar_z(ar_it_cols))));
    disp('tb_pol_a');
    disp(tb_pol_a);
    
    % Save to result map
    result_map('tb_valpol_alliter') = tb_valpol_alliter;
    result_map('tb_val') = tb_val;
    result_map('tb_pol_a') = tb_pol_a;
end

%% Generate and Save Graphs

if (bl_graph)
    bl_input_override = true;
    ff_az_vf_post_graph(param_map, support_map, armt_map, result_map, bl_input_override);
end

end

##### SOURCE END #####
--></body></html>