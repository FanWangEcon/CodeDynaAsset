
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>ff_az_vf_post</title><meta name="generator" content="MATLAB 9.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-05-27"><meta name="DC.source" content="ff_az_vf_post.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">FF_AZ_VF_POST handles post ff_az_vf tabling, graphing, gen mat</a></li><li><a href="#2">Parameters Defaults</a></li><li><a href="#3">Parse Parameter</a></li><li><a href="#4">Consumption and Income Matrix</a></li><li><a href="#5">Saving workspace to mat</a></li><li><a href="#6">Table Generation</a></li><li><a href="#7">Graphing</a></li></ul></div><h2 id="1">FF_AZ_VF_POST handles post ff_az_vf tabling, graphing, gen mat</h2><p>While invoking ff_az_vf, if bl_post == true, proceed with below</p><pre class="codeinput"><span class="keyword">function</span> ff_az_vf_post(varargin)
</pre><h2 id="2">Parameters Defaults</h2><pre class="codeinput">params_len = length(varargin);
bl_input_override = 0;
<span class="keyword">if</span> (params_len == 7)
    bl_input_override = varargin{7};
<span class="keyword">end</span>

<span class="keyword">if</span> (bl_input_override)
    <span class="comment">% if invoked from outside overrid fully</span>
    [param_map, support_map, armt_map, ~, result_map, ~] = varargin{:};

    params_group = values(result_map, {<span class="string">'mt_val'</span>, <span class="string">'mt_pol_a'</span>});
    [mt_val, mt_pol_a] = params_group{:};
    params_group = values(result_map, {<span class="string">'ar_val_diff_norm'</span>, <span class="string">'ar_pol_diff_norm'</span>, <span class="string">'ar_pol_perc_change'</span>});
    [ar_val_diff_norm, ar_pol_diff_norm, ar_pol_perc_change] = params_group{:};

<span class="keyword">else</span>
    clear <span class="string">all</span>;
    close <span class="string">all</span>;

    <span class="comment">% internal invoke for testing</span>
    it_param_set = 4;
    bl_input_override = true;

    <span class="comment">% Get Parameters</span>
    [param_map, support_map] = ffs_az_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_az_get_funcgrid(param_map, support_map, bl_input_override); <span class="comment">% 1 for override</span>

    <span class="comment">% Generate Default val and policy matrixes</span>
    params_group = values(param_map, {<span class="string">'it_maxiter_val'</span>, <span class="string">'it_z_n'</span>, <span class="string">'it_a_n'</span>});
    [it_maxiter_val, it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {<span class="string">'ar_a'</span>, <span class="string">'ar_z'</span>});
    [ar_a, ar_z] = params_group{:};
    f_util_standin = func_map(<span class="string">'f_util_standin'</span>);

    <span class="comment">% Set Defaults</span>
    mt_val = f_util_standin(ar_z, ar_a');
    mt_pol_a = zeros(size(mt_val)) + ar_a'*0.9;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    ar_pol_perc_change = rand([it_iter_max, it_z_n]);

    <span class="comment">% Set Results Map</span>
    result_map = containers.Map(<span class="string">'KeyType'</span>,<span class="string">'char'</span>, <span class="string">'ValueType'</span>,<span class="string">'any'</span>);
    result_map(<span class="string">'mt_val'</span>) = mt_val;
    result_map(<span class="string">'mt_pol_a'</span>) = mt_pol_a;
<span class="keyword">end</span>
</pre><h2 id="3">Parse Parameter</h2><p>support_map</p><pre class="codeinput">params_group = values(support_map, {<span class="string">'it_display_every'</span>, <span class="string">'bl_display_final'</span>});
[it_display_every, bl_display_final] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_graph'</span>, <span class="string">'bl_graph_onebyones'</span>});
[bl_graph] = params_group{:};
params_group = values(support_map, {<span class="string">'bl_mat'</span>, <span class="string">'st_mat_path'</span>, <span class="string">'st_mat_prefix'</span>, <span class="string">'st_mat_name_main'</span>, <span class="string">'st_mat_suffix'</span>});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};
<span class="comment">% func_map</span>
params_group = values(func_map, {<span class="string">'f_util_log'</span>, <span class="string">'f_util_crra'</span>, <span class="string">'f_inc'</span>, <span class="string">'f_coh'</span>, <span class="string">'f_cons'</span>});
[f_util_log, f_util_crra, f_inc, f_coh, f_cons] = params_group{:};
</pre><h2 id="4">Consumption and Income Matrix</h2><pre class="codeinput">mt_cons = f_cons(ar_z, ar_a', mt_pol_a);
mt_incm = f_inc(ar_z, ar_a');
result_map(<span class="string">'mt_cons'</span>) = mt_cons;
result_map(<span class="string">'mt_incm'</span>) = mt_incm;
</pre><h2 id="5">Saving workspace to mat</h2><pre class="codeinput"><span class="keyword">if</span> (bl_mat)
    mkdir(support_map(<span class="string">'st_mat_path'</span>));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Directory already exists. 
</pre><h2 id="6">Table Generation</h2><pre class="codeinput"><span class="keyword">if</span> (bl_display_final)

    <span class="comment">% Display Value Function Iteration Step by Step REsults</span>
    it_iter_max = length(ar_val_diff_norm);
    tb_valpol_alliter = array2table([ar_val_diff_norm(1:it_display_every:it_iter_max)';<span class="keyword">...</span>
        ar_pol_diff_norm(1:it_display_every:it_iter_max)'; <span class="keyword">...</span>
        ar_pol_perc_change(1:it_display_every:it_iter_max, :)']');
    cl_col_names = [<span class="string">'valgap'</span>, <span class="string">'polgap'</span>, strcat(<span class="string">'z'</span>, string((1:it_z_n)))];
    cl_row_names = strcat(<span class="string">'iter='</span>, string((1:it_display_every:it_iter_max)));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'valgap'</span>} = <span class="string">'norm(mt_val - mt_val_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'valgap'</span>} = <span class="string">'norm(mt_pol_a - mt_pol_a_cur)'</span>;
    tb_valpol_alliter.Properties.VariableDescriptions{<span class="string">'z1'</span>} = <span class="string">'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)'</span>;
    summary(tb_valpol_alliter);
    disp(tb_valpol_alliter);

    <span class="comment">% Display Values by States</span>
    <span class="comment">% at most display 11 columns of shocks</span>
    <span class="comment">% at most display 50 rows for states</span>
    <span class="comment">% display first and last</span>
    <span class="keyword">if</span> (it_a_n &gt;= 50)
        ar_it_rows = (1:1:25);
        ar_it_rows = [ar_it_rows ((it_a_n)-25):1:(it_a_n)];
    <span class="keyword">else</span>
        ar_it_rows = 1:1:it_a_n;
    <span class="keyword">end</span>
    <span class="keyword">if</span> (it_z_n &gt;= 12)
        ar_it_cols = (1:1:6);
        ar_it_cols = [ar_it_cols ((it_z_n)-6):1:(it_z_n)];
    <span class="keyword">else</span>
        ar_it_cols = 1:1:it_z_n;
    <span class="keyword">end</span>
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);

    <span class="comment">% Display Optimal Values</span>
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat(<span class="string">'a'</span>,string(ar_it_rows), <span class="string">'='</span>, string(ar_a(ar_it_rows)));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_val'</span>);
    summary(tb_val);
    disp(tb_val);

    <span class="comment">% Display Optimal Choices</span>
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat(<span class="string">'a='</span>, string(ar_a(ar_it_rows)));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat(<span class="string">'z='</span>, string(ar_z(ar_it_cols))));
    disp(<span class="string">'tb_pol_a'</span>);
    summary(tb_pol_a);
    disp(tb_pol_a);

<span class="keyword">end</span>
</pre><pre class="codeoutput">
Variables:

    valgap: 50&times;1 double

        Properties:
            Description:  norm(mt_pol_a - mt_pol_a_cur)
        Values:

            Min       0.034813
            Median     0.54507
            Max        0.98031

    polgap: 50&times;1 double

        Values:

            Min       0.0098551
            Median        0.499
            Max         0.97788

    z1: 50&times;1 double

        Properties:
            Description:  z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)
        Values:

            Min       0.019594
            Median     0.54531
            Max        0.98625

    z2: 50&times;1 double

        Values:

            Min       0.026502
            Median     0.46581
            Max        0.99679

    z3: 50&times;1 double

        Values:

            Min       0.0051875
            Median      0.56465
            Max         0.98784

    z4: 50&times;1 double

        Values:

            Min       0.029185
            Median     0.53094
            Max        0.99054

    z5: 50&times;1 double

        Values:

            Min       0.020777
            Median     0.45241
            Max        0.94982

    z6: 50&times;1 double

        Values:

            Min       0.0075775
            Median      0.50648
            Max          0.9923

    z7: 50&times;1 double

        Values:

            Min       0.022532
            Median     0.54789
            Max        0.99884

    z8: 50&times;1 double

        Values:

            Min       0.083994
            Median     0.45839
            Max        0.99887

    z9: 50&times;1 double

        Values:

            Min       0.01557
            Median    0.60297
            Max       0.99852

    z10: 50&times;1 double

        Values:

            Min       0.0073303
            Median      0.41701
            Max         0.99914

    z11: 50&times;1 double

        Values:

            Min       0.0088355
            Median      0.46495
            Max         0.98627

                valgap      polgap         z1          z2          z3           z4          z5          z6           z7          z8         z9          z10          z11   
               ________    _________    ________    ________    _________    ________    ________    _________    ________    ________    _______    _________    _________

    iter=1      0.67393       0.8532     0.92477      0.4002      0.72301     0.34812      0.8072      0.70513     0.71166     0.56388    0.60403      0.23276      0.18299
    iter=2       0.2151     0.050885     0.10855     0.95375      0.21338     0.36516     0.67451     0.092712     0.23165     0.46944     0.7746       0.1434      0.22422
    iter=3       0.1507      0.36184     0.62874     0.85241      0.29701     0.51312     0.27876      0.80913     0.16001     0.44356    0.46881      0.17316      0.95577
    iter=4      0.12317      0.87328     0.82644     0.38902        0.576     0.80168     0.19292      0.27091     0.74378     0.20157    0.14612        0.753      0.13193
    iter=5      0.25743      0.51526    0.088587     0.68048      0.76147     0.47663     0.39383      0.68682     0.97101     0.19618    0.21722     0.075456      0.34974
    iter=6     0.034813      0.58703    0.019594     0.46728      0.82126     0.99054     0.63239      0.91336     0.37025     0.85223    0.87144     0.073975      0.92067
    iter=7      0.85018      0.70077     0.89935     0.15084        0.486     0.37312     0.22615     0.093724     0.65521     0.69114    0.94232      0.25497       0.3957
    iter=8      0.72752      0.86298      0.4829     0.24041      0.46992     0.84706    0.039838      0.29696     0.68156     0.37886    0.10712      0.15413       0.8779
    iter=9      0.41293      0.20979      0.8143     0.21821      0.50051    0.034034    0.089118      0.77012     0.12667     0.19025    0.50318      0.19045      0.59999
    iter=10     0.14606      0.38527     0.92743     0.58201      0.75793     0.77662     0.32342      0.51897     0.96753     0.25562    0.30481      0.64705       0.5238
    iter=11     0.54768      0.80069      0.1383      0.3232      0.29339     0.33251     0.60697       0.6171     0.24246     0.29693    0.77599      0.78824     0.092441
    iter=12     0.80743      0.49623     0.14249    0.026502      0.81408     0.26027     0.42809      0.11918     0.53276     0.89581    0.72762    0.0082414      0.95632
    iter=13     0.36331     0.099189     0.87372     0.60309       0.7029     0.64937     0.89861      0.56055     0.83144     0.99096    0.26804      0.98365      0.53769
    iter=14      0.4733      0.39545     0.30971     0.54633    0.0051875     0.96625     0.52472      0.95647      0.6823    0.083994     0.7685    0.0078539      0.81103
    iter=15     0.44875      0.89774     0.17109     0.60561       0.1577     0.58418     0.83048      0.72743     0.51714     0.34704    0.84139      0.81152      0.54209
    iter=16     0.71228      0.15247     0.84111     0.48694      0.65903     0.86683     0.51751      0.92332     0.40977    0.088489    0.40273      0.10875      0.69966
    iter=17     0.80815      0.76356     0.46708     0.99679      0.85816      0.5219     0.39629     0.053315      0.1451     0.63064    0.94038      0.91995      0.98627
    iter=18     0.22137      0.97788     0.53539     0.31009       0.3935      0.4122     0.20639      0.72533     0.24545     0.25184    0.01557     0.029213     0.090131
    iter=19     0.29886      0.15638     0.98625     0.27151      0.69201     0.53998     0.72147     0.082218     0.69887      0.4259    0.61408      0.60731      0.94938
    iter=20     0.98031      0.90533     0.11149     0.20515      0.98108     0.28684     0.36531      0.72374     0.41834     0.50912    0.15876      0.72158     0.048659
    iter=21     0.70416      0.35462      0.6371     0.86058      0.91856     0.68018     0.55446     0.046013     0.15232     0.27846    0.38119     0.078076      0.94965
    iter=22     0.40064      0.69133     0.13115     0.12839      0.51541     0.40696      0.6394      0.58546     0.81338     0.53828    0.42477      0.72439      0.19311
    iter=23     0.37693     0.072577     0.90255     0.81759      0.63368     0.13473     0.75374      0.30119     0.09607     0.80252    0.68117      0.91647      0.20163
    iter=24       0.332      0.35731     0.91928     0.85958      0.38017     0.58194     0.45107      0.41461     0.87328     0.12227    0.38625      0.69782      0.33818
    iter=25      0.7333      0.85859     0.55523     0.49739     0.090777     0.12376    0.020777       0.9586     0.51547     0.75047    0.25398      0.88714     0.023182
    iter=26     0.54246      0.44968      0.3268     0.87241      0.23153     0.94192     0.19656      0.19847     0.16371     0.47991     0.7689      0.60233      0.36442
    iter=27     0.55284      0.10495     0.91307     0.71058     0.084097       0.323     0.25958      0.49399     0.74584     0.99887    0.18214      0.97687      0.48846
    iter=28      0.1378      0.51618     0.43397     0.62965      0.98784     0.72101     0.51632      0.08944     0.43024     0.46701    0.99852      0.80855      0.17657
    iter=29     0.68438      0.42129     0.78334      0.6315      0.46189     0.83036     0.24866      0.84081     0.15769     0.54111    0.32124      0.96774      0.83093
    iter=30     0.28787      0.78177     0.23202     0.92166      0.76591    0.062593     0.63715      0.64445    0.085008    0.088269    0.12066      0.44078     0.024942
    iter=31     0.92004      0.91531     0.24734     0.98346      0.74729     0.23721     0.69333    0.0075775     0.86395      0.9699    0.77714      0.70002      0.66733
    iter=32     0.12372      0.67743    0.061166     0.66953      0.47003     0.60678     0.76064       0.9581     0.77714     0.62237    0.96225      0.60918      0.72774
    iter=33     0.75687      0.59166     0.53463     0.14731      0.44824      0.8294     0.26106      0.22399     0.26702     0.44977    0.39239      0.39323     0.057534
    iter=34     0.44367      0.50176     0.48716     0.03341      0.80379     0.68817     0.19535      0.22978     0.28465     0.91004    0.67561      0.13299      0.60715
    iter=35     0.88817       0.8614     0.79998      0.2142      0.59951    0.047465     0.84017      0.77808     0.60699     0.90643    0.29686      0.64927    0.0088355
    iter=36      0.8493      0.36759     0.67719     0.33471      0.42688     0.68414     0.21277       0.9923    0.047323     0.12649    0.22925      0.55788      0.65108
    iter=37     0.64957      0.58825     0.69762     0.55837      0.31219     0.89808     0.72041      0.54685     0.83555     0.25712    0.84068      0.29592      0.44143
    iter=38      0.9732     0.059062     0.35583     0.39803      0.30969    0.057801     0.59771      0.10257     0.96881     0.60338    0.38984      0.04913      0.61048
    iter=39     0.86397      0.73791     0.55557    0.048662      0.71896    0.097478     0.15019     0.056159      0.7501     0.18814    0.62238       0.7078      0.15296
    iter=40      0.4733      0.39538     0.53101     0.50074      0.68724     0.39799     0.57301      0.22646     0.92423     0.26572    0.81504      0.12699      0.14585
    iter=41     0.90671      0.21676     0.38421     0.44456       0.5533     0.89431     0.40168      0.30954       0.107     0.17381    0.95702      0.89876      0.97587
    iter=42     0.32527      0.16259     0.75125     0.30801      0.87911      0.6706     0.33943      0.81221     0.90917     0.50851    0.49567     0.055555      0.72981
    iter=43     0.63684      0.59619     0.67983     0.85967     0.064639     0.82444     0.54935       0.8559     0.81958     0.62658    0.84377      0.26402     0.020607
    iter=44     0.93571      0.13764      0.5911     0.53969       0.8913     0.86854      0.8559      0.14431     0.64361     0.41456    0.54422     0.077889      0.32221
    iter=45     0.40407    0.0098551    0.071723     0.35433      0.62535      0.6304     0.45375      0.21304     0.99884    0.093889     0.6019      0.93176      0.36983
    iter=46     0.88574      0.82504     0.15022    0.085792     0.060434     0.57247     0.35462     0.026683     0.21479     0.34982    0.44362    0.0073303      0.20303
    iter=47     0.61703      0.18694     0.32138     0.40663      0.98169     0.45801     0.41443      0.33692     0.99074     0.52913    0.68193      0.12714      0.49167
    iter=48    0.090247     0.079398     0.87315     0.46435      0.89511     0.44241     0.32171      0.67633    0.022532     0.99241    0.67283      0.99914      0.15089
    iter=49     0.71962     0.090966     0.78986     0.22237      0.30307    0.085605     0.90803      0.95531     0.39522     0.10561     0.9189      0.32291      0.84443
    iter=50     0.12666      0.75451     0.67342    0.069526       0.5432    0.029185     0.94982     0.050019     0.56303     0.63054      0.613     0.021409      0.52984

tb_val

Variables:

    z_0_34664: 51&times;1 double

        Values:

            Min         -7.9672  
            Median       4.3388  
            Max          4.6299  

    z_0_42338: 51&times;1 double

        Values:

            Min         -7.7672  
            Median       4.3388  
            Max          4.6299  

    z_0_51712: 51&times;1 double

        Values:

            Min         -7.5672  
            Median       4.3388  
            Max          4.6299  

    z_0_63162: 51&times;1 double

        Values:

            Min         -7.3672  
            Median       4.3388  
            Max          4.6299  

    z_0_77146: 51&times;1 double

        Values:

            Min         -7.1672  
            Median       4.3388  
            Max          4.6299  

    z_0_94226: 51&times;1 double

        Values:

            Min         -6.9672  
            Median       4.3388  
            Max          4.6299  

    z_1_1509: 51&times;1 double

        Values:

            Min        -6.7672  
            Median      4.3388  
            Max         4.6299  

    z_1_4057: 51&times;1 double

        Values:

            Min        -6.5672  
            Median      4.3388  
            Max         4.6299  

    z_1_7169: 51&times;1 double

        Values:

            Min        -6.3672  
            Median      4.3388  
            Max         4.6299  

    z_2_097: 51&times;1 double

        Values:

            Min        -6.1672 
            Median      4.3388 
            Max         4.6299 

    z_2_5613: 51&times;1 double

        Values:

            Min        -5.9672  
            Median      4.3388  
            Max         4.6299  

                   z_0_34664    z_0_42338    z_0_51712    z_0_63162    z_0_77146    z_0_94226    z_1_1509    z_1_4057    z_1_7169    z_2_097     z_2_5613
                   _________    _________    _________    _________    _________    _________    ________    ________    ________    ________    ________

    a1=0            -7.9672      -7.7672      -7.5672      -7.3672      -7.1672      -6.9672      -6.7672    -6.5672     -6.3672      -6.1672     -5.9672
    a2=1.0101      0.035078     0.035152     0.035242     0.035353     0.035488     0.035653     0.035854     0.0361      0.0364     0.036766    0.037214
    a3=2.0202       0.72806      0.72809      0.72814       0.7282      0.72826      0.72835      0.72845    0.72857     0.72872       0.7289     0.72913
    a4=3.0303        1.1335       1.1335       1.1335       1.1336       1.1336       1.1337       1.1337     1.1338      1.1339        1.134      1.1342
    a5=4.0404        1.4211       1.4211       1.4212       1.4212       1.4212       1.4213       1.4213     1.4214      1.4215       1.4215      1.4217
    a6=5.05051       1.6442       1.6443       1.6443       1.6443       1.6443       1.6444       1.6444     1.6445      1.6445       1.6446      1.6447
    a7=6.06061       1.8266       1.8266       1.8266       1.8266       1.8266       1.8267       1.8267     1.8267      1.8268       1.8268      1.8269
    a8=7.07071       1.9807       1.9807       1.9807       1.9807       1.9808       1.9808       1.9808     1.9808      1.9809       1.9809       1.981
    a9=8.08081       2.1142       2.1142       2.1142       2.1143       2.1143       2.1143       2.1143     2.1144      2.1144       2.1144      2.1145
    a10=9.09091       2.232        2.232        2.232        2.232       2.2321       2.2321       2.2321     2.2321      2.2322       2.2322      2.2322
    a11=10.101       2.3374       2.3374       2.3374       2.3374       2.3374       2.3374       2.3374     2.3375      2.3375       2.3375      2.3376
    a12=11.1111      2.4327       2.4327       2.4327       2.4327       2.4327       2.4327       2.4327     2.4328      2.4328       2.4328      2.4329
    a13=12.1212      2.5197       2.5197       2.5197       2.5197       2.5197       2.5197       2.5197     2.5198      2.5198       2.5198      2.5199
    a14=13.1313      2.5997       2.5997       2.5997       2.5997       2.5997       2.5998       2.5998     2.5998      2.5998       2.5998      2.5999
    a15=14.1414      2.6738       2.6738       2.6738       2.6738       2.6739       2.6739       2.6739     2.6739      2.6739       2.6739       2.674
    a16=15.1515      2.7428       2.7428       2.7428       2.7428       2.7428       2.7429       2.7429     2.7429      2.7429       2.7429       2.743
    a17=16.1616      2.8074       2.8074       2.8074       2.8074       2.8074       2.8074       2.8074     2.8074      2.8074       2.8075      2.8075
    a18=17.1717       2.868        2.868        2.868        2.868        2.868        2.868        2.868      2.868      2.8681       2.8681      2.8681
    a19=18.1818      2.9251       2.9251       2.9251       2.9251       2.9252       2.9252       2.9252     2.9252      2.9252       2.9252      2.9253
    a20=19.1919      2.9792       2.9792       2.9792       2.9792       2.9792       2.9792       2.9792     2.9793      2.9793       2.9793      2.9793
    a21=20.202       3.0305       3.0305       3.0305       3.0305       3.0305       3.0305       3.0305     3.0305      3.0306       3.0306      3.0306
    a22=21.2121      3.0793       3.0793       3.0793       3.0793       3.0793       3.0793       3.0793     3.0793      3.0793       3.0794      3.0794
    a23=22.2222      3.1258       3.1258       3.1258       3.1258       3.1258       3.1258       3.1258     3.1258      3.1259       3.1259      3.1259
    a24=23.2323      3.1703       3.1703       3.1703       3.1703       3.1703       3.1703       3.1703     3.1703      3.1703       3.1703      3.1703
    a25=24.2424      3.2128       3.2128       3.2128       3.2128       3.2128       3.2128       3.2128     3.2129      3.2129       3.2129      3.2129
    a75=74.7475      4.3388       4.3388       4.3388       4.3388       4.3388       4.3388       4.3388     4.3388      4.3388       4.3388      4.3388
    a76=75.7576      4.3522       4.3522       4.3522       4.3522       4.3522       4.3522       4.3522     4.3522      4.3523       4.3523      4.3523
    a77=76.7677      4.3655       4.3655       4.3655       4.3655       4.3655       4.3655       4.3655     4.3655      4.3655       4.3655      4.3655
    a78=77.7778      4.3786       4.3786       4.3786       4.3786       4.3786       4.3786       4.3786     4.3786      4.3786       4.3786      4.3786
    a79=78.7879      4.3915       4.3915       4.3915       4.3915       4.3915       4.3915       4.3915     4.3915      4.3915       4.3915      4.3915
    a80=79.798       4.4042       4.4042       4.4042       4.4042       4.4042       4.4042       4.4042     4.4042      4.4042       4.4042      4.4042
    a81=80.8081      4.4168       4.4168       4.4168       4.4168       4.4168       4.4168       4.4168     4.4168      4.4168       4.4168      4.4168
    a82=81.8182      4.4292       4.4292       4.4292       4.4292       4.4292       4.4292       4.4292     4.4292      4.4292       4.4292      4.4292
    a83=82.8283      4.4415       4.4415       4.4415       4.4415       4.4415       4.4415       4.4415     4.4415      4.4415       4.4415      4.4415
    a84=83.8384      4.4536       4.4536       4.4536       4.4536       4.4536       4.4536       4.4536     4.4536      4.4536       4.4536      4.4536
    a85=84.8485      4.4656       4.4656       4.4656       4.4656       4.4656       4.4656       4.4656     4.4656      4.4656       4.4656      4.4656
    a86=85.8586      4.4774       4.4774       4.4774       4.4774       4.4774       4.4774       4.4774     4.4774      4.4774       4.4774      4.4774
    a87=86.8687      4.4891       4.4891       4.4891       4.4891       4.4891       4.4891       4.4891     4.4891      4.4891       4.4891      4.4891
    a88=87.8788      4.5007       4.5007       4.5007       4.5007       4.5007       4.5007       4.5007     4.5007      4.5007       4.5007      4.5007
    a89=88.8889      4.5121       4.5121       4.5121       4.5121       4.5121       4.5121       4.5121     4.5121      4.5121       4.5121      4.5121
    a90=89.899       4.5234       4.5234       4.5234       4.5234       4.5234       4.5234       4.5234     4.5234      4.5234       4.5234      4.5234
    a91=90.9091      4.5346       4.5346       4.5346       4.5346       4.5346       4.5346       4.5346     4.5346      4.5346       4.5346      4.5346
    a92=91.9192      4.5456       4.5456       4.5456       4.5456       4.5456       4.5456       4.5456     4.5456      4.5456       4.5456      4.5456
    a93=92.9293      4.5565       4.5565       4.5565       4.5565       4.5565       4.5565       4.5565     4.5565      4.5565       4.5566      4.5566
    a94=93.9394      4.5673       4.5673       4.5673       4.5673       4.5674       4.5674       4.5674     4.5674      4.5674       4.5674      4.5674
    a95=94.9495       4.578        4.578        4.578        4.578        4.578        4.578        4.578     4.5781      4.5781       4.5781      4.5781
    a96=95.9596      4.5886       4.5886       4.5886       4.5886       4.5886       4.5886       4.5886     4.5886      4.5886       4.5886      4.5886
    a97=96.9697      4.5991       4.5991       4.5991       4.5991       4.5991       4.5991       4.5991     4.5991      4.5991       4.5991      4.5991
    a98=97.9798      4.6095       4.6095       4.6095       4.6095       4.6095       4.6095       4.6095     4.6095      4.6095       4.6095      4.6095
    a99=98.9899      4.6197       4.6197       4.6197       4.6197       4.6197       4.6197       4.6197     4.6197      4.6197       4.6197      4.6197
    a100=100         4.6299       4.6299       4.6299       4.6299       4.6299       4.6299       4.6299     4.6299      4.6299       4.6299      4.6299

tb_pol_a

Variables:

    z_0_34664: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_0_42338: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_0_51712: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_0_63162: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_0_77146: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_0_94226: 51&times;1 double

        Values:

            Min              0   
            Median      67.273   
            Max             90   

    z_1_1509: 51&times;1 double

        Values:

            Min              0  
            Median      67.273  
            Max             90  

    z_1_4057: 51&times;1 double

        Values:

            Min              0  
            Median      67.273  
            Max             90  

    z_1_7169: 51&times;1 double

        Values:

            Min              0  
            Median      67.273  
            Max             90  

    z_2_097: 51&times;1 double

        Values:

            Min             0  
            Median     67.273  
            Max            90  

    z_2_5613: 51&times;1 double

        Values:

            Min              0  
            Median      67.273  
            Max             90  

                 z_0_34664    z_0_42338    z_0_51712    z_0_63162    z_0_77146    z_0_94226    z_1_1509    z_1_4057    z_1_7169    z_2_097    z_2_5613
                 _________    _________    _________    _________    _________    _________    ________    ________    ________    _______    ________

    a=0                 0            0            0            0            0            0           0           0           0           0          0 
    a=1.0101      0.90909      0.90909      0.90909      0.90909      0.90909      0.90909     0.90909     0.90909     0.90909     0.90909    0.90909 
    a=2.0202       1.8182       1.8182       1.8182       1.8182       1.8182       1.8182      1.8182      1.8182      1.8182      1.8182     1.8182 
    a=3.0303       2.7273       2.7273       2.7273       2.7273       2.7273       2.7273      2.7273      2.7273      2.7273      2.7273     2.7273 
    a=4.0404       3.6364       3.6364       3.6364       3.6364       3.6364       3.6364      3.6364      3.6364      3.6364      3.6364     3.6364 
    a=5.05051      4.5455       4.5455       4.5455       4.5455       4.5455       4.5455      4.5455      4.5455      4.5455      4.5455     4.5455 
    a=6.06061      5.4545       5.4545       5.4545       5.4545       5.4545       5.4545      5.4545      5.4545      5.4545      5.4545     5.4545 
    a=7.07071      6.3636       6.3636       6.3636       6.3636       6.3636       6.3636      6.3636      6.3636      6.3636      6.3636     6.3636 
    a=8.08081      7.2727       7.2727       7.2727       7.2727       7.2727       7.2727      7.2727      7.2727      7.2727      7.2727     7.2727 
    a=9.09091      8.1818       8.1818       8.1818       8.1818       8.1818       8.1818      8.1818      8.1818      8.1818      8.1818     8.1818 
    a=10.101       9.0909       9.0909       9.0909       9.0909       9.0909       9.0909      9.0909      9.0909      9.0909      9.0909     9.0909 
    a=11.1111          10           10           10           10           10           10          10          10          10          10         10 
    a=12.1212      10.909       10.909       10.909       10.909       10.909       10.909      10.909      10.909      10.909      10.909     10.909 
    a=13.1313      11.818       11.818       11.818       11.818       11.818       11.818      11.818      11.818      11.818      11.818     11.818 
    a=14.1414      12.727       12.727       12.727       12.727       12.727       12.727      12.727      12.727      12.727      12.727     12.727 
    a=15.1515      13.636       13.636       13.636       13.636       13.636       13.636      13.636      13.636      13.636      13.636     13.636 
    a=16.1616      14.545       14.545       14.545       14.545       14.545       14.545      14.545      14.545      14.545      14.545     14.545 
    a=17.1717      15.455       15.455       15.455       15.455       15.455       15.455      15.455      15.455      15.455      15.455     15.455 
    a=18.1818      16.364       16.364       16.364       16.364       16.364       16.364      16.364      16.364      16.364      16.364     16.364 
    a=19.1919      17.273       17.273       17.273       17.273       17.273       17.273      17.273      17.273      17.273      17.273     17.273 
    a=20.202       18.182       18.182       18.182       18.182       18.182       18.182      18.182      18.182      18.182      18.182     18.182 
    a=21.2121      19.091       19.091       19.091       19.091       19.091       19.091      19.091      19.091      19.091      19.091     19.091 
    a=22.2222          20           20           20           20           20           20          20          20          20          20         20 
    a=23.2323      20.909       20.909       20.909       20.909       20.909       20.909      20.909      20.909      20.909      20.909     20.909 
    a=24.2424      21.818       21.818       21.818       21.818       21.818       21.818      21.818      21.818      21.818      21.818     21.818 
    a=74.7475      67.273       67.273       67.273       67.273       67.273       67.273      67.273      67.273      67.273      67.273     67.273 
    a=75.7576      68.182       68.182       68.182       68.182       68.182       68.182      68.182      68.182      68.182      68.182     68.182 
    a=76.7677      69.091       69.091       69.091       69.091       69.091       69.091      69.091      69.091      69.091      69.091     69.091 
    a=77.7778          70           70           70           70           70           70          70          70          70          70         70 
    a=78.7879      70.909       70.909       70.909       70.909       70.909       70.909      70.909      70.909      70.909      70.909     70.909 
    a=79.798       71.818       71.818       71.818       71.818       71.818       71.818      71.818      71.818      71.818      71.818     71.818 
    a=80.8081      72.727       72.727       72.727       72.727       72.727       72.727      72.727      72.727      72.727      72.727     72.727 
    a=81.8182      73.636       73.636       73.636       73.636       73.636       73.636      73.636      73.636      73.636      73.636     73.636 
    a=82.8283      74.545       74.545       74.545       74.545       74.545       74.545      74.545      74.545      74.545      74.545     74.545 
    a=83.8384      75.455       75.455       75.455       75.455       75.455       75.455      75.455      75.455      75.455      75.455     75.455 
    a=84.8485      76.364       76.364       76.364       76.364       76.364       76.364      76.364      76.364      76.364      76.364     76.364 
    a=85.8586      77.273       77.273       77.273       77.273       77.273       77.273      77.273      77.273      77.273      77.273     77.273 
    a=86.8687      78.182       78.182       78.182       78.182       78.182       78.182      78.182      78.182      78.182      78.182     78.182 
    a=87.8788      79.091       79.091       79.091       79.091       79.091       79.091      79.091      79.091      79.091      79.091     79.091 
    a=88.8889          80           80           80           80           80           80          80          80          80          80         80 
    a=89.899       80.909       80.909       80.909       80.909       80.909       80.909      80.909      80.909      80.909      80.909     80.909 
    a=90.9091      81.818       81.818       81.818       81.818       81.818       81.818      81.818      81.818      81.818      81.818     81.818 
    a=91.9192      82.727       82.727       82.727       82.727       82.727       82.727      82.727      82.727      82.727      82.727     82.727 
    a=92.9293      83.636       83.636       83.636       83.636       83.636       83.636      83.636      83.636      83.636      83.636     83.636 
    a=93.9394      84.545       84.545       84.545       84.545       84.545       84.545      84.545      84.545      84.545      84.545     84.545 
    a=94.9495      85.455       85.455       85.455       85.455       85.455       85.455      85.455      85.455      85.455      85.455     85.455 
    a=95.9596      86.364       86.364       86.364       86.364       86.364       86.364      86.364      86.364      86.364      86.364     86.364 
    a=96.9697      87.273       87.273       87.273       87.273       87.273       87.273      87.273      87.273      87.273      87.273     87.273 
    a=97.9798      88.182       88.182       88.182       88.182       88.182       88.182      88.182      88.182      88.182      88.182     88.182 
    a=98.9899      89.091       89.091       89.091       89.091       89.091       89.091      89.091      89.091      89.091      89.091     89.091 
    a=100              90           90           90           90           90           90          90          90          90          90         90 

</pre><h2 id="7">Graphing</h2><pre class="codeinput"><span class="keyword">if</span> (bl_graph)
    ff_az_vf_post_graph(param_map, support_map, armt_map, result_map);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="ff_az_vf_post_01.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_02.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_03.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_04.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_05.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_06.png" alt=""> <img vspace="5" hspace="5" src="ff_az_vf_post_07.png" alt=""> <pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019a</a><br></p></div><!--
##### SOURCE BEGIN #####
%% FF_AZ_VF_POST handles post ff_az_vf tabling, graphing, gen mat
% While invoking ff_az_vf, if bl_post == true, proceed with below
function ff_az_vf_post(varargin)

%% Parameters Defaults
params_len = length(varargin);
bl_input_override = 0;
if (params_len == 7)
    bl_input_override = varargin{7};
end

if (bl_input_override)
    % if invoked from outside overrid fully
    [param_map, support_map, armt_map, ~, result_map, ~] = varargin{:};
    
    params_group = values(result_map, {'mt_val', 'mt_pol_a'});
    [mt_val, mt_pol_a] = params_group{:};
    params_group = values(result_map, {'ar_val_diff_norm', 'ar_pol_diff_norm', 'ar_pol_perc_change'});
    [ar_val_diff_norm, ar_pol_diff_norm, ar_pol_perc_change] = params_group{:};
    
else
    clear all;
    close all;
    
    % internal invoke for testing
    it_param_set = 4;
    bl_input_override = true;
    
    % Get Parameters
    [param_map, support_map] = ffs_az_set_default_param(it_param_set);
    [armt_map, func_map] = ffs_az_get_funcgrid(param_map, support_map, bl_input_override); % 1 for override
    
    % Generate Default val and policy matrixes
    params_group = values(param_map, {'it_maxiter_val', 'it_z_n', 'it_a_n'});
    [it_maxiter_val, it_z_n, it_a_n] = params_group{:};
    params_group = values(armt_map, {'ar_a', 'ar_z'});
    [ar_a, ar_z] = params_group{:};
    f_util_standin = func_map('f_util_standin');
    
    % Set Defaults
    mt_val = f_util_standin(ar_z, ar_a');
    mt_pol_a = zeros(size(mt_val)) + ar_a'*0.9;
    it_iter_max = min(it_maxiter_val, 50);
    ar_val_diff_norm = rand([it_iter_max, 1]);
    ar_pol_diff_norm = rand([it_iter_max, 1]);
    ar_pol_perc_change = rand([it_iter_max, it_z_n]);
    
    % Set Results Map
    result_map = containers.Map('KeyType','char', 'ValueType','any');
    result_map('mt_val') = mt_val;
    result_map('mt_pol_a') = mt_pol_a;
end

%% Parse Parameter
% support_map
params_group = values(support_map, {'it_display_every', 'bl_display_final'});
[it_display_every, bl_display_final] = params_group{:};
params_group = values(support_map, {'bl_graph', 'bl_graph_onebyones'});
[bl_graph] = params_group{:};
params_group = values(support_map, {'bl_mat', 'st_mat_path', 'st_mat_prefix', 'st_mat_name_main', 'st_mat_suffix'});
[bl_mat, st_mat_path, st_mat_prefix, st_mat_name_main, st_mat_suffix] = params_group{:};
% func_map
params_group = values(func_map, {'f_util_log', 'f_util_crra', 'f_inc', 'f_coh', 'f_cons'});
[f_util_log, f_util_crra, f_inc, f_coh, f_cons] = params_group{:};

%% Consumption and Income Matrix
mt_cons = f_cons(ar_z, ar_a', mt_pol_a);
mt_incm = f_inc(ar_z, ar_a');
result_map('mt_cons') = mt_cons;
result_map('mt_incm') = mt_incm;

%% Saving workspace to mat
if (bl_mat)
    mkdir(support_map('st_mat_path'));
    st_file_name = [st_mat_prefix st_mat_name_main st_mat_suffix];
    save(strcat(st_mat_path, st_file_name));
end

%% Table Generation
if (bl_display_final)
    
    % Display Value Function Iteration Step by Step REsults
    it_iter_max = length(ar_val_diff_norm);
    tb_valpol_alliter = array2table([ar_val_diff_norm(1:it_display_every:it_iter_max)';...
        ar_pol_diff_norm(1:it_display_every:it_iter_max)'; ...
        ar_pol_perc_change(1:it_display_every:it_iter_max, :)']');
    cl_col_names = ['valgap', 'polgap', strcat('z', string((1:it_z_n)))];
    cl_row_names = strcat('iter=', string((1:it_display_every:it_iter_max)));
    tb_valpol_alliter.Properties.VariableNames = cl_col_names;
    tb_valpol_alliter.Properties.RowNames = cl_row_names;
    tb_valpol_alliter.Properties.VariableDescriptions{'valgap'} = 'norm(mt_val - mt_val_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'valgap'} = 'norm(mt_pol_a - mt_pol_a_cur)';
    tb_valpol_alliter.Properties.VariableDescriptions{'z1'} = 'z1 perc change: sum((mt_pol_a ~= mt_pol_a_cur))/(it_a_n)';
    summary(tb_valpol_alliter);
    disp(tb_valpol_alliter);
    
    % Display Values by States
    % at most display 11 columns of shocks
    % at most display 50 rows for states
    % display first and last
    if (it_a_n >= 50)
        ar_it_rows = (1:1:25);
        ar_it_rows = [ar_it_rows ((it_a_n)-25):1:(it_a_n)];
    else
        ar_it_rows = 1:1:it_a_n;
    end
    if (it_z_n >= 12)
        ar_it_cols = (1:1:6);
        ar_it_cols = [ar_it_cols ((it_z_n)-6):1:(it_z_n)];
    else
        ar_it_cols = 1:1:it_z_n;
    end
    mt_val_print = mt_val(ar_it_rows, ar_it_cols);
    mt_pol_a_print = mt_pol_a(ar_it_rows, ar_it_cols);
    
    % Display Optimal Values
    tb_val = array2table(mt_val_print);
    tb_val.Properties.RowNames = strcat('a',string(ar_it_rows), '=', string(ar_a(ar_it_rows)));
    tb_val.Properties.VariableNames = matlab.lang.makeValidName(strcat('z=', string(ar_z(ar_it_cols))));
    disp('tb_val');
    summary(tb_val);
    disp(tb_val);
    
    % Display Optimal Choices
    tb_pol_a = array2table(mt_pol_a_print);
    tb_pol_a.Properties.RowNames = strcat('a=', string(ar_a(ar_it_rows)));
    tb_pol_a.Properties.VariableNames = matlab.lang.makeValidName(strcat('z=', string(ar_z(ar_it_cols))));
    disp('tb_pol_a');
    summary(tb_pol_a);
    disp(tb_pol_a);
    
end

%% Graphing
if (bl_graph)
    ff_az_vf_post_graph(param_map, support_map, armt_map, result_map);
end

end

##### SOURCE END #####
--></body></html>